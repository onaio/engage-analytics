[0m01:00:23.441524 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 1 with readable column names
-- Questionnaire ID: 55
-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as "ipc_s1_patient_age",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as "ipc_s1_patient_dob",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as "ipc_s1_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as "ipc_s1_in_the_past_6_months",max(case when linkid = 'f1.92.1' then answer_value_text end) as "ipc_s1_f1921",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as "ipc_s1_in_the_past_1_year",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as "ipc_s1_i_noticed_that_when_i_was_asking_about_important_p",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s1_did_you_complete_the_required_assessments_and_the_",max(case when linkid = 'f1.42.2' then answer_value_text end) as "ipc_s1_do_you_think_an_important_persons_death_is_connect",max(case when linkid = 'f1.68.2' then answer_value_text end) as "ipc_s1_are_you_and_someone_else_having_a_strong_disagreem",max(case when linkid = 'f1.69.2' then answer_value_text end) as "ipc_s1_briefly_tell_me_about_the_disagreement",max(case when linkid = 'f1.70.2' then answer_value_text end) as "ipc_s1_how_has_this_disagreement_been_affecting_you",max(case when linkid = 'f1.72.2' then answer_value_text end) as "ipc_s1_have_there_been_any_changes_in_your_life_that_are_",max(case when linkid = 'f1.73.2' then answer_value_text end) as "ipc_s1_what_was_the_change",max(case when linkid = 'f1.74.2' then answer_value_text end) as "ipc_s1_when_did_this_happen",max(case when linkid = 'f1.76.2' then answer_value_text end) as "ipc_s1_if_the_client_did_not_mention_any_close_relationsh",max(case when linkid = 'f1.78.2' then answer_value_text end) as "ipc_s1_would_you_say_you_have_close_relationships",max(case when linkid = 'f1.79.2' then answer_value_text end) as "ipc_s1_has_anything_changed_in_your_life_so_that_now_you_",max(case when linkid = 'f1.88.2' then answer_value_text end) as "ipc_s1_f1882",max(case when linkid = 'f1.89.2' then answer_value_text end) as "ipc_s1_select_the_possible_interpersonal_problem_areas_yo",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as "ipc_s1_your_most_distressing_current_symptoms_began",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as "ipc_s1_taskid_session_1_navigator",max(case when linkid = 'f1.40.2' then answer_value_text end) as "ipc_s1_f1402",max(case when linkid = 'f1.79.3' then answer_value_text end) as "ipc_s1_when_did_this_event_happen",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as "ipc_s1_is_there_anything_else_that_we_did_not_discuss_tha",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s1_taskid_session_2_navigator",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'f1.40.3' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or_",max(case when linkid = 'f1.43.2' then answer_value_text end) as "ipc_s1_tell_me_about_your_relationship_with_this_person_h",max(case when linkid = 'f1.69.3' then answer_value_text end) as "ipc_s1_when_did_this_disagreement_happen",max(case when linkid = 'f1.82.2' then answer_value_text end) as "ipc_s1_do_you_want_to_propose_an_interpersonal_formulatio",max(case when linkid = 'f1.87.2' then answer_value_text end) as "ipc_s1_do_you_agree_with_this",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as "ipc_s1_these_are_the_symptoms_you_said_you_are_currently_",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as "ipc_s1_taskid_mood_pdf",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as "ipc_s1_relationships_eg_talk_with_friends_or_vi",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as "ipc_s1_is_there_anything_that_could_get_in_the_way_of_you",max(case when linkid = 'f1.81.3' then answer_value_text end) as "ipc_s1_f1813",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_provider_pdf",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as "ipc_s1_work_on_my_relationship_with_my_parents_",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as "ipc_s1_f13931",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_client_pdf",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as "ipc_s1_of_these_symptoms_which_are_the_most_distressing",max(case when linkid = 'f1.81.4' then answer_value_text end) as "ipc_s1_f1814",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as "ipc_s1_earlier_than_that_you_noticed_symptoms",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as "ipc_s1_community_activities_eg_go_to_a_recreati",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as "ipc_s1_patient_name",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as "ipc_s1_f13932",max(case when linkid = 'f1.40.5' then answer_value_text end) as "ipc_s1_f1405",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as "ipc_s1_when_did_these_symptoms_begin",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as "ipc_s1_xxx",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "ipc_s1_yesterday_",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as "ipc_s1_patient_gender",max(case when linkid = 'f1.40.6' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__54",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as "ipc_s1_phq9_total",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as "ipc_s1_possible_problem_areas",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing_57",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as "ipc_s1_gad7_total",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as "ipc_s1_hobbies_eg_listen_to_music_play_video_ga",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as "ipc_s1_what_was_going_on_in_your_life_when_you_started_to",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s1_ptsd_total",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as "ipc_s1_zfgh",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as "ipc_s1_do_you_agree_with_this_summary",max(case when linkid = 'f1.40.8' then answer_value_text end) as "ipc_s1_f1408",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_mood_rating_session_1_score",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as "ipc_s1_what_about_before_that_was_there_a_time_before_in_",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as "ipc_s1_religionspirituality_eg_pray_or_go_to_se",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s1_mood_rating_total",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as "ipc_s1_person_1_is",max(case when linkid = 'f1.40.9' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__72",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as "ipc_s1_phq9_total_meaning",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as "ipc_s1_what_were_the_symptoms",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as "ipc_s1_with_my_pastor_",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as "ipc_s1_gad7_total_meaning",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as "ipc_s1_f13941",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as "ipc_s1_ptsd_total_meaning_toggle",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as "ipc_s1_when_did_you_notice_these_symptoms",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as "ipc_s1_other",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as "ipc_s1_mood_rating_comment",max(case when linkid = 'f1.38.4' then answer_value_text end) as "ipc_s1_f1384",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as "ipc_s1_f13942",max(case when linkid = 'f1.40.11' then answer_value_text end) as "ipc_s1_f14011",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as "ipc_s1_what_was_happening_then",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ipc_session_1",max(case when linkid = 'f1.40.12' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__87",max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as "ipc_s1_ex",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_89",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as "ipc_s1_person_2_is",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as "ipc_s1_f13951",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as "ipc_s1_f13952",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as "ipc_s1_gud",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_94",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as "ipc_s1_person_3_is",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as "ipc_s1_f13961",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as "ipc_s1_f13962",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_98",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as "ipc_s1_person_4_is",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as "seeing_someone_be_killed_or_seriously_injured",max(case when linkid = 'f1.38.3' then answer_value_text end) as "f1.38.3",max(case when linkid = 'f1.46.2' then answer_value_text end) as "f1.46.2",max(case when linkid = 'task-id-008' then answer_value_text end) as "task-id-008",max(case when linkid = 'task-id-009' then answer_value_text end) as "task-id-009",max(case when linkid = 'task-id-010' then answer_value_text end) as "task-id-010",max(case when linkid = 'task-id-012' then answer_value_text end) as "task-id-012"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m01:00:23.444640 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:23.446496 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m01:00:23.446763 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp" rename to "qr_spi_subform_4"
[0m01:00:23.449066 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:00:23.451189 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m01:00:23.451414 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m01:00:23.451608 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1" rename to "qr_start_ipc_s1__dbt_backup"
[0m01:00:23.452265 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m01:00:23.452484 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m01:00:23.452766 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m01:00:23.454278 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:23.454540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:23.455807 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup"
[0m01:00:23.457350 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m01:00:23.457650 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m01:00:23.457845 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp" rename to "qr_start_ipc_s1"
[0m01:00:23.458025 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup" cascade
[0m01:00:23.459864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:23.461652 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m01:00:23.461866 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m01:00:23.462074 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m01:00:23.462766 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: Close
[0m01:00:23.462951 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m01:00:23.463244 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220e1e20>]}
[0m01:00:23.463963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:23.463771 [info ] [Thread-4 (]: 31 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [[32mCREATE VIEW[0m in 0.66s]
[0m01:00:23.465258 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup"
[0m01:00:23.465535 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_spi_subform_4
[0m01:00:23.465809 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m01:00:23.466009 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_start_ipc_s4
[0m01:00:23.466214 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup" cascade
[0m01:00:23.466444 [info ] [Thread-4 (]: 35 of 35 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [RUN]
[0m01:00:23.466741 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_4, now model.engage_analytics.qr_start_ipc_s4)
[0m01:00:23.466908 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_start_ipc_s4
[0m01:00:23.469519 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:23.469784 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:00:23.470045 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m01:00:23.470797 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: Close
[0m01:00:23.470990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:23.471283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122497ef0>]}
[0m01:00:23.471797 [info ] [Thread-1 (]: 32 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [[32mCREATE VIEW[0m in 0.66s]
[0m01:00:23.472092 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_start_ipc_s1
[0m01:00:23.794777 [debug] [Thread-3 (]: SQL status: SELECT 91 in 0.612 seconds
[0m01:00:23.796377 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.796895 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_start_ipc_s2
[0m01:00:23.798832 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.799203 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.799371 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: BEGIN
[0m01:00:23.800214 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m01:00:23.800495 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.801049 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 2 with readable column names
-- Questionnaire ID: 58
-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "ipc_s2_phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "ipc_s2_gad7_total_meaning",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s2_ptsd_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as "ipc_s2_phq9_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as "ipc_s2_summary_when_1",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as "ipc_s2_most_distressing_symptoms",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as "ipc_s2_selected_problem_area",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as "ipc_s2_ptsd_total_meaning_toggle",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as "ipc_s2_gad7_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s2_taskid_session_2_navigator",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as "ipc_s2_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s2_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s2_taskid_session_3_navigator",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as "ipc_s2_have_you_proposed_the_interpersonal_formulation_in",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_provider_pdf",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s2_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as "ipc_s2_a4a9cad504db44e59a9d0f1bf40ca840",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s2_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s2_747188c84fc043ea92b49baa32567f73",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as "ipc_s2_did_the_person_ever_hit_kick_push_or_slap_you",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as "ipc_s2_do_you_agree_with_this",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ipc_session_2",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s2_3d2ccf9a0e7b48a0854044d43b6dacfe",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area_28",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s2_6fb0c7a5a21143ecaf7b5f1079399133",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_mood_rating_session_1_score",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s2_did_you_ever_hit_kick_push_or_slap_the_person",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as "ipc_s2_do_you_still_think_that",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s2_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s2_232484cf1aee4bfaa66e61494587a16a",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s2_9ed77f2a0d5a434db153d8deadfbc3f8",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s2_3bfee97a6a0e4cd0bdb77ffa8d36191f",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree_37",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__39",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__40",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__41",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as "ipc_s2_287593c3417445afa99871d249230943",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s2_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s2_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s2_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s2_665e1595f16948159d24dac265f1809b",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s2_bc8f199a59f04184864db1c0befd26df",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s2_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s2_e17756cd48614dde859cf90241977246",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s2_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as "ipc_s2_is_any_of_the_2_question_above_is_true",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as "ipc_s2_2ef63cf4b37e4216a8e1db6d1b91cc2a",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s2_3e0b76f9090243bab8580b1505e9d168",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s2_9cc2834b0d2843d08811509995cfcdb8",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s2_a7f10195b8594670abbca2498c4fe45f",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__57",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s2_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s2_547a07c2f94c4956997f0439626d0251",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s2_6c1b2aa7f2444d5abfc6e0faef33bfe6",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s2_a77f07b379134708a35414e503a948f1",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s2_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s2_example_skills_63",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s2_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s2_eb8828db167447e7ba9ae3c161160b65",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s2_example_skills_66",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s2_4c95559d86ff4b87a271e52388072a53",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s2_bed17079d1e54bbeaf073d7b6a86243e",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__69",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__70",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__71",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s2_example_skills_72",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s2_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__77",max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__78",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__79",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = 'task-id-013' then answer_value_text end) as "task-id-013",max(case when linkid = 'task-id-014' then answer_value_text end) as "task-id-014",max(case when linkid = 'task-id-015' then answer_value_text end) as "task-id-015",max(case when linkid = 'task-id-016' then answer_value_text end) as "task-id-016",max(case when linkid = 'task-id-018' then answer_value_text end) as "task-id-018"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m01:00:23.807667 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:00:23.809941 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.810189 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2" rename to "qr_start_ipc_s2__dbt_backup"
[0m01:00:23.812151 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:23.813783 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.813988 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp" rename to "qr_start_ipc_s2"
[0m01:00:23.815525 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:23.816265 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m01:00:23.816457 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.816610 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m01:00:23.817484 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:23.818669 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup"
[0m01:00:23.818916 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.819076 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup" cascade
[0m01:00:23.821341 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:00:23.822106 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: Close
[0m01:00:23.822565 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12278e720>]}
[0m01:00:23.823085 [info ] [Thread-3 (]: 33 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [[32mCREATE VIEW[0m in 0.64s]
[0m01:00:23.823432 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_start_ipc_s2
[0m01:00:23.932953 [debug] [Thread-2 (]: SQL status: SELECT 97 in 0.608 seconds
[0m01:00:23.934724 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.935330 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_start_ipc_s3
[0m01:00:23.937288 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.937766 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.937942 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: BEGIN
[0m01:00:23.938821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m01:00:23.939140 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.939759 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 3 with readable column names
-- Questionnaire ID: 208
-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as "ipc_s3_phq9_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as "ipc_s3_gad7_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as "ipc_s3_ptsd_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as "ipc_s3_ptsd_total_meaning",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s3_taskid_session_3_navigator",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s3_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s3_taskid_session_4_navigator",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as "ipc_s3_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s3_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_provider_pdf",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s3_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ipc_session_3",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_16",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s3_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_18",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s3_observation_id_of_mood_rating_session_3_score",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as "ipc_s3_1b59ddeb483d4b1baf53f3942204589a",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s3_did_you_ever_hit_kick_push_or_slap_the_personno",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s3_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_23",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as "ipc_s3_4554f4b2d15e47e7a10dd77939dd3afc",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_25",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as "ipc_s3_f9a9f4928eb84c718ec6f80ab596430b",max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__28",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__29",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__30",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s3_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as "ipc_s3_59744d4501004d62b1055cbecd973ffd",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as "ipc_s3_6b5fa4342fc34e4bad1189f6260a81f2",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as "ipc_s3_77fc70ba6cac494cb27a77ebce2289e5",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s3_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s3_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as "ipc_s3_has_anything_changed_since_the_last_time_we_met",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s3_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_40",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as "ipc_s3_4ad7384fa3324e4193180d3f9e540ee7",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as "ipc_s3_stage_identified_in_session_2",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_43",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_44",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_45",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as "ipc_s3_b24118e231c54e23af3a1722af72c299",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as "ipc_s3_68b3cbf5b9ef4da49ac1bcbc20f04473",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as "ipc_s3_9e995f48b09249b2a9e4c7e754e446e5",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__49",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s3_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as "ipc_s3_e8b8e5504d6542beacb92f4ac17c7f49",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s3_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s3_example_skills_53",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s3_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s3_example_skills_55",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_56",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_57",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_58",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s3_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_60",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as "ipc_s3_920de190557a423391a34bf293f18214",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as "ipc_s3_95121ef1bfe540ce841c524334644148",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as "ipc_s3_e1a13d53b867440f8622bccebf54f176",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s3_547a07c2f94c4956997f0439626d0251",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as "ipc_s3_8ac792f53f3c49d3a80063c662bf00cd",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__66",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__67",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__68",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s3_a77f07b379134708a35414e503a948f1",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s3_example_skills_70",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_71",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s3_4c95559d86ff4b87a271e52388072a53",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__73",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_77",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as "ipc_s3_8c82f7573f404b09bdf478ee376f75a8",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s3_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__82",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__83",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "gad7_total_meaning",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person_91",max(case when linkid = 'task-id-019' then answer_value_text end) as "task-id-019",max(case when linkid = 'task-id-020' then answer_value_text end) as "task-id-020",max(case when linkid = 'task-id-021' then answer_value_text end) as "task-id-021",max(case when linkid = 'task-id-022' then answer_value_text end) as "task-id-022",max(case when linkid = 'task-id-023' then answer_value_text end) as "task-id-023",max(case when linkid = 'task-id-024' then answer_value_text end) as "task-id-024"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m01:00:23.945991 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:00:23.947967 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.948160 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3" rename to "qr_start_ipc_s3__dbt_backup"
[0m01:00:23.949533 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:23.950914 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.951088 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp" rename to "qr_start_ipc_s3"
[0m01:00:23.952569 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:23.954384 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m01:00:23.954595 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.954757 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m01:00:23.955787 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:23.957003 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup"
[0m01:00:23.957259 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.957422 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup" cascade
[0m01:00:23.959617 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:00:23.960322 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: Close
[0m01:00:23.960606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12253e030>]}
[0m01:00:23.960929 [info ] [Thread-2 (]: 34 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m01:00:23.961267 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_start_ipc_s3
[0m01:00:24.067557 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.596 seconds
[0m01:00:24.068757 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.069359 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_start_ipc_s4
[0m01:00:24.071188 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.071560 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.071733 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: BEGIN
[0m01:00:24.072348 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m01:00:24.072561 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.072967 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 4 with readable column names
-- Questionnaire ID: 63
-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as "ipc_s4_phq9_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as "ipc_s4_gad7_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as "ipc_s4_ptsd_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s4_taskid_session_4_navigator",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_provider_pdf",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as "ipc_s4_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_client_pdf",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as "ipc_s4_what_we_know_is_that_symptoms_can_come_back_in_the",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s4_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as "ipc_s4_after_todays_session_i_can_refer_you_for_clinical_",max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as "ipc_s4_after_todays_session_i_will_be_referring_you_for_a",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri_14",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as "ipc_s4_how_does_it_make_you_feel_to_know_that_today_is_ou",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as "ipc_s4_how_do_you_feel_about_today_being_our_last_session",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as "ipc_s4_how_would_you_know_if_your_symptoms_are_coming_bac",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that_",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as "ipc_s4_please_select_how_you_would_like_to_proceed_with_t",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that__21",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s_22",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y_23",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s4_mood_rating_total",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as "ipc_s4_i_am_going_to_provide_you_with_our_agencys_contact",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard_28",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that_",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that__30",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as "ipc_s4_7fef53bc56db47ce8cba8efd4bcbc318",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "did_you_discuss_this_clients_severe_mental_health_screening",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "what_is_the_recommended_plan_to_address_the_probable_severe",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as "feeling_changed",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "referral_details_if_the_client_is_referred_out",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as "rerer",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as "20241031",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as "20250201",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as "is-connected-to-clinical-care-details",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as "is-connected-to-clinical-care-question"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m01:00:24.077020 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:00:24.079253 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.079473 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4" rename to "qr_start_ipc_s4__dbt_backup"
[0m01:00:24.080873 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:24.082293 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.082469 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp" rename to "qr_start_ipc_s4"
[0m01:00:24.083605 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:24.084417 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m01:00:24.084624 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.084798 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m01:00:24.086109 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:24.087221 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup"
[0m01:00:24.087464 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.087628 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup" cascade
[0m01:00:24.089184 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:00:24.089908 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: Close
[0m01:00:24.090196 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12254d1f0>]}
[0m01:00:24.090506 [info ] [Thread-4 (]: 35 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [[32mCREATE VIEW[0m in 0.62s]
[0m01:00:24.090774 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_start_ipc_s4
[0m01:00:24.091539 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:24.091721 [debug] [MainThread]: On master: BEGIN
[0m01:00:24.091870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:24.099959 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:00:24.100229 [debug] [MainThread]: On master: COMMIT
[0m01:00:24.100395 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:24.100538 [debug] [MainThread]: On master: COMMIT
[0m01:00:24.100883 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:24.101068 [debug] [MainThread]: On master: Close
[0m01:00:24.101300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:24.101441 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s1' was properly closed.
[0m01:00:24.101564 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s3' was properly closed.
[0m01:00:24.101679 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s2' was properly closed.
[0m01:00:24.101788 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s4' was properly closed.
[0m01:00:24.102047 [info ] [MainThread]: 
[0m01:00:24.102204 [info ] [MainThread]: Finished running 35 view models in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m01:00:24.104323 [debug] [MainThread]: Command end result
[0m01:00:24.130341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m01:00:24.131690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m01:00:24.136980 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m01:00:24.137227 [info ] [MainThread]: 
[0m01:00:24.137428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:24.137585 [info ] [MainThread]: 
[0m01:00:24.137752 [info ] [MainThread]: Done. PASS=35 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=35
[0m01:00:24.138105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8651004, "process_in_blocks": "0", "process_kernel_time": 0.23999, "process_mem_max_rss": "139935744", "process_out_blocks": "0", "process_user_time": 1.959722}
[0m01:00:24.138341 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:24.138297 after 6.87 seconds
[0m01:00:24.138540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106852090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227e5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106206690>]}
[0m01:00:24.138743 [debug] [MainThread]: Flushing usage events
[0m01:00:24.622006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:22.120150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e328d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528ce60>]}


============================== 08:56:22.124575 | d1da6f25-573f-4d55-a5ea-f8efbf024bf6 ==============================
[0m08:56:22.124575 [info ] [MainThread]: Running with dbt=1.10.11
[0m08:56:22.124912 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m08:56:22.137468 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m08:56:22.138681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.06328259, "process_in_blocks": "0", "process_kernel_time": 0.140712, "process_mem_max_rss": "104906752", "process_out_blocks": "0", "process_user_time": 0.6585}
[0m08:56:22.140465 [debug] [MainThread]: Command `dbt run` failed at 08:56:22.140352 after 0.07 seconds
[0m08:56:22.141264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104586a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d414f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528cfe0>]}
[0m08:56:22.142581 [debug] [MainThread]: Flushing usage events
[0m08:56:22.611369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:36.885599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107491bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11099b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a20f20>]}


============================== 08:57:36.889178 | ec06a64b-4d83-49c7-be3c-82af262d1702 ==============================
[0m08:57:36.889178 [info ] [MainThread]: Running with dbt=1.10.11
[0m08:57:36.889510 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m08:57:36.892297 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m08:57:36.892639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04285225, "process_in_blocks": "0", "process_kernel_time": 0.114381, "process_mem_max_rss": "105545728", "process_out_blocks": "0", "process_user_time": 0.652399}
[0m08:57:36.892889 [debug] [MainThread]: Command `dbt run` failed at 08:57:36.892848 after 0.04 seconds
[0m08:57:36.893049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a210a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108861b0>]}
[0m08:57:36.893210 [debug] [MainThread]: Flushing usage events
[0m08:57:37.117063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:41.654640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109399040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109398d70>]}


============================== 09:06:41.658196 | 92fa46f3-f040-4320-925a-7fa2e727d011 ==============================
[0m09:06:41.658196 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:06:41.658520 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:06:41.661489 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m09:06:41.661934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.045668084, "process_in_blocks": "0", "process_kernel_time": 0.100475, "process_mem_max_rss": "104710144", "process_out_blocks": "0", "process_user_time": 0.639013}
[0m09:06:41.662217 [debug] [MainThread]: Command `dbt run` failed at 09:06:41.662167 after 0.05 seconds
[0m09:06:41.662398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109398ef0>]}
[0m09:06:41.662575 [debug] [MainThread]: Flushing usage events
[0m09:06:41.916999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:01.826119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ed130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ece30>]}


============================== 09:10:01.830215 | def3d702-4732-42c3-ac76-285a5d0c87db ==============================
[0m09:10:01.830215 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:10:01.830540 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:10:01.833653 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m09:10:01.834014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.045539916, "process_in_blocks": "0", "process_kernel_time": 0.114911, "process_mem_max_rss": "104775680", "process_out_blocks": "0", "process_user_time": 0.66647}
[0m09:10:01.834275 [debug] [MainThread]: Command `dbt run` failed at 09:10:01.834226 after 0.05 seconds
[0m09:10:01.834444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ecf80>]}
[0m09:10:01.834603 [debug] [MainThread]: Flushing usage events
[0m09:10:02.080189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:55.629862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035c2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770d1c0>]}


============================== 09:11:55.632802 | 79af3a07-cdbc-4591-9056-6ac66072ba97 ==============================
[0m09:11:55.632802 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:11:55.633160 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:11:55.778303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79af3a07-cdbc-4591-9056-6ac66072ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6f800>]}
[0m09:11:55.807204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79af3a07-cdbc-4591-9056-6ac66072ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e15b0>]}
[0m09:11:55.807977 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:11:55.863094 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:11:55.961350 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m09:11:55.961779 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://seeds/questionnaire_metadata_old.csv
[0m09:11:56.004447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79af3a07-cdbc-4591-9056-6ac66072ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba6900>]}
[0m09:11:56.062873 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:11:56.064716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:11:56.079848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79af3a07-cdbc-4591-9056-6ac66072ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110efd5b0>]}
[0m09:11:56.080150 [info ] [MainThread]: Found 57 models, 1 seed, 12 sources, 558 macros
[0m09:11:56.080344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79af3a07-cdbc-4591-9056-6ac66072ba97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c6f30>]}
[0m09:11:56.082177 [info ] [MainThread]: 
[0m09:11:56.082388 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:11:56.082534 [info ] [MainThread]: 
[0m09:11:56.082805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:11:56.086118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:11:56.086501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:11:56.093420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:11:56.128227 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:11:56.128498 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:11:56.128680 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:11:56.128836 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:11:56.128997 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:11:56.129157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:56.129304 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:11:56.129442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:56.130857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:56.133196 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m09:11:56.133411 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m09:11:56.133651 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m09:11:56.134311 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:11:56.134500 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:11:56.134750 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:11:56.134958 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:11:56.135132 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:11:56.135288 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:11:56.135455 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:11:56.135619 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:11:56.135771 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m09:11:56.135928 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:11:56.136109 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:11:56.136258 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:11:56.136412 [debug] [ThreadPool]: On list_airbyte: No close available on handle
[0m09:11:56.136547 [debug] [ThreadPool]: On list_airbyte: No close available on handle
[0m09:11:56.136677 [debug] [ThreadPool]: On list_airbyte: No close available on handle
[0m09:11:56.137141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:56.137275 [debug] [MainThread]: Connection 'list_airbyte' was properly closed.
[0m09:11:56.137390 [debug] [MainThread]: Connection 'list_airbyte' was properly closed.
[0m09:11:56.137499 [debug] [MainThread]: Connection 'list_airbyte' was properly closed.
[0m09:11:56.137655 [info ] [MainThread]: 
[0m09:11:56.137814 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m09:11:56.138058 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m09:11:56.138381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5402665, "process_in_blocks": "0", "process_kernel_time": 0.1554, "process_mem_max_rss": "129581056", "process_out_blocks": "0", "process_user_time": 0.943068}
[0m09:11:56.138611 [debug] [MainThread]: Command `dbt run` failed at 09:11:56.138569 after 0.54 seconds
[0m09:11:56.138790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d38f80>]}
[0m09:11:56.138967 [debug] [MainThread]: Flushing usage events
[0m09:11:56.354563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:34.745095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041264b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781d160>]}


============================== 09:12:34.748905 | 38942c9c-dc9a-498a-8e4c-de5111be1eb7 ==============================
[0m09:12:34.748905 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:12:34.749257 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:12:34.848121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d892b0>]}
[0m09:12:34.877486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d475c0>]}
[0m09:12:34.878324 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:12:34.968871 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:12:35.061593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:35.061869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:35.083711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e208c0>]}
[0m09:12:35.130595 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:12:35.132143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:12:35.145420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ee7e0>]}
[0m09:12:35.145765 [info ] [MainThread]: Found 57 models, 1 seed, 12 sources, 558 macros
[0m09:12:35.145954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108452660>]}
[0m09:12:35.147919 [info ] [MainThread]: 
[0m09:12:35.148112 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:12:35.148253 [info ] [MainThread]: 
[0m09:12:35.148514 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:35.151607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:12:35.157535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:12:35.158810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:12:35.182564 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:12:35.182820 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:12:35.183015 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:12:35.183181 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:12:35.183345 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:12:35.183493 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:12:35.183651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:35.183788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:35.183918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:35.596831 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.413 seconds
[0m09:12:35.597362 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.413 seconds
[0m09:12:35.597626 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.414 seconds
[0m09:12:35.598881 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:12:35.599707 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:12:35.600475 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:12:35.604479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m09:12:35.609722 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:12:35.610209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m09:12:35.610443 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:12:35.610819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m09:12:35.612178 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:12:35.612441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:35.613638 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:12:35.613914 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:12:35.614273 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:12:35.614468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:35.614649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:35.637563 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m09:12:35.637938 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:12:35.638161 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:12:35.638622 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m09:12:35.638860 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m09:12:35.639042 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:12:35.639269 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:12:35.639525 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:12:35.639774 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:12:35.649001 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m09:12:35.649277 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.009 seconds
[0m09:12:35.649488 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.009 seconds
[0m09:12:35.650415 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:12:35.651522 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:12:35.652310 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:12:35.653049 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:12:35.653239 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:12:35.653418 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:12:35.662000 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:35.662235 [debug] [MainThread]: On master: BEGIN
[0m09:12:35.662399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:35.677945 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:12:35.678167 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:35.678394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:12:35.690439 [debug] [MainThread]: SQL status: SELECT 109 in 0.012 seconds
[0m09:12:35.699453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774380>]}
[0m09:12:35.699744 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:35.700559 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:35.700734 [debug] [MainThread]: On master: BEGIN
[0m09:12:35.701817 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:12:35.702175 [debug] [MainThread]: On master: COMMIT
[0m09:12:35.702418 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:35.702579 [debug] [MainThread]: On master: COMMIT
[0m09:12:35.703080 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:35.703243 [debug] [MainThread]: On master: Close
[0m09:12:35.705419 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m09:12:35.705725 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m09:12:35.705935 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m09:12:35.706395 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m09:12:35.706235 [info ] [Thread-1 (]: 1 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m09:12:35.706758 [info ] [Thread-2 (]: 2 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m09:12:35.707047 [info ] [Thread-3 (]: 3 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m09:12:35.707299 [info ] [Thread-4 (]: 4 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m09:12:35.707688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_careplans)
[0m09:12:35.707915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_careteams)
[0m09:12:35.708110 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_encounter)
[0m09:12:35.708347 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m09:12:35.708531 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m09:12:35.708712 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m09:12:35.708876 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m09:12:35.709039 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m09:12:35.717544 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m09:12:35.719720 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m09:12:35.722963 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m09:12:35.725623 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m09:12:35.727052 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m09:12:35.740505 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m09:12:35.746333 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m09:12:35.746654 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m09:12:35.775463 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:12:35.776279 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:12:35.776622 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:12:35.778496 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:12:35.778761 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

    
  
    

  create temporary table "stg_careplans__dbt_tmp091235760691"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans")

  );
  
  
[0m09:12:35.778992 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

    
  
    

  create temporary table "stg_encounter__dbt_tmp091235757661"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter")

  );
  
  
[0m09:12:35.779206 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

    
  
    

  create temporary table "stg_careteams__dbt_tmp091235767237"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams")

  );
  
  
[0m09:12:35.779409 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

    
  
    

  create temporary table "stg_locations__dbt_tmp091235777858"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations")

  );
  
  
[0m09:12:35.779626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:35.779772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:35.779912 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:35.780051 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:12:35.819803 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.040 seconds
[0m09:12:35.820155 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.040 seconds
[0m09:12:35.855028 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.075 seconds
[0m09:12:35.855368 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.076 seconds
[0m09:12:35.858861 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:12:35.860496 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:12:35.861855 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:12:35.863133 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:12:35.863326 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m09:12:35.863529 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m09:12:35.863786 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m09:12:35.863969 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m09:12:35.864861 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:35.865120 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:35.865380 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:35.865533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:35.865686 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:12:35.865864 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:12:35.866034 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:12:35.866187 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:12:35.866360 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter__dbt_tmp091235757661'
        
      order by ordinal_position

  
[0m09:12:35.866548 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams__dbt_tmp091235767237'
        
      order by ordinal_position

  
[0m09:12:35.866728 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations__dbt_tmp091235777858'
        
      order by ordinal_position

  
[0m09:12:35.866958 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans__dbt_tmp091235760691'
        
      order by ordinal_position

  
[0m09:12:35.880291 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.013 seconds
[0m09:12:35.880607 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.013 seconds
[0m09:12:35.880798 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.013 seconds
[0m09:12:35.880988 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.014 seconds
[0m09:12:35.883814 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:12:35.885725 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:12:35.887520 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:12:35.889208 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:12:35.889446 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.889687 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.889945 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.890184 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.892311 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:12:35.892567 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:12:35.892797 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:12:35.892959 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m09:12:35.896791 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:12:35.898349 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:12:35.900756 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:12:35.902280 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:12:35.902490 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.902685 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.902870 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.903085 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.905023 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:12:35.905292 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:12:35.911800 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.008 seconds
[0m09:12:35.912895 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m09:12:35.913091 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.010 seconds
[0m09:12:35.914095 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m09:12:35.915000 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m09:12:35.916017 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m09:12:35.916450 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:12:35.916837 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careteams__dbt_tmp091235767237" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" ("id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource")
    (
        select "id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource"
        from "stg_careteams__dbt_tmp091235767237"
    )
  
[0m09:12:35.917161 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:12:35.917385 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_encounter__dbt_tmp091235757661" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" ("id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at"
        from "stg_encounter__dbt_tmp091235757661"
    )
  
[0m09:12:35.917654 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:12:35.917911 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careplans__dbt_tmp091235760691" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" ("id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at"
        from "stg_careplans__dbt_tmp091235760691"
    )
  
[0m09:12:35.918194 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:12:35.918437 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_locations__dbt_tmp091235777858" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" ("id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference")
    (
        select "id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference"
        from "stg_locations__dbt_tmp091235777858"
    )
  
[0m09:12:35.918870 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:12:35.925779 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.008 seconds
[0m09:12:35.926102 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:12:35.926303 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.008 seconds
[0m09:12:35.926998 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:12:35.927183 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.009 seconds
[0m09:12:35.927395 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:12:35.927987 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:12:35.928176 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:12:35.928820 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:12:35.928994 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:12:35.929172 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:12:35.929334 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:12:35.929491 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:12:35.929663 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:12:35.929857 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:12:35.930944 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:35.931169 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:35.931355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:35.932395 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m09:12:35.932569 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:12:35.932922 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m09:12:35.933235 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m09:12:35.933546 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m09:12:35.935140 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dc290>]}
[0m09:12:35.935472 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077df200>]}
[0m09:12:35.935700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087aa330>]}
[0m09:12:35.935969 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7dc70>]}
[0m09:12:35.936343 [info ] [Thread-2 (]: 2 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mINSERT 0 0[0m in 0.23s]
[0m09:12:35.936673 [info ] [Thread-4 (]: 4 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mINSERT 0 0[0m in 0.23s]
[0m09:12:35.936997 [info ] [Thread-1 (]: 1 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mINSERT 0 0[0m in 0.23s]
[0m09:12:35.937467 [info ] [Thread-3 (]: 3 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mINSERT 0 0[0m in 0.23s]
[0m09:12:35.937830 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m09:12:35.938177 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m09:12:35.938494 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m09:12:35.938774 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m09:12:35.939007 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m09:12:35.939259 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_organizations
[0m09:12:35.939496 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_patient
[0m09:12:35.939695 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_practitioner
[0m09:12:35.939942 [info ] [Thread-2 (]: 5 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m09:12:35.940165 [info ] [Thread-4 (]: 6 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m09:12:35.940391 [info ] [Thread-1 (]: 7 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m09:12:35.940668 [info ] [Thread-3 (]: 8 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m09:12:35.940928 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_organization_affiliations)
[0m09:12:35.941127 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_organizations)
[0m09:12:35.941297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_patient)
[0m09:12:35.941458 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_practitioner)
[0m09:12:35.941624 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m09:12:35.941784 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_organizations
[0m09:12:35.941935 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_patient
[0m09:12:35.942088 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m09:12:35.944515 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.946927 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m09:12:35.949212 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m09:12:35.951162 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m09:12:35.951710 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m09:12:35.953515 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.953734 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

    
  
    

  create temporary table "stg_organization_affiliations__dbt_tmp091235952763"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations")

  );
  
  
[0m09:12:35.954002 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:35.954205 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_practitioner
[0m09:12:35.954484 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_patient
[0m09:12:35.954721 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_organizations
[0m09:12:35.957582 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:12:35.959651 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:12:35.961479 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:12:35.961754 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

    
  
    

  create temporary table "stg_practitioner__dbt_tmp091235956914"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner")

  );
  
  
[0m09:12:35.962060 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

    
  
    

  create temporary table "stg_patient__dbt_tmp091235958900"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient")

  );
  
  
[0m09:12:35.962383 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

    
  
    

  create temporary table "stg_organizations__dbt_tmp091235960802"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  -- this filter will only be applied on an incremental run
   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations")

  );
  
  
[0m09:12:35.962658 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:35.962880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:35.963139 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:35.970289 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.016 seconds
[0m09:12:35.972132 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.972419 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m09:12:35.972992 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:35.973238 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.973425 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations__dbt_tmp091235952763'
        
      order by ordinal_position

  
[0m09:12:35.977765 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:12:35.979473 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.979690 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.981520 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:12:35.983043 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.983252 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:35.985006 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:12:35.986040 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.987222 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.987523 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organization_affiliations__dbt_tmp091235952763" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" ("id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at"
        from "stg_organization_affiliations__dbt_tmp091235952763"
    )
  
[0m09:12:35.988633 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:12:35.989441 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:12:35.989705 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:12:35.989886 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:12:35.990310 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.027 seconds
[0m09:12:35.991998 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:12:35.992223 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.030 seconds
[0m09:12:35.992429 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:35.992613 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m09:12:35.994212 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:12:35.994703 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m09:12:35.994963 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m09:12:35.995274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cccf80>]}
[0m09:12:35.995511 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:35.995926 [info ] [Thread-2 (]: 5 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mINSERT 0 0[0m in 0.05s]
[0m09:12:35.996209 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:12:35.996430 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:35.996798 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m09:12:35.997079 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations__dbt_tmp091235960802'
        
      order by ordinal_position

  
[0m09:12:35.997280 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:12:35.997484 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m09:12:35.997851 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner__dbt_tmp091235956914'
        
      order by ordinal_position

  
[0m09:12:35.998151 [info ] [Thread-2 (]: 9 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m09:12:35.998543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_practitioner_roles)
[0m09:12:35.998746 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m09:12:36.001830 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.002151 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.039 seconds
[0m09:12:36.002501 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m09:12:36.004150 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:12:36.006044 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:12:36.006332 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.008 seconds
[0m09:12:36.006591 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: BEGIN
[0m09:12:36.006869 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m09:12:36.007113 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.008868 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:12:36.010811 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.011067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m09:12:36.011341 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.011577 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

    
  
    

  create temporary table "stg_practitioner_roles__dbt_tmp091236010137"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles")

  );
  
  
[0m09:12:36.011798 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:12:36.011987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:36.012208 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient__dbt_tmp091235958900'
        
      order by ordinal_position

  
[0m09:12:36.013264 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:12:36.015020 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:12:36.015286 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.003 seconds
[0m09:12:36.015551 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.017357 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:12:36.017595 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.005 seconds
[0m09:12:36.017843 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.019593 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:12:36.019896 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:12:36.020217 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.021432 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m09:12:36.022050 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:12:36.023048 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m09:12:36.023433 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:12:36.023675 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organizations__dbt_tmp091235960802" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" ("id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at")
    (
        select "id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at"
        from "stg_organizations__dbt_tmp091235960802"
    )
  
[0m09:12:36.023924 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.002 seconds
[0m09:12:36.025629 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:12:36.025862 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:12:36.026114 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:12:36.026330 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.027120 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:12:36.027353 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner__dbt_tmp091235956914" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" ("id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at"
        from "stg_practitioner__dbt_tmp091235956914"
    )
  
[0m09:12:36.027624 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:12:36.027815 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:12:36.028527 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:36.028730 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:12:36.029135 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: Close
[0m09:12:36.029782 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:12:36.029980 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.002 seconds
[0m09:12:36.030230 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.018 seconds
[0m09:12:36.030553 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774170>]}
[0m09:12:36.030776 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:12:36.033009 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m09:12:36.034484 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.034849 [info ] [Thread-4 (]: 6 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mINSERT 0 0[0m in 0.09s]
[0m09:12:36.035064 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:12:36.035308 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m09:12:36.035580 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_organizations
[0m09:12:36.035860 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m09:12:36.036130 [info ] [Thread-4 (]: 10 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m09:12:36.036361 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_questionnaire_response)
[0m09:12:36.036599 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:12:36.036773 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m09:12:36.036995 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_patient__dbt_tmp091235958900" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" ("id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at")
    (
        select "id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at"
        from "stg_patient__dbt_tmp091235958900"
    )
  
[0m09:12:36.039040 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.039712 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m09:12:36.041900 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.042140 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m09:12:36.042363 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

    
  
    

  create temporary table "stg_questionnaire_response__dbt_tmp091236040959"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response")

  );
  
  
[0m09:12:36.042652 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m09:12:36.042854 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.043030 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:36.043244 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m09:12:36.043704 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: Close
[0m09:12:36.043972 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles__dbt_tmp091236010137'
        
      order by ordinal_position

  
[0m09:12:36.044868 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:12:36.045192 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:12:36.045617 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4cdd0>]}
[0m09:12:36.046046 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:12:36.046483 [info ] [Thread-3 (]: 8 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mINSERT 0 0[0m in 0.10s]
[0m09:12:36.046941 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_practitioner
[0m09:12:36.047212 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_task
[0m09:12:36.047829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:36.047585 [info ] [Thread-3 (]: 11 of 57 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m09:12:36.048389 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: Close
[0m09:12:36.048632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.stg_task)
[0m09:12:36.048850 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_task
[0m09:12:36.049113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072086e0>]}
[0m09:12:36.051647 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m09:12:36.051921 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.007 seconds
[0m09:12:36.052300 [info ] [Thread-1 (]: 7 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mINSERT 0 0[0m in 0.11s]
[0m09:12:36.054279 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.054704 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_patient
[0m09:12:36.054978 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.055231 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_task
[0m09:12:36.055506 [debug] [Thread-1 (]: Began running node model.engage_analytics.unnested_careteams
[0m09:12:36.057787 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:12:36.058025 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:12:36.058277 [info ] [Thread-1 (]: 12 of 57 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m09:12:36.058603 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

    
  
    

  create temporary table "stg_task__dbt_tmp091236056941"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task")

  );
  
  
[0m09:12:36.060435 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.060658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.unnested_careteams)
[0m09:12:36.060962 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:36.061280 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.061537 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m09:12:36.063558 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m09:12:36.063890 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:12:36.065167 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.065545 [debug] [Thread-1 (]: Began executing node model.engage_analytics.unnested_careteams
[0m09:12:36.075875 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m09:12:36.076272 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.076666 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner_roles__dbt_tmp091236010137" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" ("id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at"
        from "stg_practitioner_roles__dbt_tmp091236010137"
    )
  
[0m09:12:36.080550 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:12:36.080837 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:12:36.081052 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m09:12:36.081958 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:12:36.082192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:36.082425 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:12:36.082714 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:12:36.082913 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.040 seconds
[0m09:12:36.084667 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.084913 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m09:12:36.085180 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:36.085576 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m09:12:36.085806 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:36.086050 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.086246 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response__dbt_tmp091236040959'
        
      order by ordinal_position

  
[0m09:12:36.086587 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c99160>]}
[0m09:12:36.087066 [info ] [Thread-2 (]: 9 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mINSERT 0 0[0m in 0.09s]
[0m09:12:36.087490 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m09:12:36.087700 [debug] [Thread-2 (]: Began running node model.engage_analytics.encounters
[0m09:12:36.088067 [info ] [Thread-2 (]: 13 of 57 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m09:12:36.088322 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.encounters)
[0m09:12:36.088507 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.encounters
[0m09:12:36.094103 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.007 seconds
[0m09:12:36.099444 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.101206 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.101574 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m09:12:36.101849 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.102164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:12:36.102411 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:36.102732 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:12:36.103057 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m09:12:36.104741 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.002 seconds
[0m09:12:36.106760 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.107149 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.109236 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.002 seconds
[0m09:12:36.110383 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.112406 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.112719 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_questionnaire_response__dbt_tmp091236040959" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" ("id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at")
    (
        select "id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at"
        from "stg_questionnaire_response__dbt_tmp091236040959"
    )
  
[0m09:12:36.116590 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m09:12:36.117688 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:12:36.117920 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:12:36.118093 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:12:36.118315 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:12:36.121652 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:12:36.121939 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:12:36.122233 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams" rename to "unnested_careteams__dbt_backup"
[0m09:12:36.122790 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m09:12:36.123235 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a8440>]}
[0m09:12:36.123599 [info ] [Thread-4 (]: 10 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mINSERT 0 0[0m in 0.09s]
[0m09:12:36.123888 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m09:12:36.124085 [debug] [Thread-4 (]: Began running node model.engage_analytics.organization_affiliations
[0m09:12:36.124417 [info ] [Thread-4 (]: 14 of 57 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m09:12:36.124729 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.organization_affiliations)
[0m09:12:36.125029 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m09:12:36.127379 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m09:12:36.129213 [debug] [Thread-4 (]: Began executing node model.engage_analytics.organization_affiliations
[0m09:12:36.131504 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:12:36.131751 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

    
  
    

  create temporary table "organization_affiliations__dbt_tmp091236130720"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

where s._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
)

  );
  
  
[0m09:12:36.131937 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:36.139991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m09:12:36.142760 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:12:36.143126 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.041 seconds
[0m09:12:36.143443 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m09:12:36.144476 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.144818 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m09:12:36.145301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:36.147238 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:12:36.147484 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:12:36.147656 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:12:36.148313 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:12:36.149061 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.149259 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m09:12:36.151614 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.002 seconds
[0m09:12:36.152244 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.152425 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m09:12:36.154097 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:12:36.155794 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m09:12:36.156212 [debug] [Thread-2 (]: Began executing node model.engage_analytics.encounters
[0m09:12:36.158674 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.158947 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.027 seconds
[0m09:12:36.159139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m09:12:36.159469 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    
  
    

  create temporary table "encounters__dbt_tmp091236157681"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."encounters")

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

where e._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
)

  );
  
  
[0m09:12:36.161217 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:12:36.166007 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m09:12:36.167379 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m09:12:36.170954 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:12:36.171346 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m09:12:36.173462 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:12:36.173736 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:12:36.174031 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations__dbt_tmp091236130720'
        
      order by ordinal_position

  
[0m09:12:36.182374 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.008 seconds
[0m09:12:36.185876 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:12:36.186642 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:12:36.187092 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.190269 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: Close
[0m09:12:36.191030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b11280>]}
[0m09:12:36.192122 [info ] [Thread-1 (]: 12 of 57 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.13s]
[0m09:12:36.194406 [debug] [Thread-1 (]: Finished running node model.engage_analytics.unnested_careteams
[0m09:12:36.194722 [debug] [Thread-1 (]: Began running node model.engage_analytics.organizations
[0m09:12:36.195467 [info ] [Thread-1 (]: 15 of 57 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m09:12:36.195767 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.005 seconds
[0m09:12:36.196054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.organizations)
[0m09:12:36.197630 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.030 seconds
[0m09:12:36.202877 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:12:36.206193 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.organizations
[0m09:12:36.211409 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.228190 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.230320 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:12:36.235723 [debug] [Thread-2 (]: On model.engage_analytics.encounters: BEGIN
[0m09:12:36.236146 [debug] [Thread-1 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m09:12:36.236437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:36.237012 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:36.237478 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.238284 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'encounters__dbt_tmp091236157681'
        
      order by ordinal_position

  
[0m09:12:36.238628 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.003 seconds
[0m09:12:36.239833 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m09:12:36.240501 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:12:36.240752 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organization_affiliations__dbt_tmp091236130720" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" ("id", "organization_id", "location_id", "_airbyte_emitted_at")
    (
        select "id", "organization_id", "location_id", "_airbyte_emitted_at"
        from "organization_affiliations__dbt_tmp091236130720"
    )
  
[0m09:12:36.241893 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:12:36.242699 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:12:36.242982 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:12:36.243235 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:12:36.243437 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.005 seconds
[0m09:12:36.245948 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.246149 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.248426 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:12:36.250266 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.250495 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.252494 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m09:12:36.252773 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:12:36.253871 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m09:12:36.255225 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m09:12:36.255699 [debug] [Thread-1 (]: Began executing node model.engage_analytics.organizations
[0m09:12:36.257801 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:12:36.258046 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.258272 [debug] [Thread-1 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    
  
    

  create temporary table "organizations__dbt_tmp091236257017"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

where o._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
)

  );
  
  
[0m09:12:36.258534 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."encounters" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "encounters__dbt_tmp091236157681" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."encounters" ("id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at")
    (
        select "id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at"
        from "encounters__dbt_tmp091236157681"
    )
  
[0m09:12:36.279652 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:12:36.280003 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.021 seconds
[0m09:12:36.281628 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:12:36.281912 [debug] [Thread-4 (]: SQL status: COMMIT in 0.038 seconds
[0m09:12:36.282618 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m09:12:36.282825 [debug] [Thread-1 (]: On model.engage_analytics.organizations: BEGIN
[0m09:12:36.283247 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: Close
[0m09:12:36.283426 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:12:36.283724 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m09:12:36.284166 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d368a0>]}
[0m09:12:36.284426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:36.284990 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:12:36.285222 [debug] [Thread-1 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organizations__dbt_tmp091236257017'
        
      order by ordinal_position

  
[0m09:12:36.284776 [info ] [Thread-4 (]: 14 of 57 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mINSERT 0 0[0m in 0.16s]
[0m09:12:36.285592 [debug] [Thread-4 (]: Finished running node model.engage_analytics.organization_affiliations
[0m09:12:36.285810 [debug] [Thread-4 (]: Began running node model.engage_analytics.patient
[0m09:12:36.286121 [info ] [Thread-4 (]: 16 of 57 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m09:12:36.286439 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.patient)
[0m09:12:36.286631 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.patient
[0m09:12:36.289137 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m09:12:36.289438 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:12:36.291207 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:12:36.291561 [debug] [Thread-1 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.292064 [debug] [Thread-4 (]: Began executing node model.engage_analytics.patient
[0m09:12:36.294358 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:12:36.294661 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m09:12:36.295032 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp091236293388"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m09:12:36.295338 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:12:36.295742 [debug] [Thread-2 (]: On model.engage_analytics.encounters: Close
[0m09:12:36.295961 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:36.297827 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:12:36.298298 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6b260>]}
[0m09:12:36.298561 [debug] [Thread-1 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.299029 [info ] [Thread-2 (]: 13 of 57 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mINSERT 0 0[0m in 0.21s]
[0m09:12:36.299420 [debug] [Thread-2 (]: Finished running node model.engage_analytics.encounters
[0m09:12:36.299632 [debug] [Thread-2 (]: Began running node model.engage_analytics.practitioner_role
[0m09:12:36.299900 [info ] [Thread-2 (]: 17 of 57 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m09:12:36.300121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.practitioner_role)
[0m09:12:36.300292 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.practitioner_role
[0m09:12:36.302486 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m09:12:36.302763 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:12:36.304806 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m09:12:36.305208 [debug] [Thread-2 (]: Began executing node model.engage_analytics.practitioner_role
[0m09:12:36.307288 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:12:36.307560 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

    
  
    

  create temporary table "practitioner_role__dbt_tmp091236306538"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

where spr._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01')
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
)

  );
  
  
[0m09:12:36.307904 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:12:36.308081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:36.308283 [debug] [Thread-1 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organizations__dbt_tmp091236257017" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organizations" ("id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at")
    (
        select "id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at"
        from "organizations__dbt_tmp091236257017"
    )
  
[0m09:12:36.309838 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:12:36.310846 [debug] [Thread-1 (]: On model.engage_analytics.organizations: COMMIT
[0m09:12:36.311108 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:12:36.311279 [debug] [Thread-1 (]: On model.engage_analytics.organizations: COMMIT
[0m09:12:36.314840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:12:36.315358 [debug] [Thread-1 (]: On model.engage_analytics.organizations: Close
[0m09:12:36.315704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8bf50>]}
[0m09:12:36.316053 [info ] [Thread-1 (]: 15 of 57 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mINSERT 0 0[0m in 0.12s]
[0m09:12:36.316343 [debug] [Thread-1 (]: Finished running node model.engage_analytics.organizations
[0m09:12:36.316544 [debug] [Thread-1 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m09:12:36.316794 [info ] [Thread-1 (]: 18 of 57 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m09:12:36.317005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.int_qr_answers_long)
[0m09:12:36.317178 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m09:12:36.318976 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m09:12:36.319430 [debug] [Thread-1 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m09:12:36.321180 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m09:12:36.321748 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:12:36.322210 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m09:12:36.322395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:36.328673 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:12:36.330467 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:12:36.330721 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.035 seconds
[0m09:12:36.330997 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m09:12:36.332454 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:12:36.332795 [debug] [Thread-4 (]: On model.engage_analytics.patient: BEGIN
[0m09:12:36.333408 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:36.333622 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:12:36.333825 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:36.334025 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role__dbt_tmp091236306538'
        
      order by ordinal_position

  
[0m09:12:36.334273 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:12:36.334496 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp091236293388'
        
      order by ordinal_position

  
[0m09:12:36.338793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:12:36.339144 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.005 seconds
[0m09:12:36.339354 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.005 seconds
[0m09:12:36.339517 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:12:36.341216 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:12:36.342678 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:12:36.343000 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m09:12:36.343378 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.343637 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.345968 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:12:36.346219 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:12:36.347958 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:12:36.350248 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:12:36.350469 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.350667 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.352557 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:12:36.352819 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:12:36.353978 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m09:12:36.355015 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m09:12:36.355316 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:12:36.357198 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:12:36.357521 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" rename to "int_qr_answers_long__dbt_backup"
[0m09:12:36.357845 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:12:36.358086 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp091236293388" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp091236293388"
    )
  
[0m09:12:36.358346 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:12:36.358565 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioner_role__dbt_tmp091236306538" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" ("id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at")
    (
        select "id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at"
        from "practitioner_role__dbt_tmp091236306538"
    )
  
[0m09:12:36.363110 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m09:12:36.363364 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m09:12:36.364054 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:12:36.364730 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m09:12:36.364928 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:12:36.365128 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:12:36.365303 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:12:36.365473 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m09:12:36.369267 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m09:12:36.369513 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:12:36.369936 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: Close
[0m09:12:36.370113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m09:12:36.370440 [debug] [Thread-4 (]: On model.engage_analytics.patient: Close
[0m09:12:36.370749 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3dd90>]}
[0m09:12:36.372180 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:12:36.372437 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9d7c0>]}
[0m09:12:36.372807 [info ] [Thread-2 (]: 17 of 57 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mINSERT 0 0[0m in 0.07s]
[0m09:12:36.373083 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m09:12:36.373411 [info ] [Thread-4 (]: 16 of 57 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.09s]
[0m09:12:36.373680 [debug] [Thread-2 (]: Finished running node model.engage_analytics.practitioner_role
[0m09:12:36.373999 [debug] [Thread-4 (]: Finished running node model.engage_analytics.patient
[0m09:12:36.374228 [debug] [Thread-2 (]: Began running node model.engage_analytics.int_qr_header
[0m09:12:36.374442 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_tags
[0m09:12:36.374721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:36.374963 [info ] [Thread-2 (]: 19 of 57 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m09:12:36.375910 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:12:36.375169 [info ] [Thread-4 (]: 20 of 57 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m09:12:36.376338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.int_qr_header)
[0m09:12:36.376545 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:12:36.376722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.int_qr_tags)
[0m09:12:36.376896 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.int_qr_header
[0m09:12:36.377053 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:12:36.377259 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m09:12:36.378789 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m09:12:36.380533 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m09:12:36.381030 [debug] [Thread-2 (]: Began executing node model.engage_analytics.int_qr_header
[0m09:12:36.382501 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m09:12:36.382820 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_tags
[0m09:12:36.384912 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:12:36.385162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m09:12:36.385459 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

    
  
    

  create temporary table "int_qr_tags__dbt_tmp091236384144"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags")

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m09:12:36.387231 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m09:12:36.387469 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:36.387717 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:12:36.388027 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:12:36.388282 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m09:12:36.388464 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m09:12:36.388716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:36.406037 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m09:12:36.406328 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:12:36.406535 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m09:12:36.407927 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:12:36.409882 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:12:36.410104 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" rename to "int_qr_header__dbt_backup"
[0m09:12:36.410890 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:36.413362 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:12:36.413600 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m09:12:36.414001 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.027 seconds
[0m09:12:36.415614 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:12:36.415828 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:36.416047 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m09:12:36.416847 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:12:36.417126 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:12:36.417356 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:12:36.417598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:36.417785 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:12:36.417952 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags__dbt_tmp091236384144'
        
      order by ordinal_position

  
[0m09:12:36.422242 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.004 seconds
[0m09:12:36.424149 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:12:36.424429 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:12:36.424715 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m09:12:36.425902 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m09:12:36.426190 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:12:36.426368 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m09:12:36.427325 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.002 seconds
[0m09:12:36.429073 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:12:36.429299 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:12:36.432739 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.003 seconds
[0m09:12:36.434169 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m09:12:36.434719 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:12:36.434949 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" as DBT_INTERNAL_DEST
        where (resource_id) in (
            select distinct resource_id
            from "int_qr_tags__dbt_tmp091236384144" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" ("resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version")
    (
        select "resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version"
        from "int_qr_tags__dbt_tmp091236384144"
    )
  
[0m09:12:36.436720 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:12:36.437625 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:12:36.437842 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:12:36.438014 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:12:36.439336 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:36.439745 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: Close
[0m09:12:36.440029 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d75fd0>]}
[0m09:12:36.440343 [info ] [Thread-4 (]: 20 of 57 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mINSERT 0 0[0m in 0.06s]
[0m09:12:36.440598 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_tags
[0m09:12:36.440783 [debug] [Thread-4 (]: Began running node model.engage_analytics.current_practitioner_role
[0m09:12:36.441128 [info ] [Thread-4 (]: 21 of 57 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m09:12:36.441458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.current_practitioner_role)
[0m09:12:36.441666 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m09:12:36.443168 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m09:12:36.443627 [debug] [Thread-4 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m09:12:36.445176 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m09:12:36.445528 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:12:36.445692 [debug] [Thread-4 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m09:12:36.445838 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:36.460291 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m09:12:36.460584 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:12:36.460799 [debug] [Thread-4 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m09:12:36.468346 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:12:36.470193 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:12:36.470403 [debug] [Thread-4 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" rename to "current_practitioner_role__dbt_backup"
[0m09:12:36.471545 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:36.473032 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:12:36.473214 [debug] [Thread-4 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m09:12:36.474008 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:36.474886 [debug] [Thread-4 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:12:36.475109 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:12:36.475289 [debug] [Thread-4 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:12:36.479237 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:12:36.481526 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m09:12:36.481856 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:12:36.482034 [debug] [Thread-4 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m09:12:36.484946 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:12:36.485700 [debug] [Thread-4 (]: On model.engage_analytics.current_practitioner_role: Close
[0m09:12:36.486066 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0a600>]}
[0m09:12:36.486447 [info ] [Thread-4 (]: 21 of 57 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.04s]
[0m09:12:36.486738 [debug] [Thread-4 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m09:12:36.487183 [debug] [Thread-4 (]: Began running node model.engage_analytics.practitioners
[0m09:12:36.487486 [info ] [Thread-4 (]: 22 of 57 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m09:12:36.487721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.practitioners)
[0m09:12:36.487929 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.practitioners
[0m09:12:36.490077 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.490309 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m09:12:36.490501 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:36.507631 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.017 seconds
[0m09:12:36.508571 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.508867 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m09:12:36.509666 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.001 seconds
[0m09:12:36.510726 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m09:12:36.511218 [debug] [Thread-4 (]: Began executing node model.engage_analytics.practitioners
[0m09:12:36.513083 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.513331 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    
  
    

  create temporary table "practitioners__dbt_tmp091236512439"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

where p._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
)

  );
  
  
[0m09:12:36.530340 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.141 seconds
[0m09:12:36.531255 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m09:12:36.531478 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.018 seconds
[0m09:12:36.531810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c64c20>]}
[0m09:12:36.531994 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.105 seconds
[0m09:12:36.533517 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.534038 [info ] [Thread-1 (]: 18 of 57 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.21s]
[0m09:12:36.534693 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: Close
[0m09:12:36.534966 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: BEGIN
[0m09:12:36.535359 [debug] [Thread-1 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m09:12:36.535734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a965a0>]}
[0m09:12:36.536229 [info ] [Thread-2 (]: 19 of 57 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.16s]
[0m09:12:36.536529 [debug] [Thread-2 (]: Finished running node model.engage_analytics.int_qr_header
[0m09:12:36.536741 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:36.537043 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.537612 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioners__dbt_tmp091236512439'
        
      order by ordinal_position

  
[0m09:12:36.537960 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m09:12:36.538178 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:12:36.538482 [info ] [Thread-1 (]: 23 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m09:12:36.538989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.qr_1_month_follow_up)
[0m09:12:36.538731 [info ] [Thread-2 (]: 24 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [RUN]
[0m09:12:36.539395 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m09:12:36.539645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.qr_common_mental_health_symptoms)
[0m09:12:36.547110 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.009 seconds
[0m09:12:36.547558 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:12:36.547831 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:12:36.549769 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.550051 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:36.552503 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:12:36.552719 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.552961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:36.553299 [debug] [Thread-2 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:36.553761 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:36.555868 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:12:36.557917 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.558255 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:12:36.560288 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:12:36.561567 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m09:12:36.562063 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.562259 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioners__dbt_tmp091236512439" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" ("id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role")
    (
        select "id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role"
        from "practitioners__dbt_tmp091236512439"
    )
  
[0m09:12:36.568993 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m09:12:36.569892 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:12:36.570160 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:12:36.570337 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:12:36.572799 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:36.573270 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: Close
[0m09:12:36.573621 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e22600>]}
[0m09:12:36.573986 [info ] [Thread-4 (]: 22 of 57 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mINSERT 0 0[0m in 0.09s]
[0m09:12:36.574373 [debug] [Thread-4 (]: Finished running node model.engage_analytics.practitioners
[0m09:12:36.574667 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_confidential_s1
[0m09:12:36.574932 [info ] [Thread-4 (]: 25 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [RUN]
[0m09:12:36.575198 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioners, now model.engage_analytics.qr_confidential_s1)
[0m09:12:36.575387 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_confidential_s1
[0m09:12:36.578750 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:12:36.579112 [debug] [Thread-4 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:36.579404 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:36.611437 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.550 seconds
[0m09:12:36.613351 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:12:36.613607 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: BEGIN
[0m09:12:36.614229 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:36.614430 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:12:36.614608 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_task__dbt_tmp091236056941'
        
      order by ordinal_position

  
[0m09:12:36.619373 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.005 seconds
[0m09:12:36.621256 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:12:36.621507 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.624059 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:12:36.625868 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:12:36.626079 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:12:36.628167 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:12:36.629466 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m09:12:36.629925 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:12:36.630123 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_task__dbt_tmp091236056941" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" ("id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at")
    (
        select "id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at"
        from "stg_task__dbt_tmp091236056941"
    )
  
[0m09:12:36.631170 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:12:36.631800 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:12:36.631984 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:12:36.632135 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:12:36.633848 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:36.634204 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: Close
[0m09:12:36.634492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4f440>]}
[0m09:12:36.634815 [info ] [Thread-3 (]: 11 of 57 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mINSERT 0 0[0m in 0.59s]
[0m09:12:36.635086 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_task
[0m09:12:36.635274 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_financial_wellness_tool
[0m09:12:36.635517 [info ] [Thread-3 (]: 26 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [RUN]
[0m09:12:36.635712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.qr_financial_wellness_tool)
[0m09:12:36.635878 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_financial_wellness_tool
[0m09:12:36.638330 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:12:36.638570 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:36.638788 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:37.851378 [debug] [Thread-4 (]: SQL status: SELECT 5 in 1.272 seconds
[0m09:12:37.852103 [debug] [Thread-1 (]: SQL status: SELECT 2 in 1.299 seconds
[0m09:12:37.854649 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_confidential_s1"
[0m09:12:37.856510 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:12:37.858710 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_confidential_s1
[0m09:12:37.858978 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m09:12:37.859161 [debug] [Thread-2 (]: SQL status: SELECT 36 in 1.305 seconds
[0m09:12:37.861102 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_confidential_s1"
[0m09:12:37.861421 [debug] [Thread-3 (]: SQL status: SELECT 23 in 1.223 seconds
[0m09:12:37.863128 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:12:37.864254 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:12:37.865260 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:12:37.865760 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:12:37.866020 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:12:37.866257 [debug] [Thread-4 (]: On model.engage_analytics.qr_confidential_s1: BEGIN
[0m09:12:37.866463 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:12:37.866627 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m09:12:37.868330 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:12:37.868588 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:12:37.868783 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_financial_wellness_tool
[0m09:12:37.869038 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:12:37.869235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:37.870700 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:12:37.870979 [debug] [Thread-4 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Discuss Confidentiality with readable column names
-- Questionnaire ID: 23451
-- Source file: questionnaire/ipc-session-1/confidential-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:37.871222 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:12:37.871415 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:12:37.871798 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- 1 month follow up with readable column names
-- Questionnaire ID: 1-month-follow-up
-- Source file: questionnaire/1-month-follow-up.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'completed-all-recommended-interventions' then answer_value_text end) as "completed-all-recommended-interventions",max(case when linkid = 'schedule-this-meeting' then answer_value_text end) as "schedule-this-meeting"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:37.872101 [debug] [Thread-2 (]: On model.engage_analytics.qr_common_mental_health_symptoms: BEGIN
[0m09:12:37.873226 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:12:37.873521 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: BEGIN
[0m09:12:37.873896 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:37.874138 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:12:37.874403 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:12:37.874604 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:37.914150 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m09:12:37.914605 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:12:37.915038 [debug] [Thread-2 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Common Mental Health Symptoms with readable column names
-- Questionnaire ID: q-common-mental-health-symptoms
-- Source file: questionnaire/assessments/common-mental-health-symptoms.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "total_score",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrfeeling",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "total_score_meaning",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brrepeat",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "total_score_5",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrloss_of",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brhaving",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "total_score_meaning_9",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "how_difficult_have_these_problems_made_it_for_you_to_do_your",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "total_score_11",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brfeelin",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "total_score_meaning_13",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi_14",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrhaving",max(case when linkid = 'f1.10.1' then answer_value_text end) as "f1.10.1",max(case when linkid = 'f1.11.1' then answer_value_text end) as "f1.11.1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "f1.15.1",max(case when linkid = 'f1.16.1' then answer_value_text end) as "f1.16.1",max(case when linkid = 'f1.17.1' then answer_value_text end) as "f1.17.1",max(case when linkid = 'f1.18.1' then answer_value_text end) as "f1.18.1",max(case when linkid = 'f1.19.1' then answer_value_text end) as "f1.19.1",max(case when linkid = 'f1.20.1' then answer_value_text end) as "f1.20.1",max(case when linkid = 'f1.21.1' then answer_value_text end) as "f1.21.1",max(case when linkid = 'f1.3.1' then answer_value_text end) as "f1.3.1",max(case when linkid = 'f1.4.1' then answer_value_text end) as "f1.4.1",max(case when linkid = 'f1.5.1' then answer_value_text end) as "f1.5.1",max(case when linkid = 'f1.6.1' then answer_value_text end) as "f1.6.1",max(case when linkid = 'f1.7.1' then answer_value_text end) as "f1.7.1",max(case when linkid = 'f1.8.1' then answer_value_text end) as "f1.8.1",max(case when linkid = 'f1.9.1' then answer_value_text end) as "f1.9.1",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'show-pcl-5-to-8-questions' then answer_value_text end) as "show-pcl-5-to-8-questions",max(case when linkid = 'task-id-common-mental-pdf' then answer_value_text end) as "task-id-common-mental-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:37.915417 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:12:37.917020 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:12:37.917226 [debug] [Thread-4 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp" rename to "qr_confidential_s1"
[0m09:12:37.917738 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Financial Wellness Tool with readable column names
-- Questionnaire ID: q-financial-wellness-tool
-- Source file: questionnaire/assessments/financial-wellness-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '21234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_there_a_time_when_you_or",max(case when linkid = '31234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo",max(case when linkid = '3456789a-bcde-f012-3456-789abcdef012' then answer_value_text end) as "financial_how_hard_is_it_for_you_to_pay_for_the_very_basics_",max(case when linkid = '51234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_how_strongly_do_you_agree_or_disagree_with_the_fol",max(case when linkid = '61234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_move_in_with_other_p",max(case when linkid = '6789abcd-ef01-2345-6789-abcdef012345' then answer_value_text end) as "financial_in_the_past_12_months_how_often_did_you_run_out_of",max(case when linkid = '91234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_stay_at_a_shelter_in",max(case when linkid = 'c1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo_8",max(case when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab' then answer_value_text end) as "financial_i_worried_whether_my_food_would_run_out_before_i_g",max(case when linkid = 'f0123456-789a-bcde-f012-3456789abcde' then answer_value_text end) as "financial_the_food_that_i_bought_just_didnt_last_and_i_didnt",max(case when linkid = 'f1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_your_phone_gas_heating_w",max(case when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d' then answer_value_text end) as "financial_when_you_think_about_your_financial_situation_how_",max(case when linkid = 'high-debt' then answer_value_text end) as "high-debt",max(case when linkid = 'high-food-insecurity' then answer_value_text end) as "high-food-insecurity",max(case when linkid = 'high-housing-insecurity' then answer_value_text end) as "high-housing-insecurity",max(case when linkid = 'high-paying-bills' then answer_value_text end) as "high-paying-bills",max(case when linkid = 'moderate-debt' then answer_value_text end) as "moderate-debt",max(case when linkid = 'moderate-food-insecurity' then answer_value_text end) as "moderate-food-insecurity",max(case when linkid = 'moderate-housing-insecurity' then answer_value_text end) as "moderate-housing-insecurity",max(case when linkid = 'moderate-medical-hardships' then answer_value_text end) as "moderate-medical-hardships",max(case when linkid = 'moderate-paying-bills' then answer_value_text end) as "moderate-paying-bills",max(case when linkid = 'no-financial-hardship' then answer_value_text end) as "no-financial-hardship",max(case when linkid = 'overall-financial-hardship' then answer_value_text end) as "overall-financial-hardship"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:37.918117 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m09:12:37.919207 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:37.919499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:37.920243 [debug] [Thread-4 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:12:37.920869 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:12:37.921097 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:12:37.921331 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:12:37.921583 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:12:37.921808 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:37.922007 [debug] [Thread-4 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:12:37.923570 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:12:37.923789 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:12:37.925147 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:12:37.925427 [debug] [Thread-2 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp" rename to "qr_common_mental_health_symptoms"
[0m09:12:37.925712 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp" rename to "qr_financial_wellness_tool"
[0m09:12:37.926617 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:37.926897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:37.927142 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:37.927328 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:37.928577 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup"
[0m09:12:37.929727 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m09:12:37.930489 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:12:37.931210 [debug] [Thread-2 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:12:37.931509 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:12:37.931776 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:12:37.931959 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:12:37.932136 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:12:37.932314 [debug] [Thread-4 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup" cascade
[0m09:12:37.932503 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m09:12:37.932673 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:12:37.933215 [debug] [Thread-2 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:12:37.933969 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:37.934687 [debug] [Thread-4 (]: On model.engage_analytics.qr_confidential_s1: Close
[0m09:12:37.934882 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:37.935097 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:37.935332 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:37.936113 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m09:12:37.936435 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaad20>]}
[0m09:12:37.937712 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup"
[0m09:12:37.938892 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup"
[0m09:12:37.939613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c42030>]}
[0m09:12:37.939961 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:12:37.940272 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:12:37.940575 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup" cascade
[0m09:12:37.940830 [debug] [Thread-2 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup" cascade
[0m09:12:37.941638 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:12:37.941877 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:37.942573 [debug] [Thread-2 (]: On model.engage_analytics.qr_common_mental_health_symptoms: Close
[0m09:12:37.943429 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: Close
[0m09:12:37.944068 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaa000>]}
[0m09:12:37.944427 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb7ec0>]}
[0m09:12:38.094758 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m09:12:38.095695 [info ] [Thread-1 (]: 23 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 1.40s]
[0m09:12:38.097803 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m09:12:38.096205 [info ] [Thread-2 (]: 24 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 1.40s]
[0m09:12:38.098305 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_gad_7_s1
[0m09:12:38.096974 [info ] [Thread-3 (]: 26 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [[32mCREATE VIEW[0m in 1.31s]
[0m09:12:38.098936 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:12:38.097407 [info ] [Thread-4 (]: 25 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [[32mCREATE VIEW[0m in 1.36s]
[0m09:12:38.099426 [info ] [Thread-1 (]: 27 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [RUN]
[0m09:12:38.099881 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_financial_wellness_tool
[0m09:12:38.100220 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_gad_7_s2
[0m09:12:38.100657 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_confidential_s1
[0m09:12:38.101100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_gad_7_s1)
[0m09:12:38.101463 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_gad_7_s3
[0m09:12:38.101864 [info ] [Thread-2 (]: 28 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [RUN]
[0m09:12:38.102238 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_gad_7_s4
[0m09:12:38.102850 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_gad_7_s1
[0m09:12:38.103485 [info ] [Thread-3 (]: 29 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [RUN]
[0m09:12:38.103927 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_common_mental_health_symptoms, now model.engage_analytics.qr_gad_7_s2)
[0m09:12:38.104374 [info ] [Thread-4 (]: 30 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [RUN]
[0m09:12:38.108818 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:12:38.109333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_financial_wellness_tool, now model.engage_analytics.qr_gad_7_s3)
[0m09:12:38.109656 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_gad_7_s2
[0m09:12:38.109959 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_confidential_s1, now model.engage_analytics.qr_gad_7_s4)
[0m09:12:38.110268 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:38.110581 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_gad_7_s3
[0m09:12:38.115290 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:12:38.115587 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_gad_7_s4
[0m09:12:38.115836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:38.118841 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:12:38.119154 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:38.121871 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:12:38.122369 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:38.122741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:38.123057 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:38.123372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:38.123833 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:38.750958 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.628 seconds
[0m09:12:38.754659 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s2"
[0m09:12:38.755311 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.632 seconds
[0m09:12:38.755831 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.632 seconds
[0m09:12:38.756928 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s3"
[0m09:12:38.757694 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s4"
[0m09:12:38.758055 [debug] [Thread-1 (]: SQL status: SELECT 18 in 0.642 seconds
[0m09:12:38.758407 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_gad_7_s2
[0m09:12:38.759231 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s1"
[0m09:12:38.759463 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_gad_7_s3
[0m09:12:38.759659 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_gad_7_s4
[0m09:12:38.761528 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s2"
[0m09:12:38.763383 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s3"
[0m09:12:38.764932 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s4"
[0m09:12:38.765209 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_gad_7_s1
[0m09:12:38.766780 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s1"
[0m09:12:38.767129 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:12:38.767372 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: BEGIN
[0m09:12:38.767607 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:12:38.767808 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:12:38.767998 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:12:38.768187 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: BEGIN
[0m09:12:38.768442 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: BEGIN
[0m09:12:38.768705 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:38.768918 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s1: BEGIN
[0m09:12:38.769150 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:12:38.769535 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 2) with readable column names
-- Questionnaire ID: 205
-- Source file: questionnaire/ipc-session-2/gad-7-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_gad7_session_2",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s2_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s2_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s2_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s2_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s2_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s2_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s2_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_gad7_session_2_score",max(case when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s2_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:38.769799 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:38.769968 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:38.770133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:38.770297 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:12:38.770475 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:12:38.770633 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:12:38.770871 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 4) with readable column names
-- Questionnaire ID: 62
-- Source file: questionnaire/ipc-session-4/gad-7-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s4_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s4_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s4_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s4_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s4_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s4_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s4_q7_afraid",max(case when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = 'e4155e07-1d18-448f-8111-182bf4149672' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s4_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:38.771180 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 3) with readable column names
-- Questionnaire ID: 59
-- Source file: questionnaire/ipc-session-3/gad-7-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s3_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s3_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s3_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s3_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s3_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s3_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s3_q7_afraid",max(case when linkid = '534c4998-b964-4101-b919-ff3c26af9714' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s3_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:38.771507 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 1) with readable column names
-- Questionnaire ID: 202
-- Source file: questionnaire/ipc-session-1/gad-7-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9' then answer_value_text end) as "ipc_s1_taskid_gad_pdf",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_gad7_session_1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s1_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s1_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s1_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s1_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s1_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s1_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s1_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_gad7_session_1_score",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s1_score_meaning_13",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:38.772487 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:12:38.774042 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:12:38.774245 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:12:38.774423 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:38.774582 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:38.774751 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp" rename to "qr_gad_7_s2"
[0m09:12:38.777032 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:12:38.778505 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:12:38.780358 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:12:38.780717 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp" rename to "qr_gad_7_s4"
[0m09:12:38.780944 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp" rename to "qr_gad_7_s3"
[0m09:12:38.781167 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp" rename to "qr_gad_7_s1"
[0m09:12:38.781557 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:38.782201 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:12:38.782405 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:38.782584 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:38.782750 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:12:38.782908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:38.783473 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:12:38.784025 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:12:38.784209 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:12:38.784768 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:12:38.784965 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:12:38.785150 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:12:38.785350 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:12:38.785528 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:12:38.785693 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:12:38.785895 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:12:38.786101 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:38.787427 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup"
[0m09:12:38.787622 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:38.787792 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:38.787947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:38.788196 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:12:38.789264 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup"
[0m09:12:38.790321 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup"
[0m09:12:38.791389 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup"
[0m09:12:38.791574 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup" cascade
[0m09:12:38.791829 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:12:38.792078 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:12:38.792310 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:12:38.792516 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup" cascade
[0m09:12:38.792708 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup" cascade
[0m09:12:38.792913 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:12:38.793087 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup" cascade
[0m09:12:38.793870 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: Close
[0m09:12:38.794071 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:38.794248 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:38.794561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc9880>]}
[0m09:12:38.795222 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: Close
[0m09:12:38.795406 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:38.796069 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: Close
[0m09:12:38.796407 [info ] [Thread-2 (]: 28 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [[32mCREATE VIEW[0m in 0.69s]
[0m09:12:38.796683 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb6810>]}
[0m09:12:38.797392 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s1: Close
[0m09:12:38.797705 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_gad_7_s2
[0m09:12:38.797971 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdc350>]}
[0m09:12:38.798485 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_mood_rating_s1
[0m09:12:38.798284 [info ] [Thread-3 (]: 29 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [[32mCREATE VIEW[0m in 0.69s]
[0m09:12:38.798895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e15d00>]}
[0m09:12:38.799181 [info ] [Thread-4 (]: 30 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [[32mCREATE VIEW[0m in 0.69s]
[0m09:12:38.799548 [info ] [Thread-2 (]: 31 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [RUN]
[0m09:12:38.799917 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_gad_7_s3
[0m09:12:38.800241 [info ] [Thread-1 (]: 27 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [[32mCREATE VIEW[0m in 0.70s]
[0m09:12:38.800525 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_gad_7_s4
[0m09:12:38.800755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s2, now model.engage_analytics.qr_mood_rating_s1)
[0m09:12:38.800975 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_mood_rating_s2
[0m09:12:38.801309 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_gad_7_s1
[0m09:12:38.801555 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_mood_rating_s3
[0m09:12:38.801892 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_mood_rating_s1
[0m09:12:38.802208 [info ] [Thread-3 (]: 32 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [RUN]
[0m09:12:38.802550 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_mood_rating_s4
[0m09:12:38.802924 [info ] [Thread-4 (]: 33 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [RUN]
[0m09:12:38.805970 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:12:38.806242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s3, now model.engage_analytics.qr_mood_rating_s2)
[0m09:12:38.806485 [info ] [Thread-1 (]: 34 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [RUN]
[0m09:12:38.806696 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s4, now model.engage_analytics.qr_mood_rating_s3)
[0m09:12:38.806907 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:38.807102 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_mood_rating_s2
[0m09:12:38.807275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s1, now model.engage_analytics.qr_mood_rating_s4)
[0m09:12:38.807455 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_mood_rating_s3
[0m09:12:38.807629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:38.809955 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:12:38.810182 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_mood_rating_s4
[0m09:12:38.812564 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:12:38.814221 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:38.817170 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:12:38.817473 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:38.817699 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:38.817915 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:38.818155 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:38.818516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:39.401713 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.594 seconds
[0m09:12:39.402777 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:12:39.403071 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.585 seconds
[0m09:12:39.403833 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:12:39.404099 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.586 seconds
[0m09:12:39.404801 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:12:39.405105 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.587 seconds
[0m09:12:39.406041 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:12:39.406360 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_mood_rating_s4
[0m09:12:39.408132 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:12:39.408508 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_mood_rating_s1
[0m09:12:39.408858 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_mood_rating_s3
[0m09:12:39.410661 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:12:39.410905 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_mood_rating_s2
[0m09:12:39.412525 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:12:39.414210 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:12:39.414471 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:12:39.414775 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:12:39.414984 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: BEGIN
[0m09:12:39.415167 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: BEGIN
[0m09:12:39.415419 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:12:39.415710 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:12:39.415895 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: BEGIN
[0m09:12:39.416078 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: BEGIN
[0m09:12:39.416279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:39.416439 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:39.416694 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:12:39.416949 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:39.417125 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:39.417340 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:12:39.417624 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 4) with readable column names
-- Questionnaire ID: 209
-- Source file: questionnaire/ipc-session-4/mood-rating-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990' then answer_value_text end) as "mood_s4_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:39.417880 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:12:39.418104 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:12:39.418376 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 1) with readable column names
-- Questionnaire ID: 203
-- Source file: questionnaire/ipc-session-1/mood-rating-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "mood_s1_8085cded8e0f497f9e3d5fab3981d727",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "mood_s1_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:39.418693 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 3) with readable column names
-- Questionnaire ID: 207
-- Source file: questionnaire/ipc-session-3/mood-rating-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "mood_s3_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:39.418978 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 2) with readable column names
-- Questionnaire ID: 206
-- Source file: questionnaire/ipc-session-2/mood-rating-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "mood_s2_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:39.420646 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:12:39.422259 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:12:39.422503 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:39.422727 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:39.422924 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp" rename to "qr_mood_rating_s4"
[0m09:12:39.423103 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:12:39.424743 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:12:39.426195 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:12:39.428361 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:12:39.428582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:39.428772 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp" rename to "qr_mood_rating_s3"
[0m09:12:39.428975 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp" rename to "qr_mood_rating_s1"
[0m09:12:39.429173 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp" rename to "qr_mood_rating_s2"
[0m09:12:39.429819 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:12:39.430130 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:12:39.430351 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:12:39.430620 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:39.430831 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:39.431445 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:12:39.431618 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:39.431787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:39.432383 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:12:39.432571 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:12:39.433129 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:12:39.434335 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup"
[0m09:12:39.434547 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:12:39.434739 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:12:39.434923 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:12:39.435218 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:12:39.435408 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:12:39.435660 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:12:39.435889 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup" cascade
[0m09:12:39.436318 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:39.436544 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:12:39.437939 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup"
[0m09:12:39.438154 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:39.438317 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:39.439111 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: Close
[0m09:12:39.439459 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:12:39.440630 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup"
[0m09:12:39.441755 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup"
[0m09:12:39.442023 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup" cascade
[0m09:12:39.442353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b22ea0>]}
[0m09:12:39.442745 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:12:39.443075 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:12:39.443986 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup" cascade
[0m09:12:39.444212 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:39.443796 [info ] [Thread-1 (]: 34 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [[32mCREATE VIEW[0m in 0.64s]
[0m09:12:39.444520 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup" cascade
[0m09:12:39.445399 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: Close
[0m09:12:39.445607 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:39.445868 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_mood_rating_s4
[0m09:12:39.446559 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: Close
[0m09:12:39.446809 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bddfd0>]}
[0m09:12:39.447028 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:39.447240 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_mw_tool
[0m09:12:39.447947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710eea0>]}
[0m09:12:39.448755 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: Close
[0m09:12:39.447676 [info ] [Thread-4 (]: 33 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:12:39.449134 [info ] [Thread-1 (]: 35 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [RUN]
[0m09:12:39.449528 [info ] [Thread-2 (]: 31 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [[32mCREATE VIEW[0m in 0.65s]
[0m09:12:39.449877 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108babef0>]}
[0m09:12:39.450253 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_mood_rating_s3
[0m09:12:39.450649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s4, now model.engage_analytics.qr_mw_tool)
[0m09:12:39.450972 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_mood_rating_s1
[0m09:12:39.451343 [info ] [Thread-3 (]: 32 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [[32mCREATE VIEW[0m in 0.64s]
[0m09:12:39.451591 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:12:39.451854 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_mw_tool
[0m09:12:39.452134 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_phq_9_s1
[0m09:12:39.452390 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_mood_rating_s2
[0m09:12:39.452701 [info ] [Thread-4 (]: 36 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [RUN]
[0m09:12:39.455601 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:12:39.455919 [info ] [Thread-2 (]: 37 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [RUN]
[0m09:12:39.456153 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_phq_9_s2
[0m09:12:39.456399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s3, now model.engage_analytics.qr_mw_tool_ipc_session_4)
[0m09:12:39.456604 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:39.456801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s1, now model.engage_analytics.qr_phq_9_s1)
[0m09:12:39.457023 [info ] [Thread-3 (]: 38 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [RUN]
[0m09:12:39.457324 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:12:39.457611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:39.457797 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_phq_9_s1
[0m09:12:39.458018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s2, now model.engage_analytics.qr_phq_9_s2)
[0m09:12:39.460353 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:12:39.463275 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:12:39.463545 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_phq_9_s2
[0m09:12:39.463872 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

    
    with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:39.464211 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:39.466936 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:12:39.467183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:39.467425 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:39.467648 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:39.468146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:40.035558 [debug] [Thread-1 (]: SQL status: SELECT 37 in 0.578 seconds
[0m09:12:40.038953 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool"
[0m09:12:40.039594 [debug] [Thread-4 (]: SQL status: SELECT 28 in 0.572 seconds
[0m09:12:40.041421 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:12:40.041777 [debug] [Thread-2 (]: SQL status: SELECT 21 in 0.574 seconds
[0m09:12:40.042739 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s1"
[0m09:12:40.043127 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_mw_tool
[0m09:12:40.045960 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool"
[0m09:12:40.046229 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.578 seconds
[0m09:12:40.047045 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s2"
[0m09:12:40.047280 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:12:40.048700 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:12:40.049016 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_phq_9_s2
[0m09:12:40.050477 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s2"
[0m09:12:40.050843 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_phq_9_s1
[0m09:12:40.052495 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s1"
[0m09:12:40.052806 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:12:40.053024 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:12:40.053197 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: BEGIN
[0m09:12:40.053372 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:12:40.053626 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s2: BEGIN
[0m09:12:40.053851 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:12:40.054034 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool: BEGIN
[0m09:12:40.054308 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: BEGIN
[0m09:12:40.054576 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:40.054771 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:40.054986 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:12:40.055225 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:12:40.055464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:40.055784 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool Session 4 with readable column names
-- Questionnaire ID: mw-tool-ipc-session-4
-- Source file: questionnaire/assessments/mw-tool-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_s",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "in_the_past_year_have_you_ever_felt_that_your_thoughts_were",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "in_the_past_year_how_often_do_you_have_a_drink_containing_a",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "in_the_past_month_have_you_wished_you_were_dead_or_wished_y",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "in_the_past_year_did_you_at_any_time_hear_voices_saying_qui",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_down_d",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "in_the_past_year_how_many_times_have_you_used_a_recreationa",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "in_the_past_year_how_many_drinks_containing_alcohol_do_you",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "in_the_past_3_months_have_you_ever_done_anything_started_t",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_nervous",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "in_the_past_month_have_you_had_any_actual_thoughts_of_killi",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_so_restless_tha",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_a",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-mw-tool-ipc-s4-pdf' then answer_value_text end) as "task-id-mw-tool-ipc-s4-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:40.056091 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:40.056348 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 2) with readable column names
-- Questionnaire ID: 57
-- Source file: questionnaire/ipc-session-2/phq-9-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_phq9_session_2",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s2_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s2_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s2_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s2_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s2_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s2_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s2_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s2_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s2_q7_concentration",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_phq9_session_2_score",max(case when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'a07491bd-039d-417b-9caf-0af536316594' then answer_value_text end) as "ipc_s2_score_meaning_14"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:40.056590 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:12:40.056803 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:12:40.057158 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool with readable column names
-- Questionnaire ID: 1613532
-- Source file: questionnaire/assessments/mw-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "mental_in_the_past_year_have_you_ever_felt_that_your_thou",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "mental_in_the_past_year_how_often_do_you_have_a_drink_con",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "mental_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "mental_in_the_past_year_did_you_at_any_time_hear_voices_s",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "mental_q2_depressed",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "mental_in_the_past_year_how_many_times_have_you_used_a_re",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "mental_in_the_past_year_how_many_drinks_containing_alcoho",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "mental_in_the_past_3_months_have_you_ever_done_anything_s",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "mental_q1_anxious",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "mental_in_the_past_month_have_you_had_any_actual_thoughts",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "mental_q5_restless",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe_13",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "mental_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "mental_supervisors_name",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "mental_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "mental_referral_details_if_the_client_is_referred_out",max(case when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29' then answer_value_text end) as "retake_screening",max(case when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f' then answer_value_text end) as "retake_screening_19",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'q1-to-q3-negative' then answer_value_text end) as "q1-to-q3-negative",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-common-mental-health-form' then answer_value_text end) as "task-id-common-mental-health-form",max(case when linkid = 'task-id-mwtool-pdf' then answer_value_text end) as "task-id-mwtool-pdf",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:40.057583 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 1) with readable column names
-- Questionnaire ID: 54
-- Source file: questionnaire/ipc-session-1/phq-9-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.3.1' then answer_value_text end) as "phq9_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "phq9_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "phq9_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "phq9_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "phq9_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "phq9_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "phq9_q7_concentration",max(case when linkid = 'f1.10.1' then answer_value_text end) as "phq9_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "phq9_q9_suicide",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "phq9_total_score",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "phq9_score_meaning",max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as "phq9_score_meaning_code",max(case when linkid = 'encounter-id' then answer_value_text end) as "phq9_encounter_id",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "phq9_observation_id",max(case when linkid = 'calculated-month' then answer_value_text end) as "phq9_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "phq9_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "phq9_field_cd8e3d6d",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as "phq9_task_id",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "phq9_field_9c366bcc",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "phq9_field_b5bc7f80",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "phq9_link_encounter"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:40.059465 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:12:40.061051 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:12:40.061260 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:40.061451 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:12:40.061603 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:12:40.061767 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp" rename to "qr_phq_9_s2"
[0m09:12:40.063291 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:12:40.064696 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:12:40.066133 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:12:40.066380 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp" rename to "qr_phq_9_s1"
[0m09:12:40.066567 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp" rename to "qr_mw_tool_ipc_session_4"
[0m09:12:40.066740 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp" rename to "qr_mw_tool"
[0m09:12:40.067127 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:40.067748 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:12:40.067954 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:40.068135 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:12:40.068293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:40.068468 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:40.069291 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:12:40.069584 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:12:40.070262 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:12:40.070846 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:12:40.071052 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:12:40.071313 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:12:40.071561 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:12:40.071756 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:12:40.071943 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:12:40.072121 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:40.072313 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:12:40.074568 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup"
[0m09:12:40.074799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:40.074986 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:12:40.075260 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:12:40.075466 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m09:12:40.076542 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup"
[0m09:12:40.077653 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup"
[0m09:12:40.077855 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup" cascade
[0m09:12:40.078955 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup"
[0m09:12:40.079267 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:12:40.079525 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:12:40.079790 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:12:40.079972 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup" cascade
[0m09:12:40.080149 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:12:40.080309 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup" cascade
[0m09:12:40.080489 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup" cascade
[0m09:12:40.081199 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s2: Close
[0m09:12:40.081385 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:40.082050 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool: Close
[0m09:12:40.082226 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:40.082476 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c68fe0>]}
[0m09:12:40.082651 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:40.082863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6b530>]}
[0m09:12:40.083474 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: Close
[0m09:12:40.084376 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: Close
[0m09:12:40.083798 [info ] [Thread-3 (]: 38 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [[32mCREATE VIEW[0m in 0.62s]
[0m09:12:40.084831 [info ] [Thread-1 (]: 35 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:40.085234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a54410>]}
[0m09:12:40.085624 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_phq_9_s2
[0m09:12:40.085917 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb88c0>]}
[0m09:12:40.086238 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_mw_tool
[0m09:12:40.086566 [info ] [Thread-2 (]: 37 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:40.086830 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_phq_9_s3
[0m09:12:40.087395 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_phq_9_s4
[0m09:12:40.087207 [info ] [Thread-4 (]: 36 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:40.087714 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_phq_9_s1
[0m09:12:40.087938 [info ] [Thread-3 (]: 39 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [RUN]
[0m09:12:40.088174 [info ] [Thread-1 (]: 40 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [RUN]
[0m09:12:40.088446 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:12:40.088643 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_planning_next_steps
[0m09:12:40.088869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s2, now model.engage_analytics.qr_phq_9_s3)
[0m09:12:40.089075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool, now model.engage_analytics.qr_phq_9_s4)
[0m09:12:40.089358 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_registration_info
[0m09:12:40.089656 [info ] [Thread-2 (]: 41 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [RUN]
[0m09:12:40.089937 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_phq_9_s3
[0m09:12:40.090134 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_phq_9_s4
[0m09:12:40.090390 [info ] [Thread-4 (]: 42 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [RUN]
[0m09:12:40.090636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s1, now model.engage_analytics.qr_planning_next_steps)
[0m09:12:40.093370 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:12:40.095725 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:12:40.095982 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool_ipc_session_4, now model.engage_analytics.qr_registration_info)
[0m09:12:40.096193 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_planning_next_steps
[0m09:12:40.096405 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:40.096617 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:40.096805 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_registration_info
[0m09:12:40.099071 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:12:40.099277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:40.099629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:40.102169 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:12:40.102441 [debug] [Thread-2 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:40.102965 [debug] [Thread-4 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:40.103272 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:40.103515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:40.679617 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.580 seconds
[0m09:12:40.680305 [debug] [Thread-4 (]: SQL status: SELECT 28 in 0.577 seconds
[0m09:12:40.683145 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s3"
[0m09:12:40.683776 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.584 seconds
[0m09:12:40.684072 [debug] [Thread-2 (]: SQL status: SELECT 66 in 0.581 seconds
[0m09:12:40.685193 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info"
[0m09:12:40.686338 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s4"
[0m09:12:40.687498 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_planning_next_steps"
[0m09:12:40.687847 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_phq_9_s3
[0m09:12:40.689935 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s3"
[0m09:12:40.690344 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_phq_9_s4
[0m09:12:40.690627 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_planning_next_steps
[0m09:12:40.693421 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s4"
[0m09:12:40.693665 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_registration_info
[0m09:12:40.695231 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_planning_next_steps"
[0m09:12:40.695474 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:12:40.696999 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info"
[0m09:12:40.697284 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: BEGIN
[0m09:12:40.697502 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:12:40.697736 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: BEGIN
[0m09:12:40.698018 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:12:40.698189 [debug] [Thread-2 (]: On model.engage_analytics.qr_planning_next_steps: BEGIN
[0m09:12:40.698371 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:40.698539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:40.698749 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:12:40.699004 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:12:40.699260 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:40.699461 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:12:40.699710 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 3) with readable column names
-- Questionnaire ID: 61
-- Source file: questionnaire/ipc-session-3/phq-9-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s3_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s3_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s3_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s3_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s3_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s3_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s3_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s3_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s3_q7_concentration",max(case when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9' then answer_value_text end) as "ipc_s3_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:40.700056 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 4) with readable column names
-- Questionnaire ID: 211
-- Source file: questionnaire/ipc-session-4/phq-9-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "ipc_s4_how_difficult_have_these_problems_made_it_for_you_",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s4_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s4_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s4_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s4_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s4_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s4_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s4_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s4_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s4_q7_concentration",max(case when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792' then answer_value_text end) as "ipc_s4_score_meaning_13"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:40.700317 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:12:40.700488 [debug] [Thread-4 (]: On model.engage_analytics.qr_registration_info: BEGIN
[0m09:12:40.700999 [debug] [Thread-2 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Planning Next Steps with readable column names
-- Questionnaire ID: q-planning-next-steps
-- Source file: questionnaire/assessments/planning-next-steps.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7' then answer_value_text end) as "referral_to_mental_health_specialist",max(case when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7' then answer_value_text end) as "referred",max(case when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f' then answer_value_text end) as "okay",max(case when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d' then answer_value_text end) as "field_2cb66889",max(case when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6' then answer_value_text end) as "field_34a56c28",max(case when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9' then answer_value_text end) as "referres",max(case when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01' then answer_value_text end) as "field_34ab6c28",max(case when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d' then answer_value_text end) as "field_3b9f7e5d",max(case when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f' then answer_value_text end) as "sbirt_motivational_interviewing",max(case when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7' then answer_value_text end) as "safety",max(case when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123' then answer_value_text end) as "others",max(case when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae' then answer_value_text end) as "mental_health",max(case when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345' then answer_value_text end) as "not_interested",max(case when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf' then answer_value_text end) as "20250924",max(case when linkid = '69712544-6237-4962-a455-ee6e9ee80000' then answer_value_text end) as "field_69712544",max(case when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e' then answer_value_text end) as "field_76ba8dbe",max(case when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574' then answer_value_text end) as "hh",max(case when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106' then answer_value_text end) as "20260505",max(case when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d' then answer_value_text end) as "field_9a8b7c6d",max(case when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d' then answer_value_text end) as "sbirt_motivational_interviewingbrspan_stylecolor006",max(case when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab' then answer_value_text end) as "field_ab12d39f",max(case when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e' then answer_value_text end) as "they_gtycyvuy",max(case when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e' then answer_value_text end) as "field_b2c3d4e5",max(case when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc' then answer_value_text end) as "test",max(case when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e' then answer_value_text end) as "field_bc2def4a",max(case when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f' then answer_value_text end) as "field_c3d4e5f6",max(case when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4' then answer_value_text end) as "field_c9d8b7a6",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd' then answer_value_text end) as "not_interested_28",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f' then answer_value_text end) as "field_cd34f5b1",max(case when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f' then answer_value_text end) as "iwbwb",max(case when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a' then answer_value_text end) as "needs_checkups",max(case when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a' then answer_value_text end) as "hhh",max(case when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90' then answer_value_text end) as "20250827",max(case when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7' then answer_value_text end) as "referral_to_mental_health_specialist_34",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b' then answer_value_text end) as "already_received_a_similar_service",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4' then answer_value_text end) as "field_ef5617d3",max(case when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5' then answer_value_text end) as "peace",max(case when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100' then answer_value_text end) as "interested_but_not_now",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g' then answer_value_text end) as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g",max(case when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h' then answer_value_text end) as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h",max(case when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i' then answer_value_text end) as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i",max(case when linkid = 'financial-hardships-list' then answer_value_text end) as "financial-hardships-list",max(case when linkid = 'is-fws' then answer_value_text end) as "is-fws",max(case when linkid = 'is-ipc' then answer_value_text end) as "is-ipc",max(case when linkid = 'is-ipc-main' then answer_value_text end) as "is-ipc-main",max(case when linkid = 'is-ipc-optional' then answer_value_text end) as "is-ipc-optional",max(case when linkid = 'is-mhs' then answer_value_text end) as "is-mhs",max(case when linkid = 'is-other-agency-services' then answer_value_text end) as "is-other-agency-services",max(case when linkid = 'is-other-services-outside-agency' then answer_value_text end) as "is-other-services-outside-agency",max(case when linkid = 'is-sbirt' then answer_value_text end) as "is-sbirt",max(case when linkid = 'is-sbirt-main' then answer_value_text end) as "is-sbirt-main",max(case when linkid = 'is-sbirt-optional' then answer_value_text end) as "is-sbirt-optional",max(case when linkid = 'is-spi' then answer_value_text end) as "is-spi",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'scheduled-ipc-session-1-with-current-time' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time",max(case when linkid = 'scheduled-ipc-session-1-with-current-time-2' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time-2",max(case when linkid = 'task-id-000' then answer_value_text end) as "task-id-000",max(case when linkid = 'task-id-001' then answer_value_text end) as "task-id-001",max(case when linkid = 'task-id-002' then answer_value_text end) as "task-id-002",max(case when linkid = 'task-id-003' then answer_value_text end) as "task-id-003",max(case when linkid = 'task-id-004' then answer_value_text end) as "task-id-004",max(case when linkid = 'task-id-006' then answer_value_text end) as "task-id-006",max(case when linkid = 'task-id-planning-next-steps-pdf' then answer_value_text end) as "task-id-planning-next-steps-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:40.701814 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:40.702027 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:12:40.702346 [debug] [Thread-4 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Add Family Member Registration with readable column names
-- Questionnaire ID: 221
-- Source file: questionnaire/generic/registration_info.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff' then answer_value_text end) as "registration_36d39dbe00e24e29f0793ec8f0119aff",max(case when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd' then answer_value_text end) as "registration_middle_name",max(case when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271' then answer_value_text end) as "registration_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7' then answer_value_text end) as "registration_age",max(case when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d' then answer_value_text end) as "registration_surname",max(case when linkid = 'age' then answer_value_text end) as "registration_age_6",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "registration_calculated_age",max(case when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f' then answer_value_text end) as "registration_unique_id",max(case when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0' then answer_value_text end) as "registration_has_this_person_received_engage_services_in_the_pa",max(case when linkid = 'calculated-month' then answer_value_text end) as "registration_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "registration_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "registration_date_of_birth_dob",max(case when linkid = 'e6306275-b989-4375-8527-3a56092081b8' then answer_value_text end) as "registration_first_name",max(case when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd' then answer_value_text end) as "registration_what_was_your_biological_sex_assigned_at_birth",max(case when linkid = 'choice-gender-identity' then answer_value_text end) as "choice-gender-identity",max(case when linkid = 'choice-pronouns' then answer_value_text end) as "choice-pronouns",max(case when linkid = 'do-you-have-medicaid' then answer_value_text end) as "do-you-have-medicaid",max(case when linkid = 'email-address' then answer_value_text end) as "email-address",max(case when linkid = 'medicaid-number' then answer_value_text end) as "medicaid-number",max(case when linkid = 'other-best-represents-how-you-think-of-yourself' then answer_value_text end) as "other-best-represents-how-you-think-of-yourself",max(case when linkid = 'other-biological-sex-at-birth' then answer_value_text end) as "other-biological-sex-at-birth",max(case when linkid = 'other-gender-identity' then answer_value_text end) as "other-gender-identity",max(case when linkid = 'other-pronouns' then answer_value_text end) as "other-pronouns",max(case when linkid = 'other-where-did-you-first-learn-about-engage' then answer_value_text end) as "other-where-did-you-first-learn-about-engage",max(case when linkid = 'phone-number' then answer_value_text end) as "phone-number",max(case when linkid = 'physical-address' then answer_value_text end) as "physical-address",max(case when linkid = 'where-did-you-first-learn-about-engage' then answer_value_text end) as "where-did-you-first-learn-about-engage",max(case when linkid = 'zip-code' then answer_value_text end) as "zip-code"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:40.703124 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:12:40.703340 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:40.704843 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:12:40.706184 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:12:40.706374 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:12:40.706542 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp" rename to "qr_phq_9_s4"
[0m09:12:40.706704 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:12:40.706866 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp" rename to "qr_phq_9_s3"
[0m09:12:40.708233 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:12:40.709652 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:12:40.709895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:40.710133 [debug] [Thread-2 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp" rename to "qr_planning_next_steps"
[0m09:12:40.710474 [debug] [Thread-4 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp" rename to "qr_registration_info"
[0m09:12:40.711263 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:12:40.711608 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:40.711876 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:12:40.712526 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:12:40.712727 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:40.712908 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:12:40.713086 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:40.713265 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:12:40.713825 [debug] [Thread-4 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:12:40.714460 [debug] [Thread-2 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:12:40.714676 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:12:40.714871 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:12:40.715054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:40.715230 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:12:40.715422 [debug] [Thread-4 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:12:40.716627 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup"
[0m09:12:40.716835 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:40.717006 [debug] [Thread-2 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:12:40.717295 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:12:40.718654 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup"
[0m09:12:40.718895 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:40.719119 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup" cascade
[0m09:12:40.720456 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:12:40.720679 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:40.721838 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup"
[0m09:12:40.722064 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup" cascade
[0m09:12:40.723142 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup"
[0m09:12:40.723348 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:40.723605 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:12:40.723920 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:12:40.724611 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: Close
[0m09:12:40.724799 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:40.724974 [debug] [Thread-4 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup" cascade
[0m09:12:40.725162 [debug] [Thread-2 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup" cascade
[0m09:12:40.725814 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: Close
[0m09:12:40.726080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d943e0>]}
[0m09:12:40.726472 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087463c0>]}
[0m09:12:40.727202 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:40.727386 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:40.726799 [info ] [Thread-3 (]: 39 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:12:40.728167 [debug] [Thread-2 (]: On model.engage_analytics.qr_planning_next_steps: Close
[0m09:12:40.727037 [info ] [Thread-1 (]: 40 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [[32mCREATE VIEW[0m in 0.64s]
[0m09:12:40.728934 [debug] [Thread-4 (]: On model.engage_analytics.qr_registration_info: Close
[0m09:12:40.729208 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_phq_9_s3
[0m09:12:40.729469 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_phq_9_s4
[0m09:12:40.729694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d978c0>]}
[0m09:12:40.729940 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_remove_patient
[0m09:12:40.730160 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba97c0>]}
[0m09:12:40.730387 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_sbirt
[0m09:12:40.730702 [info ] [Thread-2 (]: 41 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [[32mCREATE VIEW[0m in 0.64s]
[0m09:12:40.730909 [info ] [Thread-3 (]: 43 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [RUN]
[0m09:12:40.731201 [info ] [Thread-4 (]: 42 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:40.731438 [info ] [Thread-1 (]: 44 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_sbirt .. [RUN]
[0m09:12:40.731853 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_planning_next_steps
[0m09:12:40.732158 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s3, now model.engage_analytics.qr_remove_patient)
[0m09:12:40.732462 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_registration_info
[0m09:12:40.732704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s4, now model.engage_analytics.qr_sbirt)
[0m09:12:40.732985 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:12:40.733268 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_remove_patient
[0m09:12:40.733572 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:12:40.733875 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_sbirt
[0m09:12:40.734257 [info ] [Thread-2 (]: 45 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [RUN]
[0m09:12:40.737236 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:12:40.737567 [info ] [Thread-4 (]: 46 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [RUN]
[0m09:12:40.740048 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:12:40.740311 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_planning_next_steps, now model.engage_analytics.qr_sf_pcl_5_s1)
[0m09:12:40.740527 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:40.740751 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_registration_info, now model.engage_analytics.qr_sf_pcl_5_s2)
[0m09:12:40.740978 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:40.741196 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:12:40.741393 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:40.741579 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:12:40.741753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:40.744240 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:12:40.747249 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:12:40.747690 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:40.748019 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:40.748363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:40.748670 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:41.318213 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.577 seconds
[0m09:12:41.320759 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_remove_patient"
[0m09:12:41.322512 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_remove_patient
[0m09:12:41.322934 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.574 seconds
[0m09:12:41.325093 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_remove_patient"
[0m09:12:41.325293 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.577 seconds
[0m09:12:41.326218 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:12:41.327464 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:12:41.328014 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:12:41.328287 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: BEGIN
[0m09:12:41.328692 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:12:41.330571 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:12:41.330870 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:12:41.331126 [debug] [Thread-1 (]: SQL status: SELECT 159 in 0.589 seconds
[0m09:12:41.331299 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m09:12:41.334318 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:12:41.336406 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_sbirt"
[0m09:12:41.336681 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:12:41.336910 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:12:41.337250 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- eCBIS Remove Family Form with readable column names
-- Questionnaire ID: 69
-- Source file: questionnaire/generic/remove_patient.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f' then answer_value_text end) as "remove_family_date_of_death",max(case when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a' then answer_value_text end) as "remove_family_give_other_reasons_for_removal",max(case when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5' then answer_value_text end) as "remove_family_age_at_death_year",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b' then answer_value_text end) as "remove_family_a11ebb0dacb34038956b293a41acb85b",max(case when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1' then answer_value_text end) as "remove_family_date_moved_away",max(case when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff' then answer_value_text end) as "remove_family_reason_for_removal",max(case when linkid = 'patient-birthdate' then answer_value_text end) as "remove_family_patientbirthdate",max(case when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec' then answer_value_text end) as "reason_unknown"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:41.337531 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: BEGIN
[0m09:12:41.337785 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:12:41.338021 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_sbirt
[0m09:12:41.338345 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: BEGIN
[0m09:12:41.340076 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_sbirt"
[0m09:12:41.340336 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:12:41.340698 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:12:41.341026 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 2) with readable column names
-- Questionnaire ID: 56
-- Source file: questionnaire/ipc-session-2/sf-pcl-5-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ptsd_session_2",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_pcptsd_session_2_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s2_score_meaning_13",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s2_is_ptsd",max(case when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:41.341350 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:41.341550 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:12:41.341893 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:12:41.342164 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:12:41.343774 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:12:41.344128 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 1) with readable column names
-- Questionnaire ID: 204
-- Source file: questionnaire/ipc-session-1/sf-pcl-5-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505' then answer_value_text end) as "ipc_s1_taskid_ptsd_pdf",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av_8",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ptsd_session_1",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_pcptsd_session_1_score",max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s1_score_meaning_14",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s1_is_ptsd",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:41.344472 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:41.344662 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: BEGIN
[0m09:12:41.344863 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp" rename to "qr_remove_patient"
[0m09:12:41.346391 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:12:41.346662 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp" rename to "qr_sf_pcl_5_s2"
[0m09:12:41.347121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:41.347365 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:41.347576 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:12:41.347851 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:41.348070 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:41.348784 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:12:41.349632 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SBIRT with readable column names
-- Questionnaire ID: 212
-- Source file: questionnaire/sbirt.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_drink_alc",max(case when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t",max(case when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e' then answer_value_text end) as "sbirt_have_you_or_someone_else_been_injured_as_a_result_",max(case when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621' then answer_value_text end) as "sbirt_how_often_do_you_have_six_or_more_drinks_on_one_oc",max(case when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_needed_a_f",max(case when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848' then answer_value_text end) as "sbirt_have_you_ever_experienced_withdrawal_symptoms_felt",max(case when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4' then answer_value_text end) as "sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_o",max(case when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_8",max(case when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_had_a_feel",max(case when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1' then answer_value_text end) as "sbirt_how_many_standard_drinks_containing_alcohol_do_you",max(case when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_been_unabl",max(case when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11' then answer_value_text end) as "sbirt_how_often_do_you_have_a_drink_containing_alcohol",max(case when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4' then answer_value_text end) as "sbirt_have_you_neglected_your_family_because_of_your_use",max(case when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267' then answer_value_text end) as "sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use",max(case when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_15",max(case when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990' then answer_value_text end) as "sbirt_have_you_had_medical_problems_as_a_result_of_your_",max(case when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3' then answer_value_text end) as "sbirt_have_you_ever_used_any_drugs_by_injection_nonmedic",max(case when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c' then answer_value_text end) as "sbirt_have_you_engaged_in_illegal_activities_in_order_to",max(case when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_19",max(case when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_20",max(case when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_failed_to_",max(case when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_22",max(case when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41' then answer_value_text end) as "sbirt_does_your_spouse_or_parents_ever_complain_about_yo",max(case when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_24",max(case when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_25",max(case when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_26",max(case when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9' then answer_value_text end) as "sbirt_are_you_always_able_to_stop_using_drugs_when_you_w",max(case when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_found_that",max(case when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b' then answer_value_text end) as "sbirt_have_you_used_drugs_other_than_those_required_for_",max(case when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88' then answer_value_text end) as "sbirt_has_a_relative_or_friend_or_a_doctor_or_another_he",max(case when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba' then answer_value_text end) as "sbirt_do_you_use_more_than_one_drug_at_a_time",max(case when linkid = '0466b304-2876-409b-ade2-d1c675614854' then answer_value_text end) as "sbirt_please_select_one_substance_you_would_like_to_disc",max(case when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_metha",max(case when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78' then answer_value_text end) as "sbirt_i_would_like_to_offer_an_opportunity_to_start_a_co",max(case when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0' then answer_value_text end) as "sbirt_we_could_start_by_discussing_the_pros_and_cons_of_",max(case when linkid = '39843731-a8e7-4822-bad7-55489947ebeb' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_other",max(case when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_alc",max(case when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_canna",max(case when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_hallu",max(case when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_sedat",max(case when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_inhal",max(case when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_cocai",max(case when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_the",max(case when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491' then answer_value_text end) as "sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_al",max(case when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_presc",max(case when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha",max(case when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_47",max(case when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_48",max(case when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_49",max(case when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_50",max(case when linkid = '8427af19-3bad-4713-bad9-b179437fef96' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_stree",max(case when linkid = '90876967-c973-4bee-9217-8c7482cb12a2' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_52",max(case when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368' then answer_value_text end) as "sbirt_cannabis_marijuana_pot_grass_hash_etc",max(case when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_54",max(case when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_55",max(case when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d' then answer_value_text end) as "sbirt_would_you_be_interested_in_learning_more_about_sub",max(case when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9' then answer_value_text end) as "sbirt_1579996975654c3eb488d6a65d66c6c9",max(case when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812' then answer_value_text end) as "sbirt_things_you_can_do",max(case when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_prescript",max(case when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_methamphe",max(case when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_other_dru",max(case when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_inhalants",max(case when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cannabis_",max(case when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_64",max(case when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3' then answer_value_text end) as "sbirt_what_are_some_good_things_about_staying_the_same",max(case when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848' then answer_value_text end) as "sbirt_street_opioids_heroin_opium_etc_or_prescription_op",max(case when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_hallucino",max(case when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cocaine_l",max(case when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_sedatives",max(case when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509' then answer_value_text end) as "sbirt_what_are_some_good_things_about_making_a_change",max(case when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1' then answer_value_text end) as "sbirt_what_are_your_health_goals_around_substance_use",max(case when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f' then answer_value_text end) as "sbirt_cocaine_coke_crack_etc",max(case when linkid = '1600f791-fd2c-44d8-8384-37973785741b' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed",max(case when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_74",max(case when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_75",max(case when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_76",max(case when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_street_op",max(case when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_78",max(case when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299' then answer_value_text end) as "sbirt_other_drugs",max(case when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_80",max(case when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_81",max(case when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_82",max(case when linkid = 'edced328-6f82-458a-bce4-35987bff19fb' then answer_value_text end) as "sbirt_edced3286f82458abce435987bff19fb",max(case when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19' then answer_value_text end) as "sbirt_can_i_share_additional_treatment_options_with_you",max(case when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre",max(case when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3' then answer_value_text end) as "sbirt_prescription_stimulants_just_for_the_feeling_more_",max(case when linkid = '582271e0-892e-4795-ac55-0b73baf828ca' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_87",max(case when linkid = '654d5688-f42a-469b-8494-81115b760e29' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_88",max(case when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_89",max(case when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_90",max(case when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_91",max(case when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_92",max(case when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_93",max(case when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_94",max(case when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down",max(case when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_96",max(case when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_97",max(case when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_98",max(case when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_99",max(case when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_100",max(case when linkid = 'ad609c63-366e-476a-b131-610ceed211da' then answer_value_text end) as "sbirt_things_others_can_help_you_do",max(case when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_102",max(case when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac' then answer_value_text end) as "sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_e",max(case when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_104",max(case when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_105",max(case when linkid = '6281fa0d-ef3f-4013-bd31-062371828010' then answer_value_text end) as "sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whipp",max(case when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_107",max(case when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe' then answer_value_text end) as "sbirt_sedatives_just_for_the_feeling_more_than_prescribe",max(case when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f' then answer_value_text end) as "sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecs",max(case when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404' then answer_value_text end) as "sbirt_any_other_drugs_to_get_high",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '36af2335-ac86-4864-8a3d-619451160cc5' then answer_value_text end) as "2_times_in_a_day",max(case when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f' then answer_value_text end) as "join_a_community_group_and",max(case when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5' then answer_value_text end) as "therapy",max(case when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528' then answer_value_text end) as "2_days_per_week",max(case when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730' then answer_value_text end) as "field_445adcc0",max(case when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045' then answer_value_text end) as "3_days_per_week",max(case when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb' then answer_value_text end) as "not_ready",max(case when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6' then answer_value_text end) as "quit",max(case when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5' then answer_value_text end) as "20250224",max(case when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3' then answer_value_text end) as "2_times_in_a_day_124",max(case when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d' then answer_value_text end) as "field_859d58d6",max(case when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427' then answer_value_text end) as "field_8a6c4c5b",max(case when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7' then answer_value_text end) as "social_places_you_can_go_to_eg_take_a_walk_at_the_park",max(case when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4' then answer_value_text end) as "internally",max(case when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3' then answer_value_text end) as "work_toward_a_goal",max(case when linkid = 'drug-to-use-alcohol' then answer_value_text end) as "drug-to-use-alcohol",max(case when linkid = 'drug-to-use-marijuana-or-other' then answer_value_text end) as "drug-to-use-marijuana-or-other",max(case when linkid = 'health-goals-do-not-want-to-change' then answer_value_text end) as "health-goals-do-not-want-to-change",max(case when linkid = 'is-drug-dependence' then answer_value_text end) as "is-drug-dependence",max(case when linkid = 'is-high-risk-alcohol' then answer_value_text end) as "is-high-risk-alcohol",max(case when linkid = 'is-high-risk-drug' then answer_value_text end) as "is-high-risk-drug",max(case when linkid = 'is-low-risk-alcohol' then answer_value_text end) as "is-low-risk-alcohol",max(case when linkid = 'is-low-risk-drug' then answer_value_text end) as "is-low-risk-drug",max(case when linkid = 'is-medium-risk-alcohol' then answer_value_text end) as "is-medium-risk-alcohol",max(case when linkid = 'is-medium-risk-drug' then answer_value_text end) as "is-medium-risk-drug",max(case when linkid = 'is-opioid-dependence' then answer_value_text end) as "is-opioid-dependence",max(case when linkid = 'other-drug-list' then answer_value_text end) as "other-drug-list",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender' then answer_value_text end) as "patient-gender",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'score-audit' then answer_value_text end) as "score-audit",max(case when linkid = 'score-dast' then answer_value_text end) as "score-dast",max(case when linkid = 'should-converse-about-substance-use' then answer_value_text end) as "should-converse-about-substance-use",max(case when linkid = 'should-discuss-health-goals' then answer_value_text end) as "should-discuss-health-goals",max(case when linkid = 'show-client-use-with-other-drugs' then answer_value_text end) as "show-client-use-with-other-drugs",max(case when linkid = 'show-discuss-next-steps' then answer_value_text end) as "show-discuss-next-steps",max(case when linkid = 'show-goals' then answer_value_text end) as "show-goals",max(case when linkid = 'show-intervention-when-low-risk' then answer_value_text end) as "show-intervention-when-low-risk",max(case when linkid = 'show-intervention-when-medium-high-risk' then answer_value_text end) as "show-intervention-when-medium-high-risk",max(case when linkid = 'show-is-medium-high-risk' then answer_value_text end) as "show-is-medium-high-risk",max(case when linkid = 'show-summary-for-low-risk' then answer_value_text end) as "show-summary-for-low-risk",max(case when linkid = 'show-things-to-do' then answer_value_text end) as "show-things-to-do",max(case when linkid = 'task-id-sbirt-pdf' then answer_value_text end) as "task-id-sbirt-pdf",max(case when linkid = 'using-opioids-and-low-risk' then answer_value_text end) as "using-opioids-and-low-risk"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:41.350919 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:12:41.352317 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:12:41.352526 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:12:41.352891 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:12:41.353147 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp" rename to "qr_sf_pcl_5_s1"
[0m09:12:41.353373 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:12:41.353563 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:12:41.354615 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:41.354823 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:41.354995 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:41.355665 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:12:41.356895 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup"
[0m09:12:41.358029 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup"
[0m09:12:41.358261 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:12:41.358577 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:12:41.358896 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:12:41.359102 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:12:41.359279 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup" cascade
[0m09:12:41.359458 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup" cascade
[0m09:12:41.360247 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:41.360439 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:41.361118 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: Close
[0m09:12:41.361303 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:12:41.361921 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: Close
[0m09:12:41.362081 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:41.363512 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:12:41.363805 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba0590>]}
[0m09:12:41.365176 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup"
[0m09:12:41.365545 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc1be0>]}
[0m09:12:41.365818 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp" rename to "qr_sbirt"
[0m09:12:41.366526 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:12:41.366234 [info ] [Thread-4 (]: 46 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [[32mCREATE VIEW[0m in 0.62s]
[0m09:12:41.366878 [info ] [Thread-3 (]: 43 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:41.367125 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup" cascade
[0m09:12:41.367400 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:12:41.367631 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_remove_patient
[0m09:12:41.367859 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:12:41.368149 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:12:41.368394 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:41.368628 [info ] [Thread-4 (]: 47 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [RUN]
[0m09:12:41.368889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:41.369121 [info ] [Thread-3 (]: 48 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [RUN]
[0m09:12:41.369837 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: Close
[0m09:12:41.370038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s2, now model.engage_analytics.qr_sf_pcl_5_s3)
[0m09:12:41.370603 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:12:41.370803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_remove_patient, now model.engage_analytics.qr_sf_pcl_5_s4)
[0m09:12:41.371019 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:12:41.371275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be2630>]}
[0m09:12:41.371467 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:12:41.371644 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:12:41.375305 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:12:41.375702 [info ] [Thread-2 (]: 45 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:41.376008 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:12:41.378772 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:12:41.379054 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:41.379349 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:12:41.379649 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:41.379894 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:41.380145 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_sociodemographic_survey
[0m09:12:41.380360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:41.380585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:41.380971 [info ] [Thread-2 (]: 49 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [RUN]
[0m09:12:41.382478 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup"
[0m09:12:41.382846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s1, now model.engage_analytics.qr_sociodemographic_survey)
[0m09:12:41.383252 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:12:41.383485 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_sociodemographic_survey
[0m09:12:41.383697 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup" cascade
[0m09:12:41.386144 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:12:41.386570 [debug] [Thread-2 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:41.386798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:41.387048 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:41.387943 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: Close
[0m09:12:41.388364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0e900>]}
[0m09:12:41.388753 [info ] [Thread-1 (]: 44 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_sbirt  [[32mCREATE VIEW[0m in 0.66s]
[0m09:12:41.389100 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_sbirt
[0m09:12:41.389329 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_spi_subform_1
[0m09:12:41.389637 [info ] [Thread-1 (]: 50 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [RUN]
[0m09:12:41.389926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sbirt, now model.engage_analytics.qr_spi_subform_1)
[0m09:12:41.390106 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_spi_subform_1
[0m09:12:41.393225 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:12:41.393526 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:41.393720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:41.956898 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.576 seconds
[0m09:12:41.960415 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:12:41.960727 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.581 seconds
[0m09:12:41.960934 [debug] [Thread-2 (]: SQL status: SELECT 25 in 0.574 seconds
[0m09:12:41.961949 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:12:41.962977 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:12:41.964268 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.570 seconds
[0m09:12:41.965266 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_1"
[0m09:12:41.965648 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:12:41.965897 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_sociodemographic_survey
[0m09:12:41.967868 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:12:41.968186 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:12:41.969925 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:12:41.970156 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_spi_subform_1
[0m09:12:41.972094 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:12:41.975203 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_1"
[0m09:12:41.975491 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:12:41.975830 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:12:41.976231 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:12:41.976591 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: BEGIN
[0m09:12:41.976978 [debug] [Thread-2 (]: On model.engage_analytics.qr_sociodemographic_survey: BEGIN
[0m09:12:41.977357 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s3: BEGIN
[0m09:12:41.977686 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:12:41.977985 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: BEGIN
[0m09:12:41.978624 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:41.978841 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:41.979038 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:41.979278 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:12:41.979493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:41.979723 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:12:41.979915 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:12:41.980247 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 4) with readable column names
-- Questionnaire ID: 210
-- Source file: questionnaire/ipc-session-4/sf-pcl-5-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s4_encounter_id_of_ptsd_session_4",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s4_score_meaning_12",max(case when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:41.980558 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:12:41.980852 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 3) with readable column names
-- Questionnaire ID: 60
-- Source file: questionnaire/ipc-session-3/sf-pcl-5-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ptsd_session_3",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s3_score_meaning_12",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s3_is_ptsd",max(case when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:41.981279 [debug] [Thread-2 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Sociodemographic Survey with readable column names
-- Questionnaire ID: 1613531
-- Source file: questionnaire/assessments/sociodemographic_survey.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7' then answer_value_text end) as "demographic_if_you_were_not_born_in_the_us_how_long_have_you_l",max(case when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5' then answer_value_text end) as "demographic_please_specify",max(case when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde' then answer_value_text end) as "demographic_please_specify_3",max(case when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe' then answer_value_text end) as "demographic_where_were_you_born",max(case when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af' then answer_value_text end) as "demographic_what_is_the_zip_code_of_where_you_currently_live",max(case when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739' then answer_value_text end) as "demographic_what_was_your_biological_sex_at_birth",max(case when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d' then answer_value_text end) as "demographic_please_enter_the_number_of_years",max(case when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173' then answer_value_text end) as "demographic_we_would_like_to_know_about_what_you_do_are_you",max(case when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4' then answer_value_text end) as "demographic_please_enter_the_number_of_months",max(case when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9' then answer_value_text end) as "demographic_what_is_your_race_andor_ethnicity",max(case when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0' then answer_value_text end) as "demographic_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '92fed595-49f2-4fab-81ff-885941f31e07' then answer_value_text end) as "demographic_where_did_this_client_first_learn_about_engage",max(case when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a' then answer_value_text end) as "demographic_what_is_your_marital_status",max(case when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c' then answer_value_text end) as "demographic_what_term_best_expresses_how_you_describe_your_gen",max(case when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba' then answer_value_text end) as "demographic_what_was_the_highest_grade_or_level_of_school_that",max(case when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f' then answer_value_text end) as "demographic_please_specify_the_us_territorycommonwealth_eg_pue",max(case when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130' then answer_value_text end) as "some_of_the_time",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:41.981780 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 1 with readable column names
-- Questionnaire ID: 104455
-- Source file: questionnaire/spi/spi-subform-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_1",max(case when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab' then answer_value_text end) as "spi_is_low_risk",max(case when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d' then answer_value_text end) as "spi_is_medium_risk",max(case when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b' then answer_value_text end) as "spi_is_high_risk",max(case when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5' then answer_value_text end) as "spi_were_any_of_these_in_the_past_three_months",max(case when linkid = '35062b98-748b-441c-ad74-185823e1bb52' then answer_value_text end) as "spi_in_the_past_month_have_you_been_thinking_about_how",max(case when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb' then answer_value_text end) as "spi_in_the_past_month_have_you_had_these_thoughts_and_",max(case when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23' then answer_value_text end) as "spi_in_the_past_month_have_you_started_to_work_out_or_",max(case when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511' then answer_value_text end) as "spi_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea' then answer_value_text end) as "spi_have_you_ever_done_anything_started_to_do_anything",max(case when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce' then answer_value_text end) as "spi_in_the_past_month_have_you_actually_had_any_though",max(case when linkid = 'task-id-spi-subform-2' then answer_value_text end) as "spi_taskid_spi_subform_2",max(case when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03' then answer_value_text end) as "spi_43898926e9d5400ea09562a8c7f8dd03",max(case when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837' then answer_value_text end) as "spi_644c00f28b07491192d0f05f5e5cc837",max(case when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9' then answer_value_text end) as "spi_71dbaac9867f4d7fb6d7e1f59402bbf9",max(case when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda' then answer_value_text end) as "spi_7fc39fba84db490daf4e8f772d91ffda",max(case when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42' then answer_value_text end) as "spi_a6601f970a3449d0b181611d6705ca42",max(case when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423' then answer_value_text end) as "spi_c7d21a570fc64e3ab411beceb1fb2423",max(case when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019' then answer_value_text end) as "spi_ecabd308c45a41f78754b1f63a101019",max(case when linkid = 'task-status-spi-subform-2' then answer_value_text end) as "spi_taskstatus_spi_subform_2",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "task-id-spi-subform-3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "task-id-spi-subform-4",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "task-status-spi-subform-3",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "task-status-spi-subform-4"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:41.984544 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:41.984835 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:41.986663 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:12:41.986901 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:12:41.987153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:12:41.988824 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:12:41.989084 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp" rename to "qr_sf_pcl_5_s4"
[0m09:12:41.990543 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:12:41.992248 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:12:41.992547 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp" rename to "qr_sf_pcl_5_s3"
[0m09:12:41.992874 [debug] [Thread-2 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp" rename to "qr_sociodemographic_survey"
[0m09:12:41.993082 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp" rename to "qr_spi_subform_1"
[0m09:12:41.993798 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:41.994007 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:41.994662 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:12:41.994857 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:41.995040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:41.995627 [debug] [Thread-2 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:12:41.995823 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:12:41.996375 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:12:41.996938 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:12:41.997125 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:12:41.997314 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:12:41.997515 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:12:41.997693 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:12:41.997883 [debug] [Thread-2 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:12:41.998091 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:12:41.998280 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:12:41.999117 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:42.000420 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup"
[0m09:12:42.000624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:42.000808 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:42.000977 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:42.001244 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:12:42.002481 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup"
[0m09:12:42.003643 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup"
[0m09:12:42.004806 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup"
[0m09:12:42.005022 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup" cascade
[0m09:12:42.005348 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:12:42.005619 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:12:42.005870 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:12:42.006133 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup" cascade
[0m09:12:42.006374 [debug] [Thread-2 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup" cascade
[0m09:12:42.006586 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:42.006772 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup" cascade
[0m09:12:42.007612 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: Close
[0m09:12:42.007865 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:42.008134 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:42.008483 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e30a40>]}
[0m09:12:42.009260 [debug] [Thread-2 (]: On model.engage_analytics.qr_sociodemographic_survey: Close
[0m09:12:42.009453 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:12:42.010135 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: Close
[0m09:12:42.010493 [info ] [Thread-3 (]: 48 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [[32mCREATE VIEW[0m in 0.64s]
[0m09:12:42.010831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6a780>]}
[0m09:12:42.011474 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s3: Close
[0m09:12:42.011866 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:12:42.012178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c684a0>]}
[0m09:12:42.012544 [info ] [Thread-2 (]: 49 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:42.012910 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_spi_subform_2
[0m09:12:42.013266 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd1eb0>]}
[0m09:12:42.013736 [info ] [Thread-1 (]: 50 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [[32mCREATE VIEW[0m in 0.62s]
[0m09:12:42.014145 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_sociodemographic_survey
[0m09:12:42.014454 [info ] [Thread-3 (]: 51 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [RUN]
[0m09:12:42.014821 [info ] [Thread-4 (]: 47 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:12:42.015170 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_spi_subform_1
[0m09:12:42.015452 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_spi_subform_3
[0m09:12:42.015681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s4, now model.engage_analytics.qr_spi_subform_2)
[0m09:12:42.015974 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:12:42.016174 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_spi_subform_4
[0m09:12:42.016413 [info ] [Thread-2 (]: 52 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [RUN]
[0m09:12:42.016703 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_spi_subform_2
[0m09:12:42.016949 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_start_ipc_s1
[0m09:12:42.017291 [info ] [Thread-1 (]: 53 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [RUN]
[0m09:12:42.017609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sociodemographic_survey, now model.engage_analytics.qr_spi_subform_3)
[0m09:12:42.021433 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:12:42.021745 [info ] [Thread-4 (]: 54 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [RUN]
[0m09:12:42.022104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_1, now model.engage_analytics.qr_spi_subform_4)
[0m09:12:42.022325 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_spi_subform_3
[0m09:12:42.022541 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:42.022764 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s3, now model.engage_analytics.qr_start_ipc_s1)
[0m09:12:42.023043 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_spi_subform_4
[0m09:12:42.025651 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:12:42.025905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:42.026117 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_start_ipc_s1
[0m09:12:42.028487 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:12:42.028767 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:42.031707 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:12:42.031968 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:42.032169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:42.032362 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:42.032621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:42.032894 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:42.609450 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.583 seconds
[0m09:12:42.612284 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_2"
[0m09:12:42.612911 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.581 seconds
[0m09:12:42.614177 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_3"
[0m09:12:42.615150 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_spi_subform_2
[0m09:12:42.617067 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_2"
[0m09:12:42.617447 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_spi_subform_3
[0m09:12:42.619129 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_3"
[0m09:12:42.619463 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:12:42.619703 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: BEGIN
[0m09:12:42.619918 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:12:42.620113 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: BEGIN
[0m09:12:42.620521 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:42.620717 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:12:42.620891 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:42.621157 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 2 with readable column names
-- Questionnaire ID: 104453
-- Source file: questionnaire/spi/spi-subform-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_2",max(case when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36' then answer_value_text end) as "spi_did_this_client_also_screen_positive_for_probable_",max(case when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896' then answer_value_text end) as "spi_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab_5",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "spi_taskid_spi_subform_3",max(case when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50' then answer_value_text end) as "spi_d02eb882411e4bc0af9d08a77fcc3f50",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "spi_taskstatus_spi_subform_3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "spi_taskid_spi_subform_4",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "spi_taskstatus_spi_subform_4",max(case when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f' then answer_value_text end) as "spi_53b30f1274eb474c941c5f0e81b7eb9f",max(case when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253' then answer_value_text end) as "spi_did_you_discuss_this_clients_suicide_risk_screenin",max(case when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b' then answer_value_text end) as "spi_this_client_scored_in_the_moderate_to_high_range_o",max(case when linkid = '783e2646-c8ea-466d-bba8-85c891a14435' then answer_value_text end) as "spi_783e2646c8ea466dbba885c891a14435"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:42.621424 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:12:42.621693 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 3 with readable column names
-- Questionnaire ID: 104454
-- Source file: questionnaire/spi/spi-subform-3.json




  
  

  
  

  
  

  
  
    
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_3"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:42.622640 [debug] [Thread-1 (]: SQL status: SELECT 231 in 0.590 seconds
[0m09:12:42.625197 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_4"
[0m09:12:42.625439 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:12:42.625678 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:12:42.627488 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:12:42.629050 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:12:42.629253 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp" rename to "qr_spi_subform_3"
[0m09:12:42.629451 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp" rename to "qr_spi_subform_2"
[0m09:12:42.629648 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_spi_subform_4
[0m09:12:42.632224 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_4"
[0m09:12:42.632498 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:12:42.633118 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:12:42.633305 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:12:42.633481 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:12:42.634245 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:12:42.634537 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:12:42.634736 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:12:42.634949 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:12:42.635143 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: BEGIN
[0m09:12:42.635326 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:12:42.635921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:12:42.636095 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:12:42.636292 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:42.637365 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 4 with readable column names
-- Questionnaire ID: 104394
-- Source file: questionnaire/spi/spi-subform-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_4",max(case when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk_",max(case when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8' then answer_value_text end) as "spi_in_a_few_days_i_would_like_to_meet_for_a_followup_",max(case when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904' then answer_value_text end) as "spi_person_1",max(case when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0' then answer_value_text end) as "spi_when_you_feel_a_suicidal_crisis_arising_go_through",max(case when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185' then answer_value_text end) as "spi_i_would_like_to_make_a_plan_that_will_help_you_man",max(case when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048' then answer_value_text end) as "spi_cce2de12cf6244ff84e89eb4d864d048",max(case when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri",max(case when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb' then answer_value_text end) as "spi_40fbe8d043804efcbb0426fc7d3714eb",max(case when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7' then answer_value_text end) as "spi_the_methods_i_have_thought_about_using_include",max(case when linkid = '808ba31c-cd29-4743-8801-dfce357d5956' then answer_value_text end) as "spi_person_1_11",max(case when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc' then answer_value_text end) as "spi_90cedcbfbf114dc3973342e6900a09fc",max(case when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031' then answer_value_text end) as "spi_92ab6e65f9bd47188af6f731425d3031",max(case when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3' then answer_value_text end) as "spi_9d203bac75fd4f31bed6073502a977f3",max(case when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54' then answer_value_text end) as "spi_additional_hotline_numbers_you_can_contact",max(case when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk__16",max(case when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969' then answer_value_text end) as "spi_12d89dfd5e434f008446b3af23323969",max(case when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3' then answer_value_text end) as "spi_39de8b745cbc4225b27bc97e72f08af3",max(case when linkid = '437d9ea2-adb5-471a-828b-a0285a282217' then answer_value_text end) as "spi_437d9ea2adb5471a828ba0285a282217",max(case when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd' then answer_value_text end) as "spi_509b140eb1954696bc5ff2fc2d2f77dd",max(case when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7' then answer_value_text end) as "spi_53a575e3aa59408da0dd8df237b68bf7",max(case when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256' then answer_value_text end) as "spi_a6d066a2028649b0b68834696e7fb256",max(case when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4' then answer_value_text end) as "spi_ce56c71d9ea44c8e9e9ad1da93bac1d4",max(case when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect_",max(case when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77' then answer_value_text end) as "spi_person_1_25",max(case when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0' then answer_value_text end) as "spi_person_1_26",max(case when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0' then answer_value_text end) as "spi_beb4ad5f2fd84b80aa93aa9ff1896dd0",max(case when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46' then answer_value_text end) as "spi_c396a3af6f0d4a8ea42b4f47bbce5f46",max(case when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9' then answer_value_text end) as "spi_e45b778dee8c4ee981f48927006160f9",max(case when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003' then answer_value_text end) as "spi_your_local_hotline_number",max(case when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888' then answer_value_text end) as "spi_101d2b7f2b68407daa4930cb4dadc888",max(case when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0' then answer_value_text end) as "spi_14ec8995eee9416f83ad9f44631ac9b0",max(case when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564' then answer_value_text end) as "spi_18d8ee56ffd847119074126ef2cdc564",max(case when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by",max(case when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124' then answer_value_text end) as "spi_5324bdcebaaa45bf935aeb2f65bd7124",max(case when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488' then answer_value_text end) as "spi_68fa6f2e84ec4dbc900e10ede297c488",max(case when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4' then answer_value_text end) as "spi_8891cd7bad1c4030afe46752cd273cf4",max(case when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri_38",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi' then answer_value_text end) as "spi_taskid_spi_navigator",max(case when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0' then answer_value_text end) as "spi_c631e361027c4e4db89448785a3e6dd0",max(case when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410' then answer_value_text end) as "spi_taskid_my_safety_plan_pdf",max(case when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871' then answer_value_text end) as "spi_a1c56f60b8234c15b99da315d2ca1871",max(case when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9' then answer_value_text end) as "spi_ae4fa455f173435abb1b4df1d1316bd9",max(case when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad' then answer_value_text end) as "spi_bc981d8a7f22450babab3acca810ccad",max(case when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db' then answer_value_text end) as "spi_c6c266cc1c8541c097ce9ab491be45db",max(case when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233' then answer_value_text end) as "spi_person_2",max(case when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7' then answer_value_text end) as "spi_7d8621a4dcc84f4892103fb7d0dcc3c7",max(case when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164' then answer_value_text end) as "spi_83661ebe71cf4eab88e3bfecbfe35164",max(case when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12' then answer_value_text end) as "spi_be88b02764b64c3cbf5936a94dc79b12",max(case when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de' then answer_value_text end) as "spi_c3b4cf6e385d40b793804de2f81463de",max(case when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso",max(case when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect__53",max(case when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7' then answer_value_text end) as "spi_ff115c2695b94e0d87ed80817d438fc7",max(case when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596' then answer_value_text end) as "spi_656a57f8f6f04fc5b34771dd8d38f596",max(case when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7' then answer_value_text end) as "spi_f749685963bb4b2f8f7596e44e893bf7",max(case when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0' then answer_value_text end) as "spi_f8861b1c781f4f12b4c8f8110f0c2cc0",max(case when linkid = '15e5007d-028f-4644-8fb6-0346730c3101' then answer_value_text end) as "spi_15e5007d028f46448fb60346730c3101",max(case when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by",max(case when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_60",max(case when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e' then answer_value_text end) as "spi_2b2e05e90c11490cbbff278ba90d7b4e",max(case when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070' then answer_value_text end) as "spi_3e388595a32f46238c9f3c67bad04070",max(case when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123' then answer_value_text end) as "spi_62b0eb1746e54c50a133087cc190a123",max(case when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by_64",max(case when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609' then answer_value_text end) as "spi_705df2d9af924f4fb51317e01d07b609",max(case when linkid = '7845c436-4904-41fa-9553-2c401935623b' then answer_value_text end) as "spi_7845c436490441fa95532c401935623b",max(case when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe' then answer_value_text end) as "spi_person_2_67",max(case when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95' then answer_value_text end) as "spi_person_2_68",max(case when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966' then answer_value_text end) as "spi_c802f463c8f54056bc458ab8d64a1966",max(case when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by_70",max(case when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63' then answer_value_text end) as "spi_2a6c5feb8034418b8644142a5e31df63",max(case when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb' then answer_value_text end) as "spi_3785a2648bd544abbf088aa33735c0eb",max(case when linkid = '544a444d-b101-4d56-9351-00bca8ec749e' then answer_value_text end) as "spi_person_2_73",max(case when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea' then answer_value_text end) as "spi_603d1492316f497f967b5c4b1ab983ea",max(case when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f' then answer_value_text end) as "spi_9f3a622ad39b49b084e70bcf4f832a4f",max(case when linkid = 'e9c42647-eefb-42bd-9080-f83630729606' then answer_value_text end) as "spi_e9c42647eefb42bd9080f83630729606",max(case when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d' then answer_value_text end) as "spi_ee5d4acfecf04e628924cff17a33679d",max(case when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e' then answer_value_text end) as "spi_fe2f09118ddc412ba3e6f216620d147e",max(case when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a' then answer_value_text end) as "spi_370c849b0e0042acbe9d3b4c719ac31a",max(case when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52' then answer_value_text end) as "spi_person_3",max(case when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb' then answer_value_text end) as "spi_08b5e17c5e144b19ac939e479cd2a2bb",max(case when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86' then answer_value_text end) as "spi_13321778b5d44b018eda610cf0007c86",max(case when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by_84",max(case when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17' then answer_value_text end) as "spi_84018cd89134429c8dfefd6a16e4bd17",max(case when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer",max(case when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604' then answer_value_text end) as "spi_fdd7c3c3f2c343bd8a806b48aa2b9604",max(case when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4' then answer_value_text end) as "spi_8a9424b0c8934371b5c9bc0008be14b4",max(case when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af' then answer_value_text end) as "spi_a5d96f90cd914a5b8862c4e3f88694af",max(case when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3' then answer_value_text end) as "spi_person_3_90",max(case when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb' then answer_value_text end) as "spi_28b2e31aee4d4e998974b616145311eb",max(case when linkid = '53932020-eed8-46f4-8236-d548a6335a59' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by_92",max(case when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db' then answer_value_text end) as "spi_7e38a614b0a248eab7c7ca2bdc1f00db",max(case when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf' then answer_value_text end) as "spi_c1e99f8bb1ab46d1b205ecbbb4240fdf",max(case when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_95",max(case when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54' then answer_value_text end) as "spi_d4ebe78407d043128a46634c0e338a54",max(case when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47' then answer_value_text end) as "spi_53def3a1a7e5432695f22561c26ecb47",max(case when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b' then answer_value_text end) as "spi_2b96f1d93450423da277060fcfdadc6b",max(case when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5' then answer_value_text end) as "spi_person_4",max(case when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d' then answer_value_text end) as "spi_b36fdd5fccac457ca8eaf9497204ef1d",max(case when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_101",max(case when linkid = 'c5720a67-803f-4917-8261-3738de838418' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer_102",max(case when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5' then answer_value_text end) as "spi_person_3_103",max(case when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa' then answer_value_text end) as "spi_f952feaf7abc4f6fa3bcd10a43ea62fa",max(case when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6' then answer_value_text end) as "spi_bd7644ee28f14f43a65417fd5034d1f6",max(case when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090' then answer_value_text end) as "spi_72e5c1b77ce949bd834bd98b73ba7090",max(case when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33' then answer_value_text end) as "spi_person_4_107",max(case when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a' then answer_value_text end) as "spi_d82c6ae90516451391fa664686779d6a",max(case when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1' then answer_value_text end) as "spi_person_3_109",max(case when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807' then answer_value_text end) as "spi_fc5c673b41d4435286bb043c73ed9807",max(case when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49' then answer_value_text end) as "spi_0397084acd514b3a809d970a2406ea49",max(case when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972' then answer_value_text end) as "spi_6a273a9882ca4d36ade0ce98f7899972",max(case when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f' then answer_value_text end) as "spi_11aadd880cf948b2939d2b3e28191c5f",max(case when linkid = '57e87170-761c-4b57-a09c-d50cab02860c' then answer_value_text end) as "spi_57e87170761c4b57a09cd50cab02860c",max(case when linkid = '965b7874-dd24-4215-acd4-8d241a262638' then answer_value_text end) as "spi_965b7874dd244215acd48d241a262638",max(case when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb' then answer_value_text end) as "spi_bd62b64972094d329bbbdc2b2823aadb",max(case when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709' then answer_value_text end) as "spi_07c2e8dcb48b4bc7b21bc196cce32709",max(case when linkid = '83dfd82f-0277-459d-abe3-e8795750f288' then answer_value_text end) as "spi_person_5",max(case when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f' then answer_value_text end) as "spi_ae94969792ae476a96ccf8b0adc4221f",max(case when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2' then answer_value_text end) as "spi_2c7b6bd736f6495b9f41eb492c07c7b2",max(case when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_121",max(case when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897' then answer_value_text end) as "spi_fefdc90ffe1d4bfbaf9394df8c482897",max(case when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344' then answer_value_text end) as "spi_1fc8f8e7202248d2b41d4e8ad22af344",max(case when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c' then answer_value_text end) as "spi_8c1ac4fe1d7644368f34d315c6c17b9c",max(case when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d' then answer_value_text end) as "spi_person_5_125",max(case when linkid = 'df53c378-27fe-483d-a630-f7b171f72980' then answer_value_text end) as "spi_df53c37827fe483da630f7b171f72980",max(case when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660' then answer_value_text end) as "spi_e552afd32816446e9ff5e898bc813660",max(case when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_128",max(case when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369' then answer_value_text end) as "spi_person_4_129",max(case when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a' then answer_value_text end) as "spi_44f024678ee049f08da75e7ed827125a",max(case when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9' then answer_value_text end) as "spi_82d6b50b0bb240f694b17a4c58df43f9",max(case when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c' then answer_value_text end) as "spi_892337bdd7fd46a7bf7208e87c9f412c",max(case when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b' then answer_value_text end) as "spi_e4a1be29fe8b442391bc6b4f5d730e6b",max(case when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2' then answer_value_text end) as "spi_9f46e0ff05324105be360cfa9d0770f2",max(case when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8' then answer_value_text end) as "spi_86da79f044cb417dab20c7ecc6f8f7c8",max(case when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7' then answer_value_text end) as "spi_ce0fdd416b0941049998a04c5dd9a5b7",max(case when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0' then answer_value_text end) as "spi_3314932c64e44192b583eb31e87da1d0",max(case when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206' then answer_value_text end) as "spi_5e2ab0f5f5d94502befeaba770f0e206",max(case when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240' then answer_value_text end) as "spi_796f544054f84d69b961a5b7e6a63240",max(case when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478' then answer_value_text end) as "spi_9f531e6126cf4223865339c24d6dd478",max(case when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_141",max(case when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021' then answer_value_text end) as "spi_4d334b16ea16429994ed32e84ef97021",max(case when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf' then answer_value_text end) as "spi_895fad45c3b547c59edf5f9b9e793fbf",max(case when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc' then answer_value_text end) as "spi_92da95cc50dd4bf0acca4465c07d44cc",max(case when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd' then answer_value_text end) as "spi_person_5_145",max(case when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc' then answer_value_text end) as "spi_f1fef9d72ab94ead9c24c4dc9c7ed4cc",max(case when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2' then answer_value_text end) as "spi_40d6a87f94984cfdb2334610e6de08c2",max(case when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668' then answer_value_text end) as "spi_ac3206ddb60b4cb1a5593a770a685668",max(case when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21' then answer_value_text end) as "spi_f895ed4f50044da49d59c21293674b21",max(case when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8' then answer_value_text end) as "spi_faefef23d2e64777b6288f83921e8fd8",max(case when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c' then answer_value_text end) as "spi_62a0463889284aabb4901a33739b7a5c",max(case when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f' then answer_value_text end) as "spi_bfe595d6325f492ab3b6cc5541e18c3f",max(case when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa' then answer_value_text end) as "spi_40d8ef6402f042ae947877651bd26dfa",max(case when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3' then answer_value_text end) as "spi_249f5ce8ecc04e4396756b01ca1502a3",max(case when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27' then answer_value_text end) as "spi_9b1b11e8608f4ea9911b88aae467ac27",max(case when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4' then answer_value_text end) as "spi_dae7f411758d48009842fc0038a6b4a4",max(case when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14' then answer_value_text end) as "spi_0c308fef8ce54217a8d48e6ff00c8e14",max(case when linkid = '54b75d55-1c43-4552-acbf-d9754831add8' then answer_value_text end) as "spi_54b75d551c434552acbfd9754831add8",max(case when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c' then answer_value_text end) as "spi_9faa2b7818424326bf7f9975bf04dc2c",max(case when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f' then answer_value_text end) as "spi_a320b7874cba457f9c6067ff76c7020f",max(case when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc' then answer_value_text end) as "spi_706fc36fefef4bf9827e7dc100cc92bc",max(case when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a' then answer_value_text end) as "spi_a57b5b3412e54ec882157f316267323a",max(case when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75' then answer_value_text end) as "spi_6bbdb2cfe7f6443a8f4e841e16bb9b75",max(case when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e' then answer_value_text end) as "spi_d617b1e1ea224863a878627f6b81963e",max(case when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc' then answer_value_text end) as "spi_2cedd4dd15e549518674ea4d4eeb7cfc",max(case when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200' then answer_value_text end) as "spi_c0655b118f2147ed8ede95498c2e8200",max(case when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225' then answer_value_text end) as "spi_1895c0a7b0904f499b0c08dca9a7b225",max(case when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c' then answer_value_text end) as "spi_f311f3ca5537413488285e537bb26a9c",max(case when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268' then answer_value_text end) as "spi_1a00c7b7e80d4e908ed4efd8f6d96268",max(case when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e' then answer_value_text end) as "spi_527c0166cc354cc3a9d97eeb0a54635e",max(case when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed' then answer_value_text end) as "spi_41cce38aca5c4e24904a25b1027336ed",max(case when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5' then answer_value_text end) as "spi_e8726638cfdb40aeb72cf1d594f64de5",max(case when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f' then answer_value_text end) as "spi_6ac23c5d0035489585f233c2fbba8f3f",max(case when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99' then answer_value_text end) as "spi_e7ba8485515441b8ac1835410a83cd99",max(case when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81' then answer_value_text end) as "spi_06f9231a999b445982606fbbcdfc5d81",max(case when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444' then answer_value_text end) as "spi_d8615ac796b246a2b3a5b5b83945b444",max(case when linkid = '74d0f0df-e726-4c40-84ce-efece882818b' then answer_value_text end) as "spi_74d0f0dfe7264c4084ceefece882818b",max(case when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d' then answer_value_text end) as "spi_1d0ad82509de4018a680cd0e6bf0983d",max(case when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03' then answer_value_text end) as "spi_d5194db005464bd196d8d56457930c03",max(case when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131' then answer_value_text end) as "spi_9e11ce9790e842f2ba188c4f0720c131",max(case when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0' then answer_value_text end) as "spi_cb75bba90bd84dceba2fd1b21a97c2a0",max(case when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2' then answer_value_text end) as "spi_2f44652fdf2d476e933d75b6ed55f5f2",max(case when linkid = '7b51625b-73b9-472d-9c71-299beb26694f' then answer_value_text end) as "spi_7b51625b73b9472d9c71299beb26694f",max(case when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a' then answer_value_text end) as "spi_13e2f93482ed4b23af6e95523dc3746a",max(case when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248' then answer_value_text end) as "spi_ec54e447c9814dd2aaa4659f8e494248",max(case when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71' then answer_value_text end) as "spi_cf16ca6e8b1b467db807fc5d50339f71",max(case when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d' then answer_value_text end) as "spi_ce18eee3aa6444238db150fe7f00850d",max(case when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c' then answer_value_text end) as "spi_5a79866df1fb4bd8b4c4f18c982bef3c",max(case when linkid = '45772f3f-c610-408b-942b-359769945cf4' then answer_value_text end) as "spi_45772f3fc610408b942b359769945cf4",max(case when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111' then answer_value_text end) as "spi_cebffdf48fd14829884c41cc42bc0111",max(case when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0' then answer_value_text end) as "spi_7ca03155c9ec45e18cd05b86fa444ad0",max(case when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149' then answer_value_text end) as "spi_46c2861b70a94fdf94eae1a01cae3149",max(case when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d' then answer_value_text end) as "spi_8a5b1c7de3ef444385f1fa5213d89f8d",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12' then answer_value_text end) as "paracetamol",max(case when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98' then answer_value_text end) as "tiredness",max(case when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6' then answer_value_text end) as "watching_tv",max(case when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6' then answer_value_text end) as "wait_what",max(case when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by",max(case when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe' then answer_value_text end) as "sleeping",max(case when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f' then answer_value_text end) as "what",max(case when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264' then answer_value_text end) as "what_205",max(case when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d' then answer_value_text end) as "wait",max(case when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05' then answer_value_text end) as "wait_what_207",max(case when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13' then answer_value_text end) as "tiredness_208",max(case when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by_209",max(case when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8' then answer_value_text end) as "sleeping_210",max(case when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d' then answer_value_text end) as "socialize",max(case when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2' then answer_value_text end) as "yoga_playing_with_dog",max(case when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b' then answer_value_text end) as "watching_tv_213",max(case when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351' then answer_value_text end) as "video_games",max(case when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7' then answer_value_text end) as "wait_215",max(case when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba' then answer_value_text end) as "walking_in_the_park",max(case when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8' then answer_value_text end) as "none",max(case when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9' then answer_value_text end) as "20250204",max(case when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0' then answer_value_text end) as "taking_toxins",max(case when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a' then answer_value_text end) as "tiktok_dance_challenges",max(case when linkid = 'no-response-step-1' then answer_value_text end) as "no-response-step-1",max(case when linkid = 'no-response-step-1-review' then answer_value_text end) as "no-response-step-1-review",max(case when linkid = 'no-response-step-2' then answer_value_text end) as "no-response-step-2",max(case when linkid = 'no-response-step-2-review' then answer_value_text end) as "no-response-step-2-review",max(case when linkid = 'no-response-step-3' then answer_value_text end) as "no-response-step-3",max(case when linkid = 'no-response-step-3-review' then answer_value_text end) as "no-response-step-3-review",max(case when linkid = 'no-response-step-4' then answer_value_text end) as "no-response-step-4",max(case when linkid = 'no-response-step-4-review' then answer_value_text end) as "no-response-step-4-review",max(case when linkid = 'no-response-step-6a' then answer_value_text end) as "no-response-step-6a",max(case when linkid = 'no-response-step-6a-review' then answer_value_text end) as "no-response-step-6a-review",max(case when linkid = 'other-signs-step-1' then answer_value_text end) as "other-signs-step-1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:42.638386 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:12:42.678333 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup"
[0m09:12:42.678673 [debug] [Thread-4 (]: SQL status: SELECT 111 in 0.646 seconds
[0m09:12:42.680289 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup"
[0m09:12:42.680704 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:12:42.682419 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:12:42.682733 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:12:42.682961 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup" cascade
[0m09:12:42.683260 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup" cascade
[0m09:12:42.684014 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:42.684239 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:42.685046 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: Close
[0m09:12:42.685281 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_start_ipc_s1
[0m09:12:42.685963 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: Close
[0m09:12:42.688053 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:12:42.688379 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee7920>]}
[0m09:12:42.688935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1f110>]}
[0m09:12:42.689300 [info ] [Thread-3 (]: 51 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [[32mCREATE VIEW[0m in 0.67s]
[0m09:12:42.690054 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_spi_subform_2
[0m09:12:42.690286 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:12:42.689789 [info ] [Thread-2 (]: 52 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [[32mCREATE VIEW[0m in 0.67s]
[0m09:12:42.690576 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_start_ipc_s2
[0m09:12:42.690787 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:12:42.690993 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s1: BEGIN
[0m09:12:42.691235 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_spi_subform_3
[0m09:12:42.691482 [info ] [Thread-3 (]: 55 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [RUN]
[0m09:12:42.693094 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:12:42.693367 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_start_ipc_s3
[0m09:12:42.693621 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_2, now model.engage_analytics.qr_start_ipc_s2)
[0m09:12:42.693912 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:42.694112 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp" rename to "qr_spi_subform_4"
[0m09:12:42.694549 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_start_ipc_s2
[0m09:12:42.694384 [info ] [Thread-2 (]: 56 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [RUN]
[0m09:12:42.694842 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:12:42.697776 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:12:42.698037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:12:42.698296 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_3, now model.engage_analytics.qr_start_ipc_s3)
[0m09:12:42.698978 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 1 with readable column names
-- Questionnaire ID: 55
-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as "ipc_s1_patient_age",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as "ipc_s1_patient_dob",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as "ipc_s1_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as "ipc_s1_in_the_past_6_months",max(case when linkid = 'f1.92.1' then answer_value_text end) as "ipc_s1_f1921",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as "ipc_s1_in_the_past_1_year",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as "ipc_s1_i_noticed_that_when_i_was_asking_about_important_p",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s1_did_you_complete_the_required_assessments_and_the_",max(case when linkid = 'f1.42.2' then answer_value_text end) as "ipc_s1_do_you_think_an_important_persons_death_is_connect",max(case when linkid = 'f1.68.2' then answer_value_text end) as "ipc_s1_are_you_and_someone_else_having_a_strong_disagreem",max(case when linkid = 'f1.69.2' then answer_value_text end) as "ipc_s1_briefly_tell_me_about_the_disagreement",max(case when linkid = 'f1.70.2' then answer_value_text end) as "ipc_s1_how_has_this_disagreement_been_affecting_you",max(case when linkid = 'f1.72.2' then answer_value_text end) as "ipc_s1_have_there_been_any_changes_in_your_life_that_are_",max(case when linkid = 'f1.73.2' then answer_value_text end) as "ipc_s1_what_was_the_change",max(case when linkid = 'f1.74.2' then answer_value_text end) as "ipc_s1_when_did_this_happen",max(case when linkid = 'f1.76.2' then answer_value_text end) as "ipc_s1_if_the_client_did_not_mention_any_close_relationsh",max(case when linkid = 'f1.78.2' then answer_value_text end) as "ipc_s1_would_you_say_you_have_close_relationships",max(case when linkid = 'f1.79.2' then answer_value_text end) as "ipc_s1_has_anything_changed_in_your_life_so_that_now_you_",max(case when linkid = 'f1.88.2' then answer_value_text end) as "ipc_s1_f1882",max(case when linkid = 'f1.89.2' then answer_value_text end) as "ipc_s1_select_the_possible_interpersonal_problem_areas_yo",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as "ipc_s1_your_most_distressing_current_symptoms_began",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as "ipc_s1_taskid_session_1_navigator",max(case when linkid = 'f1.40.2' then answer_value_text end) as "ipc_s1_f1402",max(case when linkid = 'f1.79.3' then answer_value_text end) as "ipc_s1_when_did_this_event_happen",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as "ipc_s1_is_there_anything_else_that_we_did_not_discuss_tha",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s1_taskid_session_2_navigator",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'f1.40.3' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or_",max(case when linkid = 'f1.43.2' then answer_value_text end) as "ipc_s1_tell_me_about_your_relationship_with_this_person_h",max(case when linkid = 'f1.69.3' then answer_value_text end) as "ipc_s1_when_did_this_disagreement_happen",max(case when linkid = 'f1.82.2' then answer_value_text end) as "ipc_s1_do_you_want_to_propose_an_interpersonal_formulatio",max(case when linkid = 'f1.87.2' then answer_value_text end) as "ipc_s1_do_you_agree_with_this",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as "ipc_s1_these_are_the_symptoms_you_said_you_are_currently_",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as "ipc_s1_taskid_mood_pdf",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as "ipc_s1_relationships_eg_talk_with_friends_or_vi",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as "ipc_s1_is_there_anything_that_could_get_in_the_way_of_you",max(case when linkid = 'f1.81.3' then answer_value_text end) as "ipc_s1_f1813",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_provider_pdf",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as "ipc_s1_work_on_my_relationship_with_my_parents_",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as "ipc_s1_f13931",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_client_pdf",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as "ipc_s1_of_these_symptoms_which_are_the_most_distressing",max(case when linkid = 'f1.81.4' then answer_value_text end) as "ipc_s1_f1814",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as "ipc_s1_earlier_than_that_you_noticed_symptoms",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as "ipc_s1_community_activities_eg_go_to_a_recreati",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as "ipc_s1_patient_name",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as "ipc_s1_f13932",max(case when linkid = 'f1.40.5' then answer_value_text end) as "ipc_s1_f1405",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as "ipc_s1_when_did_these_symptoms_begin",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as "ipc_s1_xxx",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "ipc_s1_yesterday_",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as "ipc_s1_patient_gender",max(case when linkid = 'f1.40.6' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__54",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as "ipc_s1_phq9_total",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as "ipc_s1_possible_problem_areas",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing_57",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as "ipc_s1_gad7_total",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as "ipc_s1_hobbies_eg_listen_to_music_play_video_ga",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as "ipc_s1_what_was_going_on_in_your_life_when_you_started_to",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s1_ptsd_total",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as "ipc_s1_zfgh",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as "ipc_s1_do_you_agree_with_this_summary",max(case when linkid = 'f1.40.8' then answer_value_text end) as "ipc_s1_f1408",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_mood_rating_session_1_score",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as "ipc_s1_what_about_before_that_was_there_a_time_before_in_",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as "ipc_s1_religionspirituality_eg_pray_or_go_to_se",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s1_mood_rating_total",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as "ipc_s1_person_1_is",max(case when linkid = 'f1.40.9' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__72",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as "ipc_s1_phq9_total_meaning",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as "ipc_s1_what_were_the_symptoms",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as "ipc_s1_with_my_pastor_",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as "ipc_s1_gad7_total_meaning",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as "ipc_s1_f13941",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as "ipc_s1_ptsd_total_meaning_toggle",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as "ipc_s1_when_did_you_notice_these_symptoms",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as "ipc_s1_other",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as "ipc_s1_mood_rating_comment",max(case when linkid = 'f1.38.4' then answer_value_text end) as "ipc_s1_f1384",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as "ipc_s1_f13942",max(case when linkid = 'f1.40.11' then answer_value_text end) as "ipc_s1_f14011",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as "ipc_s1_what_was_happening_then",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ipc_session_1",max(case when linkid = 'f1.40.12' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__87",max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as "ipc_s1_ex",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_89",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as "ipc_s1_person_2_is",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as "ipc_s1_f13951",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as "ipc_s1_f13952",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as "ipc_s1_gud",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_94",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as "ipc_s1_person_3_is",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as "ipc_s1_f13961",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as "ipc_s1_f13962",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_98",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as "ipc_s1_person_4_is",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as "seeing_someone_be_killed_or_seriously_injured",max(case when linkid = 'f1.38.3' then answer_value_text end) as "f1.38.3",max(case when linkid = 'f1.46.2' then answer_value_text end) as "f1.46.2",max(case when linkid = 'task-id-008' then answer_value_text end) as "task-id-008",max(case when linkid = 'task-id-009' then answer_value_text end) as "task-id-009",max(case when linkid = 'task-id-010' then answer_value_text end) as "task-id-010",max(case when linkid = 'task-id-012' then answer_value_text end) as "task-id-012"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:42.699617 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:42.700380 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:12:42.700624 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_start_ipc_s3
[0m09:12:42.701251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:12:42.701470 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:12:42.703940 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:12:42.704362 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:12:42.704651 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:42.705123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:12:42.706467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:42.707840 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup"
[0m09:12:42.708114 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:12:42.708540 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:12:42.710102 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:12:42.710376 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup" cascade
[0m09:12:42.710654 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp" rename to "qr_start_ipc_s1"
[0m09:12:42.711411 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:42.712192 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: Close
[0m09:12:42.712515 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:42.712880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c604a0>]}
[0m09:12:42.713660 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:12:42.714307 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:12:42.714499 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:12:42.715831 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:42.718339 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup"
[0m09:12:42.718687 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:12:42.718958 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup" cascade
[0m09:12:42.719708 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:12:42.720432 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s1: Close
[0m09:12:42.720722 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d68fb0>]}
[0m09:12:42.894160 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m09:12:42.894624 [info ] [Thread-4 (]: 54 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [[32mCREATE VIEW[0m in 0.70s]
[0m09:12:42.895234 [info ] [Thread-1 (]: 53 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [[32mCREATE VIEW[0m in 0.69s]
[0m09:12:42.895615 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_start_ipc_s1
[0m09:12:42.895856 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_spi_subform_4
[0m09:12:42.896053 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_start_ipc_s4
[0m09:12:42.896378 [info ] [Thread-4 (]: 57 of 57 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [RUN]
[0m09:12:42.896722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_start_ipc_s1, now model.engage_analytics.qr_start_ipc_s4)
[0m09:12:42.896923 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_start_ipc_s4
[0m09:12:42.899308 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:12:42.899530 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:12:42.899722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:12:43.288789 [debug] [Thread-2 (]: SQL status: SELECT 97 in 0.584 seconds
[0m09:12:43.293919 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:12:43.294249 [debug] [Thread-3 (]: SQL status: SELECT 91 in 0.593 seconds
[0m09:12:43.295896 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:12:43.296348 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_start_ipc_s3
[0m09:12:43.298282 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:12:43.298587 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_start_ipc_s2
[0m09:12:43.300233 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:12:43.300573 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:12:43.300790 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: BEGIN
[0m09:12:43.300974 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:12:43.301291 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: BEGIN
[0m09:12:43.301804 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:43.302018 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:12:43.302608 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 3 with readable column names
-- Questionnaire ID: 208
-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as "ipc_s3_phq9_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as "ipc_s3_gad7_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as "ipc_s3_ptsd_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as "ipc_s3_ptsd_total_meaning",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s3_taskid_session_3_navigator",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s3_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s3_taskid_session_4_navigator",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as "ipc_s3_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s3_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_provider_pdf",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s3_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ipc_session_3",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_16",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s3_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_18",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s3_observation_id_of_mood_rating_session_3_score",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as "ipc_s3_1b59ddeb483d4b1baf53f3942204589a",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s3_did_you_ever_hit_kick_push_or_slap_the_personno",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s3_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_23",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as "ipc_s3_4554f4b2d15e47e7a10dd77939dd3afc",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_25",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as "ipc_s3_f9a9f4928eb84c718ec6f80ab596430b",max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__28",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__29",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__30",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s3_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as "ipc_s3_59744d4501004d62b1055cbecd973ffd",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as "ipc_s3_6b5fa4342fc34e4bad1189f6260a81f2",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as "ipc_s3_77fc70ba6cac494cb27a77ebce2289e5",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s3_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s3_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as "ipc_s3_has_anything_changed_since_the_last_time_we_met",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s3_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_40",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as "ipc_s3_4ad7384fa3324e4193180d3f9e540ee7",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as "ipc_s3_stage_identified_in_session_2",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_43",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_44",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_45",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as "ipc_s3_b24118e231c54e23af3a1722af72c299",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as "ipc_s3_68b3cbf5b9ef4da49ac1bcbc20f04473",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as "ipc_s3_9e995f48b09249b2a9e4c7e754e446e5",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__49",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s3_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as "ipc_s3_e8b8e5504d6542beacb92f4ac17c7f49",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s3_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s3_example_skills_53",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s3_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s3_example_skills_55",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_56",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_57",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_58",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s3_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_60",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as "ipc_s3_920de190557a423391a34bf293f18214",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as "ipc_s3_95121ef1bfe540ce841c524334644148",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as "ipc_s3_e1a13d53b867440f8622bccebf54f176",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s3_547a07c2f94c4956997f0439626d0251",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as "ipc_s3_8ac792f53f3c49d3a80063c662bf00cd",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__66",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__67",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__68",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s3_a77f07b379134708a35414e503a948f1",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s3_example_skills_70",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_71",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s3_4c95559d86ff4b87a271e52388072a53",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__73",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_77",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as "ipc_s3_8c82f7573f404b09bdf478ee376f75a8",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s3_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__82",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__83",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "gad7_total_meaning",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person_91",max(case when linkid = 'task-id-019' then answer_value_text end) as "task-id-019",max(case when linkid = 'task-id-020' then answer_value_text end) as "task-id-020",max(case when linkid = 'task-id-021' then answer_value_text end) as "task-id-021",max(case when linkid = 'task-id-022' then answer_value_text end) as "task-id-022",max(case when linkid = 'task-id-023' then answer_value_text end) as "task-id-023",max(case when linkid = 'task-id-024' then answer_value_text end) as "task-id-024"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:43.303268 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m09:12:43.303518 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:12:43.304051 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 2 with readable column names
-- Questionnaire ID: 58
-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "ipc_s2_phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "ipc_s2_gad7_total_meaning",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s2_ptsd_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as "ipc_s2_phq9_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as "ipc_s2_summary_when_1",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as "ipc_s2_most_distressing_symptoms",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as "ipc_s2_selected_problem_area",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as "ipc_s2_ptsd_total_meaning_toggle",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as "ipc_s2_gad7_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s2_taskid_session_2_navigator",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as "ipc_s2_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s2_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s2_taskid_session_3_navigator",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as "ipc_s2_have_you_proposed_the_interpersonal_formulation_in",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_provider_pdf",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s2_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as "ipc_s2_a4a9cad504db44e59a9d0f1bf40ca840",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s2_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s2_747188c84fc043ea92b49baa32567f73",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as "ipc_s2_did_the_person_ever_hit_kick_push_or_slap_you",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as "ipc_s2_do_you_agree_with_this",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ipc_session_2",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s2_3d2ccf9a0e7b48a0854044d43b6dacfe",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area_28",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s2_6fb0c7a5a21143ecaf7b5f1079399133",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_mood_rating_session_1_score",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s2_did_you_ever_hit_kick_push_or_slap_the_person",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as "ipc_s2_do_you_still_think_that",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s2_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s2_232484cf1aee4bfaa66e61494587a16a",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s2_9ed77f2a0d5a434db153d8deadfbc3f8",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s2_3bfee97a6a0e4cd0bdb77ffa8d36191f",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree_37",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__39",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__40",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__41",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as "ipc_s2_287593c3417445afa99871d249230943",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s2_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s2_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s2_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s2_665e1595f16948159d24dac265f1809b",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s2_bc8f199a59f04184864db1c0befd26df",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s2_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s2_e17756cd48614dde859cf90241977246",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s2_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as "ipc_s2_is_any_of_the_2_question_above_is_true",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as "ipc_s2_2ef63cf4b37e4216a8e1db6d1b91cc2a",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s2_3e0b76f9090243bab8580b1505e9d168",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s2_9cc2834b0d2843d08811509995cfcdb8",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s2_a7f10195b8594670abbca2498c4fe45f",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__57",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s2_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s2_547a07c2f94c4956997f0439626d0251",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s2_6c1b2aa7f2444d5abfc6e0faef33bfe6",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s2_a77f07b379134708a35414e503a948f1",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s2_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s2_example_skills_63",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s2_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s2_eb8828db167447e7ba9ae3c161160b65",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s2_example_skills_66",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s2_4c95559d86ff4b87a271e52388072a53",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s2_bed17079d1e54bbeaf073d7b6a86243e",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__69",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__70",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__71",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s2_example_skills_72",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s2_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__77",max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__78",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__79",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = 'task-id-013' then answer_value_text end) as "task-id-013",max(case when linkid = 'task-id-014' then answer_value_text end) as "task-id-014",max(case when linkid = 'task-id-015' then answer_value_text end) as "task-id-015",max(case when linkid = 'task-id-016' then answer_value_text end) as "task-id-016",max(case when linkid = 'task-id-018' then answer_value_text end) as "task-id-018"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:43.309696 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:12:43.309958 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:12:43.311579 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:12:43.313105 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:12:43.313376 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp" rename to "qr_start_ipc_s2"
[0m09:12:43.313634 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp" rename to "qr_start_ipc_s3"
[0m09:12:43.315273 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:43.315501 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:43.316206 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:12:43.316818 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:12:43.317018 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:12:43.317213 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:12:43.317480 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:12:43.317653 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:12:43.318786 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:43.320106 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup"
[0m09:12:43.320375 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:43.320760 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:12:43.322072 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup"
[0m09:12:43.322299 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup" cascade
[0m09:12:43.322602 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:12:43.322831 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup" cascade
[0m09:12:43.323314 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:43.323497 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:12:43.324264 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: Close
[0m09:12:43.324876 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: Close
[0m09:12:43.325241 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba4ad0>]}
[0m09:12:43.325726 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca0740>]}
[0m09:12:43.326061 [info ] [Thread-2 (]: 56 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:43.326671 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_start_ipc_s3
[0m09:12:43.326435 [info ] [Thread-3 (]: 55 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [[32mCREATE VIEW[0m in 0.63s]
[0m09:12:43.327016 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_start_ipc_s2
[0m09:12:43.483684 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.584 seconds
[0m09:12:43.489092 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:12:43.490673 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_start_ipc_s4
[0m09:12:43.494045 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:12:43.494676 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:12:43.494890 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: BEGIN
[0m09:12:43.495774 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:12:43.496033 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:12:43.496497 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 4 with readable column names
-- Questionnaire ID: 63
-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as "ipc_s4_phq9_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as "ipc_s4_gad7_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as "ipc_s4_ptsd_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s4_taskid_session_4_navigator",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_provider_pdf",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as "ipc_s4_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_client_pdf",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as "ipc_s4_what_we_know_is_that_symptoms_can_come_back_in_the",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s4_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as "ipc_s4_after_todays_session_i_can_refer_you_for_clinical_",max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as "ipc_s4_after_todays_session_i_will_be_referring_you_for_a",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri_14",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as "ipc_s4_how_does_it_make_you_feel_to_know_that_today_is_ou",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as "ipc_s4_how_do_you_feel_about_today_being_our_last_session",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as "ipc_s4_how_would_you_know_if_your_symptoms_are_coming_bac",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that_",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as "ipc_s4_please_select_how_you_would_like_to_proceed_with_t",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that__21",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s_22",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y_23",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s4_mood_rating_total",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as "ipc_s4_i_am_going_to_provide_you_with_our_agencys_contact",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard_28",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that_",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that__30",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as "ipc_s4_7fef53bc56db47ce8cba8efd4bcbc318",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "did_you_discuss_this_clients_severe_mental_health_screening",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "what_is_the_recommended_plan_to_address_the_probable_severe",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as "feeling_changed",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "referral_details_if_the_client_is_referred_out",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as "rerer",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as "20241031",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as "20250201",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as "is-connected-to-clinical-care-details",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as "is-connected-to-clinical-care-question"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:12:43.500581 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:12:43.502243 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:12:43.502454 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp" rename to "qr_start_ipc_s4"
[0m09:12:43.503554 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:43.504214 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:12:43.504421 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:12:43.504580 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:12:43.505347 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:12:43.506398 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup"
[0m09:12:43.506648 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:12:43.506814 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup" cascade
[0m09:12:43.507312 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:12:43.507931 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: Close
[0m09:12:43.508209 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38942c9c-dc9a-498a-8e4c-de5111be1eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e31fa0>]}
[0m09:12:43.508522 [info ] [Thread-4 (]: 57 of 57 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [[32mCREATE VIEW[0m in 0.61s]
[0m09:12:43.508791 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_start_ipc_s4
[0m09:12:43.510141 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:43.510618 [debug] [MainThread]: On master: BEGIN
[0m09:12:43.510957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:43.526009 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:12:43.526331 [debug] [MainThread]: On master: COMMIT
[0m09:12:43.526507 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:43.526659 [debug] [MainThread]: On master: COMMIT
[0m09:12:43.527107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:43.527325 [debug] [MainThread]: On master: Close
[0m09:12:43.527583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:43.527736 [debug] [MainThread]: Connection 'model.engage_analytics.qr_spi_subform_4' was properly closed.
[0m09:12:43.527871 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s3' was properly closed.
[0m09:12:43.528003 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s2' was properly closed.
[0m09:12:43.528131 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s4' was properly closed.
[0m09:12:43.528412 [info ] [MainThread]: 
[0m09:12:43.528590 [info ] [MainThread]: Finished running 18 incremental models, 39 view models in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m09:12:43.532079 [debug] [MainThread]: Command end result
[0m09:12:43.558321 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:12:43.559675 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:12:43.567911 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:12:43.568155 [info ] [MainThread]: 
[0m09:12:43.568416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:43.568775 [info ] [MainThread]: 
[0m09:12:43.568996 [info ] [MainThread]: Done. PASS=57 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=57
[0m09:12:43.569410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.866725, "process_in_blocks": "0", "process_kernel_time": 0.418944, "process_mem_max_rss": "138739712", "process_out_blocks": "0", "process_user_time": 2.716343}
[0m09:12:43.569699 [debug] [MainThread]: Command `dbt run` succeeded at 09:12:43.569653 after 8.87 seconds
[0m09:12:43.569958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f325a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f32690>]}
[0m09:12:43.570175 [debug] [MainThread]: Flushing usage events
[0m09:12:43.689883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:06.370794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c9c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130d220>]}


============================== 09:20:06.374514 | 22482fe2-a3d9-44bf-918a-c0bf792a01c0 ==============================
[0m09:20:06.374514 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:20:06.374865 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select qr_registration_info', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'introspect': 'True', 'use_colors': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:20:06.378075 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m09:20:06.378479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04636029, "process_in_blocks": "0", "process_kernel_time": 0.084683, "process_mem_max_rss": "106315776", "process_out_blocks": "0", "process_user_time": 0.673489}
[0m09:20:06.378769 [debug] [MainThread]: Command `dbt run` failed at 09:20:06.378721 after 0.05 seconds
[0m09:20:06.378953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130f7d0>]}
[0m09:20:06.379131 [debug] [MainThread]: Flushing usage events
[0m09:20:06.492937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:38.778721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c09f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e21310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e20fe0>]}


============================== 09:25:38.782886 | 0de1ab49-1f52-48b0-99d5-8672a092bd75 ==============================
[0m09:25:38.782886 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:25:38.783249 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'use_colors': 'True', 'empty': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:25:38.891987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d5b7a0>]}
[0m09:25:38.922882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb15b0>]}
[0m09:25:38.923705 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:25:38.977746 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:25:39.074624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m09:25:39.075193 [debug] [MainThread]: Partial parsing: added file: engage_analytics://models/marts/qr_named/qr_registration_info_anon.sql
[0m09:25:39.075374 [debug] [MainThread]: Partial parsing: added file: engage_analytics://models/marts/patient_anon.sql
[0m09:25:39.075555 [debug] [MainThread]: Partial parsing: updated file: engage_analytics://models/marts/resources/patient.sql
[0m09:25:39.213219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a26c0>]}
[0m09:25:39.265366 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:25:39.267411 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:25:39.281742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e38770>]}
[0m09:25:39.282075 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:25:39.282258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11108ad50>]}
[0m09:25:39.284180 [info ] [MainThread]: 
[0m09:25:39.284379 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:25:39.284516 [info ] [MainThread]: 
[0m09:25:39.284755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:25:39.288012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:25:39.293390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:25:39.293765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:25:39.351539 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:25:39.351808 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:25:39.351996 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:25:39.352151 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:25:39.352304 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:25:39.352461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:39.352601 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:25:39.352732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:39.354203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:39.415571 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.061 seconds
[0m09:25:39.415862 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.063 seconds
[0m09:25:39.416049 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.064 seconds
[0m09:25:39.416947 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:25:39.417631 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:25:39.418180 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:25:39.420551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m09:25:39.423724 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:25:39.423935 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:25:39.424231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m09:25:39.424475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:39.424728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m09:25:39.425852 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:25:39.426853 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:25:39.427022 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:25:39.427181 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:25:39.427391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:39.427548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:39.449558 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m09:25:39.449840 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:25:39.450014 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:25:39.450870 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m09:25:39.451122 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m09:25:39.451288 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:25:39.451446 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:25:39.451608 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:25:39.451786 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:25:39.452811 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.003 seconds
[0m09:25:39.453851 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:25:39.454118 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m09:25:39.454915 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:25:39.455154 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m09:25:39.455368 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:25:39.455915 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:25:39.456069 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:25:39.459765 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:25:39.463636 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:39.463841 [debug] [MainThread]: On master: BEGIN
[0m09:25:39.463970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:39.479194 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:25:39.479416 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:39.479594 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:25:39.482898 [debug] [MainThread]: SQL status: SELECT 109 in 0.003 seconds
[0m09:25:39.490778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6e8d0>]}
[0m09:25:39.491068 [debug] [MainThread]: On master: ROLLBACK
[0m09:25:39.492173 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:39.492432 [debug] [MainThread]: On master: BEGIN
[0m09:25:39.493439 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.493597 [debug] [MainThread]: On master: COMMIT
[0m09:25:39.493737 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:39.493857 [debug] [MainThread]: On master: COMMIT
[0m09:25:39.494390 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:25:39.494522 [debug] [MainThread]: On master: Close
[0m09:25:39.498234 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m09:25:39.498486 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m09:25:39.498929 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m09:25:39.498765 [info ] [Thread-1 (]: 1 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m09:25:39.499268 [info ] [Thread-2 (]: 2 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m09:25:39.499551 [info ] [Thread-3 (]: 3 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m09:25:39.499779 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m09:25:39.499976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_careplans)
[0m09:25:39.500159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_careteams)
[0m09:25:39.500325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_encounter)
[0m09:25:39.500703 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m09:25:39.500548 [info ] [Thread-4 (]: 4 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m09:25:39.500904 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m09:25:39.501065 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m09:25:39.507625 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m09:25:39.507998 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m09:25:39.510408 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m09:25:39.512530 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m09:25:39.512951 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m09:25:39.516001 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m09:25:39.516391 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m09:25:39.523025 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m09:25:39.523303 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m09:25:39.544636 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:25:39.545115 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:25:39.547962 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:25:39.548173 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m09:25:39.548444 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

    
  
    

  create temporary table "stg_careplans__dbt_tmp092539530911"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans")

  );
  
  
[0m09:25:39.548713 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

    
  
    

  create temporary table "stg_encounter__dbt_tmp092539536890"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter")

  );
  
  
[0m09:25:39.548931 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

    
  
    

  create temporary table "stg_careteams__dbt_tmp092539547301"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams")

  );
  
  
[0m09:25:39.550567 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:25:39.550749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:39.550922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:39.551119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:39.551300 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

    
  
    

  create temporary table "stg_locations__dbt_tmp092539549951"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations")

  );
  
  
[0m09:25:39.551714 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:25:39.582464 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.031 seconds
[0m09:25:39.582808 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.031 seconds
[0m09:25:39.587004 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m09:25:39.590046 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:25:39.591531 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:25:39.591813 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.041 seconds
[0m09:25:39.593326 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:25:39.593577 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m09:25:39.593809 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m09:25:39.595362 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:25:39.595560 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m09:25:39.595800 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m09:25:39.596236 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.596437 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:39.596626 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:25:39.596794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.596963 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:25:39.597107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.597281 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams__dbt_tmp092539547301'
        
      order by ordinal_position

  
[0m09:25:39.597443 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:25:39.597603 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter__dbt_tmp092539536890'
        
      order by ordinal_position

  
[0m09:25:39.597762 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:25:39.597981 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans__dbt_tmp092539530911'
        
      order by ordinal_position

  
[0m09:25:39.598226 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations__dbt_tmp092539549951'
        
      order by ordinal_position

  
[0m09:25:39.603437 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.005 seconds
[0m09:25:39.603728 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.005 seconds
[0m09:25:39.606512 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:25:39.606750 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.009 seconds
[0m09:25:39.606912 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.008 seconds
[0m09:25:39.608578 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:25:39.608861 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.611292 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:25:39.612912 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:25:39.613146 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.613411 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.613642 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.615296 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:25:39.619000 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:25:39.619260 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.005 seconds
[0m09:25:39.619464 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.006 seconds
[0m09:25:39.619616 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.006 seconds
[0m09:25:39.619799 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.621586 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:25:39.623052 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:25:39.624432 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:25:39.624663 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.624895 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.625132 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.626381 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:25:39.632318 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.007 seconds
[0m09:25:39.632595 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.007 seconds
[0m09:25:39.632813 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.008 seconds
[0m09:25:39.634442 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m09:25:39.635503 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m09:25:39.636436 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m09:25:39.637422 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m09:25:39.638076 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:25:39.638282 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_encounter__dbt_tmp092539536890" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" ("id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at"
        from "stg_encounter__dbt_tmp092539536890"
    )
  
[0m09:25:39.638542 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:25:39.638777 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careplans__dbt_tmp092539530911" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" ("id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at"
        from "stg_careplans__dbt_tmp092539530911"
    )
  
[0m09:25:39.639016 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:25:39.639242 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_locations__dbt_tmp092539549951" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" ("id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference")
    (
        select "id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference"
        from "stg_locations__dbt_tmp092539549951"
    )
  
[0m09:25:39.639458 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.639679 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:25:39.639916 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.646554 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m09:25:39.646835 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:25:39.647052 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careteams__dbt_tmp092539547301" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" ("id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource")
    (
        select "id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource"
        from "stg_careteams__dbt_tmp092539547301"
    )
  
[0m09:25:39.647654 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:25:39.648160 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:25:39.648340 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:25:39.648564 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:25:39.648755 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:25:39.648924 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:25:39.649077 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:25:39.649328 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:25:39.651009 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:25:39.651580 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:25:39.651748 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:25:39.651899 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:25:39.652485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:25:39.653331 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m09:25:39.653522 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:25:39.653894 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m09:25:39.654969 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:25:39.655333 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m09:25:39.655558 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m09:25:39.655910 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m09:25:39.656225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111092f00>]}
[0m09:25:39.656729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ddbb0>]}
[0m09:25:39.656567 [info ] [Thread-1 (]: 1 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mINSERT 0 0[0m in 0.15s]
[0m09:25:39.657370 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111579640>]}
[0m09:25:39.657607 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114aa8a0>]}
[0m09:25:39.657890 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m09:25:39.657048 [info ] [Thread-4 (]: 4 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mINSERT 0 0[0m in 0.15s]
[0m09:25:39.658263 [info ] [Thread-3 (]: 3 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mINSERT 0 0[0m in 0.16s]
[0m09:25:39.658567 [info ] [Thread-2 (]: 2 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mINSERT 0 0[0m in 0.16s]
[0m09:25:39.658807 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m09:25:39.659114 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m09:25:39.659355 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m09:25:39.659576 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m09:25:39.659784 [info ] [Thread-1 (]: 5 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m09:25:39.659985 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_organizations
[0m09:25:39.660174 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_patient
[0m09:25:39.660364 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_practitioner
[0m09:25:39.660602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_organization_affiliations)
[0m09:25:39.660838 [info ] [Thread-4 (]: 6 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m09:25:39.661160 [info ] [Thread-3 (]: 7 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m09:25:39.661445 [info ] [Thread-2 (]: 8 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m09:25:39.661658 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m09:25:39.661864 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_organizations)
[0m09:25:39.662057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_patient)
[0m09:25:39.662244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_practitioner)
[0m09:25:39.664603 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.664817 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_organizations
[0m09:25:39.664991 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_patient
[0m09:25:39.665152 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m09:25:39.667396 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m09:25:39.670625 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m09:25:39.673005 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m09:25:39.673418 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m09:25:39.675963 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.676269 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

    
  
    

  create temporary table "stg_organization_affiliations__dbt_tmp092539675106"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations")

  );
  
  
[0m09:25:39.676554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:39.676777 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_practitioner
[0m09:25:39.678849 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:25:39.679083 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_patient
[0m09:25:39.679303 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

    
  
    

  create temporary table "stg_practitioner__dbt_tmp092539678123"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner")

  );
  
  
[0m09:25:39.679507 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_organizations
[0m09:25:39.681181 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:25:39.681378 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:39.682998 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:25:39.683231 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

    
  
    

  create temporary table "stg_patient__dbt_tmp092539680547"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient")

  );
  
  
[0m09:25:39.683574 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

    
  
    

  create temporary table "stg_organizations__dbt_tmp092539682406"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  -- this filter will only be applied on an incremental run
   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations")

  );
  
  
[0m09:25:39.683833 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:39.684082 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:39.710436 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.026 seconds
[0m09:25:39.710786 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m09:25:39.712741 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:25:39.713005 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.032 seconds
[0m09:25:39.713208 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.029 seconds
[0m09:25:39.714749 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.715018 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m09:25:39.717234 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:25:39.718642 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:25:39.718845 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m09:25:39.719071 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m09:25:39.719274 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: BEGIN
[0m09:25:39.719623 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.719817 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:25:39.720013 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:39.720156 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.720311 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations__dbt_tmp092539682406'
        
      order by ordinal_position

  
[0m09:25:39.720461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.720611 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:25:39.720760 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:25:39.720952 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.721205 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient__dbt_tmp092539680547'
        
      order by ordinal_position

  
[0m09:25:39.721480 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner__dbt_tmp092539678123'
        
      order by ordinal_position

  
[0m09:25:39.721675 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations__dbt_tmp092539675106'
        
      order by ordinal_position

  
[0m09:25:39.724507 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:25:39.726210 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:25:39.726490 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m09:25:39.726735 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.726913 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.005 seconds
[0m09:25:39.727064 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.005 seconds
[0m09:25:39.728773 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.730219 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:25:39.731619 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:25:39.731821 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.732021 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m09:25:39.732228 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.732408 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.734104 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:25:39.734339 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:25:39.734576 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.736285 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.736552 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.002 seconds
[0m09:25:39.736731 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:25:39.736911 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.738457 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:25:39.739798 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:25:39.739972 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m09:25:39.740202 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.740416 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.741534 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m09:25:39.741777 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:25:39.743849 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.744142 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.002 seconds
[0m09:25:39.745162 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m09:25:39.745389 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.003 seconds
[0m09:25:39.746225 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m09:25:39.746587 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:25:39.746795 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_patient__dbt_tmp092539680547" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" ("id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at")
    (
        select "id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at"
        from "stg_patient__dbt_tmp092539680547"
    )
  
[0m09:25:39.747021 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.747220 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organization_affiliations__dbt_tmp092539675106" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" ("id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at"
        from "stg_organization_affiliations__dbt_tmp092539675106"
    )
  
[0m09:25:39.747447 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:25:39.747630 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organizations__dbt_tmp092539682406" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" ("id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at")
    (
        select "id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at"
        from "stg_organizations__dbt_tmp092539682406"
    )
  
[0m09:25:39.747820 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.748055 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.748780 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:25:39.749000 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.749195 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:25:39.749772 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:25:39.750007 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:25:39.750656 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:25:39.750853 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner__dbt_tmp092539678123" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" ("id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at"
        from "stg_practitioner__dbt_tmp092539678123"
    )
  
[0m09:25:39.751042 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:25:39.751203 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:25:39.751370 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:25:39.751549 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:25:39.751770 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:25:39.752327 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.752938 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:25:39.753118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:39.753282 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:39.753448 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:25:39.753599 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:39.753955 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m09:25:39.754255 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: Close
[0m09:25:39.754410 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:25:39.754689 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: Close
[0m09:25:39.755020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c7c80>]}
[0m09:25:39.755296 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11331a360>]}
[0m09:25:39.755750 [info ] [Thread-1 (]: 5 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mINSERT 0 0[0m in 0.09s]
[0m09:25:39.756112 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f4dc10>]}
[0m09:25:39.756808 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m09:25:39.756501 [info ] [Thread-3 (]: 7 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mINSERT 0 0[0m in 0.09s]
[0m09:25:39.757462 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:39.757271 [info ] [Thread-4 (]: 6 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mINSERT 0 0[0m in 0.09s]
[0m09:25:39.757783 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m09:25:39.758215 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_patient
[0m09:25:39.758647 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: Close
[0m09:25:39.758906 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_organizations
[0m09:25:39.759314 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m09:25:39.759145 [info ] [Thread-1 (]: 9 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m09:25:39.759636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114de6f0>]}
[0m09:25:39.759811 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_task
[0m09:25:39.760038 [info ] [Thread-3 (]: 10 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m09:25:39.760317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_practitioner_roles)
[0m09:25:39.760684 [info ] [Thread-2 (]: 8 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mINSERT 0 0[0m in 0.10s]
[0m09:25:39.760969 [info ] [Thread-4 (]: 11 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m09:25:39.761232 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.stg_questionnaire_response)
[0m09:25:39.761449 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m09:25:39.761716 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_practitioner
[0m09:25:39.761899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_task)
[0m09:25:39.762073 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m09:25:39.764551 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.764860 [debug] [Thread-2 (]: Began running node model.engage_analytics.encounters
[0m09:25:39.765101 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_task
[0m09:25:39.767109 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.770135 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m09:25:39.767649 [info ] [Thread-2 (]: 12 of 59 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m09:25:39.770618 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m09:25:39.770881 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.encounters)
[0m09:25:39.772938 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.773206 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.encounters
[0m09:25:39.773407 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m09:25:39.773599 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_task
[0m09:25:39.773796 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

    
  
    

  create temporary table "stg_practitioner_roles__dbt_tmp092539772166"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles")

  );
  
  
[0m09:25:39.778922 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.780655 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.782471 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:25:39.782743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:39.782975 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m09:25:39.783290 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

    
  
    

  create temporary table "stg_questionnaire_response__dbt_tmp092539780097"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response")

  );
  
  
[0m09:25:39.783585 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

    
  
    

  create temporary table "stg_task__dbt_tmp092539781846"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task")

  );
  
  
[0m09:25:39.783948 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:39.784161 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:39.784385 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:39.818533 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.035 seconds
[0m09:25:39.818892 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m09:25:39.819803 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.822529 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.822843 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.039 seconds
[0m09:25:39.823060 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m09:25:39.823333 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m09:25:39.824723 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.825050 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m09:25:39.825653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.826059 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.826302 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.826512 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles__dbt_tmp092539772166'
        
      order by ordinal_position

  
[0m09:25:39.826708 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.826915 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response__dbt_tmp092539780097'
        
      order by ordinal_position

  
[0m09:25:39.828208 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:25:39.829083 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.829292 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m09:25:39.830954 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:25:39.831208 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.004 seconds
[0m09:25:39.832936 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.833229 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.004 seconds
[0m09:25:39.834998 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.835270 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.836033 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.836256 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.836523 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m09:25:39.838852 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:25:39.839124 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:25:39.840793 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.840978 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.004 seconds
[0m09:25:39.842322 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m09:25:39.842535 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.843944 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.844336 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.844793 [debug] [Thread-2 (]: Began executing node model.engage_analytics.encounters
[0m09:25:39.846945 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.847235 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.003 seconds
[0m09:25:39.847450 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m09:25:39.847769 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    
  
    

  create temporary table "encounters__dbt_tmp092539846150"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."encounters")

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

where e._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
)

  );
  
  
[0m09:25:39.849081 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.850056 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.850718 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.850944 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_questionnaire_response__dbt_tmp092539780097" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" ("id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at")
    (
        select "id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at"
        from "stg_questionnaire_response__dbt_tmp092539780097"
    )
  
[0m09:25:39.851183 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.851392 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner_roles__dbt_tmp092539772166" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" ("id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at"
        from "stg_practitioner_roles__dbt_tmp092539772166"
    )
  
[0m09:25:39.852196 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.852898 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:25:39.853102 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:25:39.853278 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:25:39.853506 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:25:39.854399 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:25:39.854627 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m09:25:39.854821 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:25:39.854995 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:39.856445 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.856641 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:25:39.857086 [debug] [Thread-3 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m09:25:39.857259 [debug] [Thread-2 (]: On model.engage_analytics.encounters: BEGIN
[0m09:25:39.857511 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.073 seconds
[0m09:25:39.857863 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11330fc20>]}
[0m09:25:39.859965 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:25:39.860193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:25:39.860415 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m09:25:39.860797 [info ] [Thread-3 (]: 10 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mINSERT 0 0[0m in 0.10s]
[0m09:25:39.861023 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: BEGIN
[0m09:25:39.861423 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m09:25:39.861611 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.861865 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m09:25:39.862079 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'encounters__dbt_tmp092539846150'
        
      order by ordinal_position

  
[0m09:25:39.862316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132eb0b0>]}
[0m09:25:39.862525 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:39.862750 [debug] [Thread-3 (]: Began running node model.engage_analytics.unnested_careteams
[0m09:25:39.863255 [info ] [Thread-1 (]: 9 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mINSERT 0 0[0m in 0.10s]
[0m09:25:39.863495 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:25:39.863767 [info ] [Thread-3 (]: 13 of 59 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m09:25:39.864051 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m09:25:39.864236 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_task__dbt_tmp092539781846'
        
      order by ordinal_position

  
[0m09:25:39.864445 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.unnested_careteams)
[0m09:25:39.864626 [debug] [Thread-1 (]: Began running node model.engage_analytics.organization_affiliations
[0m09:25:39.864854 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m09:25:39.865079 [info ] [Thread-1 (]: 14 of 59 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m09:25:39.866650 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m09:25:39.866964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.organization_affiliations)
[0m09:25:39.867212 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.004 seconds
[0m09:25:39.867481 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m09:25:39.869295 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.871442 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m09:25:39.871748 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:39.872011 [debug] [Thread-3 (]: Began executing node model.engage_analytics.unnested_careteams
[0m09:25:39.872205 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.007 seconds
[0m09:25:39.878892 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.006 seconds
[0m09:25:39.882059 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m09:25:39.884172 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:25:39.884452 [debug] [Thread-1 (]: Began executing node model.engage_analytics.organization_affiliations
[0m09:25:39.886022 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.886298 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.888264 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:25:39.888520 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:39.888927 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

    
  
    

  create temporary table "organization_affiliations__dbt_tmp092539887527"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

where s._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
)

  );
  
  
[0m09:25:39.889275 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:25:39.889493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:39.889686 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m09:25:39.889929 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:39.891195 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:25:39.891477 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.003 seconds
[0m09:25:39.892639 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m09:25:39.894487 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:25:39.894781 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:25:39.895121 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.895316 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."encounters" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "encounters__dbt_tmp092539846150" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."encounters" ("id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at")
    (
        select "id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at"
        from "encounters__dbt_tmp092539846150"
    )
  
[0m09:25:39.896159 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.896785 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m09:25:39.896986 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:25:39.897191 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:25:39.899233 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m09:25:39.899531 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m09:25:39.900393 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:25:39.900643 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_task__dbt_tmp092539781846" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" ("id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at")
    (
        select "id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at"
        from "stg_task__dbt_tmp092539781846"
    )
  
[0m09:25:39.900910 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:39.901425 [debug] [Thread-2 (]: On model.engage_analytics.encounters: Close
[0m09:25:39.901724 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132e0380>]}
[0m09:25:39.901916 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.902251 [info ] [Thread-2 (]: 12 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mINSERT 0 0[0m in 0.13s]
[0m09:25:39.902977 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:25:39.903263 [debug] [Thread-2 (]: Finished running node model.engage_analytics.encounters
[0m09:25:39.903467 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:25:39.903767 [debug] [Thread-2 (]: Began running node model.engage_analytics.patient
[0m09:25:39.904031 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:25:39.904279 [info ] [Thread-2 (]: 15 of 59 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m09:25:39.904582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.patient)
[0m09:25:39.904802 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.patient
[0m09:25:39.907363 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m09:25:39.907663 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:25:39.908227 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: Close
[0m09:25:39.908471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m09:25:39.908837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113423a70>]}
[0m09:25:39.909088 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:25:39.909709 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m09:25:39.909962 [debug] [Thread-2 (]: Began executing node model.engage_analytics.patient
[0m09:25:39.909488 [info ] [Thread-4 (]: 11 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mINSERT 0 0[0m in 0.15s]
[0m09:25:39.910264 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:25:39.912452 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:25:39.912760 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:39.913064 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_task
[0m09:25:39.914743 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:25:39.915052 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp092539911597"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    DATE_PART('year', AGE(stp.birthDate::date))::integer as age_years,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m09:25:39.918908 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:25:39.919290 [debug] [Thread-4 (]: Began running node model.engage_analytics.organizations
[0m09:25:39.919544 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m09:25:39.919796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:39.920018 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams" rename to "unnested_careteams__dbt_backup"
[0m09:25:39.920310 [info ] [Thread-4 (]: 16 of 59 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m09:25:39.920739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.organizations)
[0m09:25:39.920944 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.organizations
[0m09:25:39.922879 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:25:39.923116 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m09:25:39.923356 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:25:39.923589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m09:25:39.923774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:39.925221 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:25:39.925414 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:25:39.925735 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m09:25:39.926100 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations__dbt_tmp092539887527'
        
      order by ordinal_position

  
[0m09:25:39.927077 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:39.928919 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:25:39.929179 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:25:39.929345 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:25:39.932476 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m09:25:39.935613 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:25:39.935950 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m09:25:39.936355 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:39.940470 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m09:25:39.945639 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:25:39.945975 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m09:25:39.946206 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m09:25:39.947968 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:25:39.948229 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:39.948495 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:25:39.949338 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: Close
[0m09:25:39.949657 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11156b770>]}
[0m09:25:39.949992 [info ] [Thread-3 (]: 13 of 59 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.09s]
[0m09:25:39.950270 [debug] [Thread-3 (]: Finished running node model.engage_analytics.unnested_careteams
[0m09:25:39.950465 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m09:25:39.950675 [info ] [Thread-3 (]: 17 of 59 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m09:25:39.950888 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.int_qr_answers_long)
[0m09:25:39.951059 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m09:25:39.951296 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m09:25:39.953233 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m09:25:39.954549 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m09:25:39.954802 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.031 seconds
[0m09:25:39.955921 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m09:25:39.956402 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m09:25:39.956685 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:25:39.956956 [debug] [Thread-4 (]: Began executing node model.engage_analytics.organizations
[0m09:25:39.959260 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m09:25:39.959652 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.040 seconds
[0m09:25:39.959908 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organization_affiliations__dbt_tmp092539887527" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" ("id", "organization_id", "location_id", "_airbyte_emitted_at")
    (
        select "id", "organization_id", "location_id", "_airbyte_emitted_at"
        from "organization_affiliations__dbt_tmp092539887527"
    )
  
[0m09:25:39.962263 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:25:39.962877 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:25:39.965325 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:25:39.965732 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    
  
    

  create temporary table "organizations__dbt_tmp092539961327"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

where o._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
)

  );
  
  
[0m09:25:39.965978 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m09:25:39.966154 [debug] [Thread-2 (]: On model.engage_analytics.patient: BEGIN
[0m09:25:39.966391 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:39.966613 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:39.967774 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:25:39.968022 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:25:39.968273 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.002 seconds
[0m09:25:39.968546 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:25:39.968753 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m09:25:39.970335 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:25:39.970728 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:25:39.970997 [debug] [Thread-4 (]: On model.engage_analytics.organizations: BEGIN
[0m09:25:39.971257 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp092539911597'
        
      order by ordinal_position

  
[0m09:25:39.971511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:39.972270 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: Close
[0m09:25:39.972475 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:39.972697 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:25:39.972903 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organizations__dbt_tmp092539961327'
        
      order by ordinal_position

  
[0m09:25:39.973319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113453770>]}
[0m09:25:39.973684 [info ] [Thread-1 (]: 14 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mINSERT 0 0[0m in 0.11s]
[0m09:25:39.973964 [debug] [Thread-1 (]: Finished running node model.engage_analytics.organization_affiliations
[0m09:25:39.974318 [debug] [Thread-1 (]: Began running node model.engage_analytics.int_qr_header
[0m09:25:39.974581 [info ] [Thread-1 (]: 18 of 59 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m09:25:39.974826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.int_qr_header)
[0m09:25:39.975010 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.int_qr_header
[0m09:25:39.976671 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m09:25:39.977299 [debug] [Thread-1 (]: Began executing node model.engage_analytics.int_qr_header
[0m09:25:39.977614 [debug] [Thread-2 (]: SQL status: SELECT 15 in 0.006 seconds
[0m09:25:39.979275 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m09:25:39.979477 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.006 seconds
[0m09:25:39.983051 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:25:40.022086 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:25:40.022348 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m09:25:40.022616 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:40.022972 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:40.023295 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:25:40.023471 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:25:40.023708 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m09:25:40.023999 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m09:25:40.024307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:40.025877 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.002 seconds
[0m09:25:40.027582 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:25:40.027853 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:40.028054 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.004 seconds
[0m09:25:40.028239 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:40.029897 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:25:40.031622 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:25:40.031940 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" rename to "int_qr_answers_long__dbt_backup"
[0m09:25:40.032219 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:40.033489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:40.033730 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.002 seconds
[0m09:25:40.035234 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:25:40.035461 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.003 seconds
[0m09:25:40.036573 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m09:25:40.036850 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m09:25:40.037970 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m09:25:40.038671 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:25:40.038952 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organizations__dbt_tmp092539961327" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organizations" ("id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at")
    (
        select "id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at"
        from "organizations__dbt_tmp092539961327"
    )
  
[0m09:25:40.039227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:25:40.039542 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:40.039794 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:25:40.040511 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:25:40.040761 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:25:40.041003 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:40.041224 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m09:25:40.041424 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:25:40.041609 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp092539911597" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp092539911597"
    )
  
[0m09:25:40.042289 [debug] [Thread-4 (]: On model.engage_analytics.organizations: COMMIT
[0m09:25:40.042500 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:25:40.042709 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:25:40.042922 [debug] [Thread-4 (]: On model.engage_analytics.organizations: COMMIT
[0m09:25:40.043299 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:40.043962 [debug] [Thread-2 (]: On model.engage_analytics.patient: COMMIT
[0m09:25:40.044151 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:40.044319 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:40.044475 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:25:40.044615 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:40.046278 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:25:40.047680 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m09:25:40.047849 [debug] [Thread-2 (]: On model.engage_analytics.patient: COMMIT
[0m09:25:40.048185 [debug] [Thread-4 (]: On model.engage_analytics.organizations: Close
[0m09:25:40.048356 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" rename to "int_qr_header__dbt_backup"
[0m09:25:40.048610 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:25:40.048923 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113295250>]}
[0m09:25:40.049126 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m09:25:40.049349 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:40.049559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:40.050210 [debug] [Thread-2 (]: On model.engage_analytics.patient: Close
[0m09:25:40.049873 [info ] [Thread-4 (]: 16 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mINSERT 0 0[0m in 0.13s]
[0m09:25:40.051686 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:25:40.051979 [debug] [Thread-4 (]: Finished running node model.engage_analytics.organizations
[0m09:25:40.052252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113242540>]}
[0m09:25:40.052500 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m09:25:40.052771 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_tags
[0m09:25:40.053142 [info ] [Thread-2 (]: 15 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.15s]
[0m09:25:40.053434 [info ] [Thread-4 (]: 19 of 59 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m09:25:40.053694 [debug] [Thread-2 (]: Finished running node model.engage_analytics.patient
[0m09:25:40.053895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:40.054126 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.int_qr_tags)
[0m09:25:40.054336 [debug] [Thread-2 (]: Began running node model.engage_analytics.practitioner_role
[0m09:25:40.054968 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:25:40.055265 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m09:25:40.055519 [info ] [Thread-2 (]: 20 of 59 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m09:25:40.055771 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:25:40.058793 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m09:25:40.059176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.practitioner_role)
[0m09:25:40.059443 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:25:40.059681 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.practitioner_role
[0m09:25:40.062027 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m09:25:40.062328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:40.063515 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m09:25:40.063795 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:25:40.063971 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m09:25:40.064162 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_tags
[0m09:25:40.065765 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:25:40.065999 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

    
  
    

  create temporary table "int_qr_tags__dbt_tmp092540065178"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags")

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m09:25:40.066232 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:40.066452 [debug] [Thread-2 (]: Began executing node model.engage_analytics.practitioner_role
[0m09:25:40.068517 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:25:40.068809 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

    
  
    

  create temporary table "practitioner_role__dbt_tmp092540067507"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

where spr._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01')
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
)

  );
  
  
[0m09:25:40.069010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:40.070948 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:25:40.071751 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m09:25:40.071979 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m09:25:40.072748 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_header: Close
[0m09:25:40.073057 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132437a0>]}
[0m09:25:40.073368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b19a0>]}
[0m09:25:40.073737 [info ] [Thread-3 (]: 17 of 59 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.12s]
[0m09:25:40.074089 [info ] [Thread-1 (]: 18 of 59 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.10s]
[0m09:25:40.074465 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m09:25:40.074823 [debug] [Thread-1 (]: Finished running node model.engage_analytics.int_qr_header
[0m09:25:40.075092 [debug] [Thread-3 (]: Began running node model.engage_analytics.patient_anon
[0m09:25:40.075500 [info ] [Thread-3 (]: 21 of 59 START sql view model engage_analytics_engage_analytics_mart.patient_anon  [RUN]
[0m09:25:40.075813 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.patient_anon)
[0m09:25:40.076029 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.patient_anon
[0m09:25:40.077737 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.patient_anon"
[0m09:25:40.078188 [debug] [Thread-3 (]: Began executing node model.engage_analytics.patient_anon
[0m09:25:40.079707 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.patient_anon"
[0m09:25:40.080115 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:25:40.080287 [debug] [Thread-3 (]: On model.engage_analytics.patient_anon: BEGIN
[0m09:25:40.080442 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:40.086630 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:25:40.088349 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:25:40.088555 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m09:25:40.088750 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:25:40.090259 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:25:40.090522 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:25:40.090811 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m09:25:40.091073 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:25:40.091384 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags__dbt_tmp092540065178'
        
      order by ordinal_position

  
[0m09:25:40.091919 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:40.092188 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:25:40.092368 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role__dbt_tmp092540067507'
        
      order by ordinal_position

  
[0m09:25:40.095382 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.004 seconds
[0m09:25:40.098256 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:25:40.098619 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.006 seconds
[0m09:25:40.098857 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m09:25:40.099098 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:25:40.100873 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:25:40.101106 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:25:40.101339 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:40.101563 [debug] [Thread-3 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized patient view with masked PII fields for data sharing
-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number

select 
    -- Use hashed ID for referential integrity while maintaining privacy
    MD5(p.id::text) as patient_id_hash,
    
    -- Demographic information (non-PII)
    p.gender,
    p.age_years,  -- Age instead of birth_date for privacy
    p.deceased,
    p.active,
    p.registration_date,
    
    -- Masked name fields
    'REDACTED' as name_family_masked,
    'REDACTED' as name_given_masked,
    
    -- Masked contact information
    'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, 'XXXX'), 4) as phone_number_masked,
    
    -- Location and organization (reference IDs only, no PII)
    p.location_id,
    p.practitioner_id,
    p.practitioner_organization_id,
    p.practitioner_careteam_id,
    
    -- Metadata
    p._airbyte_emitted_at,
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."patient" p
  );
[0m09:25:40.102830 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column p.age_years does not exist
LINE 18:     p.age_years,  -- Age instead of birth_date for privacy
             ^

[0m09:25:40.103034 [debug] [Thread-3 (]: On model.engage_analytics.patient_anon: ROLLBACK
[0m09:25:40.103224 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.002 seconds
[0m09:25:40.104860 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:25:40.105177 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:25:40.105402 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.004 seconds
[0m09:25:40.105673 [debug] [Thread-3 (]: On model.engage_analytics.patient_anon: Close
[0m09:25:40.107322 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:25:40.107560 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.002 seconds
[0m09:25:40.107774 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:40.109379 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m09:25:40.109890 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:25:40.110095 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" as DBT_INTERNAL_DEST
        where (resource_id) in (
            select distinct resource_id
            from "int_qr_tags__dbt_tmp092540065178" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" ("resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version")
    (
        select "resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version"
        from "int_qr_tags__dbt_tmp092540065178"
    )
  
[0m09:25:40.111093 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:40.111792 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:25:40.112058 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:25:40.112381 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:25:40.113546 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m09:25:40.113821 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:25:40.114289 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:25:40.114529 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioner_role__dbt_tmp092540067507" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" ("id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at")
    (
        select "id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at"
        from "practitioner_role__dbt_tmp092540067507"
    )
  
[0m09:25:40.114962 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:40.115367 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: Close
[0m09:25:40.115636 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:40.116012 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132e0d40>]}
[0m09:25:40.116693 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:25:40.117120 [info ] [Thread-4 (]: 19 of 59 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mINSERT 0 0[0m in 0.06s]
[0m09:25:40.117419 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:25:40.117735 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_tags
[0m09:25:40.117971 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:25:40.118662 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m09:25:40.118851 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:25:40.119283 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:40.119116 [info ] [Thread-1 (]: 22 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m09:25:40.119548 [info ] [Thread-4 (]: 23 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [RUN]
[0m09:25:40.119971 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: Close
[0m09:25:40.120216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.qr_1_month_follow_up)
[0m09:25:40.120414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.qr_common_mental_health_symptoms)
[0m09:25:40.120715 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113259af0>]}
[0m09:25:40.120920 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m09:25:40.121144 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:25:40.121609 [info ] [Thread-2 (]: 20 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mINSERT 0 0[0m in 0.06s]
[0m09:25:40.128804 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:25:40.131290 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:25:40.131611 [debug] [Thread-2 (]: Finished running node model.engage_analytics.practitioner_role
[0m09:25:40.131843 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:40.132080 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:40.132310 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_confidential_s1
[0m09:25:40.132569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:40.132774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:40.133005 [info ] [Thread-2 (]: 24 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [RUN]
[0m09:25:40.134125 [debug] [Thread-3 (]: Database Error in model patient_anon (models/marts/patient_anon.sql)
  column p.age_years does not exist
  LINE 18:     p.age_years,  -- Age instead of birth_date for privacy
               ^
  compiled code at target/run/engage_analytics/models/marts/patient_anon.sql
[0m09:25:40.134485 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.qr_confidential_s1)
[0m09:25:40.134817 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113249d30>]}
[0m09:25:40.135056 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_confidential_s1
[0m09:25:40.135513 [error] [Thread-3 (]: 21 of 59 ERROR creating sql view model engage_analytics_engage_analytics_mart.patient_anon  [[31mERROR[0m in 0.06s]
[0m09:25:40.138185 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:25:40.138574 [debug] [Thread-3 (]: Finished running node model.engage_analytics.patient_anon
[0m09:25:40.138835 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:40.139098 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_financial_wellness_tool
[0m09:25:40.139363 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.patient_anon' to be skipped because of status 'error'.  Reason: Database Error in model patient_anon (models/marts/patient_anon.sql)
  column p.age_years does not exist
  LINE 18:     p.age_years,  -- Age instead of birth_date for privacy
               ^
  compiled code at target/run/engage_analytics/models/marts/patient_anon.sql.
[0m09:25:40.139559 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:40.139838 [info ] [Thread-3 (]: 25 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [RUN]
[0m09:25:40.140627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient_anon, now model.engage_analytics.qr_financial_wellness_tool)
[0m09:25:40.140816 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_financial_wellness_tool
[0m09:25:40.143329 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:25:40.143948 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:40.144273 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:40.894979 [debug] [Thread-4 (]: SQL status: SELECT 36 in 0.762 seconds
[0m09:25:40.899231 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:25:40.899931 [debug] [Thread-3 (]: SQL status: SELECT 23 in 0.756 seconds
[0m09:25:40.901408 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:25:40.902121 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:25:40.905032 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:25:40.905398 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_financial_wellness_tool
[0m09:25:40.907015 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:25:40.907439 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:25:40.907654 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: BEGIN
[0m09:25:40.907865 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:25:40.908100 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: BEGIN
[0m09:25:40.908732 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.769 seconds
[0m09:25:40.908921 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:40.909098 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:40.909873 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_confidential_s1"
[0m09:25:40.910148 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:25:40.910412 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:25:40.910792 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Common Mental Health Symptoms with readable column names
-- Questionnaire ID: q-common-mental-health-symptoms
-- Source file: questionnaire/assessments/common-mental-health-symptoms.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "total_score",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrfeeling",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "total_score_meaning",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brrepeat",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "total_score_5",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrloss_of",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brhaving",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "total_score_meaning_9",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "how_difficult_have_these_problems_made_it_for_you_to_do_your",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "total_score_11",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brfeelin",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "total_score_meaning_13",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi_14",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrhaving",max(case when linkid = 'f1.10.1' then answer_value_text end) as "f1.10.1",max(case when linkid = 'f1.11.1' then answer_value_text end) as "f1.11.1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "f1.15.1",max(case when linkid = 'f1.16.1' then answer_value_text end) as "f1.16.1",max(case when linkid = 'f1.17.1' then answer_value_text end) as "f1.17.1",max(case when linkid = 'f1.18.1' then answer_value_text end) as "f1.18.1",max(case when linkid = 'f1.19.1' then answer_value_text end) as "f1.19.1",max(case when linkid = 'f1.20.1' then answer_value_text end) as "f1.20.1",max(case when linkid = 'f1.21.1' then answer_value_text end) as "f1.21.1",max(case when linkid = 'f1.3.1' then answer_value_text end) as "f1.3.1",max(case when linkid = 'f1.4.1' then answer_value_text end) as "f1.4.1",max(case when linkid = 'f1.5.1' then answer_value_text end) as "f1.5.1",max(case when linkid = 'f1.6.1' then answer_value_text end) as "f1.6.1",max(case when linkid = 'f1.7.1' then answer_value_text end) as "f1.7.1",max(case when linkid = 'f1.8.1' then answer_value_text end) as "f1.8.1",max(case when linkid = 'f1.9.1' then answer_value_text end) as "f1.9.1",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'show-pcl-5-to-8-questions' then answer_value_text end) as "show-pcl-5-to-8-questions",max(case when linkid = 'task-id-common-mental-pdf' then answer_value_text end) as "task-id-common-mental-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:40.911250 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Financial Wellness Tool with readable column names
-- Questionnaire ID: q-financial-wellness-tool
-- Source file: questionnaire/assessments/financial-wellness-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '21234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_there_a_time_when_you_or",max(case when linkid = '31234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo",max(case when linkid = '3456789a-bcde-f012-3456-789abcdef012' then answer_value_text end) as "financial_how_hard_is_it_for_you_to_pay_for_the_very_basics_",max(case when linkid = '51234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_how_strongly_do_you_agree_or_disagree_with_the_fol",max(case when linkid = '61234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_move_in_with_other_p",max(case when linkid = '6789abcd-ef01-2345-6789-abcdef012345' then answer_value_text end) as "financial_in_the_past_12_months_how_often_did_you_run_out_of",max(case when linkid = '91234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_stay_at_a_shelter_in",max(case when linkid = 'c1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo_8",max(case when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab' then answer_value_text end) as "financial_i_worried_whether_my_food_would_run_out_before_i_g",max(case when linkid = 'f0123456-789a-bcde-f012-3456789abcde' then answer_value_text end) as "financial_the_food_that_i_bought_just_didnt_last_and_i_didnt",max(case when linkid = 'f1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_your_phone_gas_heating_w",max(case when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d' then answer_value_text end) as "financial_when_you_think_about_your_financial_situation_how_",max(case when linkid = 'high-debt' then answer_value_text end) as "high-debt",max(case when linkid = 'high-food-insecurity' then answer_value_text end) as "high-food-insecurity",max(case when linkid = 'high-housing-insecurity' then answer_value_text end) as "high-housing-insecurity",max(case when linkid = 'high-paying-bills' then answer_value_text end) as "high-paying-bills",max(case when linkid = 'moderate-debt' then answer_value_text end) as "moderate-debt",max(case when linkid = 'moderate-food-insecurity' then answer_value_text end) as "moderate-food-insecurity",max(case when linkid = 'moderate-housing-insecurity' then answer_value_text end) as "moderate-housing-insecurity",max(case when linkid = 'moderate-medical-hardships' then answer_value_text end) as "moderate-medical-hardships",max(case when linkid = 'moderate-paying-bills' then answer_value_text end) as "moderate-paying-bills",max(case when linkid = 'no-financial-hardship' then answer_value_text end) as "no-financial-hardship",max(case when linkid = 'overall-financial-hardship' then answer_value_text end) as "overall-financial-hardship"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:40.911624 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_confidential_s1
[0m09:25:40.913394 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_confidential_s1"
[0m09:25:40.913908 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:25:40.914078 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: BEGIN
[0m09:25:40.914768 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:40.914943 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:40.915107 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:25:40.915261 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:25:40.916683 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:25:40.916868 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.784 seconds
[0m09:25:40.917086 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Discuss Confidentiality with readable column names
-- Questionnaire ID: 23451
-- Source file: questionnaire/ipc-session-1/confidential-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:40.918417 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:25:40.918610 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp" rename to "qr_financial_wellness_tool"
[0m09:25:40.919302 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:25:40.919531 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp" rename to "qr_common_mental_health_symptoms"
[0m09:25:40.919952 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m09:25:40.921572 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:25:40.921851 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:40.922101 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:40.922290 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:40.922991 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:25:40.923560 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:25:40.924972 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:25:40.925175 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:25:40.925356 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:25:40.925549 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:25:40.925711 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp" rename to "qr_confidential_s1"
[0m09:25:40.925887 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:25:40.926044 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:25:40.926192 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m09:25:40.926841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:40.927118 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:40.927340 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:25:40.927512 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:40.927675 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:40.928263 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:25:40.928504 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- 1 month follow up with readable column names
-- Questionnaire ID: 1-month-follow-up
-- Source file: questionnaire/1-month-follow-up.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'completed-all-recommended-interventions' then answer_value_text end) as "completed-all-recommended-interventions",max(case when linkid = 'schedule-this-meeting' then answer_value_text end) as "schedule-this-meeting"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:40.929793 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup"
[0m09:25:40.931877 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup"
[0m09:25:40.932183 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:25:40.932561 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:25:40.932837 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:25:40.933020 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:25:40.933199 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup" cascade
[0m09:25:40.933382 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup" cascade
[0m09:25:40.934031 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:40.934247 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:40.934931 [debug] [Thread-3 (]: On model.engage_analytics.qr_financial_wellness_tool: Close
[0m09:25:40.935096 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:40.935261 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:40.935872 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: Close
[0m09:25:40.937031 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup"
[0m09:25:40.937308 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132b1ca0>]}
[0m09:25:40.938885 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:25:40.939299 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:25:40.939593 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132cbcb0>]}
[0m09:25:40.940187 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m09:25:40.940007 [info ] [Thread-3 (]: 25 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [[32mCREATE VIEW[0m in 0.80s]
[0m09:25:40.940429 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup" cascade
[0m09:25:40.941097 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_financial_wellness_tool
[0m09:25:40.941508 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_gad_7_s1
[0m09:25:40.941708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:40.942223 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:40.942019 [info ] [Thread-3 (]: 26 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [RUN]
[0m09:25:40.943072 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:25:40.943935 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: Close
[0m09:25:40.944149 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_financial_wellness_tool, now model.engage_analytics.qr_gad_7_s1)
[0m09:25:40.944449 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:25:40.944976 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_gad_7_s1
[0m09:25:40.945245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113243bc0>]}
[0m09:25:40.945622 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:25:40.948204 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:25:40.948684 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:40.948942 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:40.949598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:40.950854 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m09:25:40.951176 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:25:40.951354 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m09:25:40.951982 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:40.952830 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m09:25:40.953134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11330c950>]}
[0m09:25:41.199719 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m09:25:41.201415 [info ] [Thread-2 (]: 24 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [[32mCREATE VIEW[0m in 0.81s]
[0m09:25:41.203613 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_confidential_s1
[0m09:25:41.202815 [info ] [Thread-4 (]: 23 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 0.82s]
[0m09:25:41.205283 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_gad_7_s2
[0m09:25:41.204565 [info ] [Thread-1 (]: 22 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 0.83s]
[0m09:25:41.205774 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:25:41.206078 [info ] [Thread-2 (]: 27 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [RUN]
[0m09:25:41.206373 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m09:25:41.206576 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_gad_7_s3
[0m09:25:41.206811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_confidential_s1, now model.engage_analytics.qr_gad_7_s2)
[0m09:25:41.207046 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_gad_7_s4
[0m09:25:41.207303 [info ] [Thread-4 (]: 28 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [RUN]
[0m09:25:41.207518 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_gad_7_s2
[0m09:25:41.207859 [info ] [Thread-1 (]: 29 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [RUN]
[0m09:25:41.208263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_common_mental_health_symptoms, now model.engage_analytics.qr_gad_7_s3)
[0m09:25:41.211357 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:25:41.211680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_gad_7_s4)
[0m09:25:41.211909 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_gad_7_s3
[0m09:25:41.212100 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:41.212277 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_gad_7_s4
[0m09:25:41.214972 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:25:41.215408 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:41.219520 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:25:41.219795 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:41.220241 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:41.220430 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:41.220592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:41.529156 [debug] [Thread-3 (]: SQL status: SELECT 18 in 0.580 seconds
[0m09:25:41.532065 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s1"
[0m09:25:41.533449 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_gad_7_s1
[0m09:25:41.535462 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s1"
[0m09:25:41.535971 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:25:41.536162 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: BEGIN
[0m09:25:41.536946 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:41.537179 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:25:41.537488 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 1) with readable column names
-- Questionnaire ID: 202
-- Source file: questionnaire/ipc-session-1/gad-7-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9' then answer_value_text end) as "ipc_s1_taskid_gad_pdf",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_gad7_session_1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s1_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s1_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s1_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s1_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s1_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s1_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s1_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_gad7_session_1_score",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s1_score_meaning_13",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:41.540706 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:41.543339 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:25:41.543552 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp" rename to "qr_gad_7_s1"
[0m09:25:41.544683 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:41.545476 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:25:41.545693 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:25:41.545865 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:25:41.546770 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:41.547913 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup"
[0m09:25:41.548168 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:25:41.548326 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup" cascade
[0m09:25:41.548900 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:41.549620 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: Close
[0m09:25:41.549960 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e3c80>]}
[0m09:25:41.550280 [info ] [Thread-3 (]: 26 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [[32mCREATE VIEW[0m in 0.61s]
[0m09:25:41.550743 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_gad_7_s1
[0m09:25:41.550995 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_mood_rating_s1
[0m09:25:41.551285 [info ] [Thread-3 (]: 30 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [RUN]
[0m09:25:41.551528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s1, now model.engage_analytics.qr_mood_rating_s1)
[0m09:25:41.551703 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_mood_rating_s1
[0m09:25:41.554294 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:25:41.554550 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:41.554738 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:41.806079 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.585 seconds
[0m09:25:41.806766 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.586 seconds
[0m09:25:41.810278 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s3"
[0m09:25:41.810902 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.595 seconds
[0m09:25:41.812337 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s4"
[0m09:25:41.813798 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s2"
[0m09:25:41.814337 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_gad_7_s3
[0m09:25:41.816052 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s3"
[0m09:25:41.816356 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_gad_7_s2
[0m09:25:41.817908 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s2"
[0m09:25:41.818281 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_gad_7_s4
[0m09:25:41.819886 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s4"
[0m09:25:41.820174 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:25:41.820398 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: BEGIN
[0m09:25:41.820698 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:25:41.820912 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: BEGIN
[0m09:25:41.821195 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:25:41.821426 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:41.821638 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: BEGIN
[0m09:25:41.821834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:41.822027 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:25:41.822260 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:25:41.822552 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 3) with readable column names
-- Questionnaire ID: 59
-- Source file: questionnaire/ipc-session-3/gad-7-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s3_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s3_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s3_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s3_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s3_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s3_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s3_q7_afraid",max(case when linkid = '534c4998-b964-4101-b919-ff3c26af9714' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s3_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:41.822815 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:41.823041 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 4) with readable column names
-- Questionnaire ID: 62
-- Source file: questionnaire/ipc-session-4/gad-7-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s4_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s4_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s4_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s4_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s4_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s4_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s4_q7_afraid",max(case when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = 'e4155e07-1d18-448f-8111-182bf4149672' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s4_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:41.823326 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:25:41.823578 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 2) with readable column names
-- Questionnaire ID: 205
-- Source file: questionnaire/ipc-session-2/gad-7-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_gad7_session_2",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s2_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s2_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s2_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s2_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s2_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s2_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s2_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_gad7_session_2_score",max(case when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s2_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:41.825736 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:41.825978 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:41.826173 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:41.827735 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:25:41.829142 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:25:41.830777 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:25:41.831008 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp" rename to "qr_gad_7_s3"
[0m09:25:41.831215 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp" rename to "qr_gad_7_s4"
[0m09:25:41.831407 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp" rename to "qr_gad_7_s2"
[0m09:25:41.832486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:41.832698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:41.833319 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:25:41.833494 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:41.834036 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:25:41.834209 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:25:41.835525 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:25:41.835714 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:25:41.835874 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:25:41.836027 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:25:41.836176 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:25:41.836353 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:25:41.837163 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:41.838330 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup"
[0m09:25:41.838562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:41.838812 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:25:41.838982 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:41.839959 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup"
[0m09:25:41.840133 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup" cascade
[0m09:25:41.841122 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup"
[0m09:25:41.841408 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:25:41.841684 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:25:41.841868 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup" cascade
[0m09:25:41.842049 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:41.842204 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup" cascade
[0m09:25:41.842865 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s2: Close
[0m09:25:41.843047 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:41.843324 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113328320>]}
[0m09:25:41.843891 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: Close
[0m09:25:41.844043 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:41.844326 [info ] [Thread-2 (]: 27 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [[32mCREATE VIEW[0m in 0.64s]
[0m09:25:41.844602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132def30>]}
[0m09:25:41.845171 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: Close
[0m09:25:41.845434 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_gad_7_s2
[0m09:25:41.845778 [info ] [Thread-1 (]: 29 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [[32mCREATE VIEW[0m in 0.63s]
[0m09:25:41.846237 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_mood_rating_s2
[0m09:25:41.846630 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d1820>]}
[0m09:25:41.846973 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_gad_7_s4
[0m09:25:41.847307 [info ] [Thread-2 (]: 31 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [RUN]
[0m09:25:41.847685 [info ] [Thread-4 (]: 28 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:25:41.847975 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_mood_rating_s3
[0m09:25:41.848215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s2, now model.engage_analytics.qr_mood_rating_s2)
[0m09:25:41.848461 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_gad_7_s3
[0m09:25:41.848667 [info ] [Thread-1 (]: 32 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [RUN]
[0m09:25:41.848859 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_mood_rating_s2
[0m09:25:41.849029 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_mood_rating_s4
[0m09:25:41.849213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s4, now model.engage_analytics.qr_mood_rating_s3)
[0m09:25:41.851737 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:25:41.852067 [info ] [Thread-4 (]: 33 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [RUN]
[0m09:25:41.852272 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_mood_rating_s3
[0m09:25:41.852448 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:41.852642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s3, now model.engage_analytics.qr_mood_rating_s4)
[0m09:25:41.855379 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:25:41.855753 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:41.856001 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_mood_rating_s4
[0m09:25:41.856196 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:41.859407 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:25:41.859737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:41.859954 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:41.860311 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:42.156454 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.601 seconds
[0m09:25:42.159153 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:25:42.161102 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_mood_rating_s1
[0m09:25:42.163054 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:25:42.163817 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:25:42.164049 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s1: BEGIN
[0m09:25:42.164961 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:42.165248 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:25:42.165488 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 1) with readable column names
-- Questionnaire ID: 203
-- Source file: questionnaire/ipc-session-1/mood-rating-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "mood_s1_8085cded8e0f497f9e3d5fab3981d727",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "mood_s1_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:42.167990 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:42.169666 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:25:42.169884 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp" rename to "qr_mood_rating_s1"
[0m09:25:42.170822 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:42.171504 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:25:42.171682 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:25:42.171839 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:25:42.172791 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:42.174796 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup"
[0m09:25:42.175097 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:25:42.175278 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup" cascade
[0m09:25:42.175941 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:42.176776 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s1: Close
[0m09:25:42.177129 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113449580>]}
[0m09:25:42.177465 [info ] [Thread-3 (]: 30 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [[32mCREATE VIEW[0m in 0.63s]
[0m09:25:42.177749 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_mood_rating_s1
[0m09:25:42.177943 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_mw_tool
[0m09:25:42.178178 [info ] [Thread-3 (]: 34 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [RUN]
[0m09:25:42.178427 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s1, now model.engage_analytics.qr_mw_tool)
[0m09:25:42.178630 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_mw_tool
[0m09:25:42.181273 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:25:42.181547 [debug] [Thread-3 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:42.181719 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:42.434857 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.579 seconds
[0m09:25:42.438481 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:25:42.438841 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.579 seconds
[0m09:25:42.439841 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:25:42.440120 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.580 seconds
[0m09:25:42.440863 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:25:42.441273 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_mood_rating_s3
[0m09:25:42.443105 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:25:42.443435 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_mood_rating_s4
[0m09:25:42.445099 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:25:42.445421 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:25:42.445660 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: BEGIN
[0m09:25:42.445981 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:25:42.446212 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_mood_rating_s2
[0m09:25:42.446437 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s4: BEGIN
[0m09:25:42.446662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:42.448491 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:25:42.448783 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:25:42.449150 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 3) with readable column names
-- Questionnaire ID: 207
-- Source file: questionnaire/ipc-session-3/mood-rating-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "mood_s3_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:42.449432 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:42.449689 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:25:42.449932 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 4) with readable column names
-- Questionnaire ID: 209
-- Source file: questionnaire/ipc-session-4/mood-rating-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990' then answer_value_text end) as "mood_s4_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:42.450267 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:25:42.450463 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: BEGIN
[0m09:25:42.451031 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:42.451207 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:25:42.451420 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 2) with readable column names
-- Questionnaire ID: 206
-- Source file: questionnaire/ipc-session-2/mood-rating-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "mood_s2_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:42.451653 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:42.453191 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:25:42.453449 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:42.453674 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp" rename to "qr_mood_rating_s3"
[0m09:25:42.455251 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:25:42.455474 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:25:42.455712 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp" rename to "qr_mood_rating_s4"
[0m09:25:42.457222 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:25:42.457459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:42.457644 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp" rename to "qr_mood_rating_s2"
[0m09:25:42.458329 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:25:42.458604 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:42.458801 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:25:42.459433 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:25:42.459646 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:42.459826 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:25:42.460011 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:25:42.460555 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:25:42.460754 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:25:42.460928 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:25:42.461119 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:25:42.461420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:42.462575 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup"
[0m09:25:42.462830 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:25:42.463034 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:42.463247 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup" cascade
[0m09:25:42.463440 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:42.465287 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup"
[0m09:25:42.466442 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup"
[0m09:25:42.466718 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:25:42.466877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:42.467092 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:25:42.467251 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup" cascade
[0m09:25:42.467854 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: Close
[0m09:25:42.468026 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup" cascade
[0m09:25:42.468337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134311f0>]}
[0m09:25:42.468661 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:42.469323 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: Close
[0m09:25:42.469614 [info ] [Thread-1 (]: 32 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [[32mCREATE VIEW[0m in 0.62s]
[0m09:25:42.469927 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_mood_rating_s3
[0m09:25:42.470130 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:25:42.470351 [info ] [Thread-1 (]: 35 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [RUN]
[0m09:25:42.470612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s3, now model.engage_analytics.qr_mw_tool_ipc_session_4)
[0m09:25:42.470885 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:25:42.471156 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:25:42.471427 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134d8050>]}
[0m09:25:42.472157 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s4: Close
[0m09:25:42.474675 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:25:42.475065 [info ] [Thread-2 (]: 31 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [[32mCREATE VIEW[0m in 0.62s]
[0m09:25:42.475377 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

    
    with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:42.475687 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11324ed80>]}
[0m09:25:42.475968 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_mood_rating_s2
[0m09:25:42.476139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:42.476415 [info ] [Thread-4 (]: 33 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [[32mCREATE VIEW[0m in 0.62s]
[0m09:25:42.476626 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_phq_9_s1
[0m09:25:42.477095 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_mood_rating_s4
[0m09:25:42.477334 [info ] [Thread-2 (]: 36 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [RUN]
[0m09:25:42.477537 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_phq_9_s2
[0m09:25:42.477733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s2, now model.engage_analytics.qr_phq_9_s1)
[0m09:25:42.478150 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_phq_9_s1
[0m09:25:42.477970 [info ] [Thread-4 (]: 37 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [RUN]
[0m09:25:42.481508 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:25:42.481872 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s4, now model.engage_analytics.qr_phq_9_s2)
[0m09:25:42.482144 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:42.482396 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_phq_9_s2
[0m09:25:42.482667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:42.485777 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:25:42.486260 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:42.486515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:42.772268 [debug] [Thread-3 (]: SQL status: SELECT 37 in 0.590 seconds
[0m09:25:42.776737 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool"
[0m09:25:42.777732 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_mw_tool
[0m09:25:42.779629 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool"
[0m09:25:42.780353 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:25:42.780580 [debug] [Thread-3 (]: On model.engage_analytics.qr_mw_tool: BEGIN
[0m09:25:42.781417 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:42.781764 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:25:42.782141 [debug] [Thread-3 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool with readable column names
-- Questionnaire ID: 1613532
-- Source file: questionnaire/assessments/mw-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "mental_in_the_past_year_have_you_ever_felt_that_your_thou",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "mental_in_the_past_year_how_often_do_you_have_a_drink_con",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "mental_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "mental_in_the_past_year_did_you_at_any_time_hear_voices_s",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "mental_q2_depressed",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "mental_in_the_past_year_how_many_times_have_you_used_a_re",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "mental_in_the_past_year_how_many_drinks_containing_alcoho",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "mental_in_the_past_3_months_have_you_ever_done_anything_s",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "mental_q1_anxious",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "mental_in_the_past_month_have_you_had_any_actual_thoughts",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "mental_q5_restless",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe_13",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "mental_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "mental_supervisors_name",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "mental_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "mental_referral_details_if_the_client_is_referred_out",max(case when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29' then answer_value_text end) as "retake_screening",max(case when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f' then answer_value_text end) as "retake_screening_19",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'q1-to-q3-negative' then answer_value_text end) as "q1-to-q3-negative",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-common-mental-health-form' then answer_value_text end) as "task-id-common-mental-health-form",max(case when linkid = 'task-id-mwtool-pdf' then answer_value_text end) as "task-id-mwtool-pdf",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:42.785557 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:42.787183 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:25:42.787406 [debug] [Thread-3 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp" rename to "qr_mw_tool"
[0m09:25:42.788625 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:42.789331 [debug] [Thread-3 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:25:42.789529 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:25:42.789751 [debug] [Thread-3 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:25:42.790870 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:42.792001 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup"
[0m09:25:42.792259 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:25:42.792426 [debug] [Thread-3 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup" cascade
[0m09:25:42.792962 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:42.793656 [debug] [Thread-3 (]: On model.engage_analytics.qr_mw_tool: Close
[0m09:25:42.793960 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113549e80>]}
[0m09:25:42.794282 [info ] [Thread-3 (]: 34 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [[32mCREATE VIEW[0m in 0.62s]
[0m09:25:42.794583 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_mw_tool
[0m09:25:42.794783 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_phq_9_s3
[0m09:25:42.795065 [info ] [Thread-3 (]: 38 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [RUN]
[0m09:25:42.795352 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool, now model.engage_analytics.qr_phq_9_s3)
[0m09:25:42.795521 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_phq_9_s3
[0m09:25:42.798204 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:25:42.798467 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:42.798692 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:43.058775 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.582 seconds
[0m09:25:43.061859 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:25:43.063107 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:25:43.065993 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:25:43.066584 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:25:43.066769 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: BEGIN
[0m09:25:43.067694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:43.067898 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:25:43.068207 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool Session 4 with readable column names
-- Questionnaire ID: mw-tool-ipc-session-4
-- Source file: questionnaire/assessments/mw-tool-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_s",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "in_the_past_year_have_you_ever_felt_that_your_thoughts_were",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "in_the_past_year_how_often_do_you_have_a_drink_containing_a",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "in_the_past_month_have_you_wished_you_were_dead_or_wished_y",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "in_the_past_year_did_you_at_any_time_hear_voices_saying_qui",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_down_d",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "in_the_past_year_how_many_times_have_you_used_a_recreationa",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "in_the_past_year_how_many_drinks_containing_alcohol_do_you",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "in_the_past_3_months_have_you_ever_done_anything_started_t",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_nervous",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "in_the_past_month_have_you_had_any_actual_thoughts_of_killi",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_so_restless_tha",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_a",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-mw-tool-ipc-s4-pdf' then answer_value_text end) as "task-id-mw-tool-ipc-s4-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:43.070621 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.584 seconds
[0m09:25:43.071740 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s2"
[0m09:25:43.072021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:43.073699 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:25:43.073904 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp" rename to "qr_mw_tool_ipc_session_4"
[0m09:25:43.074161 [debug] [Thread-2 (]: SQL status: SELECT 21 in 0.592 seconds
[0m09:25:43.075158 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s1"
[0m09:25:43.075442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:43.075633 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_phq_9_s2
[0m09:25:43.076255 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:25:43.077869 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s2"
[0m09:25:43.078076 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:25:43.078376 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_phq_9_s1
[0m09:25:43.078543 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:25:43.080164 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s1"
[0m09:25:43.080372 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:25:43.080642 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: BEGIN
[0m09:25:43.080954 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:25:43.081132 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: BEGIN
[0m09:25:43.081341 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:43.081594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:43.081853 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:25:43.082025 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:43.083268 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup"
[0m09:25:43.083609 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 2) with readable column names
-- Questionnaire ID: 57
-- Source file: questionnaire/ipc-session-2/phq-9-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_phq9_session_2",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s2_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s2_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s2_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s2_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s2_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s2_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s2_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s2_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s2_q7_concentration",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_phq9_session_2_score",max(case when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'a07491bd-039d-417b-9caf-0af536316594' then answer_value_text end) as "ipc_s2_score_meaning_14"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:43.083876 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:25:43.084196 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:25:43.084509 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 1) with readable column names
-- Questionnaire ID: 54
-- Source file: questionnaire/ipc-session-1/phq-9-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.3.1' then answer_value_text end) as "phq9_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "phq9_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "phq9_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "phq9_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "phq9_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "phq9_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "phq9_q7_concentration",max(case when linkid = 'f1.10.1' then answer_value_text end) as "phq9_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "phq9_q9_suicide",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "phq9_total_score",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "phq9_score_meaning",max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as "phq9_score_meaning_code",max(case when linkid = 'encounter-id' then answer_value_text end) as "phq9_encounter_id",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "phq9_observation_id",max(case when linkid = 'calculated-month' then answer_value_text end) as "phq9_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "phq9_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "phq9_field_cd8e3d6d",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as "phq9_task_id",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "phq9_field_9c366bcc",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "phq9_field_b5bc7f80",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "phq9_link_encounter"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:43.084786 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup" cascade
[0m09:25:43.085335 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:43.086002 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: Close
[0m09:25:43.086292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11328eba0>]}
[0m09:25:43.086780 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:43.086610 [info ] [Thread-1 (]: 35 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [[32mCREATE VIEW[0m in 0.62s]
[0m09:25:43.088505 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:25:43.088778 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:25:43.089073 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:25:43.089291 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp" rename to "qr_phq_9_s2"
[0m09:25:43.090692 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:25:43.090976 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_phq_9_s4
[0m09:25:43.091261 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp" rename to "qr_phq_9_s1"
[0m09:25:43.091508 [info ] [Thread-1 (]: 39 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [RUN]
[0m09:25:43.091843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool_ipc_session_4, now model.engage_analytics.qr_phq_9_s4)
[0m09:25:43.092052 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:43.092299 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_phq_9_s4
[0m09:25:43.092530 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:43.093257 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:25:43.095885 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:25:43.096856 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:25:43.097119 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:25:43.097327 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:43.097556 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:25:43.097725 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:25:43.098027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:43.098191 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:25:43.099703 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:43.101844 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup"
[0m09:25:43.102114 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:25:43.102594 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:25:43.103897 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup"
[0m09:25:43.104196 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup" cascade
[0m09:25:43.104561 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:25:43.104793 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup" cascade
[0m09:25:43.105426 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:43.105676 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:43.106431 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: Close
[0m09:25:43.107203 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s1: Close
[0m09:25:43.108058 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135c17f0>]}
[0m09:25:43.108669 [info ] [Thread-4 (]: 37 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [[32mCREATE VIEW[0m in 0.63s]
[0m09:25:43.108989 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_phq_9_s2
[0m09:25:43.109199 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_planning_next_steps
[0m09:25:43.109421 [info ] [Thread-4 (]: 40 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [RUN]
[0m09:25:43.109869 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s2, now model.engage_analytics.qr_planning_next_steps)
[0m09:25:43.110239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e00b0>]}
[0m09:25:43.110485 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_planning_next_steps
[0m09:25:43.110900 [info ] [Thread-2 (]: 36 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [[32mCREATE VIEW[0m in 0.63s]
[0m09:25:43.113570 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:25:43.114059 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_phq_9_s1
[0m09:25:43.114360 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:43.114859 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_registration_info
[0m09:25:43.115101 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:43.115601 [info ] [Thread-2 (]: 41 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [RUN]
[0m09:25:43.116204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s1, now model.engage_analytics.qr_registration_info)
[0m09:25:43.116403 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_registration_info
[0m09:25:43.119541 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:25:43.120087 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:43.120303 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:43.400009 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.601 seconds
[0m09:25:43.402805 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s3"
[0m09:25:43.405380 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_phq_9_s3
[0m09:25:43.407477 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s3"
[0m09:25:43.408030 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:25:43.408214 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: BEGIN
[0m09:25:43.409112 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:43.409398 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:25:43.409653 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 3) with readable column names
-- Questionnaire ID: 61
-- Source file: questionnaire/ipc-session-3/phq-9-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s3_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s3_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s3_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s3_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s3_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s3_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s3_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s3_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s3_q7_concentration",max(case when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9' then answer_value_text end) as "ipc_s3_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:43.412335 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:43.413972 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:25:43.414180 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp" rename to "qr_phq_9_s3"
[0m09:25:43.415113 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:43.415967 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:25:43.416172 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:25:43.416335 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:25:43.417540 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:43.418667 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup"
[0m09:25:43.418918 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:25:43.419080 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup" cascade
[0m09:25:43.419588 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:43.420206 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: Close
[0m09:25:43.420496 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11324ed80>]}
[0m09:25:43.420813 [info ] [Thread-3 (]: 38 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [[32mCREATE VIEW[0m in 0.63s]
[0m09:25:43.421230 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_phq_9_s3
[0m09:25:43.421449 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_remove_patient
[0m09:25:43.421776 [info ] [Thread-3 (]: 42 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [RUN]
[0m09:25:43.422040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s3, now model.engage_analytics.qr_remove_patient)
[0m09:25:43.422214 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_remove_patient
[0m09:25:43.424689 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:25:43.424935 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:43.425109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:43.691699 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.593 seconds
[0m09:25:43.695397 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s4"
[0m09:25:43.696359 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_phq_9_s4
[0m09:25:43.698333 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s4"
[0m09:25:43.699065 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:25:43.699282 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: BEGIN
[0m09:25:43.700122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:43.700321 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:25:43.700760 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 4) with readable column names
-- Questionnaire ID: 211
-- Source file: questionnaire/ipc-session-4/phq-9-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "ipc_s4_how_difficult_have_these_problems_made_it_for_you_",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s4_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s4_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s4_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s4_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s4_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s4_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s4_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s4_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s4_q7_concentration",max(case when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792' then answer_value_text end) as "ipc_s4_score_meaning_13"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:43.703568 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:43.706041 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:25:43.706282 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp" rename to "qr_phq_9_s4"
[0m09:25:43.707396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:43.708138 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:25:43.708345 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:25:43.708506 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:25:43.709205 [debug] [Thread-4 (]: SQL status: SELECT 66 in 0.594 seconds
[0m09:25:43.710455 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_planning_next_steps"
[0m09:25:43.710814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:43.752180 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup"
[0m09:25:43.752476 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.632 seconds
[0m09:25:43.752785 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:25:43.752965 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_planning_next_steps
[0m09:25:43.753953 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info"
[0m09:25:43.754152 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup" cascade
[0m09:25:43.755819 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_planning_next_steps"
[0m09:25:43.756481 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_registration_info
[0m09:25:43.758065 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info"
[0m09:25:43.758353 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:25:43.758538 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: BEGIN
[0m09:25:43.758716 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:25:43.759465 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: Close
[0m09:25:43.759651 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:43.759833 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:25:43.760240 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Planning Next Steps with readable column names
-- Questionnaire ID: q-planning-next-steps
-- Source file: questionnaire/assessments/planning-next-steps.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7' then answer_value_text end) as "referral_to_mental_health_specialist",max(case when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7' then answer_value_text end) as "referred",max(case when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f' then answer_value_text end) as "okay",max(case when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d' then answer_value_text end) as "field_2cb66889",max(case when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6' then answer_value_text end) as "field_34a56c28",max(case when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9' then answer_value_text end) as "referres",max(case when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01' then answer_value_text end) as "field_34ab6c28",max(case when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d' then answer_value_text end) as "field_3b9f7e5d",max(case when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f' then answer_value_text end) as "sbirt_motivational_interviewing",max(case when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7' then answer_value_text end) as "safety",max(case when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123' then answer_value_text end) as "others",max(case when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae' then answer_value_text end) as "mental_health",max(case when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345' then answer_value_text end) as "not_interested",max(case when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf' then answer_value_text end) as "20250924",max(case when linkid = '69712544-6237-4962-a455-ee6e9ee80000' then answer_value_text end) as "field_69712544",max(case when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e' then answer_value_text end) as "field_76ba8dbe",max(case when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574' then answer_value_text end) as "hh",max(case when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106' then answer_value_text end) as "20260505",max(case when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d' then answer_value_text end) as "field_9a8b7c6d",max(case when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d' then answer_value_text end) as "sbirt_motivational_interviewingbrspan_stylecolor006",max(case when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab' then answer_value_text end) as "field_ab12d39f",max(case when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e' then answer_value_text end) as "they_gtycyvuy",max(case when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e' then answer_value_text end) as "field_b2c3d4e5",max(case when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc' then answer_value_text end) as "test",max(case when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e' then answer_value_text end) as "field_bc2def4a",max(case when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f' then answer_value_text end) as "field_c3d4e5f6",max(case when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4' then answer_value_text end) as "field_c9d8b7a6",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd' then answer_value_text end) as "not_interested_28",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f' then answer_value_text end) as "field_cd34f5b1",max(case when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f' then answer_value_text end) as "iwbwb",max(case when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a' then answer_value_text end) as "needs_checkups",max(case when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a' then answer_value_text end) as "hhh",max(case when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90' then answer_value_text end) as "20250827",max(case when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7' then answer_value_text end) as "referral_to_mental_health_specialist_34",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b' then answer_value_text end) as "already_received_a_similar_service",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4' then answer_value_text end) as "field_ef5617d3",max(case when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5' then answer_value_text end) as "peace",max(case when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100' then answer_value_text end) as "interested_but_not_now",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g' then answer_value_text end) as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g",max(case when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h' then answer_value_text end) as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h",max(case when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i' then answer_value_text end) as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i",max(case when linkid = 'financial-hardships-list' then answer_value_text end) as "financial-hardships-list",max(case when linkid = 'is-fws' then answer_value_text end) as "is-fws",max(case when linkid = 'is-ipc' then answer_value_text end) as "is-ipc",max(case when linkid = 'is-ipc-main' then answer_value_text end) as "is-ipc-main",max(case when linkid = 'is-ipc-optional' then answer_value_text end) as "is-ipc-optional",max(case when linkid = 'is-mhs' then answer_value_text end) as "is-mhs",max(case when linkid = 'is-other-agency-services' then answer_value_text end) as "is-other-agency-services",max(case when linkid = 'is-other-services-outside-agency' then answer_value_text end) as "is-other-services-outside-agency",max(case when linkid = 'is-sbirt' then answer_value_text end) as "is-sbirt",max(case when linkid = 'is-sbirt-main' then answer_value_text end) as "is-sbirt-main",max(case when linkid = 'is-sbirt-optional' then answer_value_text end) as "is-sbirt-optional",max(case when linkid = 'is-spi' then answer_value_text end) as "is-spi",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'scheduled-ipc-session-1-with-current-time' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time",max(case when linkid = 'scheduled-ipc-session-1-with-current-time-2' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time-2",max(case when linkid = 'task-id-000' then answer_value_text end) as "task-id-000",max(case when linkid = 'task-id-001' then answer_value_text end) as "task-id-001",max(case when linkid = 'task-id-002' then answer_value_text end) as "task-id-002",max(case when linkid = 'task-id-003' then answer_value_text end) as "task-id-003",max(case when linkid = 'task-id-004' then answer_value_text end) as "task-id-004",max(case when linkid = 'task-id-006' then answer_value_text end) as "task-id-006",max(case when linkid = 'task-id-planning-next-steps-pdf' then answer_value_text end) as "task-id-planning-next-steps-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:43.760762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136417c0>]}
[0m09:25:43.760977 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:25:43.761433 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: BEGIN
[0m09:25:43.761291 [info ] [Thread-1 (]: 39 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [[32mCREATE VIEW[0m in 0.67s]
[0m09:25:43.761837 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_phq_9_s4
[0m09:25:43.762083 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_sbirt
[0m09:25:43.762310 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:43.762549 [info ] [Thread-1 (]: 43 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sbirt .. [RUN]
[0m09:25:43.762787 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:25:43.763016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s4, now model.engage_analytics.qr_sbirt)
[0m09:25:43.763317 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Add Family Member Registration with readable column names
-- Questionnaire ID: 221
-- Source file: questionnaire/generic/registration_info.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff' then answer_value_text end) as "registration_36d39dbe00e24e29f0793ec8f0119aff",max(case when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd' then answer_value_text end) as "registration_middle_name",max(case when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271' then answer_value_text end) as "registration_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7' then answer_value_text end) as "registration_age",max(case when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d' then answer_value_text end) as "registration_surname",max(case when linkid = 'age' then answer_value_text end) as "registration_age_6",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "registration_calculated_age",max(case when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f' then answer_value_text end) as "registration_unique_id",max(case when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0' then answer_value_text end) as "registration_has_this_person_received_engage_services_in_the_pa",max(case when linkid = 'calculated-month' then answer_value_text end) as "registration_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "registration_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "registration_date_of_birth_dob",max(case when linkid = 'e6306275-b989-4375-8527-3a56092081b8' then answer_value_text end) as "registration_first_name",max(case when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd' then answer_value_text end) as "registration_what_was_your_biological_sex_assigned_at_birth",max(case when linkid = 'choice-gender-identity' then answer_value_text end) as "choice-gender-identity",max(case when linkid = 'choice-pronouns' then answer_value_text end) as "choice-pronouns",max(case when linkid = 'do-you-have-medicaid' then answer_value_text end) as "do-you-have-medicaid",max(case when linkid = 'email-address' then answer_value_text end) as "email-address",max(case when linkid = 'medicaid-number' then answer_value_text end) as "medicaid-number",max(case when linkid = 'other-best-represents-how-you-think-of-yourself' then answer_value_text end) as "other-best-represents-how-you-think-of-yourself",max(case when linkid = 'other-biological-sex-at-birth' then answer_value_text end) as "other-biological-sex-at-birth",max(case when linkid = 'other-gender-identity' then answer_value_text end) as "other-gender-identity",max(case when linkid = 'other-pronouns' then answer_value_text end) as "other-pronouns",max(case when linkid = 'other-where-did-you-first-learn-about-engage' then answer_value_text end) as "other-where-did-you-first-learn-about-engage",max(case when linkid = 'phone-number' then answer_value_text end) as "phone-number",max(case when linkid = 'physical-address' then answer_value_text end) as "physical-address",max(case when linkid = 'where-did-you-first-learn-about-engage' then answer_value_text end) as "where-did-you-first-learn-about-engage",max(case when linkid = 'zip-code' then answer_value_text end) as "zip-code"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:43.763618 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_sbirt
[0m09:25:43.766068 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:25:43.766278 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:25:43.766530 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:43.766705 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:43.768296 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:25:43.768582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:43.770061 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:25:43.770404 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp" rename to "qr_planning_next_steps"
[0m09:25:43.770779 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp" rename to "qr_registration_info"
[0m09:25:43.800399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m09:25:43.805674 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m09:25:43.807640 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:25:43.808268 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:25:43.808514 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:25:43.808726 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:25:43.808917 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:25:43.809375 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:25:43.810511 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:43.811950 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup"
[0m09:25:43.812254 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:25:43.812493 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup" cascade
[0m09:25:43.812723 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:25:43.814537 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup"
[0m09:25:43.814869 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:25:43.815057 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup" cascade
[0m09:25:43.815276 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:25:43.815991 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: Close
[0m09:25:43.816304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132aa2d0>]}
[0m09:25:43.817392 [info ] [Thread-2 (]: 41 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [[32mCREATE VIEW[0m in 0.70s]
[0m09:25:43.817669 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_registration_info
[0m09:25:43.817865 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:25:43.818064 [info ] [Thread-2 (]: 44 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [RUN]
[0m09:25:43.818273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_registration_info, now model.engage_analytics.qr_sf_pcl_5_s1)
[0m09:25:43.818439 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:25:43.824098 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m09:25:43.826175 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:25:43.827216 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: Close
[0m09:25:43.827534 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:43.827813 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:43.828201 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11341bd40>]}
[0m09:25:43.828793 [info ] [Thread-4 (]: 40 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [[32mCREATE VIEW[0m in 0.72s]
[0m09:25:43.829231 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_planning_next_steps
[0m09:25:43.829498 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:25:43.829829 [info ] [Thread-4 (]: 45 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [RUN]
[0m09:25:43.830095 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_planning_next_steps, now model.engage_analytics.qr_sf_pcl_5_s2)
[0m09:25:43.830274 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:25:43.832932 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:25:43.833239 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:43.833518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:44.057986 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.633 seconds
[0m09:25:44.061732 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_remove_patient"
[0m09:25:44.064118 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_remove_patient
[0m09:25:44.066101 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_remove_patient"
[0m09:25:44.066575 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:25:44.066776 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: BEGIN
[0m09:25:44.067690 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:44.067915 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:25:44.068162 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- eCBIS Remove Family Form with readable column names
-- Questionnaire ID: 69
-- Source file: questionnaire/generic/remove_patient.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f' then answer_value_text end) as "remove_family_date_of_death",max(case when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a' then answer_value_text end) as "remove_family_give_other_reasons_for_removal",max(case when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5' then answer_value_text end) as "remove_family_age_at_death_year",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b' then answer_value_text end) as "remove_family_a11ebb0dacb34038956b293a41acb85b",max(case when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1' then answer_value_text end) as "remove_family_date_moved_away",max(case when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff' then answer_value_text end) as "remove_family_reason_for_removal",max(case when linkid = 'patient-birthdate' then answer_value_text end) as "remove_family_patientbirthdate",max(case when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec' then answer_value_text end) as "reason_unknown"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:44.070588 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:44.072206 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:25:44.072414 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp" rename to "qr_remove_patient"
[0m09:25:44.073489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:44.074162 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:25:44.074353 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:25:44.074516 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:25:44.075569 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:44.077047 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup"
[0m09:25:44.077358 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:25:44.077537 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup" cascade
[0m09:25:44.078295 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:44.078968 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: Close
[0m09:25:44.079252 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134d9cd0>]}
[0m09:25:44.079564 [info ] [Thread-3 (]: 42 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [[32mCREATE VIEW[0m in 0.66s]
[0m09:25:44.079828 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_remove_patient
[0m09:25:44.080014 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:25:44.080269 [info ] [Thread-3 (]: 46 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [RUN]
[0m09:25:44.080465 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_remove_patient, now model.engage_analytics.qr_sf_pcl_5_s3)
[0m09:25:44.080655 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:25:44.083079 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:25:44.083324 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:44.083503 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:44.411272 [debug] [Thread-1 (]: SQL status: SELECT 159 in 0.642 seconds
[0m09:25:44.417206 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_sbirt"
[0m09:25:44.417574 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.584 seconds
[0m09:25:44.417921 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.590 seconds
[0m09:25:44.418935 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:25:44.419817 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:25:44.420254 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_sbirt
[0m09:25:44.422537 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_sbirt"
[0m09:25:44.422914 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:25:44.423206 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:25:44.424995 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:25:44.427737 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:25:44.428227 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:25:44.428530 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: BEGIN
[0m09:25:44.428900 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:25:44.429131 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:25:44.429497 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: BEGIN
[0m09:25:44.429700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:44.429971 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: BEGIN
[0m09:25:44.430243 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:25:44.431330 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SBIRT with readable column names
-- Questionnaire ID: 212
-- Source file: questionnaire/sbirt.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_drink_alc",max(case when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t",max(case when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e' then answer_value_text end) as "sbirt_have_you_or_someone_else_been_injured_as_a_result_",max(case when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621' then answer_value_text end) as "sbirt_how_often_do_you_have_six_or_more_drinks_on_one_oc",max(case when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_needed_a_f",max(case when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848' then answer_value_text end) as "sbirt_have_you_ever_experienced_withdrawal_symptoms_felt",max(case when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4' then answer_value_text end) as "sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_o",max(case when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_8",max(case when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_had_a_feel",max(case when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1' then answer_value_text end) as "sbirt_how_many_standard_drinks_containing_alcohol_do_you",max(case when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_been_unabl",max(case when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11' then answer_value_text end) as "sbirt_how_often_do_you_have_a_drink_containing_alcohol",max(case when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4' then answer_value_text end) as "sbirt_have_you_neglected_your_family_because_of_your_use",max(case when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267' then answer_value_text end) as "sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use",max(case when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_15",max(case when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990' then answer_value_text end) as "sbirt_have_you_had_medical_problems_as_a_result_of_your_",max(case when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3' then answer_value_text end) as "sbirt_have_you_ever_used_any_drugs_by_injection_nonmedic",max(case when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c' then answer_value_text end) as "sbirt_have_you_engaged_in_illegal_activities_in_order_to",max(case when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_19",max(case when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_20",max(case when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_failed_to_",max(case when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_22",max(case when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41' then answer_value_text end) as "sbirt_does_your_spouse_or_parents_ever_complain_about_yo",max(case when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_24",max(case when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_25",max(case when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_26",max(case when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9' then answer_value_text end) as "sbirt_are_you_always_able_to_stop_using_drugs_when_you_w",max(case when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_found_that",max(case when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b' then answer_value_text end) as "sbirt_have_you_used_drugs_other_than_those_required_for_",max(case when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88' then answer_value_text end) as "sbirt_has_a_relative_or_friend_or_a_doctor_or_another_he",max(case when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba' then answer_value_text end) as "sbirt_do_you_use_more_than_one_drug_at_a_time",max(case when linkid = '0466b304-2876-409b-ade2-d1c675614854' then answer_value_text end) as "sbirt_please_select_one_substance_you_would_like_to_disc",max(case when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_metha",max(case when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78' then answer_value_text end) as "sbirt_i_would_like_to_offer_an_opportunity_to_start_a_co",max(case when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0' then answer_value_text end) as "sbirt_we_could_start_by_discussing_the_pros_and_cons_of_",max(case when linkid = '39843731-a8e7-4822-bad7-55489947ebeb' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_other",max(case when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_alc",max(case when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_canna",max(case when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_hallu",max(case when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_sedat",max(case when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_inhal",max(case when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_cocai",max(case when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_the",max(case when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491' then answer_value_text end) as "sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_al",max(case when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_presc",max(case when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha",max(case when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_47",max(case when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_48",max(case when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_49",max(case when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_50",max(case when linkid = '8427af19-3bad-4713-bad9-b179437fef96' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_stree",max(case when linkid = '90876967-c973-4bee-9217-8c7482cb12a2' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_52",max(case when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368' then answer_value_text end) as "sbirt_cannabis_marijuana_pot_grass_hash_etc",max(case when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_54",max(case when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_55",max(case when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d' then answer_value_text end) as "sbirt_would_you_be_interested_in_learning_more_about_sub",max(case when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9' then answer_value_text end) as "sbirt_1579996975654c3eb488d6a65d66c6c9",max(case when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812' then answer_value_text end) as "sbirt_things_you_can_do",max(case when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_prescript",max(case when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_methamphe",max(case when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_other_dru",max(case when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_inhalants",max(case when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cannabis_",max(case when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_64",max(case when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3' then answer_value_text end) as "sbirt_what_are_some_good_things_about_staying_the_same",max(case when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848' then answer_value_text end) as "sbirt_street_opioids_heroin_opium_etc_or_prescription_op",max(case when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_hallucino",max(case when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cocaine_l",max(case when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_sedatives",max(case when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509' then answer_value_text end) as "sbirt_what_are_some_good_things_about_making_a_change",max(case when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1' then answer_value_text end) as "sbirt_what_are_your_health_goals_around_substance_use",max(case when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f' then answer_value_text end) as "sbirt_cocaine_coke_crack_etc",max(case when linkid = '1600f791-fd2c-44d8-8384-37973785741b' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed",max(case when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_74",max(case when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_75",max(case when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_76",max(case when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_street_op",max(case when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_78",max(case when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299' then answer_value_text end) as "sbirt_other_drugs",max(case when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_80",max(case when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_81",max(case when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_82",max(case when linkid = 'edced328-6f82-458a-bce4-35987bff19fb' then answer_value_text end) as "sbirt_edced3286f82458abce435987bff19fb",max(case when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19' then answer_value_text end) as "sbirt_can_i_share_additional_treatment_options_with_you",max(case when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre",max(case when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3' then answer_value_text end) as "sbirt_prescription_stimulants_just_for_the_feeling_more_",max(case when linkid = '582271e0-892e-4795-ac55-0b73baf828ca' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_87",max(case when linkid = '654d5688-f42a-469b-8494-81115b760e29' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_88",max(case when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_89",max(case when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_90",max(case when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_91",max(case when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_92",max(case when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_93",max(case when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_94",max(case when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down",max(case when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_96",max(case when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_97",max(case when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_98",max(case when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_99",max(case when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_100",max(case when linkid = 'ad609c63-366e-476a-b131-610ceed211da' then answer_value_text end) as "sbirt_things_others_can_help_you_do",max(case when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_102",max(case when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac' then answer_value_text end) as "sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_e",max(case when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_104",max(case when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_105",max(case when linkid = '6281fa0d-ef3f-4013-bd31-062371828010' then answer_value_text end) as "sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whipp",max(case when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_107",max(case when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe' then answer_value_text end) as "sbirt_sedatives_just_for_the_feeling_more_than_prescribe",max(case when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f' then answer_value_text end) as "sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecs",max(case when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404' then answer_value_text end) as "sbirt_any_other_drugs_to_get_high",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '36af2335-ac86-4864-8a3d-619451160cc5' then answer_value_text end) as "2_times_in_a_day",max(case when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f' then answer_value_text end) as "join_a_community_group_and",max(case when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5' then answer_value_text end) as "therapy",max(case when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528' then answer_value_text end) as "2_days_per_week",max(case when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730' then answer_value_text end) as "field_445adcc0",max(case when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045' then answer_value_text end) as "3_days_per_week",max(case when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb' then answer_value_text end) as "not_ready",max(case when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6' then answer_value_text end) as "quit",max(case when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5' then answer_value_text end) as "20250224",max(case when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3' then answer_value_text end) as "2_times_in_a_day_124",max(case when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d' then answer_value_text end) as "field_859d58d6",max(case when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427' then answer_value_text end) as "field_8a6c4c5b",max(case when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7' then answer_value_text end) as "social_places_you_can_go_to_eg_take_a_walk_at_the_park",max(case when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4' then answer_value_text end) as "internally",max(case when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3' then answer_value_text end) as "work_toward_a_goal",max(case when linkid = 'drug-to-use-alcohol' then answer_value_text end) as "drug-to-use-alcohol",max(case when linkid = 'drug-to-use-marijuana-or-other' then answer_value_text end) as "drug-to-use-marijuana-or-other",max(case when linkid = 'health-goals-do-not-want-to-change' then answer_value_text end) as "health-goals-do-not-want-to-change",max(case when linkid = 'is-drug-dependence' then answer_value_text end) as "is-drug-dependence",max(case when linkid = 'is-high-risk-alcohol' then answer_value_text end) as "is-high-risk-alcohol",max(case when linkid = 'is-high-risk-drug' then answer_value_text end) as "is-high-risk-drug",max(case when linkid = 'is-low-risk-alcohol' then answer_value_text end) as "is-low-risk-alcohol",max(case when linkid = 'is-low-risk-drug' then answer_value_text end) as "is-low-risk-drug",max(case when linkid = 'is-medium-risk-alcohol' then answer_value_text end) as "is-medium-risk-alcohol",max(case when linkid = 'is-medium-risk-drug' then answer_value_text end) as "is-medium-risk-drug",max(case when linkid = 'is-opioid-dependence' then answer_value_text end) as "is-opioid-dependence",max(case when linkid = 'other-drug-list' then answer_value_text end) as "other-drug-list",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender' then answer_value_text end) as "patient-gender",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'score-audit' then answer_value_text end) as "score-audit",max(case when linkid = 'score-dast' then answer_value_text end) as "score-dast",max(case when linkid = 'should-converse-about-substance-use' then answer_value_text end) as "should-converse-about-substance-use",max(case when linkid = 'should-discuss-health-goals' then answer_value_text end) as "should-discuss-health-goals",max(case when linkid = 'show-client-use-with-other-drugs' then answer_value_text end) as "show-client-use-with-other-drugs",max(case when linkid = 'show-discuss-next-steps' then answer_value_text end) as "show-discuss-next-steps",max(case when linkid = 'show-goals' then answer_value_text end) as "show-goals",max(case when linkid = 'show-intervention-when-low-risk' then answer_value_text end) as "show-intervention-when-low-risk",max(case when linkid = 'show-intervention-when-medium-high-risk' then answer_value_text end) as "show-intervention-when-medium-high-risk",max(case when linkid = 'show-is-medium-high-risk' then answer_value_text end) as "show-is-medium-high-risk",max(case when linkid = 'show-summary-for-low-risk' then answer_value_text end) as "show-summary-for-low-risk",max(case when linkid = 'show-things-to-do' then answer_value_text end) as "show-things-to-do",max(case when linkid = 'task-id-sbirt-pdf' then answer_value_text end) as "task-id-sbirt-pdf",max(case when linkid = 'using-opioids-and-low-risk' then answer_value_text end) as "using-opioids-and-low-risk"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:44.432245 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:25:44.432493 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m09:25:44.432742 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:25:44.432971 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:25:44.433275 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 2) with readable column names
-- Questionnaire ID: 56
-- Source file: questionnaire/ipc-session-2/sf-pcl-5-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ptsd_session_2",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_pcptsd_session_2_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s2_score_meaning_13",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s2_is_ptsd",max(case when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:44.433702 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 1) with readable column names
-- Questionnaire ID: 204
-- Source file: questionnaire/ipc-session-1/sf-pcl-5-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505' then answer_value_text end) as "ipc_s1_taskid_ptsd_pdf",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av_8",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ptsd_session_1",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_pcptsd_session_1_score",max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s1_score_meaning_14",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s1_is_ptsd",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:44.436760 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:44.437077 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:44.439086 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:25:44.440702 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:25:44.440955 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp" rename to "qr_sf_pcl_5_s2"
[0m09:25:44.441178 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp" rename to "qr_sf_pcl_5_s1"
[0m09:25:44.441456 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:25:44.443196 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:25:44.443449 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:44.443671 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp" rename to "qr_sbirt"
[0m09:25:44.443828 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:44.444505 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:25:44.445372 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:25:44.445802 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:25:44.446060 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:25:44.446380 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:25:44.446704 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:25:44.446940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:44.447742 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:25:44.447969 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:25:44.448141 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:25:44.448420 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:44.448668 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:44.450102 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup"
[0m09:25:44.450382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:44.451691 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup"
[0m09:25:44.452051 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:25:44.453260 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup"
[0m09:25:44.453548 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:25:44.453752 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup" cascade
[0m09:25:44.454114 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:25:44.454331 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup" cascade
[0m09:25:44.454570 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup" cascade
[0m09:25:44.455162 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:44.455381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:44.455588 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:44.456349 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: Close
[0m09:25:44.457004 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: Close
[0m09:25:44.457587 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: Close
[0m09:25:44.457929 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134502f0>]}
[0m09:25:44.458169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11328e720>]}
[0m09:25:44.458543 [info ] [Thread-4 (]: 45 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [[32mCREATE VIEW[0m in 0.63s]
[0m09:25:44.460027 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:25:44.459574 [info ] [Thread-1 (]: 43 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sbirt  [[32mCREATE VIEW[0m in 0.70s]
[0m09:25:44.460241 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:25:44.460728 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_sbirt
[0m09:25:44.458840 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113292480>]}
[0m09:25:44.460987 [info ] [Thread-4 (]: 47 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [RUN]
[0m09:25:44.461417 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_sociodemographic_survey
[0m09:25:44.461974 [info ] [Thread-2 (]: 44 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [[32mCREATE VIEW[0m in 0.64s]
[0m09:25:44.462450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s2, now model.engage_analytics.qr_sf_pcl_5_s4)
[0m09:25:44.462790 [info ] [Thread-1 (]: 48 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [RUN]
[0m09:25:44.463095 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:25:44.463282 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:25:44.463538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sbirt, now model.engage_analytics.qr_sociodemographic_survey)
[0m09:25:44.463780 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_spi_subform_1
[0m09:25:44.466427 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:25:44.466716 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_sociodemographic_survey
[0m09:25:44.467375 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:44.469879 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:25:44.467109 [info ] [Thread-2 (]: 49 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [RUN]
[0m09:25:44.470378 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:44.470619 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:44.470865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s1, now model.engage_analytics.qr_spi_subform_1)
[0m09:25:44.471216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:44.471426 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_spi_subform_1
[0m09:25:44.476998 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:25:44.477445 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:44.477740 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:44.687249 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.604 seconds
[0m09:25:44.688385 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:25:44.688920 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:25:44.690861 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:25:44.691333 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:25:44.691524 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: BEGIN
[0m09:25:44.692550 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:44.692764 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:25:44.693167 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 3) with readable column names
-- Questionnaire ID: 60
-- Source file: questionnaire/ipc-session-3/sf-pcl-5-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ptsd_session_3",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s3_score_meaning_12",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s3_is_ptsd",max(case when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:44.696248 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:44.697845 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:25:44.698028 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp" rename to "qr_sf_pcl_5_s3"
[0m09:25:44.698883 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:44.699525 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:25:44.699718 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:25:44.699877 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:25:44.700614 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:44.701734 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup"
[0m09:25:44.701989 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:25:44.702186 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup" cascade
[0m09:25:44.702905 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:44.703734 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: Close
[0m09:25:44.704044 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e83b0>]}
[0m09:25:44.704365 [info ] [Thread-3 (]: 46 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [[32mCREATE VIEW[0m in 0.62s]
[0m09:25:44.704639 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:25:44.704833 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_spi_subform_2
[0m09:25:44.705092 [info ] [Thread-3 (]: 50 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [RUN]
[0m09:25:44.705289 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s3, now model.engage_analytics.qr_spi_subform_2)
[0m09:25:44.705452 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_spi_subform_2
[0m09:25:44.707852 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:25:44.708089 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:44.708270 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:45.068408 [debug] [Thread-2 (]: SQL status: SELECT 24 in 0.590 seconds
[0m09:25:45.071350 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_1"
[0m09:25:45.071892 [debug] [Thread-1 (]: SQL status: SELECT 25 in 0.601 seconds
[0m09:25:45.072446 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.602 seconds
[0m09:25:45.073831 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:25:45.074667 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:25:45.075629 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_spi_subform_1
[0m09:25:45.077691 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_1"
[0m09:25:45.077938 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_sociodemographic_survey
[0m09:25:45.079520 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:25:45.079759 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:25:45.081371 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:25:45.081700 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:25:45.081924 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: BEGIN
[0m09:25:45.082196 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:25:45.082427 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:25:45.082609 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: BEGIN
[0m09:25:45.082838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:45.083333 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:25:45.083624 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Sociodemographic Survey with readable column names
-- Questionnaire ID: 1613531
-- Source file: questionnaire/assessments/sociodemographic_survey.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7' then answer_value_text end) as "demographic_if_you_were_not_born_in_the_us_how_long_have_you_l",max(case when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5' then answer_value_text end) as "demographic_please_specify",max(case when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde' then answer_value_text end) as "demographic_please_specify_3",max(case when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe' then answer_value_text end) as "demographic_where_were_you_born",max(case when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af' then answer_value_text end) as "demographic_what_is_the_zip_code_of_where_you_currently_live",max(case when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739' then answer_value_text end) as "demographic_what_was_your_biological_sex_at_birth",max(case when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d' then answer_value_text end) as "demographic_please_enter_the_number_of_years",max(case when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173' then answer_value_text end) as "demographic_we_would_like_to_know_about_what_you_do_are_you",max(case when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4' then answer_value_text end) as "demographic_please_enter_the_number_of_months",max(case when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9' then answer_value_text end) as "demographic_what_is_your_race_andor_ethnicity",max(case when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0' then answer_value_text end) as "demographic_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '92fed595-49f2-4fab-81ff-885941f31e07' then answer_value_text end) as "demographic_where_did_this_client_first_learn_about_engage",max(case when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a' then answer_value_text end) as "demographic_what_is_your_marital_status",max(case when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c' then answer_value_text end) as "demographic_what_term_best_expresses_how_you_describe_your_gen",max(case when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba' then answer_value_text end) as "demographic_what_was_the_highest_grade_or_level_of_school_that",max(case when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f' then answer_value_text end) as "demographic_please_specify_the_us_territorycommonwealth_eg_pue",max(case when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130' then answer_value_text end) as "some_of_the_time",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:45.083948 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:45.083082 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_1: BEGIN
[0m09:25:45.084196 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:25:45.084549 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 4) with readable column names
-- Questionnaire ID: 210
-- Source file: questionnaire/ipc-session-4/sf-pcl-5-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s4_encounter_id_of_ptsd_session_4",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s4_score_meaning_12",max(case when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:45.084914 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:45.085112 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:25:45.085453 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 1 with readable column names
-- Questionnaire ID: 104455
-- Source file: questionnaire/spi/spi-subform-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_1",max(case when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab' then answer_value_text end) as "spi_is_low_risk",max(case when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d' then answer_value_text end) as "spi_is_medium_risk",max(case when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b' then answer_value_text end) as "spi_is_high_risk",max(case when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5' then answer_value_text end) as "spi_were_any_of_these_in_the_past_three_months",max(case when linkid = '35062b98-748b-441c-ad74-185823e1bb52' then answer_value_text end) as "spi_in_the_past_month_have_you_been_thinking_about_how",max(case when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb' then answer_value_text end) as "spi_in_the_past_month_have_you_had_these_thoughts_and_",max(case when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23' then answer_value_text end) as "spi_in_the_past_month_have_you_started_to_work_out_or_",max(case when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511' then answer_value_text end) as "spi_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea' then answer_value_text end) as "spi_have_you_ever_done_anything_started_to_do_anything",max(case when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce' then answer_value_text end) as "spi_in_the_past_month_have_you_actually_had_any_though",max(case when linkid = 'task-id-spi-subform-2' then answer_value_text end) as "spi_taskid_spi_subform_2",max(case when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03' then answer_value_text end) as "spi_43898926e9d5400ea09562a8c7f8dd03",max(case when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837' then answer_value_text end) as "spi_644c00f28b07491192d0f05f5e5cc837",max(case when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9' then answer_value_text end) as "spi_71dbaac9867f4d7fb6d7e1f59402bbf9",max(case when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda' then answer_value_text end) as "spi_7fc39fba84db490daf4e8f772d91ffda",max(case when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42' then answer_value_text end) as "spi_a6601f970a3449d0b181611d6705ca42",max(case when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423' then answer_value_text end) as "spi_c7d21a570fc64e3ab411beceb1fb2423",max(case when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019' then answer_value_text end) as "spi_ecabd308c45a41f78754b1f63a101019",max(case when linkid = 'task-status-spi-subform-2' then answer_value_text end) as "spi_taskstatus_spi_subform_2",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "task-id-spi-subform-3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "task-id-spi-subform-4",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "task-status-spi-subform-3",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "task-status-spi-subform-4"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:45.087010 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:45.088721 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:25:45.088951 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:25:45.089142 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:45.089328 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp" rename to "qr_sociodemographic_survey"
[0m09:25:45.091651 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:25:45.093116 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:25:45.093343 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp" rename to "qr_sf_pcl_5_s4"
[0m09:25:45.093525 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp" rename to "qr_spi_subform_1"
[0m09:25:45.094072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:45.094687 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:25:45.094869 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:45.095028 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:45.095184 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:25:45.095704 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:25:45.096208 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:25:45.096380 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:25:45.096537 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:25:45.096688 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:25:45.096869 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:25:45.097024 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:25:45.097597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:45.097853 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:45.098052 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:45.099124 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup"
[0m09:25:45.100201 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup"
[0m09:25:45.101424 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup"
[0m09:25:45.101741 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:25:45.102067 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:25:45.102368 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:25:45.102571 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup" cascade
[0m09:25:45.102760 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup" cascade
[0m09:25:45.102934 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup" cascade
[0m09:25:45.103579 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:45.103748 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:45.104454 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: Close
[0m09:25:45.104620 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:45.105218 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_1: Close
[0m09:25:45.105841 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: Close
[0m09:25:45.106087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112dbb30>]}
[0m09:25:45.106329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b94c0>]}
[0m09:25:45.106643 [info ] [Thread-1 (]: 48 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [[32mCREATE VIEW[0m in 0.64s]
[0m09:25:45.106979 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d88c0>]}
[0m09:25:45.107938 [info ] [Thread-4 (]: 47 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [[32mCREATE VIEW[0m in 0.64s]
[0m09:25:45.107353 [info ] [Thread-2 (]: 49 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [[32mCREATE VIEW[0m in 0.64s]
[0m09:25:45.108253 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:25:45.107680 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_sociodemographic_survey
[0m09:25:45.108604 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_spi_subform_1
[0m09:25:45.108808 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_spi_subform_3
[0m09:25:45.109104 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_spi_subform_4
[0m09:25:45.109401 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_start_ipc_s1
[0m09:25:45.109707 [info ] [Thread-4 (]: 51 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [RUN]
[0m09:25:45.109958 [info ] [Thread-1 (]: 52 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [RUN]
[0m09:25:45.110189 [info ] [Thread-2 (]: 53 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [RUN]
[0m09:25:45.110479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s4, now model.engage_analytics.qr_spi_subform_3)
[0m09:25:45.110690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sociodemographic_survey, now model.engage_analytics.qr_spi_subform_4)
[0m09:25:45.110931 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_1, now model.engage_analytics.qr_start_ipc_s1)
[0m09:25:45.111145 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_spi_subform_3
[0m09:25:45.111303 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_spi_subform_4
[0m09:25:45.111457 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_start_ipc_s1
[0m09:25:45.114070 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:25:45.116448 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:25:45.119377 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:25:45.119699 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:45.119914 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:45.120144 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:45.120356 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:45.120562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:45.120852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:45.332140 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.624 seconds
[0m09:25:45.333290 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_2"
[0m09:25:45.334722 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_spi_subform_2
[0m09:25:45.337407 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_2"
[0m09:25:45.337988 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:25:45.338203 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: BEGIN
[0m09:25:45.339030 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:45.339379 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:25:45.339661 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 2 with readable column names
-- Questionnaire ID: 104453
-- Source file: questionnaire/spi/spi-subform-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_2",max(case when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36' then answer_value_text end) as "spi_did_this_client_also_screen_positive_for_probable_",max(case when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896' then answer_value_text end) as "spi_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab_5",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "spi_taskid_spi_subform_3",max(case when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50' then answer_value_text end) as "spi_d02eb882411e4bc0af9d08a77fcc3f50",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "spi_taskstatus_spi_subform_3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "spi_taskid_spi_subform_4",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "spi_taskstatus_spi_subform_4",max(case when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f' then answer_value_text end) as "spi_53b30f1274eb474c941c5f0e81b7eb9f",max(case when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253' then answer_value_text end) as "spi_did_you_discuss_this_clients_suicide_risk_screenin",max(case when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b' then answer_value_text end) as "spi_this_client_scored_in_the_moderate_to_high_range_o",max(case when linkid = '783e2646-c8ea-466d-bba8-85c891a14435' then answer_value_text end) as "spi_783e2646c8ea466dbba885c891a14435"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:45.342769 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:45.344464 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:25:45.344663 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp" rename to "qr_spi_subform_2"
[0m09:25:45.345722 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:45.346713 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:25:45.346948 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:25:45.347115 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:25:45.348571 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:45.349994 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup"
[0m09:25:45.350327 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:25:45.350512 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup" cascade
[0m09:25:45.351298 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:45.351989 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: Close
[0m09:25:45.352276 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113353c80>]}
[0m09:25:45.352594 [info ] [Thread-3 (]: 50 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [[32mCREATE VIEW[0m in 0.65s]
[0m09:25:45.353025 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_spi_subform_2
[0m09:25:45.353321 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_start_ipc_s2
[0m09:25:45.353574 [info ] [Thread-3 (]: 54 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [RUN]
[0m09:25:45.353886 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_2, now model.engage_analytics.qr_start_ipc_s2)
[0m09:25:45.354232 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_start_ipc_s2
[0m09:25:45.357403 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:25:45.357749 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:45.357943 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:45.735780 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.615 seconds
[0m09:25:45.738535 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_3"
[0m09:25:45.739683 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_spi_subform_3
[0m09:25:45.741768 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_3"
[0m09:25:45.742210 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:25:45.742386 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: BEGIN
[0m09:25:45.743139 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:45.743417 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:25:45.743639 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 3 with readable column names
-- Questionnaire ID: 104454
-- Source file: questionnaire/spi/spi-subform-3.json




  
  

  
  

  
  

  
  
    
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_3"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:45.745790 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:25:45.747419 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:25:45.747625 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp" rename to "qr_spi_subform_3"
[0m09:25:45.747825 [debug] [Thread-1 (]: SQL status: SELECT 231 in 0.627 seconds
[0m09:25:45.750277 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_4"
[0m09:25:45.750642 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:25:45.751437 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:25:45.751714 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:25:45.751939 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:25:45.752127 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_spi_subform_4
[0m09:25:45.753988 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_4"
[0m09:25:45.754191 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:45.755240 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup"
[0m09:25:45.755532 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:25:45.755702 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup" cascade
[0m09:25:45.755985 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:25:45.756157 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: BEGIN
[0m09:25:45.756364 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:45.757090 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: Close
[0m09:25:45.757282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:45.757853 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:25:45.757690 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113397d70>]}
[0m09:25:45.758891 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 4 with readable column names
-- Questionnaire ID: 104394
-- Source file: questionnaire/spi/spi-subform-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_4",max(case when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk_",max(case when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8' then answer_value_text end) as "spi_in_a_few_days_i_would_like_to_meet_for_a_followup_",max(case when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904' then answer_value_text end) as "spi_person_1",max(case when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0' then answer_value_text end) as "spi_when_you_feel_a_suicidal_crisis_arising_go_through",max(case when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185' then answer_value_text end) as "spi_i_would_like_to_make_a_plan_that_will_help_you_man",max(case when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048' then answer_value_text end) as "spi_cce2de12cf6244ff84e89eb4d864d048",max(case when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri",max(case when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb' then answer_value_text end) as "spi_40fbe8d043804efcbb0426fc7d3714eb",max(case when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7' then answer_value_text end) as "spi_the_methods_i_have_thought_about_using_include",max(case when linkid = '808ba31c-cd29-4743-8801-dfce357d5956' then answer_value_text end) as "spi_person_1_11",max(case when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc' then answer_value_text end) as "spi_90cedcbfbf114dc3973342e6900a09fc",max(case when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031' then answer_value_text end) as "spi_92ab6e65f9bd47188af6f731425d3031",max(case when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3' then answer_value_text end) as "spi_9d203bac75fd4f31bed6073502a977f3",max(case when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54' then answer_value_text end) as "spi_additional_hotline_numbers_you_can_contact",max(case when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk__16",max(case when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969' then answer_value_text end) as "spi_12d89dfd5e434f008446b3af23323969",max(case when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3' then answer_value_text end) as "spi_39de8b745cbc4225b27bc97e72f08af3",max(case when linkid = '437d9ea2-adb5-471a-828b-a0285a282217' then answer_value_text end) as "spi_437d9ea2adb5471a828ba0285a282217",max(case when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd' then answer_value_text end) as "spi_509b140eb1954696bc5ff2fc2d2f77dd",max(case when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7' then answer_value_text end) as "spi_53a575e3aa59408da0dd8df237b68bf7",max(case when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256' then answer_value_text end) as "spi_a6d066a2028649b0b68834696e7fb256",max(case when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4' then answer_value_text end) as "spi_ce56c71d9ea44c8e9e9ad1da93bac1d4",max(case when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect_",max(case when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77' then answer_value_text end) as "spi_person_1_25",max(case when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0' then answer_value_text end) as "spi_person_1_26",max(case when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0' then answer_value_text end) as "spi_beb4ad5f2fd84b80aa93aa9ff1896dd0",max(case when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46' then answer_value_text end) as "spi_c396a3af6f0d4a8ea42b4f47bbce5f46",max(case when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9' then answer_value_text end) as "spi_e45b778dee8c4ee981f48927006160f9",max(case when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003' then answer_value_text end) as "spi_your_local_hotline_number",max(case when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888' then answer_value_text end) as "spi_101d2b7f2b68407daa4930cb4dadc888",max(case when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0' then answer_value_text end) as "spi_14ec8995eee9416f83ad9f44631ac9b0",max(case when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564' then answer_value_text end) as "spi_18d8ee56ffd847119074126ef2cdc564",max(case when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by",max(case when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124' then answer_value_text end) as "spi_5324bdcebaaa45bf935aeb2f65bd7124",max(case when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488' then answer_value_text end) as "spi_68fa6f2e84ec4dbc900e10ede297c488",max(case when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4' then answer_value_text end) as "spi_8891cd7bad1c4030afe46752cd273cf4",max(case when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri_38",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi' then answer_value_text end) as "spi_taskid_spi_navigator",max(case when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0' then answer_value_text end) as "spi_c631e361027c4e4db89448785a3e6dd0",max(case when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410' then answer_value_text end) as "spi_taskid_my_safety_plan_pdf",max(case when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871' then answer_value_text end) as "spi_a1c56f60b8234c15b99da315d2ca1871",max(case when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9' then answer_value_text end) as "spi_ae4fa455f173435abb1b4df1d1316bd9",max(case when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad' then answer_value_text end) as "spi_bc981d8a7f22450babab3acca810ccad",max(case when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db' then answer_value_text end) as "spi_c6c266cc1c8541c097ce9ab491be45db",max(case when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233' then answer_value_text end) as "spi_person_2",max(case when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7' then answer_value_text end) as "spi_7d8621a4dcc84f4892103fb7d0dcc3c7",max(case when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164' then answer_value_text end) as "spi_83661ebe71cf4eab88e3bfecbfe35164",max(case when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12' then answer_value_text end) as "spi_be88b02764b64c3cbf5936a94dc79b12",max(case when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de' then answer_value_text end) as "spi_c3b4cf6e385d40b793804de2f81463de",max(case when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso",max(case when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect__53",max(case when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7' then answer_value_text end) as "spi_ff115c2695b94e0d87ed80817d438fc7",max(case when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596' then answer_value_text end) as "spi_656a57f8f6f04fc5b34771dd8d38f596",max(case when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7' then answer_value_text end) as "spi_f749685963bb4b2f8f7596e44e893bf7",max(case when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0' then answer_value_text end) as "spi_f8861b1c781f4f12b4c8f8110f0c2cc0",max(case when linkid = '15e5007d-028f-4644-8fb6-0346730c3101' then answer_value_text end) as "spi_15e5007d028f46448fb60346730c3101",max(case when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by",max(case when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_60",max(case when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e' then answer_value_text end) as "spi_2b2e05e90c11490cbbff278ba90d7b4e",max(case when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070' then answer_value_text end) as "spi_3e388595a32f46238c9f3c67bad04070",max(case when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123' then answer_value_text end) as "spi_62b0eb1746e54c50a133087cc190a123",max(case when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by_64",max(case when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609' then answer_value_text end) as "spi_705df2d9af924f4fb51317e01d07b609",max(case when linkid = '7845c436-4904-41fa-9553-2c401935623b' then answer_value_text end) as "spi_7845c436490441fa95532c401935623b",max(case when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe' then answer_value_text end) as "spi_person_2_67",max(case when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95' then answer_value_text end) as "spi_person_2_68",max(case when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966' then answer_value_text end) as "spi_c802f463c8f54056bc458ab8d64a1966",max(case when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by_70",max(case when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63' then answer_value_text end) as "spi_2a6c5feb8034418b8644142a5e31df63",max(case when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb' then answer_value_text end) as "spi_3785a2648bd544abbf088aa33735c0eb",max(case when linkid = '544a444d-b101-4d56-9351-00bca8ec749e' then answer_value_text end) as "spi_person_2_73",max(case when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea' then answer_value_text end) as "spi_603d1492316f497f967b5c4b1ab983ea",max(case when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f' then answer_value_text end) as "spi_9f3a622ad39b49b084e70bcf4f832a4f",max(case when linkid = 'e9c42647-eefb-42bd-9080-f83630729606' then answer_value_text end) as "spi_e9c42647eefb42bd9080f83630729606",max(case when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d' then answer_value_text end) as "spi_ee5d4acfecf04e628924cff17a33679d",max(case when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e' then answer_value_text end) as "spi_fe2f09118ddc412ba3e6f216620d147e",max(case when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a' then answer_value_text end) as "spi_370c849b0e0042acbe9d3b4c719ac31a",max(case when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52' then answer_value_text end) as "spi_person_3",max(case when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb' then answer_value_text end) as "spi_08b5e17c5e144b19ac939e479cd2a2bb",max(case when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86' then answer_value_text end) as "spi_13321778b5d44b018eda610cf0007c86",max(case when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by_84",max(case when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17' then answer_value_text end) as "spi_84018cd89134429c8dfefd6a16e4bd17",max(case when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer",max(case when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604' then answer_value_text end) as "spi_fdd7c3c3f2c343bd8a806b48aa2b9604",max(case when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4' then answer_value_text end) as "spi_8a9424b0c8934371b5c9bc0008be14b4",max(case when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af' then answer_value_text end) as "spi_a5d96f90cd914a5b8862c4e3f88694af",max(case when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3' then answer_value_text end) as "spi_person_3_90",max(case when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb' then answer_value_text end) as "spi_28b2e31aee4d4e998974b616145311eb",max(case when linkid = '53932020-eed8-46f4-8236-d548a6335a59' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by_92",max(case when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db' then answer_value_text end) as "spi_7e38a614b0a248eab7c7ca2bdc1f00db",max(case when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf' then answer_value_text end) as "spi_c1e99f8bb1ab46d1b205ecbbb4240fdf",max(case when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_95",max(case when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54' then answer_value_text end) as "spi_d4ebe78407d043128a46634c0e338a54",max(case when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47' then answer_value_text end) as "spi_53def3a1a7e5432695f22561c26ecb47",max(case when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b' then answer_value_text end) as "spi_2b96f1d93450423da277060fcfdadc6b",max(case when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5' then answer_value_text end) as "spi_person_4",max(case when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d' then answer_value_text end) as "spi_b36fdd5fccac457ca8eaf9497204ef1d",max(case when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_101",max(case when linkid = 'c5720a67-803f-4917-8261-3738de838418' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer_102",max(case when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5' then answer_value_text end) as "spi_person_3_103",max(case when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa' then answer_value_text end) as "spi_f952feaf7abc4f6fa3bcd10a43ea62fa",max(case when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6' then answer_value_text end) as "spi_bd7644ee28f14f43a65417fd5034d1f6",max(case when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090' then answer_value_text end) as "spi_72e5c1b77ce949bd834bd98b73ba7090",max(case when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33' then answer_value_text end) as "spi_person_4_107",max(case when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a' then answer_value_text end) as "spi_d82c6ae90516451391fa664686779d6a",max(case when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1' then answer_value_text end) as "spi_person_3_109",max(case when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807' then answer_value_text end) as "spi_fc5c673b41d4435286bb043c73ed9807",max(case when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49' then answer_value_text end) as "spi_0397084acd514b3a809d970a2406ea49",max(case when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972' then answer_value_text end) as "spi_6a273a9882ca4d36ade0ce98f7899972",max(case when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f' then answer_value_text end) as "spi_11aadd880cf948b2939d2b3e28191c5f",max(case when linkid = '57e87170-761c-4b57-a09c-d50cab02860c' then answer_value_text end) as "spi_57e87170761c4b57a09cd50cab02860c",max(case when linkid = '965b7874-dd24-4215-acd4-8d241a262638' then answer_value_text end) as "spi_965b7874dd244215acd48d241a262638",max(case when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb' then answer_value_text end) as "spi_bd62b64972094d329bbbdc2b2823aadb",max(case when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709' then answer_value_text end) as "spi_07c2e8dcb48b4bc7b21bc196cce32709",max(case when linkid = '83dfd82f-0277-459d-abe3-e8795750f288' then answer_value_text end) as "spi_person_5",max(case when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f' then answer_value_text end) as "spi_ae94969792ae476a96ccf8b0adc4221f",max(case when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2' then answer_value_text end) as "spi_2c7b6bd736f6495b9f41eb492c07c7b2",max(case when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_121",max(case when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897' then answer_value_text end) as "spi_fefdc90ffe1d4bfbaf9394df8c482897",max(case when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344' then answer_value_text end) as "spi_1fc8f8e7202248d2b41d4e8ad22af344",max(case when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c' then answer_value_text end) as "spi_8c1ac4fe1d7644368f34d315c6c17b9c",max(case when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d' then answer_value_text end) as "spi_person_5_125",max(case when linkid = 'df53c378-27fe-483d-a630-f7b171f72980' then answer_value_text end) as "spi_df53c37827fe483da630f7b171f72980",max(case when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660' then answer_value_text end) as "spi_e552afd32816446e9ff5e898bc813660",max(case when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_128",max(case when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369' then answer_value_text end) as "spi_person_4_129",max(case when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a' then answer_value_text end) as "spi_44f024678ee049f08da75e7ed827125a",max(case when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9' then answer_value_text end) as "spi_82d6b50b0bb240f694b17a4c58df43f9",max(case when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c' then answer_value_text end) as "spi_892337bdd7fd46a7bf7208e87c9f412c",max(case when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b' then answer_value_text end) as "spi_e4a1be29fe8b442391bc6b4f5d730e6b",max(case when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2' then answer_value_text end) as "spi_9f46e0ff05324105be360cfa9d0770f2",max(case when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8' then answer_value_text end) as "spi_86da79f044cb417dab20c7ecc6f8f7c8",max(case when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7' then answer_value_text end) as "spi_ce0fdd416b0941049998a04c5dd9a5b7",max(case when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0' then answer_value_text end) as "spi_3314932c64e44192b583eb31e87da1d0",max(case when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206' then answer_value_text end) as "spi_5e2ab0f5f5d94502befeaba770f0e206",max(case when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240' then answer_value_text end) as "spi_796f544054f84d69b961a5b7e6a63240",max(case when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478' then answer_value_text end) as "spi_9f531e6126cf4223865339c24d6dd478",max(case when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_141",max(case when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021' then answer_value_text end) as "spi_4d334b16ea16429994ed32e84ef97021",max(case when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf' then answer_value_text end) as "spi_895fad45c3b547c59edf5f9b9e793fbf",max(case when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc' then answer_value_text end) as "spi_92da95cc50dd4bf0acca4465c07d44cc",max(case when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd' then answer_value_text end) as "spi_person_5_145",max(case when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc' then answer_value_text end) as "spi_f1fef9d72ab94ead9c24c4dc9c7ed4cc",max(case when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2' then answer_value_text end) as "spi_40d6a87f94984cfdb2334610e6de08c2",max(case when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668' then answer_value_text end) as "spi_ac3206ddb60b4cb1a5593a770a685668",max(case when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21' then answer_value_text end) as "spi_f895ed4f50044da49d59c21293674b21",max(case when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8' then answer_value_text end) as "spi_faefef23d2e64777b6288f83921e8fd8",max(case when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c' then answer_value_text end) as "spi_62a0463889284aabb4901a33739b7a5c",max(case when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f' then answer_value_text end) as "spi_bfe595d6325f492ab3b6cc5541e18c3f",max(case when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa' then answer_value_text end) as "spi_40d8ef6402f042ae947877651bd26dfa",max(case when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3' then answer_value_text end) as "spi_249f5ce8ecc04e4396756b01ca1502a3",max(case when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27' then answer_value_text end) as "spi_9b1b11e8608f4ea9911b88aae467ac27",max(case when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4' then answer_value_text end) as "spi_dae7f411758d48009842fc0038a6b4a4",max(case when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14' then answer_value_text end) as "spi_0c308fef8ce54217a8d48e6ff00c8e14",max(case when linkid = '54b75d55-1c43-4552-acbf-d9754831add8' then answer_value_text end) as "spi_54b75d551c434552acbfd9754831add8",max(case when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c' then answer_value_text end) as "spi_9faa2b7818424326bf7f9975bf04dc2c",max(case when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f' then answer_value_text end) as "spi_a320b7874cba457f9c6067ff76c7020f",max(case when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc' then answer_value_text end) as "spi_706fc36fefef4bf9827e7dc100cc92bc",max(case when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a' then answer_value_text end) as "spi_a57b5b3412e54ec882157f316267323a",max(case when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75' then answer_value_text end) as "spi_6bbdb2cfe7f6443a8f4e841e16bb9b75",max(case when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e' then answer_value_text end) as "spi_d617b1e1ea224863a878627f6b81963e",max(case when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc' then answer_value_text end) as "spi_2cedd4dd15e549518674ea4d4eeb7cfc",max(case when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200' then answer_value_text end) as "spi_c0655b118f2147ed8ede95498c2e8200",max(case when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225' then answer_value_text end) as "spi_1895c0a7b0904f499b0c08dca9a7b225",max(case when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c' then answer_value_text end) as "spi_f311f3ca5537413488285e537bb26a9c",max(case when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268' then answer_value_text end) as "spi_1a00c7b7e80d4e908ed4efd8f6d96268",max(case when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e' then answer_value_text end) as "spi_527c0166cc354cc3a9d97eeb0a54635e",max(case when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed' then answer_value_text end) as "spi_41cce38aca5c4e24904a25b1027336ed",max(case when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5' then answer_value_text end) as "spi_e8726638cfdb40aeb72cf1d594f64de5",max(case when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f' then answer_value_text end) as "spi_6ac23c5d0035489585f233c2fbba8f3f",max(case when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99' then answer_value_text end) as "spi_e7ba8485515441b8ac1835410a83cd99",max(case when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81' then answer_value_text end) as "spi_06f9231a999b445982606fbbcdfc5d81",max(case when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444' then answer_value_text end) as "spi_d8615ac796b246a2b3a5b5b83945b444",max(case when linkid = '74d0f0df-e726-4c40-84ce-efece882818b' then answer_value_text end) as "spi_74d0f0dfe7264c4084ceefece882818b",max(case when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d' then answer_value_text end) as "spi_1d0ad82509de4018a680cd0e6bf0983d",max(case when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03' then answer_value_text end) as "spi_d5194db005464bd196d8d56457930c03",max(case when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131' then answer_value_text end) as "spi_9e11ce9790e842f2ba188c4f0720c131",max(case when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0' then answer_value_text end) as "spi_cb75bba90bd84dceba2fd1b21a97c2a0",max(case when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2' then answer_value_text end) as "spi_2f44652fdf2d476e933d75b6ed55f5f2",max(case when linkid = '7b51625b-73b9-472d-9c71-299beb26694f' then answer_value_text end) as "spi_7b51625b73b9472d9c71299beb26694f",max(case when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a' then answer_value_text end) as "spi_13e2f93482ed4b23af6e95523dc3746a",max(case when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248' then answer_value_text end) as "spi_ec54e447c9814dd2aaa4659f8e494248",max(case when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71' then answer_value_text end) as "spi_cf16ca6e8b1b467db807fc5d50339f71",max(case when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d' then answer_value_text end) as "spi_ce18eee3aa6444238db150fe7f00850d",max(case when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c' then answer_value_text end) as "spi_5a79866df1fb4bd8b4c4f18c982bef3c",max(case when linkid = '45772f3f-c610-408b-942b-359769945cf4' then answer_value_text end) as "spi_45772f3fc610408b942b359769945cf4",max(case when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111' then answer_value_text end) as "spi_cebffdf48fd14829884c41cc42bc0111",max(case when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0' then answer_value_text end) as "spi_7ca03155c9ec45e18cd05b86fa444ad0",max(case when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149' then answer_value_text end) as "spi_46c2861b70a94fdf94eae1a01cae3149",max(case when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d' then answer_value_text end) as "spi_8a5b1c7de3ef444385f1fa5213d89f8d",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12' then answer_value_text end) as "paracetamol",max(case when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98' then answer_value_text end) as "tiredness",max(case when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6' then answer_value_text end) as "watching_tv",max(case when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6' then answer_value_text end) as "wait_what",max(case when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by",max(case when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe' then answer_value_text end) as "sleeping",max(case when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f' then answer_value_text end) as "what",max(case when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264' then answer_value_text end) as "what_205",max(case when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d' then answer_value_text end) as "wait",max(case when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05' then answer_value_text end) as "wait_what_207",max(case when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13' then answer_value_text end) as "tiredness_208",max(case when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by_209",max(case when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8' then answer_value_text end) as "sleeping_210",max(case when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d' then answer_value_text end) as "socialize",max(case when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2' then answer_value_text end) as "yoga_playing_with_dog",max(case when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b' then answer_value_text end) as "watching_tv_213",max(case when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351' then answer_value_text end) as "video_games",max(case when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7' then answer_value_text end) as "wait_215",max(case when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba' then answer_value_text end) as "walking_in_the_park",max(case when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8' then answer_value_text end) as "none",max(case when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9' then answer_value_text end) as "20250204",max(case when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0' then answer_value_text end) as "taking_toxins",max(case when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a' then answer_value_text end) as "tiktok_dance_challenges",max(case when linkid = 'no-response-step-1' then answer_value_text end) as "no-response-step-1",max(case when linkid = 'no-response-step-1-review' then answer_value_text end) as "no-response-step-1-review",max(case when linkid = 'no-response-step-2' then answer_value_text end) as "no-response-step-2",max(case when linkid = 'no-response-step-2-review' then answer_value_text end) as "no-response-step-2-review",max(case when linkid = 'no-response-step-3' then answer_value_text end) as "no-response-step-3",max(case when linkid = 'no-response-step-3-review' then answer_value_text end) as "no-response-step-3-review",max(case when linkid = 'no-response-step-4' then answer_value_text end) as "no-response-step-4",max(case when linkid = 'no-response-step-4-review' then answer_value_text end) as "no-response-step-4-review",max(case when linkid = 'no-response-step-6a' then answer_value_text end) as "no-response-step-6a",max(case when linkid = 'no-response-step-6a-review' then answer_value_text end) as "no-response-step-6a-review",max(case when linkid = 'other-signs-step-1' then answer_value_text end) as "other-signs-step-1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:45.757445 [debug] [Thread-2 (]: SQL status: SELECT 111 in 0.637 seconds
[0m09:25:45.760104 [info ] [Thread-4 (]: 51 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [[32mCREATE VIEW[0m in 0.65s]
[0m09:25:45.761747 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:25:45.762042 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_spi_subform_3
[0m09:25:45.762344 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_start_ipc_s3
[0m09:25:45.762682 [info ] [Thread-4 (]: 55 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [RUN]
[0m09:25:45.762982 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_3, now model.engage_analytics.qr_start_ipc_s3)
[0m09:25:45.763208 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_start_ipc_s3
[0m09:25:45.765634 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:25:45.765864 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_start_ipc_s1
[0m09:25:45.766105 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:45.769134 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:25:45.769563 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:25:45.770254 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:25:45.770489 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s1: BEGIN
[0m09:25:45.771759 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:45.771978 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:25:45.772164 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:25:45.773986 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:25:45.774638 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 1 with readable column names
-- Questionnaire ID: 55
-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as "ipc_s1_patient_age",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as "ipc_s1_patient_dob",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as "ipc_s1_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as "ipc_s1_in_the_past_6_months",max(case when linkid = 'f1.92.1' then answer_value_text end) as "ipc_s1_f1921",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as "ipc_s1_in_the_past_1_year",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as "ipc_s1_i_noticed_that_when_i_was_asking_about_important_p",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s1_did_you_complete_the_required_assessments_and_the_",max(case when linkid = 'f1.42.2' then answer_value_text end) as "ipc_s1_do_you_think_an_important_persons_death_is_connect",max(case when linkid = 'f1.68.2' then answer_value_text end) as "ipc_s1_are_you_and_someone_else_having_a_strong_disagreem",max(case when linkid = 'f1.69.2' then answer_value_text end) as "ipc_s1_briefly_tell_me_about_the_disagreement",max(case when linkid = 'f1.70.2' then answer_value_text end) as "ipc_s1_how_has_this_disagreement_been_affecting_you",max(case when linkid = 'f1.72.2' then answer_value_text end) as "ipc_s1_have_there_been_any_changes_in_your_life_that_are_",max(case when linkid = 'f1.73.2' then answer_value_text end) as "ipc_s1_what_was_the_change",max(case when linkid = 'f1.74.2' then answer_value_text end) as "ipc_s1_when_did_this_happen",max(case when linkid = 'f1.76.2' then answer_value_text end) as "ipc_s1_if_the_client_did_not_mention_any_close_relationsh",max(case when linkid = 'f1.78.2' then answer_value_text end) as "ipc_s1_would_you_say_you_have_close_relationships",max(case when linkid = 'f1.79.2' then answer_value_text end) as "ipc_s1_has_anything_changed_in_your_life_so_that_now_you_",max(case when linkid = 'f1.88.2' then answer_value_text end) as "ipc_s1_f1882",max(case when linkid = 'f1.89.2' then answer_value_text end) as "ipc_s1_select_the_possible_interpersonal_problem_areas_yo",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as "ipc_s1_your_most_distressing_current_symptoms_began",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as "ipc_s1_taskid_session_1_navigator",max(case when linkid = 'f1.40.2' then answer_value_text end) as "ipc_s1_f1402",max(case when linkid = 'f1.79.3' then answer_value_text end) as "ipc_s1_when_did_this_event_happen",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as "ipc_s1_is_there_anything_else_that_we_did_not_discuss_tha",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s1_taskid_session_2_navigator",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'f1.40.3' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or_",max(case when linkid = 'f1.43.2' then answer_value_text end) as "ipc_s1_tell_me_about_your_relationship_with_this_person_h",max(case when linkid = 'f1.69.3' then answer_value_text end) as "ipc_s1_when_did_this_disagreement_happen",max(case when linkid = 'f1.82.2' then answer_value_text end) as "ipc_s1_do_you_want_to_propose_an_interpersonal_formulatio",max(case when linkid = 'f1.87.2' then answer_value_text end) as "ipc_s1_do_you_agree_with_this",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as "ipc_s1_these_are_the_symptoms_you_said_you_are_currently_",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as "ipc_s1_taskid_mood_pdf",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as "ipc_s1_relationships_eg_talk_with_friends_or_vi",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as "ipc_s1_is_there_anything_that_could_get_in_the_way_of_you",max(case when linkid = 'f1.81.3' then answer_value_text end) as "ipc_s1_f1813",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_provider_pdf",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as "ipc_s1_work_on_my_relationship_with_my_parents_",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as "ipc_s1_f13931",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_client_pdf",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as "ipc_s1_of_these_symptoms_which_are_the_most_distressing",max(case when linkid = 'f1.81.4' then answer_value_text end) as "ipc_s1_f1814",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as "ipc_s1_earlier_than_that_you_noticed_symptoms",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as "ipc_s1_community_activities_eg_go_to_a_recreati",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as "ipc_s1_patient_name",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as "ipc_s1_f13932",max(case when linkid = 'f1.40.5' then answer_value_text end) as "ipc_s1_f1405",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as "ipc_s1_when_did_these_symptoms_begin",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as "ipc_s1_xxx",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "ipc_s1_yesterday_",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as "ipc_s1_patient_gender",max(case when linkid = 'f1.40.6' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__54",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as "ipc_s1_phq9_total",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as "ipc_s1_possible_problem_areas",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing_57",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as "ipc_s1_gad7_total",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as "ipc_s1_hobbies_eg_listen_to_music_play_video_ga",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as "ipc_s1_what_was_going_on_in_your_life_when_you_started_to",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s1_ptsd_total",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as "ipc_s1_zfgh",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as "ipc_s1_do_you_agree_with_this_summary",max(case when linkid = 'f1.40.8' then answer_value_text end) as "ipc_s1_f1408",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_mood_rating_session_1_score",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as "ipc_s1_what_about_before_that_was_there_a_time_before_in_",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as "ipc_s1_religionspirituality_eg_pray_or_go_to_se",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s1_mood_rating_total",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as "ipc_s1_person_1_is",max(case when linkid = 'f1.40.9' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__72",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as "ipc_s1_phq9_total_meaning",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as "ipc_s1_what_were_the_symptoms",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as "ipc_s1_with_my_pastor_",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as "ipc_s1_gad7_total_meaning",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as "ipc_s1_f13941",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as "ipc_s1_ptsd_total_meaning_toggle",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as "ipc_s1_when_did_you_notice_these_symptoms",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as "ipc_s1_other",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as "ipc_s1_mood_rating_comment",max(case when linkid = 'f1.38.4' then answer_value_text end) as "ipc_s1_f1384",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as "ipc_s1_f13942",max(case when linkid = 'f1.40.11' then answer_value_text end) as "ipc_s1_f14011",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as "ipc_s1_what_was_happening_then",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ipc_session_1",max(case when linkid = 'f1.40.12' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__87",max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as "ipc_s1_ex",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_89",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as "ipc_s1_person_2_is",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as "ipc_s1_f13951",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as "ipc_s1_f13952",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as "ipc_s1_gud",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_94",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as "ipc_s1_person_3_is",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as "ipc_s1_f13961",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as "ipc_s1_f13962",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_98",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as "ipc_s1_person_4_is",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as "seeing_someone_be_killed_or_seriously_injured",max(case when linkid = 'f1.38.3' then answer_value_text end) as "f1.38.3",max(case when linkid = 'f1.46.2' then answer_value_text end) as "f1.46.2",max(case when linkid = 'task-id-008' then answer_value_text end) as "task-id-008",max(case when linkid = 'task-id-009' then answer_value_text end) as "task-id-009",max(case when linkid = 'task-id-010' then answer_value_text end) as "task-id-010",max(case when linkid = 'task-id-012' then answer_value_text end) as "task-id-012"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:45.775273 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp" rename to "qr_spi_subform_4"
[0m09:25:45.778878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:25:45.779973 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:25:45.780195 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:25:45.780367 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:25:45.782486 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:25:45.785839 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:25:45.786349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m09:25:45.786612 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp" rename to "qr_start_ipc_s1"
[0m09:25:45.787969 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup"
[0m09:25:45.788418 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:25:45.788672 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup" cascade
[0m09:25:45.789391 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:45.790180 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: Close
[0m09:25:45.790426 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:45.790842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113470230>]}
[0m09:25:45.791576 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:25:45.792224 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:25:45.792030 [info ] [Thread-1 (]: 52 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [[32mCREATE VIEW[0m in 0.68s]
[0m09:25:45.792482 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:25:45.792745 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_spi_subform_4
[0m09:25:45.792968 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_start_ipc_s4
[0m09:25:45.793218 [info ] [Thread-1 (]: 56 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [RUN]
[0m09:25:45.793438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_4, now model.engage_analytics.qr_start_ipc_s4)
[0m09:25:45.793624 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:45.793784 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_start_ipc_s4
[0m09:25:45.795071 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup"
[0m09:25:45.797537 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:25:45.797970 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:25:45.798264 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:25:45.798708 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup" cascade
[0m09:25:45.798994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:45.799907 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:45.801228 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s1: Close
[0m09:25:45.801622 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11322a720>]}
[0m09:25:45.969565 [debug] [Thread-2 (]: An error was encountered while trying to send an event
[0m09:25:45.970147 [info ] [Thread-2 (]: 53 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [[32mCREATE VIEW[0m in 0.69s]
[0m09:25:45.970552 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_start_ipc_s1
[0m09:25:45.970805 [debug] [Thread-2 (]: Began running node model.engage_analytics.current_practitioner_role
[0m09:25:45.971036 [info ] [Thread-2 (]: 57 of 59 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m09:25:45.971319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_start_ipc_s1, now model.engage_analytics.current_practitioner_role)
[0m09:25:45.971496 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m09:25:45.972963 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m09:25:45.973463 [debug] [Thread-2 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m09:25:45.975264 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m09:25:45.975694 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:25:45.975868 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m09:25:45.976022 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:45.985346 [debug] [Thread-3 (]: SQL status: SELECT 91 in 0.627 seconds
[0m09:25:45.987281 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:25:45.987885 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_start_ipc_s2
[0m09:25:45.989800 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:25:45.990277 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:25:45.990455 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: BEGIN
[0m09:25:45.991003 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:45.991310 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:25:45.991494 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m09:25:45.992057 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 2 with readable column names
-- Questionnaire ID: 58
-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "ipc_s2_phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "ipc_s2_gad7_total_meaning",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s2_ptsd_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as "ipc_s2_phq9_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as "ipc_s2_summary_when_1",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as "ipc_s2_most_distressing_symptoms",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as "ipc_s2_selected_problem_area",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as "ipc_s2_ptsd_total_meaning_toggle",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as "ipc_s2_gad7_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s2_taskid_session_2_navigator",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as "ipc_s2_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s2_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s2_taskid_session_3_navigator",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as "ipc_s2_have_you_proposed_the_interpersonal_formulation_in",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_provider_pdf",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s2_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as "ipc_s2_a4a9cad504db44e59a9d0f1bf40ca840",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s2_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s2_747188c84fc043ea92b49baa32567f73",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as "ipc_s2_did_the_person_ever_hit_kick_push_or_slap_you",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as "ipc_s2_do_you_agree_with_this",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ipc_session_2",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s2_3d2ccf9a0e7b48a0854044d43b6dacfe",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area_28",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s2_6fb0c7a5a21143ecaf7b5f1079399133",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_mood_rating_session_1_score",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s2_did_you_ever_hit_kick_push_or_slap_the_person",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as "ipc_s2_do_you_still_think_that",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s2_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s2_232484cf1aee4bfaa66e61494587a16a",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s2_9ed77f2a0d5a434db153d8deadfbc3f8",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s2_3bfee97a6a0e4cd0bdb77ffa8d36191f",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree_37",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__39",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__40",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__41",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as "ipc_s2_287593c3417445afa99871d249230943",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s2_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s2_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s2_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s2_665e1595f16948159d24dac265f1809b",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s2_bc8f199a59f04184864db1c0befd26df",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s2_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s2_e17756cd48614dde859cf90241977246",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s2_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as "ipc_s2_is_any_of_the_2_question_above_is_true",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as "ipc_s2_2ef63cf4b37e4216a8e1db6d1b91cc2a",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s2_3e0b76f9090243bab8580b1505e9d168",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s2_9cc2834b0d2843d08811509995cfcdb8",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s2_a7f10195b8594670abbca2498c4fe45f",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__57",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s2_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s2_547a07c2f94c4956997f0439626d0251",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s2_6c1b2aa7f2444d5abfc6e0faef33bfe6",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s2_a77f07b379134708a35414e503a948f1",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s2_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s2_example_skills_63",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s2_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s2_eb8828db167447e7ba9ae3c161160b65",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s2_example_skills_66",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s2_4c95559d86ff4b87a271e52388072a53",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s2_bed17079d1e54bbeaf073d7b6a86243e",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__69",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__70",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__71",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s2_example_skills_72",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s2_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__77",max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__78",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__79",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = 'task-id-013' then answer_value_text end) as "task-id-013",max(case when linkid = 'task-id-014' then answer_value_text end) as "task-id-014",max(case when linkid = 'task-id-015' then answer_value_text end) as "task-id-015",max(case when linkid = 'task-id-016' then answer_value_text end) as "task-id-016",max(case when linkid = 'task-id-018' then answer_value_text end) as "task-id-018"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:45.992621 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:25:45.992889 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m09:25:45.994344 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:25:45.997213 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:25:45.997448 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" rename to "current_practitioner_role__dbt_backup"
[0m09:25:45.998110 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:25:45.998391 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:45.999917 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:25:46.001552 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:25:46.001787 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp" rename to "qr_start_ipc_s2"
[0m09:25:46.002005 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m09:25:46.002893 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:46.003637 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:25:46.003825 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:46.004019 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:25:46.004604 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:25:46.004787 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:25:46.004969 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:25:46.005158 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:25:46.006071 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:46.007308 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m09:25:46.007526 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:25:46.007814 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:25:46.009034 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup"
[0m09:25:46.009308 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m09:25:46.009648 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:25:46.009859 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup" cascade
[0m09:25:46.010408 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:46.011136 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: Close
[0m09:25:46.011310 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:25:46.012027 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: Close
[0m09:25:46.012330 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113240560>]}
[0m09:25:46.012564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113240d10>]}
[0m09:25:46.012891 [info ] [Thread-3 (]: 54 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [[32mCREATE VIEW[0m in 0.66s]
[0m09:25:46.013423 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_start_ipc_s2
[0m09:25:46.013620 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_registration_info_anon
[0m09:25:46.013134 [info ] [Thread-2 (]: 57 of 59 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.04s]
[0m09:25:46.013907 [info ] [Thread-3 (]: 58 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [RUN]
[0m09:25:46.014169 [debug] [Thread-2 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m09:25:46.014369 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_start_ipc_s2, now model.engage_analytics.qr_registration_info_anon)
[0m09:25:46.014748 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_registration_info_anon
[0m09:25:46.015018 [debug] [Thread-2 (]: Began running node model.engage_analytics.practitioners
[0m09:25:46.016865 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info_anon"
[0m09:25:46.017196 [info ] [Thread-2 (]: 59 of 59 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m09:25:46.017536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.practitioners)
[0m09:25:46.017713 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.practitioners
[0m09:25:46.019868 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.020087 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m09:25:46.020308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:25:46.020568 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_registration_info_anon
[0m09:25:46.022979 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info_anon"
[0m09:25:46.023820 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:25:46.024019 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info_anon: BEGIN
[0m09:25:46.024183 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:25:46.036954 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.017 seconds
[0m09:25:46.038023 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.038262 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m09:25:46.038925 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.000 seconds
[0m09:25:46.039824 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m09:25:46.040068 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m09:25:46.040285 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:25:46.040533 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized registration info with masked PII fields
-- Masks: Unique ID, Names, DOB, Phone, Email, Physical address, Zip code, Medicaid number

select 
    -- Non-PII identifiers (hashed for referential integrity)
    MD5(qr_id::text) as qr_id_hash,
    questionnaire_id,
    MD5(subject_patient_id::text) as subject_patient_id_hash,
    encounter_id,
    author_practitioner_id,
    
    -- Location and organization references (non-PII)
    practitioner_location_id,
    practitioner_organization_id,
    practitioner_id,
    practitioner_careteam_id,
    
    -- Application metadata
    application_version,
    
    -- Masked PII fields
    'REDACTED' as registration_unique_id_masked,
    'REDACTED' as registration_first_name_masked,
    'REDACTED' as registration_middle_name_masked,
    'REDACTED' as registration_surname_masked,
    
    -- Age fields (keep age, mask DOB)
    registration_age,
    registration_age_6,
    registration_calculated_age,
    'REDACTED' as registration_date_of_birth_dob_masked,
    
    -- Masked contact information
    'REDACTED' as "email-address_masked",
    CASE 
        WHEN "phone-number" IS NOT NULL 
        THEN 'XXX-XXX-' || RIGHT("phone-number", 4)
        ELSE NULL
    END as "phone-number_masked",
    'REDACTED' as "physical-address_masked",
    CASE 
        WHEN "zip-code" IS NOT NULL 
        THEN LEFT("zip-code", 3) || 'XX'
        ELSE NULL
    END as "zip-code_masked",
    
    -- Masked Medicaid information
    CASE 
        WHEN "do-you-have-medicaid" = 'Yes' 
        THEN 'Yes'
        ELSE "do-you-have-medicaid"
    END as "do-you-have-medicaid",
    'REDACTED' as "medicaid-number_masked",
    
    -- Non-PII demographic fields
    registration_which_of_the_following_best_represents_how_you_thi,
    registration_what_was_your_biological_sex_assigned_at_birth,
    "choice-gender-identity",
    "choice-pronouns",
    other_best_represents_how_you_think_of_yourself,
    
    -- Service history (non-PII)
    registration_has_this_person_received_engage_services_in_the_pa,
    
    -- Date components (non-specific)
    registration_calculated_month,
    registration_calculated_year,
    
    -- Metadata
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info"
  );
[0m09:25:46.041020 [debug] [Thread-2 (]: Began executing node model.engage_analytics.practitioners
[0m09:25:46.044349 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.044633 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "other_best_represents_how_you_think_of_yourself" does not exist
LINE 68:     other_best_represents_how_you_think_of_yourself,
             ^

[0m09:25:46.044867 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    
  
    

  create temporary table "practitioners__dbt_tmp092546042396"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

where p._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
)

  );
  
  
[0m09:25:46.045094 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info_anon: ROLLBACK
[0m09:25:46.045845 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info_anon: Close
[0m09:25:46.047244 [debug] [Thread-3 (]: Database Error in model qr_registration_info_anon (models/marts/qr_named/qr_registration_info_anon.sql)
  column "other_best_represents_how_you_think_of_yourself" does not exist
  LINE 68:     other_best_represents_how_you_think_of_yourself,
               ^
  compiled code at target/run/engage_analytics/models/marts/qr_named/qr_registration_info_anon.sql
[0m09:25:46.047500 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.002 seconds
[0m09:25:46.047823 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135629f0>]}
[0m09:25:46.049469 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.049849 [error] [Thread-3 (]: 58 of 59 ERROR creating sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [[31mERROR[0m in 0.03s]
[0m09:25:46.050088 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: BEGIN
[0m09:25:46.050403 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_registration_info_anon
[0m09:25:46.050748 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_registration_info_anon' to be skipped because of status 'error'.  Reason: Database Error in model qr_registration_info_anon (models/marts/qr_named/qr_registration_info_anon.sql)
  column "other_best_represents_how_you_think_of_yourself" does not exist
  LINE 68:     other_best_represents_how_you_think_of_yourself,
               ^
  compiled code at target/run/engage_analytics/models/marts/qr_named/qr_registration_info_anon.sql.
[0m09:25:46.051076 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:46.051268 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.051444 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioners__dbt_tmp092546042396'
        
      order by ordinal_position

  
[0m09:25:46.055078 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.003 seconds
[0m09:25:46.056804 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.057013 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:46.059244 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:25:46.061078 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.061288 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:25:46.063270 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:25:46.064376 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m09:25:46.064892 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.065088 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioners__dbt_tmp092546042396" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" ("id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role")
    (
        select "id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role"
        from "practitioners__dbt_tmp092546042396"
    )
  
[0m09:25:46.066254 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:25:46.067217 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:25:46.067452 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:25:46.067625 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:25:46.068815 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:46.069314 [debug] [Thread-2 (]: On model.engage_analytics.practitioners: Close
[0m09:25:46.069613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134da4e0>]}
[0m09:25:46.069930 [info ] [Thread-2 (]: 59 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mINSERT 0 0[0m in 0.05s]
[0m09:25:46.070230 [debug] [Thread-2 (]: Finished running node model.engage_analytics.practitioners
[0m09:25:46.379682 [debug] [Thread-4 (]: SQL status: SELECT 97 in 0.610 seconds
[0m09:25:46.384354 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:25:46.385038 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_start_ipc_s3
[0m09:25:46.386904 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:25:46.387688 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:25:46.387969 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: BEGIN
[0m09:25:46.388727 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:25:46.388999 [debug] [Thread-1 (]: SQL status: SELECT 42 in 0.590 seconds
[0m09:25:46.389232 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:25:46.390395 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:25:46.390986 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 3 with readable column names
-- Questionnaire ID: 208
-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as "ipc_s3_phq9_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as "ipc_s3_gad7_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as "ipc_s3_ptsd_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as "ipc_s3_ptsd_total_meaning",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s3_taskid_session_3_navigator",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s3_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s3_taskid_session_4_navigator",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as "ipc_s3_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s3_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_provider_pdf",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s3_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ipc_session_3",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_16",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s3_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_18",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s3_observation_id_of_mood_rating_session_3_score",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as "ipc_s3_1b59ddeb483d4b1baf53f3942204589a",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s3_did_you_ever_hit_kick_push_or_slap_the_personno",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s3_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_23",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as "ipc_s3_4554f4b2d15e47e7a10dd77939dd3afc",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_25",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as "ipc_s3_f9a9f4928eb84c718ec6f80ab596430b",max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__28",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__29",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__30",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s3_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as "ipc_s3_59744d4501004d62b1055cbecd973ffd",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as "ipc_s3_6b5fa4342fc34e4bad1189f6260a81f2",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as "ipc_s3_77fc70ba6cac494cb27a77ebce2289e5",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s3_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s3_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as "ipc_s3_has_anything_changed_since_the_last_time_we_met",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s3_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_40",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as "ipc_s3_4ad7384fa3324e4193180d3f9e540ee7",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as "ipc_s3_stage_identified_in_session_2",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_43",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_44",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_45",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as "ipc_s3_b24118e231c54e23af3a1722af72c299",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as "ipc_s3_68b3cbf5b9ef4da49ac1bcbc20f04473",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as "ipc_s3_9e995f48b09249b2a9e4c7e754e446e5",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__49",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s3_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as "ipc_s3_e8b8e5504d6542beacb92f4ac17c7f49",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s3_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s3_example_skills_53",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s3_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s3_example_skills_55",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_56",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_57",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_58",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s3_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_60",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as "ipc_s3_920de190557a423391a34bf293f18214",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as "ipc_s3_95121ef1bfe540ce841c524334644148",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as "ipc_s3_e1a13d53b867440f8622bccebf54f176",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s3_547a07c2f94c4956997f0439626d0251",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as "ipc_s3_8ac792f53f3c49d3a80063c662bf00cd",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__66",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__67",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__68",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s3_a77f07b379134708a35414e503a948f1",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s3_example_skills_70",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_71",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s3_4c95559d86ff4b87a271e52388072a53",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__73",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_77",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as "ipc_s3_8c82f7573f404b09bdf478ee376f75a8",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s3_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__82",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__83",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "gad7_total_meaning",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person_91",max(case when linkid = 'task-id-019' then answer_value_text end) as "task-id-019",max(case when linkid = 'task-id-020' then answer_value_text end) as "task-id-020",max(case when linkid = 'task-id-021' then answer_value_text end) as "task-id-021",max(case when linkid = 'task-id-022' then answer_value_text end) as "task-id-022",max(case when linkid = 'task-id-023' then answer_value_text end) as "task-id-023",max(case when linkid = 'task-id-024' then answer_value_text end) as "task-id-024"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:46.391839 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_start_ipc_s4
[0m09:25:46.393704 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:25:46.394188 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:25:46.394362 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s4: BEGIN
[0m09:25:46.395002 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:25:46.395221 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:25:46.395574 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 4 with readable column names
-- Questionnaire ID: 63
-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as "ipc_s4_phq9_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as "ipc_s4_gad7_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as "ipc_s4_ptsd_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s4_taskid_session_4_navigator",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_provider_pdf",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as "ipc_s4_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_client_pdf",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as "ipc_s4_what_we_know_is_that_symptoms_can_come_back_in_the",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s4_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as "ipc_s4_after_todays_session_i_can_refer_you_for_clinical_",max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as "ipc_s4_after_todays_session_i_will_be_referring_you_for_a",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri_14",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as "ipc_s4_how_does_it_make_you_feel_to_know_that_today_is_ou",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as "ipc_s4_how_do_you_feel_about_today_being_our_last_session",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as "ipc_s4_how_would_you_know_if_your_symptoms_are_coming_bac",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that_",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as "ipc_s4_please_select_how_you_would_like_to_proceed_with_t",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that__21",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s_22",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y_23",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s4_mood_rating_total",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as "ipc_s4_i_am_going_to_provide_you_with_our_agencys_contact",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard_28",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that_",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that__30",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as "ipc_s4_7fef53bc56db47ce8cba8efd4bcbc318",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "did_you_discuss_this_clients_severe_mental_health_screening",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "what_is_the_recommended_plan_to_address_the_probable_severe",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as "feeling_changed",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "referral_details_if_the_client_is_referred_out",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as "rerer",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as "20241031",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as "20250201",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as "is-connected-to-clinical-care-details",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as "is-connected-to-clinical-care-question"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:25:46.397133 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:25:46.398717 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:25:46.398922 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp" rename to "qr_start_ipc_s3"
[0m09:25:46.399186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:25:46.400734 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:25:46.400958 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:25:46.401170 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp" rename to "qr_start_ipc_s4"
[0m09:25:46.401809 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:25:46.402014 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:25:46.402180 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:25:46.402862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:25:46.403036 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:46.403610 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:25:46.404700 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup"
[0m09:25:46.404931 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:25:46.405185 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:25:46.405360 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:25:46.405529 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup" cascade
[0m09:25:46.406031 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:46.406649 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: Close
[0m09:25:46.406832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:25:46.407107 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b88c0>]}
[0m09:25:46.409076 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup"
[0m09:25:46.409487 [info ] [Thread-4 (]: 55 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:25:46.409831 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:25:46.410088 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_start_ipc_s3
[0m09:25:46.410317 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup" cascade
[0m09:25:46.410981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:25:46.411629 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s4: Close
[0m09:25:46.411884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de1ab49-1f52-48b0-99d5-8672a092bd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132448f0>]}
[0m09:25:46.412162 [info ] [Thread-1 (]: 56 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [[32mCREATE VIEW[0m in 0.62s]
[0m09:25:46.412486 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_start_ipc_s4
[0m09:25:46.413218 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:46.413377 [debug] [MainThread]: On master: BEGIN
[0m09:25:46.413508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:25:46.427750 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:25:46.428062 [debug] [MainThread]: On master: COMMIT
[0m09:25:46.428222 [debug] [MainThread]: Using postgres connection "master"
[0m09:25:46.428360 [debug] [MainThread]: On master: COMMIT
[0m09:25:46.428846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:25:46.429082 [debug] [MainThread]: On master: Close
[0m09:25:46.429337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:46.429483 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s4' was properly closed.
[0m09:25:46.429609 [debug] [MainThread]: Connection 'model.engage_analytics.practitioners' was properly closed.
[0m09:25:46.429727 [debug] [MainThread]: Connection 'model.engage_analytics.qr_registration_info_anon' was properly closed.
[0m09:25:46.429842 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s3' was properly closed.
[0m09:25:46.430110 [info ] [MainThread]: 
[0m09:25:46.430399 [info ] [MainThread]: Finished running 18 incremental models, 41 view models in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m09:25:46.433730 [debug] [MainThread]: Command end result
[0m09:25:46.459398 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:25:46.460801 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:25:46.467467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:25:46.467689 [info ] [MainThread]: 
[0m09:25:46.467897 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:25:46.468070 [info ] [MainThread]: 
[0m09:25:46.468274 [error] [MainThread]: [31mFailure in model patient_anon (models/marts/patient_anon.sql)[0m
[0m09:25:46.468475 [error] [MainThread]:   Database Error in model patient_anon (models/marts/patient_anon.sql)
  column p.age_years does not exist
  LINE 18:     p.age_years,  -- Age instead of birth_date for privacy
               ^
  compiled code at target/run/engage_analytics/models/marts/patient_anon.sql
[0m09:25:46.468622 [info ] [MainThread]: 
[0m09:25:46.468796 [info ] [MainThread]:   compiled code at target/compiled/engage_analytics/models/marts/patient_anon.sql
[0m09:25:46.468958 [info ] [MainThread]: 
[0m09:25:46.469132 [error] [MainThread]: [31mFailure in model qr_registration_info_anon (models/marts/qr_named/qr_registration_info_anon.sql)[0m
[0m09:25:46.469315 [error] [MainThread]:   Database Error in model qr_registration_info_anon (models/marts/qr_named/qr_registration_info_anon.sql)
  column "other_best_represents_how_you_think_of_yourself" does not exist
  LINE 68:     other_best_represents_how_you_think_of_yourself,
               ^
  compiled code at target/run/engage_analytics/models/marts/qr_named/qr_registration_info_anon.sql
[0m09:25:46.469460 [info ] [MainThread]: 
[0m09:25:46.469627 [info ] [MainThread]:   compiled code at target/compiled/engage_analytics/models/marts/qr_named/qr_registration_info_anon.sql
[0m09:25:46.469785 [info ] [MainThread]: 
[0m09:25:46.469951 [info ] [MainThread]: Done. PASS=57 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=59
[0m09:25:46.470330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.733714, "process_in_blocks": "0", "process_kernel_time": 0.408263, "process_mem_max_rss": "146964480", "process_out_blocks": "0", "process_user_time": 2.723965}
[0m09:25:46.470575 [debug] [MainThread]: Command `dbt run` failed at 09:25:46.470533 after 7.73 seconds
[0m09:25:46.470841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e21160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e21190>]}
[0m09:25:46.471084 [debug] [MainThread]: Flushing usage events
[0m09:25:46.585225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:26:49.523448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919d280>]}


============================== 09:26:49.527554 | da484239-7bb1-4d66-922d-09f63cbf0ecf ==============================
[0m09:26:49.527554 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:26:49.527903 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select patient', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:26:49.531387 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m09:26:49.531909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.055960417, "process_in_blocks": "0", "process_kernel_time": 0.137097, "process_mem_max_rss": "106266624", "process_out_blocks": "0", "process_user_time": 0.728111}
[0m09:26:49.532292 [debug] [MainThread]: Command `dbt run` failed at 09:26:49.532190 after 0.06 seconds
[0m09:26:49.532556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109079b50>]}
[0m09:26:49.532814 [debug] [MainThread]: Flushing usage events
[0m09:26:49.696043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:04.453314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103215fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e09580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e09280>]}


============================== 09:27:04.457069 | c453511f-1a40-44f6-8820-9a45aebd11e9 ==============================
[0m09:27:04.457069 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:27:04.457402 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select patient', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:27:04.562065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c453511f-1a40-44f6-8820-9a45aebd11e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738ce90>]}
[0m09:27:04.593388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c453511f-1a40-44f6-8820-9a45aebd11e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ec3b0>]}
[0m09:27:04.594199 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:27:04.646661 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:27:04.741667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:27:04.741953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:27:04.763634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c453511f-1a40-44f6-8820-9a45aebd11e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074753a0>]}
[0m09:27:04.820022 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:27:04.821948 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:27:04.890769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c453511f-1a40-44f6-8820-9a45aebd11e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d15490>]}
[0m09:27:04.891141 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:27:04.891343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c453511f-1a40-44f6-8820-9a45aebd11e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af27e0>]}
[0m09:27:04.892671 [info ] [MainThread]: 
[0m09:27:04.892855 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:27:04.892990 [info ] [MainThread]: 
[0m09:27:04.896206 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:27:04.902484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:27:04.934714 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:27:04.935038 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:27:04.935207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:04.984476 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.049 seconds
[0m09:27:04.985368 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:27:04.989299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m09:27:04.989706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m09:27:04.992860 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:27:04.993228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m09:27:04.994329 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:27:04.994513 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:27:04.995374 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:27:04.995541 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:27:04.995679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:04.995810 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:27:04.995938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:04.996164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:05.019576 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m09:27:05.019881 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m09:27:05.020102 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:27:05.020304 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m09:27:05.020493 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:27:05.020670 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:27:05.020831 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:27:05.020983 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:27:05.021193 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:27:05.023787 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m09:27:05.024038 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m09:27:05.024775 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:27:05.024932 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.004 seconds
[0m09:27:05.025517 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:27:05.026390 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:27:05.026619 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:27:05.027300 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:27:05.029543 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:27:05.033642 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:05.033839 [debug] [MainThread]: On master: BEGIN
[0m09:27:05.033972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:05.051078 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m09:27:05.051351 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:05.051553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:27:05.054455 [debug] [MainThread]: SQL status: SELECT 109 in 0.003 seconds
[0m09:27:05.061957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c453511f-1a40-44f6-8820-9a45aebd11e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033de0f0>]}
[0m09:27:05.062186 [debug] [MainThread]: On master: ROLLBACK
[0m09:27:05.063487 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:05.063749 [debug] [MainThread]: On master: BEGIN
[0m09:27:05.065034 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:27:05.065187 [debug] [MainThread]: On master: COMMIT
[0m09:27:05.065327 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:05.065464 [debug] [MainThread]: On master: COMMIT
[0m09:27:05.066121 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:27:05.066292 [debug] [MainThread]: On master: Close
[0m09:27:05.068002 [debug] [Thread-1 (]: Began running node model.engage_analytics.patient
[0m09:27:05.068321 [info ] [Thread-1 (]: 1 of 1 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m09:27:05.068569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.patient)
[0m09:27:05.068754 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.patient
[0m09:27:05.081682 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m09:27:05.082236 [debug] [Thread-1 (]: Began executing node model.engage_analytics.patient
[0m09:27:05.107705 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:05.107997 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp092705096008"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    DATE_PART('year', AGE(stp.birthDate::date))::integer as age_years,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m09:27:05.108259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:05.138133 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.030 seconds
[0m09:27:05.144909 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:05.145163 [debug] [Thread-1 (]: On model.engage_analytics.patient: BEGIN
[0m09:27:05.146127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:27:05.146394 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:05.146576 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp092705096008'
        
      order by ordinal_position

  
[0m09:27:05.153172 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.006 seconds
[0m09:27:05.155957 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:05.156175 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:27:05.158480 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:27:05.162584 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:05.162822 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:27:05.164929 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:27:05.171830 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m09:27:05.172295 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:05.172489 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp092705096008" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp092705096008"
    )
  
[0m09:27:05.173733 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:27:05.181270 [debug] [Thread-1 (]: On model.engage_analytics.patient: COMMIT
[0m09:27:05.181526 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:05.181684 [debug] [Thread-1 (]: On model.engage_analytics.patient: COMMIT
[0m09:27:05.182917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:27:05.183998 [debug] [Thread-1 (]: On model.engage_analytics.patient: Close
[0m09:27:05.185201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c453511f-1a40-44f6-8820-9a45aebd11e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba7290>]}
[0m09:27:05.185688 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.12s]
[0m09:27:05.186016 [debug] [Thread-1 (]: Finished running node model.engage_analytics.patient
[0m09:27:05.186860 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:05.187080 [debug] [MainThread]: On master: BEGIN
[0m09:27:05.187226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:27:05.200972 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:27:05.201255 [debug] [MainThread]: On master: COMMIT
[0m09:27:05.201410 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:05.201544 [debug] [MainThread]: On master: COMMIT
[0m09:27:05.201943 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:27:05.202133 [debug] [MainThread]: On master: Close
[0m09:27:05.202369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:05.202517 [debug] [MainThread]: Connection 'model.engage_analytics.patient' was properly closed.
[0m09:27:05.202652 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_stg' was properly closed.
[0m09:27:05.202775 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_mart' was properly closed.
[0m09:27:05.202928 [info ] [MainThread]: 
[0m09:27:05.203087 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m09:27:05.203420 [debug] [MainThread]: Command end result
[0m09:27:05.260689 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:27:05.262057 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:27:05.265507 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:27:05.265680 [info ] [MainThread]: 
[0m09:27:05.265870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:05.266012 [info ] [MainThread]: 
[0m09:27:05.266162 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:27:05.266445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.850529, "process_in_blocks": "0", "process_kernel_time": 0.214078, "process_mem_max_rss": "135577600", "process_out_blocks": "0", "process_user_time": 1.199954}
[0m09:27:05.266653 [debug] [MainThread]: Command `dbt run` succeeded at 09:27:05.266615 after 0.85 seconds
[0m09:27:05.266825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032fefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032feff0>]}
[0m09:27:05.266996 [debug] [MainThread]: Flushing usage events
[0m09:27:05.433778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:34.532796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102096780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105865580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058652b0>]}


============================== 09:27:34.536827 | c73f9acf-9d0e-4587-b6bb-b3553d6d46ad ==============================
[0m09:27:34.536827 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:27:34.537177 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select patient_anon qr_registration_info_anon', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:27:34.638318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c73f9acf-9d0e-4587-b6bb-b3553d6d46ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058941d0>]}
[0m09:27:34.669618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c73f9acf-9d0e-4587-b6bb-b3553d6d46ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef1970>]}
[0m09:27:34.671151 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:27:34.725295 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:27:34.822094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:27:34.822603 [debug] [MainThread]: Partial parsing: updated file: engage_analytics://models/marts/qr_named/qr_registration_info_anon.sql
[0m09:27:34.952873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c73f9acf-9d0e-4587-b6bb-b3553d6d46ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf6810>]}
[0m09:27:35.001531 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:27:35.003230 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:27:35.017069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c73f9acf-9d0e-4587-b6bb-b3553d6d46ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673fd40>]}
[0m09:27:35.017462 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:27:35.017658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c73f9acf-9d0e-4587-b6bb-b3553d6d46ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105894950>]}
[0m09:27:35.019073 [info ] [MainThread]: 
[0m09:27:35.019261 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:27:35.019402 [info ] [MainThread]: 
[0m09:27:35.019660 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:27:35.021564 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:27:35.080917 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:27:35.081184 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:27:35.081326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:35.127790 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.046 seconds
[0m09:27:35.128857 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:27:35.131238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m09:27:35.134573 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:27:35.134923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m09:27:35.135167 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:27:35.135473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m09:27:35.136717 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:27:35.136927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:35.137778 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:27:35.137935 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:27:35.138190 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:27:35.138344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:35.138487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:35.175482 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m09:27:35.175805 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m09:27:35.176078 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:27:35.176316 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m09:27:35.176592 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:27:35.176834 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:27:35.177091 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:27:35.177312 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:27:35.177613 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:27:35.179444 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m09:27:35.180250 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:27:35.180456 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.003 seconds
[0m09:27:35.180678 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m09:27:35.181789 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:27:35.181968 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:27:35.182614 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:27:35.183303 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:27:35.183536 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:27:35.190177 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:35.190373 [debug] [MainThread]: On master: BEGIN
[0m09:27:35.190506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:35.208135 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:27:35.208375 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:35.208550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:27:35.211890 [debug] [MainThread]: SQL status: SELECT 109 in 0.003 seconds
[0m09:27:35.219384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c73f9acf-9d0e-4587-b6bb-b3553d6d46ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788abd0>]}
[0m09:27:35.219667 [debug] [MainThread]: On master: ROLLBACK
[0m09:27:35.220792 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:35.221066 [debug] [MainThread]: On master: BEGIN
[0m09:27:35.223049 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:27:35.223199 [debug] [MainThread]: On master: COMMIT
[0m09:27:35.223342 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:35.223467 [debug] [MainThread]: On master: COMMIT
[0m09:27:35.224369 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:27:35.224577 [debug] [MainThread]: On master: Close
[0m09:27:35.227158 [debug] [Thread-1 (]: Began running node model.engage_analytics.patient_anon
[0m09:27:35.227397 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_registration_info_anon
[0m09:27:35.227656 [info ] [Thread-1 (]: 1 of 2 START sql view model engage_analytics_engage_analytics_mart.patient_anon  [RUN]
[0m09:27:35.227897 [info ] [Thread-2 (]: 2 of 2 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [RUN]
[0m09:27:35.228163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.patient_anon)
[0m09:27:35.228413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.qr_registration_info_anon)
[0m09:27:35.228605 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.patient_anon
[0m09:27:35.228772 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_registration_info_anon
[0m09:27:35.232473 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.patient_anon"
[0m09:27:35.234002 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info_anon"
[0m09:27:35.234473 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_registration_info_anon
[0m09:27:35.241019 [debug] [Thread-1 (]: Began executing node model.engage_analytics.patient_anon
[0m09:27:35.254675 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info_anon"
[0m09:27:35.256506 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.patient_anon"
[0m09:27:35.257126 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:27:35.257322 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: BEGIN
[0m09:27:35.257496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:35.257710 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:27:35.258007 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: BEGIN
[0m09:27:35.258176 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:27:35.282454 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m09:27:35.282752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m09:27:35.282958 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:27:35.283137 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:27:35.283368 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized registration info with masked PII fields
-- Masks: Unique ID, Names, DOB, Phone, Email, Physical address, Zip code, Medicaid number

select 
    -- Non-PII identifiers (hashed for referential integrity)
    MD5(qr_id::text) as qr_id_hash,
    questionnaire_id,
    MD5(subject_patient_id::text) as subject_patient_id_hash,
    encounter_id,
    author_practitioner_id,
    
    -- Location and organization references (non-PII)
    practitioner_location_id,
    practitioner_organization_id,
    practitioner_id,
    practitioner_careteam_id,
    
    -- Application metadata
    application_version,
    
    -- Masked PII fields
    'REDACTED' as registration_unique_id_masked,
    'REDACTED' as registration_first_name_masked,
    'REDACTED' as registration_middle_name_masked,
    'REDACTED' as registration_surname_masked,
    
    -- Age fields (keep age, mask DOB)
    registration_age,
    registration_age_6,
    registration_calculated_age,
    'REDACTED' as registration_date_of_birth_dob_masked,
    
    -- Masked contact information
    'REDACTED' as "email-address_masked",
    CASE 
        WHEN "phone-number" IS NOT NULL 
        THEN 'XXX-XXX-' || RIGHT("phone-number", 4)
        ELSE NULL
    END as "phone-number_masked",
    'REDACTED' as "physical-address_masked",
    CASE 
        WHEN "zip-code" IS NOT NULL 
        THEN LEFT("zip-code", 3) || 'XX'
        ELSE NULL
    END as "zip-code_masked",
    
    -- Masked Medicaid information
    CASE 
        WHEN "do-you-have-medicaid" = 'Yes' 
        THEN 'Yes'
        ELSE "do-you-have-medicaid"
    END as "do-you-have-medicaid",
    'REDACTED' as "medicaid-number_masked",
    
    -- Non-PII demographic fields
    registration_which_of_the_following_best_represents_how_you_thi,
    registration_what_was_your_biological_sex_assigned_at_birth,
    "choice-gender-identity",
    "choice-pronouns",
    "other-best-represents-how-you-think-of-yourself",
    
    -- Service history (non-PII)
    registration_has_this_person_received_engage_services_in_the_pa,
    
    -- Date components (non-specific)
    registration_calculated_month,
    registration_calculated_year,
    
    -- Metadata
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info"
  );
[0m09:27:35.283615 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized patient view with masked PII fields for data sharing
-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number

select 
    -- Use hashed ID for referential integrity while maintaining privacy
    MD5(p.id::text) as patient_id_hash,
    
    -- Demographic information (non-PII)
    p.gender,
    p.age_years,  -- Age instead of birth_date for privacy
    p.deceased,
    p.active,
    p.registration_date,
    
    -- Masked name fields
    'REDACTED' as name_family_masked,
    'REDACTED' as name_given_masked,
    
    -- Masked contact information
    'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, 'XXXX'), 4) as phone_number_masked,
    
    -- Location and organization (reference IDs only, no PII)
    p.location_id,
    p.practitioner_id,
    p.practitioner_organization_id,
    p.practitioner_careteam_id,
    
    -- Metadata
    p._airbyte_emitted_at,
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."patient" p
  );
[0m09:27:35.284551 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column p.age_years does not exist
LINE 18:     p.age_years,  -- Age instead of birth_date for privacy
             ^

[0m09:27:35.284834 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: ROLLBACK
[0m09:27:35.285930 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: Close
[0m09:27:35.286185 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:27:35.289616 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:27:35.290642 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp" rename to "qr_registration_info_anon"
[0m09:27:35.291694 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:27:35.298289 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:27:35.298589 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:27:35.298809 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:27:35.301116 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:27:35.304770 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup"
[0m09:27:35.307137 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:27:35.307377 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup" cascade
[0m09:27:35.308803 [debug] [Thread-1 (]: Database Error in model patient_anon (models/marts/patient_anon.sql)
  column p.age_years does not exist
  LINE 18:     p.age_years,  -- Age instead of birth_date for privacy
               ^
  compiled code at target/run/engage_analytics/models/marts/patient_anon.sql
[0m09:27:35.309039 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:27:35.311236 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: Close
[0m09:27:35.311852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c73f9acf-9d0e-4587-b6bb-b3553d6d46ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6f680>]}
[0m09:27:35.312043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c73f9acf-9d0e-4587-b6bb-b3553d6d46ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105822c60>]}
[0m09:27:35.312388 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model engage_analytics_engage_analytics_mart.patient_anon  [[31mERROR[0m in 0.08s]
[0m09:27:35.312965 [debug] [Thread-1 (]: Finished running node model.engage_analytics.patient_anon
[0m09:27:35.312660 [info ] [Thread-2 (]: 2 of 2 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [[32mCREATE VIEW[0m in 0.08s]
[0m09:27:35.313265 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.patient_anon' to be skipped because of status 'error'.  Reason: Database Error in model patient_anon (models/marts/patient_anon.sql)
  column p.age_years does not exist
  LINE 18:     p.age_years,  -- Age instead of birth_date for privacy
               ^
  compiled code at target/run/engage_analytics/models/marts/patient_anon.sql.
[0m09:27:35.313533 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_registration_info_anon
[0m09:27:35.314460 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:35.314636 [debug] [MainThread]: On master: BEGIN
[0m09:27:35.314770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:27:35.332816 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:27:35.333070 [debug] [MainThread]: On master: COMMIT
[0m09:27:35.333224 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:35.333360 [debug] [MainThread]: On master: COMMIT
[0m09:27:35.333863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:27:35.334050 [debug] [MainThread]: On master: Close
[0m09:27:35.334285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:35.334427 [debug] [MainThread]: Connection 'model.engage_analytics.patient_anon' was properly closed.
[0m09:27:35.334546 [debug] [MainThread]: Connection 'model.engage_analytics.qr_registration_info_anon' was properly closed.
[0m09:27:35.334660 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_mart' was properly closed.
[0m09:27:35.334831 [info ] [MainThread]: 
[0m09:27:35.334981 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m09:27:35.335346 [debug] [MainThread]: Command end result
[0m09:27:35.356698 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:27:35.358117 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:27:35.361559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:27:35.361805 [info ] [MainThread]: 
[0m09:27:35.361995 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:27:35.362149 [info ] [MainThread]: 
[0m09:27:35.362335 [error] [MainThread]: [31mFailure in model patient_anon (models/marts/patient_anon.sql)[0m
[0m09:27:35.362513 [error] [MainThread]:   Database Error in model patient_anon (models/marts/patient_anon.sql)
  column p.age_years does not exist
  LINE 18:     p.age_years,  -- Age instead of birth_date for privacy
               ^
  compiled code at target/run/engage_analytics/models/marts/patient_anon.sql
[0m09:27:35.362646 [info ] [MainThread]: 
[0m09:27:35.362802 [info ] [MainThread]:   compiled code at target/compiled/engage_analytics/models/marts/patient_anon.sql
[0m09:27:35.362936 [info ] [MainThread]: 
[0m09:27:35.363083 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m09:27:35.363403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.86769974, "process_in_blocks": "0", "process_kernel_time": 0.224363, "process_mem_max_rss": "137986048", "process_out_blocks": "0", "process_user_time": 1.284185}
[0m09:27:35.363660 [debug] [MainThread]: Command `dbt run` failed at 09:27:35.363622 after 0.87 seconds
[0m09:27:35.363838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b715e0>]}
[0m09:27:35.364007 [debug] [MainThread]: Flushing usage events
[0m09:27:35.482152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:52.718186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069895e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069891f0>]}


============================== 09:27:52.722103 | 1ea772e2-264e-4806-9f5c-aed6bc649f8b ==============================
[0m09:27:52.722103 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:27:52.722476 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select patient --full-refresh', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:27:52.823927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ea772e2-264e-4806-9f5c-aed6bc649f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a53f20>]}
[0m09:27:52.854366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ea772e2-264e-4806-9f5c-aed6bc649f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b8800>]}
[0m09:27:52.855451 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:27:52.910462 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:27:53.004036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:27:53.004334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:27:53.026488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ea772e2-264e-4806-9f5c-aed6bc649f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107857f20>]}
[0m09:27:53.075584 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:27:53.077478 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:27:53.091155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ea772e2-264e-4806-9f5c-aed6bc649f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077268d0>]}
[0m09:27:53.091430 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:27:53.091607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ea772e2-264e-4806-9f5c-aed6bc649f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107681f70>]}
[0m09:27:53.092707 [info ] [MainThread]: 
[0m09:27:53.092893 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:27:53.093023 [info ] [MainThread]: 
[0m09:27:53.093264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:27:53.093773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:27:53.122204 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:27:53.122476 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:27:53.122642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:53.170641 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.048 seconds
[0m09:27:53.171720 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:27:53.175558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m09:27:53.175920 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m09:27:53.176157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_int'
[0m09:27:53.179293 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:27:53.180434 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:27:53.181534 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:27:53.181775 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:27:53.181988 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:27:53.182191 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:27:53.182347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:53.182489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:53.182619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:53.211378 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m09:27:53.211718 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m09:27:53.211979 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m09:27:53.212184 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:27:53.212420 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:27:53.212609 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:27:53.212783 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:27:53.212957 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:27:53.213133 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:27:53.215313 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m09:27:53.215552 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m09:27:53.216387 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:27:53.216556 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.003 seconds
[0m09:27:53.217135 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:27:53.218081 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:27:53.218371 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:27:53.219539 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:27:53.219770 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:27:53.225803 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:53.226050 [debug] [MainThread]: On master: BEGIN
[0m09:27:53.226185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:53.241271 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:27:53.241563 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:53.241763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:27:53.244711 [debug] [MainThread]: SQL status: SELECT 110 in 0.003 seconds
[0m09:27:53.253621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ea772e2-264e-4806-9f5c-aed6bc649f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdd2b0>]}
[0m09:27:53.253970 [debug] [MainThread]: On master: ROLLBACK
[0m09:27:53.254756 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:53.254923 [debug] [MainThread]: On master: BEGIN
[0m09:27:53.255795 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:27:53.256053 [debug] [MainThread]: On master: COMMIT
[0m09:27:53.256207 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:53.256340 [debug] [MainThread]: On master: COMMIT
[0m09:27:53.256805 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:27:53.256966 [debug] [MainThread]: On master: Close
[0m09:27:53.260222 [debug] [Thread-1 (]: Began running node model.engage_analytics.patient
[0m09:27:53.260600 [info ] [Thread-1 (]: 1 of 1 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m09:27:53.260847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.patient)
[0m09:27:53.261025 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.patient
[0m09:27:53.273691 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m09:27:53.274297 [debug] [Thread-1 (]: Began executing node model.engage_analytics.patient
[0m09:27:53.300259 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m09:27:53.300842 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:53.301036 [debug] [Thread-1 (]: On model.engage_analytics.patient: BEGIN
[0m09:27:53.301197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:53.320679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m09:27:53.320981 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:53.321230 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_mart"."patient__dbt_tmp"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    DATE_PART('year', AGE(stp.birthDate::date))::integer as age_years,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


  );
  
  
[0m09:27:53.343561 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.022 seconds
[0m09:27:53.348980 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:53.349232 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient" rename to "patient__dbt_backup"
[0m09:27:53.350179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:27:53.351775 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:53.351985 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient__dbt_tmp" rename to "patient"
[0m09:27:53.352646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:27:53.360807 [debug] [Thread-1 (]: On model.engage_analytics.patient: COMMIT
[0m09:27:53.361082 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:53.361250 [debug] [Thread-1 (]: On model.engage_analytics.patient: COMMIT
[0m09:27:53.362483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:27:53.365767 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."patient__dbt_backup"
[0m09:27:53.367870 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:27:53.368067 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */
drop table if exists "airbyte"."engage_analytics_engage_analytics_mart"."patient__dbt_backup" cascade
[0m09:27:53.370886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:27:53.372137 [debug] [Thread-1 (]: On model.engage_analytics.patient: Close
[0m09:27:53.373289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea772e2-264e-4806-9f5c-aed6bc649f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033968a0>]}
[0m09:27:53.373794 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mSELECT 400[0m in 0.11s]
[0m09:27:53.374132 [debug] [Thread-1 (]: Finished running node model.engage_analytics.patient
[0m09:27:53.374778 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:53.374942 [debug] [MainThread]: On master: BEGIN
[0m09:27:53.375075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:27:53.389126 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:27:53.389417 [debug] [MainThread]: On master: COMMIT
[0m09:27:53.389566 [debug] [MainThread]: Using postgres connection "master"
[0m09:27:53.389694 [debug] [MainThread]: On master: COMMIT
[0m09:27:53.390102 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:27:53.390302 [debug] [MainThread]: On master: Close
[0m09:27:53.390544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:53.390684 [debug] [MainThread]: Connection 'model.engage_analytics.patient' was properly closed.
[0m09:27:53.390806 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_stg' was properly closed.
[0m09:27:53.390926 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_int' was properly closed.
[0m09:27:53.391074 [info ] [MainThread]: 
[0m09:27:53.391254 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m09:27:53.391668 [debug] [MainThread]: Command end result
[0m09:27:53.447830 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:27:53.449058 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:27:53.451803 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:27:53.451971 [info ] [MainThread]: 
[0m09:27:53.452163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:53.452304 [info ] [MainThread]: 
[0m09:27:53.452455 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:27:53.452753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.77462184, "process_in_blocks": "0", "process_kernel_time": 0.191286, "process_mem_max_rss": "135708672", "process_out_blocks": "0", "process_user_time": 1.159049}
[0m09:27:53.452963 [debug] [MainThread]: Command `dbt run` succeeded at 09:27:53.452927 after 0.77 seconds
[0m09:27:53.453134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106054080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10223b8c0>]}
[0m09:27:53.453299 [debug] [MainThread]: Flushing usage events
[0m09:27:53.568256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:03.946199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11366ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142095b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142092b0>]}


============================== 09:28:03.949913 | 86da4718-ca70-48b7-93da-4c547943680a ==============================
[0m09:28:03.949913 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:28:03.950467 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select patient_anon qr_registration_info_anon', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'use_colors': 'True', 'empty': 'False', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:28:04.052414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86da4718-ca70-48b7-93da-4c547943680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114239910>]}
[0m09:28:04.082876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86da4718-ca70-48b7-93da-4c547943680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ec7620>]}
[0m09:28:04.084586 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:28:04.137415 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:28:04.228663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:28:04.228945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:28:04.252060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86da4718-ca70-48b7-93da-4c547943680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d7dc40>]}
[0m09:28:04.302737 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:28:04.304763 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:28:04.318788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86da4718-ca70-48b7-93da-4c547943680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141c9130>]}
[0m09:28:04.319149 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:28:04.319337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86da4718-ca70-48b7-93da-4c547943680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11529b650>]}
[0m09:28:04.320657 [info ] [MainThread]: 
[0m09:28:04.320927 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:28:04.321078 [info ] [MainThread]: 
[0m09:28:04.321362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:28:04.323245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:28:04.349655 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:28:04.349931 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:28:04.350086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:04.396127 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.046 seconds
[0m09:28:04.396996 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:28:04.399133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m09:28:04.399462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m09:28:04.399733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_int'
[0m09:28:04.402558 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:28:04.403626 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:28:04.404600 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:28:04.404778 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:28:04.404953 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:28:04.405108 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:28:04.405250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:04.405382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:04.405510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:04.436890 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m09:28:04.437276 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:28:04.437520 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:28:04.437966 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m09:28:04.438225 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m09:28:04.438400 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:28:04.438553 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:28:04.438711 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:28:04.438895 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:28:04.439789 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m09:28:04.440540 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:28:04.440749 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.002 seconds
[0m09:28:04.441519 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:28:04.441761 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m09:28:04.441978 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:28:04.442855 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:28:04.443030 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:28:04.443779 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:28:04.450562 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.450834 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.450985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:04.466099 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:28:04.466306 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.466481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:28:04.470291 [debug] [MainThread]: SQL status: SELECT 110 in 0.004 seconds
[0m09:28:04.478300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86da4718-ca70-48b7-93da-4c547943680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cea3f0>]}
[0m09:28:04.478611 [debug] [MainThread]: On master: ROLLBACK
[0m09:28:04.479707 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.479958 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.480970 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:28:04.481120 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.481251 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.481375 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.481952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:28:04.482124 [debug] [MainThread]: On master: Close
[0m09:28:04.484570 [debug] [Thread-1 (]: Began running node model.engage_analytics.patient_anon
[0m09:28:04.484883 [info ] [Thread-1 (]: 1 of 2 START sql view model engage_analytics_engage_analytics_mart.patient_anon  [RUN]
[0m09:28:04.485127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.patient_anon)
[0m09:28:04.485309 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.patient_anon
[0m09:28:04.489330 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.patient_anon"
[0m09:28:04.489591 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_registration_info_anon
[0m09:28:04.489930 [info ] [Thread-2 (]: 2 of 2 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [RUN]
[0m09:28:04.490164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.qr_registration_info_anon)
[0m09:28:04.490342 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_registration_info_anon
[0m09:28:04.492036 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info_anon"
[0m09:28:04.492503 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_registration_info_anon
[0m09:28:04.498773 [debug] [Thread-1 (]: Began executing node model.engage_analytics.patient_anon
[0m09:28:04.513536 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.patient_anon"
[0m09:28:04.514376 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info_anon"
[0m09:28:04.514918 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:04.515101 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: BEGIN
[0m09:28:04.515262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:04.515531 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:04.515733 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: BEGIN
[0m09:28:04.515895 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:04.537185 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m09:28:04.537480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m09:28:04.537677 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:04.537855 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:04.538097 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized registration info with masked PII fields
-- Masks: Unique ID, Names, DOB, Phone, Email, Physical address, Zip code, Medicaid number

select 
    -- Non-PII identifiers (hashed for referential integrity)
    MD5(qr_id::text) as qr_id_hash,
    questionnaire_id,
    MD5(subject_patient_id::text) as subject_patient_id_hash,
    encounter_id,
    author_practitioner_id,
    
    -- Location and organization references (non-PII)
    practitioner_location_id,
    practitioner_organization_id,
    practitioner_id,
    practitioner_careteam_id,
    
    -- Application metadata
    application_version,
    
    -- Masked PII fields
    'REDACTED' as registration_unique_id_masked,
    'REDACTED' as registration_first_name_masked,
    'REDACTED' as registration_middle_name_masked,
    'REDACTED' as registration_surname_masked,
    
    -- Age fields (keep age, mask DOB)
    registration_age,
    registration_age_6,
    registration_calculated_age,
    'REDACTED' as registration_date_of_birth_dob_masked,
    
    -- Masked contact information
    'REDACTED' as "email-address_masked",
    CASE 
        WHEN "phone-number" IS NOT NULL 
        THEN 'XXX-XXX-' || RIGHT("phone-number", 4)
        ELSE NULL
    END as "phone-number_masked",
    'REDACTED' as "physical-address_masked",
    CASE 
        WHEN "zip-code" IS NOT NULL 
        THEN LEFT("zip-code", 3) || 'XX'
        ELSE NULL
    END as "zip-code_masked",
    
    -- Masked Medicaid information
    CASE 
        WHEN "do-you-have-medicaid" = 'Yes' 
        THEN 'Yes'
        ELSE "do-you-have-medicaid"
    END as "do-you-have-medicaid",
    'REDACTED' as "medicaid-number_masked",
    
    -- Non-PII demographic fields
    registration_which_of_the_following_best_represents_how_you_thi,
    registration_what_was_your_biological_sex_assigned_at_birth,
    "choice-gender-identity",
    "choice-pronouns",
    "other-best-represents-how-you-think-of-yourself",
    
    -- Service history (non-PII)
    registration_has_this_person_received_engage_services_in_the_pa,
    
    -- Date components (non-specific)
    registration_calculated_month,
    registration_calculated_year,
    
    -- Metadata
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info"
  );
[0m09:28:04.538360 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized patient view with masked PII fields for data sharing
-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number

select 
    -- Use hashed ID for referential integrity while maintaining privacy
    MD5(p.id::text) as patient_id_hash,
    
    -- Demographic information (non-PII)
    p.gender,
    p.age_years,  -- Age instead of birth_date for privacy
    p.deceased,
    p.active,
    p.registration_date,
    
    -- Masked name fields
    'REDACTED' as name_family_masked,
    'REDACTED' as name_given_masked,
    
    -- Masked contact information
    'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, 'XXXX'), 4) as phone_number_masked,
    
    -- Location and organization (reference IDs only, no PII)
    p.location_id,
    p.practitioner_id,
    p.practitioner_organization_id,
    p.practitioner_careteam_id,
    
    -- Metadata
    p._airbyte_emitted_at,
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."patient" p
  );
[0m09:28:04.540080 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:28:04.543554 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:04.543817 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:28:04.543991 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp" rename to "patient_anon"
[0m09:28:04.545644 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:04.545911 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon" rename to "qr_registration_info_anon__dbt_backup"
[0m09:28:04.546928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:04.553200 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:28:04.554866 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:04.555090 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp" rename to "qr_registration_info_anon"
[0m09:28:04.556081 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:28:04.556274 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:04.556434 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:28:04.556945 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:04.558503 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:28:04.558719 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:04.558882 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:28:04.559095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:04.562270 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup"
[0m09:28:04.562553 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:28:04.564774 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:04.566057 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup"
[0m09:28:04.566289 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup" cascade
[0m09:28:04.566708 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:04.567020 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup" cascade
[0m09:28:04.567682 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:04.569033 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: Close
[0m09:28:04.569947 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:28:04.570584 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info_anon: Close
[0m09:28:04.571336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86da4718-ca70-48b7-93da-4c547943680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156af860>]}
[0m09:28:04.571587 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86da4718-ca70-48b7-93da-4c547943680a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11568b680>]}
[0m09:28:04.572015 [info ] [Thread-1 (]: 1 of 2 OK created sql view model engage_analytics_engage_analytics_mart.patient_anon  [[32mCREATE VIEW[0m in 0.08s]
[0m09:28:04.572341 [info ] [Thread-2 (]: 2 of 2 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [[32mCREATE VIEW[0m in 0.08s]
[0m09:28:04.572619 [debug] [Thread-1 (]: Finished running node model.engage_analytics.patient_anon
[0m09:28:04.572846 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_registration_info_anon
[0m09:28:04.573617 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.573811 [debug] [MainThread]: On master: BEGIN
[0m09:28:04.573968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:04.590650 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m09:28:04.590970 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.591146 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:04.591293 [debug] [MainThread]: On master: COMMIT
[0m09:28:04.591851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:28:04.592070 [debug] [MainThread]: On master: Close
[0m09:28:04.592299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:04.592436 [debug] [MainThread]: Connection 'model.engage_analytics.patient_anon' was properly closed.
[0m09:28:04.592554 [debug] [MainThread]: Connection 'model.engage_analytics.qr_registration_info_anon' was properly closed.
[0m09:28:04.592668 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_int' was properly closed.
[0m09:28:04.592843 [info ] [MainThread]: 
[0m09:28:04.593001 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m09:28:04.593362 [debug] [MainThread]: Command end result
[0m09:28:04.644325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:28:04.645639 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:28:04.648414 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:28:04.648593 [info ] [MainThread]: 
[0m09:28:04.648796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:04.648993 [info ] [MainThread]: 
[0m09:28:04.649175 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m09:28:04.649535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.74055743, "process_in_blocks": "0", "process_kernel_time": 0.179073, "process_mem_max_rss": "135593984", "process_out_blocks": "0", "process_user_time": 1.156289}
[0m09:28:04.649763 [debug] [MainThread]: Command `dbt run` succeeded at 09:28:04.649723 after 0.74 seconds
[0m09:28:04.649954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d66930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d66660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159008f0>]}
[0m09:28:04.650134 [debug] [MainThread]: Flushing usage events
[0m09:28:04.763915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:41.824387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038ca030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa9220>]}


============================== 09:28:41.828625 | 73d75804-aad9-48df-a9ac-a82e61717704 ==============================
[0m09:28:41.828625 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:28:41.829018 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:28:41.930538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070755e0>]}
[0m09:28:41.961160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1d400>]}
[0m09:28:41.962842 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:28:42.018012 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:28:42.111947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:28:42.112277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:28:42.134985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107615760>]}
[0m09:28:42.183602 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:28:42.185464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:28:42.199348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd31d0>]}
[0m09:28:42.199686 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:28:42.199887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca3a70>]}
[0m09:28:42.202012 [info ] [MainThread]: 
[0m09:28:42.202232 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:28:42.202376 [info ] [MainThread]: 
[0m09:28:42.202621 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:28:42.205708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:28:42.206049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:28:42.212212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:28:42.237424 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:28:42.237693 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:28:42.237925 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:28:42.238110 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:28:42.238329 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:28:42.238517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:42.238873 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:28:42.239013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:42.240446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:42.306491 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.066 seconds
[0m09:28:42.306815 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.068 seconds
[0m09:28:42.307712 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:28:42.307908 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.069 seconds
[0m09:28:42.308531 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:28:42.309282 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:28:42.311604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m09:28:42.314796 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:28:42.315002 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:28:42.315140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:42.315440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m09:28:42.316636 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:28:42.317011 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:28:42.317326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m09:28:42.317571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:42.318760 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:28:42.319063 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:28:42.319226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:42.334289 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m09:28:42.334586 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:28:42.334758 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:28:42.336815 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m09:28:42.337606 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:28:42.338079 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:28:42.340174 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m09:28:42.340517 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:28:42.340734 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:28:42.341180 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m09:28:42.341323 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:28:42.341470 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:28:42.342930 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m09:28:42.343678 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:28:42.343886 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.002 seconds
[0m09:28:42.344878 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:28:42.345092 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:28:42.345527 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:28:42.352307 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:42.352528 [debug] [MainThread]: On master: BEGIN
[0m09:28:42.352658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:42.367867 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:28:42.368166 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:42.368358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:28:42.371353 [debug] [MainThread]: SQL status: SELECT 111 in 0.003 seconds
[0m09:28:42.379716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108828ce0>]}
[0m09:28:42.380053 [debug] [MainThread]: On master: ROLLBACK
[0m09:28:42.381491 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:42.381725 [debug] [MainThread]: On master: BEGIN
[0m09:28:42.383278 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.383429 [debug] [MainThread]: On master: COMMIT
[0m09:28:42.383557 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:42.383679 [debug] [MainThread]: On master: COMMIT
[0m09:28:42.384439 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.384575 [debug] [MainThread]: On master: Close
[0m09:28:42.386998 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m09:28:42.387291 [info ] [Thread-1 (]: 1 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m09:28:42.387528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_careplans)
[0m09:28:42.387694 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m09:28:42.394201 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m09:28:42.394462 [info ] [Thread-2 (]: 2 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m09:28:42.394679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_careteams)
[0m09:28:42.394841 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m09:28:42.399817 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m09:28:42.401606 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m09:28:42.401961 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m09:28:42.402206 [info ] [Thread-3 (]: 3 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m09:28:42.402440 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m09:28:42.402778 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_encounter)
[0m09:28:42.403131 [info ] [Thread-4 (]: 4 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m09:28:42.403408 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m09:28:42.403582 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m09:28:42.403766 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m09:28:42.404104 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m09:28:42.418708 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m09:28:42.434081 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:28:42.435869 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:28:42.436074 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m09:28:42.436415 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

    
  
    

  create temporary table "stg_careteams__dbt_tmp092842422034"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams")

  );
  
  
[0m09:28:42.436740 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

    
  
    

  create temporary table "stg_careplans__dbt_tmp092842435248"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans")

  );
  
  
[0m09:28:42.439542 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m09:28:42.439842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:42.440083 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m09:28:42.440270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:42.442504 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:28:42.442841 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m09:28:42.443056 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

    
  
    

  create temporary table "stg_encounter__dbt_tmp092842441824"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter")

  );
  
  
[0m09:28:42.445518 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:28:42.445808 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:42.446097 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

    
  
    

  create temporary table "stg_locations__dbt_tmp092842444920"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations")

  );
  
  
[0m09:28:42.446396 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:28:42.461820 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.022 seconds
[0m09:28:42.498430 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:28:42.498841 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m09:28:42.499552 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:42.499828 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:28:42.500033 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams__dbt_tmp092842422034'
        
      order by ordinal_position

  
[0m09:28:42.500268 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.054 seconds
[0m09:28:42.501860 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:28:42.502110 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m09:28:42.502338 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.056 seconds
[0m09:28:42.503868 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:28:42.504196 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:42.504440 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.064 seconds
[0m09:28:42.504616 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.004 seconds
[0m09:28:42.504788 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m09:28:42.505054 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:28:42.506644 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:28:42.509189 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:28:42.509487 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter__dbt_tmp092842441824'
        
      order by ordinal_position

  
[0m09:28:42.509682 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m09:28:42.509907 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.510149 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.510430 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:28:42.510634 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations__dbt_tmp092842444920'
        
      order by ordinal_position

  
[0m09:28:42.510837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:42.510991 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:28:42.511152 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans__dbt_tmp092842435248'
        
      order by ordinal_position

  
[0m09:28:42.512141 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:28:42.515885 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:28:42.516169 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.005 seconds
[0m09:28:42.516399 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.005 seconds
[0m09:28:42.516578 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.516739 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.006 seconds
[0m09:28:42.518543 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:28:42.520117 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:28:42.521805 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:28:42.522027 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.522250 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:28:42.522479 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.522690 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.529248 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.006 seconds
[0m09:28:42.531467 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m09:28:42.533445 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:28:42.533732 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.002 seconds
[0m09:28:42.534040 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:28:42.534328 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.536121 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:28:42.537999 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:28:42.538360 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:28:42.538604 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.538811 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.539041 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careteams__dbt_tmp092842422034" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" ("id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource")
    (
        select "id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource"
        from "stg_careteams__dbt_tmp092842422034"
    )
  
[0m09:28:42.540108 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:28:42.541283 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m09:28:42.541556 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:28:42.542634 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m09:28:42.542868 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m09:28:42.543060 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m09:28:42.544003 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m09:28:42.551133 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:28:42.551377 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:28:42.551572 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:28:42.551775 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:28:42.551984 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_locations__dbt_tmp092842444920" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" ("id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference")
    (
        select "id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference"
        from "stg_locations__dbt_tmp092842444920"
    )
  
[0m09:28:42.552215 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_encounter__dbt_tmp092842441824" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" ("id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at"
        from "stg_encounter__dbt_tmp092842441824"
    )
  
[0m09:28:42.552413 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:28:42.552568 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:28:42.552836 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careplans__dbt_tmp092842435248" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" ("id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at"
        from "stg_careplans__dbt_tmp092842435248"
    )
  
[0m09:28:42.553643 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.554563 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m09:28:42.554761 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:28:42.554936 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:28:42.555100 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:28:42.556346 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:28:42.556921 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:28:42.557495 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:28:42.557746 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:28:42.557952 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:28:42.558146 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:28:42.558369 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039b2810>]}
[0m09:28:42.558544 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:28:42.558712 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:28:42.558865 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:28:42.559171 [info ] [Thread-2 (]: 2 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mINSERT 0 0[0m in 0.16s]
[0m09:28:42.559592 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m09:28:42.559811 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m09:28:42.560107 [info ] [Thread-2 (]: 5 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m09:28:42.560436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_organization_affiliations)
[0m09:28:42.560605 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m09:28:42.563091 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.563382 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m09:28:42.563718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:28:42.563925 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:28:42.564358 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m09:28:42.564729 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m09:28:42.565053 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m09:28:42.565232 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m09:28:42.565663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6b890>]}
[0m09:28:42.565990 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107551ac0>]}
[0m09:28:42.568106 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.568455 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd22a0>]}
[0m09:28:42.568882 [info ] [Thread-1 (]: 1 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mINSERT 0 0[0m in 0.18s]
[0m09:28:42.569649 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

    
  
    

  create temporary table "stg_organization_affiliations__dbt_tmp092842567284"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations")

  );
  
  
[0m09:28:42.569359 [info ] [Thread-3 (]: 3 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mINSERT 0 0[0m in 0.16s]
[0m09:28:42.570077 [info ] [Thread-4 (]: 4 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mINSERT 0 0[0m in 0.16s]
[0m09:28:42.570393 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m09:28:42.570625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:42.570946 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m09:28:42.571233 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m09:28:42.571472 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_organizations
[0m09:28:42.571772 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_patient
[0m09:28:42.572025 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_practitioner
[0m09:28:42.572328 [info ] [Thread-1 (]: 6 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m09:28:42.572605 [info ] [Thread-3 (]: 7 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m09:28:42.572896 [info ] [Thread-4 (]: 8 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m09:28:42.573170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_organizations)
[0m09:28:42.573435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_patient)
[0m09:28:42.573758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_practitioner)
[0m09:28:42.573950 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_organizations
[0m09:28:42.574138 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_patient
[0m09:28:42.574378 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m09:28:42.576887 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m09:28:42.579271 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m09:28:42.582742 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m09:28:42.583629 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_organizations
[0m09:28:42.583841 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_practitioner
[0m09:28:42.585595 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:28:42.585843 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_patient
[0m09:28:42.587766 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:28:42.588006 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

    
  
    

  create temporary table "stg_organizations__dbt_tmp092842584925"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  -- this filter will only be applied on an incremental run
   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations")

  );
  
  
[0m09:28:42.589819 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:28:42.590095 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

    
  
    

  create temporary table "stg_practitioner__dbt_tmp092842587147"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner")

  );
  
  
[0m09:28:42.590366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:42.590786 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

    
  
    

  create temporary table "stg_patient__dbt_tmp092842589140"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient")

  );
  
  
[0m09:28:42.591065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:42.591379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:42.592182 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.022 seconds
[0m09:28:42.594136 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.594452 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m09:28:42.595172 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:42.595415 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.595596 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations__dbt_tmp092842567284'
        
      order by ordinal_position

  
[0m09:28:42.599377 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:28:42.601154 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.601377 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.603575 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:28:42.605501 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.605775 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.607660 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:28:42.608616 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.609070 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.609267 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organization_affiliations__dbt_tmp092842567284" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" ("id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at"
        from "stg_organization_affiliations__dbt_tmp092842567284"
    )
  
[0m09:28:42.610116 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.611028 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:28:42.611262 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:28:42.611435 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:28:42.612163 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.612513 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m09:28:42.612808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e236e0>]}
[0m09:28:42.613119 [info ] [Thread-2 (]: 5 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mINSERT 0 0[0m in 0.05s]
[0m09:28:42.613395 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m09:28:42.613593 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m09:28:42.613942 [info ] [Thread-2 (]: 9 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m09:28:42.614471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_practitioner_roles)
[0m09:28:42.614723 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m09:28:42.617091 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.617356 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.026 seconds
[0m09:28:42.617591 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.027 seconds
[0m09:28:42.617803 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.026 seconds
[0m09:28:42.619508 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:28:42.621930 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:28:42.623299 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:28:42.623584 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m09:28:42.623843 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m09:28:42.624080 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m09:28:42.624325 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: BEGIN
[0m09:28:42.626119 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.626515 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

    
  
    

  create temporary table "stg_practitioner_roles__dbt_tmp092842625449"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles")

  );
  
  
[0m09:28:42.626760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:42.627040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.627264 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.627456 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.627702 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:28:42.627941 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:28:42.628192 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:28:42.628439 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations__dbt_tmp092842584925'
        
      order by ordinal_position

  
[0m09:28:42.628692 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient__dbt_tmp092842589140'
        
      order by ordinal_position

  
[0m09:28:42.628934 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner__dbt_tmp092842587147'
        
      order by ordinal_position

  
[0m09:28:42.633431 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:28:42.633692 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m09:28:42.633877 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.005 seconds
[0m09:28:42.635633 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:28:42.637461 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:28:42.639032 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:28:42.639275 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.639616 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.639886 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.641934 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:28:42.643784 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:28:42.644136 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.004 seconds
[0m09:28:42.644343 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.644507 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:28:42.644649 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.018 seconds
[0m09:28:42.646330 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:28:42.648135 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:28:42.648359 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:28:42.650636 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.650896 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.651097 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.652011 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m09:28:42.652213 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m09:28:42.652932 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:42.653134 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.653310 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles__dbt_tmp092842625449'
        
      order by ordinal_position

  
[0m09:28:42.653587 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:28:42.653878 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner__dbt_tmp092842587147" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" ("id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at"
        from "stg_practitioner__dbt_tmp092842587147"
    )
  
[0m09:28:42.654224 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.002 seconds
[0m09:28:42.654538 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:28:42.655878 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m09:28:42.656103 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:28:42.656999 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m09:28:42.657218 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:28:42.657864 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:28:42.659505 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.659737 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:28:42.659969 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.660168 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:28:42.660362 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:28:42.660544 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:28:42.660772 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_patient__dbt_tmp092842589140" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" ("id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at")
    (
        select "id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at"
        from "stg_patient__dbt_tmp092842589140"
    )
  
[0m09:28:42.661050 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organizations__dbt_tmp092842584925" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" ("id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at")
    (
        select "id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at"
        from "stg_organizations__dbt_tmp092842584925"
    )
  
[0m09:28:42.661662 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.662080 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: Close
[0m09:28:42.662268 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.662436 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.662600 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:28:42.663233 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:28:42.663537 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea63c0>]}
[0m09:28:42.664300 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:28:42.666058 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.666279 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:28:42.666802 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:28:42.666630 [info ] [Thread-4 (]: 8 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mINSERT 0 0[0m in 0.09s]
[0m09:28:42.667044 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.667244 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:28:42.667409 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:28:42.667647 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_practitioner
[0m09:28:42.667942 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m09:28:42.668236 [info ] [Thread-4 (]: 10 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m09:28:42.668512 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.stg_questionnaire_response)
[0m09:28:42.668725 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.668922 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m09:28:42.669087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.669456 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: Close
[0m09:28:42.669672 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:28:42.671481 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.671848 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: Close
[0m09:28:42.672971 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.673245 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b12f30>]}
[0m09:28:42.673549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f17b30>]}
[0m09:28:42.674113 [info ] [Thread-3 (]: 7 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mINSERT 0 0[0m in 0.10s]
[0m09:28:42.675166 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_patient
[0m09:28:42.675379 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m09:28:42.674847 [info ] [Thread-1 (]: 6 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mINSERT 0 0[0m in 0.10s]
[0m09:28:42.675771 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.676046 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_task
[0m09:28:42.678241 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.678606 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_organizations
[0m09:28:42.678838 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner_roles__dbt_tmp092842625449" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" ("id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at"
        from "stg_practitioner_roles__dbt_tmp092842625449"
    )
  
[0m09:28:42.679124 [info ] [Thread-3 (]: 11 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m09:28:42.679471 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

    
  
    

  create temporary table "stg_questionnaire_response__dbt_tmp092842677476"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response")

  );
  
  
[0m09:28:42.679755 [debug] [Thread-1 (]: Began running node model.engage_analytics.unnested_careteams
[0m09:28:42.680123 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.stg_task)
[0m09:28:42.680338 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:42.680608 [info ] [Thread-1 (]: 12 of 59 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m09:28:42.680833 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_task
[0m09:28:42.681050 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.681327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.unnested_careteams)
[0m09:28:42.684124 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m09:28:42.685060 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:28:42.685355 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m09:28:42.685617 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:28:42.687202 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m09:28:42.687598 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:28:42.687895 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_task
[0m09:28:42.690024 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:28:42.690265 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

    
  
    

  create temporary table "stg_task__dbt_tmp092842689179"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task")

  );
  
  
[0m09:28:42.690519 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:42.690792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:42.691304 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m09:28:42.691674 [debug] [Thread-1 (]: Began executing node model.engage_analytics.unnested_careteams
[0m09:28:42.698391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee6060>]}
[0m09:28:42.702974 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m09:28:42.703339 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.023 seconds
[0m09:28:42.703657 [info ] [Thread-2 (]: 9 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mINSERT 0 0[0m in 0.08s]
[0m09:28:42.705553 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.706069 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m09:28:42.706388 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m09:28:42.706729 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:28:42.706954 [debug] [Thread-2 (]: Began running node model.engage_analytics.encounters
[0m09:28:42.707329 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m09:28:42.707670 [info ] [Thread-2 (]: 13 of 59 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m09:28:42.708070 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.708288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:42.708524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.encounters)
[0m09:28:42.708706 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.708982 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.encounters
[0m09:28:42.709182 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response__dbt_tmp092842677476'
        
      order by ordinal_position

  
[0m09:28:42.720244 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.720654 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m09:28:42.720960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:42.723508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:28:42.723881 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:28:42.724118 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m09:28:42.724713 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.004 seconds
[0m09:28:42.726562 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.726827 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:42.727117 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.730883 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:28:42.731193 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams" rename to "unnested_careteams__dbt_backup"
[0m09:28:42.732056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:42.733778 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:28:42.734152 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m09:28:42.734417 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m09:28:42.736173 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.736505 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.736945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:42.738772 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:28:42.739025 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:28:42.739221 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:28:42.739471 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m09:28:42.740541 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.740818 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.745559 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m09:28:42.747792 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:28:42.747998 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m09:28:42.748292 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.027 seconds
[0m09:28:42.749009 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.749265 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.058 seconds
[0m09:28:42.749526 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:42.749704 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m09:28:42.749927 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.751529 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:28:42.752174 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: Close
[0m09:28:42.752495 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_questionnaire_response__dbt_tmp092842677476" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" ("id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at")
    (
        select "id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at"
        from "stg_questionnaire_response__dbt_tmp092842677476"
    )
  
[0m09:28:42.752733 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: BEGIN
[0m09:28:42.753107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9e2a0>]}
[0m09:28:42.753753 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.753515 [info ] [Thread-1 (]: 12 of 59 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.07s]
[0m09:28:42.754034 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:28:42.754255 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.754561 [debug] [Thread-1 (]: Finished running node model.engage_analytics.unnested_careteams
[0m09:28:42.754786 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_task__dbt_tmp092842689179'
        
      order by ordinal_position

  
[0m09:28:42.755474 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:28:42.755687 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:28:42.755899 [debug] [Thread-1 (]: Began running node model.engage_analytics.organization_affiliations
[0m09:28:42.756144 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:28:42.756867 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.757122 [info ] [Thread-1 (]: 14 of 59 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m09:28:42.757355 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:28:42.757578 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m09:28:42.757821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.organization_affiliations)
[0m09:28:42.758154 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m09:28:42.760480 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m09:28:42.760715 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:28:42.760889 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:28:42.761076 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.005 seconds
[0m09:28:42.762579 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.763131 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m09:28:42.764976 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:28:42.765239 [debug] [Thread-1 (]: Began executing node model.engage_analytics.organization_affiliations
[0m09:28:42.765450 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m09:28:42.765804 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.766110 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee9ca0>]}
[0m09:28:42.768278 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:28:42.769090 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

    
  
    

  create temporary table "organization_affiliations__dbt_tmp092842767435"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

where s._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
)

  );
  
  
[0m09:28:42.768871 [info ] [Thread-4 (]: 10 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mINSERT 0 0[0m in 0.10s]
[0m09:28:42.769388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:42.769695 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m09:28:42.770047 [debug] [Thread-4 (]: Began running node model.engage_analytics.patient
[0m09:28:42.770337 [info ] [Thread-4 (]: 15 of 59 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m09:28:42.770698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.patient)
[0m09:28:42.770936 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:28:42.771149 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:28:42.771396 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.patient
[0m09:28:42.772996 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m09:28:42.774961 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:28:42.777466 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m09:28:42.777897 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:28:42.778460 [debug] [Thread-2 (]: Began executing node model.engage_analytics.encounters
[0m09:28:42.780875 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.781175 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.003 seconds
[0m09:28:42.781510 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    
  
    

  create temporary table "encounters__dbt_tmp092842779972"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."encounters")

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

where e._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
)

  );
  
  
[0m09:28:42.781816 [debug] [Thread-4 (]: Began executing node model.engage_analytics.patient
[0m09:28:42.783255 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m09:28:42.786530 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:28:42.786990 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp092842785744"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    DATE_PART('year', AGE(stp.birthDate::date))::integer as age_years,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m09:28:42.787355 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m09:28:42.787608 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:42.787837 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m09:28:42.789692 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:28:42.790008 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:28:42.791418 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.791768 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m09:28:42.792059 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_task__dbt_tmp092842689179" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" ("id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at")
    (
        select "id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at"
        from "stg_task__dbt_tmp092842689179"
    )
  
[0m09:28:42.792293 [debug] [Thread-2 (]: On model.engage_analytics.encounters: BEGIN
[0m09:28:42.792889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:42.793139 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.793354 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:28:42.793570 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.793813 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.794050 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations__dbt_tmp092842767435'
        
      order by ordinal_position

  
[0m09:28:42.794807 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:28:42.795042 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'encounters__dbt_tmp092842779972'
        
      order by ordinal_position

  
[0m09:28:42.795294 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:28:42.795557 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:28:42.796597 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.797057 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: Close
[0m09:28:42.797372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe42f0>]}
[0m09:28:42.797726 [info ] [Thread-3 (]: 11 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mINSERT 0 0[0m in 0.12s]
[0m09:28:42.798053 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_task
[0m09:28:42.798270 [debug] [Thread-3 (]: Began running node model.engage_analytics.organizations
[0m09:28:42.798532 [info ] [Thread-3 (]: 16 of 59 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m09:28:42.798926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.organizations)
[0m09:28:42.799143 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.organizations
[0m09:28:42.801248 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:28:42.801481 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.006 seconds
[0m09:28:42.801725 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m09:28:42.801949 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m09:28:42.803754 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.805340 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:28:42.805567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:42.805783 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.805999 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.806626 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.019 seconds
[0m09:28:42.808412 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:28:42.808708 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:28:42.808947 [debug] [Thread-4 (]: On model.engage_analytics.patient: BEGIN
[0m09:28:42.809118 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m09:28:42.811109 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.812983 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:28:42.813316 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.813552 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:42.813797 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.814133 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:28:42.814405 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp092842785744'
        
      order by ordinal_position

  
[0m09:28:42.816099 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:28:42.816380 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m09:28:42.817834 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m09:28:42.818709 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m09:28:42.818967 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.004 seconds
[0m09:28:42.821961 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:28:42.822240 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.822584 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.822837 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."encounters" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "encounters__dbt_tmp092842779972" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."encounters" ("id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at")
    (
        select "id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at"
        from "encounters__dbt_tmp092842779972"
    )
  
[0m09:28:42.823100 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:28:42.823364 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organization_affiliations__dbt_tmp092842767435" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" ("id", "organization_id", "location_id", "_airbyte_emitted_at")
    (
        select "id", "organization_id", "location_id", "_airbyte_emitted_at"
        from "organization_affiliations__dbt_tmp092842767435"
    )
  
[0m09:28:42.823633 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m09:28:42.824584 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m09:28:42.824848 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.825111 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:28:42.825296 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.003 seconds
[0m09:28:42.826047 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:28:42.826707 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m09:28:42.828574 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:28:42.828886 [debug] [Thread-3 (]: Began executing node model.engage_analytics.organizations
[0m09:28:42.829111 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:28:42.829351 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:28:42.829585 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.831727 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:28:42.831954 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:28:42.832158 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m09:28:42.832422 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    
  
    

  create temporary table "organizations__dbt_tmp092842830893"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

where o._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
)

  );
  
  
[0m09:28:42.833353 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.833590 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.834001 [debug] [Thread-2 (]: On model.engage_analytics.encounters: Close
[0m09:28:42.834207 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.001 seconds
[0m09:28:42.834607 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: Close
[0m09:28:42.834795 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.002 seconds
[0m09:28:42.836421 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:28:42.836727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098175c0>]}
[0m09:28:42.838087 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m09:28:42.838365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109825e80>]}
[0m09:28:42.838555 [debug] [Thread-3 (]: On model.engage_analytics.organizations: BEGIN
[0m09:28:42.838907 [info ] [Thread-2 (]: 13 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mINSERT 0 0[0m in 0.13s]
[0m09:28:42.839291 [info ] [Thread-1 (]: 14 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mINSERT 0 0[0m in 0.08s]
[0m09:28:42.839697 [debug] [Thread-2 (]: Finished running node model.engage_analytics.encounters
[0m09:28:42.839920 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:42.840184 [debug] [Thread-1 (]: Finished running node model.engage_analytics.organization_affiliations
[0m09:28:42.840384 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:28:42.840601 [debug] [Thread-2 (]: Began running node model.engage_analytics.practitioner_role
[0m09:28:42.840794 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:28:42.840976 [debug] [Thread-1 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m09:28:42.841178 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp092842785744" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "age_years", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "age_years", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp092842785744"
    )
  
[0m09:28:42.841595 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organizations__dbt_tmp092842830893'
        
      order by ordinal_position

  
[0m09:28:42.841440 [info ] [Thread-2 (]: 17 of 59 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m09:28:42.841869 [info ] [Thread-1 (]: 18 of 59 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m09:28:42.842132 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.practitioner_role)
[0m09:28:42.842352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.int_qr_answers_long)
[0m09:28:42.842532 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.practitioner_role
[0m09:28:42.842705 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.842863 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m09:28:42.844948 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m09:28:42.845635 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m09:28:42.847262 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m09:28:42.847561 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.005 seconds
[0m09:28:42.847912 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:28:42.849593 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:28:42.849897 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m09:28:42.850173 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.850383 [debug] [Thread-1 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m09:28:42.850607 [debug] [Thread-2 (]: Began executing node model.engage_analytics.practitioner_role
[0m09:28:42.852131 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m09:28:42.852373 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:42.852581 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.002 seconds
[0m09:28:42.855580 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:28:42.856166 [debug] [Thread-4 (]: On model.engage_analytics.patient: Close
[0m09:28:42.857845 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:28:42.858131 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

    
  
    

  create temporary table "practitioner_role__dbt_tmp092842853837"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

where spr._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01')
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
)

  );
  
  
[0m09:28:42.858431 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.858663 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:28:42.858909 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb87a0>]}
[0m09:28:42.859094 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:42.859342 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m09:28:42.859654 [info ] [Thread-4 (]: 15 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.09s]
[0m09:28:42.859947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:42.860205 [debug] [Thread-4 (]: Finished running node model.engage_analytics.patient
[0m09:28:42.860481 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_header
[0m09:28:42.860785 [info ] [Thread-4 (]: 19 of 59 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m09:28:42.861082 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.int_qr_header)
[0m09:28:42.861298 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.002 seconds
[0m09:28:42.861542 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_header
[0m09:28:42.862685 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m09:28:42.864333 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m09:28:42.864832 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_header
[0m09:28:42.866602 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m09:28:42.866855 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:28:42.867118 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organizations__dbt_tmp092842830893" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organizations" ("id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at")
    (
        select "id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at"
        from "organizations__dbt_tmp092842830893"
    )
  
[0m09:28:42.867501 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:28:42.867743 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m09:28:42.867916 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:42.868109 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.868839 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m09:28:42.869038 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:28:42.869208 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m09:28:42.870051 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.870768 [debug] [Thread-3 (]: On model.engage_analytics.organizations: Close
[0m09:28:42.871089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983a030>]}
[0m09:28:42.871534 [info ] [Thread-3 (]: 16 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mINSERT 0 0[0m in 0.07s]
[0m09:28:42.871842 [debug] [Thread-3 (]: Finished running node model.engage_analytics.organizations
[0m09:28:42.872044 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_tags
[0m09:28:42.872302 [info ] [Thread-3 (]: 20 of 59 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m09:28:42.872523 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.int_qr_tags)
[0m09:28:42.872688 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m09:28:42.874640 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m09:28:42.875072 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_tags
[0m09:28:42.877107 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:28:42.877470 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

    
  
    

  create temporary table "int_qr_tags__dbt_tmp092842876378"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags")

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m09:28:42.877971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:42.879920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:28:42.880299 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:28:42.880590 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m09:28:42.881983 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.023 seconds
[0m09:28:42.883843 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:28:42.884148 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:42.884429 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m09:28:42.886553 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:28:42.886847 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m09:28:42.887090 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" rename to "int_qr_answers_long__dbt_backup"
[0m09:28:42.887387 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:28:42.887749 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:42.887994 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m09:28:42.888206 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:28:42.888545 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role__dbt_tmp092842853837'
        
      order by ordinal_position

  
[0m09:28:42.888892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:42.890531 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:28:42.890766 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:42.891072 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m09:28:42.893649 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:28:42.893960 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.005 seconds
[0m09:28:42.894229 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" rename to "int_qr_header__dbt_backup"
[0m09:28:42.895779 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:28:42.895975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:42.896203 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.896841 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:28:42.897116 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:42.897449 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:28:42.897681 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:28:42.899298 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:28:42.899507 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.002 seconds
[0m09:28:42.899712 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:28:42.901253 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:28:42.901458 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m09:28:42.903202 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:28:42.903490 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m09:28:42.903799 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:42.904241 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:28:42.904911 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:28:42.905127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:42.905355 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:28:42.905527 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:42.907273 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m09:28:42.907485 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.003 seconds
[0m09:28:42.907648 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:28:42.907817 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:28:42.908089 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:28:42.909025 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m09:28:42.909300 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags__dbt_tmp092842876378'
        
      order by ordinal_position

  
[0m09:28:42.909526 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m09:28:42.909844 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.911041 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m09:28:42.911314 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:28:42.911503 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:28:42.911679 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m09:28:42.911875 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioner_role__dbt_tmp092842853837" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" ("id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at")
    (
        select "id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at"
        from "practitioner_role__dbt_tmp092842853837"
    )
  
[0m09:28:42.912887 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.913603 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:28:42.913853 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.004 seconds
[0m09:28:42.914102 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:28:42.915771 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:28:42.915972 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:28:42.916162 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:28:42.917173 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.917545 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: Close
[0m09:28:42.917823 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098838f0>]}
[0m09:28:42.918329 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.002 seconds
[0m09:28:42.918133 [info ] [Thread-2 (]: 17 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mINSERT 0 0[0m in 0.08s]
[0m09:28:42.920180 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:28:42.920524 [debug] [Thread-2 (]: Finished running node model.engage_analytics.practitioner_role
[0m09:28:42.920742 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:28:42.920968 [debug] [Thread-2 (]: Began running node model.engage_analytics.patient_anon
[0m09:28:42.921317 [info ] [Thread-2 (]: 21 of 59 START sql view model engage_analytics_engage_analytics_mart.patient_anon  [RUN]
[0m09:28:42.921550 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.patient_anon)
[0m09:28:42.921723 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.patient_anon
[0m09:28:42.923399 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.patient_anon"
[0m09:28:42.923615 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.002 seconds
[0m09:28:42.924750 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m09:28:42.925124 [debug] [Thread-2 (]: Began executing node model.engage_analytics.patient_anon
[0m09:28:42.928089 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.patient_anon"
[0m09:28:42.928462 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:28:42.928673 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" as DBT_INTERNAL_DEST
        where (resource_id) in (
            select distinct resource_id
            from "int_qr_tags__dbt_tmp092842876378" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" ("resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version")
    (
        select "resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version"
        from "int_qr_tags__dbt_tmp092842876378"
    )
  
[0m09:28:42.929232 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:28:42.930012 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m09:28:42.930227 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:42.930428 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:28:42.930700 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:42.931603 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:28:42.931881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb8b60>]}
[0m09:28:42.932774 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: Close
[0m09:28:42.933018 [debug] [Thread-2 (]: On model.engage_analytics.patient_anon: BEGIN
[0m09:28:42.933256 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:28:42.933653 [info ] [Thread-1 (]: 18 of 59 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.09s]
[0m09:28:42.934059 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10883b170>]}
[0m09:28:42.934284 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:42.934496 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:28:42.934762 [debug] [Thread-1 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m09:28:42.935058 [info ] [Thread-4 (]: 19 of 59 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.07s]
[0m09:28:42.935384 [debug] [Thread-1 (]: Began running node model.engage_analytics.current_practitioner_role
[0m09:28:42.935709 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_header
[0m09:28:42.936005 [info ] [Thread-1 (]: 22 of 59 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m09:28:42.936342 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.936649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.current_practitioner_role)
[0m09:28:42.937071 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: Close
[0m09:28:42.937311 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m09:28:42.937690 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990b200>]}
[0m09:28:42.939458 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m09:28:42.939958 [info ] [Thread-3 (]: 20 of 59 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mINSERT 0 0[0m in 0.07s]
[0m09:28:42.940393 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_tags
[0m09:28:42.940934 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m09:28:42.941134 [debug] [Thread-1 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m09:28:42.941317 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:28:42.941566 [info ] [Thread-4 (]: 23 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m09:28:42.943511 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m09:28:42.943889 [info ] [Thread-3 (]: 24 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [RUN]
[0m09:28:42.944321 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.qr_1_month_follow_up)
[0m09:28:42.944690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.qr_common_mental_health_symptoms)
[0m09:28:42.945017 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m09:28:42.945280 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:28:42.945463 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:28:42.952073 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:28:42.952408 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m09:28:42.952697 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m09:28:42.954976 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:28:42.955288 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:42.955555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:42.955782 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:42.956012 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:42.956247 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:42.956614 [debug] [Thread-2 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized patient view with masked PII fields for data sharing
-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number

select 
    -- Use hashed ID for referential integrity while maintaining privacy
    MD5(p.id::text) as patient_id_hash,
    
    -- Demographic information (non-PII)
    p.gender,
    p.age_years,  -- Age instead of birth_date for privacy
    p.deceased,
    p.active,
    p.registration_date,
    
    -- Masked name fields
    'REDACTED' as name_family_masked,
    'REDACTED' as name_given_masked,
    
    -- Masked contact information
    'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, 'XXXX'), 4) as phone_number_masked,
    
    -- Location and organization (reference IDs only, no PII)
    p.location_id,
    p.practitioner_id,
    p.practitioner_organization_id,
    p.practitioner_careteam_id,
    
    -- Metadata
    p._airbyte_emitted_at,
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."patient" p
  );
[0m09:28:42.956889 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:42.958951 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:42.960967 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:42.961187 [debug] [Thread-2 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon" rename to "patient_anon__dbt_backup"
[0m09:28:42.962053 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:42.963806 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:42.964048 [debug] [Thread-2 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp" rename to "patient_anon"
[0m09:28:42.964955 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:42.965921 [debug] [Thread-2 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:28:42.966211 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:42.966508 [debug] [Thread-2 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:28:42.967673 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.969011 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup"
[0m09:28:42.969348 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:28:42.969540 [debug] [Thread-2 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup" cascade
[0m09:28:42.971157 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:42.971905 [debug] [Thread-2 (]: On model.engage_analytics.patient_anon: Close
[0m09:28:42.972207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbed50>]}
[0m09:28:42.972523 [info ] [Thread-2 (]: 21 of 59 OK created sql view model engage_analytics_engage_analytics_mart.patient_anon  [[32mCREATE VIEW[0m in 0.05s]
[0m09:28:42.972823 [debug] [Thread-2 (]: Finished running node model.engage_analytics.patient_anon
[0m09:28:42.973011 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_confidential_s1
[0m09:28:42.973216 [info ] [Thread-2 (]: 25 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [RUN]
[0m09:28:42.973475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient_anon, now model.engage_analytics.qr_confidential_s1)
[0m09:28:42.973692 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_confidential_s1
[0m09:28:42.977437 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:28:42.977752 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:42.977960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:42.978383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m09:28:42.978552 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:28:42.978725 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m09:28:42.980817 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:42.982884 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:28:42.983116 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" rename to "current_practitioner_role__dbt_backup"
[0m09:28:42.984097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:42.985902 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:28:42.986123 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m09:28:42.987278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:42.988019 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:28:42.988228 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:28:42.988503 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:28:42.990074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:42.992122 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m09:28:42.992507 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:28:42.992713 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m09:28:42.994082 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:42.994837 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: Close
[0m09:28:42.995198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff6270>]}
[0m09:28:42.995557 [info ] [Thread-1 (]: 22 of 59 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.06s]
[0m09:28:42.995899 [debug] [Thread-1 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m09:28:42.996163 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_financial_wellness_tool
[0m09:28:42.996479 [info ] [Thread-1 (]: 26 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [RUN]
[0m09:28:42.996813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.qr_financial_wellness_tool)
[0m09:28:42.996998 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_financial_wellness_tool
[0m09:28:42.999841 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:28:43.000116 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:43.000318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:43.754879 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.777 seconds
[0m09:28:43.757487 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_confidential_s1"
[0m09:28:43.758627 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_confidential_s1
[0m09:28:43.761230 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_confidential_s1"
[0m09:28:43.761561 [debug] [Thread-3 (]: SQL status: SELECT 36 in 0.805 seconds
[0m09:28:43.762699 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:28:43.763126 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:28:43.763321 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: BEGIN
[0m09:28:43.763768 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:28:43.765408 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:28:43.765673 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:43.765937 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:28:43.766213 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Discuss Confidentiality with readable column names
-- Questionnaire ID: 23451
-- Source file: questionnaire/ipc-session-1/confidential-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:43.766534 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:28:43.766843 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: BEGIN
[0m09:28:43.767458 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:43.767636 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:28:43.767944 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Common Mental Health Symptoms with readable column names
-- Questionnaire ID: q-common-mental-health-symptoms
-- Source file: questionnaire/assessments/common-mental-health-symptoms.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "total_score",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrfeeling",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "total_score_meaning",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brrepeat",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "total_score_5",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrloss_of",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brhaving",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "total_score_meaning_9",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "how_difficult_have_these_problems_made_it_for_you_to_do_your",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "total_score_11",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brfeelin",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "total_score_meaning_13",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi_14",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrhaving",max(case when linkid = 'f1.10.1' then answer_value_text end) as "f1.10.1",max(case when linkid = 'f1.11.1' then answer_value_text end) as "f1.11.1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "f1.15.1",max(case when linkid = 'f1.16.1' then answer_value_text end) as "f1.16.1",max(case when linkid = 'f1.17.1' then answer_value_text end) as "f1.17.1",max(case when linkid = 'f1.18.1' then answer_value_text end) as "f1.18.1",max(case when linkid = 'f1.19.1' then answer_value_text end) as "f1.19.1",max(case when linkid = 'f1.20.1' then answer_value_text end) as "f1.20.1",max(case when linkid = 'f1.21.1' then answer_value_text end) as "f1.21.1",max(case when linkid = 'f1.3.1' then answer_value_text end) as "f1.3.1",max(case when linkid = 'f1.4.1' then answer_value_text end) as "f1.4.1",max(case when linkid = 'f1.5.1' then answer_value_text end) as "f1.5.1",max(case when linkid = 'f1.6.1' then answer_value_text end) as "f1.6.1",max(case when linkid = 'f1.7.1' then answer_value_text end) as "f1.7.1",max(case when linkid = 'f1.8.1' then answer_value_text end) as "f1.8.1",max(case when linkid = 'f1.9.1' then answer_value_text end) as "f1.9.1",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'show-pcl-5-to-8-questions' then answer_value_text end) as "show-pcl-5-to-8-questions",max(case when linkid = 'task-id-common-mental-pdf' then answer_value_text end) as "task-id-common-mental-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:43.769788 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:43.770041 [debug] [Thread-1 (]: SQL status: SELECT 23 in 0.770 seconds
[0m09:28:43.771683 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:28:43.771890 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.816 seconds
[0m09:28:43.772059 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:43.772991 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:28:43.773246 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp" rename to "qr_confidential_s1"
[0m09:28:43.774024 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:28:43.775463 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:28:43.775885 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp" rename to "qr_common_mental_health_symptoms"
[0m09:28:43.776250 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m09:28:43.776515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:43.776729 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_financial_wellness_tool
[0m09:28:43.776934 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:43.779543 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:28:43.780352 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:28:43.821420 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:28:43.822286 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:28:43.822608 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:28:43.823224 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:28:43.823426 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:28:43.823739 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:28:43.824064 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:28:43.824325 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m09:28:43.824549 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:28:43.824818 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: BEGIN
[0m09:28:43.825556 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:43.825778 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:28:43.825976 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:43.826226 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- 1 month follow up with readable column names
-- Questionnaire ID: 1-month-follow-up
-- Source file: questionnaire/1-month-follow-up.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'completed-all-recommended-interventions' then answer_value_text end) as "completed-all-recommended-interventions",max(case when linkid = 'schedule-this-meeting' then answer_value_text end) as "schedule-this-meeting"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:43.826461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:43.826659 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:43.828004 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup"
[0m09:28:43.828283 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:28:43.829549 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup"
[0m09:28:43.829984 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:28:43.830386 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Financial Wellness Tool with readable column names
-- Questionnaire ID: q-financial-wellness-tool
-- Source file: questionnaire/assessments/financial-wellness-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '21234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_there_a_time_when_you_or",max(case when linkid = '31234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo",max(case when linkid = '3456789a-bcde-f012-3456-789abcdef012' then answer_value_text end) as "financial_how_hard_is_it_for_you_to_pay_for_the_very_basics_",max(case when linkid = '51234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_how_strongly_do_you_agree_or_disagree_with_the_fol",max(case when linkid = '61234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_move_in_with_other_p",max(case when linkid = '6789abcd-ef01-2345-6789-abcdef012345' then answer_value_text end) as "financial_in_the_past_12_months_how_often_did_you_run_out_of",max(case when linkid = '91234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_stay_at_a_shelter_in",max(case when linkid = 'c1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo_8",max(case when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab' then answer_value_text end) as "financial_i_worried_whether_my_food_would_run_out_before_i_g",max(case when linkid = 'f0123456-789a-bcde-f012-3456789abcde' then answer_value_text end) as "financial_the_food_that_i_bought_just_didnt_last_and_i_didnt",max(case when linkid = 'f1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_your_phone_gas_heating_w",max(case when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d' then answer_value_text end) as "financial_when_you_think_about_your_financial_situation_how_",max(case when linkid = 'high-debt' then answer_value_text end) as "high-debt",max(case when linkid = 'high-food-insecurity' then answer_value_text end) as "high-food-insecurity",max(case when linkid = 'high-housing-insecurity' then answer_value_text end) as "high-housing-insecurity",max(case when linkid = 'high-paying-bills' then answer_value_text end) as "high-paying-bills",max(case when linkid = 'moderate-debt' then answer_value_text end) as "moderate-debt",max(case when linkid = 'moderate-food-insecurity' then answer_value_text end) as "moderate-food-insecurity",max(case when linkid = 'moderate-housing-insecurity' then answer_value_text end) as "moderate-housing-insecurity",max(case when linkid = 'moderate-medical-hardships' then answer_value_text end) as "moderate-medical-hardships",max(case when linkid = 'moderate-paying-bills' then answer_value_text end) as "moderate-paying-bills",max(case when linkid = 'no-financial-hardship' then answer_value_text end) as "no-financial-hardship",max(case when linkid = 'overall-financial-hardship' then answer_value_text end) as "overall-financial-hardship"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:43.830750 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:43.831024 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:28:43.831263 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup" cascade
[0m09:28:43.832991 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:28:43.833243 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup" cascade
[0m09:28:43.833476 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m09:28:43.833866 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:43.834631 [debug] [Thread-2 (]: On model.engage_analytics.qr_confidential_s1: Close
[0m09:28:43.834838 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:43.835037 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:43.835251 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:43.835571 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098046b0>]}
[0m09:28:43.836405 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:28:43.837125 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: Close
[0m09:28:43.838819 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:28:43.839461 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:28:43.839829 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7e5a0>]}
[0m09:28:43.840046 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp" rename to "qr_financial_wellness_tool"
[0m09:28:43.840289 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:28:43.841716 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:43.841974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:43.843357 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m09:28:43.844448 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:28:43.844776 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:28:43.844985 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:28:43.845174 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m09:28:43.845358 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:28:43.846031 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:43.846724 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m09:28:43.846917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:43.848121 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup"
[0m09:28:43.848417 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:28:43.848709 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f58e00>]}
[0m09:28:43.848932 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup" cascade
[0m09:28:43.849578 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:43.850203 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: Close
[0m09:28:43.850451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099731a0>]}
[0m09:28:44.121838 [debug] [Thread-2 (]: An error was encountered while trying to send an event
[0m09:28:44.122973 [info ] [Thread-3 (]: 24 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 0.90s]
[0m09:28:44.123797 [info ] [Thread-4 (]: 23 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 0.90s]
[0m09:28:44.124950 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:28:44.124420 [info ] [Thread-2 (]: 25 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [[32mCREATE VIEW[0m in 0.86s]
[0m09:28:44.125311 [info ] [Thread-1 (]: 26 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [[32mCREATE VIEW[0m in 0.85s]
[0m09:28:44.126133 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m09:28:44.126590 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_gad_7_s1
[0m09:28:44.127097 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_confidential_s1
[0m09:28:44.128690 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_gad_7_s3
[0m09:28:44.128001 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_gad_7_s2
[0m09:28:44.128322 [info ] [Thread-3 (]: 27 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [RUN]
[0m09:28:44.129052 [info ] [Thread-2 (]: 29 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [RUN]
[0m09:28:44.127597 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_financial_wellness_tool
[0m09:28:44.129459 [info ] [Thread-4 (]: 28 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [RUN]
[0m09:28:44.129914 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_common_mental_health_symptoms, now model.engage_analytics.qr_gad_7_s1)
[0m09:28:44.130175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_confidential_s1, now model.engage_analytics.qr_gad_7_s3)
[0m09:28:44.130758 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_gad_7_s4
[0m09:28:44.131016 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_gad_7_s2)
[0m09:28:44.131276 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_gad_7_s1
[0m09:28:44.131496 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_gad_7_s3
[0m09:28:44.132126 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_gad_7_s2
[0m09:28:44.135556 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:28:44.131865 [info ] [Thread-1 (]: 30 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [RUN]
[0m09:28:44.141393 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:28:44.144690 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:28:44.145014 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:44.145409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_financial_wellness_tool, now model.engage_analytics.qr_gad_7_s4)
[0m09:28:44.145731 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:44.145979 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:44.146183 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:44.146573 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_gad_7_s4
[0m09:28:44.146870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:44.147105 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:44.150309 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:28:44.150886 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:44.151173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:44.754569 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.607 seconds
[0m09:28:44.757489 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s2"
[0m09:28:44.758040 [debug] [Thread-3 (]: SQL status: SELECT 18 in 0.612 seconds
[0m09:28:44.759616 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s1"
[0m09:28:44.760210 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_gad_7_s2
[0m09:28:44.762227 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s2"
[0m09:28:44.762523 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_gad_7_s1
[0m09:28:44.762864 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.616 seconds
[0m09:28:44.764592 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s1"
[0m09:28:44.764823 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.614 seconds
[0m09:28:44.765789 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s3"
[0m09:28:44.766694 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s4"
[0m09:28:44.766950 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:28:44.767267 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:28:44.767474 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s2: BEGIN
[0m09:28:44.767730 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: BEGIN
[0m09:28:44.767975 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_gad_7_s4
[0m09:28:44.768208 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_gad_7_s3
[0m09:28:44.769916 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s4"
[0m09:28:44.770166 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:44.771729 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s3"
[0m09:28:44.771933 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m09:28:44.772204 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:28:44.772521 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:28:44.772833 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 1) with readable column names
-- Questionnaire ID: 202
-- Source file: questionnaire/ipc-session-1/gad-7-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9' then answer_value_text end) as "ipc_s1_taskid_gad_pdf",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_gad7_session_1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s1_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s1_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s1_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s1_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s1_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s1_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s1_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_gad7_session_1_score",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s1_score_meaning_13",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:44.773233 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:28:44.773538 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 2) with readable column names
-- Questionnaire ID: 205
-- Source file: questionnaire/ipc-session-2/gad-7-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_gad7_session_2",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s2_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s2_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s2_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s2_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s2_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s2_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s2_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_gad7_session_2_score",max(case when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s2_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:44.773922 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:28:44.774182 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: BEGIN
[0m09:28:44.774457 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s3: BEGIN
[0m09:28:44.775101 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:44.775325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:44.775530 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:28:44.775751 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:28:44.776042 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 3) with readable column names
-- Questionnaire ID: 59
-- Source file: questionnaire/ipc-session-3/gad-7-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s3_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s3_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s3_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s3_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s3_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s3_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s3_q7_afraid",max(case when linkid = '534c4998-b964-4101-b919-ff3c26af9714' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s3_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:44.776452 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 4) with readable column names
-- Questionnaire ID: 62
-- Source file: questionnaire/ipc-session-4/gad-7-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s4_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s4_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s4_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s4_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s4_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s4_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s4_q7_afraid",max(case when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = 'e4155e07-1d18-448f-8111-182bf4149672' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s4_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:44.776722 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:44.776888 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:44.778714 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:28:44.780856 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:28:44.781126 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:44.781386 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:44.781592 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp" rename to "qr_gad_7_s2"
[0m09:28:44.781817 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp" rename to "qr_gad_7_s1"
[0m09:28:44.783474 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:28:44.785907 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:28:44.786302 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp" rename to "qr_gad_7_s4"
[0m09:28:44.786579 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp" rename to "qr_gad_7_s3"
[0m09:28:44.787077 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:44.787377 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:44.788196 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:28:44.788402 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:44.788595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:44.789357 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:28:44.789592 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:28:44.790274 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:28:44.791074 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:28:44.791313 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:28:44.791507 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:28:44.791797 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:28:44.792152 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:28:44.792433 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:28:44.792737 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:28:44.792988 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:28:44.793354 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:44.794831 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup"
[0m09:28:44.795093 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:44.795299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:44.795493 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:44.795782 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:28:44.797077 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup"
[0m09:28:44.798400 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup"
[0m09:28:44.799453 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup"
[0m09:28:44.799692 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup" cascade
[0m09:28:44.800150 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:28:44.800599 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:28:44.800945 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:28:44.801242 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup" cascade
[0m09:28:44.801483 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup" cascade
[0m09:28:44.801716 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:44.801925 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup" cascade
[0m09:28:44.802789 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s2: Close
[0m09:28:44.803050 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:44.803294 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:44.803785 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba7f80>]}
[0m09:28:44.804052 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:44.804897 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s4: Close
[0m09:28:44.805823 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s3: Close
[0m09:28:44.806231 [info ] [Thread-4 (]: 28 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [[32mCREATE VIEW[0m in 0.67s]
[0m09:28:44.806967 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s1: Close
[0m09:28:44.807383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa4c80>]}
[0m09:28:44.807704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff7ce0>]}
[0m09:28:44.807997 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_gad_7_s2
[0m09:28:44.808465 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7a390>]}
[0m09:28:44.808820 [info ] [Thread-2 (]: 29 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [[32mCREATE VIEW[0m in 0.68s]
[0m09:28:44.809162 [info ] [Thread-1 (]: 30 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [[32mCREATE VIEW[0m in 0.66s]
[0m09:28:44.809454 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_mood_rating_s1
[0m09:28:44.809772 [info ] [Thread-3 (]: 27 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [[32mCREATE VIEW[0m in 0.68s]
[0m09:28:44.810087 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_gad_7_s3
[0m09:28:44.810470 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_gad_7_s4
[0m09:28:44.810789 [info ] [Thread-4 (]: 31 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [RUN]
[0m09:28:44.811239 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_gad_7_s1
[0m09:28:44.811486 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_mood_rating_s2
[0m09:28:44.811762 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_mood_rating_s3
[0m09:28:44.812114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s2, now model.engage_analytics.qr_mood_rating_s1)
[0m09:28:44.812444 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_mood_rating_s4
[0m09:28:44.812765 [info ] [Thread-2 (]: 32 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [RUN]
[0m09:28:44.813054 [info ] [Thread-1 (]: 33 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [RUN]
[0m09:28:44.813317 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_mood_rating_s1
[0m09:28:44.813537 [info ] [Thread-3 (]: 34 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [RUN]
[0m09:28:44.813764 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s3, now model.engage_analytics.qr_mood_rating_s2)
[0m09:28:44.814104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s4, now model.engage_analytics.qr_mood_rating_s3)
[0m09:28:44.816870 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:28:44.817137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s1, now model.engage_analytics.qr_mood_rating_s4)
[0m09:28:44.817552 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_mood_rating_s2
[0m09:28:44.817921 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_mood_rating_s3
[0m09:28:44.818143 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:44.818335 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_mood_rating_s4
[0m09:28:44.821296 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:28:44.825247 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:28:44.825489 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:44.827702 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:28:44.828075 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:44.828426 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:44.828772 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:44.829001 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:44.829229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:44.829448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:45.413646 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.588 seconds
[0m09:28:45.417445 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:28:45.418143 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.589 seconds
[0m09:28:45.418616 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.589 seconds
[0m09:28:45.418941 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.590 seconds
[0m09:28:45.419978 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:28:45.420711 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:28:45.421536 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:28:45.422010 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_mood_rating_s1
[0m09:28:45.423825 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:28:45.424102 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_mood_rating_s4
[0m09:28:45.425935 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:28:45.426311 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_mood_rating_s2
[0m09:28:45.426534 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_mood_rating_s3
[0m09:28:45.428599 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:28:45.429023 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:28:45.430758 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:28:45.431008 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:28:45.431242 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s1: BEGIN
[0m09:28:45.431498 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: BEGIN
[0m09:28:45.431822 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:28:45.432044 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: BEGIN
[0m09:28:45.432330 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:28:45.432603 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:45.432838 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:45.433049 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: BEGIN
[0m09:28:45.433254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:45.433473 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:28:45.433681 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:28:45.433922 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:28:45.434199 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 1) with readable column names
-- Questionnaire ID: 203
-- Source file: questionnaire/ipc-session-1/mood-rating-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "mood_s1_8085cded8e0f497f9e3d5fab3981d727",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "mood_s1_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:45.434464 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:45.434712 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 4) with readable column names
-- Questionnaire ID: 209
-- Source file: questionnaire/ipc-session-4/mood-rating-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990' then answer_value_text end) as "mood_s4_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:45.435034 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 3) with readable column names
-- Questionnaire ID: 207
-- Source file: questionnaire/ipc-session-3/mood-rating-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "mood_s3_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:45.435331 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:28:45.435648 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 2) with readable column names
-- Questionnaire ID: 206
-- Source file: questionnaire/ipc-session-2/mood-rating-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "mood_s2_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:45.437651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:45.437895 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:45.438092 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:45.438271 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:45.439932 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:28:45.441379 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:28:45.442743 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:28:45.445261 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:28:45.445545 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp" rename to "qr_mood_rating_s3"
[0m09:28:45.445815 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp" rename to "qr_mood_rating_s1"
[0m09:28:45.446087 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp" rename to "qr_mood_rating_s4"
[0m09:28:45.446483 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp" rename to "qr_mood_rating_s2"
[0m09:28:45.447702 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:45.447918 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:45.448133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:45.448325 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:45.448987 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:28:45.449737 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:28:45.450466 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:28:45.451048 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:28:45.451239 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:28:45.451466 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:28:45.451896 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:28:45.452398 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:28:45.452657 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:28:45.452873 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:28:45.453097 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:28:45.453308 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:28:45.454348 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:45.455749 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup"
[0m09:28:45.455960 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:45.456283 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:28:45.456482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:28:45.456690 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:28:45.457841 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup"
[0m09:28:45.458065 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup" cascade
[0m09:28:45.459274 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup"
[0m09:28:45.460605 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup"
[0m09:28:45.460963 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:28:45.461296 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:28:45.461674 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:28:45.461965 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:45.462176 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup" cascade
[0m09:28:45.462415 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup" cascade
[0m09:28:45.462640 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup" cascade
[0m09:28:45.463393 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s1: Close
[0m09:28:45.463890 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5d250>]}
[0m09:28:45.464155 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:45.464424 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:45.464658 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:45.465826 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s2: Close
[0m09:28:45.465016 [info ] [Thread-4 (]: 31 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [[32mCREATE VIEW[0m in 0.65s]
[0m09:28:45.466639 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: Close
[0m09:28:45.467301 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: Close
[0m09:28:45.467735 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_mood_rating_s1
[0m09:28:45.468062 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5f320>]}
[0m09:28:45.468399 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109805670>]}
[0m09:28:45.468707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e43650>]}
[0m09:28:45.468940 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_mw_tool
[0m09:28:45.469340 [info ] [Thread-2 (]: 32 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [[32mCREATE VIEW[0m in 0.65s]
[0m09:28:45.469939 [info ] [Thread-3 (]: 34 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [[32mCREATE VIEW[0m in 0.65s]
[0m09:28:45.470451 [info ] [Thread-1 (]: 33 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [[32mCREATE VIEW[0m in 0.65s]
[0m09:28:45.470867 [info ] [Thread-4 (]: 35 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [RUN]
[0m09:28:45.471180 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_mood_rating_s2
[0m09:28:45.471442 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_mood_rating_s4
[0m09:28:45.471695 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_mood_rating_s3
[0m09:28:45.471968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s1, now model.engage_analytics.qr_mw_tool)
[0m09:28:45.472204 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:28:45.472443 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_phq_9_s1
[0m09:28:45.472730 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_phq_9_s2
[0m09:28:45.472962 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_mw_tool
[0m09:28:45.473254 [info ] [Thread-2 (]: 36 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [RUN]
[0m09:28:45.473573 [info ] [Thread-3 (]: 37 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [RUN]
[0m09:28:45.474089 [info ] [Thread-1 (]: 38 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [RUN]
[0m09:28:45.477308 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:28:45.477677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s2, now model.engage_analytics.qr_mw_tool_ipc_session_4)
[0m09:28:45.477986 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s4, now model.engage_analytics.qr_phq_9_s1)
[0m09:28:45.478216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s3, now model.engage_analytics.qr_phq_9_s2)
[0m09:28:45.478475 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:45.478705 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:28:45.478947 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_phq_9_s1
[0m09:28:45.479273 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_phq_9_s2
[0m09:28:45.479580 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:45.482639 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:28:45.486121 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:28:45.489105 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:28:45.489517 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

    
    with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:45.489746 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:45.490018 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:45.490254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:45.490483 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:45.490678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:46.103197 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.612 seconds
[0m09:28:46.103966 [debug] [Thread-4 (]: SQL status: SELECT 37 in 0.624 seconds
[0m09:28:46.105198 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s1"
[0m09:28:46.106207 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool"
[0m09:28:46.106436 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.616 seconds
[0m09:28:46.106690 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.616 seconds
[0m09:28:46.107699 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:28:46.108477 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s2"
[0m09:28:46.108877 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_phq_9_s1
[0m09:28:46.111933 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s1"
[0m09:28:46.112207 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_mw_tool
[0m09:28:46.112514 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:28:46.114020 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool"
[0m09:28:46.115739 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:28:46.116211 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:28:46.116461 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_phq_9_s2
[0m09:28:46.116817 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: BEGIN
[0m09:28:46.118706 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s2"
[0m09:28:46.118962 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:28:46.119224 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:28:46.119516 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool: BEGIN
[0m09:28:46.119766 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:46.120013 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: BEGIN
[0m09:28:46.120310 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:28:46.120708 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:28:46.121037 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 1) with readable column names
-- Questionnaire ID: 54
-- Source file: questionnaire/ipc-session-1/phq-9-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.3.1' then answer_value_text end) as "phq9_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "phq9_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "phq9_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "phq9_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "phq9_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "phq9_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "phq9_q7_concentration",max(case when linkid = 'f1.10.1' then answer_value_text end) as "phq9_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "phq9_q9_suicide",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "phq9_total_score",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "phq9_score_meaning",max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as "phq9_score_meaning_code",max(case when linkid = 'encounter-id' then answer_value_text end) as "phq9_encounter_id",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "phq9_observation_id",max(case when linkid = 'calculated-month' then answer_value_text end) as "phq9_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "phq9_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "phq9_field_cd8e3d6d",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as "phq9_task_id",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "phq9_field_9c366bcc",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "phq9_field_b5bc7f80",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "phq9_link_encounter"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:46.121358 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:46.121592 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:46.121804 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: BEGIN
[0m09:28:46.122091 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:28:46.122300 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:28:46.122700 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool with readable column names
-- Questionnaire ID: 1613532
-- Source file: questionnaire/assessments/mw-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "mental_in_the_past_year_have_you_ever_felt_that_your_thou",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "mental_in_the_past_year_how_often_do_you_have_a_drink_con",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "mental_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "mental_in_the_past_year_did_you_at_any_time_hear_voices_s",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "mental_q2_depressed",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "mental_in_the_past_year_how_many_times_have_you_used_a_re",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "mental_in_the_past_year_how_many_drinks_containing_alcoho",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "mental_in_the_past_3_months_have_you_ever_done_anything_s",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "mental_q1_anxious",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "mental_in_the_past_month_have_you_had_any_actual_thoughts",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "mental_q5_restless",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe_13",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "mental_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "mental_supervisors_name",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "mental_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "mental_referral_details_if_the_client_is_referred_out",max(case when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29' then answer_value_text end) as "retake_screening",max(case when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f' then answer_value_text end) as "retake_screening_19",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'q1-to-q3-negative' then answer_value_text end) as "q1-to-q3-negative",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-common-mental-health-form' then answer_value_text end) as "task-id-common-mental-health-form",max(case when linkid = 'task-id-mwtool-pdf' then answer_value_text end) as "task-id-mwtool-pdf",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:46.123078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:46.123436 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool Session 4 with readable column names
-- Questionnaire ID: mw-tool-ipc-session-4
-- Source file: questionnaire/assessments/mw-tool-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_s",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "in_the_past_year_have_you_ever_felt_that_your_thoughts_were",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "in_the_past_year_how_often_do_you_have_a_drink_containing_a",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "in_the_past_month_have_you_wished_you_were_dead_or_wished_y",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "in_the_past_year_did_you_at_any_time_hear_voices_saying_qui",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_down_d",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "in_the_past_year_how_many_times_have_you_used_a_recreationa",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "in_the_past_year_how_many_drinks_containing_alcohol_do_you",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "in_the_past_3_months_have_you_ever_done_anything_started_t",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_nervous",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "in_the_past_month_have_you_had_any_actual_thoughts_of_killi",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_so_restless_tha",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_a",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-mw-tool-ipc-s4-pdf' then answer_value_text end) as "task-id-mw-tool-ipc-s4-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:46.123888 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:28:46.124240 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 2) with readable column names
-- Questionnaire ID: 57
-- Source file: questionnaire/ipc-session-2/phq-9-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_phq9_session_2",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s2_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s2_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s2_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s2_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s2_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s2_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s2_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s2_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s2_q7_concentration",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_phq9_session_2_score",max(case when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'a07491bd-039d-417b-9caf-0af536316594' then answer_value_text end) as "ipc_s2_score_meaning_14"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:46.124847 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:46.126409 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:28:46.126606 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp" rename to "qr_phq_9_s1"
[0m09:28:46.127096 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:46.127295 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:46.128784 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:28:46.129027 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:28:46.129261 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:46.130708 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:28:46.130918 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp" rename to "qr_phq_9_s2"
[0m09:28:46.132575 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:28:46.133212 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:28:46.133420 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp" rename to "qr_mw_tool"
[0m09:28:46.133704 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp" rename to "qr_mw_tool_ipc_session_4"
[0m09:28:46.133930 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:28:46.134190 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:28:46.134376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:46.135040 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:28:46.135336 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:28:46.135517 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:28:46.135717 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:46.135930 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:46.136145 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:46.136912 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:28:46.139029 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup"
[0m09:28:46.139274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:28:46.140001 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:28:46.140234 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:28:46.140557 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:28:46.141786 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup"
[0m09:28:46.141994 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:28:46.142180 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:28:46.142366 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup" cascade
[0m09:28:46.142638 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:28:46.142822 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:28:46.143096 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup" cascade
[0m09:28:46.143524 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:46.144334 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: Close
[0m09:28:46.144570 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:46.144804 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:46.145023 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:46.145337 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbb500>]}
[0m09:28:46.146690 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup"
[0m09:28:46.147413 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: Close
[0m09:28:46.148641 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup"
[0m09:28:46.149410 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:28:46.149097 [info ] [Thread-3 (]: 37 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [[32mCREATE VIEW[0m in 0.67s]
[0m09:28:46.149800 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:28:46.150073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec1b50>]}
[0m09:28:46.150290 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup" cascade
[0m09:28:46.150579 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_phq_9_s1
[0m09:28:46.150777 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup" cascade
[0m09:28:46.151109 [info ] [Thread-1 (]: 38 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [[32mCREATE VIEW[0m in 0.67s]
[0m09:28:46.151419 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_phq_9_s3
[0m09:28:46.151771 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_phq_9_s2
[0m09:28:46.151999 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:46.152457 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:46.152255 [info ] [Thread-3 (]: 39 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [RUN]
[0m09:28:46.152798 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_phq_9_s4
[0m09:28:46.153628 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: Close
[0m09:28:46.154416 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool: Close
[0m09:28:46.154686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s1, now model.engage_analytics.qr_phq_9_s3)
[0m09:28:46.154996 [info ] [Thread-1 (]: 40 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [RUN]
[0m09:28:46.155337 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_phq_9_s3
[0m09:28:46.155627 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec2ff0>]}
[0m09:28:46.155962 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3a4e0>]}
[0m09:28:46.156204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s2, now model.engage_analytics.qr_phq_9_s4)
[0m09:28:46.159346 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:28:46.159859 [info ] [Thread-4 (]: 35 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [[32mCREATE VIEW[0m in 0.68s]
[0m09:28:46.160400 [info ] [Thread-2 (]: 36 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [[32mCREATE VIEW[0m in 0.68s]
[0m09:28:46.160735 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_phq_9_s4
[0m09:28:46.160975 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:46.161222 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_mw_tool
[0m09:28:46.161559 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:28:46.164043 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:28:46.164256 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:46.164463 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_planning_next_steps
[0m09:28:46.164753 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_registration_info
[0m09:28:46.165019 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:46.165447 [info ] [Thread-4 (]: 41 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [RUN]
[0m09:28:46.165874 [info ] [Thread-2 (]: 42 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [RUN]
[0m09:28:46.166359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:46.166681 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool, now model.engage_analytics.qr_planning_next_steps)
[0m09:28:46.166953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool_ipc_session_4, now model.engage_analytics.qr_registration_info)
[0m09:28:46.167323 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_planning_next_steps
[0m09:28:46.167552 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_registration_info
[0m09:28:46.170122 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:28:46.172676 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:28:46.172958 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:46.173231 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:46.173487 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:46.173712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:46.750527 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.586 seconds
[0m09:28:46.753837 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s3"
[0m09:28:46.754407 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.588 seconds
[0m09:28:46.755758 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s4"
[0m09:28:46.756272 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_phq_9_s3
[0m09:28:46.758336 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s3"
[0m09:28:46.758660 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.585 seconds
[0m09:28:46.758948 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_phq_9_s4
[0m09:28:46.759943 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info"
[0m09:28:46.760192 [debug] [Thread-4 (]: SQL status: SELECT 66 in 0.587 seconds
[0m09:28:46.763056 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s4"
[0m09:28:46.764625 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_planning_next_steps"
[0m09:28:46.765001 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:28:46.765419 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: BEGIN
[0m09:28:46.765654 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_registration_info
[0m09:28:46.765940 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:28:46.767659 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info"
[0m09:28:46.767899 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:46.768078 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: BEGIN
[0m09:28:46.768329 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_planning_next_steps
[0m09:28:46.768511 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:28:46.768793 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:28:46.770476 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_planning_next_steps"
[0m09:28:46.770738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:46.771020 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 3) with readable column names
-- Questionnaire ID: 61
-- Source file: questionnaire/ipc-session-3/phq-9-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s3_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s3_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s3_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s3_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s3_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s3_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s3_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s3_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s3_q7_concentration",max(case when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9' then answer_value_text end) as "ipc_s3_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:46.771309 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: BEGIN
[0m09:28:46.771551 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:28:46.771940 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 4) with readable column names
-- Questionnaire ID: 211
-- Source file: questionnaire/ipc-session-4/phq-9-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "ipc_s4_how_difficult_have_these_problems_made_it_for_you_",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s4_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s4_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s4_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s4_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s4_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s4_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s4_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s4_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s4_q7_concentration",max(case when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792' then answer_value_text end) as "ipc_s4_score_meaning_13"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:46.772247 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:46.772487 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:28:46.772811 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Add Family Member Registration with readable column names
-- Questionnaire ID: 221
-- Source file: questionnaire/generic/registration_info.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff' then answer_value_text end) as "registration_36d39dbe00e24e29f0793ec8f0119aff",max(case when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd' then answer_value_text end) as "registration_middle_name",max(case when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271' then answer_value_text end) as "registration_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7' then answer_value_text end) as "registration_age",max(case when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d' then answer_value_text end) as "registration_surname",max(case when linkid = 'age' then answer_value_text end) as "registration_age_6",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "registration_calculated_age",max(case when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f' then answer_value_text end) as "registration_unique_id",max(case when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0' then answer_value_text end) as "registration_has_this_person_received_engage_services_in_the_pa",max(case when linkid = 'calculated-month' then answer_value_text end) as "registration_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "registration_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "registration_date_of_birth_dob",max(case when linkid = 'e6306275-b989-4375-8527-3a56092081b8' then answer_value_text end) as "registration_first_name",max(case when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd' then answer_value_text end) as "registration_what_was_your_biological_sex_assigned_at_birth",max(case when linkid = 'choice-gender-identity' then answer_value_text end) as "choice-gender-identity",max(case when linkid = 'choice-pronouns' then answer_value_text end) as "choice-pronouns",max(case when linkid = 'do-you-have-medicaid' then answer_value_text end) as "do-you-have-medicaid",max(case when linkid = 'email-address' then answer_value_text end) as "email-address",max(case when linkid = 'medicaid-number' then answer_value_text end) as "medicaid-number",max(case when linkid = 'other-best-represents-how-you-think-of-yourself' then answer_value_text end) as "other-best-represents-how-you-think-of-yourself",max(case when linkid = 'other-biological-sex-at-birth' then answer_value_text end) as "other-biological-sex-at-birth",max(case when linkid = 'other-gender-identity' then answer_value_text end) as "other-gender-identity",max(case when linkid = 'other-pronouns' then answer_value_text end) as "other-pronouns",max(case when linkid = 'other-where-did-you-first-learn-about-engage' then answer_value_text end) as "other-where-did-you-first-learn-about-engage",max(case when linkid = 'phone-number' then answer_value_text end) as "phone-number",max(case when linkid = 'physical-address' then answer_value_text end) as "physical-address",max(case when linkid = 'where-did-you-first-learn-about-engage' then answer_value_text end) as "where-did-you-first-learn-about-engage",max(case when linkid = 'zip-code' then answer_value_text end) as "zip-code"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:46.773163 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:28:46.773384 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: BEGIN
[0m09:28:46.773920 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:46.774089 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:28:46.774488 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Planning Next Steps with readable column names
-- Questionnaire ID: q-planning-next-steps
-- Source file: questionnaire/assessments/planning-next-steps.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7' then answer_value_text end) as "referral_to_mental_health_specialist",max(case when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7' then answer_value_text end) as "referred",max(case when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f' then answer_value_text end) as "okay",max(case when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d' then answer_value_text end) as "field_2cb66889",max(case when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6' then answer_value_text end) as "field_34a56c28",max(case when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9' then answer_value_text end) as "referres",max(case when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01' then answer_value_text end) as "field_34ab6c28",max(case when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d' then answer_value_text end) as "field_3b9f7e5d",max(case when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f' then answer_value_text end) as "sbirt_motivational_interviewing",max(case when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7' then answer_value_text end) as "safety",max(case when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123' then answer_value_text end) as "others",max(case when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae' then answer_value_text end) as "mental_health",max(case when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345' then answer_value_text end) as "not_interested",max(case when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf' then answer_value_text end) as "20250924",max(case when linkid = '69712544-6237-4962-a455-ee6e9ee80000' then answer_value_text end) as "field_69712544",max(case when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e' then answer_value_text end) as "field_76ba8dbe",max(case when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574' then answer_value_text end) as "hh",max(case when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106' then answer_value_text end) as "20260505",max(case when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d' then answer_value_text end) as "field_9a8b7c6d",max(case when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d' then answer_value_text end) as "sbirt_motivational_interviewingbrspan_stylecolor006",max(case when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab' then answer_value_text end) as "field_ab12d39f",max(case when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e' then answer_value_text end) as "they_gtycyvuy",max(case when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e' then answer_value_text end) as "field_b2c3d4e5",max(case when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc' then answer_value_text end) as "test",max(case when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e' then answer_value_text end) as "field_bc2def4a",max(case when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f' then answer_value_text end) as "field_c3d4e5f6",max(case when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4' then answer_value_text end) as "field_c9d8b7a6",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd' then answer_value_text end) as "not_interested_28",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f' then answer_value_text end) as "field_cd34f5b1",max(case when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f' then answer_value_text end) as "iwbwb",max(case when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a' then answer_value_text end) as "needs_checkups",max(case when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a' then answer_value_text end) as "hhh",max(case when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90' then answer_value_text end) as "20250827",max(case when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7' then answer_value_text end) as "referral_to_mental_health_specialist_34",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b' then answer_value_text end) as "already_received_a_similar_service",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4' then answer_value_text end) as "field_ef5617d3",max(case when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5' then answer_value_text end) as "peace",max(case when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100' then answer_value_text end) as "interested_but_not_now",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g' then answer_value_text end) as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g",max(case when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h' then answer_value_text end) as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h",max(case when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i' then answer_value_text end) as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i",max(case when linkid = 'financial-hardships-list' then answer_value_text end) as "financial-hardships-list",max(case when linkid = 'is-fws' then answer_value_text end) as "is-fws",max(case when linkid = 'is-ipc' then answer_value_text end) as "is-ipc",max(case when linkid = 'is-ipc-main' then answer_value_text end) as "is-ipc-main",max(case when linkid = 'is-ipc-optional' then answer_value_text end) as "is-ipc-optional",max(case when linkid = 'is-mhs' then answer_value_text end) as "is-mhs",max(case when linkid = 'is-other-agency-services' then answer_value_text end) as "is-other-agency-services",max(case when linkid = 'is-other-services-outside-agency' then answer_value_text end) as "is-other-services-outside-agency",max(case when linkid = 'is-sbirt' then answer_value_text end) as "is-sbirt",max(case when linkid = 'is-sbirt-main' then answer_value_text end) as "is-sbirt-main",max(case when linkid = 'is-sbirt-optional' then answer_value_text end) as "is-sbirt-optional",max(case when linkid = 'is-spi' then answer_value_text end) as "is-spi",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'scheduled-ipc-session-1-with-current-time' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time",max(case when linkid = 'scheduled-ipc-session-1-with-current-time-2' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time-2",max(case when linkid = 'task-id-000' then answer_value_text end) as "task-id-000",max(case when linkid = 'task-id-001' then answer_value_text end) as "task-id-001",max(case when linkid = 'task-id-002' then answer_value_text end) as "task-id-002",max(case when linkid = 'task-id-003' then answer_value_text end) as "task-id-003",max(case when linkid = 'task-id-004' then answer_value_text end) as "task-id-004",max(case when linkid = 'task-id-006' then answer_value_text end) as "task-id-006",max(case when linkid = 'task-id-planning-next-steps-pdf' then answer_value_text end) as "task-id-planning-next-steps-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:46.774928 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:46.775135 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:46.776827 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:28:46.777048 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:46.778582 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:28:46.778795 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp" rename to "qr_phq_9_s3"
[0m09:28:46.780217 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:28:46.780434 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:28:46.780600 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp" rename to "qr_phq_9_s4"
[0m09:28:46.780837 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp" rename to "qr_registration_info"
[0m09:28:46.782389 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:28:46.782621 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:46.782891 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp" rename to "qr_planning_next_steps"
[0m09:28:46.783564 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:28:46.783787 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:46.783994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:46.784249 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:28:46.784925 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:28:46.785563 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:28:46.785784 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:46.785965 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:28:46.786189 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:28:46.786426 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:28:46.787073 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:28:46.787338 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:28:46.787548 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:28:46.787755 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:28:46.788015 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:28:46.788355 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:46.789545 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup"
[0m09:28:46.789806 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:28:46.789988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:46.790170 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:46.790327 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:46.790517 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup" cascade
[0m09:28:46.792512 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup"
[0m09:28:46.793567 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup"
[0m09:28:46.794778 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup"
[0m09:28:46.795188 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:28:46.795451 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:28:46.795642 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:46.795893 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:28:46.796126 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup" cascade
[0m09:28:46.796353 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup" cascade
[0m09:28:46.797090 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s3: Close
[0m09:28:46.797319 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup" cascade
[0m09:28:46.797764 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e604d0>]}
[0m09:28:46.798079 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:46.798298 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:46.798613 [info ] [Thread-3 (]: 39 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:28:46.798848 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:46.799613 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: Close
[0m09:28:46.800300 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: Close
[0m09:28:46.800579 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_phq_9_s3
[0m09:28:46.801188 [debug] [Thread-2 (]: On model.engage_analytics.qr_registration_info: Close
[0m09:28:46.801479 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_remove_patient
[0m09:28:46.801745 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe7ec0>]}
[0m09:28:46.802050 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109806360>]}
[0m09:28:46.802411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec3bf0>]}
[0m09:28:46.802755 [info ] [Thread-3 (]: 43 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [RUN]
[0m09:28:46.803165 [info ] [Thread-4 (]: 41 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [[32mCREATE VIEW[0m in 0.64s]
[0m09:28:46.803621 [info ] [Thread-2 (]: 42 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [[32mCREATE VIEW[0m in 0.64s]
[0m09:28:46.804300 [info ] [Thread-1 (]: 40 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [[32mCREATE VIEW[0m in 0.65s]
[0m09:28:46.804682 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s3, now model.engage_analytics.qr_remove_patient)
[0m09:28:46.805026 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_planning_next_steps
[0m09:28:46.805340 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_registration_info
[0m09:28:46.805591 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_phq_9_s4
[0m09:28:46.805778 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_remove_patient
[0m09:28:46.805977 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sbirt
[0m09:28:46.806196 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:28:46.806548 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:28:46.809588 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:28:46.809982 [info ] [Thread-4 (]: 44 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sbirt .. [RUN]
[0m09:28:46.810233 [info ] [Thread-2 (]: 45 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [RUN]
[0m09:28:46.810556 [info ] [Thread-1 (]: 46 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [RUN]
[0m09:28:46.810866 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:46.811203 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_planning_next_steps, now model.engage_analytics.qr_sbirt)
[0m09:28:46.811469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_registration_info, now model.engage_analytics.qr_sf_pcl_5_s1)
[0m09:28:46.811731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s4, now model.engage_analytics.qr_sf_pcl_5_s2)
[0m09:28:46.811963 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:46.812134 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sbirt
[0m09:28:46.812361 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:28:46.812691 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:28:46.815578 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:28:46.818414 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:28:46.820725 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:28:46.820962 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:46.821260 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:46.821534 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:46.821726 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:46.821939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:46.822214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:47.390862 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.579 seconds
[0m09:28:47.393401 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_remove_patient"
[0m09:28:47.394704 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_remove_patient
[0m09:28:47.397619 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_remove_patient"
[0m09:28:47.398188 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:28:47.398377 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: BEGIN
[0m09:28:47.399174 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:47.399347 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:28:47.399573 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- eCBIS Remove Family Form with readable column names
-- Questionnaire ID: 69
-- Source file: questionnaire/generic/remove_patient.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f' then answer_value_text end) as "remove_family_date_of_death",max(case when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a' then answer_value_text end) as "remove_family_give_other_reasons_for_removal",max(case when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5' then answer_value_text end) as "remove_family_age_at_death_year",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b' then answer_value_text end) as "remove_family_a11ebb0dacb34038956b293a41acb85b",max(case when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1' then answer_value_text end) as "remove_family_date_moved_away",max(case when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff' then answer_value_text end) as "remove_family_reason_for_removal",max(case when linkid = 'patient-birthdate' then answer_value_text end) as "remove_family_patientbirthdate",max(case when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec' then answer_value_text end) as "reason_unknown"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:47.401993 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:47.402294 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.580 seconds
[0m09:28:47.404111 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:28:47.405185 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:28:47.405457 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp" rename to "qr_remove_patient"
[0m09:28:47.405974 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:28:47.408654 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:28:47.408881 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:28:47.409161 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.587 seconds
[0m09:28:47.409873 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:28:47.410723 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:28:47.410946 [debug] [Thread-4 (]: SQL status: SELECT 159 in 0.589 seconds
[0m09:28:47.411211 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:28:47.413380 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sbirt"
[0m09:28:47.413648 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:28:47.413850 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:28:47.414130 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: BEGIN
[0m09:28:47.414325 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:28:47.416133 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:28:47.416361 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:47.416546 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:47.416768 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sbirt
[0m09:28:47.417973 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup"
[0m09:28:47.418223 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:28:47.419992 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sbirt"
[0m09:28:47.420359 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:28:47.420752 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 1) with readable column names
-- Questionnaire ID: 204
-- Source file: questionnaire/ipc-session-1/sf-pcl-5-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505' then answer_value_text end) as "ipc_s1_taskid_ptsd_pdf",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av_8",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ptsd_session_1",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_pcptsd_session_1_score",max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s1_score_meaning_14",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s1_is_ptsd",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:47.421139 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:28:47.421382 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup" cascade
[0m09:28:47.421665 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s2: BEGIN
[0m09:28:47.421894 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:28:47.422071 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: BEGIN
[0m09:28:47.422271 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:47.422945 [debug] [Thread-3 (]: On model.engage_analytics.qr_remove_patient: Close
[0m09:28:47.423124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:47.423302 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:47.423610 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0ce30>]}
[0m09:28:47.423830 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:28:47.424014 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:28:47.424614 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 2) with readable column names
-- Questionnaire ID: 56
-- Source file: questionnaire/ipc-session-2/sf-pcl-5-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ptsd_session_2",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_pcptsd_session_2_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s2_score_meaning_13",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s2_is_ptsd",max(case when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:47.424334 [info ] [Thread-3 (]: 43 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [[32mCREATE VIEW[0m in 0.62s]
[0m09:28:47.424962 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:47.425785 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SBIRT with readable column names
-- Questionnaire ID: 212
-- Source file: questionnaire/sbirt.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_drink_alc",max(case when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t",max(case when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e' then answer_value_text end) as "sbirt_have_you_or_someone_else_been_injured_as_a_result_",max(case when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621' then answer_value_text end) as "sbirt_how_often_do_you_have_six_or_more_drinks_on_one_oc",max(case when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_needed_a_f",max(case when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848' then answer_value_text end) as "sbirt_have_you_ever_experienced_withdrawal_symptoms_felt",max(case when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4' then answer_value_text end) as "sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_o",max(case when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_8",max(case when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_had_a_feel",max(case when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1' then answer_value_text end) as "sbirt_how_many_standard_drinks_containing_alcohol_do_you",max(case when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_been_unabl",max(case when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11' then answer_value_text end) as "sbirt_how_often_do_you_have_a_drink_containing_alcohol",max(case when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4' then answer_value_text end) as "sbirt_have_you_neglected_your_family_because_of_your_use",max(case when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267' then answer_value_text end) as "sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use",max(case when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_15",max(case when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990' then answer_value_text end) as "sbirt_have_you_had_medical_problems_as_a_result_of_your_",max(case when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3' then answer_value_text end) as "sbirt_have_you_ever_used_any_drugs_by_injection_nonmedic",max(case when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c' then answer_value_text end) as "sbirt_have_you_engaged_in_illegal_activities_in_order_to",max(case when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_19",max(case when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_20",max(case when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_failed_to_",max(case when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_22",max(case when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41' then answer_value_text end) as "sbirt_does_your_spouse_or_parents_ever_complain_about_yo",max(case when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_24",max(case when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_25",max(case when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_26",max(case when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9' then answer_value_text end) as "sbirt_are_you_always_able_to_stop_using_drugs_when_you_w",max(case when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_found_that",max(case when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b' then answer_value_text end) as "sbirt_have_you_used_drugs_other_than_those_required_for_",max(case when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88' then answer_value_text end) as "sbirt_has_a_relative_or_friend_or_a_doctor_or_another_he",max(case when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba' then answer_value_text end) as "sbirt_do_you_use_more_than_one_drug_at_a_time",max(case when linkid = '0466b304-2876-409b-ade2-d1c675614854' then answer_value_text end) as "sbirt_please_select_one_substance_you_would_like_to_disc",max(case when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_metha",max(case when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78' then answer_value_text end) as "sbirt_i_would_like_to_offer_an_opportunity_to_start_a_co",max(case when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0' then answer_value_text end) as "sbirt_we_could_start_by_discussing_the_pros_and_cons_of_",max(case when linkid = '39843731-a8e7-4822-bad7-55489947ebeb' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_other",max(case when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_alc",max(case when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_canna",max(case when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_hallu",max(case when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_sedat",max(case when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_inhal",max(case when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_cocai",max(case when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_the",max(case when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491' then answer_value_text end) as "sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_al",max(case when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_presc",max(case when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha",max(case when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_47",max(case when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_48",max(case when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_49",max(case when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_50",max(case when linkid = '8427af19-3bad-4713-bad9-b179437fef96' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_stree",max(case when linkid = '90876967-c973-4bee-9217-8c7482cb12a2' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_52",max(case when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368' then answer_value_text end) as "sbirt_cannabis_marijuana_pot_grass_hash_etc",max(case when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_54",max(case when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_55",max(case when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d' then answer_value_text end) as "sbirt_would_you_be_interested_in_learning_more_about_sub",max(case when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9' then answer_value_text end) as "sbirt_1579996975654c3eb488d6a65d66c6c9",max(case when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812' then answer_value_text end) as "sbirt_things_you_can_do",max(case when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_prescript",max(case when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_methamphe",max(case when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_other_dru",max(case when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_inhalants",max(case when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cannabis_",max(case when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_64",max(case when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3' then answer_value_text end) as "sbirt_what_are_some_good_things_about_staying_the_same",max(case when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848' then answer_value_text end) as "sbirt_street_opioids_heroin_opium_etc_or_prescription_op",max(case when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_hallucino",max(case when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cocaine_l",max(case when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_sedatives",max(case when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509' then answer_value_text end) as "sbirt_what_are_some_good_things_about_making_a_change",max(case when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1' then answer_value_text end) as "sbirt_what_are_your_health_goals_around_substance_use",max(case when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f' then answer_value_text end) as "sbirt_cocaine_coke_crack_etc",max(case when linkid = '1600f791-fd2c-44d8-8384-37973785741b' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed",max(case when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_74",max(case when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_75",max(case when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_76",max(case when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_street_op",max(case when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_78",max(case when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299' then answer_value_text end) as "sbirt_other_drugs",max(case when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_80",max(case when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_81",max(case when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_82",max(case when linkid = 'edced328-6f82-458a-bce4-35987bff19fb' then answer_value_text end) as "sbirt_edced3286f82458abce435987bff19fb",max(case when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19' then answer_value_text end) as "sbirt_can_i_share_additional_treatment_options_with_you",max(case when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre",max(case when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3' then answer_value_text end) as "sbirt_prescription_stimulants_just_for_the_feeling_more_",max(case when linkid = '582271e0-892e-4795-ac55-0b73baf828ca' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_87",max(case when linkid = '654d5688-f42a-469b-8494-81115b760e29' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_88",max(case when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_89",max(case when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_90",max(case when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_91",max(case when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_92",max(case when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_93",max(case when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_94",max(case when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down",max(case when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_96",max(case when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_97",max(case when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_98",max(case when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_99",max(case when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_100",max(case when linkid = 'ad609c63-366e-476a-b131-610ceed211da' then answer_value_text end) as "sbirt_things_others_can_help_you_do",max(case when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_102",max(case when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac' then answer_value_text end) as "sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_e",max(case when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_104",max(case when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_105",max(case when linkid = '6281fa0d-ef3f-4013-bd31-062371828010' then answer_value_text end) as "sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whipp",max(case when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_107",max(case when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe' then answer_value_text end) as "sbirt_sedatives_just_for_the_feeling_more_than_prescribe",max(case when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f' then answer_value_text end) as "sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecs",max(case when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404' then answer_value_text end) as "sbirt_any_other_drugs_to_get_high",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '36af2335-ac86-4864-8a3d-619451160cc5' then answer_value_text end) as "2_times_in_a_day",max(case when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f' then answer_value_text end) as "join_a_community_group_and",max(case when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5' then answer_value_text end) as "therapy",max(case when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528' then answer_value_text end) as "2_days_per_week",max(case when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730' then answer_value_text end) as "field_445adcc0",max(case when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045' then answer_value_text end) as "3_days_per_week",max(case when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb' then answer_value_text end) as "not_ready",max(case when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6' then answer_value_text end) as "quit",max(case when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5' then answer_value_text end) as "20250224",max(case when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3' then answer_value_text end) as "2_times_in_a_day_124",max(case when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d' then answer_value_text end) as "field_859d58d6",max(case when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427' then answer_value_text end) as "field_8a6c4c5b",max(case when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7' then answer_value_text end) as "social_places_you_can_go_to_eg_take_a_walk_at_the_park",max(case when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4' then answer_value_text end) as "internally",max(case when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3' then answer_value_text end) as "work_toward_a_goal",max(case when linkid = 'drug-to-use-alcohol' then answer_value_text end) as "drug-to-use-alcohol",max(case when linkid = 'drug-to-use-marijuana-or-other' then answer_value_text end) as "drug-to-use-marijuana-or-other",max(case when linkid = 'health-goals-do-not-want-to-change' then answer_value_text end) as "health-goals-do-not-want-to-change",max(case when linkid = 'is-drug-dependence' then answer_value_text end) as "is-drug-dependence",max(case when linkid = 'is-high-risk-alcohol' then answer_value_text end) as "is-high-risk-alcohol",max(case when linkid = 'is-high-risk-drug' then answer_value_text end) as "is-high-risk-drug",max(case when linkid = 'is-low-risk-alcohol' then answer_value_text end) as "is-low-risk-alcohol",max(case when linkid = 'is-low-risk-drug' then answer_value_text end) as "is-low-risk-drug",max(case when linkid = 'is-medium-risk-alcohol' then answer_value_text end) as "is-medium-risk-alcohol",max(case when linkid = 'is-medium-risk-drug' then answer_value_text end) as "is-medium-risk-drug",max(case when linkid = 'is-opioid-dependence' then answer_value_text end) as "is-opioid-dependence",max(case when linkid = 'other-drug-list' then answer_value_text end) as "other-drug-list",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender' then answer_value_text end) as "patient-gender",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'score-audit' then answer_value_text end) as "score-audit",max(case when linkid = 'score-dast' then answer_value_text end) as "score-dast",max(case when linkid = 'should-converse-about-substance-use' then answer_value_text end) as "should-converse-about-substance-use",max(case when linkid = 'should-discuss-health-goals' then answer_value_text end) as "should-discuss-health-goals",max(case when linkid = 'show-client-use-with-other-drugs' then answer_value_text end) as "show-client-use-with-other-drugs",max(case when linkid = 'show-discuss-next-steps' then answer_value_text end) as "show-discuss-next-steps",max(case when linkid = 'show-goals' then answer_value_text end) as "show-goals",max(case when linkid = 'show-intervention-when-low-risk' then answer_value_text end) as "show-intervention-when-low-risk",max(case when linkid = 'show-intervention-when-medium-high-risk' then answer_value_text end) as "show-intervention-when-medium-high-risk",max(case when linkid = 'show-is-medium-high-risk' then answer_value_text end) as "show-is-medium-high-risk",max(case when linkid = 'show-summary-for-low-risk' then answer_value_text end) as "show-summary-for-low-risk",max(case when linkid = 'show-things-to-do' then answer_value_text end) as "show-things-to-do",max(case when linkid = 'task-id-sbirt-pdf' then answer_value_text end) as "task-id-sbirt-pdf",max(case when linkid = 'using-opioids-and-low-risk' then answer_value_text end) as "using-opioids-and-low-risk"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:47.426814 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_remove_patient
[0m09:28:47.428541 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:28:47.428876 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:28:47.429104 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp" rename to "qr_sf_pcl_5_s1"
[0m09:28:47.429463 [info ] [Thread-3 (]: 47 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [RUN]
[0m09:28:47.429745 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:47.430340 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_remove_patient, now model.engage_analytics.qr_sf_pcl_5_s3)
[0m09:28:47.432025 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:28:47.432339 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:28:47.432984 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp" rename to "qr_sf_pcl_5_s2"
[0m09:28:47.435669 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:28:47.436051 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:28:47.436429 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:47.437259 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:28:47.437544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:47.437700 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:47.437888 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:28:47.438623 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:28:47.438979 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:28:47.439200 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:28:47.439419 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:28:47.441010 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:28:47.441362 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:28:47.441541 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp" rename to "qr_sbirt"
[0m09:28:47.442366 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:47.443813 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup"
[0m09:28:47.444921 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:47.445233 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:28:47.445459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:28:47.446157 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:28:47.446368 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup" cascade
[0m09:28:47.447521 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup"
[0m09:28:47.447791 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:28:47.448181 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:28:47.448418 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:28:47.448604 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:47.448846 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup" cascade
[0m09:28:47.449905 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s1: Close
[0m09:28:47.450119 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:47.450486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098768d0>]}
[0m09:28:47.451785 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup"
[0m09:28:47.452013 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:28:47.452725 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:28:47.452398 [info ] [Thread-2 (]: 45 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [[32mCREATE VIEW[0m in 0.64s]
[0m09:28:47.453650 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s2: Close
[0m09:28:47.453892 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup" cascade
[0m09:28:47.454246 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:28:47.454556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0b920>]}
[0m09:28:47.454904 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:28:47.455302 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:47.455636 [info ] [Thread-1 (]: 46 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [[32mCREATE VIEW[0m in 0.64s]
[0m09:28:47.456677 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: Close
[0m09:28:47.455903 [info ] [Thread-2 (]: 48 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [RUN]
[0m09:28:47.457126 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:28:47.457471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s1, now model.engage_analytics.qr_sf_pcl_5_s4)
[0m09:28:47.457804 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3aff0>]}
[0m09:28:47.458062 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_sociodemographic_survey
[0m09:28:47.458380 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:28:47.458879 [info ] [Thread-4 (]: 44 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sbirt  [[32mCREATE VIEW[0m in 0.65s]
[0m09:28:47.461918 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:28:47.459151 [info ] [Thread-1 (]: 49 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [RUN]
[0m09:28:47.462407 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sbirt
[0m09:28:47.462686 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:47.463025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s2, now model.engage_analytics.qr_sociodemographic_survey)
[0m09:28:47.463258 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_spi_subform_1
[0m09:28:47.463539 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:47.463801 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_sociodemographic_survey
[0m09:28:47.464064 [info ] [Thread-4 (]: 50 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [RUN]
[0m09:28:47.466796 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:28:47.467060 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sbirt, now model.engage_analytics.qr_spi_subform_1)
[0m09:28:47.467416 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:47.467729 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_spi_subform_1
[0m09:28:47.467985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:47.470302 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:28:47.470681 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:47.470950 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:48.030440 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.592 seconds
[0m09:28:48.033324 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:28:48.034498 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:28:48.037186 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:28:48.037730 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:28:48.037923 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: BEGIN
[0m09:28:48.038788 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:48.039073 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:28:48.039375 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 3) with readable column names
-- Questionnaire ID: 60
-- Source file: questionnaire/ipc-session-3/sf-pcl-5-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ptsd_session_3",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s3_score_meaning_12",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s3_is_ptsd",max(case when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:48.043345 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:48.045485 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:28:48.046052 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp" rename to "qr_sf_pcl_5_s3"
[0m09:28:48.046430 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.583 seconds
[0m09:28:48.047598 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:28:48.047834 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:48.048597 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:28:48.048836 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:28:48.049008 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:28:48.049290 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:28:48.051226 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:28:48.051525 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:48.053834 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup"
[0m09:28:48.054202 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:28:48.054401 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup" cascade
[0m09:28:48.054675 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:28:48.054922 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s4: BEGIN
[0m09:28:48.055354 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:48.056100 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s3: Close
[0m09:28:48.056420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c2f90>]}
[0m09:28:48.056780 [info ] [Thread-3 (]: 47 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [[32mCREATE VIEW[0m in 0.63s]
[0m09:28:48.057200 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:28:48.057492 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m09:28:48.057765 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_spi_subform_2
[0m09:28:48.058076 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:28:48.058491 [debug] [Thread-1 (]: SQL status: SELECT 25 in 0.591 seconds
[0m09:28:48.058325 [info ] [Thread-3 (]: 51 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [RUN]
[0m09:28:48.058882 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 4) with readable column names
-- Questionnaire ID: 210
-- Source file: questionnaire/ipc-session-4/sf-pcl-5-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s4_encounter_id_of_ptsd_session_4",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s4_score_meaning_12",max(case when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:48.060123 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:28:48.060398 [debug] [Thread-4 (]: SQL status: SELECT 24 in 0.589 seconds
[0m09:28:48.060650 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s3, now model.engage_analytics.qr_spi_subform_2)
[0m09:28:48.061787 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_1"
[0m09:28:48.062073 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_spi_subform_2
[0m09:28:48.062599 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_sociodemographic_survey
[0m09:28:48.104351 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_spi_subform_1
[0m09:28:48.104678 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m09:28:48.107376 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:28:48.109378 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:28:48.111142 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_1"
[0m09:28:48.112903 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:28:48.113227 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:48.113632 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp" rename to "qr_sf_pcl_5_s4"
[0m09:28:48.113909 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:48.114457 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:28:48.114686 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:28:48.114888 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: BEGIN
[0m09:28:48.115117 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_1: BEGIN
[0m09:28:48.115354 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:48.116164 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:28:48.116408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:48.116642 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:28:48.116856 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:48.117058 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:28:48.117270 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:28:48.117456 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:28:48.117794 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Sociodemographic Survey with readable column names
-- Questionnaire ID: 1613531
-- Source file: questionnaire/assessments/sociodemographic_survey.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7' then answer_value_text end) as "demographic_if_you_were_not_born_in_the_us_how_long_have_you_l",max(case when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5' then answer_value_text end) as "demographic_please_specify",max(case when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde' then answer_value_text end) as "demographic_please_specify_3",max(case when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe' then answer_value_text end) as "demographic_where_were_you_born",max(case when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af' then answer_value_text end) as "demographic_what_is_the_zip_code_of_where_you_currently_live",max(case when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739' then answer_value_text end) as "demographic_what_was_your_biological_sex_at_birth",max(case when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d' then answer_value_text end) as "demographic_please_enter_the_number_of_years",max(case when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173' then answer_value_text end) as "demographic_we_would_like_to_know_about_what_you_do_are_you",max(case when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4' then answer_value_text end) as "demographic_please_enter_the_number_of_months",max(case when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9' then answer_value_text end) as "demographic_what_is_your_race_andor_ethnicity",max(case when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0' then answer_value_text end) as "demographic_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '92fed595-49f2-4fab-81ff-885941f31e07' then answer_value_text end) as "demographic_where_did_this_client_first_learn_about_engage",max(case when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a' then answer_value_text end) as "demographic_what_is_your_marital_status",max(case when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c' then answer_value_text end) as "demographic_what_term_best_expresses_how_you_describe_your_gen",max(case when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba' then answer_value_text end) as "demographic_what_was_the_highest_grade_or_level_of_school_that",max(case when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f' then answer_value_text end) as "demographic_please_specify_the_us_territorycommonwealth_eg_pue",max(case when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130' then answer_value_text end) as "some_of_the_time",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:48.118319 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 1 with readable column names
-- Questionnaire ID: 104455
-- Source file: questionnaire/spi/spi-subform-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_1",max(case when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab' then answer_value_text end) as "spi_is_low_risk",max(case when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d' then answer_value_text end) as "spi_is_medium_risk",max(case when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b' then answer_value_text end) as "spi_is_high_risk",max(case when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5' then answer_value_text end) as "spi_were_any_of_these_in_the_past_three_months",max(case when linkid = '35062b98-748b-441c-ad74-185823e1bb52' then answer_value_text end) as "spi_in_the_past_month_have_you_been_thinking_about_how",max(case when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb' then answer_value_text end) as "spi_in_the_past_month_have_you_had_these_thoughts_and_",max(case when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23' then answer_value_text end) as "spi_in_the_past_month_have_you_started_to_work_out_or_",max(case when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511' then answer_value_text end) as "spi_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea' then answer_value_text end) as "spi_have_you_ever_done_anything_started_to_do_anything",max(case when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce' then answer_value_text end) as "spi_in_the_past_month_have_you_actually_had_any_though",max(case when linkid = 'task-id-spi-subform-2' then answer_value_text end) as "spi_taskid_spi_subform_2",max(case when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03' then answer_value_text end) as "spi_43898926e9d5400ea09562a8c7f8dd03",max(case when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837' then answer_value_text end) as "spi_644c00f28b07491192d0f05f5e5cc837",max(case when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9' then answer_value_text end) as "spi_71dbaac9867f4d7fb6d7e1f59402bbf9",max(case when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda' then answer_value_text end) as "spi_7fc39fba84db490daf4e8f772d91ffda",max(case when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42' then answer_value_text end) as "spi_a6601f970a3449d0b181611d6705ca42",max(case when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423' then answer_value_text end) as "spi_c7d21a570fc64e3ab411beceb1fb2423",max(case when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019' then answer_value_text end) as "spi_ecabd308c45a41f78754b1f63a101019",max(case when linkid = 'task-status-spi-subform-2' then answer_value_text end) as "spi_taskstatus_spi_subform_2",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "task-id-spi-subform-3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "task-id-spi-subform-4",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "task-status-spi-subform-3",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "task-status-spi-subform-4"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:48.118714 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:48.120066 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup"
[0m09:28:48.120428 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:28:48.120610 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup" cascade
[0m09:28:48.121190 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:48.121863 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s4: Close
[0m09:28:48.122120 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:28:48.122476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d5940>]}
[0m09:28:48.122723 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:48.124535 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:28:48.126365 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:28:48.126592 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp" rename to "qr_sociodemographic_survey"
[0m09:28:48.124979 [info ] [Thread-2 (]: 48 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [[32mCREATE VIEW[0m in 0.67s]
[0m09:28:48.126909 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp" rename to "qr_spi_subform_1"
[0m09:28:48.127276 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:28:48.127622 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_spi_subform_3
[0m09:28:48.127877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:48.128457 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:48.128239 [info ] [Thread-2 (]: 52 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [RUN]
[0m09:28:48.129195 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:28:48.129924 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:28:48.130208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s4, now model.engage_analytics.qr_spi_subform_3)
[0m09:28:48.130453 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:28:48.130637 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:28:48.130886 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_spi_subform_3
[0m09:28:48.131118 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:28:48.131293 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:28:48.133986 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:28:48.134506 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:48.134791 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:48.135529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:48.135787 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:48.138063 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup"
[0m09:28:48.139279 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup"
[0m09:28:48.139737 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:28:48.140132 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:28:48.140350 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup" cascade
[0m09:28:48.140600 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup" cascade
[0m09:28:48.141525 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:48.141769 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:48.142582 [debug] [Thread-1 (]: On model.engage_analytics.qr_sociodemographic_survey: Close
[0m09:28:48.143218 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_1: Close
[0m09:28:48.143571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6bc50>]}
[0m09:28:48.143989 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e68e90>]}
[0m09:28:48.144405 [info ] [Thread-4 (]: 50 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [[32mCREATE VIEW[0m in 0.68s]
[0m09:28:48.144695 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_spi_subform_1
[0m09:28:48.144891 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_spi_subform_4
[0m09:28:48.145100 [info ] [Thread-4 (]: 53 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [RUN]
[0m09:28:48.145315 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_1, now model.engage_analytics.qr_spi_subform_4)
[0m09:28:48.145484 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_spi_subform_4
[0m09:28:48.148147 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:28:48.148520 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:48.148929 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:48.149249 [info ] [Thread-1 (]: 49 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [[32mCREATE VIEW[0m in 0.68s]
[0m09:28:48.149709 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_sociodemographic_survey
[0m09:28:48.149942 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_start_ipc_s1
[0m09:28:48.150187 [info ] [Thread-1 (]: 54 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [RUN]
[0m09:28:48.150503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sociodemographic_survey, now model.engage_analytics.qr_start_ipc_s1)
[0m09:28:48.150754 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_start_ipc_s1
[0m09:28:48.154029 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:28:48.154522 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:48.154758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:48.699833 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.586 seconds
[0m09:28:48.702700 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_2"
[0m09:28:48.703998 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_spi_subform_2
[0m09:28:48.706132 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_2"
[0m09:28:48.706677 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:28:48.706876 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: BEGIN
[0m09:28:48.707671 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:48.707858 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:28:48.708111 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 2 with readable column names
-- Questionnaire ID: 104453
-- Source file: questionnaire/spi/spi-subform-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_2",max(case when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36' then answer_value_text end) as "spi_did_this_client_also_screen_positive_for_probable_",max(case when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896' then answer_value_text end) as "spi_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab_5",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "spi_taskid_spi_subform_3",max(case when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50' then answer_value_text end) as "spi_d02eb882411e4bc0af9d08a77fcc3f50",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "spi_taskstatus_spi_subform_3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "spi_taskid_spi_subform_4",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "spi_taskstatus_spi_subform_4",max(case when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f' then answer_value_text end) as "spi_53b30f1274eb474c941c5f0e81b7eb9f",max(case when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253' then answer_value_text end) as "spi_did_you_discuss_this_clients_suicide_risk_screenin",max(case when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b' then answer_value_text end) as "spi_this_client_scored_in_the_moderate_to_high_range_o",max(case when linkid = '783e2646-c8ea-466d-bba8-85c891a14435' then answer_value_text end) as "spi_783e2646c8ea466dbba885c891a14435"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:48.710892 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:48.712663 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:28:48.712881 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp" rename to "qr_spi_subform_2"
[0m09:28:48.713587 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.579 seconds
[0m09:28:48.713809 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:48.714666 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_3"
[0m09:28:48.715279 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:28:48.715574 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:28:48.715763 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:28:48.716104 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_spi_subform_3
[0m09:28:48.717866 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_3"
[0m09:28:48.718098 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:48.719141 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup"
[0m09:28:48.719488 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:28:48.719669 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup" cascade
[0m09:28:48.719961 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:28:48.720176 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: BEGIN
[0m09:28:48.720353 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:28:48.721231 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_2: Close
[0m09:28:48.721430 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:48.721625 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:28:48.721899 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109854350>]}
[0m09:28:48.722126 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 3 with readable column names
-- Questionnaire ID: 104454
-- Source file: questionnaire/spi/spi-subform-3.json




  
  

  
  

  
  

  
  
    
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_3"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:48.722506 [info ] [Thread-3 (]: 51 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [[32mCREATE VIEW[0m in 0.66s]
[0m09:28:48.722986 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_spi_subform_2
[0m09:28:48.723256 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_start_ipc_s2
[0m09:28:48.723547 [info ] [Thread-3 (]: 55 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [RUN]
[0m09:28:48.723802 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_2, now model.engage_analytics.qr_start_ipc_s2)
[0m09:28:48.723986 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_start_ipc_s2
[0m09:28:48.726462 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:28:48.726738 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:48.727027 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:48.729886 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:28:48.730146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:28:48.730341 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp" rename to "qr_spi_subform_3"
[0m09:28:48.731396 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:48.732437 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:28:48.732713 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:28:48.732940 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:28:48.733871 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:48.735193 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup"
[0m09:28:48.735482 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:28:48.735659 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup" cascade
[0m09:28:48.736321 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:48.737099 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_3: Close
[0m09:28:48.737558 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b46210>]}
[0m09:28:48.737896 [info ] [Thread-2 (]: 52 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [[32mCREATE VIEW[0m in 0.61s]
[0m09:28:48.738256 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_spi_subform_3
[0m09:28:48.738498 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_start_ipc_s3
[0m09:28:48.738785 [info ] [Thread-2 (]: 56 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [RUN]
[0m09:28:48.739128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_3, now model.engage_analytics.qr_start_ipc_s3)
[0m09:28:48.739309 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_start_ipc_s3
[0m09:28:48.742478 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:28:48.742780 [debug] [Thread-4 (]: SQL status: SELECT 231 in 0.594 seconds
[0m09:28:48.743002 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:48.745545 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_4"
[0m09:28:48.745892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:28:48.746435 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_spi_subform_4
[0m09:28:48.748313 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_4"
[0m09:28:48.748890 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:28:48.749286 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: BEGIN
[0m09:28:48.750128 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:48.750360 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:28:48.751418 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 4 with readable column names
-- Questionnaire ID: 104394
-- Source file: questionnaire/spi/spi-subform-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_4",max(case when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk_",max(case when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8' then answer_value_text end) as "spi_in_a_few_days_i_would_like_to_meet_for_a_followup_",max(case when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904' then answer_value_text end) as "spi_person_1",max(case when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0' then answer_value_text end) as "spi_when_you_feel_a_suicidal_crisis_arising_go_through",max(case when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185' then answer_value_text end) as "spi_i_would_like_to_make_a_plan_that_will_help_you_man",max(case when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048' then answer_value_text end) as "spi_cce2de12cf6244ff84e89eb4d864d048",max(case when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri",max(case when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb' then answer_value_text end) as "spi_40fbe8d043804efcbb0426fc7d3714eb",max(case when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7' then answer_value_text end) as "spi_the_methods_i_have_thought_about_using_include",max(case when linkid = '808ba31c-cd29-4743-8801-dfce357d5956' then answer_value_text end) as "spi_person_1_11",max(case when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc' then answer_value_text end) as "spi_90cedcbfbf114dc3973342e6900a09fc",max(case when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031' then answer_value_text end) as "spi_92ab6e65f9bd47188af6f731425d3031",max(case when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3' then answer_value_text end) as "spi_9d203bac75fd4f31bed6073502a977f3",max(case when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54' then answer_value_text end) as "spi_additional_hotline_numbers_you_can_contact",max(case when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk__16",max(case when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969' then answer_value_text end) as "spi_12d89dfd5e434f008446b3af23323969",max(case when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3' then answer_value_text end) as "spi_39de8b745cbc4225b27bc97e72f08af3",max(case when linkid = '437d9ea2-adb5-471a-828b-a0285a282217' then answer_value_text end) as "spi_437d9ea2adb5471a828ba0285a282217",max(case when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd' then answer_value_text end) as "spi_509b140eb1954696bc5ff2fc2d2f77dd",max(case when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7' then answer_value_text end) as "spi_53a575e3aa59408da0dd8df237b68bf7",max(case when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256' then answer_value_text end) as "spi_a6d066a2028649b0b68834696e7fb256",max(case when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4' then answer_value_text end) as "spi_ce56c71d9ea44c8e9e9ad1da93bac1d4",max(case when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect_",max(case when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77' then answer_value_text end) as "spi_person_1_25",max(case when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0' then answer_value_text end) as "spi_person_1_26",max(case when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0' then answer_value_text end) as "spi_beb4ad5f2fd84b80aa93aa9ff1896dd0",max(case when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46' then answer_value_text end) as "spi_c396a3af6f0d4a8ea42b4f47bbce5f46",max(case when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9' then answer_value_text end) as "spi_e45b778dee8c4ee981f48927006160f9",max(case when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003' then answer_value_text end) as "spi_your_local_hotline_number",max(case when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888' then answer_value_text end) as "spi_101d2b7f2b68407daa4930cb4dadc888",max(case when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0' then answer_value_text end) as "spi_14ec8995eee9416f83ad9f44631ac9b0",max(case when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564' then answer_value_text end) as "spi_18d8ee56ffd847119074126ef2cdc564",max(case when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by",max(case when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124' then answer_value_text end) as "spi_5324bdcebaaa45bf935aeb2f65bd7124",max(case when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488' then answer_value_text end) as "spi_68fa6f2e84ec4dbc900e10ede297c488",max(case when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4' then answer_value_text end) as "spi_8891cd7bad1c4030afe46752cd273cf4",max(case when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri_38",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi' then answer_value_text end) as "spi_taskid_spi_navigator",max(case when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0' then answer_value_text end) as "spi_c631e361027c4e4db89448785a3e6dd0",max(case when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410' then answer_value_text end) as "spi_taskid_my_safety_plan_pdf",max(case when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871' then answer_value_text end) as "spi_a1c56f60b8234c15b99da315d2ca1871",max(case when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9' then answer_value_text end) as "spi_ae4fa455f173435abb1b4df1d1316bd9",max(case when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad' then answer_value_text end) as "spi_bc981d8a7f22450babab3acca810ccad",max(case when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db' then answer_value_text end) as "spi_c6c266cc1c8541c097ce9ab491be45db",max(case when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233' then answer_value_text end) as "spi_person_2",max(case when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7' then answer_value_text end) as "spi_7d8621a4dcc84f4892103fb7d0dcc3c7",max(case when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164' then answer_value_text end) as "spi_83661ebe71cf4eab88e3bfecbfe35164",max(case when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12' then answer_value_text end) as "spi_be88b02764b64c3cbf5936a94dc79b12",max(case when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de' then answer_value_text end) as "spi_c3b4cf6e385d40b793804de2f81463de",max(case when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso",max(case when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect__53",max(case when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7' then answer_value_text end) as "spi_ff115c2695b94e0d87ed80817d438fc7",max(case when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596' then answer_value_text end) as "spi_656a57f8f6f04fc5b34771dd8d38f596",max(case when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7' then answer_value_text end) as "spi_f749685963bb4b2f8f7596e44e893bf7",max(case when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0' then answer_value_text end) as "spi_f8861b1c781f4f12b4c8f8110f0c2cc0",max(case when linkid = '15e5007d-028f-4644-8fb6-0346730c3101' then answer_value_text end) as "spi_15e5007d028f46448fb60346730c3101",max(case when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by",max(case when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_60",max(case when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e' then answer_value_text end) as "spi_2b2e05e90c11490cbbff278ba90d7b4e",max(case when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070' then answer_value_text end) as "spi_3e388595a32f46238c9f3c67bad04070",max(case when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123' then answer_value_text end) as "spi_62b0eb1746e54c50a133087cc190a123",max(case when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by_64",max(case when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609' then answer_value_text end) as "spi_705df2d9af924f4fb51317e01d07b609",max(case when linkid = '7845c436-4904-41fa-9553-2c401935623b' then answer_value_text end) as "spi_7845c436490441fa95532c401935623b",max(case when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe' then answer_value_text end) as "spi_person_2_67",max(case when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95' then answer_value_text end) as "spi_person_2_68",max(case when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966' then answer_value_text end) as "spi_c802f463c8f54056bc458ab8d64a1966",max(case when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by_70",max(case when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63' then answer_value_text end) as "spi_2a6c5feb8034418b8644142a5e31df63",max(case when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb' then answer_value_text end) as "spi_3785a2648bd544abbf088aa33735c0eb",max(case when linkid = '544a444d-b101-4d56-9351-00bca8ec749e' then answer_value_text end) as "spi_person_2_73",max(case when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea' then answer_value_text end) as "spi_603d1492316f497f967b5c4b1ab983ea",max(case when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f' then answer_value_text end) as "spi_9f3a622ad39b49b084e70bcf4f832a4f",max(case when linkid = 'e9c42647-eefb-42bd-9080-f83630729606' then answer_value_text end) as "spi_e9c42647eefb42bd9080f83630729606",max(case when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d' then answer_value_text end) as "spi_ee5d4acfecf04e628924cff17a33679d",max(case when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e' then answer_value_text end) as "spi_fe2f09118ddc412ba3e6f216620d147e",max(case when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a' then answer_value_text end) as "spi_370c849b0e0042acbe9d3b4c719ac31a",max(case when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52' then answer_value_text end) as "spi_person_3",max(case when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb' then answer_value_text end) as "spi_08b5e17c5e144b19ac939e479cd2a2bb",max(case when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86' then answer_value_text end) as "spi_13321778b5d44b018eda610cf0007c86",max(case when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by_84",max(case when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17' then answer_value_text end) as "spi_84018cd89134429c8dfefd6a16e4bd17",max(case when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer",max(case when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604' then answer_value_text end) as "spi_fdd7c3c3f2c343bd8a806b48aa2b9604",max(case when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4' then answer_value_text end) as "spi_8a9424b0c8934371b5c9bc0008be14b4",max(case when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af' then answer_value_text end) as "spi_a5d96f90cd914a5b8862c4e3f88694af",max(case when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3' then answer_value_text end) as "spi_person_3_90",max(case when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb' then answer_value_text end) as "spi_28b2e31aee4d4e998974b616145311eb",max(case when linkid = '53932020-eed8-46f4-8236-d548a6335a59' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by_92",max(case when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db' then answer_value_text end) as "spi_7e38a614b0a248eab7c7ca2bdc1f00db",max(case when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf' then answer_value_text end) as "spi_c1e99f8bb1ab46d1b205ecbbb4240fdf",max(case when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_95",max(case when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54' then answer_value_text end) as "spi_d4ebe78407d043128a46634c0e338a54",max(case when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47' then answer_value_text end) as "spi_53def3a1a7e5432695f22561c26ecb47",max(case when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b' then answer_value_text end) as "spi_2b96f1d93450423da277060fcfdadc6b",max(case when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5' then answer_value_text end) as "spi_person_4",max(case when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d' then answer_value_text end) as "spi_b36fdd5fccac457ca8eaf9497204ef1d",max(case when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_101",max(case when linkid = 'c5720a67-803f-4917-8261-3738de838418' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer_102",max(case when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5' then answer_value_text end) as "spi_person_3_103",max(case when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa' then answer_value_text end) as "spi_f952feaf7abc4f6fa3bcd10a43ea62fa",max(case when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6' then answer_value_text end) as "spi_bd7644ee28f14f43a65417fd5034d1f6",max(case when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090' then answer_value_text end) as "spi_72e5c1b77ce949bd834bd98b73ba7090",max(case when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33' then answer_value_text end) as "spi_person_4_107",max(case when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a' then answer_value_text end) as "spi_d82c6ae90516451391fa664686779d6a",max(case when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1' then answer_value_text end) as "spi_person_3_109",max(case when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807' then answer_value_text end) as "spi_fc5c673b41d4435286bb043c73ed9807",max(case when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49' then answer_value_text end) as "spi_0397084acd514b3a809d970a2406ea49",max(case when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972' then answer_value_text end) as "spi_6a273a9882ca4d36ade0ce98f7899972",max(case when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f' then answer_value_text end) as "spi_11aadd880cf948b2939d2b3e28191c5f",max(case when linkid = '57e87170-761c-4b57-a09c-d50cab02860c' then answer_value_text end) as "spi_57e87170761c4b57a09cd50cab02860c",max(case when linkid = '965b7874-dd24-4215-acd4-8d241a262638' then answer_value_text end) as "spi_965b7874dd244215acd48d241a262638",max(case when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb' then answer_value_text end) as "spi_bd62b64972094d329bbbdc2b2823aadb",max(case when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709' then answer_value_text end) as "spi_07c2e8dcb48b4bc7b21bc196cce32709",max(case when linkid = '83dfd82f-0277-459d-abe3-e8795750f288' then answer_value_text end) as "spi_person_5",max(case when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f' then answer_value_text end) as "spi_ae94969792ae476a96ccf8b0adc4221f",max(case when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2' then answer_value_text end) as "spi_2c7b6bd736f6495b9f41eb492c07c7b2",max(case when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_121",max(case when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897' then answer_value_text end) as "spi_fefdc90ffe1d4bfbaf9394df8c482897",max(case when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344' then answer_value_text end) as "spi_1fc8f8e7202248d2b41d4e8ad22af344",max(case when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c' then answer_value_text end) as "spi_8c1ac4fe1d7644368f34d315c6c17b9c",max(case when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d' then answer_value_text end) as "spi_person_5_125",max(case when linkid = 'df53c378-27fe-483d-a630-f7b171f72980' then answer_value_text end) as "spi_df53c37827fe483da630f7b171f72980",max(case when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660' then answer_value_text end) as "spi_e552afd32816446e9ff5e898bc813660",max(case when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_128",max(case when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369' then answer_value_text end) as "spi_person_4_129",max(case when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a' then answer_value_text end) as "spi_44f024678ee049f08da75e7ed827125a",max(case when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9' then answer_value_text end) as "spi_82d6b50b0bb240f694b17a4c58df43f9",max(case when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c' then answer_value_text end) as "spi_892337bdd7fd46a7bf7208e87c9f412c",max(case when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b' then answer_value_text end) as "spi_e4a1be29fe8b442391bc6b4f5d730e6b",max(case when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2' then answer_value_text end) as "spi_9f46e0ff05324105be360cfa9d0770f2",max(case when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8' then answer_value_text end) as "spi_86da79f044cb417dab20c7ecc6f8f7c8",max(case when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7' then answer_value_text end) as "spi_ce0fdd416b0941049998a04c5dd9a5b7",max(case when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0' then answer_value_text end) as "spi_3314932c64e44192b583eb31e87da1d0",max(case when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206' then answer_value_text end) as "spi_5e2ab0f5f5d94502befeaba770f0e206",max(case when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240' then answer_value_text end) as "spi_796f544054f84d69b961a5b7e6a63240",max(case when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478' then answer_value_text end) as "spi_9f531e6126cf4223865339c24d6dd478",max(case when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_141",max(case when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021' then answer_value_text end) as "spi_4d334b16ea16429994ed32e84ef97021",max(case when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf' then answer_value_text end) as "spi_895fad45c3b547c59edf5f9b9e793fbf",max(case when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc' then answer_value_text end) as "spi_92da95cc50dd4bf0acca4465c07d44cc",max(case when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd' then answer_value_text end) as "spi_person_5_145",max(case when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc' then answer_value_text end) as "spi_f1fef9d72ab94ead9c24c4dc9c7ed4cc",max(case when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2' then answer_value_text end) as "spi_40d6a87f94984cfdb2334610e6de08c2",max(case when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668' then answer_value_text end) as "spi_ac3206ddb60b4cb1a5593a770a685668",max(case when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21' then answer_value_text end) as "spi_f895ed4f50044da49d59c21293674b21",max(case when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8' then answer_value_text end) as "spi_faefef23d2e64777b6288f83921e8fd8",max(case when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c' then answer_value_text end) as "spi_62a0463889284aabb4901a33739b7a5c",max(case when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f' then answer_value_text end) as "spi_bfe595d6325f492ab3b6cc5541e18c3f",max(case when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa' then answer_value_text end) as "spi_40d8ef6402f042ae947877651bd26dfa",max(case when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3' then answer_value_text end) as "spi_249f5ce8ecc04e4396756b01ca1502a3",max(case when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27' then answer_value_text end) as "spi_9b1b11e8608f4ea9911b88aae467ac27",max(case when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4' then answer_value_text end) as "spi_dae7f411758d48009842fc0038a6b4a4",max(case when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14' then answer_value_text end) as "spi_0c308fef8ce54217a8d48e6ff00c8e14",max(case when linkid = '54b75d55-1c43-4552-acbf-d9754831add8' then answer_value_text end) as "spi_54b75d551c434552acbfd9754831add8",max(case when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c' then answer_value_text end) as "spi_9faa2b7818424326bf7f9975bf04dc2c",max(case when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f' then answer_value_text end) as "spi_a320b7874cba457f9c6067ff76c7020f",max(case when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc' then answer_value_text end) as "spi_706fc36fefef4bf9827e7dc100cc92bc",max(case when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a' then answer_value_text end) as "spi_a57b5b3412e54ec882157f316267323a",max(case when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75' then answer_value_text end) as "spi_6bbdb2cfe7f6443a8f4e841e16bb9b75",max(case when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e' then answer_value_text end) as "spi_d617b1e1ea224863a878627f6b81963e",max(case when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc' then answer_value_text end) as "spi_2cedd4dd15e549518674ea4d4eeb7cfc",max(case when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200' then answer_value_text end) as "spi_c0655b118f2147ed8ede95498c2e8200",max(case when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225' then answer_value_text end) as "spi_1895c0a7b0904f499b0c08dca9a7b225",max(case when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c' then answer_value_text end) as "spi_f311f3ca5537413488285e537bb26a9c",max(case when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268' then answer_value_text end) as "spi_1a00c7b7e80d4e908ed4efd8f6d96268",max(case when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e' then answer_value_text end) as "spi_527c0166cc354cc3a9d97eeb0a54635e",max(case when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed' then answer_value_text end) as "spi_41cce38aca5c4e24904a25b1027336ed",max(case when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5' then answer_value_text end) as "spi_e8726638cfdb40aeb72cf1d594f64de5",max(case when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f' then answer_value_text end) as "spi_6ac23c5d0035489585f233c2fbba8f3f",max(case when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99' then answer_value_text end) as "spi_e7ba8485515441b8ac1835410a83cd99",max(case when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81' then answer_value_text end) as "spi_06f9231a999b445982606fbbcdfc5d81",max(case when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444' then answer_value_text end) as "spi_d8615ac796b246a2b3a5b5b83945b444",max(case when linkid = '74d0f0df-e726-4c40-84ce-efece882818b' then answer_value_text end) as "spi_74d0f0dfe7264c4084ceefece882818b",max(case when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d' then answer_value_text end) as "spi_1d0ad82509de4018a680cd0e6bf0983d",max(case when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03' then answer_value_text end) as "spi_d5194db005464bd196d8d56457930c03",max(case when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131' then answer_value_text end) as "spi_9e11ce9790e842f2ba188c4f0720c131",max(case when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0' then answer_value_text end) as "spi_cb75bba90bd84dceba2fd1b21a97c2a0",max(case when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2' then answer_value_text end) as "spi_2f44652fdf2d476e933d75b6ed55f5f2",max(case when linkid = '7b51625b-73b9-472d-9c71-299beb26694f' then answer_value_text end) as "spi_7b51625b73b9472d9c71299beb26694f",max(case when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a' then answer_value_text end) as "spi_13e2f93482ed4b23af6e95523dc3746a",max(case when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248' then answer_value_text end) as "spi_ec54e447c9814dd2aaa4659f8e494248",max(case when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71' then answer_value_text end) as "spi_cf16ca6e8b1b467db807fc5d50339f71",max(case when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d' then answer_value_text end) as "spi_ce18eee3aa6444238db150fe7f00850d",max(case when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c' then answer_value_text end) as "spi_5a79866df1fb4bd8b4c4f18c982bef3c",max(case when linkid = '45772f3f-c610-408b-942b-359769945cf4' then answer_value_text end) as "spi_45772f3fc610408b942b359769945cf4",max(case when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111' then answer_value_text end) as "spi_cebffdf48fd14829884c41cc42bc0111",max(case when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0' then answer_value_text end) as "spi_7ca03155c9ec45e18cd05b86fa444ad0",max(case when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149' then answer_value_text end) as "spi_46c2861b70a94fdf94eae1a01cae3149",max(case when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d' then answer_value_text end) as "spi_8a5b1c7de3ef444385f1fa5213d89f8d",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12' then answer_value_text end) as "paracetamol",max(case when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98' then answer_value_text end) as "tiredness",max(case when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6' then answer_value_text end) as "watching_tv",max(case when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6' then answer_value_text end) as "wait_what",max(case when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by",max(case when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe' then answer_value_text end) as "sleeping",max(case when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f' then answer_value_text end) as "what",max(case when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264' then answer_value_text end) as "what_205",max(case when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d' then answer_value_text end) as "wait",max(case when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05' then answer_value_text end) as "wait_what_207",max(case when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13' then answer_value_text end) as "tiredness_208",max(case when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by_209",max(case when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8' then answer_value_text end) as "sleeping_210",max(case when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d' then answer_value_text end) as "socialize",max(case when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2' then answer_value_text end) as "yoga_playing_with_dog",max(case when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b' then answer_value_text end) as "watching_tv_213",max(case when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351' then answer_value_text end) as "video_games",max(case when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7' then answer_value_text end) as "wait_215",max(case when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba' then answer_value_text end) as "walking_in_the_park",max(case when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8' then answer_value_text end) as "none",max(case when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9' then answer_value_text end) as "20250204",max(case when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0' then answer_value_text end) as "taking_toxins",max(case when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a' then answer_value_text end) as "tiktok_dance_challenges",max(case when linkid = 'no-response-step-1' then answer_value_text end) as "no-response-step-1",max(case when linkid = 'no-response-step-1-review' then answer_value_text end) as "no-response-step-1-review",max(case when linkid = 'no-response-step-2' then answer_value_text end) as "no-response-step-2",max(case when linkid = 'no-response-step-2-review' then answer_value_text end) as "no-response-step-2-review",max(case when linkid = 'no-response-step-3' then answer_value_text end) as "no-response-step-3",max(case when linkid = 'no-response-step-3-review' then answer_value_text end) as "no-response-step-3-review",max(case when linkid = 'no-response-step-4' then answer_value_text end) as "no-response-step-4",max(case when linkid = 'no-response-step-4-review' then answer_value_text end) as "no-response-step-4-review",max(case when linkid = 'no-response-step-6a' then answer_value_text end) as "no-response-step-6a",max(case when linkid = 'no-response-step-6a-review' then answer_value_text end) as "no-response-step-6a-review",max(case when linkid = 'other-signs-step-1' then answer_value_text end) as "other-signs-step-1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:48.761292 [debug] [Thread-1 (]: SQL status: SELECT 111 in 0.606 seconds
[0m09:28:48.763181 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:28:48.764040 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:28:48.766111 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:28:48.766361 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp" rename to "qr_spi_subform_4"
[0m09:28:48.766613 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_start_ipc_s1
[0m09:28:48.768565 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:28:48.769134 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:28:48.769436 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:28:48.770210 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:28:48.770677 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: BEGIN
[0m09:28:48.770875 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:28:48.771164 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:28:48.771565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:48.771790 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:28:48.772396 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 1 with readable column names
-- Questionnaire ID: 55
-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as "ipc_s1_patient_age",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as "ipc_s1_patient_dob",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as "ipc_s1_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as "ipc_s1_in_the_past_6_months",max(case when linkid = 'f1.92.1' then answer_value_text end) as "ipc_s1_f1921",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as "ipc_s1_in_the_past_1_year",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as "ipc_s1_i_noticed_that_when_i_was_asking_about_important_p",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s1_did_you_complete_the_required_assessments_and_the_",max(case when linkid = 'f1.42.2' then answer_value_text end) as "ipc_s1_do_you_think_an_important_persons_death_is_connect",max(case when linkid = 'f1.68.2' then answer_value_text end) as "ipc_s1_are_you_and_someone_else_having_a_strong_disagreem",max(case when linkid = 'f1.69.2' then answer_value_text end) as "ipc_s1_briefly_tell_me_about_the_disagreement",max(case when linkid = 'f1.70.2' then answer_value_text end) as "ipc_s1_how_has_this_disagreement_been_affecting_you",max(case when linkid = 'f1.72.2' then answer_value_text end) as "ipc_s1_have_there_been_any_changes_in_your_life_that_are_",max(case when linkid = 'f1.73.2' then answer_value_text end) as "ipc_s1_what_was_the_change",max(case when linkid = 'f1.74.2' then answer_value_text end) as "ipc_s1_when_did_this_happen",max(case when linkid = 'f1.76.2' then answer_value_text end) as "ipc_s1_if_the_client_did_not_mention_any_close_relationsh",max(case when linkid = 'f1.78.2' then answer_value_text end) as "ipc_s1_would_you_say_you_have_close_relationships",max(case when linkid = 'f1.79.2' then answer_value_text end) as "ipc_s1_has_anything_changed_in_your_life_so_that_now_you_",max(case when linkid = 'f1.88.2' then answer_value_text end) as "ipc_s1_f1882",max(case when linkid = 'f1.89.2' then answer_value_text end) as "ipc_s1_select_the_possible_interpersonal_problem_areas_yo",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as "ipc_s1_your_most_distressing_current_symptoms_began",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as "ipc_s1_taskid_session_1_navigator",max(case when linkid = 'f1.40.2' then answer_value_text end) as "ipc_s1_f1402",max(case when linkid = 'f1.79.3' then answer_value_text end) as "ipc_s1_when_did_this_event_happen",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as "ipc_s1_is_there_anything_else_that_we_did_not_discuss_tha",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s1_taskid_session_2_navigator",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'f1.40.3' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or_",max(case when linkid = 'f1.43.2' then answer_value_text end) as "ipc_s1_tell_me_about_your_relationship_with_this_person_h",max(case when linkid = 'f1.69.3' then answer_value_text end) as "ipc_s1_when_did_this_disagreement_happen",max(case when linkid = 'f1.82.2' then answer_value_text end) as "ipc_s1_do_you_want_to_propose_an_interpersonal_formulatio",max(case when linkid = 'f1.87.2' then answer_value_text end) as "ipc_s1_do_you_agree_with_this",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as "ipc_s1_these_are_the_symptoms_you_said_you_are_currently_",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as "ipc_s1_taskid_mood_pdf",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as "ipc_s1_relationships_eg_talk_with_friends_or_vi",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as "ipc_s1_is_there_anything_that_could_get_in_the_way_of_you",max(case when linkid = 'f1.81.3' then answer_value_text end) as "ipc_s1_f1813",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_provider_pdf",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as "ipc_s1_work_on_my_relationship_with_my_parents_",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as "ipc_s1_f13931",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_client_pdf",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as "ipc_s1_of_these_symptoms_which_are_the_most_distressing",max(case when linkid = 'f1.81.4' then answer_value_text end) as "ipc_s1_f1814",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as "ipc_s1_earlier_than_that_you_noticed_symptoms",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as "ipc_s1_community_activities_eg_go_to_a_recreati",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as "ipc_s1_patient_name",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as "ipc_s1_f13932",max(case when linkid = 'f1.40.5' then answer_value_text end) as "ipc_s1_f1405",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as "ipc_s1_when_did_these_symptoms_begin",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as "ipc_s1_xxx",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "ipc_s1_yesterday_",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as "ipc_s1_patient_gender",max(case when linkid = 'f1.40.6' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__54",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as "ipc_s1_phq9_total",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as "ipc_s1_possible_problem_areas",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing_57",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as "ipc_s1_gad7_total",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as "ipc_s1_hobbies_eg_listen_to_music_play_video_ga",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as "ipc_s1_what_was_going_on_in_your_life_when_you_started_to",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s1_ptsd_total",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as "ipc_s1_zfgh",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as "ipc_s1_do_you_agree_with_this_summary",max(case when linkid = 'f1.40.8' then answer_value_text end) as "ipc_s1_f1408",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_mood_rating_session_1_score",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as "ipc_s1_what_about_before_that_was_there_a_time_before_in_",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as "ipc_s1_religionspirituality_eg_pray_or_go_to_se",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s1_mood_rating_total",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as "ipc_s1_person_1_is",max(case when linkid = 'f1.40.9' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__72",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as "ipc_s1_phq9_total_meaning",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as "ipc_s1_what_were_the_symptoms",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as "ipc_s1_with_my_pastor_",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as "ipc_s1_gad7_total_meaning",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as "ipc_s1_f13941",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as "ipc_s1_ptsd_total_meaning_toggle",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as "ipc_s1_when_did_you_notice_these_symptoms",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as "ipc_s1_other",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as "ipc_s1_mood_rating_comment",max(case when linkid = 'f1.38.4' then answer_value_text end) as "ipc_s1_f1384",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as "ipc_s1_f13942",max(case when linkid = 'f1.40.11' then answer_value_text end) as "ipc_s1_f14011",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as "ipc_s1_what_was_happening_then",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ipc_session_1",max(case when linkid = 'f1.40.12' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__87",max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as "ipc_s1_ex",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_89",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as "ipc_s1_person_2_is",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as "ipc_s1_f13951",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as "ipc_s1_f13952",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as "ipc_s1_gud",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_94",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as "ipc_s1_person_3_is",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as "ipc_s1_f13961",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as "ipc_s1_f13962",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_98",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as "ipc_s1_person_4_is",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as "seeing_someone_be_killed_or_seriously_injured",max(case when linkid = 'f1.38.3' then answer_value_text end) as "f1.38.3",max(case when linkid = 'f1.46.2' then answer_value_text end) as "f1.46.2",max(case when linkid = 'task-id-008' then answer_value_text end) as "task-id-008",max(case when linkid = 'task-id-009' then answer_value_text end) as "task-id-009",max(case when linkid = 'task-id-010' then answer_value_text end) as "task-id-010",max(case when linkid = 'task-id-012' then answer_value_text end) as "task-id-012"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:48.772982 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:28:48.774345 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup"
[0m09:28:48.774697 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:28:48.774888 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup" cascade
[0m09:28:48.775582 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:48.776340 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: Close
[0m09:28:48.776643 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5d160>]}
[0m09:28:48.779367 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:28:48.781072 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:28:48.781274 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp" rename to "qr_start_ipc_s1"
[0m09:28:48.782770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:48.783433 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:28:48.783618 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:28:48.783774 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:28:48.784833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:48.786773 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup"
[0m09:28:48.787085 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:28:48.787256 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup" cascade
[0m09:28:48.787778 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:48.788416 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: Close
[0m09:28:48.788691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba7800>]}
[0m09:28:48.938095 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m09:28:48.939016 [info ] [Thread-4 (]: 53 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [[32mCREATE VIEW[0m in 0.63s]
[0m09:28:48.938526 [info ] [Thread-1 (]: 54 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [[32mCREATE VIEW[0m in 0.64s]
[0m09:28:48.939318 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_spi_subform_4
[0m09:28:48.939558 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_start_ipc_s1
[0m09:28:48.939761 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_start_ipc_s4
[0m09:28:48.940015 [debug] [Thread-1 (]: Began running node model.engage_analytics.practitioners
[0m09:28:48.940297 [info ] [Thread-4 (]: 57 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [RUN]
[0m09:28:48.940548 [info ] [Thread-1 (]: 58 of 59 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m09:28:48.941722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_4, now model.engage_analytics.qr_start_ipc_s4)
[0m09:28:48.941907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_start_ipc_s1, now model.engage_analytics.practitioners)
[0m09:28:48.942204 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_start_ipc_s4
[0m09:28:48.942511 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.practitioners
[0m09:28:48.945226 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:28:48.947817 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.948141 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:28:48.948466 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m09:28:48.948740 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:28:48.948915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:48.966552 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.018 seconds
[0m09:28:48.967543 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.967751 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m09:28:48.968563 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m09:28:48.969837 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m09:28:48.970392 [debug] [Thread-1 (]: Began executing node model.engage_analytics.practitioners
[0m09:28:48.973151 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.973498 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    
  
    

  create temporary table "practitioners__dbt_tmp092848972181"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

where p._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
)

  );
  
  
[0m09:28:48.976276 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m09:28:48.977932 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.978146 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: BEGIN
[0m09:28:48.978783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:48.978953 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.979121 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioners__dbt_tmp092848972181'
        
      order by ordinal_position

  
[0m09:28:48.983254 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m09:28:48.984996 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.985217 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:48.987362 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:28:48.989050 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.989261 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:28:48.991295 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:28:48.992306 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m09:28:48.992795 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.993320 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioners__dbt_tmp092848972181" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" ("id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role")
    (
        select "id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role"
        from "practitioners__dbt_tmp092848972181"
    )
  
[0m09:28:48.994184 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:28:48.994873 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:28:48.995069 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:28:48.995229 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:28:48.996542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:48.997064 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: Close
[0m09:28:48.997378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e69490>]}
[0m09:28:48.997699 [info ] [Thread-1 (]: 58 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mINSERT 0 0[0m in 0.06s]
[0m09:28:48.997970 [debug] [Thread-1 (]: Finished running node model.engage_analytics.practitioners
[0m09:28:48.998165 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_registration_info_anon
[0m09:28:48.998500 [info ] [Thread-1 (]: 59 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [RUN]
[0m09:28:48.998840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioners, now model.engage_analytics.qr_registration_info_anon)
[0m09:28:48.999042 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_registration_info_anon
[0m09:28:49.000811 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info_anon"
[0m09:28:49.001276 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_registration_info_anon
[0m09:28:49.004456 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info_anon"
[0m09:28:49.005000 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:49.005292 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: BEGIN
[0m09:28:49.005535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:49.020286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:28:49.020598 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:49.020840 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized registration info with masked PII fields
-- Masks: Unique ID, Names, DOB, Phone, Email, Physical address, Zip code, Medicaid number

select 
    -- Non-PII identifiers (hashed for referential integrity)
    MD5(qr_id::text) as qr_id_hash,
    questionnaire_id,
    MD5(subject_patient_id::text) as subject_patient_id_hash,
    encounter_id,
    author_practitioner_id,
    
    -- Location and organization references (non-PII)
    practitioner_location_id,
    practitioner_organization_id,
    practitioner_id,
    practitioner_careteam_id,
    
    -- Application metadata
    application_version,
    
    -- Masked PII fields
    'REDACTED' as registration_unique_id_masked,
    'REDACTED' as registration_first_name_masked,
    'REDACTED' as registration_middle_name_masked,
    'REDACTED' as registration_surname_masked,
    
    -- Age fields (keep age, mask DOB)
    registration_age,
    registration_age_6,
    registration_calculated_age,
    'REDACTED' as registration_date_of_birth_dob_masked,
    
    -- Masked contact information
    'REDACTED' as "email-address_masked",
    CASE 
        WHEN "phone-number" IS NOT NULL 
        THEN 'XXX-XXX-' || RIGHT("phone-number", 4)
        ELSE NULL
    END as "phone-number_masked",
    'REDACTED' as "physical-address_masked",
    CASE 
        WHEN "zip-code" IS NOT NULL 
        THEN LEFT("zip-code", 3) || 'XX'
        ELSE NULL
    END as "zip-code_masked",
    
    -- Masked Medicaid information
    CASE 
        WHEN "do-you-have-medicaid" = 'Yes' 
        THEN 'Yes'
        ELSE "do-you-have-medicaid"
    END as "do-you-have-medicaid",
    'REDACTED' as "medicaid-number_masked",
    
    -- Non-PII demographic fields
    registration_which_of_the_following_best_represents_how_you_thi,
    registration_what_was_your_biological_sex_assigned_at_birth,
    "choice-gender-identity",
    "choice-pronouns",
    "other-best-represents-how-you-think-of-yourself",
    
    -- Service history (non-PII)
    registration_has_this_person_received_engage_services_in_the_pa,
    
    -- Date components (non-specific)
    registration_calculated_month,
    registration_calculated_year,
    
    -- Metadata
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info"
  );
[0m09:28:49.023267 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:28:49.025022 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:49.025238 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp" rename to "qr_registration_info_anon"
[0m09:28:49.025962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:49.026612 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:28:49.026802 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:49.026966 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:28:49.027930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:49.029128 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup"
[0m09:28:49.029424 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:28:49.029597 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup" cascade
[0m09:28:49.030270 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:49.031010 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: Close
[0m09:28:49.031320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f148f0>]}
[0m09:28:49.031682 [info ] [Thread-1 (]: 59 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [[32mCREATE VIEW[0m in 0.03s]
[0m09:28:49.031986 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_registration_info_anon
[0m09:28:49.325793 [debug] [Thread-3 (]: SQL status: SELECT 91 in 0.595 seconds
[0m09:28:49.330427 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:28:49.332009 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_start_ipc_s2
[0m09:28:49.334052 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:28:49.334580 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:28:49.334765 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: BEGIN
[0m09:28:49.335394 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:49.335590 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:28:49.336135 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 2 with readable column names
-- Questionnaire ID: 58
-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "ipc_s2_phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "ipc_s2_gad7_total_meaning",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s2_ptsd_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as "ipc_s2_phq9_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as "ipc_s2_summary_when_1",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as "ipc_s2_most_distressing_symptoms",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as "ipc_s2_selected_problem_area",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as "ipc_s2_ptsd_total_meaning_toggle",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as "ipc_s2_gad7_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s2_taskid_session_2_navigator",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as "ipc_s2_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s2_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s2_taskid_session_3_navigator",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as "ipc_s2_have_you_proposed_the_interpersonal_formulation_in",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_provider_pdf",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s2_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as "ipc_s2_a4a9cad504db44e59a9d0f1bf40ca840",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s2_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s2_747188c84fc043ea92b49baa32567f73",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as "ipc_s2_did_the_person_ever_hit_kick_push_or_slap_you",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as "ipc_s2_do_you_agree_with_this",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ipc_session_2",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s2_3d2ccf9a0e7b48a0854044d43b6dacfe",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area_28",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s2_6fb0c7a5a21143ecaf7b5f1079399133",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_mood_rating_session_1_score",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s2_did_you_ever_hit_kick_push_or_slap_the_person",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as "ipc_s2_do_you_still_think_that",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s2_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s2_232484cf1aee4bfaa66e61494587a16a",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s2_9ed77f2a0d5a434db153d8deadfbc3f8",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s2_3bfee97a6a0e4cd0bdb77ffa8d36191f",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree_37",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__39",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__40",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__41",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as "ipc_s2_287593c3417445afa99871d249230943",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s2_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s2_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s2_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s2_665e1595f16948159d24dac265f1809b",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s2_bc8f199a59f04184864db1c0befd26df",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s2_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s2_e17756cd48614dde859cf90241977246",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s2_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as "ipc_s2_is_any_of_the_2_question_above_is_true",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as "ipc_s2_2ef63cf4b37e4216a8e1db6d1b91cc2a",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s2_3e0b76f9090243bab8580b1505e9d168",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s2_9cc2834b0d2843d08811509995cfcdb8",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s2_a7f10195b8594670abbca2498c4fe45f",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__57",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s2_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s2_547a07c2f94c4956997f0439626d0251",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s2_6c1b2aa7f2444d5abfc6e0faef33bfe6",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s2_a77f07b379134708a35414e503a948f1",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s2_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s2_example_skills_63",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s2_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s2_eb8828db167447e7ba9ae3c161160b65",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s2_example_skills_66",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s2_4c95559d86ff4b87a271e52388072a53",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s2_bed17079d1e54bbeaf073d7b6a86243e",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__69",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__70",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__71",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s2_example_skills_72",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s2_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__77",max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__78",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__79",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = 'task-id-013' then answer_value_text end) as "task-id-013",max(case when linkid = 'task-id-014' then answer_value_text end) as "task-id-014",max(case when linkid = 'task-id-015' then answer_value_text end) as "task-id-015",max(case when linkid = 'task-id-016' then answer_value_text end) as "task-id-016",max(case when linkid = 'task-id-018' then answer_value_text end) as "task-id-018"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:49.340552 [debug] [Thread-2 (]: SQL status: SELECT 97 in 0.595 seconds
[0m09:28:49.342228 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:28:49.342499 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:28:49.344091 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:28:49.344307 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp" rename to "qr_start_ipc_s2"
[0m09:28:49.344852 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_start_ipc_s3
[0m09:28:49.346629 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:28:49.346895 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:28:49.347501 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:28:49.347703 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:28:49.347869 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:28:49.348200 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:28:49.348364 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: BEGIN
[0m09:28:49.348878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:28:49.349082 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:49.349241 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:28:49.350355 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup"
[0m09:28:49.350944 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 3 with readable column names
-- Questionnaire ID: 208
-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as "ipc_s3_phq9_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as "ipc_s3_gad7_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as "ipc_s3_ptsd_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as "ipc_s3_ptsd_total_meaning",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s3_taskid_session_3_navigator",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s3_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s3_taskid_session_4_navigator",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as "ipc_s3_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s3_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_provider_pdf",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s3_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ipc_session_3",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_16",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s3_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_18",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s3_observation_id_of_mood_rating_session_3_score",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as "ipc_s3_1b59ddeb483d4b1baf53f3942204589a",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s3_did_you_ever_hit_kick_push_or_slap_the_personno",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s3_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_23",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as "ipc_s3_4554f4b2d15e47e7a10dd77939dd3afc",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_25",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as "ipc_s3_f9a9f4928eb84c718ec6f80ab596430b",max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__28",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__29",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__30",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s3_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as "ipc_s3_59744d4501004d62b1055cbecd973ffd",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as "ipc_s3_6b5fa4342fc34e4bad1189f6260a81f2",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as "ipc_s3_77fc70ba6cac494cb27a77ebce2289e5",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s3_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s3_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as "ipc_s3_has_anything_changed_since_the_last_time_we_met",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s3_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_40",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as "ipc_s3_4ad7384fa3324e4193180d3f9e540ee7",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as "ipc_s3_stage_identified_in_session_2",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_43",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_44",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_45",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as "ipc_s3_b24118e231c54e23af3a1722af72c299",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as "ipc_s3_68b3cbf5b9ef4da49ac1bcbc20f04473",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as "ipc_s3_9e995f48b09249b2a9e4c7e754e446e5",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__49",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s3_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as "ipc_s3_e8b8e5504d6542beacb92f4ac17c7f49",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s3_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s3_example_skills_53",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s3_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s3_example_skills_55",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_56",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_57",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_58",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s3_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_60",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as "ipc_s3_920de190557a423391a34bf293f18214",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as "ipc_s3_95121ef1bfe540ce841c524334644148",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as "ipc_s3_e1a13d53b867440f8622bccebf54f176",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s3_547a07c2f94c4956997f0439626d0251",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as "ipc_s3_8ac792f53f3c49d3a80063c662bf00cd",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__66",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__67",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__68",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s3_a77f07b379134708a35414e503a948f1",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s3_example_skills_70",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_71",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s3_4c95559d86ff4b87a271e52388072a53",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__73",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_77",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as "ipc_s3_8c82f7573f404b09bdf478ee376f75a8",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s3_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__82",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__83",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "gad7_total_meaning",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person_91",max(case when linkid = 'task-id-019' then answer_value_text end) as "task-id-019",max(case when linkid = 'task-id-020' then answer_value_text end) as "task-id-020",max(case when linkid = 'task-id-021' then answer_value_text end) as "task-id-021",max(case when linkid = 'task-id-022' then answer_value_text end) as "task-id-022",max(case when linkid = 'task-id-023' then answer_value_text end) as "task-id-023",max(case when linkid = 'task-id-024' then answer_value_text end) as "task-id-024"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:49.351649 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:28:49.351930 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup" cascade
[0m09:28:49.352459 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:49.353099 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: Close
[0m09:28:49.353388 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109839d60>]}
[0m09:28:49.353697 [info ] [Thread-3 (]: 55 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [[32mCREATE VIEW[0m in 0.63s]
[0m09:28:49.354006 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_start_ipc_s2
[0m09:28:49.357364 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:28:49.358966 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:28:49.359218 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp" rename to "qr_start_ipc_s3"
[0m09:28:49.360801 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:49.361558 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:28:49.361763 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:28:49.362046 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:28:49.363240 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:49.364644 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup"
[0m09:28:49.364964 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:28:49.365140 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup" cascade
[0m09:28:49.365793 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:49.366627 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: Close
[0m09:28:49.366948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098811c0>]}
[0m09:28:49.367281 [info ] [Thread-2 (]: 56 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [[32mCREATE VIEW[0m in 0.63s]
[0m09:28:49.367562 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_start_ipc_s3
[0m09:28:49.540963 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.592 seconds
[0m09:28:49.544795 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:28:49.546014 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_start_ipc_s4
[0m09:28:49.551938 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:28:49.552501 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:28:49.552709 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: BEGIN
[0m09:28:49.553452 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:28:49.553642 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:28:49.554002 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 4 with readable column names
-- Questionnaire ID: 63
-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as "ipc_s4_phq9_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as "ipc_s4_gad7_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as "ipc_s4_ptsd_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s4_taskid_session_4_navigator",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_provider_pdf",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as "ipc_s4_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_client_pdf",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as "ipc_s4_what_we_know_is_that_symptoms_can_come_back_in_the",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s4_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as "ipc_s4_after_todays_session_i_can_refer_you_for_clinical_",max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as "ipc_s4_after_todays_session_i_will_be_referring_you_for_a",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri_14",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as "ipc_s4_how_does_it_make_you_feel_to_know_that_today_is_ou",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as "ipc_s4_how_do_you_feel_about_today_being_our_last_session",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as "ipc_s4_how_would_you_know_if_your_symptoms_are_coming_bac",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that_",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as "ipc_s4_please_select_how_you_would_like_to_proceed_with_t",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that__21",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s_22",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y_23",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s4_mood_rating_total",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as "ipc_s4_i_am_going_to_provide_you_with_our_agencys_contact",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard_28",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that_",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that__30",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as "ipc_s4_7fef53bc56db47ce8cba8efd4bcbc318",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "did_you_discuss_this_clients_severe_mental_health_screening",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "what_is_the_recommended_plan_to_address_the_probable_severe",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as "feeling_changed",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "referral_details_if_the_client_is_referred_out",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as "rerer",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as "20241031",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as "20250201",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as "is-connected-to-clinical-care-details",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as "is-connected-to-clinical-care-question"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:28:49.557964 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:28:49.559578 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:28:49.559767 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp" rename to "qr_start_ipc_s4"
[0m09:28:49.560762 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:28:49.561389 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:28:49.561582 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:28:49.561739 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:28:49.562649 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:28:49.563855 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup"
[0m09:28:49.564190 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:28:49.564372 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup" cascade
[0m09:28:49.564969 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:28:49.565818 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: Close
[0m09:28:49.566144 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d75804-aad9-48df-a9ac-a82e61717704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098787a0>]}
[0m09:28:49.566471 [info ] [Thread-4 (]: 57 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [[32mCREATE VIEW[0m in 0.62s]
[0m09:28:49.566753 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_start_ipc_s4
[0m09:28:49.567535 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:49.567734 [debug] [MainThread]: On master: BEGIN
[0m09:28:49.568052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:49.585662 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:28:49.586023 [debug] [MainThread]: On master: COMMIT
[0m09:28:49.586244 [debug] [MainThread]: Using postgres connection "master"
[0m09:28:49.586396 [debug] [MainThread]: On master: COMMIT
[0m09:28:49.586837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:28:49.587093 [debug] [MainThread]: On master: Close
[0m09:28:49.587352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:49.587497 [debug] [MainThread]: Connection 'model.engage_analytics.qr_registration_info_anon' was properly closed.
[0m09:28:49.587623 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s3' was properly closed.
[0m09:28:49.587742 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s2' was properly closed.
[0m09:28:49.587860 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s4' was properly closed.
[0m09:28:49.588132 [info ] [MainThread]: 
[0m09:28:49.588307 [info ] [MainThread]: Finished running 18 incremental models, 41 view models in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m09:28:49.591649 [debug] [MainThread]: Command end result
[0m09:28:49.620219 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:28:49.624924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:28:49.631203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:28:49.631483 [info ] [MainThread]: 
[0m09:28:49.631677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:49.631834 [info ] [MainThread]: 
[0m09:28:49.631991 [info ] [MainThread]: Done. PASS=59 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=59
[0m09:28:49.632374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.846768, "process_in_blocks": "0", "process_kernel_time": 0.413701, "process_mem_max_rss": "140623872", "process_out_blocks": "0", "process_user_time": 2.689388}
[0m09:28:49.632586 [debug] [MainThread]: Command `dbt run` succeeded at 09:28:49.632546 after 7.85 seconds
[0m09:28:49.632768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063605c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2ce90>]}
[0m09:28:49.632943 [debug] [MainThread]: Flushing usage events
[0m09:28:49.750599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:23.189465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f8a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a309610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a309310>]}


============================== 09:34:23.193937 | 76270a8e-4652-4bf3-82c2-ee76fefde625 ==============================
[0m09:34:23.193937 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:34:23.194300 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select patient_anon', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'write_json': 'True', 'introspect': 'True', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:34:23.309766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76270a8e-4652-4bf3-82c2-ee76fefde625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae93f50>]}
[0m09:34:23.339313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76270a8e-4652-4bf3-82c2-ee76fefde625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9d460>]}
[0m09:34:23.340169 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:34:23.395716 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:34:23.492268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:34:23.492811 [debug] [MainThread]: Partial parsing: updated file: engage_analytics://models/marts/patient_anon.sql
[0m09:34:23.624031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76270a8e-4652-4bf3-82c2-ee76fefde625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5f67e0>]}
[0m09:34:23.679225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:34:23.681250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:34:23.695818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76270a8e-4652-4bf3-82c2-ee76fefde625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b243d40>]}
[0m09:34:23.696163 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:34:23.696411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76270a8e-4652-4bf3-82c2-ee76fefde625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b085580>]}
[0m09:34:23.697729 [info ] [MainThread]: 
[0m09:34:23.697969 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:34:23.698119 [info ] [MainThread]: 
[0m09:34:23.698386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:34:23.698924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:34:23.728701 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:34:23.728980 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:34:23.729139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:23.771094 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.042 seconds
[0m09:34:23.772010 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:34:23.775701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m09:34:23.776059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_int'
[0m09:34:23.813252 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:34:23.813703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m09:34:23.814605 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:34:23.814816 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:34:23.815683 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:34:23.815836 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:34:23.815974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:23.816105 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:34:23.816240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:23.816548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:23.835683 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m09:34:23.835997 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:34:23.836192 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:34:23.837245 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m09:34:23.837516 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:34:23.837710 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:34:23.839041 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m09:34:23.839239 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:34:23.839402 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:34:23.840311 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.004 seconds
[0m09:34:23.841367 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:34:23.841618 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:34:23.842430 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:34:23.842623 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:34:23.842799 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m09:34:23.843520 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:34:23.843714 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:34:23.846191 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:34:23.851184 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:23.851417 [debug] [MainThread]: On master: BEGIN
[0m09:34:23.851557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:23.866948 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:34:23.867251 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:23.867451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:34:23.871648 [debug] [MainThread]: SQL status: SELECT 111 in 0.004 seconds
[0m09:34:23.880313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76270a8e-4652-4bf3-82c2-ee76fefde625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b998ec0>]}
[0m09:34:23.880642 [debug] [MainThread]: On master: ROLLBACK
[0m09:34:23.881460 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:23.881626 [debug] [MainThread]: On master: BEGIN
[0m09:34:23.882376 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:34:23.882542 [debug] [MainThread]: On master: COMMIT
[0m09:34:23.882684 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:23.882809 [debug] [MainThread]: On master: COMMIT
[0m09:34:23.883202 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:23.883360 [debug] [MainThread]: On master: Close
[0m09:34:23.885741 [debug] [Thread-1 (]: Began running node model.engage_analytics.patient_anon
[0m09:34:23.886066 [info ] [Thread-1 (]: 1 of 1 START sql view model engage_analytics_engage_analytics_mart.patient_anon  [RUN]
[0m09:34:23.886379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.patient_anon)
[0m09:34:23.886565 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.patient_anon
[0m09:34:23.890723 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.patient_anon"
[0m09:34:23.891596 [debug] [Thread-1 (]: Began executing node model.engage_analytics.patient_anon
[0m09:34:23.907945 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.patient_anon"
[0m09:34:23.908565 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:34:23.908740 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: BEGIN
[0m09:34:23.908894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:23.922867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m09:34:23.923191 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:34:23.923408 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized patient view with masked PII fields for data sharing
-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number
-- Pulls phone numbers from registration data when available

with patient_with_registration as (
    select 
        p.*,
        r."phone-number" as registration_phone
    from "airbyte"."engage_analytics_engage_analytics_mart"."patient" p
    left join "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info" r on p.id = r.subject_patient_id
)

select 
    -- Use hashed ID for referential integrity while maintaining privacy
    MD5(p.id::text) as patient_id_hash,
    
    -- Demographic information (non-PII)
    p.gender,
    p.age_years,  -- Age instead of birth_date for privacy
    p.deceased,
    p.active,
    p.registration_date,
    
    -- Masked name fields
    'REDACTED' as name_family_masked,
    'REDACTED' as name_given_masked,
    
    -- Masked contact information (use registration phone if patient phone is null)
    CASE 
        WHEN COALESCE(p.phone_number, p.registration_phone) IS NOT NULL 
            AND LENGTH(COALESCE(p.phone_number, p.registration_phone)) >= 4
        THEN 'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, p.registration_phone), 4)
        ELSE 'NO PHONE'
    END as phone_number_masked,
    
    -- Location and organization (reference IDs only, no PII)
    p.location_id,
    p.practitioner_id,
    p.practitioner_organization_id,
    p.practitioner_careteam_id,
    
    -- Metadata
    p._airbyte_emitted_at,
    CURRENT_TIMESTAMP as anonymized_at

from patient_with_registration p
  );
[0m09:34:23.927644 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:34:23.932158 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:34:23.932418 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon" rename to "patient_anon__dbt_backup"
[0m09:34:23.933410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:34:23.935170 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:34:23.935375 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp" rename to "patient_anon"
[0m09:34:23.936322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:34:23.944431 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:34:23.944713 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:34:23.944888 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:34:23.946935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:34:23.950343 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup"
[0m09:34:23.952920 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:34:23.953163 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup" cascade
[0m09:34:23.954996 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:34:23.956268 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: Close
[0m09:34:23.957453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76270a8e-4652-4bf3-82c2-ee76fefde625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0ab70>]}
[0m09:34:23.957943 [info ] [Thread-1 (]: 1 of 1 OK created sql view model engage_analytics_engage_analytics_mart.patient_anon  [[32mCREATE VIEW[0m in 0.07s]
[0m09:34:23.958248 [debug] [Thread-1 (]: Finished running node model.engage_analytics.patient_anon
[0m09:34:23.958977 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:23.959190 [debug] [MainThread]: On master: BEGIN
[0m09:34:23.959332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:23.975104 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:34:23.975487 [debug] [MainThread]: On master: COMMIT
[0m09:34:23.975675 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:23.975823 [debug] [MainThread]: On master: COMMIT
[0m09:34:23.976316 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:23.976523 [debug] [MainThread]: On master: Close
[0m09:34:23.976762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:23.977049 [debug] [MainThread]: Connection 'model.engage_analytics.patient_anon' was properly closed.
[0m09:34:23.977214 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_int' was properly closed.
[0m09:34:23.977339 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_mart' was properly closed.
[0m09:34:23.977490 [info ] [MainThread]: 
[0m09:34:23.977645 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m09:34:23.977959 [debug] [MainThread]: Command end result
[0m09:34:23.999035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:34:24.000361 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:34:24.004055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:34:24.004260 [info ] [MainThread]: 
[0m09:34:24.004479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:24.004622 [info ] [MainThread]: 
[0m09:34:24.004771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:34:24.005123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8617812, "process_in_blocks": "0", "process_kernel_time": 0.233075, "process_mem_max_rss": "140328960", "process_out_blocks": "0", "process_user_time": 1.276332}
[0m09:34:24.005418 [debug] [MainThread]: Command `dbt run` succeeded at 09:34:24.005369 after 0.86 seconds
[0m09:34:24.005630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a309490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3094c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a309310>]}
[0m09:34:24.005839 [debug] [MainThread]: Flushing usage events
[0m09:34:24.167661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:59.136846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107826fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a70d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a70d370>]}


============================== 09:34:59.140774 | df811774-22fe-44f0-909b-9f92526e0f01 ==============================
[0m09:34:59.140774 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:34:59.141121 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:34:59.246338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7f84a0>]}
[0m09:34:59.276857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7d7860>]}
[0m09:34:59.277713 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:34:59.330494 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:34:59.424299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:59.424549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:59.447576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b388230>]}
[0m09:34:59.497374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:34:59.499396 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:34:59.514719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b59fc50>]}
[0m09:34:59.515021 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:34:59.515196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a59a390>]}
[0m09:34:59.517005 [info ] [MainThread]: 
[0m09:34:59.517204 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:34:59.517346 [info ] [MainThread]: 
[0m09:34:59.517616 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:34:59.520774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:34:59.521214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:34:59.522490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:34:59.550079 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:34:59.550391 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:34:59.550597 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:34:59.550758 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:34:59.550929 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:34:59.551104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:59.551255 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:34:59.551471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:59.552955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:59.611678 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.059 seconds
[0m09:34:59.612030 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.061 seconds
[0m09:34:59.612846 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:34:59.613142 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.062 seconds
[0m09:34:59.613781 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:34:59.614391 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:34:59.616578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m09:34:59.620115 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:34:59.620508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m09:34:59.620772 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:34:59.621075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m09:34:59.622341 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:34:59.622533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:59.623446 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:34:59.623645 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:34:59.623958 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:34:59.624180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:59.624327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:59.652358 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m09:34:59.652740 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m09:34:59.653020 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m09:34:59.653176 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:34:59.653334 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:34:59.653472 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:34:59.653644 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:34:59.654106 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:34:59.654293 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:34:59.656511 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.002 seconds
[0m09:34:59.656745 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m09:34:59.656969 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m09:34:59.657974 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:34:59.658567 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:34:59.659298 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:34:59.659981 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:34:59.660167 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:34:59.660327 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:34:59.667696 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:59.667921 [debug] [MainThread]: On master: BEGIN
[0m09:34:59.668056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:59.687367 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m09:34:59.687665 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:59.687865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:34:59.691681 [debug] [MainThread]: SQL status: SELECT 112 in 0.004 seconds
[0m09:34:59.700244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b59d220>]}
[0m09:34:59.700560 [debug] [MainThread]: On master: ROLLBACK
[0m09:34:59.701425 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:59.701648 [debug] [MainThread]: On master: BEGIN
[0m09:34:59.702687 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:34:59.702858 [debug] [MainThread]: On master: COMMIT
[0m09:34:59.702998 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:59.703130 [debug] [MainThread]: On master: COMMIT
[0m09:34:59.703654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:59.703907 [debug] [MainThread]: On master: Close
[0m09:34:59.705801 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m09:34:59.706299 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m09:34:59.706122 [info ] [Thread-1 (]: 1 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m09:34:59.706746 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m09:34:59.706952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_careplans)
[0m09:34:59.706541 [info ] [Thread-2 (]: 2 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m09:34:59.707389 [info ] [Thread-3 (]: 3 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m09:34:59.707609 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m09:34:59.707781 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m09:34:59.707977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_careteams)
[0m09:34:59.708285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_encounter)
[0m09:34:59.717518 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m09:34:59.717844 [info ] [Thread-4 (]: 4 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m09:34:59.718107 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m09:34:59.718278 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m09:34:59.718700 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m09:34:59.730733 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m09:34:59.724019 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m09:34:59.736310 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m09:34:59.736632 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m09:34:59.763173 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:34:59.766195 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m09:34:59.766449 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

    
  
    

  create temporary table "stg_careplans__dbt_tmp093459751156"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans")

  );
  
  
[0m09:34:59.766802 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m09:34:59.767083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:59.769064 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:34:59.769443 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m09:34:59.769701 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

    
  
    

  create temporary table "stg_careteams__dbt_tmp093459768367"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams")

  );
  
  
[0m09:34:59.769906 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m09:34:59.771671 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:34:59.771933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:34:59.774490 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:34:59.774770 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

    
  
    

  create temporary table "stg_encounter__dbt_tmp093459771057"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter")

  );
  
  
[0m09:34:59.775089 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

    
  
    

  create temporary table "stg_locations__dbt_tmp093459773148"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations")

  );
  
  
[0m09:34:59.775351 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:34:59.775603 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:34:59.786310 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m09:34:59.823579 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:34:59.823932 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.052 seconds
[0m09:34:59.824297 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m09:34:59.826134 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:34:59.826449 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m09:34:59.827111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:34:59.827383 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.052 seconds
[0m09:34:59.827646 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:34:59.827818 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:34:59.829575 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:34:59.829789 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans__dbt_tmp093459751156'
        
      order by ordinal_position

  
[0m09:34:59.829994 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.055 seconds
[0m09:34:59.830156 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:34:59.830304 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m09:34:59.831811 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:34:59.832014 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams__dbt_tmp093459768367'
        
      order by ordinal_position

  
[0m09:34:59.832293 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m09:34:59.832665 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:34:59.832862 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:34:59.833152 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:34:59.833355 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations__dbt_tmp093459773148'
        
      order by ordinal_position

  
[0m09:34:59.833908 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:34:59.834323 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter__dbt_tmp093459771057'
        
      order by ordinal_position

  
[0m09:34:59.835281 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.005 seconds
[0m09:34:59.838191 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:34:59.838444 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.838665 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.004 seconds
[0m09:34:59.838851 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.006 seconds
[0m09:34:59.840591 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:34:59.840875 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.006 seconds
[0m09:34:59.842510 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:34:59.842730 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.004 seconds
[0m09:34:59.842979 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.844621 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:34:59.844830 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.848636 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:34:59.848940 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.849238 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.850896 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:34:59.853730 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:34:59.854090 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.005 seconds
[0m09:34:59.854363 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.854550 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.005 seconds
[0m09:34:59.854774 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.006 seconds
[0m09:34:59.856330 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:34:59.862181 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.006 seconds
[0m09:34:59.864358 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m09:34:59.866053 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:34:59.866289 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.867296 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m09:34:59.867596 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.868265 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:34:59.868516 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careteams__dbt_tmp093459768367" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" ("id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource")
    (
        select "id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource"
        from "stg_careteams__dbt_tmp093459768367"
    )
  
[0m09:34:59.868794 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:34:59.869112 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careplans__dbt_tmp093459751156" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" ("id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at"
        from "stg_careplans__dbt_tmp093459751156"
    )
  
[0m09:34:59.869587 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:34:59.869800 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:34:59.876101 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m09:34:59.877204 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:34:59.877413 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.010 seconds
[0m09:34:59.878567 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m09:34:59.879380 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:34:59.879585 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:34:59.880527 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m09:34:59.880813 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:34:59.881029 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:34:59.881310 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:34:59.881569 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:34:59.881856 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_locations__dbt_tmp093459773148" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" ("id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference")
    (
        select "id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference"
        from "stg_locations__dbt_tmp093459773148"
    )
  
[0m09:34:59.882135 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:34:59.882335 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_encounter__dbt_tmp093459771057" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" ("id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at"
        from "stg_encounter__dbt_tmp093459771057"
    )
  
[0m09:34:59.882748 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:34:59.882976 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:34:59.883143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:34:59.884091 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m09:34:59.884276 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:34:59.885003 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:34:59.885406 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m09:34:59.886048 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:34:59.886968 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:34:59.887410 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:34:59.887654 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:34:59.887835 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:34:59.888046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0ad50>]}
[0m09:34:59.888311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf58800>]}
[0m09:34:59.888736 [info ] [Thread-2 (]: 2 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mINSERT 0 0[0m in 0.18s]
[0m09:34:59.889245 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:34:59.888978 [info ] [Thread-1 (]: 1 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mINSERT 0 0[0m in 0.18s]
[0m09:34:59.889559 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m09:34:59.889723 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:34:59.890071 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m09:34:59.890311 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m09:34:59.890511 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m09:34:59.890864 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m09:34:59.891093 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_organizations
[0m09:34:59.891306 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a598e90>]}
[0m09:34:59.891555 [info ] [Thread-2 (]: 5 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m09:34:59.891937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd01340>]}
[0m09:34:59.892248 [info ] [Thread-1 (]: 6 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m09:34:59.892672 [info ] [Thread-4 (]: 4 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mINSERT 0 0[0m in 0.17s]
[0m09:34:59.892963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_organization_affiliations)
[0m09:34:59.893516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_organizations)
[0m09:34:59.893341 [info ] [Thread-3 (]: 3 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mINSERT 0 0[0m in 0.18s]
[0m09:34:59.893865 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m09:34:59.894149 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m09:34:59.894372 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_organizations
[0m09:34:59.894623 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m09:34:59.894825 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_patient
[0m09:34:59.897463 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.899770 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m09:34:59.900032 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_practitioner
[0m09:34:59.900338 [info ] [Thread-4 (]: 7 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m09:34:59.901043 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_patient)
[0m09:34:59.900821 [info ] [Thread-3 (]: 8 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m09:34:59.901321 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_patient
[0m09:34:59.901525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_practitioner)
[0m09:34:59.904069 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m09:34:59.904315 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_organizations
[0m09:34:59.904610 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m09:34:59.904911 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m09:34:59.907052 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:34:59.910933 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m09:34:59.913089 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.913373 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

    
  
    

  create temporary table "stg_organizations__dbt_tmp093459906325"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  -- this filter will only be applied on an incremental run
   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations")

  );
  
  
[0m09:34:59.913658 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_patient
[0m09:34:59.913888 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

    
  
    

  create temporary table "stg_organization_affiliations__dbt_tmp093459912287"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations")

  );
  
  
[0m09:34:59.914098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:59.916322 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:34:59.916645 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:34:59.917535 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

    
  
    

  create temporary table "stg_patient__dbt_tmp093459915436"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient")

  );
  
  
[0m09:34:59.917961 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_practitioner
[0m09:34:59.918567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:34:59.920936 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:34:59.921390 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

    
  
    

  create temporary table "stg_practitioner__dbt_tmp093459920117"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner")

  );
  
  
[0m09:34:59.921635 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:34:59.942576 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.026 seconds
[0m09:34:59.944449 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.944757 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.023 seconds
[0m09:34:59.945038 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m09:34:59.945278 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m09:34:59.945474 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.027 seconds
[0m09:34:59.947172 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:34:59.948574 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:34:59.950412 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:34:59.950693 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m09:34:59.950956 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m09:34:59.951179 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m09:34:59.951347 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: BEGIN
[0m09:34:59.951517 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.951879 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations__dbt_tmp093459912287'
        
      order by ordinal_position

  
[0m09:34:59.952295 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:34:59.952540 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:34:59.952706 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:34:59.952868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:34:59.953027 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:34:59.953237 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner__dbt_tmp093459920117'
        
      order by ordinal_position

  
[0m09:34:59.953680 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:34:59.953934 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient__dbt_tmp093459915436'
        
      order by ordinal_position

  
[0m09:34:59.954372 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations__dbt_tmp093459906325'
        
      order by ordinal_position

  
[0m09:34:59.957359 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.005 seconds
[0m09:34:59.959257 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.959574 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.005 seconds
[0m09:34:59.959837 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.960030 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.006 seconds
[0m09:34:59.960192 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m09:34:59.962759 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:34:59.964922 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:34:59.966480 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:34:59.966669 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:34:59.966857 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.967047 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.967227 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.968599 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.969060 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.971147 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:34:59.971511 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m09:34:59.971732 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.003 seconds
[0m09:34:59.973621 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:34:59.973836 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:34:59.975300 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:34:59.976737 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:34:59.976999 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.978094 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.978304 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.978496 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:34:59.979431 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.979723 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organization_affiliations__dbt_tmp093459912287" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" ("id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at"
        from "stg_organization_affiliations__dbt_tmp093459912287"
    )
  
[0m09:34:59.980962 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.002 seconds
[0m09:34:59.981301 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:34:59.982605 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m09:34:59.982831 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:34:59.983045 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m09:34:59.983930 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m09:34:59.985207 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m09:34:59.986002 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:34:59.986324 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:34:59.986608 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:34:59.986861 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_patient__dbt_tmp093459915436" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" ("id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at")
    (
        select "id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at"
        from "stg_patient__dbt_tmp093459915436"
    )
  
[0m09:34:59.987157 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:34:59.987387 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:34:59.987612 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:34:59.987954 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organizations__dbt_tmp093459906325" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" ("id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at")
    (
        select "id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at"
        from "stg_organizations__dbt_tmp093459906325"
    )
  
[0m09:34:59.988235 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner__dbt_tmp093459920117" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" ("id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at"
        from "stg_practitioner__dbt_tmp093459920117"
    )
  
[0m09:34:59.989057 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:34:59.989329 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:34:59.989560 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:34:59.989741 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:34:59.990191 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m09:34:59.990916 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:34:59.991565 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:34:59.992146 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:34:59.992516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c003500>]}
[0m09:34:59.992774 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:34:59.993022 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:34:59.993240 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:34:59.993827 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:34:59.993632 [info ] [Thread-2 (]: 5 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mINSERT 0 0[0m in 0.10s]
[0m09:34:59.994111 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:34:59.994369 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:34:59.994669 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m09:34:59.995061 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m09:34:59.995370 [info ] [Thread-2 (]: 9 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m09:34:59.995649 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:34:59.995858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:34:59.996111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_practitioner_roles)
[0m09:34:59.996294 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:34:59.996784 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: Close
[0m09:34:59.997134 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: Close
[0m09:34:59.997386 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m09:34:59.997797 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: Close
[0m09:34:59.998146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c023b30>]}
[0m09:34:59.998445 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b59cda0>]}
[0m09:35:00.001235 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.001686 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf406b0>]}
[0m09:35:00.001966 [info ] [Thread-1 (]: 6 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mINSERT 0 0[0m in 0.10s]
[0m09:35:00.002375 [info ] [Thread-4 (]: 7 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mINSERT 0 0[0m in 0.10s]
[0m09:35:00.002832 [info ] [Thread-3 (]: 8 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mINSERT 0 0[0m in 0.10s]
[0m09:35:00.003157 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_organizations
[0m09:35:00.003472 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_patient
[0m09:35:00.003771 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_practitioner
[0m09:35:00.003999 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m09:35:00.004238 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m09:35:00.004482 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_task
[0m09:35:00.004703 [debug] [Thread-3 (]: Began running node model.engage_analytics.unnested_careteams
[0m09:35:00.007705 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.008053 [info ] [Thread-1 (]: 10 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m09:35:00.008337 [info ] [Thread-4 (]: 11 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m09:35:00.008593 [info ] [Thread-3 (]: 12 of 59 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m09:35:00.008886 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

    
  
    

  create temporary table "stg_practitioner_roles__dbt_tmp093500006114"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles")

  );
  
  
[0m09:35:00.009232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_questionnaire_response)
[0m09:35:00.009494 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.stg_task)
[0m09:35:00.009687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.unnested_careteams)
[0m09:35:00.009876 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:00.010083 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m09:35:00.010308 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_task
[0m09:35:00.010519 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m09:35:00.012765 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.015371 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m09:35:00.017102 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m09:35:00.017740 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m09:35:00.019523 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.019845 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

    
  
    

  create temporary table "stg_questionnaire_response__dbt_tmp093500018871"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response")

  );
  
  
[0m09:35:00.020137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:00.020343 [debug] [Thread-3 (]: Began executing node model.engage_analytics.unnested_careteams
[0m09:35:00.020588 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_task
[0m09:35:00.030482 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m09:35:00.030796 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:35:00.032804 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:35:00.034530 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.034810 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

    
  
    

  create temporary table "stg_task__dbt_tmp093500032159"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task")

  );
  
  
[0m09:35:00.035162 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m09:35:00.035484 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:35:00.035707 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:00.035984 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m09:35:00.036327 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:00.036547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:00.036763 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.037041 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles__dbt_tmp093500006114'
        
      order by ordinal_position

  
[0m09:35:00.039860 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:35:00.042421 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.042692 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m09:35:00.042943 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.006 seconds
[0m09:35:00.044721 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.045004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m09:35:00.045267 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:35:00.045519 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.045797 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response__dbt_tmp093500018871'
        
      order by ordinal_position

  
[0m09:35:00.047770 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:35:00.049460 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.049782 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:35:00.050112 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m09:35:00.051899 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.052151 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:35:00.052379 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:35:00.053395 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.054214 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.054486 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m09:35:00.054686 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner_roles__dbt_tmp093500006114" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" ("id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at"
        from "stg_practitioner_roles__dbt_tmp093500006114"
    )
  
[0m09:35:00.054861 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m09:35:00.056650 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.056951 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:35:00.057218 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:35:00.057507 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m09:35:00.057747 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:35:00.058570 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:35:00.058845 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:35:00.059033 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:35:00.059408 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:35:00.062984 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:35:00.063285 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m09:35:00.063535 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m09:35:00.063736 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams" rename to "unnested_careteams__dbt_backup"
[0m09:35:00.064150 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m09:35:00.065360 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.065837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c026fc0>]}
[0m09:35:00.066201 [info ] [Thread-2 (]: 9 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mINSERT 0 0[0m in 0.07s]
[0m09:35:00.066501 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m09:35:00.066691 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:00.066916 [debug] [Thread-2 (]: Began running node model.engage_analytics.encounters
[0m09:35:00.068507 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:35:00.069182 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.068918 [info ] [Thread-2 (]: 13 of 59 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m09:35:00.069539 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m09:35:00.069822 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_questionnaire_response__dbt_tmp093500018871" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" ("id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at")
    (
        select "id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at"
        from "stg_questionnaire_response__dbt_tmp093500018871"
    )
  
[0m09:35:00.070076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.encounters)
[0m09:35:00.070328 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.encounters
[0m09:35:00.077258 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m09:35:00.077614 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:35:00.078514 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:35:00.082737 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.084577 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:35:00.084829 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:35:00.085045 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m09:35:00.085229 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:35:00.085439 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:35:00.085786 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:00.085978 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:35:00.087457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.087743 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.088349 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m09:35:00.092913 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m09:35:00.093218 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.057 seconds
[0m09:35:00.093593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0addf0>]}
[0m09:35:00.096386 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:35:00.098098 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:35:00.098551 [info ] [Thread-1 (]: 10 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mINSERT 0 0[0m in 0.08s]
[0m09:35:00.098795 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m09:35:00.098990 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: BEGIN
[0m09:35:00.099276 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m09:35:00.099637 [debug] [Thread-1 (]: Began running node model.engage_analytics.organization_affiliations
[0m09:35:00.100183 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:00.099934 [info ] [Thread-1 (]: 14 of 59 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m09:35:00.100548 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:35:00.100861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.organization_affiliations)
[0m09:35:00.101103 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:35:00.101303 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_task__dbt_tmp093500032159'
        
      order by ordinal_position

  
[0m09:35:00.101485 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.016 seconds
[0m09:35:00.101654 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m09:35:00.102372 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: Close
[0m09:35:00.103145 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.105412 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m09:35:00.105765 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m09:35:00.106083 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba3a210>]}
[0m09:35:00.106346 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.004 seconds
[0m09:35:00.106862 [info ] [Thread-3 (]: 12 of 59 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.10s]
[0m09:35:00.108889 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:35:00.109202 [debug] [Thread-3 (]: Finished running node model.engage_analytics.unnested_careteams
[0m09:35:00.109389 [debug] [Thread-1 (]: Began executing node model.engage_analytics.organization_affiliations
[0m09:35:00.109624 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:35:00.109911 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:35:00.110152 [debug] [Thread-3 (]: Began running node model.engage_analytics.organizations
[0m09:35:00.112193 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:35:00.113387 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.113832 [info ] [Thread-3 (]: 15 of 59 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m09:35:00.114136 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

    
  
    

  create temporary table "organization_affiliations__dbt_tmp093500111475"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

where s._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
)

  );
  
  
[0m09:35:00.114420 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m09:35:00.114671 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:35:00.114935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.organizations)
[0m09:35:00.115155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:00.117103 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:35:00.117343 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.organizations
[0m09:35:00.117540 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.002 seconds
[0m09:35:00.117795 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:35:00.119918 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:35:00.120852 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.121175 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m09:35:00.121545 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m09:35:00.121875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:00.123158 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:35:00.124757 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m09:35:00.125048 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:35:00.126895 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m09:35:00.127399 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:35:00.127660 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_task__dbt_tmp093500032159" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" ("id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at")
    (
        select "id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at"
        from "stg_task__dbt_tmp093500032159"
    )
  
[0m09:35:00.127998 [debug] [Thread-2 (]: Began executing node model.engage_analytics.encounters
[0m09:35:00.130176 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.130482 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m09:35:00.130925 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    
  
    

  create temporary table "encounters__dbt_tmp093500129398"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."encounters")

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

where e._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
)

  );
  
  
[0m09:35:00.132071 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:35:00.132440 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:35:00.132644 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:35:00.133524 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.134015 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: Close
[0m09:35:00.134414 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdfc080>]}
[0m09:35:00.134851 [info ] [Thread-4 (]: 11 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mINSERT 0 0[0m in 0.12s]
[0m09:35:00.135188 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_task
[0m09:35:00.135450 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:35:00.135757 [debug] [Thread-4 (]: Began running node model.engage_analytics.patient
[0m09:35:00.136031 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m09:35:00.138762 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:35:00.140812 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.141084 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m09:35:00.141295 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m09:35:00.139211 [info ] [Thread-4 (]: 16 of 59 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m09:35:00.141596 [debug] [Thread-2 (]: On model.engage_analytics.encounters: BEGIN
[0m09:35:00.142947 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m09:35:00.143346 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.patient)
[0m09:35:00.143808 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.patient
[0m09:35:00.146373 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m09:35:00.146647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m09:35:00.146946 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m09:35:00.147290 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:35:00.147550 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.147793 [debug] [Thread-3 (]: Began executing node model.engage_analytics.organizations
[0m09:35:00.148050 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations__dbt_tmp093500111475'
        
      order by ordinal_position

  
[0m09:35:00.148280 [debug] [Thread-4 (]: Began executing node model.engage_analytics.patient
[0m09:35:00.148511 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'encounters__dbt_tmp093500129398'
        
      order by ordinal_position

  
[0m09:35:00.150491 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:35:00.152413 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:35:00.152760 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    
  
    

  create temporary table "organizations__dbt_tmp093500149725"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

where o._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
)

  );
  
  
[0m09:35:00.153186 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp093500151691"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    DATE_PART('year', AGE(stp.birthDate::date))::integer as age_years,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m09:35:00.153535 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:00.154747 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m09:35:00.154990 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.001 seconds
[0m09:35:00.156821 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:35:00.157115 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.004 seconds
[0m09:35:00.158794 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:35:00.159160 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.160941 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.161296 [debug] [Thread-3 (]: On model.engage_analytics.organizations: BEGIN
[0m09:35:00.161651 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.162366 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:00.162582 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:35:00.162781 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organizations__dbt_tmp093500149725'
        
      order by ordinal_position

  
[0m09:35:00.163851 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m09:35:00.164123 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.002 seconds
[0m09:35:00.165810 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:35:00.168644 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.168928 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.006 seconds
[0m09:35:00.169167 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.169374 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.170924 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:35:00.171397 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.172084 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.019 seconds
[0m09:35:00.173750 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:35:00.174079 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.002 seconds
[0m09:35:00.174294 [debug] [Thread-4 (]: On model.engage_analytics.patient: BEGIN
[0m09:35:00.174454 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m09:35:00.174654 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.003 seconds
[0m09:35:00.176245 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:35:00.177234 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m09:35:00.177492 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:00.178682 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m09:35:00.178949 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.179265 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:35:00.179766 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:35:00.180003 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp093500151691'
        
      order by ordinal_position

  
[0m09:35:00.180276 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organization_affiliations__dbt_tmp093500111475" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" ("id", "organization_id", "location_id", "_airbyte_emitted_at")
    (
        select "id", "organization_id", "location_id", "_airbyte_emitted_at"
        from "organization_affiliations__dbt_tmp093500111475"
    )
  
[0m09:35:00.180500 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.180760 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."encounters" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "encounters__dbt_tmp093500129398" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."encounters" ("id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at")
    (
        select "id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at"
        from "encounters__dbt_tmp093500129398"
    )
  
[0m09:35:00.181533 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:35:00.181793 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.002 seconds
[0m09:35:00.182529 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:35:00.182727 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:35:00.183690 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m09:35:00.183970 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:35:00.184880 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m09:35:00.185156 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.004 seconds
[0m09:35:00.185465 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:35:00.185733 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:35:00.187598 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:35:00.187979 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:35:00.188201 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m09:35:00.188425 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.188692 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organizations__dbt_tmp093500149725" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organizations" ("id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at")
    (
        select "id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at"
        from "organizations__dbt_tmp093500149725"
    )
  
[0m09:35:00.188927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.189429 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: Close
[0m09:35:00.189615 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.189799 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:35:00.190067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c12d3d0>]}
[0m09:35:00.190414 [debug] [Thread-2 (]: On model.engage_analytics.encounters: Close
[0m09:35:00.191107 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m09:35:00.191302 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.002 seconds
[0m09:35:00.191610 [info ] [Thread-1 (]: 14 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mINSERT 0 0[0m in 0.09s]
[0m09:35:00.191953 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c140890>]}
[0m09:35:00.192155 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:35:00.193939 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:35:00.194335 [debug] [Thread-1 (]: Finished running node model.engage_analytics.organization_affiliations
[0m09:35:00.194898 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m09:35:00.194702 [info ] [Thread-2 (]: 13 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mINSERT 0 0[0m in 0.12s]
[0m09:35:00.195209 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.195434 [debug] [Thread-1 (]: Began running node model.engage_analytics.practitioner_role
[0m09:35:00.195762 [debug] [Thread-2 (]: Finished running node model.engage_analytics.encounters
[0m09:35:00.196294 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.196088 [info ] [Thread-1 (]: 17 of 59 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m09:35:00.196583 [debug] [Thread-2 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m09:35:00.197016 [debug] [Thread-3 (]: On model.engage_analytics.organizations: Close
[0m09:35:00.197236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.practitioner_role)
[0m09:35:00.197471 [info ] [Thread-2 (]: 18 of 59 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m09:35:00.197751 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.practitioner_role
[0m09:35:00.197997 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.002 seconds
[0m09:35:00.198216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.int_qr_answers_long)
[0m09:35:00.198525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0a7950>]}
[0m09:35:00.200915 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m09:35:00.202377 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m09:35:00.202653 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m09:35:00.203090 [info ] [Thread-3 (]: 15 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mINSERT 0 0[0m in 0.08s]
[0m09:35:00.205056 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m09:35:00.205483 [debug] [Thread-3 (]: Finished running node model.engage_analytics.organizations
[0m09:35:00.205809 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_header
[0m09:35:00.206088 [debug] [Thread-1 (]: Began executing node model.engage_analytics.practitioner_role
[0m09:35:00.206329 [info ] [Thread-3 (]: 19 of 59 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m09:35:00.208333 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:35:00.208614 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:35:00.208870 [debug] [Thread-2 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m09:35:00.210309 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.int_qr_header)
[0m09:35:00.210593 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

    
  
    

  create temporary table "practitioner_role__dbt_tmp093500207575"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

where spr._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01')
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
)

  );
  
  
[0m09:35:00.210860 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp093500151691" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "age_years", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "age_years", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp093500151691"
    )
  
[0m09:35:00.212567 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m09:35:00.212823 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_header
[0m09:35:00.213054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:00.214904 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m09:35:00.215182 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:35:00.216115 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m09:35:00.216337 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:35:00.216577 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m09:35:00.216911 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:35:00.217090 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m09:35:00.217293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:00.217633 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_header
[0m09:35:00.217887 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.219666 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m09:35:00.220092 [debug] [Thread-4 (]: On model.engage_analytics.patient: Close
[0m09:35:00.220572 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c18eea0>]}
[0m09:35:00.221266 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:35:00.221574 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m09:35:00.221016 [info ] [Thread-4 (]: 16 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.08s]
[0m09:35:00.221830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:00.222155 [debug] [Thread-4 (]: Finished running node model.engage_analytics.patient
[0m09:35:00.222510 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_tags
[0m09:35:00.222995 [info ] [Thread-4 (]: 20 of 59 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m09:35:00.223402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.int_qr_tags)
[0m09:35:00.223623 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m09:35:00.225709 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m09:35:00.226156 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_tags
[0m09:35:00.228430 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:35:00.228867 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

    
  
    

  create temporary table "int_qr_tags__dbt_tmp093500227589"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags")

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m09:35:00.229239 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:00.233188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m09:35:00.233520 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:35:00.233779 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m09:35:00.234547 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:35:00.236259 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:35:00.236486 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:00.236752 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m09:35:00.238504 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:35:00.238904 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" rename to "int_qr_answers_long__dbt_backup"
[0m09:35:00.239272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:00.239450 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:35:00.239634 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role__dbt_tmp093500207575'
        
      order by ordinal_position

  
[0m09:35:00.239927 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m09:35:00.240105 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:00.240311 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:35:00.242147 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:35:00.242421 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m09:35:00.242711 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m09:35:00.243748 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:00.243976 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m09:35:00.244171 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:35:00.245117 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:35:00.247772 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:35:00.249233 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:35:00.249533 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:35:00.249802 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:35:00.250070 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.250286 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" rename to "int_qr_header__dbt_backup"
[0m09:35:00.251912 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:35:00.252115 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:35:00.252429 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m09:35:00.253129 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:00.253406 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:00.254969 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:35:00.255180 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:35:00.255386 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m09:35:00.255569 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:35:00.255793 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m09:35:00.257460 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m09:35:00.259127 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:35:00.259372 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags__dbt_tmp093500227589'
        
      order by ordinal_position

  
[0m09:35:00.259691 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:35:00.259896 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:00.260101 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:00.260288 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m09:35:00.260957 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:35:00.261164 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:35:00.261326 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:35:00.262004 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.263374 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m09:35:00.263600 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m09:35:00.263883 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:35:00.264049 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.004 seconds
[0m09:35:00.265048 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m09:35:00.265258 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m09:35:00.266691 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:35:00.267129 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:35:00.267522 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:35:00.267826 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioner_role__dbt_tmp093500207575" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" ("id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at")
    (
        select "id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at"
        from "practitioner_role__dbt_tmp093500207575"
    )
  
[0m09:35:00.268736 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:35:00.269440 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:35:00.269627 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.002 seconds
[0m09:35:00.269798 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:35:00.271327 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:35:00.271622 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:35:00.271861 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:35:00.273443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.273866 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: Close
[0m09:35:00.274084 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.002 seconds
[0m09:35:00.274347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c18f440>]}
[0m09:35:00.275345 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m09:35:00.276003 [info ] [Thread-1 (]: 17 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mINSERT 0 0[0m in 0.08s]
[0m09:35:00.276398 [debug] [Thread-1 (]: Finished running node model.engage_analytics.practitioner_role
[0m09:35:00.276790 [debug] [Thread-1 (]: Began running node model.engage_analytics.current_practitioner_role
[0m09:35:00.277041 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:35:00.277315 [info ] [Thread-1 (]: 21 of 59 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m09:35:00.277569 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" as DBT_INTERNAL_DEST
        where (resource_id) in (
            select distinct resource_id
            from "int_qr_tags__dbt_tmp093500227589" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" ("resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version")
    (
        select "resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version"
        from "int_qr_tags__dbt_tmp093500227589"
    )
  
[0m09:35:00.277833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.current_practitioner_role)
[0m09:35:00.278063 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m09:35:00.280517 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m09:35:00.280775 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m09:35:00.281527 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:35:00.281729 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:35:00.281890 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:35:00.282170 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:35:00.282984 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m09:35:00.283210 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.283430 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m09:35:00.283777 [debug] [Thread-1 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m09:35:00.284500 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdc0a70>]}
[0m09:35:00.284972 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: Close
[0m09:35:00.285784 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: Close
[0m09:35:00.287454 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m09:35:00.287804 [info ] [Thread-2 (]: 18 of 59 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.09s]
[0m09:35:00.288184 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c21b980>]}
[0m09:35:00.288616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b599970>]}
[0m09:35:00.289074 [debug] [Thread-2 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m09:35:00.289368 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:35:00.289734 [info ] [Thread-4 (]: 20 of 59 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mINSERT 0 0[0m in 0.06s]
[0m09:35:00.290162 [info ] [Thread-3 (]: 19 of 59 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.08s]
[0m09:35:00.290519 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m09:35:00.290826 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_tags
[0m09:35:00.291117 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_header
[0m09:35:00.291313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:00.291966 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m09:35:00.292211 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:35:00.292660 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_confidential_s1
[0m09:35:00.292483 [info ] [Thread-2 (]: 22 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m09:35:00.292939 [info ] [Thread-4 (]: 23 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [RUN]
[0m09:35:00.293292 [info ] [Thread-3 (]: 24 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [RUN]
[0m09:35:00.293713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.qr_1_month_follow_up)
[0m09:35:00.293929 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.qr_common_mental_health_symptoms)
[0m09:35:00.294213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.qr_confidential_s1)
[0m09:35:00.294481 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m09:35:00.294707 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:35:00.294914 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_confidential_s1
[0m09:35:00.301373 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:35:00.303800 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:35:00.306018 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:35:00.306621 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:00.306955 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:00.307212 [debug] [Thread-3 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:00.307531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:35:00.307794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:00.308050 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:00.308318 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:00.308521 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:35:00.309072 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m09:35:00.311373 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:00.313243 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:35:00.313453 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" rename to "current_practitioner_role__dbt_backup"
[0m09:35:00.314275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:00.315807 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:35:00.316006 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m09:35:00.316791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:00.317695 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:35:00.317926 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:35:00.318101 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:35:00.319369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:00.321030 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m09:35:00.321400 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:35:00.321598 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m09:35:00.323041 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:00.323835 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: Close
[0m09:35:00.324166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdc1760>]}
[0m09:35:00.324495 [info ] [Thread-1 (]: 21 of 59 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.05s]
[0m09:35:00.324775 [debug] [Thread-1 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m09:35:00.325009 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_financial_wellness_tool
[0m09:35:00.325220 [info ] [Thread-1 (]: 25 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [RUN]
[0m09:35:00.325432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.qr_financial_wellness_tool)
[0m09:35:00.325655 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_financial_wellness_tool
[0m09:35:00.328261 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:35:00.328517 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:00.328708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:01.006298 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.698 seconds
[0m09:35:01.009341 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:35:01.011399 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m09:35:01.014222 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:35:01.015075 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:35:01.015303 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m09:35:01.016196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:01.016375 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:35:01.016611 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- 1 month follow up with readable column names
-- Questionnaire ID: 1-month-follow-up
-- Source file: questionnaire/1-month-follow-up.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'completed-all-recommended-interventions' then answer_value_text end) as "completed-all-recommended-interventions",max(case when linkid = 'schedule-this-meeting' then answer_value_text end) as "schedule-this-meeting"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:01.055919 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m09:35:01.016962 [debug] [Thread-4 (]: SQL status: SELECT 36 in 0.709 seconds
[0m09:35:01.056461 [debug] [Thread-1 (]: SQL status: SELECT 23 in 0.728 seconds
[0m09:35:01.058392 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:35:01.058742 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.750 seconds
[0m09:35:01.060122 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:35:01.061115 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:35:01.061463 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m09:35:01.062467 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_confidential_s1"
[0m09:35:01.063331 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_confidential_s1
[0m09:35:01.063576 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:35:01.065574 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_confidential_s1"
[0m09:35:01.065832 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:35:01.066100 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_financial_wellness_tool
[0m09:35:01.067762 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:35:01.068702 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:35:01.070476 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:35:01.070849 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:35:01.071108 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:35:01.071382 [debug] [Thread-3 (]: On model.engage_analytics.qr_confidential_s1: BEGIN
[0m09:35:01.071631 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:35:01.071949 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:35:01.072169 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:35:01.072412 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: BEGIN
[0m09:35:01.072647 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:01.072891 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: BEGIN
[0m09:35:01.073149 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:01.073374 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:35:01.074737 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m09:35:01.074982 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:35:01.075305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m09:35:01.075605 [debug] [Thread-3 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Discuss Confidentiality with readable column names
-- Questionnaire ID: 23451
-- Source file: questionnaire/ipc-session-1/confidential-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:01.076272 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:35:01.076551 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:35:01.076773 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:35:01.077096 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m09:35:01.077488 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Common Mental Health Symptoms with readable column names
-- Questionnaire ID: q-common-mental-health-symptoms
-- Source file: questionnaire/assessments/common-mental-health-symptoms.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "total_score",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrfeeling",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "total_score_meaning",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brrepeat",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "total_score_5",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrloss_of",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brhaving",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "total_score_meaning_9",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "how_difficult_have_these_problems_made_it_for_you_to_do_your",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "total_score_11",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brfeelin",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "total_score_meaning_13",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi_14",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrhaving",max(case when linkid = 'f1.10.1' then answer_value_text end) as "f1.10.1",max(case when linkid = 'f1.11.1' then answer_value_text end) as "f1.11.1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "f1.15.1",max(case when linkid = 'f1.16.1' then answer_value_text end) as "f1.16.1",max(case when linkid = 'f1.17.1' then answer_value_text end) as "f1.17.1",max(case when linkid = 'f1.18.1' then answer_value_text end) as "f1.18.1",max(case when linkid = 'f1.19.1' then answer_value_text end) as "f1.19.1",max(case when linkid = 'f1.20.1' then answer_value_text end) as "f1.20.1",max(case when linkid = 'f1.21.1' then answer_value_text end) as "f1.21.1",max(case when linkid = 'f1.3.1' then answer_value_text end) as "f1.3.1",max(case when linkid = 'f1.4.1' then answer_value_text end) as "f1.4.1",max(case when linkid = 'f1.5.1' then answer_value_text end) as "f1.5.1",max(case when linkid = 'f1.6.1' then answer_value_text end) as "f1.6.1",max(case when linkid = 'f1.7.1' then answer_value_text end) as "f1.7.1",max(case when linkid = 'f1.8.1' then answer_value_text end) as "f1.8.1",max(case when linkid = 'f1.9.1' then answer_value_text end) as "f1.9.1",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'show-pcl-5-to-8-questions' then answer_value_text end) as "show-pcl-5-to-8-questions",max(case when linkid = 'task-id-common-mental-pdf' then answer_value_text end) as "task-id-common-mental-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:01.077994 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Financial Wellness Tool with readable column names
-- Questionnaire ID: q-financial-wellness-tool
-- Source file: questionnaire/assessments/financial-wellness-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '21234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_there_a_time_when_you_or",max(case when linkid = '31234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo",max(case when linkid = '3456789a-bcde-f012-3456-789abcdef012' then answer_value_text end) as "financial_how_hard_is_it_for_you_to_pay_for_the_very_basics_",max(case when linkid = '51234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_how_strongly_do_you_agree_or_disagree_with_the_fol",max(case when linkid = '61234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_move_in_with_other_p",max(case when linkid = '6789abcd-ef01-2345-6789-abcdef012345' then answer_value_text end) as "financial_in_the_past_12_months_how_often_did_you_run_out_of",max(case when linkid = '91234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_stay_at_a_shelter_in",max(case when linkid = 'c1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo_8",max(case when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab' then answer_value_text end) as "financial_i_worried_whether_my_food_would_run_out_before_i_g",max(case when linkid = 'f0123456-789a-bcde-f012-3456789abcde' then answer_value_text end) as "financial_the_food_that_i_bought_just_didnt_last_and_i_didnt",max(case when linkid = 'f1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_your_phone_gas_heating_w",max(case when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d' then answer_value_text end) as "financial_when_you_think_about_your_financial_situation_how_",max(case when linkid = 'high-debt' then answer_value_text end) as "high-debt",max(case when linkid = 'high-food-insecurity' then answer_value_text end) as "high-food-insecurity",max(case when linkid = 'high-housing-insecurity' then answer_value_text end) as "high-housing-insecurity",max(case when linkid = 'high-paying-bills' then answer_value_text end) as "high-paying-bills",max(case when linkid = 'moderate-debt' then answer_value_text end) as "moderate-debt",max(case when linkid = 'moderate-food-insecurity' then answer_value_text end) as "moderate-food-insecurity",max(case when linkid = 'moderate-housing-insecurity' then answer_value_text end) as "moderate-housing-insecurity",max(case when linkid = 'moderate-medical-hardships' then answer_value_text end) as "moderate-medical-hardships",max(case when linkid = 'moderate-paying-bills' then answer_value_text end) as "moderate-paying-bills",max(case when linkid = 'no-financial-hardship' then answer_value_text end) as "no-financial-hardship",max(case when linkid = 'overall-financial-hardship' then answer_value_text end) as "overall-financial-hardship"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:01.078990 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:01.079771 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m09:35:01.080090 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:01.080534 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c250da0>]}
[0m09:35:01.082311 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:35:01.082587 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:35:01.082852 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:35:01.083137 [info ] [Thread-2 (]: 22 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 0.79s]
[0m09:35:01.083424 [debug] [Thread-3 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp" rename to "qr_confidential_s1"
[0m09:35:01.084972 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:35:01.086429 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:35:01.086725 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m09:35:01.087024 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp" rename to "qr_financial_wellness_tool"
[0m09:35:01.087306 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp" rename to "qr_common_mental_health_symptoms"
[0m09:35:01.087536 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_gad_7_s1
[0m09:35:01.087782 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:01.088086 [info ] [Thread-2 (]: 26 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [RUN]
[0m09:35:01.088915 [debug] [Thread-3 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:35:01.089214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:01.089475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_gad_7_s1)
[0m09:35:01.089689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:35:01.089885 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:35:01.090478 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:35:01.090664 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_gad_7_s1
[0m09:35:01.092145 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:35:01.092460 [debug] [Thread-3 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:35:01.092737 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:35:01.095440 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:35:01.095722 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:35:01.096000 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:35:01.096216 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:01.096431 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:35:01.096717 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:01.097227 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:01.098486 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup"
[0m09:35:01.098753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:35:01.098981 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:35:01.099282 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:35:01.100715 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup"
[0m09:35:01.102097 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup"
[0m09:35:01.102369 [debug] [Thread-3 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup" cascade
[0m09:35:01.102800 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:35:01.103175 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:35:01.103468 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup" cascade
[0m09:35:01.103716 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup" cascade
[0m09:35:01.104125 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:01.104936 [debug] [Thread-3 (]: On model.engage_analytics.qr_confidential_s1: Close
[0m09:35:01.105132 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:01.105311 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:01.105996 [debug] [Thread-4 (]: On model.engage_analytics.qr_common_mental_health_symptoms: Close
[0m09:35:01.106272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c11bf20>]}
[0m09:35:01.106918 [debug] [Thread-1 (]: On model.engage_analytics.qr_financial_wellness_tool: Close
[0m09:35:01.107270 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c10b020>]}
[0m09:35:01.108150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c12c380>]}
[0m09:35:01.259717 [debug] [Thread-3 (]: An error was encountered while trying to send an event
[0m09:35:01.260151 [info ] [Thread-1 (]: 25 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [[32mCREATE VIEW[0m in 0.78s]
[0m09:35:01.260775 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_financial_wellness_tool
[0m09:35:01.260978 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_gad_7_s2
[0m09:35:01.260484 [info ] [Thread-4 (]: 23 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 0.81s]
[0m09:35:01.261180 [info ] [Thread-1 (]: 27 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [RUN]
[0m09:35:01.261860 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:35:01.261574 [info ] [Thread-3 (]: 24 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [[32mCREATE VIEW[0m in 0.81s]
[0m09:35:01.262156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_financial_wellness_tool, now model.engage_analytics.qr_gad_7_s2)
[0m09:35:01.262355 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_gad_7_s3
[0m09:35:01.262574 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_confidential_s1
[0m09:35:01.262737 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_gad_7_s2
[0m09:35:01.262955 [info ] [Thread-4 (]: 28 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [RUN]
[0m09:35:01.263159 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_gad_7_s4
[0m09:35:01.265575 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:35:01.266009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_common_mental_health_symptoms, now model.engage_analytics.qr_gad_7_s3)
[0m09:35:01.266405 [info ] [Thread-3 (]: 29 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [RUN]
[0m09:35:01.266773 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:01.267085 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_gad_7_s3
[0m09:35:01.267362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_confidential_s1, now model.engage_analytics.qr_gad_7_s4)
[0m09:35:01.267595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:01.269948 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:35:01.270203 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_gad_7_s4
[0m09:35:01.270592 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:01.273054 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:35:01.273664 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:01.274074 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:01.274460 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:01.723788 [debug] [Thread-2 (]: SQL status: SELECT 18 in 0.627 seconds
[0m09:35:01.724887 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s1"
[0m09:35:01.726765 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_gad_7_s1
[0m09:35:01.728498 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s1"
[0m09:35:01.728951 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:35:01.729179 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: BEGIN
[0m09:35:01.730050 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:01.730228 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:35:01.730476 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 1) with readable column names
-- Questionnaire ID: 202
-- Source file: questionnaire/ipc-session-1/gad-7-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9' then answer_value_text end) as "ipc_s1_taskid_gad_pdf",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_gad7_session_1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s1_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s1_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s1_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s1_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s1_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s1_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s1_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_gad7_session_1_score",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s1_score_meaning_13",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:01.734007 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:01.736769 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:35:01.736994 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp" rename to "qr_gad_7_s1"
[0m09:35:01.738722 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:01.739838 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:35:01.740149 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:35:01.740319 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:35:01.741653 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:01.743009 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup"
[0m09:35:01.743688 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:35:01.743918 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup" cascade
[0m09:35:01.745057 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:01.745952 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: Close
[0m09:35:01.746269 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c118fb0>]}
[0m09:35:01.746721 [info ] [Thread-2 (]: 26 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [[32mCREATE VIEW[0m in 0.66s]
[0m09:35:01.747307 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_gad_7_s1
[0m09:35:01.747567 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_mood_rating_s1
[0m09:35:01.747870 [info ] [Thread-2 (]: 30 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [RUN]
[0m09:35:01.748213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s1, now model.engage_analytics.qr_mood_rating_s1)
[0m09:35:01.748431 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_mood_rating_s1
[0m09:35:01.751126 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:35:01.751363 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:01.751534 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:01.897977 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.630 seconds
[0m09:35:01.898303 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.625 seconds
[0m09:35:01.899236 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s2"
[0m09:35:01.900020 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s3"
[0m09:35:01.901637 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_gad_7_s2
[0m09:35:01.903473 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s2"
[0m09:35:01.903748 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_gad_7_s3
[0m09:35:01.905212 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s3"
[0m09:35:01.905592 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:35:01.905771 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: BEGIN
[0m09:35:01.905982 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:35:01.906169 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: BEGIN
[0m09:35:01.906362 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.632 seconds
[0m09:35:01.907369 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s4"
[0m09:35:01.907656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:01.907892 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:35:01.908174 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:35:01.908409 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:35:01.908716 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 2) with readable column names
-- Questionnaire ID: 205
-- Source file: questionnaire/ipc-session-2/gad-7-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_gad7_session_2",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s2_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s2_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s2_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s2_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s2_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s2_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s2_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_gad7_session_2_score",max(case when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s2_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:01.909054 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 3) with readable column names
-- Questionnaire ID: 59
-- Source file: questionnaire/ipc-session-3/gad-7-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s3_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s3_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s3_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s3_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s3_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s3_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s3_q7_afraid",max(case when linkid = '534c4998-b964-4101-b919-ff3c26af9714' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s3_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:01.909402 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_gad_7_s4
[0m09:35:01.911047 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s4"
[0m09:35:01.911481 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:35:01.911652 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s4: BEGIN
[0m09:35:01.911836 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:01.913627 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:35:01.913865 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m09:35:01.914070 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:35:01.914262 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp" rename to "qr_gad_7_s2"
[0m09:35:01.914444 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:35:01.915905 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:35:01.916185 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 4) with readable column names
-- Questionnaire ID: 62
-- Source file: questionnaire/ipc-session-4/gad-7-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s4_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s4_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s4_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s4_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s4_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s4_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s4_q7_afraid",max(case when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = 'e4155e07-1d18-448f-8111-182bf4149672' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s4_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:01.916442 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp" rename to "qr_gad_7_s3"
[0m09:35:01.916755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:01.917382 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:35:01.917629 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:01.917885 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:35:01.918603 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:35:01.918865 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:01.919082 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:35:01.919280 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:35:01.920926 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:35:01.921187 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:35:01.921379 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp" rename to "qr_gad_7_s4"
[0m09:35:01.922219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:01.922463 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:01.922660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:01.924608 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup"
[0m09:35:01.925838 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup"
[0m09:35:01.926589 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:35:01.926890 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:35:01.927131 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:35:01.927324 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:35:01.927550 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup" cascade
[0m09:35:01.927720 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup" cascade
[0m09:35:01.927883 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:35:01.928706 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:01.929431 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s3: Close
[0m09:35:01.929685 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:35:01.929873 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:35:01.930466 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: Close
[0m09:35:01.930728 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c008aa0>]}
[0m09:35:01.932304 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup"
[0m09:35:01.933059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2e48c0>]}
[0m09:35:01.933422 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:35:01.932780 [info ] [Thread-4 (]: 28 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [[32mCREATE VIEW[0m in 0.66s]
[0m09:35:01.934069 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup" cascade
[0m09:35:01.933866 [info ] [Thread-1 (]: 27 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [[32mCREATE VIEW[0m in 0.67s]
[0m09:35:01.934400 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_gad_7_s3
[0m09:35:01.934689 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_gad_7_s2
[0m09:35:01.934919 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_mood_rating_s2
[0m09:35:01.935187 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_mood_rating_s3
[0m09:35:01.935363 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:01.935592 [info ] [Thread-4 (]: 31 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [RUN]
[0m09:35:01.935870 [info ] [Thread-1 (]: 32 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [RUN]
[0m09:35:01.936796 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s4: Close
[0m09:35:01.937004 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s3, now model.engage_analytics.qr_mood_rating_s2)
[0m09:35:01.937205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s2, now model.engage_analytics.qr_mood_rating_s3)
[0m09:35:01.937507 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0396a0>]}
[0m09:35:01.937695 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_mood_rating_s2
[0m09:35:01.937888 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_mood_rating_s3
[0m09:35:01.938234 [info ] [Thread-3 (]: 29 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [[32mCREATE VIEW[0m in 0.67s]
[0m09:35:01.941270 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:35:01.943636 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:35:01.944057 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_gad_7_s4
[0m09:35:01.944324 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:01.944555 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:01.944798 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_mood_rating_s4
[0m09:35:01.944955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:01.945145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:01.945372 [info ] [Thread-3 (]: 33 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [RUN]
[0m09:35:01.945831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s4, now model.engage_analytics.qr_mood_rating_s4)
[0m09:35:01.945999 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_mood_rating_s4
[0m09:35:01.949157 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:35:01.949546 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:01.949734 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:02.383234 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.631 seconds
[0m09:35:02.387863 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:35:02.389879 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_mood_rating_s1
[0m09:35:02.391925 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:35:02.392930 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:35:02.393155 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: BEGIN
[0m09:35:02.394025 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:02.394283 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:35:02.394557 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 1) with readable column names
-- Questionnaire ID: 203
-- Source file: questionnaire/ipc-session-1/mood-rating-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "mood_s1_8085cded8e0f497f9e3d5fab3981d727",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "mood_s1_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:02.397200 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:02.398838 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:35:02.399058 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp" rename to "qr_mood_rating_s1"
[0m09:35:02.400021 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:02.400620 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:35:02.400900 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:35:02.401084 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:35:02.401971 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:02.403054 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup"
[0m09:35:02.403312 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:35:02.403477 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup" cascade
[0m09:35:02.404121 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:02.404808 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: Close
[0m09:35:02.405148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba4f6b0>]}
[0m09:35:02.405463 [info ] [Thread-2 (]: 30 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [[32mCREATE VIEW[0m in 0.66s]
[0m09:35:02.405776 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_mood_rating_s1
[0m09:35:02.405981 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_mw_tool
[0m09:35:02.406224 [info ] [Thread-2 (]: 34 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [RUN]
[0m09:35:02.406436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s1, now model.engage_analytics.qr_mw_tool)
[0m09:35:02.406602 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_mw_tool
[0m09:35:02.410256 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:35:02.410512 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:02.410691 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:02.550451 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.600 seconds
[0m09:35:02.551346 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.606 seconds
[0m09:35:02.554889 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:35:02.555365 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.610 seconds
[0m09:35:02.556308 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:35:02.557195 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:35:02.557690 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_mood_rating_s2
[0m09:35:02.557946 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_mood_rating_s4
[0m09:35:02.559950 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:35:02.560217 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_mood_rating_s3
[0m09:35:02.561845 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:35:02.563427 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:35:02.563826 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:35:02.564114 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:35:02.564326 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s2: BEGIN
[0m09:35:02.564564 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:35:02.564761 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: BEGIN
[0m09:35:02.564961 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: BEGIN
[0m09:35:02.565515 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:02.565816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:02.566052 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:35:02.566255 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:02.566478 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:35:02.566729 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 2) with readable column names
-- Questionnaire ID: 206
-- Source file: questionnaire/ipc-session-2/mood-rating-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "mood_s2_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:02.566949 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:35:02.567177 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 3) with readable column names
-- Questionnaire ID: 207
-- Source file: questionnaire/ipc-session-3/mood-rating-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "mood_s3_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:02.567531 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 4) with readable column names
-- Questionnaire ID: 209
-- Source file: questionnaire/ipc-session-4/mood-rating-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990' then answer_value_text end) as "mood_s4_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:02.569683 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:02.569899 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:02.570084 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:02.571636 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:35:02.573087 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:35:02.574474 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:35:02.574666 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp" rename to "qr_mood_rating_s2"
[0m09:35:02.574865 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp" rename to "qr_mood_rating_s3"
[0m09:35:02.575068 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp" rename to "qr_mood_rating_s4"
[0m09:35:02.576016 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:02.576207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:02.576379 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:02.576991 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:35:02.577523 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:35:02.578038 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:35:02.578206 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:35:02.578381 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:35:02.578549 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:35:02.578706 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:35:02.578868 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:35:02.579018 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:35:02.580245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:02.581601 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup"
[0m09:35:02.581826 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:35:02.582094 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:35:02.582364 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:35:02.584307 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup"
[0m09:35:02.585353 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup"
[0m09:35:02.585554 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup" cascade
[0m09:35:02.585922 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:35:02.586263 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:35:02.586545 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup" cascade
[0m09:35:02.586773 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup" cascade
[0m09:35:02.587091 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:02.587795 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s3: Close
[0m09:35:02.588016 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:02.588728 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s4: Close
[0m09:35:02.588928 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:35:02.589177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1d9bb0>]}
[0m09:35:02.589900 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s2: Close
[0m09:35:02.590126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7f85c0>]}
[0m09:35:02.590472 [info ] [Thread-1 (]: 32 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:02.590745 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1da8a0>]}
[0m09:35:02.591018 [info ] [Thread-3 (]: 33 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [[32mCREATE VIEW[0m in 0.64s]
[0m09:35:02.591456 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_mood_rating_s3
[0m09:35:02.591804 [info ] [Thread-4 (]: 31 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:02.592238 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_mood_rating_s4
[0m09:35:02.592488 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:35:02.592789 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_mood_rating_s2
[0m09:35:02.593032 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_phq_9_s1
[0m09:35:02.593281 [info ] [Thread-1 (]: 35 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [RUN]
[0m09:35:02.593635 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_phq_9_s2
[0m09:35:02.593942 [info ] [Thread-3 (]: 36 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [RUN]
[0m09:35:02.594260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s3, now model.engage_analytics.qr_mw_tool_ipc_session_4)
[0m09:35:02.594523 [info ] [Thread-4 (]: 37 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [RUN]
[0m09:35:02.594828 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s4, now model.engage_analytics.qr_phq_9_s1)
[0m09:35:02.595060 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:35:02.595239 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s2, now model.engage_analytics.qr_phq_9_s2)
[0m09:35:02.595409 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_phq_9_s1
[0m09:35:02.598217 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:35:02.598477 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_phq_9_s2
[0m09:35:02.601407 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:35:02.601763 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

    
    with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:02.604389 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:35:02.604708 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:02.604965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:02.605268 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:02.605560 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:02.605876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:03.021366 [debug] [Thread-2 (]: SQL status: SELECT 37 in 0.611 seconds
[0m09:35:03.022602 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool"
[0m09:35:03.024596 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_mw_tool
[0m09:35:03.026859 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool"
[0m09:35:03.027360 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:35:03.027554 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: BEGIN
[0m09:35:03.028386 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:03.028609 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:35:03.028954 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool with readable column names
-- Questionnaire ID: 1613532
-- Source file: questionnaire/assessments/mw-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "mental_in_the_past_year_have_you_ever_felt_that_your_thou",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "mental_in_the_past_year_how_often_do_you_have_a_drink_con",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "mental_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "mental_in_the_past_year_did_you_at_any_time_hear_voices_s",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "mental_q2_depressed",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "mental_in_the_past_year_how_many_times_have_you_used_a_re",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "mental_in_the_past_year_how_many_drinks_containing_alcoho",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "mental_in_the_past_3_months_have_you_ever_done_anything_s",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "mental_q1_anxious",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "mental_in_the_past_month_have_you_had_any_actual_thoughts",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "mental_q5_restless",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe_13",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "mental_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "mental_supervisors_name",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "mental_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "mental_referral_details_if_the_client_is_referred_out",max(case when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29' then answer_value_text end) as "retake_screening",max(case when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f' then answer_value_text end) as "retake_screening_19",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'q1-to-q3-negative' then answer_value_text end) as "q1-to-q3-negative",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-common-mental-health-form' then answer_value_text end) as "task-id-common-mental-health-form",max(case when linkid = 'task-id-mwtool-pdf' then answer_value_text end) as "task-id-mwtool-pdf",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:03.032860 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:03.034593 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:35:03.034792 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp" rename to "qr_mw_tool"
[0m09:35:03.035978 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:03.036656 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:35:03.036852 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:35:03.037015 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:35:03.038116 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:03.039247 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup"
[0m09:35:03.039552 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:35:03.039723 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup" cascade
[0m09:35:03.040289 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:03.040924 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: Close
[0m09:35:03.041202 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2076e0>]}
[0m09:35:03.041521 [info ] [Thread-2 (]: 34 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [[32mCREATE VIEW[0m in 0.63s]
[0m09:35:03.041832 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_mw_tool
[0m09:35:03.042112 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_phq_9_s3
[0m09:35:03.042335 [info ] [Thread-2 (]: 38 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [RUN]
[0m09:35:03.042871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool, now model.engage_analytics.qr_phq_9_s3)
[0m09:35:03.043123 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_phq_9_s3
[0m09:35:03.046642 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:35:03.047047 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:03.047313 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:03.208983 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.603 seconds
[0m09:35:03.210128 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s1"
[0m09:35:03.211242 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.605 seconds
[0m09:35:03.212193 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s2"
[0m09:35:03.212682 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_phq_9_s1
[0m09:35:03.215436 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s1"
[0m09:35:03.215706 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.611 seconds
[0m09:35:03.216728 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:35:03.217109 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_phq_9_s2
[0m09:35:03.218866 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s2"
[0m09:35:03.219413 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:35:03.219657 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: BEGIN
[0m09:35:03.219892 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:35:03.221691 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:35:03.222107 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:35:03.222338 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m09:35:03.222521 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: BEGIN
[0m09:35:03.222689 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:35:03.222876 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:35:03.223150 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 1) with readable column names
-- Questionnaire ID: 54
-- Source file: questionnaire/ipc-session-1/phq-9-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.3.1' then answer_value_text end) as "phq9_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "phq9_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "phq9_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "phq9_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "phq9_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "phq9_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "phq9_q7_concentration",max(case when linkid = 'f1.10.1' then answer_value_text end) as "phq9_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "phq9_q9_suicide",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "phq9_total_score",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "phq9_score_meaning",max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as "phq9_score_meaning_code",max(case when linkid = 'encounter-id' then answer_value_text end) as "phq9_encounter_id",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "phq9_observation_id",max(case when linkid = 'calculated-month' then answer_value_text end) as "phq9_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "phq9_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "phq9_field_cd8e3d6d",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as "phq9_task_id",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "phq9_field_9c366bcc",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "phq9_field_b5bc7f80",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "phq9_link_encounter"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:03.223439 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:03.223595 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: BEGIN
[0m09:35:03.223797 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:35:03.224048 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 2) with readable column names
-- Questionnaire ID: 57
-- Source file: questionnaire/ipc-session-2/phq-9-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_phq9_session_2",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s2_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s2_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s2_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s2_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s2_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s2_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s2_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s2_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s2_q7_concentration",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_phq9_session_2_score",max(case when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'a07491bd-039d-417b-9caf-0af536316594' then answer_value_text end) as "ipc_s2_score_meaning_14"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:03.224388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:03.224634 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:35:03.224950 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool Session 4 with readable column names
-- Questionnaire ID: mw-tool-ipc-session-4
-- Source file: questionnaire/assessments/mw-tool-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_s",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "in_the_past_year_have_you_ever_felt_that_your_thoughts_were",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "in_the_past_year_how_often_do_you_have_a_drink_containing_a",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "in_the_past_month_have_you_wished_you_were_dead_or_wished_y",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "in_the_past_year_did_you_at_any_time_hear_voices_saying_qui",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_down_d",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "in_the_past_year_how_many_times_have_you_used_a_recreationa",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "in_the_past_year_how_many_drinks_containing_alcohol_do_you",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "in_the_past_3_months_have_you_ever_done_anything_started_t",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_nervous",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "in_the_past_month_have_you_had_any_actual_thoughts_of_killi",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_so_restless_tha",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_a",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-mw-tool-ipc-s4-pdf' then answer_value_text end) as "task-id-mw-tool-ipc-s4-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:03.226630 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:03.226834 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:03.228433 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:35:03.228638 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:03.230049 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:35:03.230240 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp" rename to "qr_phq_9_s2"
[0m09:35:03.231497 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:35:03.231688 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp" rename to "qr_phq_9_s1"
[0m09:35:03.231901 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp" rename to "qr_mw_tool_ipc_session_4"
[0m09:35:03.232618 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:03.232891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:03.233099 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:03.233837 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:35:03.234538 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:35:03.235595 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:35:03.235852 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:35:03.236060 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:35:03.236292 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:35:03.236450 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:35:03.236617 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:35:03.236796 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:35:03.237987 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:03.238224 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:03.239347 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup"
[0m09:35:03.239509 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:35:03.240486 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup"
[0m09:35:03.240733 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:35:03.241777 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup"
[0m09:35:03.242045 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:35:03.242236 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup" cascade
[0m09:35:03.242490 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:35:03.242667 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup" cascade
[0m09:35:03.242865 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup" cascade
[0m09:35:03.243284 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:03.243473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:03.243636 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:03.244267 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: Close
[0m09:35:03.244849 [debug] [Thread-1 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: Close
[0m09:35:03.245382 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s2: Close
[0m09:35:03.245696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0b22a0>]}
[0m09:35:03.245914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c21b1d0>]}
[0m09:35:03.246691 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0a89e0>]}
[0m09:35:03.246267 [info ] [Thread-3 (]: 36 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:03.246997 [info ] [Thread-4 (]: 37 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:03.247383 [info ] [Thread-1 (]: 35 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:03.248134 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:35:03.247912 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_phq_9_s2
[0m09:35:03.248324 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_phq_9_s4
[0m09:35:03.248968 [info ] [Thread-1 (]: 39 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [RUN]
[0m09:35:03.248629 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_planning_next_steps
[0m09:35:03.249211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool_ipc_session_4, now model.engage_analytics.qr_phq_9_s4)
[0m09:35:03.249711 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_phq_9_s4
[0m09:35:03.249432 [info ] [Thread-4 (]: 40 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [RUN]
[0m09:35:03.254006 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:35:03.247664 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_phq_9_s1
[0m09:35:03.254414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s2, now model.engage_analytics.qr_planning_next_steps)
[0m09:35:03.254694 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:03.255042 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_registration_info
[0m09:35:03.255340 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_planning_next_steps
[0m09:35:03.255605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:03.255901 [info ] [Thread-3 (]: 41 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [RUN]
[0m09:35:03.258530 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:35:03.258919 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s1, now model.engage_analytics.qr_registration_info)
[0m09:35:03.259144 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:03.259366 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_registration_info
[0m09:35:03.259642 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:03.262621 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:35:03.263088 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:03.263315 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:03.671579 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.624 seconds
[0m09:35:03.672703 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s3"
[0m09:35:03.674104 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_phq_9_s3
[0m09:35:03.675952 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s3"
[0m09:35:03.676410 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:35:03.676578 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: BEGIN
[0m09:35:03.677241 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:03.677399 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:35:03.677616 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 3) with readable column names
-- Questionnaire ID: 61
-- Source file: questionnaire/ipc-session-3/phq-9-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s3_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s3_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s3_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s3_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s3_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s3_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s3_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s3_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s3_q7_concentration",max(case when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9' then answer_value_text end) as "ipc_s3_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:03.680026 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:03.681660 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:35:03.681944 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp" rename to "qr_phq_9_s3"
[0m09:35:03.682863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:03.683834 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:35:03.684061 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:35:03.684228 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:35:03.685381 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:03.686618 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup"
[0m09:35:03.686897 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:35:03.687066 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup" cascade
[0m09:35:03.687618 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:03.688272 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: Close
[0m09:35:03.688550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1eb710>]}
[0m09:35:03.688867 [info ] [Thread-2 (]: 38 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:03.689172 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_phq_9_s3
[0m09:35:03.689400 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_remove_patient
[0m09:35:03.689653 [info ] [Thread-2 (]: 42 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [RUN]
[0m09:35:03.689886 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s3, now model.engage_analytics.qr_remove_patient)
[0m09:35:03.690067 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_remove_patient
[0m09:35:03.692498 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:35:03.692768 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:03.693051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:03.867507 [debug] [Thread-3 (]: SQL status: SELECT 28 in 0.604 seconds
[0m09:35:03.868194 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.612 seconds
[0m09:35:03.871100 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info"
[0m09:35:03.871880 [debug] [Thread-4 (]: SQL status: SELECT 66 in 0.612 seconds
[0m09:35:03.873327 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s4"
[0m09:35:03.874847 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_planning_next_steps"
[0m09:35:03.876192 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_phq_9_s4
[0m09:35:03.877865 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s4"
[0m09:35:03.878232 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_registration_info
[0m09:35:03.880597 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info"
[0m09:35:03.880850 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_planning_next_steps
[0m09:35:03.882370 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_planning_next_steps"
[0m09:35:03.882649 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:35:03.882823 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: BEGIN
[0m09:35:03.883249 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:35:03.883529 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:35:03.883832 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: BEGIN
[0m09:35:03.884056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:03.884234 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: BEGIN
[0m09:35:03.884420 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:35:03.884695 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 4) with readable column names
-- Questionnaire ID: 211
-- Source file: questionnaire/ipc-session-4/phq-9-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "ipc_s4_how_difficult_have_these_problems_made_it_for_you_",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s4_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s4_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s4_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s4_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s4_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s4_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s4_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s4_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s4_q7_concentration",max(case when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792' then answer_value_text end) as "ipc_s4_score_meaning_13"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:03.885024 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:03.885218 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:03.885391 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:35:03.885560 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:35:03.885855 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Add Family Member Registration with readable column names
-- Questionnaire ID: 221
-- Source file: questionnaire/generic/registration_info.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff' then answer_value_text end) as "registration_36d39dbe00e24e29f0793ec8f0119aff",max(case when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd' then answer_value_text end) as "registration_middle_name",max(case when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271' then answer_value_text end) as "registration_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7' then answer_value_text end) as "registration_age",max(case when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d' then answer_value_text end) as "registration_surname",max(case when linkid = 'age' then answer_value_text end) as "registration_age_6",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "registration_calculated_age",max(case when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f' then answer_value_text end) as "registration_unique_id",max(case when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0' then answer_value_text end) as "registration_has_this_person_received_engage_services_in_the_pa",max(case when linkid = 'calculated-month' then answer_value_text end) as "registration_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "registration_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "registration_date_of_birth_dob",max(case when linkid = 'e6306275-b989-4375-8527-3a56092081b8' then answer_value_text end) as "registration_first_name",max(case when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd' then answer_value_text end) as "registration_what_was_your_biological_sex_assigned_at_birth",max(case when linkid = 'choice-gender-identity' then answer_value_text end) as "choice-gender-identity",max(case when linkid = 'choice-pronouns' then answer_value_text end) as "choice-pronouns",max(case when linkid = 'do-you-have-medicaid' then answer_value_text end) as "do-you-have-medicaid",max(case when linkid = 'email-address' then answer_value_text end) as "email-address",max(case when linkid = 'medicaid-number' then answer_value_text end) as "medicaid-number",max(case when linkid = 'other-best-represents-how-you-think-of-yourself' then answer_value_text end) as "other-best-represents-how-you-think-of-yourself",max(case when linkid = 'other-biological-sex-at-birth' then answer_value_text end) as "other-biological-sex-at-birth",max(case when linkid = 'other-gender-identity' then answer_value_text end) as "other-gender-identity",max(case when linkid = 'other-pronouns' then answer_value_text end) as "other-pronouns",max(case when linkid = 'other-where-did-you-first-learn-about-engage' then answer_value_text end) as "other-where-did-you-first-learn-about-engage",max(case when linkid = 'phone-number' then answer_value_text end) as "phone-number",max(case when linkid = 'physical-address' then answer_value_text end) as "physical-address",max(case when linkid = 'where-did-you-first-learn-about-engage' then answer_value_text end) as "where-did-you-first-learn-about-engage",max(case when linkid = 'zip-code' then answer_value_text end) as "zip-code"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:03.886394 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Planning Next Steps with readable column names
-- Questionnaire ID: q-planning-next-steps
-- Source file: questionnaire/assessments/planning-next-steps.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7' then answer_value_text end) as "referral_to_mental_health_specialist",max(case when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7' then answer_value_text end) as "referred",max(case when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f' then answer_value_text end) as "okay",max(case when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d' then answer_value_text end) as "field_2cb66889",max(case when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6' then answer_value_text end) as "field_34a56c28",max(case when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9' then answer_value_text end) as "referres",max(case when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01' then answer_value_text end) as "field_34ab6c28",max(case when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d' then answer_value_text end) as "field_3b9f7e5d",max(case when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f' then answer_value_text end) as "sbirt_motivational_interviewing",max(case when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7' then answer_value_text end) as "safety",max(case when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123' then answer_value_text end) as "others",max(case when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae' then answer_value_text end) as "mental_health",max(case when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345' then answer_value_text end) as "not_interested",max(case when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf' then answer_value_text end) as "20250924",max(case when linkid = '69712544-6237-4962-a455-ee6e9ee80000' then answer_value_text end) as "field_69712544",max(case when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e' then answer_value_text end) as "field_76ba8dbe",max(case when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574' then answer_value_text end) as "hh",max(case when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106' then answer_value_text end) as "20260505",max(case when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d' then answer_value_text end) as "field_9a8b7c6d",max(case when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d' then answer_value_text end) as "sbirt_motivational_interviewingbrspan_stylecolor006",max(case when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab' then answer_value_text end) as "field_ab12d39f",max(case when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e' then answer_value_text end) as "they_gtycyvuy",max(case when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e' then answer_value_text end) as "field_b2c3d4e5",max(case when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc' then answer_value_text end) as "test",max(case when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e' then answer_value_text end) as "field_bc2def4a",max(case when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f' then answer_value_text end) as "field_c3d4e5f6",max(case when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4' then answer_value_text end) as "field_c9d8b7a6",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd' then answer_value_text end) as "not_interested_28",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f' then answer_value_text end) as "field_cd34f5b1",max(case when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f' then answer_value_text end) as "iwbwb",max(case when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a' then answer_value_text end) as "needs_checkups",max(case when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a' then answer_value_text end) as "hhh",max(case when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90' then answer_value_text end) as "20250827",max(case when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7' then answer_value_text end) as "referral_to_mental_health_specialist_34",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b' then answer_value_text end) as "already_received_a_similar_service",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4' then answer_value_text end) as "field_ef5617d3",max(case when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5' then answer_value_text end) as "peace",max(case when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100' then answer_value_text end) as "interested_but_not_now",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g' then answer_value_text end) as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g",max(case when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h' then answer_value_text end) as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h",max(case when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i' then answer_value_text end) as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i",max(case when linkid = 'financial-hardships-list' then answer_value_text end) as "financial-hardships-list",max(case when linkid = 'is-fws' then answer_value_text end) as "is-fws",max(case when linkid = 'is-ipc' then answer_value_text end) as "is-ipc",max(case when linkid = 'is-ipc-main' then answer_value_text end) as "is-ipc-main",max(case when linkid = 'is-ipc-optional' then answer_value_text end) as "is-ipc-optional",max(case when linkid = 'is-mhs' then answer_value_text end) as "is-mhs",max(case when linkid = 'is-other-agency-services' then answer_value_text end) as "is-other-agency-services",max(case when linkid = 'is-other-services-outside-agency' then answer_value_text end) as "is-other-services-outside-agency",max(case when linkid = 'is-sbirt' then answer_value_text end) as "is-sbirt",max(case when linkid = 'is-sbirt-main' then answer_value_text end) as "is-sbirt-main",max(case when linkid = 'is-sbirt-optional' then answer_value_text end) as "is-sbirt-optional",max(case when linkid = 'is-spi' then answer_value_text end) as "is-spi",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'scheduled-ipc-session-1-with-current-time' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time",max(case when linkid = 'scheduled-ipc-session-1-with-current-time-2' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time-2",max(case when linkid = 'task-id-000' then answer_value_text end) as "task-id-000",max(case when linkid = 'task-id-001' then answer_value_text end) as "task-id-001",max(case when linkid = 'task-id-002' then answer_value_text end) as "task-id-002",max(case when linkid = 'task-id-003' then answer_value_text end) as "task-id-003",max(case when linkid = 'task-id-004' then answer_value_text end) as "task-id-004",max(case when linkid = 'task-id-006' then answer_value_text end) as "task-id-006",max(case when linkid = 'task-id-planning-next-steps-pdf' then answer_value_text end) as "task-id-planning-next-steps-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:03.887514 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:03.889267 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:35:03.889551 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp" rename to "qr_phq_9_s4"
[0m09:35:03.889767 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:03.891417 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:35:03.891653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:35:03.891841 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:35:03.892011 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp" rename to "qr_registration_info"
[0m09:35:03.892720 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:35:03.894111 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:35:03.894421 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:35:03.894660 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp" rename to "qr_planning_next_steps"
[0m09:35:03.894877 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:35:03.895227 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:03.895999 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:35:03.896205 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:35:03.896383 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:03.896586 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:35:03.896751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:35:03.897346 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:35:03.898544 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup"
[0m09:35:03.898744 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:35:03.898912 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:03.899163 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:35:03.899329 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:35:03.900406 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup"
[0m09:35:03.900609 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup" cascade
[0m09:35:03.900938 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:35:03.901206 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup" cascade
[0m09:35:03.901496 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:03.901767 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:03.901954 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:03.903029 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup"
[0m09:35:03.903680 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s4: Close
[0m09:35:03.904289 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: Close
[0m09:35:03.904561 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:35:03.904873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c03cbc0>]}
[0m09:35:03.905221 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdc2960>]}
[0m09:35:03.905462 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup" cascade
[0m09:35:03.905914 [info ] [Thread-1 (]: 39 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [[32mCREATE VIEW[0m in 0.66s]
[0m09:35:03.906405 [info ] [Thread-3 (]: 41 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:03.906778 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_phq_9_s4
[0m09:35:03.907016 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_registration_info
[0m09:35:03.907234 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_sbirt
[0m09:35:03.907415 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:03.907595 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:35:03.907905 [info ] [Thread-1 (]: 43 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sbirt .. [RUN]
[0m09:35:03.908779 [debug] [Thread-4 (]: On model.engage_analytics.qr_planning_next_steps: Close
[0m09:35:03.909333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s4, now model.engage_analytics.qr_sbirt)
[0m09:35:03.909084 [info ] [Thread-3 (]: 44 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [RUN]
[0m09:35:03.909662 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_sbirt
[0m09:35:03.909923 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1a7e00>]}
[0m09:35:03.910176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_registration_info, now model.engage_analytics.qr_sf_pcl_5_s1)
[0m09:35:03.913047 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:35:03.913510 [info ] [Thread-4 (]: 40 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [[32mCREATE VIEW[0m in 0.66s]
[0m09:35:03.913874 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:35:03.914156 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:03.914418 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_planning_next_steps
[0m09:35:03.917797 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:35:03.918026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:03.918317 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:35:03.918596 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:03.919056 [info ] [Thread-4 (]: 45 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [RUN]
[0m09:35:03.919271 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:03.919650 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_planning_next_steps, now model.engage_analytics.qr_sf_pcl_5_s2)
[0m09:35:03.919975 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:35:03.922717 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:35:03.923046 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:03.923263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:04.305569 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.612 seconds
[0m09:35:04.308645 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_remove_patient"
[0m09:35:04.311199 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_remove_patient
[0m09:35:04.313308 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_remove_patient"
[0m09:35:04.313805 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:35:04.313983 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: BEGIN
[0m09:35:04.314746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:04.314966 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:35:04.315215 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- eCBIS Remove Family Form with readable column names
-- Questionnaire ID: 69
-- Source file: questionnaire/generic/remove_patient.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f' then answer_value_text end) as "remove_family_date_of_death",max(case when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a' then answer_value_text end) as "remove_family_give_other_reasons_for_removal",max(case when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5' then answer_value_text end) as "remove_family_age_at_death_year",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b' then answer_value_text end) as "remove_family_a11ebb0dacb34038956b293a41acb85b",max(case when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1' then answer_value_text end) as "remove_family_date_moved_away",max(case when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff' then answer_value_text end) as "remove_family_reason_for_removal",max(case when linkid = 'patient-birthdate' then answer_value_text end) as "remove_family_patientbirthdate",max(case when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec' then answer_value_text end) as "reason_unknown"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:04.317661 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:04.319319 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:35:04.319517 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp" rename to "qr_remove_patient"
[0m09:35:04.320493 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:04.321165 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:35:04.321400 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:35:04.321572 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:35:04.322326 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:04.323425 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup"
[0m09:35:04.323697 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:35:04.323870 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup" cascade
[0m09:35:04.324440 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:04.325083 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: Close
[0m09:35:04.325399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c14d5b0>]}
[0m09:35:04.325824 [info ] [Thread-2 (]: 42 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [[32mCREATE VIEW[0m in 0.64s]
[0m09:35:04.326287 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_remove_patient
[0m09:35:04.326486 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:35:04.326944 [info ] [Thread-2 (]: 46 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [RUN]
[0m09:35:04.327331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_remove_patient, now model.engage_analytics.qr_sf_pcl_5_s3)
[0m09:35:04.327516 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:35:04.330245 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:35:04.330511 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:04.330691 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:04.527843 [debug] [Thread-3 (]: SQL status: SELECT 28 in 0.608 seconds
[0m09:35:04.531468 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:35:04.532481 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.609 seconds
[0m09:35:04.534064 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:35:04.534546 [debug] [Thread-1 (]: SQL status: SELECT 159 in 0.616 seconds
[0m09:35:04.536621 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_sbirt"
[0m09:35:04.536964 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:35:04.538869 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:35:04.539163 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:35:04.540746 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:35:04.541011 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_sbirt
[0m09:35:04.542528 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_sbirt"
[0m09:35:04.542808 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:35:04.543196 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s1: BEGIN
[0m09:35:04.543416 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:35:04.543701 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: BEGIN
[0m09:35:04.544036 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:35:04.545388 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:04.545613 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m09:35:04.545877 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: BEGIN
[0m09:35:04.546162 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:35:04.546400 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:35:04.546739 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 2) with readable column names
-- Questionnaire ID: 56
-- Source file: questionnaire/ipc-session-2/sf-pcl-5-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ptsd_session_2",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_pcptsd_session_2_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s2_score_meaning_13",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s2_is_ptsd",max(case when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:04.547053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:04.547355 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 1) with readable column names
-- Questionnaire ID: 204
-- Source file: questionnaire/ipc-session-1/sf-pcl-5-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505' then answer_value_text end) as "ipc_s1_taskid_ptsd_pdf",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av_8",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ptsd_session_1",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_pcptsd_session_1_score",max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s1_score_meaning_14",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s1_is_ptsd",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:04.547734 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:35:04.548676 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SBIRT with readable column names
-- Questionnaire ID: 212
-- Source file: questionnaire/sbirt.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_drink_alc",max(case when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t",max(case when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e' then answer_value_text end) as "sbirt_have_you_or_someone_else_been_injured_as_a_result_",max(case when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621' then answer_value_text end) as "sbirt_how_often_do_you_have_six_or_more_drinks_on_one_oc",max(case when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_needed_a_f",max(case when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848' then answer_value_text end) as "sbirt_have_you_ever_experienced_withdrawal_symptoms_felt",max(case when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4' then answer_value_text end) as "sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_o",max(case when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_8",max(case when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_had_a_feel",max(case when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1' then answer_value_text end) as "sbirt_how_many_standard_drinks_containing_alcohol_do_you",max(case when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_been_unabl",max(case when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11' then answer_value_text end) as "sbirt_how_often_do_you_have_a_drink_containing_alcohol",max(case when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4' then answer_value_text end) as "sbirt_have_you_neglected_your_family_because_of_your_use",max(case when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267' then answer_value_text end) as "sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use",max(case when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_15",max(case when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990' then answer_value_text end) as "sbirt_have_you_had_medical_problems_as_a_result_of_your_",max(case when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3' then answer_value_text end) as "sbirt_have_you_ever_used_any_drugs_by_injection_nonmedic",max(case when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c' then answer_value_text end) as "sbirt_have_you_engaged_in_illegal_activities_in_order_to",max(case when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_19",max(case when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_20",max(case when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_failed_to_",max(case when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_22",max(case when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41' then answer_value_text end) as "sbirt_does_your_spouse_or_parents_ever_complain_about_yo",max(case when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_24",max(case when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_25",max(case when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_26",max(case when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9' then answer_value_text end) as "sbirt_are_you_always_able_to_stop_using_drugs_when_you_w",max(case when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_found_that",max(case when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b' then answer_value_text end) as "sbirt_have_you_used_drugs_other_than_those_required_for_",max(case when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88' then answer_value_text end) as "sbirt_has_a_relative_or_friend_or_a_doctor_or_another_he",max(case when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba' then answer_value_text end) as "sbirt_do_you_use_more_than_one_drug_at_a_time",max(case when linkid = '0466b304-2876-409b-ade2-d1c675614854' then answer_value_text end) as "sbirt_please_select_one_substance_you_would_like_to_disc",max(case when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_metha",max(case when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78' then answer_value_text end) as "sbirt_i_would_like_to_offer_an_opportunity_to_start_a_co",max(case when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0' then answer_value_text end) as "sbirt_we_could_start_by_discussing_the_pros_and_cons_of_",max(case when linkid = '39843731-a8e7-4822-bad7-55489947ebeb' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_other",max(case when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_alc",max(case when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_canna",max(case when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_hallu",max(case when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_sedat",max(case when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_inhal",max(case when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_cocai",max(case when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_the",max(case when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491' then answer_value_text end) as "sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_al",max(case when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_presc",max(case when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha",max(case when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_47",max(case when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_48",max(case when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_49",max(case when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_50",max(case when linkid = '8427af19-3bad-4713-bad9-b179437fef96' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_stree",max(case when linkid = '90876967-c973-4bee-9217-8c7482cb12a2' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_52",max(case when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368' then answer_value_text end) as "sbirt_cannabis_marijuana_pot_grass_hash_etc",max(case when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_54",max(case when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_55",max(case when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d' then answer_value_text end) as "sbirt_would_you_be_interested_in_learning_more_about_sub",max(case when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9' then answer_value_text end) as "sbirt_1579996975654c3eb488d6a65d66c6c9",max(case when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812' then answer_value_text end) as "sbirt_things_you_can_do",max(case when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_prescript",max(case when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_methamphe",max(case when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_other_dru",max(case when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_inhalants",max(case when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cannabis_",max(case when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_64",max(case when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3' then answer_value_text end) as "sbirt_what_are_some_good_things_about_staying_the_same",max(case when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848' then answer_value_text end) as "sbirt_street_opioids_heroin_opium_etc_or_prescription_op",max(case when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_hallucino",max(case when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cocaine_l",max(case when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_sedatives",max(case when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509' then answer_value_text end) as "sbirt_what_are_some_good_things_about_making_a_change",max(case when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1' then answer_value_text end) as "sbirt_what_are_your_health_goals_around_substance_use",max(case when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f' then answer_value_text end) as "sbirt_cocaine_coke_crack_etc",max(case when linkid = '1600f791-fd2c-44d8-8384-37973785741b' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed",max(case when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_74",max(case when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_75",max(case when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_76",max(case when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_street_op",max(case when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_78",max(case when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299' then answer_value_text end) as "sbirt_other_drugs",max(case when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_80",max(case when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_81",max(case when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_82",max(case when linkid = 'edced328-6f82-458a-bce4-35987bff19fb' then answer_value_text end) as "sbirt_edced3286f82458abce435987bff19fb",max(case when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19' then answer_value_text end) as "sbirt_can_i_share_additional_treatment_options_with_you",max(case when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre",max(case when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3' then answer_value_text end) as "sbirt_prescription_stimulants_just_for_the_feeling_more_",max(case when linkid = '582271e0-892e-4795-ac55-0b73baf828ca' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_87",max(case when linkid = '654d5688-f42a-469b-8494-81115b760e29' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_88",max(case when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_89",max(case when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_90",max(case when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_91",max(case when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_92",max(case when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_93",max(case when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_94",max(case when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down",max(case when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_96",max(case when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_97",max(case when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_98",max(case when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_99",max(case when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_100",max(case when linkid = 'ad609c63-366e-476a-b131-610ceed211da' then answer_value_text end) as "sbirt_things_others_can_help_you_do",max(case when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_102",max(case when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac' then answer_value_text end) as "sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_e",max(case when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_104",max(case when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_105",max(case when linkid = '6281fa0d-ef3f-4013-bd31-062371828010' then answer_value_text end) as "sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whipp",max(case when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_107",max(case when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe' then answer_value_text end) as "sbirt_sedatives_just_for_the_feeling_more_than_prescribe",max(case when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f' then answer_value_text end) as "sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecs",max(case when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404' then answer_value_text end) as "sbirt_any_other_drugs_to_get_high",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '36af2335-ac86-4864-8a3d-619451160cc5' then answer_value_text end) as "2_times_in_a_day",max(case when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f' then answer_value_text end) as "join_a_community_group_and",max(case when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5' then answer_value_text end) as "therapy",max(case when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528' then answer_value_text end) as "2_days_per_week",max(case when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730' then answer_value_text end) as "field_445adcc0",max(case when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045' then answer_value_text end) as "3_days_per_week",max(case when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb' then answer_value_text end) as "not_ready",max(case when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6' then answer_value_text end) as "quit",max(case when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5' then answer_value_text end) as "20250224",max(case when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3' then answer_value_text end) as "2_times_in_a_day_124",max(case when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d' then answer_value_text end) as "field_859d58d6",max(case when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427' then answer_value_text end) as "field_8a6c4c5b",max(case when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7' then answer_value_text end) as "social_places_you_can_go_to_eg_take_a_walk_at_the_park",max(case when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4' then answer_value_text end) as "internally",max(case when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3' then answer_value_text end) as "work_toward_a_goal",max(case when linkid = 'drug-to-use-alcohol' then answer_value_text end) as "drug-to-use-alcohol",max(case when linkid = 'drug-to-use-marijuana-or-other' then answer_value_text end) as "drug-to-use-marijuana-or-other",max(case when linkid = 'health-goals-do-not-want-to-change' then answer_value_text end) as "health-goals-do-not-want-to-change",max(case when linkid = 'is-drug-dependence' then answer_value_text end) as "is-drug-dependence",max(case when linkid = 'is-high-risk-alcohol' then answer_value_text end) as "is-high-risk-alcohol",max(case when linkid = 'is-high-risk-drug' then answer_value_text end) as "is-high-risk-drug",max(case when linkid = 'is-low-risk-alcohol' then answer_value_text end) as "is-low-risk-alcohol",max(case when linkid = 'is-low-risk-drug' then answer_value_text end) as "is-low-risk-drug",max(case when linkid = 'is-medium-risk-alcohol' then answer_value_text end) as "is-medium-risk-alcohol",max(case when linkid = 'is-medium-risk-drug' then answer_value_text end) as "is-medium-risk-drug",max(case when linkid = 'is-opioid-dependence' then answer_value_text end) as "is-opioid-dependence",max(case when linkid = 'other-drug-list' then answer_value_text end) as "other-drug-list",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender' then answer_value_text end) as "patient-gender",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'score-audit' then answer_value_text end) as "score-audit",max(case when linkid = 'score-dast' then answer_value_text end) as "score-dast",max(case when linkid = 'should-converse-about-substance-use' then answer_value_text end) as "should-converse-about-substance-use",max(case when linkid = 'should-discuss-health-goals' then answer_value_text end) as "should-discuss-health-goals",max(case when linkid = 'show-client-use-with-other-drugs' then answer_value_text end) as "show-client-use-with-other-drugs",max(case when linkid = 'show-discuss-next-steps' then answer_value_text end) as "show-discuss-next-steps",max(case when linkid = 'show-goals' then answer_value_text end) as "show-goals",max(case when linkid = 'show-intervention-when-low-risk' then answer_value_text end) as "show-intervention-when-low-risk",max(case when linkid = 'show-intervention-when-medium-high-risk' then answer_value_text end) as "show-intervention-when-medium-high-risk",max(case when linkid = 'show-is-medium-high-risk' then answer_value_text end) as "show-is-medium-high-risk",max(case when linkid = 'show-summary-for-low-risk' then answer_value_text end) as "show-summary-for-low-risk",max(case when linkid = 'show-things-to-do' then answer_value_text end) as "show-things-to-do",max(case when linkid = 'task-id-sbirt-pdf' then answer_value_text end) as "task-id-sbirt-pdf",max(case when linkid = 'using-opioids-and-low-risk' then answer_value_text end) as "using-opioids-and-low-risk"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:04.550554 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:04.550787 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:04.552442 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:35:04.553798 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:35:04.554020 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp" rename to "qr_sf_pcl_5_s2"
[0m09:35:04.554236 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp" rename to "qr_sf_pcl_5_s1"
[0m09:35:04.555632 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:04.555930 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:04.556762 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:35:04.557525 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:35:04.557738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:35:04.557921 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:35:04.558128 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:35:04.559682 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:35:04.559905 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:35:04.560116 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:35:04.560296 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp" rename to "qr_sbirt"
[0m09:35:04.562104 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:35:04.562406 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:35:04.563902 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup"
[0m09:35:04.564154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:35:04.565451 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup"
[0m09:35:04.565772 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:35:04.566443 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:35:04.566808 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:35:04.567046 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup" cascade
[0m09:35:04.567275 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:35:04.567454 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup" cascade
[0m09:35:04.567718 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:35:04.568427 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:04.568633 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:04.569400 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s1: Close
[0m09:35:04.569568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:35:04.570136 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s2: Close
[0m09:35:04.571379 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup"
[0m09:35:04.571762 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0aa750>]}
[0m09:35:04.572041 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1b59d0>]}
[0m09:35:04.572399 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:35:04.572870 [info ] [Thread-3 (]: 44 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [[32mCREATE VIEW[0m in 0.66s]
[0m09:35:04.573200 [info ] [Thread-4 (]: 45 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:04.573425 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup" cascade
[0m09:35:04.573687 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:35:04.573948 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:35:04.574184 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:35:04.574405 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sociodemographic_survey
[0m09:35:04.574599 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:04.574845 [info ] [Thread-3 (]: 47 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [RUN]
[0m09:35:04.575787 [debug] [Thread-1 (]: On model.engage_analytics.qr_sbirt: Close
[0m09:35:04.575090 [info ] [Thread-4 (]: 48 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [RUN]
[0m09:35:04.576063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s1, now model.engage_analytics.qr_sf_pcl_5_s4)
[0m09:35:04.576266 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s2, now model.engage_analytics.qr_sociodemographic_survey)
[0m09:35:04.576502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c14f260>]}
[0m09:35:04.576717 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:35:04.576896 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sociodemographic_survey
[0m09:35:04.579734 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:35:04.577195 [info ] [Thread-1 (]: 43 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sbirt  [[32mCREATE VIEW[0m in 0.67s]
[0m09:35:04.582655 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:35:04.583037 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:04.583391 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_sbirt
[0m09:35:04.583580 [debug] [Thread-4 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:04.583759 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:04.583949 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_spi_subform_1
[0m09:35:04.584180 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:04.584597 [info ] [Thread-1 (]: 49 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [RUN]
[0m09:35:04.585049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sbirt, now model.engage_analytics.qr_spi_subform_1)
[0m09:35:04.585284 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_spi_subform_1
[0m09:35:04.587804 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:35:04.588104 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:04.588328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:04.960199 [debug] [Thread-2 (]: SQL status: SELECT 21 in 0.629 seconds
[0m09:35:04.962807 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:35:04.964781 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:35:04.967837 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:35:04.968509 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:35:04.968732 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: BEGIN
[0m09:35:04.969679 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:04.969886 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:35:04.970168 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 3) with readable column names
-- Questionnaire ID: 60
-- Source file: questionnaire/ipc-session-3/sf-pcl-5-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ptsd_session_3",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s3_score_meaning_12",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s3_is_ptsd",max(case when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:04.973132 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:35:04.974754 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:35:04.974983 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp" rename to "qr_sf_pcl_5_s3"
[0m09:35:04.975860 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:04.976802 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:35:04.977021 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:35:04.977216 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:35:04.978411 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:04.979752 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup"
[0m09:35:04.980108 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:35:04.980285 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup" cascade
[0m09:35:04.980998 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:04.981846 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: Close
[0m09:35:04.982157 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bfc2ed0>]}
[0m09:35:04.982490 [info ] [Thread-2 (]: 46 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [[32mCREATE VIEW[0m in 0.65s]
[0m09:35:04.982765 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:35:04.982959 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_spi_subform_2
[0m09:35:04.983313 [info ] [Thread-2 (]: 50 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [RUN]
[0m09:35:04.983687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s3, now model.engage_analytics.qr_spi_subform_2)
[0m09:35:04.983959 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_spi_subform_2
[0m09:35:04.986676 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:35:04.986959 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:04.987143 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:05.195014 [debug] [Thread-4 (]: SQL status: SELECT 25 in 0.611 seconds
[0m09:35:05.195400 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.612 seconds
[0m09:35:05.196629 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:35:05.196991 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.609 seconds
[0m09:35:05.198066 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:35:05.199088 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_1"
[0m09:35:05.199510 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:35:05.201972 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:35:05.202476 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sociodemographic_survey
[0m09:35:05.202720 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_spi_subform_1
[0m09:35:05.204519 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:35:05.206239 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_1"
[0m09:35:05.206552 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:35:05.206809 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: BEGIN
[0m09:35:05.207103 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:35:05.207286 [debug] [Thread-4 (]: On model.engage_analytics.qr_sociodemographic_survey: BEGIN
[0m09:35:05.207494 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:35:05.207666 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: BEGIN
[0m09:35:05.207885 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:05.208046 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:35:05.208217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:05.208404 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:05.209217 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:35:05.209058 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:35:05.209506 [debug] [Thread-4 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Sociodemographic Survey with readable column names
-- Questionnaire ID: 1613531
-- Source file: questionnaire/assessments/sociodemographic_survey.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7' then answer_value_text end) as "demographic_if_you_were_not_born_in_the_us_how_long_have_you_l",max(case when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5' then answer_value_text end) as "demographic_please_specify",max(case when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde' then answer_value_text end) as "demographic_please_specify_3",max(case when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe' then answer_value_text end) as "demographic_where_were_you_born",max(case when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af' then answer_value_text end) as "demographic_what_is_the_zip_code_of_where_you_currently_live",max(case when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739' then answer_value_text end) as "demographic_what_was_your_biological_sex_at_birth",max(case when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d' then answer_value_text end) as "demographic_please_enter_the_number_of_years",max(case when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173' then answer_value_text end) as "demographic_we_would_like_to_know_about_what_you_do_are_you",max(case when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4' then answer_value_text end) as "demographic_please_enter_the_number_of_months",max(case when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9' then answer_value_text end) as "demographic_what_is_your_race_andor_ethnicity",max(case when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0' then answer_value_text end) as "demographic_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '92fed595-49f2-4fab-81ff-885941f31e07' then answer_value_text end) as "demographic_where_did_this_client_first_learn_about_engage",max(case when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a' then answer_value_text end) as "demographic_what_is_your_marital_status",max(case when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c' then answer_value_text end) as "demographic_what_term_best_expresses_how_you_describe_your_gen",max(case when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba' then answer_value_text end) as "demographic_what_was_the_highest_grade_or_level_of_school_that",max(case when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f' then answer_value_text end) as "demographic_please_specify_the_us_territorycommonwealth_eg_pue",max(case when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130' then answer_value_text end) as "some_of_the_time",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:05.208757 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 4) with readable column names
-- Questionnaire ID: 210
-- Source file: questionnaire/ipc-session-4/sf-pcl-5-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s4_encounter_id_of_ptsd_session_4",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s4_score_meaning_12",max(case when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:05.210172 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 1 with readable column names
-- Questionnaire ID: 104455
-- Source file: questionnaire/spi/spi-subform-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_1",max(case when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab' then answer_value_text end) as "spi_is_low_risk",max(case when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d' then answer_value_text end) as "spi_is_medium_risk",max(case when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b' then answer_value_text end) as "spi_is_high_risk",max(case when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5' then answer_value_text end) as "spi_were_any_of_these_in_the_past_three_months",max(case when linkid = '35062b98-748b-441c-ad74-185823e1bb52' then answer_value_text end) as "spi_in_the_past_month_have_you_been_thinking_about_how",max(case when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb' then answer_value_text end) as "spi_in_the_past_month_have_you_had_these_thoughts_and_",max(case when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23' then answer_value_text end) as "spi_in_the_past_month_have_you_started_to_work_out_or_",max(case when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511' then answer_value_text end) as "spi_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea' then answer_value_text end) as "spi_have_you_ever_done_anything_started_to_do_anything",max(case when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce' then answer_value_text end) as "spi_in_the_past_month_have_you_actually_had_any_though",max(case when linkid = 'task-id-spi-subform-2' then answer_value_text end) as "spi_taskid_spi_subform_2",max(case when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03' then answer_value_text end) as "spi_43898926e9d5400ea09562a8c7f8dd03",max(case when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837' then answer_value_text end) as "spi_644c00f28b07491192d0f05f5e5cc837",max(case when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9' then answer_value_text end) as "spi_71dbaac9867f4d7fb6d7e1f59402bbf9",max(case when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda' then answer_value_text end) as "spi_7fc39fba84db490daf4e8f772d91ffda",max(case when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42' then answer_value_text end) as "spi_a6601f970a3449d0b181611d6705ca42",max(case when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423' then answer_value_text end) as "spi_c7d21a570fc64e3ab411beceb1fb2423",max(case when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019' then answer_value_text end) as "spi_ecabd308c45a41f78754b1f63a101019",max(case when linkid = 'task-status-spi-subform-2' then answer_value_text end) as "spi_taskstatus_spi_subform_2",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "task-id-spi-subform-3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "task-id-spi-subform-4",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "task-status-spi-subform-3",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "task-status-spi-subform-4"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:05.214217 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:35:05.214547 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:35:05.214784 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:35:05.216413 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:35:05.218627 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:35:05.256634 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp" rename to "qr_sf_pcl_5_s4"
[0m09:35:05.257584 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:35:05.257813 [debug] [Thread-4 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp" rename to "qr_sociodemographic_survey"
[0m09:35:05.258063 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp" rename to "qr_spi_subform_1"
[0m09:35:05.259165 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:05.259395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:05.259565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:05.260240 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:35:05.260916 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:35:05.261474 [debug] [Thread-4 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:35:05.261660 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:35:05.261824 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:35:05.261979 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:35:05.262127 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:35:05.262273 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:35:05.262416 [debug] [Thread-4 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:35:05.264027 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:05.265155 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup"
[0m09:35:05.265416 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:35:05.265584 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup" cascade
[0m09:35:05.265771 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:35:05.266789 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup"
[0m09:35:05.267062 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:35:05.267435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m09:35:05.267654 [debug] [Thread-4 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup" cascade
[0m09:35:05.267861 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:35:05.269131 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup"
[0m09:35:05.269998 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s4: Close
[0m09:35:05.270293 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:35:05.270459 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:05.270659 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup" cascade
[0m09:35:05.270933 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c10e8a0>]}
[0m09:35:05.271557 [debug] [Thread-4 (]: On model.engage_analytics.qr_sociodemographic_survey: Close
[0m09:35:05.271932 [info ] [Thread-3 (]: 47 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [[32mCREATE VIEW[0m in 0.69s]
[0m09:35:05.272313 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c22a0f0>]}
[0m09:35:05.272624 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:05.272881 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:35:05.273201 [info ] [Thread-4 (]: 48 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [[32mCREATE VIEW[0m in 0.70s]
[0m09:35:05.273860 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: Close
[0m09:35:05.274055 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_spi_subform_3
[0m09:35:05.274428 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sociodemographic_survey
[0m09:35:05.274769 [info ] [Thread-3 (]: 51 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [RUN]
[0m09:35:05.275055 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_spi_subform_4
[0m09:35:05.275369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c298c20>]}
[0m09:35:05.275651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s4, now model.engage_analytics.qr_spi_subform_3)
[0m09:35:05.275953 [info ] [Thread-4 (]: 52 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [RUN]
[0m09:35:05.276266 [info ] [Thread-1 (]: 49 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [[32mCREATE VIEW[0m in 0.69s]
[0m09:35:05.276531 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_spi_subform_3
[0m09:35:05.276817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sociodemographic_survey, now model.engage_analytics.qr_spi_subform_4)
[0m09:35:05.277151 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_spi_subform_1
[0m09:35:05.280089 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:35:05.280557 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_spi_subform_4
[0m09:35:05.280883 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_start_ipc_s1
[0m09:35:05.281126 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:05.283704 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:35:05.284009 [info ] [Thread-1 (]: 53 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [RUN]
[0m09:35:05.284276 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:05.284470 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:05.284682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_1, now model.engage_analytics.qr_start_ipc_s1)
[0m09:35:05.285004 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:05.285324 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_start_ipc_s1
[0m09:35:05.288247 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:35:05.288551 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:05.288748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:05.604753 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.618 seconds
[0m09:35:05.605785 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_2"
[0m09:35:05.606290 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_spi_subform_2
[0m09:35:05.608159 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_2"
[0m09:35:05.608620 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:35:05.608799 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: BEGIN
[0m09:35:05.609535 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:05.609715 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:35:05.610052 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 2 with readable column names
-- Questionnaire ID: 104453
-- Source file: questionnaire/spi/spi-subform-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_2",max(case when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36' then answer_value_text end) as "spi_did_this_client_also_screen_positive_for_probable_",max(case when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896' then answer_value_text end) as "spi_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab_5",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "spi_taskid_spi_subform_3",max(case when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50' then answer_value_text end) as "spi_d02eb882411e4bc0af9d08a77fcc3f50",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "spi_taskstatus_spi_subform_3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "spi_taskid_spi_subform_4",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "spi_taskstatus_spi_subform_4",max(case when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f' then answer_value_text end) as "spi_53b30f1274eb474c941c5f0e81b7eb9f",max(case when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253' then answer_value_text end) as "spi_did_you_discuss_this_clients_suicide_risk_screenin",max(case when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b' then answer_value_text end) as "spi_this_client_scored_in_the_moderate_to_high_range_o",max(case when linkid = '783e2646-c8ea-466d-bba8-85c891a14435' then answer_value_text end) as "spi_783e2646c8ea466dbba885c891a14435"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:05.612945 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:05.615597 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:35:05.615836 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp" rename to "qr_spi_subform_2"
[0m09:35:05.616878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:05.617553 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:35:05.617752 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:35:05.617915 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:35:05.619301 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:05.620603 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup"
[0m09:35:05.620899 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:35:05.621078 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup" cascade
[0m09:35:05.621720 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:05.622464 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: Close
[0m09:35:05.622769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd02a80>]}
[0m09:35:05.623143 [info ] [Thread-2 (]: 50 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [[32mCREATE VIEW[0m in 0.64s]
[0m09:35:05.623425 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_spi_subform_2
[0m09:35:05.623622 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_start_ipc_s2
[0m09:35:05.623891 [info ] [Thread-2 (]: 54 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [RUN]
[0m09:35:05.624125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_2, now model.engage_analytics.qr_start_ipc_s2)
[0m09:35:05.624295 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_start_ipc_s2
[0m09:35:05.627314 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:35:05.627607 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:05.627795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:05.888495 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.604 seconds
[0m09:35:05.891044 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_3"
[0m09:35:05.893459 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_spi_subform_3
[0m09:35:05.895619 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_3"
[0m09:35:05.896160 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:35:05.896369 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_3: BEGIN
[0m09:35:05.896959 [debug] [Thread-4 (]: SQL status: SELECT 231 in 0.612 seconds
[0m09:35:05.897159 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:05.899583 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_4"
[0m09:35:05.899795 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:35:05.900057 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 3 with readable column names
-- Questionnaire ID: 104454
-- Source file: questionnaire/spi/spi-subform-3.json




  
  

  
  

  
  

  
  
    
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_3"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:05.900742 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_spi_subform_4
[0m09:35:05.902529 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_4"
[0m09:35:05.902768 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:05.904235 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:35:05.904432 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp" rename to "qr_spi_subform_3"
[0m09:35:05.904801 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:35:05.904985 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: BEGIN
[0m09:35:05.905245 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:05.905843 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:35:05.906030 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:05.906214 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:35:05.906388 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:35:05.906555 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:35:05.907555 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 4 with readable column names
-- Questionnaire ID: 104394
-- Source file: questionnaire/spi/spi-subform-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_4",max(case when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk_",max(case when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8' then answer_value_text end) as "spi_in_a_few_days_i_would_like_to_meet_for_a_followup_",max(case when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904' then answer_value_text end) as "spi_person_1",max(case when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0' then answer_value_text end) as "spi_when_you_feel_a_suicidal_crisis_arising_go_through",max(case when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185' then answer_value_text end) as "spi_i_would_like_to_make_a_plan_that_will_help_you_man",max(case when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048' then answer_value_text end) as "spi_cce2de12cf6244ff84e89eb4d864d048",max(case when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri",max(case when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb' then answer_value_text end) as "spi_40fbe8d043804efcbb0426fc7d3714eb",max(case when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7' then answer_value_text end) as "spi_the_methods_i_have_thought_about_using_include",max(case when linkid = '808ba31c-cd29-4743-8801-dfce357d5956' then answer_value_text end) as "spi_person_1_11",max(case when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc' then answer_value_text end) as "spi_90cedcbfbf114dc3973342e6900a09fc",max(case when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031' then answer_value_text end) as "spi_92ab6e65f9bd47188af6f731425d3031",max(case when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3' then answer_value_text end) as "spi_9d203bac75fd4f31bed6073502a977f3",max(case when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54' then answer_value_text end) as "spi_additional_hotline_numbers_you_can_contact",max(case when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk__16",max(case when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969' then answer_value_text end) as "spi_12d89dfd5e434f008446b3af23323969",max(case when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3' then answer_value_text end) as "spi_39de8b745cbc4225b27bc97e72f08af3",max(case when linkid = '437d9ea2-adb5-471a-828b-a0285a282217' then answer_value_text end) as "spi_437d9ea2adb5471a828ba0285a282217",max(case when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd' then answer_value_text end) as "spi_509b140eb1954696bc5ff2fc2d2f77dd",max(case when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7' then answer_value_text end) as "spi_53a575e3aa59408da0dd8df237b68bf7",max(case when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256' then answer_value_text end) as "spi_a6d066a2028649b0b68834696e7fb256",max(case when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4' then answer_value_text end) as "spi_ce56c71d9ea44c8e9e9ad1da93bac1d4",max(case when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect_",max(case when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77' then answer_value_text end) as "spi_person_1_25",max(case when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0' then answer_value_text end) as "spi_person_1_26",max(case when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0' then answer_value_text end) as "spi_beb4ad5f2fd84b80aa93aa9ff1896dd0",max(case when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46' then answer_value_text end) as "spi_c396a3af6f0d4a8ea42b4f47bbce5f46",max(case when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9' then answer_value_text end) as "spi_e45b778dee8c4ee981f48927006160f9",max(case when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003' then answer_value_text end) as "spi_your_local_hotline_number",max(case when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888' then answer_value_text end) as "spi_101d2b7f2b68407daa4930cb4dadc888",max(case when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0' then answer_value_text end) as "spi_14ec8995eee9416f83ad9f44631ac9b0",max(case when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564' then answer_value_text end) as "spi_18d8ee56ffd847119074126ef2cdc564",max(case when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by",max(case when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124' then answer_value_text end) as "spi_5324bdcebaaa45bf935aeb2f65bd7124",max(case when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488' then answer_value_text end) as "spi_68fa6f2e84ec4dbc900e10ede297c488",max(case when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4' then answer_value_text end) as "spi_8891cd7bad1c4030afe46752cd273cf4",max(case when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri_38",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi' then answer_value_text end) as "spi_taskid_spi_navigator",max(case when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0' then answer_value_text end) as "spi_c631e361027c4e4db89448785a3e6dd0",max(case when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410' then answer_value_text end) as "spi_taskid_my_safety_plan_pdf",max(case when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871' then answer_value_text end) as "spi_a1c56f60b8234c15b99da315d2ca1871",max(case when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9' then answer_value_text end) as "spi_ae4fa455f173435abb1b4df1d1316bd9",max(case when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad' then answer_value_text end) as "spi_bc981d8a7f22450babab3acca810ccad",max(case when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db' then answer_value_text end) as "spi_c6c266cc1c8541c097ce9ab491be45db",max(case when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233' then answer_value_text end) as "spi_person_2",max(case when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7' then answer_value_text end) as "spi_7d8621a4dcc84f4892103fb7d0dcc3c7",max(case when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164' then answer_value_text end) as "spi_83661ebe71cf4eab88e3bfecbfe35164",max(case when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12' then answer_value_text end) as "spi_be88b02764b64c3cbf5936a94dc79b12",max(case when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de' then answer_value_text end) as "spi_c3b4cf6e385d40b793804de2f81463de",max(case when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso",max(case when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect__53",max(case when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7' then answer_value_text end) as "spi_ff115c2695b94e0d87ed80817d438fc7",max(case when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596' then answer_value_text end) as "spi_656a57f8f6f04fc5b34771dd8d38f596",max(case when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7' then answer_value_text end) as "spi_f749685963bb4b2f8f7596e44e893bf7",max(case when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0' then answer_value_text end) as "spi_f8861b1c781f4f12b4c8f8110f0c2cc0",max(case when linkid = '15e5007d-028f-4644-8fb6-0346730c3101' then answer_value_text end) as "spi_15e5007d028f46448fb60346730c3101",max(case when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by",max(case when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_60",max(case when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e' then answer_value_text end) as "spi_2b2e05e90c11490cbbff278ba90d7b4e",max(case when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070' then answer_value_text end) as "spi_3e388595a32f46238c9f3c67bad04070",max(case when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123' then answer_value_text end) as "spi_62b0eb1746e54c50a133087cc190a123",max(case when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by_64",max(case when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609' then answer_value_text end) as "spi_705df2d9af924f4fb51317e01d07b609",max(case when linkid = '7845c436-4904-41fa-9553-2c401935623b' then answer_value_text end) as "spi_7845c436490441fa95532c401935623b",max(case when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe' then answer_value_text end) as "spi_person_2_67",max(case when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95' then answer_value_text end) as "spi_person_2_68",max(case when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966' then answer_value_text end) as "spi_c802f463c8f54056bc458ab8d64a1966",max(case when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by_70",max(case when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63' then answer_value_text end) as "spi_2a6c5feb8034418b8644142a5e31df63",max(case when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb' then answer_value_text end) as "spi_3785a2648bd544abbf088aa33735c0eb",max(case when linkid = '544a444d-b101-4d56-9351-00bca8ec749e' then answer_value_text end) as "spi_person_2_73",max(case when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea' then answer_value_text end) as "spi_603d1492316f497f967b5c4b1ab983ea",max(case when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f' then answer_value_text end) as "spi_9f3a622ad39b49b084e70bcf4f832a4f",max(case when linkid = 'e9c42647-eefb-42bd-9080-f83630729606' then answer_value_text end) as "spi_e9c42647eefb42bd9080f83630729606",max(case when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d' then answer_value_text end) as "spi_ee5d4acfecf04e628924cff17a33679d",max(case when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e' then answer_value_text end) as "spi_fe2f09118ddc412ba3e6f216620d147e",max(case when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a' then answer_value_text end) as "spi_370c849b0e0042acbe9d3b4c719ac31a",max(case when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52' then answer_value_text end) as "spi_person_3",max(case when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb' then answer_value_text end) as "spi_08b5e17c5e144b19ac939e479cd2a2bb",max(case when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86' then answer_value_text end) as "spi_13321778b5d44b018eda610cf0007c86",max(case when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by_84",max(case when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17' then answer_value_text end) as "spi_84018cd89134429c8dfefd6a16e4bd17",max(case when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer",max(case when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604' then answer_value_text end) as "spi_fdd7c3c3f2c343bd8a806b48aa2b9604",max(case when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4' then answer_value_text end) as "spi_8a9424b0c8934371b5c9bc0008be14b4",max(case when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af' then answer_value_text end) as "spi_a5d96f90cd914a5b8862c4e3f88694af",max(case when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3' then answer_value_text end) as "spi_person_3_90",max(case when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb' then answer_value_text end) as "spi_28b2e31aee4d4e998974b616145311eb",max(case when linkid = '53932020-eed8-46f4-8236-d548a6335a59' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by_92",max(case when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db' then answer_value_text end) as "spi_7e38a614b0a248eab7c7ca2bdc1f00db",max(case when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf' then answer_value_text end) as "spi_c1e99f8bb1ab46d1b205ecbbb4240fdf",max(case when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_95",max(case when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54' then answer_value_text end) as "spi_d4ebe78407d043128a46634c0e338a54",max(case when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47' then answer_value_text end) as "spi_53def3a1a7e5432695f22561c26ecb47",max(case when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b' then answer_value_text end) as "spi_2b96f1d93450423da277060fcfdadc6b",max(case when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5' then answer_value_text end) as "spi_person_4",max(case when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d' then answer_value_text end) as "spi_b36fdd5fccac457ca8eaf9497204ef1d",max(case when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_101",max(case when linkid = 'c5720a67-803f-4917-8261-3738de838418' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer_102",max(case when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5' then answer_value_text end) as "spi_person_3_103",max(case when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa' then answer_value_text end) as "spi_f952feaf7abc4f6fa3bcd10a43ea62fa",max(case when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6' then answer_value_text end) as "spi_bd7644ee28f14f43a65417fd5034d1f6",max(case when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090' then answer_value_text end) as "spi_72e5c1b77ce949bd834bd98b73ba7090",max(case when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33' then answer_value_text end) as "spi_person_4_107",max(case when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a' then answer_value_text end) as "spi_d82c6ae90516451391fa664686779d6a",max(case when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1' then answer_value_text end) as "spi_person_3_109",max(case when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807' then answer_value_text end) as "spi_fc5c673b41d4435286bb043c73ed9807",max(case when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49' then answer_value_text end) as "spi_0397084acd514b3a809d970a2406ea49",max(case when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972' then answer_value_text end) as "spi_6a273a9882ca4d36ade0ce98f7899972",max(case when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f' then answer_value_text end) as "spi_11aadd880cf948b2939d2b3e28191c5f",max(case when linkid = '57e87170-761c-4b57-a09c-d50cab02860c' then answer_value_text end) as "spi_57e87170761c4b57a09cd50cab02860c",max(case when linkid = '965b7874-dd24-4215-acd4-8d241a262638' then answer_value_text end) as "spi_965b7874dd244215acd48d241a262638",max(case when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb' then answer_value_text end) as "spi_bd62b64972094d329bbbdc2b2823aadb",max(case when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709' then answer_value_text end) as "spi_07c2e8dcb48b4bc7b21bc196cce32709",max(case when linkid = '83dfd82f-0277-459d-abe3-e8795750f288' then answer_value_text end) as "spi_person_5",max(case when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f' then answer_value_text end) as "spi_ae94969792ae476a96ccf8b0adc4221f",max(case when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2' then answer_value_text end) as "spi_2c7b6bd736f6495b9f41eb492c07c7b2",max(case when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_121",max(case when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897' then answer_value_text end) as "spi_fefdc90ffe1d4bfbaf9394df8c482897",max(case when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344' then answer_value_text end) as "spi_1fc8f8e7202248d2b41d4e8ad22af344",max(case when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c' then answer_value_text end) as "spi_8c1ac4fe1d7644368f34d315c6c17b9c",max(case when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d' then answer_value_text end) as "spi_person_5_125",max(case when linkid = 'df53c378-27fe-483d-a630-f7b171f72980' then answer_value_text end) as "spi_df53c37827fe483da630f7b171f72980",max(case when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660' then answer_value_text end) as "spi_e552afd32816446e9ff5e898bc813660",max(case when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_128",max(case when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369' then answer_value_text end) as "spi_person_4_129",max(case when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a' then answer_value_text end) as "spi_44f024678ee049f08da75e7ed827125a",max(case when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9' then answer_value_text end) as "spi_82d6b50b0bb240f694b17a4c58df43f9",max(case when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c' then answer_value_text end) as "spi_892337bdd7fd46a7bf7208e87c9f412c",max(case when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b' then answer_value_text end) as "spi_e4a1be29fe8b442391bc6b4f5d730e6b",max(case when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2' then answer_value_text end) as "spi_9f46e0ff05324105be360cfa9d0770f2",max(case when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8' then answer_value_text end) as "spi_86da79f044cb417dab20c7ecc6f8f7c8",max(case when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7' then answer_value_text end) as "spi_ce0fdd416b0941049998a04c5dd9a5b7",max(case when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0' then answer_value_text end) as "spi_3314932c64e44192b583eb31e87da1d0",max(case when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206' then answer_value_text end) as "spi_5e2ab0f5f5d94502befeaba770f0e206",max(case when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240' then answer_value_text end) as "spi_796f544054f84d69b961a5b7e6a63240",max(case when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478' then answer_value_text end) as "spi_9f531e6126cf4223865339c24d6dd478",max(case when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_141",max(case when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021' then answer_value_text end) as "spi_4d334b16ea16429994ed32e84ef97021",max(case when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf' then answer_value_text end) as "spi_895fad45c3b547c59edf5f9b9e793fbf",max(case when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc' then answer_value_text end) as "spi_92da95cc50dd4bf0acca4465c07d44cc",max(case when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd' then answer_value_text end) as "spi_person_5_145",max(case when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc' then answer_value_text end) as "spi_f1fef9d72ab94ead9c24c4dc9c7ed4cc",max(case when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2' then answer_value_text end) as "spi_40d6a87f94984cfdb2334610e6de08c2",max(case when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668' then answer_value_text end) as "spi_ac3206ddb60b4cb1a5593a770a685668",max(case when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21' then answer_value_text end) as "spi_f895ed4f50044da49d59c21293674b21",max(case when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8' then answer_value_text end) as "spi_faefef23d2e64777b6288f83921e8fd8",max(case when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c' then answer_value_text end) as "spi_62a0463889284aabb4901a33739b7a5c",max(case when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f' then answer_value_text end) as "spi_bfe595d6325f492ab3b6cc5541e18c3f",max(case when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa' then answer_value_text end) as "spi_40d8ef6402f042ae947877651bd26dfa",max(case when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3' then answer_value_text end) as "spi_249f5ce8ecc04e4396756b01ca1502a3",max(case when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27' then answer_value_text end) as "spi_9b1b11e8608f4ea9911b88aae467ac27",max(case when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4' then answer_value_text end) as "spi_dae7f411758d48009842fc0038a6b4a4",max(case when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14' then answer_value_text end) as "spi_0c308fef8ce54217a8d48e6ff00c8e14",max(case when linkid = '54b75d55-1c43-4552-acbf-d9754831add8' then answer_value_text end) as "spi_54b75d551c434552acbfd9754831add8",max(case when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c' then answer_value_text end) as "spi_9faa2b7818424326bf7f9975bf04dc2c",max(case when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f' then answer_value_text end) as "spi_a320b7874cba457f9c6067ff76c7020f",max(case when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc' then answer_value_text end) as "spi_706fc36fefef4bf9827e7dc100cc92bc",max(case when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a' then answer_value_text end) as "spi_a57b5b3412e54ec882157f316267323a",max(case when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75' then answer_value_text end) as "spi_6bbdb2cfe7f6443a8f4e841e16bb9b75",max(case when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e' then answer_value_text end) as "spi_d617b1e1ea224863a878627f6b81963e",max(case when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc' then answer_value_text end) as "spi_2cedd4dd15e549518674ea4d4eeb7cfc",max(case when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200' then answer_value_text end) as "spi_c0655b118f2147ed8ede95498c2e8200",max(case when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225' then answer_value_text end) as "spi_1895c0a7b0904f499b0c08dca9a7b225",max(case when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c' then answer_value_text end) as "spi_f311f3ca5537413488285e537bb26a9c",max(case when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268' then answer_value_text end) as "spi_1a00c7b7e80d4e908ed4efd8f6d96268",max(case when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e' then answer_value_text end) as "spi_527c0166cc354cc3a9d97eeb0a54635e",max(case when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed' then answer_value_text end) as "spi_41cce38aca5c4e24904a25b1027336ed",max(case when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5' then answer_value_text end) as "spi_e8726638cfdb40aeb72cf1d594f64de5",max(case when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f' then answer_value_text end) as "spi_6ac23c5d0035489585f233c2fbba8f3f",max(case when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99' then answer_value_text end) as "spi_e7ba8485515441b8ac1835410a83cd99",max(case when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81' then answer_value_text end) as "spi_06f9231a999b445982606fbbcdfc5d81",max(case when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444' then answer_value_text end) as "spi_d8615ac796b246a2b3a5b5b83945b444",max(case when linkid = '74d0f0df-e726-4c40-84ce-efece882818b' then answer_value_text end) as "spi_74d0f0dfe7264c4084ceefece882818b",max(case when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d' then answer_value_text end) as "spi_1d0ad82509de4018a680cd0e6bf0983d",max(case when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03' then answer_value_text end) as "spi_d5194db005464bd196d8d56457930c03",max(case when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131' then answer_value_text end) as "spi_9e11ce9790e842f2ba188c4f0720c131",max(case when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0' then answer_value_text end) as "spi_cb75bba90bd84dceba2fd1b21a97c2a0",max(case when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2' then answer_value_text end) as "spi_2f44652fdf2d476e933d75b6ed55f5f2",max(case when linkid = '7b51625b-73b9-472d-9c71-299beb26694f' then answer_value_text end) as "spi_7b51625b73b9472d9c71299beb26694f",max(case when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a' then answer_value_text end) as "spi_13e2f93482ed4b23af6e95523dc3746a",max(case when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248' then answer_value_text end) as "spi_ec54e447c9814dd2aaa4659f8e494248",max(case when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71' then answer_value_text end) as "spi_cf16ca6e8b1b467db807fc5d50339f71",max(case when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d' then answer_value_text end) as "spi_ce18eee3aa6444238db150fe7f00850d",max(case when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c' then answer_value_text end) as "spi_5a79866df1fb4bd8b4c4f18c982bef3c",max(case when linkid = '45772f3f-c610-408b-942b-359769945cf4' then answer_value_text end) as "spi_45772f3fc610408b942b359769945cf4",max(case when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111' then answer_value_text end) as "spi_cebffdf48fd14829884c41cc42bc0111",max(case when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0' then answer_value_text end) as "spi_7ca03155c9ec45e18cd05b86fa444ad0",max(case when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149' then answer_value_text end) as "spi_46c2861b70a94fdf94eae1a01cae3149",max(case when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d' then answer_value_text end) as "spi_8a5b1c7de3ef444385f1fa5213d89f8d",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12' then answer_value_text end) as "paracetamol",max(case when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98' then answer_value_text end) as "tiredness",max(case when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6' then answer_value_text end) as "watching_tv",max(case when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6' then answer_value_text end) as "wait_what",max(case when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by",max(case when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe' then answer_value_text end) as "sleeping",max(case when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f' then answer_value_text end) as "what",max(case when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264' then answer_value_text end) as "what_205",max(case when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d' then answer_value_text end) as "wait",max(case when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05' then answer_value_text end) as "wait_what_207",max(case when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13' then answer_value_text end) as "tiredness_208",max(case when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by_209",max(case when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8' then answer_value_text end) as "sleeping_210",max(case when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d' then answer_value_text end) as "socialize",max(case when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2' then answer_value_text end) as "yoga_playing_with_dog",max(case when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b' then answer_value_text end) as "watching_tv_213",max(case when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351' then answer_value_text end) as "video_games",max(case when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7' then answer_value_text end) as "wait_215",max(case when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba' then answer_value_text end) as "walking_in_the_park",max(case when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8' then answer_value_text end) as "none",max(case when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9' then answer_value_text end) as "20250204",max(case when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0' then answer_value_text end) as "taking_toxins",max(case when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a' then answer_value_text end) as "tiktok_dance_challenges",max(case when linkid = 'no-response-step-1' then answer_value_text end) as "no-response-step-1",max(case when linkid = 'no-response-step-1-review' then answer_value_text end) as "no-response-step-1-review",max(case when linkid = 'no-response-step-2' then answer_value_text end) as "no-response-step-2",max(case when linkid = 'no-response-step-2-review' then answer_value_text end) as "no-response-step-2-review",max(case when linkid = 'no-response-step-3' then answer_value_text end) as "no-response-step-3",max(case when linkid = 'no-response-step-3-review' then answer_value_text end) as "no-response-step-3-review",max(case when linkid = 'no-response-step-4' then answer_value_text end) as "no-response-step-4",max(case when linkid = 'no-response-step-4-review' then answer_value_text end) as "no-response-step-4-review",max(case when linkid = 'no-response-step-6a' then answer_value_text end) as "no-response-step-6a",max(case when linkid = 'no-response-step-6a-review' then answer_value_text end) as "no-response-step-6a-review",max(case when linkid = 'other-signs-step-1' then answer_value_text end) as "other-signs-step-1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:05.909561 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:05.911140 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup"
[0m09:35:05.911582 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:35:05.911903 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup" cascade
[0m09:35:05.912967 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:05.914018 [debug] [Thread-3 (]: On model.engage_analytics.qr_spi_subform_3: Close
[0m09:35:05.914433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd2d7f0>]}
[0m09:35:05.914793 [info ] [Thread-3 (]: 51 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:35:05.915084 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_spi_subform_3
[0m09:35:05.915289 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_start_ipc_s3
[0m09:35:05.915581 [debug] [Thread-1 (]: SQL status: SELECT 111 in 0.627 seconds
[0m09:35:05.915939 [info ] [Thread-3 (]: 55 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [RUN]
[0m09:35:05.917656 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:35:05.917943 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_3, now model.engage_analytics.qr_start_ipc_s3)
[0m09:35:05.918177 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_start_ipc_s3
[0m09:35:05.920908 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:35:05.921223 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:35:05.921442 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:05.924702 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:35:05.925031 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_start_ipc_s1
[0m09:35:05.925317 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:05.925515 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp" rename to "qr_spi_subform_4"
[0m09:35:05.927294 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:35:05.928345 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:35:05.928599 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: BEGIN
[0m09:35:05.929159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:05.929448 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:35:05.930117 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 1 with readable column names
-- Questionnaire ID: 55
-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as "ipc_s1_patient_age",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as "ipc_s1_patient_dob",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as "ipc_s1_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as "ipc_s1_in_the_past_6_months",max(case when linkid = 'f1.92.1' then answer_value_text end) as "ipc_s1_f1921",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as "ipc_s1_in_the_past_1_year",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as "ipc_s1_i_noticed_that_when_i_was_asking_about_important_p",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s1_did_you_complete_the_required_assessments_and_the_",max(case when linkid = 'f1.42.2' then answer_value_text end) as "ipc_s1_do_you_think_an_important_persons_death_is_connect",max(case when linkid = 'f1.68.2' then answer_value_text end) as "ipc_s1_are_you_and_someone_else_having_a_strong_disagreem",max(case when linkid = 'f1.69.2' then answer_value_text end) as "ipc_s1_briefly_tell_me_about_the_disagreement",max(case when linkid = 'f1.70.2' then answer_value_text end) as "ipc_s1_how_has_this_disagreement_been_affecting_you",max(case when linkid = 'f1.72.2' then answer_value_text end) as "ipc_s1_have_there_been_any_changes_in_your_life_that_are_",max(case when linkid = 'f1.73.2' then answer_value_text end) as "ipc_s1_what_was_the_change",max(case when linkid = 'f1.74.2' then answer_value_text end) as "ipc_s1_when_did_this_happen",max(case when linkid = 'f1.76.2' then answer_value_text end) as "ipc_s1_if_the_client_did_not_mention_any_close_relationsh",max(case when linkid = 'f1.78.2' then answer_value_text end) as "ipc_s1_would_you_say_you_have_close_relationships",max(case when linkid = 'f1.79.2' then answer_value_text end) as "ipc_s1_has_anything_changed_in_your_life_so_that_now_you_",max(case when linkid = 'f1.88.2' then answer_value_text end) as "ipc_s1_f1882",max(case when linkid = 'f1.89.2' then answer_value_text end) as "ipc_s1_select_the_possible_interpersonal_problem_areas_yo",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as "ipc_s1_your_most_distressing_current_symptoms_began",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as "ipc_s1_taskid_session_1_navigator",max(case when linkid = 'f1.40.2' then answer_value_text end) as "ipc_s1_f1402",max(case when linkid = 'f1.79.3' then answer_value_text end) as "ipc_s1_when_did_this_event_happen",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as "ipc_s1_is_there_anything_else_that_we_did_not_discuss_tha",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s1_taskid_session_2_navigator",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'f1.40.3' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or_",max(case when linkid = 'f1.43.2' then answer_value_text end) as "ipc_s1_tell_me_about_your_relationship_with_this_person_h",max(case when linkid = 'f1.69.3' then answer_value_text end) as "ipc_s1_when_did_this_disagreement_happen",max(case when linkid = 'f1.82.2' then answer_value_text end) as "ipc_s1_do_you_want_to_propose_an_interpersonal_formulatio",max(case when linkid = 'f1.87.2' then answer_value_text end) as "ipc_s1_do_you_agree_with_this",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as "ipc_s1_these_are_the_symptoms_you_said_you_are_currently_",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as "ipc_s1_taskid_mood_pdf",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as "ipc_s1_relationships_eg_talk_with_friends_or_vi",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as "ipc_s1_is_there_anything_that_could_get_in_the_way_of_you",max(case when linkid = 'f1.81.3' then answer_value_text end) as "ipc_s1_f1813",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_provider_pdf",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as "ipc_s1_work_on_my_relationship_with_my_parents_",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as "ipc_s1_f13931",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_client_pdf",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as "ipc_s1_of_these_symptoms_which_are_the_most_distressing",max(case when linkid = 'f1.81.4' then answer_value_text end) as "ipc_s1_f1814",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as "ipc_s1_earlier_than_that_you_noticed_symptoms",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as "ipc_s1_community_activities_eg_go_to_a_recreati",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as "ipc_s1_patient_name",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as "ipc_s1_f13932",max(case when linkid = 'f1.40.5' then answer_value_text end) as "ipc_s1_f1405",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as "ipc_s1_when_did_these_symptoms_begin",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as "ipc_s1_xxx",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "ipc_s1_yesterday_",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as "ipc_s1_patient_gender",max(case when linkid = 'f1.40.6' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__54",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as "ipc_s1_phq9_total",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as "ipc_s1_possible_problem_areas",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing_57",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as "ipc_s1_gad7_total",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as "ipc_s1_hobbies_eg_listen_to_music_play_video_ga",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as "ipc_s1_what_was_going_on_in_your_life_when_you_started_to",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s1_ptsd_total",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as "ipc_s1_zfgh",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as "ipc_s1_do_you_agree_with_this_summary",max(case when linkid = 'f1.40.8' then answer_value_text end) as "ipc_s1_f1408",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_mood_rating_session_1_score",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as "ipc_s1_what_about_before_that_was_there_a_time_before_in_",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as "ipc_s1_religionspirituality_eg_pray_or_go_to_se",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s1_mood_rating_total",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as "ipc_s1_person_1_is",max(case when linkid = 'f1.40.9' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__72",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as "ipc_s1_phq9_total_meaning",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as "ipc_s1_what_were_the_symptoms",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as "ipc_s1_with_my_pastor_",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as "ipc_s1_gad7_total_meaning",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as "ipc_s1_f13941",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as "ipc_s1_ptsd_total_meaning_toggle",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as "ipc_s1_when_did_you_notice_these_symptoms",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as "ipc_s1_other",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as "ipc_s1_mood_rating_comment",max(case when linkid = 'f1.38.4' then answer_value_text end) as "ipc_s1_f1384",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as "ipc_s1_f13942",max(case when linkid = 'f1.40.11' then answer_value_text end) as "ipc_s1_f14011",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as "ipc_s1_what_was_happening_then",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ipc_session_1",max(case when linkid = 'f1.40.12' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__87",max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as "ipc_s1_ex",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_89",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as "ipc_s1_person_2_is",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as "ipc_s1_f13951",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as "ipc_s1_f13952",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as "ipc_s1_gud",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_94",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as "ipc_s1_person_3_is",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as "ipc_s1_f13961",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as "ipc_s1_f13962",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_98",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as "ipc_s1_person_4_is",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as "seeing_someone_be_killed_or_seriously_injured",max(case when linkid = 'f1.38.3' then answer_value_text end) as "f1.38.3",max(case when linkid = 'f1.46.2' then answer_value_text end) as "f1.46.2",max(case when linkid = 'task-id-008' then answer_value_text end) as "task-id-008",max(case when linkid = 'task-id-009' then answer_value_text end) as "task-id-009",max(case when linkid = 'task-id-010' then answer_value_text end) as "task-id-010",max(case when linkid = 'task-id-012' then answer_value_text end) as "task-id-012"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:05.930878 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:35:05.931710 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:35:05.931925 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:35:05.932087 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:35:05.933328 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:05.934788 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup"
[0m09:35:05.935297 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:35:05.935541 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup" cascade
[0m09:35:05.936473 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:05.937359 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: Close
[0m09:35:05.937596 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:35:05.937975 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdb7110>]}
[0m09:35:05.939540 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:35:05.939948 [info ] [Thread-4 (]: 52 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [[32mCREATE VIEW[0m in 0.66s]
[0m09:35:05.940193 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp" rename to "qr_start_ipc_s1"
[0m09:35:05.940554 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_spi_subform_4
[0m09:35:05.940866 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_start_ipc_s4
[0m09:35:05.941124 [info ] [Thread-4 (]: 56 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [RUN]
[0m09:35:05.941345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_4, now model.engage_analytics.qr_start_ipc_s4)
[0m09:35:05.941515 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_start_ipc_s4
[0m09:35:05.943852 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:35:05.944140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:35:05.944372 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:35:05.945159 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:35:05.945383 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:05.945559 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:35:05.945903 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:35:05.947653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:05.949231 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup"
[0m09:35:05.949745 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:35:05.949939 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup" cascade
[0m09:35:05.950929 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:05.951837 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: Close
[0m09:35:05.952206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a585ee0>]}
[0m09:35:06.165320 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m09:35:06.165948 [info ] [Thread-1 (]: 53 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [[32mCREATE VIEW[0m in 0.67s]
[0m09:35:06.166264 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_start_ipc_s1
[0m09:35:06.166483 [debug] [Thread-1 (]: Began running node model.engage_analytics.practitioners
[0m09:35:06.166693 [info ] [Thread-1 (]: 57 of 59 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m09:35:06.166966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_start_ipc_s1, now model.engage_analytics.practitioners)
[0m09:35:06.167145 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.practitioners
[0m09:35:06.169585 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.169869 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m09:35:06.170084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:06.187887 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.018 seconds
[0m09:35:06.188890 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.189096 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m09:35:06.189708 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.000 seconds
[0m09:35:06.190555 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m09:35:06.191778 [debug] [Thread-1 (]: Began executing node model.engage_analytics.practitioners
[0m09:35:06.193939 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.194187 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    
  
    

  create temporary table "practitioners__dbt_tmp093506193161"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

where p._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
)

  );
  
  
[0m09:35:06.196675 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m09:35:06.198234 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.198488 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: BEGIN
[0m09:35:06.199384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:06.199552 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.199924 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioners__dbt_tmp093506193161'
        
      order by ordinal_position

  
[0m09:35:06.204002 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m09:35:06.206849 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.207106 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:06.209331 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:35:06.211077 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.211301 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:35:06.213062 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:35:06.214256 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m09:35:06.214759 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.214963 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioners__dbt_tmp093506193161" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" ("id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role")
    (
        select "id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role"
        from "practitioners__dbt_tmp093506193161"
    )
  
[0m09:35:06.215899 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:35:06.216692 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:35:06.216911 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:35:06.217084 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:35:06.218448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:06.218870 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: Close
[0m09:35:06.219176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4e42c0>]}
[0m09:35:06.219495 [info ] [Thread-1 (]: 57 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mINSERT 0 0[0m in 0.05s]
[0m09:35:06.219841 [debug] [Thread-1 (]: Finished running node model.engage_analytics.practitioners
[0m09:35:06.220074 [debug] [Thread-1 (]: Began running node model.engage_analytics.patient_anon
[0m09:35:06.220342 [info ] [Thread-1 (]: 58 of 59 START sql view model engage_analytics_engage_analytics_mart.patient_anon  [RUN]
[0m09:35:06.220565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioners, now model.engage_analytics.patient_anon)
[0m09:35:06.220739 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.patient_anon
[0m09:35:06.222538 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.patient_anon"
[0m09:35:06.222995 [debug] [Thread-1 (]: Began executing node model.engage_analytics.patient_anon
[0m09:35:06.224719 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.patient_anon"
[0m09:35:06.225079 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:35:06.225246 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: BEGIN
[0m09:35:06.225397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:06.241511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:35:06.241822 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:35:06.242097 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized patient view with masked PII fields for data sharing
-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number
-- Pulls phone numbers from registration data when available

with patient_with_registration as (
    select 
        p.*,
        r."phone-number" as registration_phone
    from "airbyte"."engage_analytics_engage_analytics_mart"."patient" p
    left join "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info" r on p.id = r.subject_patient_id
)

select 
    -- Use hashed ID for referential integrity while maintaining privacy
    MD5(p.id::text) as patient_id_hash,
    
    -- Demographic information (non-PII)
    p.gender,
    p.age_years,  -- Age instead of birth_date for privacy
    p.deceased,
    p.active,
    p.registration_date,
    
    -- Masked name fields
    'REDACTED' as name_family_masked,
    'REDACTED' as name_given_masked,
    
    -- Masked contact information (use registration phone if patient phone is null)
    CASE 
        WHEN COALESCE(p.phone_number, p.registration_phone) IS NOT NULL 
            AND LENGTH(COALESCE(p.phone_number, p.registration_phone)) >= 4
        THEN 'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, p.registration_phone), 4)
        ELSE 'NO PHONE'
    END as phone_number_masked,
    
    -- Location and organization (reference IDs only, no PII)
    p.location_id,
    p.practitioner_id,
    p.practitioner_organization_id,
    p.practitioner_careteam_id,
    
    -- Metadata
    p._airbyte_emitted_at,
    CURRENT_TIMESTAMP as anonymized_at

from patient_with_registration p
  );
[0m09:35:06.244905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:06.246982 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:35:06.247260 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp" rename to "patient_anon"
[0m09:35:06.248098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:06.248723 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:35:06.248902 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:35:06.249056 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:35:06.250074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:06.251232 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup"
[0m09:35:06.251498 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:35:06.251662 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup" cascade
[0m09:35:06.252420 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:35:06.253284 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: Close
[0m09:35:06.253628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf0ad20>]}
[0m09:35:06.253840 [debug] [Thread-2 (]: SQL status: SELECT 91 in 0.626 seconds
[0m09:35:06.255607 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:35:06.254173 [info ] [Thread-1 (]: 58 of 59 OK created sql view model engage_analytics_engage_analytics_mart.patient_anon  [[32mCREATE VIEW[0m in 0.03s]
[0m09:35:06.255991 [debug] [Thread-1 (]: Finished running node model.engage_analytics.patient_anon
[0m09:35:06.256184 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_registration_info_anon
[0m09:35:06.256430 [info ] [Thread-1 (]: 59 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [RUN]
[0m09:35:06.256708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient_anon, now model.engage_analytics.qr_registration_info_anon)
[0m09:35:06.256896 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_start_ipc_s2
[0m09:35:06.257064 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_registration_info_anon
[0m09:35:06.258971 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:35:06.260840 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info_anon"
[0m09:35:06.261382 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:35:06.261600 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_registration_info_anon
[0m09:35:06.261770 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: BEGIN
[0m09:35:06.263457 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info_anon"
[0m09:35:06.264061 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:35:06.264358 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:06.264580 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: BEGIN
[0m09:35:06.264822 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:35:06.265073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:06.265764 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 2 with readable column names
-- Questionnaire ID: 58
-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "ipc_s2_phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "ipc_s2_gad7_total_meaning",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s2_ptsd_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as "ipc_s2_phq9_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as "ipc_s2_summary_when_1",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as "ipc_s2_most_distressing_symptoms",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as "ipc_s2_selected_problem_area",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as "ipc_s2_ptsd_total_meaning_toggle",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as "ipc_s2_gad7_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s2_taskid_session_2_navigator",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as "ipc_s2_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s2_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s2_taskid_session_3_navigator",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as "ipc_s2_have_you_proposed_the_interpersonal_formulation_in",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_provider_pdf",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s2_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as "ipc_s2_a4a9cad504db44e59a9d0f1bf40ca840",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s2_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s2_747188c84fc043ea92b49baa32567f73",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as "ipc_s2_did_the_person_ever_hit_kick_push_or_slap_you",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as "ipc_s2_do_you_agree_with_this",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ipc_session_2",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s2_3d2ccf9a0e7b48a0854044d43b6dacfe",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area_28",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s2_6fb0c7a5a21143ecaf7b5f1079399133",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_mood_rating_session_1_score",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s2_did_you_ever_hit_kick_push_or_slap_the_person",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as "ipc_s2_do_you_still_think_that",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s2_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s2_232484cf1aee4bfaa66e61494587a16a",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s2_9ed77f2a0d5a434db153d8deadfbc3f8",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s2_3bfee97a6a0e4cd0bdb77ffa8d36191f",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree_37",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__39",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__40",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__41",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as "ipc_s2_287593c3417445afa99871d249230943",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s2_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s2_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s2_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s2_665e1595f16948159d24dac265f1809b",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s2_bc8f199a59f04184864db1c0befd26df",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s2_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s2_e17756cd48614dde859cf90241977246",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s2_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as "ipc_s2_is_any_of_the_2_question_above_is_true",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as "ipc_s2_2ef63cf4b37e4216a8e1db6d1b91cc2a",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s2_3e0b76f9090243bab8580b1505e9d168",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s2_9cc2834b0d2843d08811509995cfcdb8",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s2_a7f10195b8594670abbca2498c4fe45f",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__57",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s2_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s2_547a07c2f94c4956997f0439626d0251",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s2_6c1b2aa7f2444d5abfc6e0faef33bfe6",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s2_a77f07b379134708a35414e503a948f1",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s2_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s2_example_skills_63",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s2_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s2_eb8828db167447e7ba9ae3c161160b65",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s2_example_skills_66",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s2_4c95559d86ff4b87a271e52388072a53",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s2_bed17079d1e54bbeaf073d7b6a86243e",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__69",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__70",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__71",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s2_example_skills_72",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s2_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__77",max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__78",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__79",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = 'task-id-013' then answer_value_text end) as "task-id-013",max(case when linkid = 'task-id-014' then answer_value_text end) as "task-id-014",max(case when linkid = 'task-id-015' then answer_value_text end) as "task-id-015",max(case when linkid = 'task-id-016' then answer_value_text end) as "task-id-016",max(case when linkid = 'task-id-018' then answer_value_text end) as "task-id-018"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:06.274068 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:35:06.275885 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:35:06.276194 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp" rename to "qr_start_ipc_s2"
[0m09:35:06.278077 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:35:06.278980 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:35:06.279201 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:35:06.279363 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:35:06.280454 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:06.281699 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup"
[0m09:35:06.281968 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:35:06.282148 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup" cascade
[0m09:35:06.282636 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:06.283324 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: Close
[0m09:35:06.283514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m09:35:06.283695 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:35:06.283927 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized registration info with masked PII fields
-- Masks: Unique ID, Names, DOB, Phone, Email, Physical address, Zip code, Medicaid number

select 
    -- Non-PII identifiers (hashed for referential integrity)
    MD5(qr_id::text) as qr_id_hash,
    questionnaire_id,
    MD5(subject_patient_id::text) as subject_patient_id_hash,
    encounter_id,
    author_practitioner_id,
    
    -- Location and organization references (non-PII)
    practitioner_location_id,
    practitioner_organization_id,
    practitioner_id,
    practitioner_careteam_id,
    
    -- Application metadata
    application_version,
    
    -- Masked PII fields
    'REDACTED' as registration_unique_id_masked,
    'REDACTED' as registration_first_name_masked,
    'REDACTED' as registration_middle_name_masked,
    'REDACTED' as registration_surname_masked,
    
    -- Age fields (keep age, mask DOB)
    registration_age,
    registration_age_6,
    registration_calculated_age,
    'REDACTED' as registration_date_of_birth_dob_masked,
    
    -- Masked contact information
    'REDACTED' as "email-address_masked",
    CASE 
        WHEN "phone-number" IS NOT NULL 
        THEN 'XXX-XXX-' || RIGHT("phone-number", 4)
        ELSE NULL
    END as "phone-number_masked",
    'REDACTED' as "physical-address_masked",
    CASE 
        WHEN "zip-code" IS NOT NULL 
        THEN LEFT("zip-code", 3) || 'XX'
        ELSE NULL
    END as "zip-code_masked",
    
    -- Masked Medicaid information
    CASE 
        WHEN "do-you-have-medicaid" = 'Yes' 
        THEN 'Yes'
        ELSE "do-you-have-medicaid"
    END as "do-you-have-medicaid",
    'REDACTED' as "medicaid-number_masked",
    
    -- Non-PII demographic fields
    registration_which_of_the_following_best_represents_how_you_thi,
    registration_what_was_your_biological_sex_assigned_at_birth,
    "choice-gender-identity",
    "choice-pronouns",
    "other-best-represents-how-you-think-of-yourself",
    
    -- Service history (non-PII)
    registration_has_this_person_received_engage_services_in_the_pa,
    
    -- Date components (non-specific)
    registration_calculated_month,
    registration_calculated_year,
    
    -- Metadata
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info"
  );
[0m09:35:06.284275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c015460>]}
[0m09:35:06.284682 [info ] [Thread-2 (]: 54 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [[32mCREATE VIEW[0m in 0.66s]
[0m09:35:06.285315 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_start_ipc_s2
[0m09:35:06.286856 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:35:06.288952 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:35:06.289242 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp" rename to "qr_registration_info_anon"
[0m09:35:06.290438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:06.291191 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:35:06.291380 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:35:06.291581 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:35:06.292749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:06.294199 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup"
[0m09:35:06.294583 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:35:06.294771 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup" cascade
[0m09:35:06.295461 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:06.296262 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: Close
[0m09:35:06.296578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0e5970>]}
[0m09:35:06.296901 [info ] [Thread-1 (]: 59 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [[32mCREATE VIEW[0m in 0.04s]
[0m09:35:06.297469 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_registration_info_anon
[0m09:35:06.584494 [debug] [Thread-3 (]: SQL status: SELECT 97 in 0.659 seconds
[0m09:35:06.586220 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:35:06.586779 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_start_ipc_s3
[0m09:35:06.588656 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:35:06.589197 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:35:06.589419 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s3: BEGIN
[0m09:35:06.590121 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:06.590300 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:35:06.590830 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 3 with readable column names
-- Questionnaire ID: 208
-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as "ipc_s3_phq9_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as "ipc_s3_gad7_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as "ipc_s3_ptsd_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as "ipc_s3_ptsd_total_meaning",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s3_taskid_session_3_navigator",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s3_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s3_taskid_session_4_navigator",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as "ipc_s3_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s3_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_provider_pdf",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s3_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ipc_session_3",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_16",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s3_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_18",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s3_observation_id_of_mood_rating_session_3_score",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as "ipc_s3_1b59ddeb483d4b1baf53f3942204589a",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s3_did_you_ever_hit_kick_push_or_slap_the_personno",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s3_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_23",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as "ipc_s3_4554f4b2d15e47e7a10dd77939dd3afc",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_25",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as "ipc_s3_f9a9f4928eb84c718ec6f80ab596430b",max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__28",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__29",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__30",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s3_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as "ipc_s3_59744d4501004d62b1055cbecd973ffd",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as "ipc_s3_6b5fa4342fc34e4bad1189f6260a81f2",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as "ipc_s3_77fc70ba6cac494cb27a77ebce2289e5",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s3_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s3_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as "ipc_s3_has_anything_changed_since_the_last_time_we_met",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s3_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_40",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as "ipc_s3_4ad7384fa3324e4193180d3f9e540ee7",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as "ipc_s3_stage_identified_in_session_2",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_43",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_44",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_45",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as "ipc_s3_b24118e231c54e23af3a1722af72c299",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as "ipc_s3_68b3cbf5b9ef4da49ac1bcbc20f04473",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as "ipc_s3_9e995f48b09249b2a9e4c7e754e446e5",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__49",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s3_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as "ipc_s3_e8b8e5504d6542beacb92f4ac17c7f49",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s3_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s3_example_skills_53",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s3_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s3_example_skills_55",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_56",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_57",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_58",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s3_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_60",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as "ipc_s3_920de190557a423391a34bf293f18214",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as "ipc_s3_95121ef1bfe540ce841c524334644148",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as "ipc_s3_e1a13d53b867440f8622bccebf54f176",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s3_547a07c2f94c4956997f0439626d0251",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as "ipc_s3_8ac792f53f3c49d3a80063c662bf00cd",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__66",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__67",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__68",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s3_a77f07b379134708a35414e503a948f1",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s3_example_skills_70",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_71",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s3_4c95559d86ff4b87a271e52388072a53",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__73",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_77",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as "ipc_s3_8c82f7573f404b09bdf478ee376f75a8",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s3_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__82",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__83",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "gad7_total_meaning",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person_91",max(case when linkid = 'task-id-019' then answer_value_text end) as "task-id-019",max(case when linkid = 'task-id-020' then answer_value_text end) as "task-id-020",max(case when linkid = 'task-id-021' then answer_value_text end) as "task-id-021",max(case when linkid = 'task-id-022' then answer_value_text end) as "task-id-022",max(case when linkid = 'task-id-023' then answer_value_text end) as "task-id-023",max(case when linkid = 'task-id-024' then answer_value_text end) as "task-id-024"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:06.597284 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:35:06.599064 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:35:06.599272 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp" rename to "qr_start_ipc_s3"
[0m09:35:06.600803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:06.601531 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:35:06.601771 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:35:06.601925 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:35:06.602651 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.657 seconds
[0m09:35:06.603792 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:35:06.604063 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:35:06.605313 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup"
[0m09:35:06.605604 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:35:06.605851 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup" cascade
[0m09:35:06.606278 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_start_ipc_s4
[0m09:35:06.608054 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:35:06.608245 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:35:06.608930 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s3: Close
[0m09:35:06.609269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd42c90>]}
[0m09:35:06.609480 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:35:06.610024 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: BEGIN
[0m09:35:06.609797 [info ] [Thread-3 (]: 55 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [[32mCREATE VIEW[0m in 0.69s]
[0m09:35:06.610363 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_start_ipc_s3
[0m09:35:06.610727 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:35:06.611012 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:35:06.611392 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 4 with readable column names
-- Questionnaire ID: 63
-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as "ipc_s4_phq9_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as "ipc_s4_gad7_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as "ipc_s4_ptsd_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s4_taskid_session_4_navigator",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_provider_pdf",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as "ipc_s4_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_client_pdf",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as "ipc_s4_what_we_know_is_that_symptoms_can_come_back_in_the",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s4_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as "ipc_s4_after_todays_session_i_can_refer_you_for_clinical_",max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as "ipc_s4_after_todays_session_i_will_be_referring_you_for_a",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri_14",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as "ipc_s4_how_does_it_make_you_feel_to_know_that_today_is_ou",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as "ipc_s4_how_do_you_feel_about_today_being_our_last_session",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as "ipc_s4_how_would_you_know_if_your_symptoms_are_coming_bac",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that_",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as "ipc_s4_please_select_how_you_would_like_to_proceed_with_t",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that__21",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s_22",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y_23",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s4_mood_rating_total",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as "ipc_s4_i_am_going_to_provide_you_with_our_agencys_contact",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard_28",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that_",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that__30",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as "ipc_s4_7fef53bc56db47ce8cba8efd4bcbc318",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "did_you_discuss_this_clients_severe_mental_health_screening",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "what_is_the_recommended_plan_to_address_the_probable_severe",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as "feeling_changed",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "referral_details_if_the_client_is_referred_out",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as "rerer",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as "20241031",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as "20250201",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as "is-connected-to-clinical-care-details",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as "is-connected-to-clinical-care-question"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:35:06.615416 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:35:06.618331 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:35:06.618597 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp" rename to "qr_start_ipc_s4"
[0m09:35:06.619993 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:06.620796 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:35:06.620986 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:35:06.621150 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:35:06.622101 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:35:06.623281 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup"
[0m09:35:06.623561 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:35:06.623729 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup" cascade
[0m09:35:06.624455 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:35:06.625301 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: Close
[0m09:35:06.625619 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df811774-22fe-44f0-909b-9f92526e0f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1389e0>]}
[0m09:35:06.625977 [info ] [Thread-4 (]: 56 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [[32mCREATE VIEW[0m in 0.68s]
[0m09:35:06.626279 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_start_ipc_s4
[0m09:35:06.627152 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:06.627316 [debug] [MainThread]: On master: BEGIN
[0m09:35:06.627451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:35:06.642413 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:35:06.642702 [debug] [MainThread]: On master: COMMIT
[0m09:35:06.642861 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:06.642996 [debug] [MainThread]: On master: COMMIT
[0m09:35:06.643465 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:35:06.643623 [debug] [MainThread]: On master: Close
[0m09:35:06.643844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:06.643984 [debug] [MainThread]: Connection 'model.engage_analytics.qr_registration_info_anon' was properly closed.
[0m09:35:06.644113 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s2' was properly closed.
[0m09:35:06.644234 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s3' was properly closed.
[0m09:35:06.644386 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s4' was properly closed.
[0m09:35:06.644701 [info ] [MainThread]: 
[0m09:35:06.644874 [info ] [MainThread]: Finished running 18 incremental models, 41 view models in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m09:35:06.648155 [debug] [MainThread]: Command end result
[0m09:35:06.673030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:35:06.674507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:35:06.680121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:35:06.680358 [info ] [MainThread]: 
[0m09:35:06.680569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:35:06.680743 [info ] [MainThread]: 
[0m09:35:06.680917 [info ] [MainThread]: Done. PASS=59 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=59
[0m09:35:06.681313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.580897, "process_in_blocks": "0", "process_kernel_time": 0.411727, "process_mem_max_rss": "140558336", "process_out_blocks": "0", "process_user_time": 2.70497}
[0m09:35:06.681543 [debug] [MainThread]: Command `dbt run` succeeded at 09:35:06.681500 after 7.58 seconds
[0m09:35:06.681736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198b8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0719a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b97b560>]}
[0m09:35:06.681929 [debug] [MainThread]: Flushing usage events
[0m09:35:06.826772 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:15.152350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a96c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed52b0>]}


============================== 09:38:15.157384 | bb1e0bcf-29fe-4a78-84b5-c5d4c96ca4bc ==============================
[0m09:38:15.157384 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:38:15.157850 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select qr_registration_info_anon', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:38:15.268357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb1e0bcf-29fe-4a78-84b5-c5d4c96ca4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058df620>]}
[0m09:38:15.298829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb1e0bcf-29fe-4a78-84b5-c5d4c96ca4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7d5b0>]}
[0m09:38:15.299706 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:38:15.355352 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:38:15.454265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:38:15.454759 [debug] [MainThread]: Partial parsing: updated file: engage_analytics://models/marts/qr_named/qr_registration_info_anon.sql
[0m09:38:15.588385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb1e0bcf-29fe-4a78-84b5-c5d4c96ca4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1f27b0>]}
[0m09:38:15.642158 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:38:15.643790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:38:15.659239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb1e0bcf-29fe-4a78-84b5-c5d4c96ca4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e3a8d0>]}
[0m09:38:15.659596 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:38:15.659823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb1e0bcf-29fe-4a78-84b5-c5d4c96ca4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1f2e10>]}
[0m09:38:15.661016 [info ] [MainThread]: 
[0m09:38:15.661311 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:38:15.661456 [info ] [MainThread]: 
[0m09:38:15.661696 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:15.662183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:38:15.690721 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:38:15.691074 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:38:15.691275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:15.745472 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.054 seconds
[0m09:38:15.746394 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:38:15.750680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m09:38:15.751062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m09:38:15.784462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m09:38:15.787894 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:38:15.788837 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:38:15.789834 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:38:15.790112 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:38:15.790372 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:38:15.790598 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:38:15.790808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:15.791028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:15.791238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:15.819543 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m09:38:15.819860 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m09:38:15.820042 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m09:38:15.820217 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:38:15.820534 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:38:15.820719 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:38:15.820891 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:38:15.821100 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:38:15.821280 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:38:15.824387 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m09:38:15.824648 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m09:38:15.824869 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.003 seconds
[0m09:38:15.825684 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:38:15.826343 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:38:15.827138 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:38:15.827661 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:38:15.827842 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:38:15.828152 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:38:15.835164 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:15.835440 [debug] [MainThread]: On master: BEGIN
[0m09:38:15.835578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:15.856313 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m09:38:15.856625 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:15.856829 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:38:15.862295 [debug] [MainThread]: SQL status: SELECT 112 in 0.005 seconds
[0m09:38:15.870474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb1e0bcf-29fe-4a78-84b5-c5d4c96ca4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e51ee0>]}
[0m09:38:15.870768 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:15.872158 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:15.872440 [debug] [MainThread]: On master: BEGIN
[0m09:38:15.873487 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:38:15.873648 [debug] [MainThread]: On master: COMMIT
[0m09:38:15.873787 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:15.873933 [debug] [MainThread]: On master: COMMIT
[0m09:38:15.874443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:15.874628 [debug] [MainThread]: On master: Close
[0m09:38:15.876655 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_registration_info_anon
[0m09:38:15.876947 [info ] [Thread-1 (]: 1 of 1 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [RUN]
[0m09:38:15.877175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.qr_registration_info_anon)
[0m09:38:15.877353 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_registration_info_anon
[0m09:38:15.881185 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info_anon"
[0m09:38:15.882174 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_registration_info_anon
[0m09:38:15.899763 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info_anon"
[0m09:38:15.901224 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:38:15.901514 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: BEGIN
[0m09:38:15.904360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:15.931432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m09:38:15.931761 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:38:15.932091 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized registration info with masked PII fields
-- Masks: Unique ID, Names, DOB, Phone, Email, Physical address, Zip code, Medicaid number

select 
    -- Non-PII identifiers (hashed for referential integrity)
    MD5(qr_id::text) as qr_id_hash,
    questionnaire_id,
    MD5(subject_patient_id::text) as subject_patient_id_hash,
    encounter_id,
    author_practitioner_id,
    
    -- Location and organization references (non-PII)
    practitioner_location_id,
    practitioner_organization_id,
    practitioner_id,
    practitioner_careteam_id,
    
    -- Application metadata
    application_version,
    
    -- Masked PII fields
    'REDACTED' as registration_unique_id_masked,
    'REDACTED' as registration_first_name_masked,
    'REDACTED' as registration_middle_name_masked,
    'REDACTED' as registration_surname_masked,
    
    -- Age fields (keep age, mask DOB)
    registration_age,
    registration_age_6,
    registration_calculated_age,
    'REDACTED' as registration_date_of_birth_dob_masked,
    
    -- Masked contact information
    'REDACTED' as "email-address_masked",
    CASE 
        WHEN "phone-number" IS NOT NULL AND LENGTH("phone-number") >= 4
        THEN 'XXX-XXX-' || RIGHT("phone-number", 4)
        WHEN "phone-number" IS NOT NULL
        THEN 'XXX-XXX-' || "phone-number"
        ELSE 'NO PHONE'
    END as "phone-number_masked",
    'REDACTED' as "physical-address_masked",
    CASE 
        WHEN "zip-code" IS NOT NULL 
        THEN LEFT("zip-code", 3) || 'XX'
        ELSE NULL
    END as "zip-code_masked",
    
    -- Masked Medicaid information
    CASE 
        WHEN "do-you-have-medicaid" = 'Yes' 
        THEN 'Yes'
        ELSE "do-you-have-medicaid"
    END as "do-you-have-medicaid",
    'REDACTED' as "medicaid-number_masked",
    
    -- Non-PII demographic fields
    registration_which_of_the_following_best_represents_how_you_thi,
    registration_what_was_your_biological_sex_assigned_at_birth,
    "choice-gender-identity",
    "choice-pronouns",
    "other-best-represents-how-you-think-of-yourself",
    
    -- Service history (non-PII)
    registration_has_this_person_received_engage_services_in_the_pa,
    
    -- Date components (non-specific)
    registration_calculated_month,
    registration_calculated_year,
    
    -- Metadata
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info"
  );
[0m09:38:15.935217 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:38:15.939907 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:38:15.940200 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon" rename to "qr_registration_info_anon__dbt_backup"
[0m09:38:15.941555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:15.943449 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:38:15.943665 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp" rename to "qr_registration_info_anon"
[0m09:38:15.944671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:15.953142 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:38:15.953429 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:38:15.953604 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:38:15.956521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:38:15.959868 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup"
[0m09:38:15.962004 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:38:15.962196 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup" cascade
[0m09:38:15.966436 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:38:15.967952 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: Close
[0m09:38:15.969092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1e0bcf-29fe-4a78-84b5-c5d4c96ca4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058de7e0>]}
[0m09:38:15.969476 [info ] [Thread-1 (]: 1 of 1 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [[32mCREATE VIEW[0m in 0.09s]
[0m09:38:15.969785 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_registration_info_anon
[0m09:38:15.970637 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:15.970852 [debug] [MainThread]: On master: BEGIN
[0m09:38:15.971003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:16.001325 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m09:38:16.001624 [debug] [MainThread]: On master: COMMIT
[0m09:38:16.001786 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:16.001925 [debug] [MainThread]: On master: COMMIT
[0m09:38:16.002554 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:16.002897 [debug] [MainThread]: On master: Close
[0m09:38:16.003184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:16.003342 [debug] [MainThread]: Connection 'model.engage_analytics.qr_registration_info_anon' was properly closed.
[0m09:38:16.003478 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_stg' was properly closed.
[0m09:38:16.003597 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_mart' was properly closed.
[0m09:38:16.003760 [info ] [MainThread]: 
[0m09:38:16.003914 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m09:38:16.004253 [debug] [MainThread]: Command end result
[0m09:38:16.025501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:38:16.026806 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:38:16.030456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:38:16.030656 [info ] [MainThread]: 
[0m09:38:16.030871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:38:16.031024 [info ] [MainThread]: 
[0m09:38:16.031176 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:38:16.031518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9262027, "process_in_blocks": "0", "process_kernel_time": 0.234983, "process_mem_max_rss": "138084352", "process_out_blocks": "0", "process_user_time": 1.278435}
[0m09:38:16.031747 [debug] [MainThread]: Command `dbt run` succeeded at 09:38:16.031704 after 0.93 seconds
[0m09:38:16.031955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed51f0>]}
[0m09:38:16.032154 [debug] [MainThread]: Flushing usage events
[0m09:38:16.198485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:47.685072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105019610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105019340>]}


============================== 09:44:47.688972 | cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5 ==============================
[0m09:44:47.688972 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:44:47.689325 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:44:47.799059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101a27950>]}
[0m09:44:47.829812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e38a10>]}
[0m09:44:47.830665 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:44:47.884539 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:44:47.980809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:47.981086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:48.003189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056890d0>]}
[0m09:44:48.055509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:44:48.057440 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:44:48.072400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4aba0>]}
[0m09:44:48.072710 [info ] [MainThread]: Found 59 models, 1 seed, 12 sources, 558 macros
[0m09:44:48.072894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee51f0>]}
[0m09:44:48.074719 [info ] [MainThread]: 
[0m09:44:48.074912 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:44:48.075053 [info ] [MainThread]: 
[0m09:44:48.075306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:48.078556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:44:48.085429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:44:48.085884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m09:44:48.111709 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:44:48.111966 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:44:48.112148 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:44:48.112301 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m09:44:48.112459 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:44:48.112627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:48.112771 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m09:44:48.112917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:48.113973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:48.272773 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.160 seconds
[0m09:44:48.273126 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.159 seconds
[0m09:44:48.273385 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.160 seconds
[0m09:44:48.274231 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:44:48.274927 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:44:48.275779 [debug] [ThreadPool]: On list_airbyte: Close
[0m09:44:48.280007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m09:44:48.283340 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:44:48.283659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m09:44:48.283942 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m09:44:48.284245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m09:44:48.285377 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:44:48.285602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:48.286652 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:44:48.286920 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m09:44:48.287214 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m09:44:48.287412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:48.287593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:48.332793 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m09:44:48.333209 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m09:44:48.333537 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m09:44:48.333815 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m09:44:48.333968 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m09:44:48.334131 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m09:44:48.335147 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m09:44:48.335361 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m09:44:48.335552 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m09:44:48.336932 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m09:44:48.337856 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m09:44:48.338117 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.004 seconds
[0m09:44:48.339084 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m09:44:48.339297 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:44:48.339475 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m09:44:48.340051 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m09:44:48.340206 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m09:44:48.341326 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m09:44:48.347805 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:48.348050 [debug] [MainThread]: On master: BEGIN
[0m09:44:48.348340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:48.374125 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m09:44:48.374409 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:48.374625 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:44:48.379985 [debug] [MainThread]: SQL status: SELECT 112 in 0.005 seconds
[0m09:44:48.389265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2a540>]}
[0m09:44:48.389621 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:48.390412 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:48.390610 [debug] [MainThread]: On master: BEGIN
[0m09:44:48.391653 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.391865 [debug] [MainThread]: On master: COMMIT
[0m09:44:48.392029 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:48.392174 [debug] [MainThread]: On master: COMMIT
[0m09:44:48.392709 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:44:48.392997 [debug] [MainThread]: On master: Close
[0m09:44:48.395746 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m09:44:48.396066 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m09:44:48.396434 [info ] [Thread-1 (]: 1 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m09:44:48.396702 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m09:44:48.396988 [info ] [Thread-2 (]: 2 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m09:44:48.397547 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m09:44:48.397837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_careplans)
[0m09:44:48.398160 [info ] [Thread-3 (]: 3 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m09:44:48.398456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_careteams)
[0m09:44:48.400098 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m09:44:48.398903 [info ] [Thread-4 (]: 4 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m09:44:48.400594 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_encounter)
[0m09:44:48.400897 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m09:44:48.406604 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m09:44:48.411808 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m09:44:48.412101 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m09:44:48.415569 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m09:44:48.415919 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m09:44:48.418681 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m09:44:48.422478 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m09:44:48.422742 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m09:44:48.423312 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m09:44:48.435831 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m09:44:48.459460 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:44:48.459903 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:44:48.460217 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m09:44:48.462240 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:44:48.462524 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

    
  
    

  create temporary table "stg_careteams__dbt_tmp094448443936"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams")

  );
  
  
[0m09:44:48.462807 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

    
  
    

  create temporary table "stg_careplans__dbt_tmp094448440965"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans")

  );
  
  
[0m09:44:48.465277 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:44:48.465534 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

    
  
    

  create temporary table "stg_locations__dbt_tmp094448461512"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations")

  );
  
  
[0m09:44:48.465782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:48.465967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:48.466180 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

    
  
    

  create temporary table "stg_encounter__dbt_tmp094448463941"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter")

  );
  
  
[0m09:44:48.466419 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:48.466771 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:48.501315 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.035 seconds
[0m09:44:48.533395 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.067 seconds
[0m09:44:48.539744 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:44:48.539991 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.074 seconds
[0m09:44:48.540157 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.073 seconds
[0m09:44:48.541678 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:44:48.541884 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m09:44:48.543124 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:44:48.544340 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:44:48.544520 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m09:44:48.544798 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m09:44:48.545065 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m09:44:48.545400 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.545619 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:44:48.545816 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams__dbt_tmp094448443936'
        
      order by ordinal_position

  
[0m09:44:48.546014 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.546197 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:44:48.546373 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations__dbt_tmp094448461512'
        
      order by ordinal_position

  
[0m09:44:48.546615 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.546819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m09:44:48.547032 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:44:48.547210 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:44:48.547381 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter__dbt_tmp094448463941'
        
      order by ordinal_position

  
[0m09:44:48.547559 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans__dbt_tmp094448440965'
        
      order by ordinal_position

  
[0m09:44:48.552303 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.006 seconds
[0m09:44:48.555257 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:44:48.555557 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.009 seconds
[0m09:44:48.555821 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.556006 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.008 seconds
[0m09:44:48.556158 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.008 seconds
[0m09:44:48.557915 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:44:48.559609 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:44:48.561139 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:44:48.561386 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.003 seconds
[0m09:44:48.561635 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.561867 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.562134 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.566210 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:44:48.566617 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.568721 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.002 seconds
[0m09:44:48.569004 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:44:48.569244 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.003 seconds
[0m09:44:48.571978 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:44:48.572201 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.006 seconds
[0m09:44:48.580152 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:44:48.581674 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m09:44:48.581931 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.583538 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:44:48.583745 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.584196 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.585169 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:44:48.585393 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careteams__dbt_tmp094448443936" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" ("id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource")
    (
        select "id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource"
        from "stg_careteams__dbt_tmp094448443936"
    )
  
[0m09:44:48.586232 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.002 seconds
[0m09:44:48.586528 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.586722 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m09:44:48.587749 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m09:44:48.587985 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.003 seconds
[0m09:44:48.595253 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:44:48.596326 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m09:44:48.597438 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m09:44:48.597694 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m09:44:48.598051 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m09:44:48.598311 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:44:48.598562 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careplans__dbt_tmp094448440965" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" ("id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at"
        from "stg_careplans__dbt_tmp094448440965"
    )
  
[0m09:44:48.599001 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:44:48.599227 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_locations__dbt_tmp094448461512" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" ("id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference")
    (
        select "id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference"
        from "stg_locations__dbt_tmp094448461512"
    )
  
[0m09:44:48.599500 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:44:48.599787 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_encounter__dbt_tmp094448463941" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" ("id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at"
        from "stg_encounter__dbt_tmp094448463941"
    )
  
[0m09:44:48.600089 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.600975 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:44:48.601226 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:44:48.601392 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:44:48.601535 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.601721 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m09:44:48.602382 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:44:48.603476 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m09:44:48.604191 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:44:48.604392 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m09:44:48.604587 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m09:44:48.604783 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m09:44:48.605714 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m09:44:48.605987 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m09:44:48.606309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.606794 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m09:44:48.607037 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.607274 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.607785 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m09:44:48.607990 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101a269c0>]}
[0m09:44:48.608170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042cf380>]}
[0m09:44:48.608512 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m09:44:48.608894 [info ] [Thread-2 (]: 2 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mINSERT 0 0[0m in 0.21s]
[0m09:44:48.609320 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ddbb0>]}
[0m09:44:48.609625 [info ] [Thread-1 (]: 1 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mINSERT 0 0[0m in 0.21s]
[0m09:44:48.610053 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m09:44:48.610342 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f353d0>]}
[0m09:44:48.610952 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m09:44:48.610713 [info ] [Thread-4 (]: 4 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mINSERT 0 0[0m in 0.20s]
[0m09:44:48.611236 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m09:44:48.611574 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_organizations
[0m09:44:48.612040 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m09:44:48.611808 [info ] [Thread-3 (]: 3 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mINSERT 0 0[0m in 0.21s]
[0m09:44:48.612331 [info ] [Thread-2 (]: 5 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m09:44:48.612785 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_patient
[0m09:44:48.612546 [info ] [Thread-1 (]: 6 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m09:44:48.613082 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m09:44:48.613291 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_organization_affiliations)
[0m09:44:48.613520 [info ] [Thread-4 (]: 7 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m09:44:48.613748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_organizations)
[0m09:44:48.613966 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_practitioner
[0m09:44:48.614156 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m09:44:48.614360 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_patient)
[0m09:44:48.614524 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_organizations
[0m09:44:48.617152 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.614728 [info ] [Thread-3 (]: 8 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m09:44:48.617501 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_patient
[0m09:44:48.620308 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m09:44:48.620745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_practitioner)
[0m09:44:48.623192 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m09:44:48.623553 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m09:44:48.623791 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m09:44:48.626419 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m09:44:48.626685 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_organizations
[0m09:44:48.628428 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.628711 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_patient
[0m09:44:48.631865 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:44:48.632133 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

    
  
    

  create temporary table "stg_organization_affiliations__dbt_tmp094448627815"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations")

  );
  
  
[0m09:44:48.634098 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:44:48.634351 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

    
  
    

  create temporary table "stg_organizations__dbt_tmp094448631178"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  -- this filter will only be applied on an incremental run
   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations")

  );
  
  
[0m09:44:48.634575 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_practitioner
[0m09:44:48.634763 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:48.634994 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

    
  
    

  create temporary table "stg_patient__dbt_tmp094448633407"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient")

  );
  
  
[0m09:44:48.635200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:48.636804 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:44:48.637056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:48.637341 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

    
  
    

  create temporary table "stg_practitioner__dbt_tmp094448636168"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner")

  );
  
  
[0m09:44:48.637569 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:48.675438 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.038 seconds
[0m09:44:48.677260 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:44:48.677468 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: BEGIN
[0m09:44:48.677736 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.040 seconds
[0m09:44:48.678031 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:48.678237 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m09:44:48.679629 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:44:48.679821 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.045 seconds
[0m09:44:48.680005 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:44:48.681246 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:44:48.681419 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m09:44:48.682659 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.682846 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient__dbt_tmp094448633407'
        
      order by ordinal_position

  
[0m09:44:48.683016 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m09:44:48.683294 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m09:44:48.683674 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:48.683962 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:44:48.684292 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner__dbt_tmp094448636168'
        
      order by ordinal_position

  
[0m09:44:48.684553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.684832 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:44:48.685044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.685293 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations__dbt_tmp094448631178'
        
      order by ordinal_position

  
[0m09:44:48.685518 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.685773 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations__dbt_tmp094448627815'
        
      order by ordinal_position

  
[0m09:44:48.687755 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.004 seconds
[0m09:44:48.689683 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:44:48.689923 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.690194 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.005 seconds
[0m09:44:48.692861 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:44:48.693146 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.003 seconds
[0m09:44:48.693325 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m09:44:48.693483 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.007 seconds
[0m09:44:48.693720 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.695411 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:44:48.696775 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:44:48.698120 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.698465 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.698777 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.699094 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.700638 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:44:48.702282 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:44:48.702490 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.702755 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m09:44:48.703023 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.004 seconds
[0m09:44:48.703213 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:44:48.704919 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:44:48.705160 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:44:48.706206 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m09:44:48.707758 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.707984 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.708914 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m09:44:48.709215 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.710646 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:44:48.710908 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:44:48.711128 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner__dbt_tmp094448636168" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" ("id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at"
        from "stg_practitioner__dbt_tmp094448636168"
    )
  
[0m09:44:48.711358 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:44:48.711543 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_patient__dbt_tmp094448633407" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" ("id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at")
    (
        select "id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at"
        from "stg_patient__dbt_tmp094448633407"
    )
  
[0m09:44:48.711713 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:44:48.712922 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m09:44:48.713231 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.714296 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.714574 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.715403 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:44:48.716271 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:44:48.716614 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m09:44:48.716791 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.716962 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m09:44:48.717114 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:44:48.717262 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m09:44:48.717443 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organization_affiliations__dbt_tmp094448627815" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" ("id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at"
        from "stg_organization_affiliations__dbt_tmp094448627815"
    )
  
[0m09:44:48.717606 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: COMMIT
[0m09:44:48.717768 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organizations__dbt_tmp094448631178" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" ("id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at")
    (
        select "id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at"
        from "stg_organizations__dbt_tmp094448631178"
    )
  
[0m09:44:48.719050 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.719673 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:44:48.719840 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m09:44:48.720065 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:48.720291 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:44:48.720504 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:48.720682 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m09:44:48.721104 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: Close
[0m09:44:48.721861 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:44:48.722291 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: Close
[0m09:44:48.722641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106364350>]}
[0m09:44:48.722859 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m09:44:48.723145 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556dd60>]}
[0m09:44:48.723419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.723911 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m09:44:48.723713 [info ] [Thread-3 (]: 8 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mINSERT 0 0[0m in 0.10s]
[0m09:44:48.724703 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: Close
[0m09:44:48.724343 [info ] [Thread-4 (]: 7 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mINSERT 0 0[0m in 0.11s]
[0m09:44:48.725133 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_practitioner
[0m09:44:48.725461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101b90350>]}
[0m09:44:48.725660 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.725924 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_patient
[0m09:44:48.726197 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m09:44:48.727030 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m09:44:48.726627 [info ] [Thread-1 (]: 6 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mINSERT 0 0[0m in 0.11s]
[0m09:44:48.727335 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m09:44:48.727698 [info ] [Thread-3 (]: 9 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m09:44:48.728056 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_organizations
[0m09:44:48.728372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106627fe0>]}
[0m09:44:48.728701 [info ] [Thread-4 (]: 10 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m09:44:48.729030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.stg_practitioner_roles)
[0m09:44:48.729296 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_task
[0m09:44:48.729643 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.stg_questionnaire_response)
[0m09:44:48.729968 [info ] [Thread-2 (]: 5 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mINSERT 0 0[0m in 0.12s]
[0m09:44:48.730215 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m09:44:48.730506 [info ] [Thread-1 (]: 11 of 59 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m09:44:48.730833 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m09:44:48.731095 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m09:44:48.733577 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.733844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_task)
[0m09:44:48.735511 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.735739 [debug] [Thread-2 (]: Began running node model.engage_analytics.unnested_careteams
[0m09:44:48.736152 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_task
[0m09:44:48.736870 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m09:44:48.736638 [info ] [Thread-2 (]: 12 of 59 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m09:44:48.740877 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m09:44:48.741253 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m09:44:48.743228 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.743566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.unnested_careteams)
[0m09:44:48.745706 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.745987 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

    
  
    

  create temporary table "stg_practitioner_roles__dbt_tmp094448742432"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles")

  );
  
  
[0m09:44:48.746212 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m09:44:48.746521 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

    
  
    

  create temporary table "stg_questionnaire_response__dbt_tmp094448744937"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response")

  );
  
  
[0m09:44:48.746822 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_task
[0m09:44:48.747011 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:48.748631 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m09:44:48.748873 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:48.751228 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:44:48.751887 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

    
  
    

  create temporary table "stg_task__dbt_tmp094448750341"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task")

  );
  
  
[0m09:44:48.752115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:48.752414 [debug] [Thread-2 (]: Began executing node model.engage_analytics.unnested_careteams
[0m09:44:48.761918 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m09:44:48.762805 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:44:48.763016 [debug] [Thread-2 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m09:44:48.763183 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:48.774302 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.027 seconds
[0m09:44:48.776316 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.776574 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m09:44:48.777165 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:48.777382 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.777582 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles__dbt_tmp094448742432'
        
      order by ordinal_position

  
[0m09:44:48.777913 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m09:44:48.778186 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.029 seconds
[0m09:44:48.778404 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:44:48.780814 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.781104 [debug] [Thread-2 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m09:44:48.781370 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m09:44:48.781630 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.004 seconds
[0m09:44:48.783348 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.783594 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:44:48.783811 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.784003 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:48.784222 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.787632 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:44:48.787921 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.003 seconds
[0m09:44:48.788178 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response__dbt_tmp094448744937'
        
      order by ordinal_position

  
[0m09:44:48.788508 [debug] [Thread-2 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams" rename to "unnested_careteams__dbt_backup"
[0m09:44:48.790330 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.790656 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.791358 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:48.793038 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:44:48.793310 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.002 seconds
[0m09:44:48.793539 [debug] [Thread-2 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m09:44:48.794590 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.795387 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:48.797130 [debug] [Thread-2 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:44:48.797351 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.007 seconds
[0m09:44:48.797543 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:44:48.797723 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.799282 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.799484 [debug] [Thread-2 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m09:44:48.799769 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner_roles__dbt_tmp094448742432" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" ("id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at"
        from "stg_practitioner_roles__dbt_tmp094448742432"
    )
  
[0m09:44:48.800061 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.801074 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.801326 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.804685 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m09:44:48.804975 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.005 seconds
[0m09:44:48.805716 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:44:48.807972 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m09:44:48.809950 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.810148 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m09:44:48.810327 [debug] [Thread-2 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m09:44:48.810506 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.810671 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m09:44:48.812092 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.812313 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:48.812850 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m09:44:48.813634 [debug] [Thread-2 (]: On model.engage_analytics.unnested_careteams: Close
[0m09:44:48.813924 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m09:44:48.814261 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066600e0>]}
[0m09:44:48.815447 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.815828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106618530>]}
[0m09:44:48.816387 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.064 seconds
[0m09:44:48.816194 [info ] [Thread-3 (]: 9 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mINSERT 0 0[0m in 0.09s]
[0m09:44:48.818404 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:44:48.816813 [info ] [Thread-2 (]: 12 of 59 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.07s]
[0m09:44:48.818770 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m09:44:48.819240 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: BEGIN
[0m09:44:48.819533 [debug] [Thread-2 (]: Finished running node model.engage_analytics.unnested_careteams
[0m09:44:48.819743 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.819966 [debug] [Thread-3 (]: Began running node model.engage_analytics.encounters
[0m09:44:48.820326 [debug] [Thread-2 (]: Began running node model.engage_analytics.patient
[0m09:44:48.820555 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_questionnaire_response__dbt_tmp094448744937" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" ("id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at")
    (
        select "id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at"
        from "stg_questionnaire_response__dbt_tmp094448744937"
    )
  
[0m09:44:48.820781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.821020 [info ] [Thread-3 (]: 13 of 59 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m09:44:48.821237 [info ] [Thread-2 (]: 14 of 59 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m09:44:48.821636 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:44:48.821877 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.encounters)
[0m09:44:48.822111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.patient)
[0m09:44:48.822351 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_task__dbt_tmp094448750341'
        
      order by ordinal_position

  
[0m09:44:48.822573 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.822792 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.encounters
[0m09:44:48.823058 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.patient
[0m09:44:48.823856 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:44:48.830453 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.007 seconds
[0m09:44:48.834610 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.836858 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m09:44:48.837068 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m09:44:48.838980 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:44:48.839207 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m09:44:48.839577 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m09:44:48.839950 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.840180 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:48.840609 [debug] [Thread-2 (]: Began executing node model.engage_analytics.patient
[0m09:44:48.843042 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:44:48.843330 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:44:48.843720 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp094448842175"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    DATE_PART('year', AGE(stp.birthDate::date))::integer as age_years,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m09:44:48.844054 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.004 seconds
[0m09:44:48.844501 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m09:44:48.844822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:48.846947 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:44:48.847437 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a0140>]}
[0m09:44:48.847678 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m09:44:48.848204 [info ] [Thread-4 (]: 10 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mINSERT 0 0[0m in 0.12s]
[0m09:44:48.848692 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m09:44:48.848947 [debug] [Thread-4 (]: Began running node model.engage_analytics.organizations
[0m09:44:48.849214 [info ] [Thread-4 (]: 15 of 59 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m09:44:48.849605 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.organizations)
[0m09:44:48.849835 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.organizations
[0m09:44:48.852082 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:44:48.852363 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.004 seconds
[0m09:44:48.852637 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m09:44:48.853913 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m09:44:48.854187 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:48.854849 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:44:48.855103 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_task__dbt_tmp094448750341" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" ("id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at")
    (
        select "id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at"
        from "stg_task__dbt_tmp094448750341"
    )
  
[0m09:44:48.856978 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:44:48.858047 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:44:48.858328 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.018 seconds
[0m09:44:48.858565 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m09:44:48.859474 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.859726 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: COMMIT
[0m09:44:48.859968 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m09:44:48.861113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.861556 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: Close
[0m09:44:48.861997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106674f80>]}
[0m09:44:48.862457 [info ] [Thread-1 (]: 11 of 59 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mINSERT 0 0[0m in 0.13s]
[0m09:44:48.862841 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_task
[0m09:44:48.863054 [debug] [Thread-1 (]: Began running node model.engage_analytics.organization_affiliations
[0m09:44:48.863439 [info ] [Thread-1 (]: 16 of 59 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m09:44:48.863731 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.003 seconds
[0m09:44:48.863977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.organization_affiliations)
[0m09:44:48.864876 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.865210 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m09:44:48.865517 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m09:44:48.865759 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:44:48.868133 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m09:44:48.869891 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:44:48.870304 [debug] [Thread-2 (]: On model.engage_analytics.patient: BEGIN
[0m09:44:48.870567 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.002 seconds
[0m09:44:48.871371 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.871625 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m09:44:48.871849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.872053 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m09:44:48.872246 [debug] [Thread-1 (]: Began executing node model.engage_analytics.organization_affiliations
[0m09:44:48.872579 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:44:48.873634 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m09:44:48.876736 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:44:48.877024 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:44:48.877237 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp094448842175'
        
      order by ordinal_position

  
[0m09:44:48.877593 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

    
  
    

  create temporary table "organization_affiliations__dbt_tmp094448876006"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

where s._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
)

  );
  
  
[0m09:44:48.879036 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m09:44:48.879345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:48.879675 [debug] [Thread-4 (]: Began executing node model.engage_analytics.organizations
[0m09:44:48.882172 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:44:48.882539 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    
  
    

  create temporary table "organizations__dbt_tmp094448881054"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

where o._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
)

  );
  
  
[0m09:44:48.882923 [debug] [Thread-3 (]: Began executing node model.engage_analytics.encounters
[0m09:44:48.885182 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.885668 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    
  
    

  create temporary table "encounters__dbt_tmp094448884293"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."encounters")

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

where e._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
)

  );
  
  
[0m09:44:48.886266 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.003 seconds
[0m09:44:48.886523 [debug] [Thread-2 (]: SQL status: SELECT 15 in 0.007 seconds
[0m09:44:48.888267 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:44:48.890179 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:44:48.890425 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m09:44:48.890608 [debug] [Thread-4 (]: On model.engage_analytics.organizations: BEGIN
[0m09:44:48.890815 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.892264 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.892519 [debug] [Thread-3 (]: On model.engage_analytics.encounters: BEGIN
[0m09:44:48.892826 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:48.893058 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:48.893293 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:44:48.893506 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.893778 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organizations__dbt_tmp094448881054'
        
      order by ordinal_position

  
[0m09:44:48.894046 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'encounters__dbt_tmp094448884293'
        
      order by ordinal_position

  
[0m09:44:48.894501 [debug] [Thread-2 (]: SQL status: SELECT 15 in 0.002 seconds
[0m09:44:48.896347 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:44:48.896582 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.896812 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m09:44:48.898465 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:44:48.898734 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:44:48.898928 [debug] [Thread-2 (]: SQL status: SELECT 15 in 0.002 seconds
[0m09:44:48.899095 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m09:44:48.899245 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.005 seconds
[0m09:44:48.901356 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:44:48.902326 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m09:44:48.903861 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.904085 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.904266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m09:44:48.904494 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.904743 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:44:48.905060 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations__dbt_tmp094448876006'
        
      order by ordinal_position

  
[0m09:44:48.905323 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:44:48.905516 [debug] [Thread-2 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp094448842175" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "age_years", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "age_years", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp094448842175"
    )
  
[0m09:44:48.906230 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.002 seconds
[0m09:44:48.907797 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:44:48.908008 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.908195 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:44:48.908367 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.003 seconds
[0m09:44:48.908981 [debug] [Thread-2 (]: On model.engage_analytics.patient: COMMIT
[0m09:44:48.909163 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m09:44:48.910893 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.911127 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:44:48.911312 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.patient"
[0m09:44:48.912684 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:44:48.912873 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.913841 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m09:44:48.914046 [debug] [Thread-2 (]: On model.engage_analytics.patient: COMMIT
[0m09:44:48.914243 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.914725 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:44:48.914975 [debug] [Thread-4 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organizations__dbt_tmp094448881054" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organizations" ("id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at")
    (
        select "id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at"
        from "organizations__dbt_tmp094448881054"
    )
  
[0m09:44:48.915506 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.915915 [debug] [Thread-2 (]: On model.engage_analytics.patient: Close
[0m09:44:48.916097 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.916767 [debug] [Thread-4 (]: On model.engage_analytics.organizations: COMMIT
[0m09:44:48.917014 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m09:44:48.917339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724e00>]}
[0m09:44:48.917595 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organizations"
[0m09:44:48.917803 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.003 seconds
[0m09:44:48.919485 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:44:48.920043 [debug] [Thread-4 (]: On model.engage_analytics.organizations: COMMIT
[0m09:44:48.919877 [info ] [Thread-2 (]: 14 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.10s]
[0m09:44:48.921238 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m09:44:48.921485 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.921820 [debug] [Thread-2 (]: Finished running node model.engage_analytics.patient
[0m09:44:48.922147 [debug] [Thread-2 (]: Began running node model.engage_analytics.practitioner_role
[0m09:44:48.922405 [info ] [Thread-2 (]: 17 of 59 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m09:44:48.922757 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.922994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.practitioner_role)
[0m09:44:48.923415 [debug] [Thread-4 (]: On model.engage_analytics.organizations: Close
[0m09:44:48.923613 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.923793 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m09:44:48.923958 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.practitioner_role
[0m09:44:48.924175 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."encounters" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "encounters__dbt_tmp094448884293" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."encounters" ("id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at")
    (
        select "id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at"
        from "encounters__dbt_tmp094448884293"
    )
  
[0m09:44:48.924455 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674d4c0>]}
[0m09:44:48.925342 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m09:44:48.927642 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m09:44:48.928238 [info ] [Thread-4 (]: 15 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mINSERT 0 0[0m in 0.07s]
[0m09:44:48.928757 [debug] [Thread-4 (]: Finished running node model.engage_analytics.organizations
[0m09:44:48.928987 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.929216 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m09:44:48.929437 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:44:48.930170 [debug] [Thread-3 (]: On model.engage_analytics.encounters: COMMIT
[0m09:44:48.930634 [debug] [Thread-2 (]: Began executing node model.engage_analytics.practitioner_role
[0m09:44:48.930481 [info ] [Thread-4 (]: 18 of 59 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m09:44:48.930876 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organization_affiliations__dbt_tmp094448876006" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" ("id", "organization_id", "location_id", "_airbyte_emitted_at")
    (
        select "id", "organization_id", "location_id", "_airbyte_emitted_at"
        from "organization_affiliations__dbt_tmp094448876006"
    )
  
[0m09:44:48.931081 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m09:44:48.933130 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:44:48.933388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.int_qr_answers_long)
[0m09:44:48.933669 [debug] [Thread-3 (]: On model.engage_analytics.encounters: COMMIT
[0m09:44:48.933916 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

    
  
    

  create temporary table "practitioner_role__dbt_tmp094448932345"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

where spr._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01')
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
)

  );
  
  
[0m09:44:48.934153 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m09:44:48.934499 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:48.934758 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.937518 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m09:44:48.937800 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:44:48.938683 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:44:48.939159 [debug] [Thread-3 (]: On model.engage_analytics.encounters: Close
[0m09:44:48.939382 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m09:44:48.939748 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m09:44:48.940188 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679aed0>]}
[0m09:44:48.940885 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m09:44:48.940646 [info ] [Thread-3 (]: 13 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mINSERT 0 0[0m in 0.12s]
[0m09:44:48.941190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.942995 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m09:44:48.943375 [debug] [Thread-3 (]: Finished running node model.engage_analytics.encounters
[0m09:44:48.943873 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: Close
[0m09:44:48.944181 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_header
[0m09:44:48.944560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067731a0>]}
[0m09:44:48.944870 [info ] [Thread-3 (]: 19 of 59 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m09:44:48.945703 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.int_qr_header)
[0m09:44:48.945476 [info ] [Thread-1 (]: 16 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mINSERT 0 0[0m in 0.08s]
[0m09:44:48.946041 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:44:48.946256 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_header
[0m09:44:48.946626 [debug] [Thread-1 (]: Finished running node model.engage_analytics.organization_affiliations
[0m09:44:48.946902 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m09:44:48.948638 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m09:44:48.949016 [debug] [Thread-1 (]: Began running node model.engage_analytics.int_qr_tags
[0m09:44:48.949300 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:48.949628 [info ] [Thread-1 (]: 20 of 59 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m09:44:48.950026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.int_qr_tags)
[0m09:44:48.950269 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m09:44:48.950577 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_header
[0m09:44:48.952612 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m09:44:48.954545 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m09:44:48.955079 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:44:48.956855 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:44:48.957082 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m09:44:48.957501 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:44:48.957800 [debug] [Thread-1 (]: Began executing node model.engage_analytics.int_qr_tags
[0m09:44:48.958025 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m09:44:48.958234 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:48.960209 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:44:48.960535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:48.960755 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:44:48.961061 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

    
  
    

  create temporary table "int_qr_tags__dbt_tmp094448959488"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags")

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m09:44:48.961455 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role__dbt_tmp094448932345'
        
      order by ordinal_position

  
[0m09:44:48.961701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:48.964810 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m09:44:48.965112 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:44:48.965372 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m09:44:48.966319 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.004 seconds
[0m09:44:48.968248 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:44:48.968509 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:48.968757 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.970450 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:44:48.970791 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" rename to "int_qr_answers_long__dbt_backup"
[0m09:44:48.976295 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:44:48.979651 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:44:48.979931 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.009 seconds
[0m09:44:48.980307 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m09:44:48.982228 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:44:48.982662 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:48.985047 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:44:48.985990 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:44:48.986217 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:44:48.986379 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m09:44:48.986641 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.004 seconds
[0m09:44:48.987879 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m09:44:48.988182 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:48.990238 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m09:44:48.990647 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m09:44:48.990839 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m09:44:48.991071 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m09:44:48.991244 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:44:48.991480 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:44:48.991743 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m09:44:48.992018 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioner_role__dbt_tmp094448932345" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" ("id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at")
    (
        select "id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at"
        from "practitioner_role__dbt_tmp094448932345"
    )
  
[0m09:44:48.993014 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:48.993723 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:44:48.993967 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m09:44:48.994125 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m09:44:48.994485 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:48.994750 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m09:44:48.996524 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:44:48.996839 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:48.998579 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:44:48.998883 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" rename to "int_qr_header__dbt_backup"
[0m09:44:48.999309 [debug] [Thread-2 (]: On model.engage_analytics.practitioner_role: Close
[0m09:44:48.999526 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m09:44:48.999943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106779610>]}
[0m09:44:49.000328 [info ] [Thread-2 (]: 17 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mINSERT 0 0[0m in 0.08s]
[0m09:44:49.000605 [debug] [Thread-2 (]: Finished running node model.engage_analytics.practitioner_role
[0m09:44:49.000953 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:49.001148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:49.002686 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:44:49.002884 [debug] [Thread-2 (]: Began running node model.engage_analytics.current_practitioner_role
[0m09:44:49.003079 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:44:49.003278 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m09:44:49.003937 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags__dbt_tmp094448959488'
        
      order by ordinal_position

  
[0m09:44:49.003671 [info ] [Thread-2 (]: 21 of 59 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m09:44:49.004416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.current_practitioner_role)
[0m09:44:49.004641 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m09:44:49.004887 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:49.006552 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m09:44:49.007644 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:44:49.007949 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:44:49.008125 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m09:44:49.008919 [debug] [Thread-2 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m09:44:49.010933 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m09:44:49.011221 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:44:49.011516 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.007 seconds
[0m09:44:49.012956 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m09:44:49.015602 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:44:49.016136 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m09:44:49.016381 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.025 seconds
[0m09:44:49.016638 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:44:49.016866 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:44:49.017046 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m09:44:49.017838 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m09:44:49.018088 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m09:44:49.018336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:49.018762 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a80a510>]}
[0m09:44:49.019121 [info ] [Thread-4 (]: 18 of 59 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.09s]
[0m09:44:49.019588 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m09:44:49.020861 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:44:49.021682 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: Close
[0m09:44:49.021956 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m09:44:49.022324 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a80b0e0>]}
[0m09:44:49.024226 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:44:49.024629 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m09:44:49.024949 [info ] [Thread-3 (]: 19 of 59 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.08s]
[0m09:44:49.025389 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_header
[0m09:44:49.028161 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m09:44:49.029553 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m09:44:49.030049 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:44:49.030247 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" as DBT_INTERNAL_DEST
        where (resource_id) in (
            select distinct resource_id
            from "int_qr_tags__dbt_tmp094448959488" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" ("resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version")
    (
        select "resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version"
        from "int_qr_tags__dbt_tmp094448959488"
    )
  
[0m09:44:49.031253 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:49.031969 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:44:49.032168 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m09:44:49.032326 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m09:44:49.033148 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:49.033645 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: Close
[0m09:44:49.033853 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m09:44:49.034125 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:44:49.034327 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m09:44:49.034602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c8230>]}
[0m09:44:49.034993 [info ] [Thread-1 (]: 20 of 59 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mINSERT 0 0[0m in 0.08s]
[0m09:44:49.035268 [debug] [Thread-1 (]: Finished running node model.engage_analytics.int_qr_tags
[0m09:44:49.035728 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m09:44:49.035980 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:44:49.036285 [info ] [Thread-4 (]: 22 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m09:44:49.036897 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:49.036699 [info ] [Thread-3 (]: 23 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [RUN]
[0m09:44:49.037245 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_confidential_s1
[0m09:44:49.037520 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.qr_1_month_follow_up)
[0m09:44:49.039388 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:44:49.039643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.qr_common_mental_health_symptoms)
[0m09:44:49.039967 [info ] [Thread-1 (]: 24 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [RUN]
[0m09:44:49.040212 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m09:44:49.040484 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" rename to "current_practitioner_role__dbt_backup"
[0m09:44:49.040728 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:44:49.040945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.qr_confidential_s1)
[0m09:44:49.047807 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:44:49.050307 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:44:49.050653 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:44:49.050928 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_confidential_s1
[0m09:44:49.051148 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:49.051356 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:49.053118 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:44:49.055431 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:44:49.055663 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:49.055873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:49.056044 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m09:44:49.056223 [debug] [Thread-1 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:49.056653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:49.057569 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:49.058459 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:44:49.058757 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:44:49.059009 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m09:44:49.060100 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:49.061558 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m09:44:49.061878 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m09:44:49.062058 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m09:44:49.063424 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:49.064288 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: Close
[0m09:44:49.064623 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106334f20>]}
[0m09:44:49.064965 [info ] [Thread-2 (]: 21 of 59 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.06s]
[0m09:44:49.065332 [debug] [Thread-2 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m09:44:49.065590 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_financial_wellness_tool
[0m09:44:49.065840 [info ] [Thread-2 (]: 25 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [RUN]
[0m09:44:49.066224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.qr_financial_wellness_tool)
[0m09:44:49.066411 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_financial_wellness_tool
[0m09:44:49.068865 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:44:49.069099 [debug] [Thread-2 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:49.069282 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:49.852439 [debug] [Thread-2 (]: SQL status: SELECT 23 in 0.783 seconds
[0m09:44:49.853626 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:44:49.855142 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_financial_wellness_tool
[0m09:44:49.855460 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.799 seconds
[0m09:44:49.893050 [debug] [Thread-3 (]: SQL status: SELECT 36 in 0.837 seconds
[0m09:44:49.893351 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.838 seconds
[0m09:44:49.893828 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_financial_wellness_tool"
[0m09:44:49.895064 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_confidential_s1"
[0m09:44:49.896351 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:44:49.897254 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:44:49.898039 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:44:49.898414 [debug] [Thread-2 (]: On model.engage_analytics.qr_financial_wellness_tool: BEGIN
[0m09:44:49.898746 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:44:49.899057 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_confidential_s1
[0m09:44:49.900781 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:44:49.901005 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m09:44:49.901188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m09:44:49.902664 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_confidential_s1"
[0m09:44:49.904618 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m09:44:49.904937 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:44:49.905302 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:44:49.905713 [debug] [Thread-2 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Financial Wellness Tool with readable column names
-- Questionnaire ID: q-financial-wellness-tool
-- Source file: questionnaire/assessments/financial-wellness-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '21234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_there_a_time_when_you_or",max(case when linkid = '31234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo",max(case when linkid = '3456789a-bcde-f012-3456-789abcdef012' then answer_value_text end) as "financial_how_hard_is_it_for_you_to_pay_for_the_very_basics_",max(case when linkid = '51234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_how_strongly_do_you_agree_or_disagree_with_the_fol",max(case when linkid = '61234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_move_in_with_other_p",max(case when linkid = '6789abcd-ef01-2345-6789-abcdef012345' then answer_value_text end) as "financial_in_the_past_12_months_how_often_did_you_run_out_of",max(case when linkid = '91234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_stay_at_a_shelter_in",max(case when linkid = 'c1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_did_you_not_pay_the_full_amo_8",max(case when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab' then answer_value_text end) as "financial_i_worried_whether_my_food_would_run_out_before_i_g",max(case when linkid = 'f0123456-789a-bcde-f012-3456789abcde' then answer_value_text end) as "financial_the_food_that_i_bought_just_didnt_last_and_i_didnt",max(case when linkid = 'f1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as "financial_in_the_past_12_months_was_your_phone_gas_heating_w",max(case when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d' then answer_value_text end) as "financial_when_you_think_about_your_financial_situation_how_",max(case when linkid = 'high-debt' then answer_value_text end) as "high-debt",max(case when linkid = 'high-food-insecurity' then answer_value_text end) as "high-food-insecurity",max(case when linkid = 'high-housing-insecurity' then answer_value_text end) as "high-housing-insecurity",max(case when linkid = 'high-paying-bills' then answer_value_text end) as "high-paying-bills",max(case when linkid = 'moderate-debt' then answer_value_text end) as "moderate-debt",max(case when linkid = 'moderate-food-insecurity' then answer_value_text end) as "moderate-food-insecurity",max(case when linkid = 'moderate-housing-insecurity' then answer_value_text end) as "moderate-housing-insecurity",max(case when linkid = 'moderate-medical-hardships' then answer_value_text end) as "moderate-medical-hardships",max(case when linkid = 'moderate-paying-bills' then answer_value_text end) as "moderate-paying-bills",max(case when linkid = 'no-financial-hardship' then answer_value_text end) as "no-financial-hardship",max(case when linkid = 'overall-financial-hardship' then answer_value_text end) as "overall-financial-hardship"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:49.906145 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: BEGIN
[0m09:44:49.906385 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:44:49.906696 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:44:49.906949 [debug] [Thread-1 (]: On model.engage_analytics.qr_confidential_s1: BEGIN
[0m09:44:49.907263 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m09:44:49.907509 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:49.907763 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:44:49.908153 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Common Mental Health Symptoms with readable column names
-- Questionnaire ID: q-common-mental-health-symptoms
-- Source file: questionnaire/assessments/common-mental-health-symptoms.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "total_score",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrfeeling",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "total_score_meaning",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brrepeat",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "total_score_5",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrloss_of",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brhaving",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "total_score_meaning_9",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "how_difficult_have_these_problems_made_it_for_you_to_do_your",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "total_score_11",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_brfeelin",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "total_score_meaning_13",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_by_bravoidi_14",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "in_the_past_month_how_much_were_you_bothered_bybrhaving",max(case when linkid = 'f1.10.1' then answer_value_text end) as "f1.10.1",max(case when linkid = 'f1.11.1' then answer_value_text end) as "f1.11.1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "f1.15.1",max(case when linkid = 'f1.16.1' then answer_value_text end) as "f1.16.1",max(case when linkid = 'f1.17.1' then answer_value_text end) as "f1.17.1",max(case when linkid = 'f1.18.1' then answer_value_text end) as "f1.18.1",max(case when linkid = 'f1.19.1' then answer_value_text end) as "f1.19.1",max(case when linkid = 'f1.20.1' then answer_value_text end) as "f1.20.1",max(case when linkid = 'f1.21.1' then answer_value_text end) as "f1.21.1",max(case when linkid = 'f1.3.1' then answer_value_text end) as "f1.3.1",max(case when linkid = 'f1.4.1' then answer_value_text end) as "f1.4.1",max(case when linkid = 'f1.5.1' then answer_value_text end) as "f1.5.1",max(case when linkid = 'f1.6.1' then answer_value_text end) as "f1.6.1",max(case when linkid = 'f1.7.1' then answer_value_text end) as "f1.7.1",max(case when linkid = 'f1.8.1' then answer_value_text end) as "f1.8.1",max(case when linkid = 'f1.9.1' then answer_value_text end) as "f1.9.1",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'show-pcl-5-to-8-questions' then answer_value_text end) as "show-pcl-5-to-8-questions",max(case when linkid = 'task-id-common-mental-pdf' then answer_value_text end) as "task-id-common-mental-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:49.908532 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:49.908743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:49.908997 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:44:49.909228 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:44:49.909523 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- 1 month follow up with readable column names
-- Questionnaire ID: 1-month-follow-up
-- Source file: questionnaire/1-month-follow-up.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'completed-all-recommended-interventions' then answer_value_text end) as "completed-all-recommended-interventions",max(case when linkid = 'schedule-this-meeting' then answer_value_text end) as "schedule-this-meeting"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:49.909889 [debug] [Thread-1 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Discuss Confidentiality with readable column names
-- Questionnaire ID: 23451
-- Source file: questionnaire/ipc-session-1/confidential-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:49.910583 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:49.912383 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:44:49.912651 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:49.912887 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:49.913113 [debug] [Thread-2 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_tmp" rename to "qr_financial_wellness_tool"
[0m09:44:49.913296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:49.915002 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:44:49.916498 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:44:49.918284 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:44:49.918509 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:49.918700 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m09:44:49.918925 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_tmp" rename to "qr_common_mental_health_symptoms"
[0m09:44:49.919154 [debug] [Thread-1 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_tmp" rename to "qr_confidential_s1"
[0m09:44:49.919822 [debug] [Thread-2 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:44:49.920081 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:44:49.920253 [debug] [Thread-2 (]: On model.engage_analytics.qr_financial_wellness_tool: COMMIT
[0m09:44:49.920725 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:49.921399 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:44:49.921595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:49.921779 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:44:49.921959 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:49.922123 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:49.922740 [debug] [Thread-1 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:44:49.922929 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m09:44:49.923493 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:44:49.924659 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup"
[0m09:44:49.924851 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:44:49.925104 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:44:49.925458 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_financial_wellness_tool"
[0m09:44:49.925725 [debug] [Thread-1 (]: On model.engage_analytics.qr_confidential_s1: COMMIT
[0m09:44:49.925930 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:49.926106 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: COMMIT
[0m09:44:49.926316 [debug] [Thread-2 (]: On model.engage_analytics.qr_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_financial_wellness_tool__dbt_backup" cascade
[0m09:44:49.928507 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m09:44:49.928802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:49.929202 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m09:44:49.930386 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup"
[0m09:44:49.930616 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:49.930819 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m09:44:49.931001 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:44:49.931296 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_confidential_s1"
[0m09:44:49.932482 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup"
[0m09:44:49.933283 [debug] [Thread-2 (]: On model.engage_analytics.qr_financial_wellness_tool: Close
[0m09:44:49.933484 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:49.933661 [debug] [Thread-1 (]: On model.engage_analytics.qr_confidential_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_confidential_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_confidential_s1__dbt_backup" cascade
[0m09:44:49.933971 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_common_mental_health_symptoms"
[0m09:44:49.934617 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m09:44:49.934883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665c6e0>]}
[0m09:44:49.935110 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_common_mental_health_symptoms__dbt_backup" cascade
[0m09:44:49.935376 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665d280>]}
[0m09:44:49.935613 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:49.935871 [info ] [Thread-2 (]: 25 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_financial_wellness_tool  [[32mCREATE VIEW[0m in 0.87s]
[0m09:44:49.936468 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:49.937057 [debug] [Thread-1 (]: On model.engage_analytics.qr_confidential_s1: Close
[0m09:44:49.937331 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_financial_wellness_tool
[0m09:44:49.937990 [debug] [Thread-3 (]: On model.engage_analytics.qr_common_mental_health_symptoms: Close
[0m09:44:49.938379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d9e20>]}
[0m09:44:49.938647 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_gad_7_s1
[0m09:44:49.939132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665d760>]}
[0m09:44:49.939677 [info ] [Thread-2 (]: 26 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [RUN]
[0m09:44:49.939997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_financial_wellness_tool, now model.engage_analytics.qr_gad_7_s1)
[0m09:44:49.940178 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_gad_7_s1
[0m09:44:49.943078 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:44:49.943687 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:49.944701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:50.213918 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m09:44:50.214349 [info ] [Thread-1 (]: 24 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_confidential_s1  [[32mCREATE VIEW[0m in 0.90s]
[0m09:44:50.214651 [info ] [Thread-3 (]: 23 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 0.90s]
[0m09:44:50.215180 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_confidential_s1
[0m09:44:50.215509 [info ] [Thread-4 (]: 22 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 0.90s]
[0m09:44:50.215828 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_common_mental_health_symptoms
[0m09:44:50.216043 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_gad_7_s2
[0m09:44:50.216483 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m09:44:50.216865 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_gad_7_s3
[0m09:44:50.217222 [info ] [Thread-1 (]: 27 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [RUN]
[0m09:44:50.217597 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_gad_7_s4
[0m09:44:50.217980 [info ] [Thread-3 (]: 28 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [RUN]
[0m09:44:50.218403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_confidential_s1, now model.engage_analytics.qr_gad_7_s2)
[0m09:44:50.218722 [info ] [Thread-4 (]: 29 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [RUN]
[0m09:44:50.219034 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_common_mental_health_symptoms, now model.engage_analytics.qr_gad_7_s3)
[0m09:44:50.219256 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_gad_7_s2
[0m09:44:50.219483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_gad_7_s4)
[0m09:44:50.219761 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_gad_7_s3
[0m09:44:50.222565 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:44:50.222860 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_gad_7_s4
[0m09:44:50.225182 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:44:50.225436 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:50.227623 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:44:50.227849 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:50.228045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:50.228397 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:50.228584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:50.228886 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:50.634898 [debug] [Thread-2 (]: SQL status: SELECT 18 in 0.690 seconds
[0m09:44:50.637977 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s1"
[0m09:44:50.639935 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_gad_7_s1
[0m09:44:50.641838 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s1"
[0m09:44:50.642301 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:44:50.642493 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: BEGIN
[0m09:44:50.643343 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:50.643577 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:44:50.643896 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 1) with readable column names
-- Questionnaire ID: 202
-- Source file: questionnaire/ipc-session-1/gad-7-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9' then answer_value_text end) as "ipc_s1_taskid_gad_pdf",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_gad7_session_1",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s1_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s1_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s1_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s1_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s1_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s1_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s1_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_gad7_session_1_score",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s1_score_meaning_13",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:50.646631 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:50.649178 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:44:50.649392 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_tmp" rename to "qr_gad_7_s1"
[0m09:44:50.650346 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:50.651060 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:44:50.651261 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:44:50.651426 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: COMMIT
[0m09:44:50.652673 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:50.653975 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup"
[0m09:44:50.654274 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s1"
[0m09:44:50.654454 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s1__dbt_backup" cascade
[0m09:44:50.655185 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:50.655874 [debug] [Thread-2 (]: On model.engage_analytics.qr_gad_7_s1: Close
[0m09:44:50.656169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640ac30>]}
[0m09:44:50.656490 [info ] [Thread-2 (]: 26 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s1  [[32mCREATE VIEW[0m in 0.72s]
[0m09:44:50.656792 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_gad_7_s1
[0m09:44:50.657202 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_mood_rating_s1
[0m09:44:50.657516 [info ] [Thread-2 (]: 30 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [RUN]
[0m09:44:50.657773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s1, now model.engage_analytics.qr_mood_rating_s1)
[0m09:44:50.657957 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_mood_rating_s1
[0m09:44:50.660499 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:44:50.660763 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:50.660996 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:50.821755 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.593 seconds
[0m09:44:50.823077 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.595 seconds
[0m09:44:50.825579 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s3"
[0m09:44:50.826715 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s2"
[0m09:44:50.827876 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.599 seconds
[0m09:44:50.828985 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_gad_7_s4"
[0m09:44:50.829364 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_gad_7_s2
[0m09:44:50.829596 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_gad_7_s3
[0m09:44:50.831377 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s2"
[0m09:44:50.832822 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s3"
[0m09:44:50.833427 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:44:50.833650 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:44:50.833891 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_gad_7_s4
[0m09:44:50.834125 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: BEGIN
[0m09:44:50.834359 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: BEGIN
[0m09:44:50.835967 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_gad_7_s4"
[0m09:44:50.836701 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:44:50.836941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:50.837128 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: BEGIN
[0m09:44:50.837327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:50.837566 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:44:50.837818 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:44:50.838091 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 3) with readable column names
-- Questionnaire ID: 59
-- Source file: questionnaire/ipc-session-3/gad-7-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s3_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s3_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s3_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s3_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s3_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s3_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s3_q7_afraid",max(case when linkid = '534c4998-b964-4101-b919-ff3c26af9714' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s3_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:50.838406 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:50.838654 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 2) with readable column names
-- Questionnaire ID: 205
-- Source file: questionnaire/ipc-session-2/gad-7-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_gad7_session_2",max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s2_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s2_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s2_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s2_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s2_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s2_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s2_q7_afraid",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_gad7_session_2_score",max(case when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s2_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:50.839057 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:44:50.839414 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- GAD-7 (IPC Session 4) with readable column names
-- Questionnaire ID: 62
-- Source file: questionnaire/ipc-session-4/gad-7-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as "ipc_s4_q1_anxious",max(case when linkid = 'f1.16.1' then answer_value_text end) as "ipc_s4_q2_control_worry",max(case when linkid = 'f1.17.1' then answer_value_text end) as "ipc_s4_q3_worry_too_much",max(case when linkid = 'f1.18.1' then answer_value_text end) as "ipc_s4_q4_trouble_relaxing",max(case when linkid = 'f1.19.1' then answer_value_text end) as "ipc_s4_q5_restless",max(case when linkid = 'f1.20.1' then answer_value_text end) as "ipc_s4_q6_irritable",max(case when linkid = 'f1.21.1' then answer_value_text end) as "ipc_s4_q7_afraid",max(case when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = 'e4155e07-1d18-448f-8111-182bf4149672' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as "ipc_s4_score_meaning_10"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:50.841467 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:50.841707 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:50.843479 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:44:50.843689 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:50.845293 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:44:50.845510 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_tmp" rename to "qr_gad_7_s3"
[0m09:44:50.846931 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:44:50.847129 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_tmp" rename to "qr_gad_7_s2"
[0m09:44:50.847391 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_tmp" rename to "qr_gad_7_s4"
[0m09:44:50.848223 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:50.848439 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:50.848635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:50.849334 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:44:50.849934 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:44:50.850468 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:44:50.850730 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:44:50.850891 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:44:50.851048 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:44:50.851196 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: COMMIT
[0m09:44:50.851342 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: COMMIT
[0m09:44:50.851484 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: COMMIT
[0m09:44:50.852498 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:50.852776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:50.854789 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup"
[0m09:44:50.854973 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:44:50.856061 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup"
[0m09:44:50.856334 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s3"
[0m09:44:50.857329 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup"
[0m09:44:50.857579 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s2"
[0m09:44:50.857777 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s3__dbt_backup" cascade
[0m09:44:50.858010 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_gad_7_s4"
[0m09:44:50.858196 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s2__dbt_backup" cascade
[0m09:44:50.858399 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_gad_7_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_gad_7_s4__dbt_backup" cascade
[0m09:44:50.858859 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:50.859119 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:50.859310 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:50.859978 [debug] [Thread-3 (]: On model.engage_analytics.qr_gad_7_s3: Close
[0m09:44:50.860637 [debug] [Thread-4 (]: On model.engage_analytics.qr_gad_7_s4: Close
[0m09:44:50.861221 [debug] [Thread-1 (]: On model.engage_analytics.qr_gad_7_s2: Close
[0m09:44:50.861622 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062742f0>]}
[0m09:44:50.861981 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556fad0>]}
[0m09:44:50.862202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063df3b0>]}
[0m09:44:50.862597 [info ] [Thread-3 (]: 28 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:50.863027 [info ] [Thread-4 (]: 29 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s4  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:50.863488 [info ] [Thread-1 (]: 27 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_gad_7_s2  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:50.863831 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_gad_7_s3
[0m09:44:50.864076 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_gad_7_s4
[0m09:44:50.864297 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_gad_7_s2
[0m09:44:50.864492 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_mood_rating_s2
[0m09:44:50.864673 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_mood_rating_s3
[0m09:44:50.864853 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_mood_rating_s4
[0m09:44:50.865109 [info ] [Thread-3 (]: 31 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [RUN]
[0m09:44:50.865330 [info ] [Thread-4 (]: 32 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [RUN]
[0m09:44:50.865969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s3, now model.engage_analytics.qr_mood_rating_s2)
[0m09:44:50.865604 [info ] [Thread-1 (]: 33 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [RUN]
[0m09:44:50.866295 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s4, now model.engage_analytics.qr_mood_rating_s3)
[0m09:44:50.866496 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_mood_rating_s2
[0m09:44:50.866681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_gad_7_s2, now model.engage_analytics.qr_mood_rating_s4)
[0m09:44:50.866859 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_mood_rating_s3
[0m09:44:50.869353 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:44:50.869585 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_mood_rating_s4
[0m09:44:50.872073 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:44:50.872468 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:50.875138 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:44:50.875389 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:50.875684 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:50.875904 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:50.876086 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:50.876350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:51.272619 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.611 seconds
[0m09:44:51.275352 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:44:51.276601 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_mood_rating_s1
[0m09:44:51.278549 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s1"
[0m09:44:51.279086 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:44:51.279279 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: BEGIN
[0m09:44:51.279956 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:51.280128 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:44:51.280350 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 1) with readable column names
-- Questionnaire ID: 203
-- Source file: questionnaire/ipc-session-1/mood-rating-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "mood_s1_8085cded8e0f497f9e3d5fab3981d727",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "mood_s1_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:51.282966 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:51.284871 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:44:51.285154 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_tmp" rename to "qr_mood_rating_s1"
[0m09:44:51.286249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:51.287050 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:44:51.287358 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:44:51.287560 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: COMMIT
[0m09:44:51.288699 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:51.289954 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup"
[0m09:44:51.290232 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s1"
[0m09:44:51.290401 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s1__dbt_backup" cascade
[0m09:44:51.291011 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:51.291726 [debug] [Thread-2 (]: On model.engage_analytics.qr_mood_rating_s1: Close
[0m09:44:51.292035 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106320440>]}
[0m09:44:51.292377 [info ] [Thread-2 (]: 30 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s1  [[32mCREATE VIEW[0m in 0.63s]
[0m09:44:51.292710 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_mood_rating_s1
[0m09:44:51.292924 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_mw_tool
[0m09:44:51.293197 [info ] [Thread-2 (]: 34 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [RUN]
[0m09:44:51.293401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s1, now model.engage_analytics.qr_mw_tool)
[0m09:44:51.293570 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_mw_tool
[0m09:44:51.297031 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:44:51.297280 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:51.297458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:51.469434 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.593 seconds
[0m09:44:51.472369 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:44:51.473663 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_mood_rating_s3
[0m09:44:51.475866 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s3"
[0m09:44:51.476181 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.600 seconds
[0m09:44:51.476467 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.600 seconds
[0m09:44:51.477471 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:44:51.478342 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:44:51.478733 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:44:51.478946 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: BEGIN
[0m09:44:51.479187 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_mood_rating_s2
[0m09:44:51.480866 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s2"
[0m09:44:51.481107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:44:51.481308 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_mood_rating_s4
[0m09:44:51.481542 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:44:51.483092 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_mood_rating_s4"
[0m09:44:51.483370 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 3) with readable column names
-- Questionnaire ID: 207
-- Source file: questionnaire/ipc-session-3/mood-rating-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "mood_s3_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:51.483717 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:44:51.484010 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: BEGIN
[0m09:44:51.484306 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:44:51.484519 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: BEGIN
[0m09:44:51.484730 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:51.484921 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:44:51.485155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:51.485402 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 2) with readable column names
-- Questionnaire ID: 206
-- Source file: questionnaire/ipc-session-2/mood-rating-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "mood_s2_total_score",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:51.485689 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:44:51.485954 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:51.486245 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mood Rating (IPC Session 4) with readable column names
-- Questionnaire ID: 209
-- Source file: questionnaire/ipc-session-4/mood-rating-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as "mood_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990' then answer_value_text end) as "mood_s4_total_score"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:51.487842 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:44:51.488135 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_tmp" rename to "qr_mood_rating_s3"
[0m09:44:51.488377 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:51.489828 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:44:51.490056 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:51.490381 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:51.490576 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_tmp" rename to "qr_mood_rating_s2"
[0m09:44:51.492183 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:44:51.492867 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:44:51.493179 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_tmp" rename to "qr_mood_rating_s4"
[0m09:44:51.493419 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:44:51.493674 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: COMMIT
[0m09:44:51.493910 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:51.494553 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:44:51.494827 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:51.495063 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:44:51.495233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:51.496554 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup"
[0m09:44:51.496789 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: COMMIT
[0m09:44:51.497398 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:44:51.497663 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s3"
[0m09:44:51.497886 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:44:51.498107 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s3__dbt_backup" cascade
[0m09:44:51.498328 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: COMMIT
[0m09:44:51.498729 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:51.500722 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup"
[0m09:44:51.500957 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:44:51.501241 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s2"
[0m09:44:51.501448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:44:51.502096 [debug] [Thread-4 (]: On model.engage_analytics.qr_mood_rating_s3: Close
[0m09:44:51.502294 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s2__dbt_backup" cascade
[0m09:44:51.503365 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup"
[0m09:44:51.503696 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067af5c0>]}
[0m09:44:51.504025 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_mood_rating_s4"
[0m09:44:51.504243 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:51.504594 [info ] [Thread-4 (]: 32 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:51.504845 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mood_rating_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mood_rating_s4__dbt_backup" cascade
[0m09:44:51.505575 [debug] [Thread-3 (]: On model.engage_analytics.qr_mood_rating_s2: Close
[0m09:44:51.505864 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_mood_rating_s3
[0m09:44:51.506216 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724260>]}
[0m09:44:51.506484 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:44:51.506762 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:51.507120 [info ] [Thread-3 (]: 31 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s2  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:51.507384 [info ] [Thread-4 (]: 35 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [RUN]
[0m09:44:51.508203 [debug] [Thread-1 (]: On model.engage_analytics.qr_mood_rating_s4: Close
[0m09:44:51.508494 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_mood_rating_s2
[0m09:44:51.508715 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s3, now model.engage_analytics.qr_mw_tool_ipc_session_4)
[0m09:44:51.508996 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_phq_9_s1
[0m09:44:51.509292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664ca70>]}
[0m09:44:51.509499 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:44:51.509804 [info ] [Thread-3 (]: 36 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [RUN]
[0m09:44:51.513513 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:44:51.510388 [info ] [Thread-1 (]: 33 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mood_rating_s4  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:51.514120 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s2, now model.engage_analytics.qr_phq_9_s1)
[0m09:44:51.514450 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

    
    with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:51.514769 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_mood_rating_s4
[0m09:44:51.514948 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_phq_9_s1
[0m09:44:51.515112 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:51.515294 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_phq_9_s2
[0m09:44:51.517992 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:44:51.518509 [info ] [Thread-1 (]: 37 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [RUN]
[0m09:44:51.518824 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:51.519203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mood_rating_s4, now model.engage_analytics.qr_phq_9_s2)
[0m09:44:51.519518 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:51.519731 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_phq_9_s2
[0m09:44:51.523012 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:44:51.523311 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:51.523509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:51.900147 [debug] [Thread-2 (]: SQL status: SELECT 37 in 0.602 seconds
[0m09:44:51.903911 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool"
[0m09:44:51.905584 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_mw_tool
[0m09:44:51.907496 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool"
[0m09:44:51.907932 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:44:51.908113 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: BEGIN
[0m09:44:51.908950 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:51.909132 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:44:51.909455 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool with readable column names
-- Questionnaire ID: 1613532
-- Source file: questionnaire/assessments/mw-tool.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "mental_in_the_past_year_have_you_ever_felt_that_your_thou",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "mental_in_the_past_year_how_often_do_you_have_a_drink_con",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "mental_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "mental_in_the_past_year_did_you_at_any_time_hear_voices_s",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "mental_q2_depressed",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "mental_in_the_past_year_how_many_times_have_you_used_a_re",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "mental_in_the_past_year_how_many_drinks_containing_alcoho",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "mental_in_the_past_3_months_have_you_ever_done_anything_s",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "mental_q1_anxious",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "mental_in_the_past_month_have_you_had_any_actual_thoughts",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "mental_q5_restless",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "mental_in_the_past_year_have_there_been_times_when_you_fe_13",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "mental_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "mental_supervisors_name",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "mental_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "mental_referral_details_if_the_client_is_referred_out",max(case when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29' then answer_value_text end) as "retake_screening",max(case when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f' then answer_value_text end) as "retake_screening_19",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'q1-to-q3-negative' then answer_value_text end) as "q1-to-q3-negative",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-common-mental-health-form' then answer_value_text end) as "task-id-common-mental-health-form",max(case when linkid = 'task-id-mwtool-pdf' then answer_value_text end) as "task-id-mwtool-pdf",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:51.912930 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:51.914492 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:44:51.914680 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_tmp" rename to "qr_mw_tool"
[0m09:44:51.915825 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:51.916539 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:44:51.916731 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:44:51.916887 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: COMMIT
[0m09:44:51.917931 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:51.919431 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup"
[0m09:44:51.919791 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_mw_tool"
[0m09:44:51.919986 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool__dbt_backup" cascade
[0m09:44:51.920764 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:51.921545 [debug] [Thread-2 (]: On model.engage_analytics.qr_mw_tool: Close
[0m09:44:51.921859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b0e30>]}
[0m09:44:51.922184 [info ] [Thread-2 (]: 34 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool  [[32mCREATE VIEW[0m in 0.63s]
[0m09:44:51.922463 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_mw_tool
[0m09:44:51.922655 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_phq_9_s3
[0m09:44:51.922867 [info ] [Thread-2 (]: 38 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [RUN]
[0m09:44:51.923099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool, now model.engage_analytics.qr_phq_9_s3)
[0m09:44:51.923269 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_phq_9_s3
[0m09:44:51.925758 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:44:51.926073 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:51.926366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:52.126241 [debug] [Thread-4 (]: SQL status: SELECT 28 in 0.611 seconds
[0m09:44:52.130597 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:44:52.131390 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:44:52.134326 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:44:52.134654 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.611 seconds
[0m09:44:52.134889 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.615 seconds
[0m09:44:52.135953 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s2"
[0m09:44:52.136836 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s1"
[0m09:44:52.137334 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:44:52.137577 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: BEGIN
[0m09:44:52.137810 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_phq_9_s2
[0m09:44:52.138029 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_phq_9_s1
[0m09:44:52.138267 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:52.140008 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s2"
[0m09:44:52.141480 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s1"
[0m09:44:52.141684 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:44:52.142104 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Mental Wellness Tool Session 4 with readable column names
-- Questionnaire ID: mw-tool-ipc-session-4
-- Source file: questionnaire/assessments/mw-tool-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_s",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as "in_the_past_year_have_you_ever_felt_that_your_thoughts_were",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as "in_the_past_year_how_often_do_you_have_a_drink_containing_a",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as "in_the_past_month_have_you_wished_you_were_dead_or_wished_y",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as "in_the_past_year_did_you_at_any_time_hear_voices_saying_qui",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_down_d",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as "in_the_past_year_how_many_times_have_you_used_a_recreationa",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as "in_the_past_year_how_many_drinks_containing_alcohol_do_you",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as "in_the_past_3_months_have_you_ever_done_anything_started_t",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_feeling_nervous",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as "in_the_past_month_have_you_had_any_actual_thoughts_of_killi",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as "in_the_last_2_weeks_how_often_have_you_been_so_restless_tha",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as "in_the_past_year_have_there_been_times_when_you_felt_that_a",max(case when linkid = 'alcohol-problem' then answer_value_text end) as "alcohol-problem",max(case when linkid = 'common-mental-health' then answer_value_text end) as "common-mental-health",max(case when linkid = 'drug-problem' then answer_value_text end) as "drug-problem",max(case when linkid = 'how-many-drinks' then answer_value_text end) as "how-many-drinks",max(case when linkid = 'no-mental-problem' then answer_value_text end) as "no-mental-problem",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'severe-mental-health' then answer_value_text end) as "severe-mental-health",max(case when linkid = 'suicide-risk' then answer_value_text end) as "suicide-risk",max(case when linkid = 'task-id-mw-tool-ipc-s4-pdf' then answer_value_text end) as "task-id-mw-tool-ipc-s4-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:52.142814 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:44:52.143024 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:44:52.143256 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: BEGIN
[0m09:44:52.143537 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: BEGIN
[0m09:44:52.144307 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:52.144534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:52.144707 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:44:52.144885 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:44:52.145156 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 1) with readable column names
-- Questionnaire ID: 54
-- Source file: questionnaire/ipc-session-1/phq-9-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.3.1' then answer_value_text end) as "phq9_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "phq9_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "phq9_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "phq9_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "phq9_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "phq9_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "phq9_q7_concentration",max(case when linkid = 'f1.10.1' then answer_value_text end) as "phq9_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "phq9_q9_suicide",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "phq9_total_score",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "phq9_score_meaning",max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as "phq9_score_meaning_code",max(case when linkid = 'encounter-id' then answer_value_text end) as "phq9_encounter_id",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "phq9_observation_id",max(case when linkid = 'calculated-month' then answer_value_text end) as "phq9_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "phq9_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "phq9_field_cd8e3d6d",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as "phq9_task_id",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "phq9_field_9c366bcc",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "phq9_field_b5bc7f80",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "phq9_link_encounter"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:52.145432 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:52.145672 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 2) with readable column names
-- Questionnaire ID: 57
-- Source file: questionnaire/ipc-session-2/phq-9-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_phq9_session_2",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s2_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s2_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s2_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s2_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s2_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s2_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s2_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s2_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s2_q7_concentration",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_phq9_session_2_score",max(case when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'a07491bd-039d-417b-9caf-0af536316594' then answer_value_text end) as "ipc_s2_score_meaning_14"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:52.147360 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:44:52.147630 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_tmp" rename to "qr_mw_tool_ipc_session_4"
[0m09:44:52.148199 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:52.149666 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:44:52.149859 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:52.150177 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:52.150415 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_tmp" rename to "qr_phq_9_s1"
[0m09:44:52.151900 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:44:52.152621 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:44:52.152905 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_tmp" rename to "qr_phq_9_s2"
[0m09:44:52.153162 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:44:52.153434 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: COMMIT
[0m09:44:52.153861 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:52.154134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:52.154809 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:44:52.155402 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:44:52.155565 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:52.155745 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:44:52.155924 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:44:52.157042 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup"
[0m09:44:52.157215 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: COMMIT
[0m09:44:52.157378 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: COMMIT
[0m09:44:52.157628 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_mw_tool_ipc_session_4"
[0m09:44:52.157849 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_mw_tool_ipc_session_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_mw_tool_ipc_session_4__dbt_backup" cascade
[0m09:44:52.158386 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:52.158565 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:52.159208 [debug] [Thread-4 (]: On model.engage_analytics.qr_mw_tool_ipc_session_4: Close
[0m09:44:52.159414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:52.160676 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup"
[0m09:44:52.162014 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup"
[0m09:44:52.162293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dc0e0>]}
[0m09:44:52.162662 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s1"
[0m09:44:52.162941 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s2"
[0m09:44:52.163450 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s1__dbt_backup" cascade
[0m09:44:52.163284 [info ] [Thread-4 (]: 35 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_mw_tool_ipc_session_4  [[32mCREATE VIEW[0m in 0.65s]
[0m09:44:52.163683 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s2__dbt_backup" cascade
[0m09:44:52.163952 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_mw_tool_ipc_session_4
[0m09:44:52.164200 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_phq_9_s4
[0m09:44:52.164481 [info ] [Thread-4 (]: 39 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [RUN]
[0m09:44:52.164736 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_mw_tool_ipc_session_4, now model.engage_analytics.qr_phq_9_s4)
[0m09:44:52.164936 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:52.165105 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_phq_9_s4
[0m09:44:52.165266 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:52.165900 [debug] [Thread-1 (]: On model.engage_analytics.qr_phq_9_s2: Close
[0m09:44:52.169320 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:44:52.170302 [debug] [Thread-3 (]: On model.engage_analytics.qr_phq_9_s1: Close
[0m09:44:52.170755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646b1a0>]}
[0m09:44:52.171026 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:52.171459 [info ] [Thread-1 (]: 37 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s2  [[32mCREATE VIEW[0m in 0.65s]
[0m09:44:52.171923 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106453bf0>]}
[0m09:44:52.172187 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:52.172604 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_phq_9_s2
[0m09:44:52.173085 [info ] [Thread-3 (]: 36 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s1  [[32mCREATE VIEW[0m in 0.66s]
[0m09:44:52.173480 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_planning_next_steps
[0m09:44:52.173768 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_phq_9_s1
[0m09:44:52.174347 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_registration_info
[0m09:44:52.174008 [info ] [Thread-1 (]: 40 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [RUN]
[0m09:44:52.175184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s2, now model.engage_analytics.qr_planning_next_steps)
[0m09:44:52.174919 [info ] [Thread-3 (]: 41 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [RUN]
[0m09:44:52.175499 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_planning_next_steps
[0m09:44:52.175710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s1, now model.engage_analytics.qr_registration_info)
[0m09:44:52.178430 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:44:52.178767 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_registration_info
[0m09:44:52.179019 [debug] [Thread-1 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:52.181617 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:44:52.181871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:52.182067 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:52.182461 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:52.543038 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.616 seconds
[0m09:44:52.545628 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s3"
[0m09:44:52.546813 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_phq_9_s3
[0m09:44:52.549570 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s3"
[0m09:44:52.550148 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:44:52.550341 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: BEGIN
[0m09:44:52.551394 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:52.551707 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:44:52.552193 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 3) with readable column names
-- Questionnaire ID: 61
-- Source file: questionnaire/ipc-session-3/phq-9-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s3_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s3_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s3_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s3_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s3_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s3_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s3_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s3_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s3_q7_concentration",max(case when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9' then answer_value_text end) as "ipc_s3_score_meaning_12"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:52.555257 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:52.557225 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:44:52.557480 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_tmp" rename to "qr_phq_9_s3"
[0m09:44:52.558408 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:52.559092 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:44:52.559297 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:44:52.559467 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: COMMIT
[0m09:44:52.560408 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:52.561706 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup"
[0m09:44:52.561985 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s3"
[0m09:44:52.562159 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s3__dbt_backup" cascade
[0m09:44:52.562755 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:52.563401 [debug] [Thread-2 (]: On model.engage_analytics.qr_phq_9_s3: Close
[0m09:44:52.563694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067142c0>]}
[0m09:44:52.564007 [info ] [Thread-2 (]: 38 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:52.564273 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_phq_9_s3
[0m09:44:52.564463 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_remove_patient
[0m09:44:52.564732 [info ] [Thread-2 (]: 42 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [RUN]
[0m09:44:52.565068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s3, now model.engage_analytics.qr_remove_patient)
[0m09:44:52.565270 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_remove_patient
[0m09:44:52.567753 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:44:52.568022 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:52.568209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:52.782804 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.610 seconds
[0m09:44:52.787152 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_phq_9_s4"
[0m09:44:52.788625 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_phq_9_s4
[0m09:44:52.790796 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_phq_9_s4"
[0m09:44:52.791391 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:44:52.791581 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s4: BEGIN
[0m09:44:52.792536 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:52.792775 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:44:52.793025 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 4) with readable column names
-- Questionnaire ID: 211
-- Source file: questionnaire/ipc-session-4/phq-9-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "ipc_s4_how_difficult_have_these_problems_made_it_for_you_",max(case when linkid = 'f1.10.1' then answer_value_text end) as "ipc_s4_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "ipc_s4_q9_suicide",max(case when linkid = 'f1.3.1' then answer_value_text end) as "ipc_s4_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "ipc_s4_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "ipc_s4_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "ipc_s4_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "ipc_s4_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "ipc_s4_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "ipc_s4_q7_concentration",max(case when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792' then answer_value_text end) as "ipc_s4_score_meaning_13"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:52.795377 [debug] [Thread-1 (]: SQL status: SELECT 66 in 0.613 seconds
[0m09:44:52.796763 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_planning_next_steps"
[0m09:44:52.796989 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:52.797267 [debug] [Thread-3 (]: SQL status: SELECT 28 in 0.615 seconds
[0m09:44:52.798888 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:44:52.799885 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info"
[0m09:44:52.800147 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_tmp" rename to "qr_phq_9_s4"
[0m09:44:52.800352 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_planning_next_steps
[0m09:44:52.803249 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_planning_next_steps"
[0m09:44:52.803555 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:44:52.804421 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:44:52.804647 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:44:52.804832 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s4: COMMIT
[0m09:44:52.805094 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_registration_info
[0m09:44:52.805351 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:44:52.807183 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info"
[0m09:44:52.807420 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:52.807588 [debug] [Thread-1 (]: On model.engage_analytics.qr_planning_next_steps: BEGIN
[0m09:44:52.808820 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup"
[0m09:44:52.809205 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_phq_9_s4"
[0m09:44:52.809454 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_phq_9_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_phq_9_s4__dbt_backup" cascade
[0m09:44:52.809714 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:44:52.809929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:52.810161 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: BEGIN
[0m09:44:52.810379 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:44:52.810679 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:52.811173 [debug] [Thread-1 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Planning Next Steps with readable column names
-- Questionnaire ID: q-planning-next-steps
-- Source file: questionnaire/assessments/planning-next-steps.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7' then answer_value_text end) as "referral_to_mental_health_specialist",max(case when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7' then answer_value_text end) as "referred",max(case when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f' then answer_value_text end) as "okay",max(case when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d' then answer_value_text end) as "field_2cb66889",max(case when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6' then answer_value_text end) as "field_34a56c28",max(case when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9' then answer_value_text end) as "referres",max(case when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01' then answer_value_text end) as "field_34ab6c28",max(case when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d' then answer_value_text end) as "field_3b9f7e5d",max(case when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f' then answer_value_text end) as "sbirt_motivational_interviewing",max(case when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7' then answer_value_text end) as "safety",max(case when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123' then answer_value_text end) as "others",max(case when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae' then answer_value_text end) as "mental_health",max(case when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345' then answer_value_text end) as "not_interested",max(case when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf' then answer_value_text end) as "20250924",max(case when linkid = '69712544-6237-4962-a455-ee6e9ee80000' then answer_value_text end) as "field_69712544",max(case when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e' then answer_value_text end) as "field_76ba8dbe",max(case when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574' then answer_value_text end) as "hh",max(case when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106' then answer_value_text end) as "20260505",max(case when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d' then answer_value_text end) as "field_9a8b7c6d",max(case when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d' then answer_value_text end) as "sbirt_motivational_interviewingbrspan_stylecolor006",max(case when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab' then answer_value_text end) as "field_ab12d39f",max(case when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e' then answer_value_text end) as "they_gtycyvuy",max(case when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e' then answer_value_text end) as "field_b2c3d4e5",max(case when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc' then answer_value_text end) as "test",max(case when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e' then answer_value_text end) as "field_bc2def4a",max(case when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f' then answer_value_text end) as "field_c3d4e5f6",max(case when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4' then answer_value_text end) as "field_c9d8b7a6",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd' then answer_value_text end) as "not_interested_28",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f' then answer_value_text end) as "field_cd34f5b1",max(case when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f' then answer_value_text end) as "iwbwb",max(case when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a' then answer_value_text end) as "needs_checkups",max(case when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a' then answer_value_text end) as "hhh",max(case when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90' then answer_value_text end) as "20250827",max(case when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7' then answer_value_text end) as "referral_to_mental_health_specialist_34",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b' then answer_value_text end) as "already_received_a_similar_service",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4' then answer_value_text end) as "field_ef5617d3",max(case when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5' then answer_value_text end) as "peace",max(case when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100' then answer_value_text end) as "interested_but_not_now",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g' then answer_value_text end) as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g",max(case when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h' then answer_value_text end) as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h",max(case when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i' then answer_value_text end) as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i",max(case when linkid = 'financial-hardships-list' then answer_value_text end) as "financial-hardships-list",max(case when linkid = 'is-fws' then answer_value_text end) as "is-fws",max(case when linkid = 'is-ipc' then answer_value_text end) as "is-ipc",max(case when linkid = 'is-ipc-main' then answer_value_text end) as "is-ipc-main",max(case when linkid = 'is-ipc-optional' then answer_value_text end) as "is-ipc-optional",max(case when linkid = 'is-mhs' then answer_value_text end) as "is-mhs",max(case when linkid = 'is-other-agency-services' then answer_value_text end) as "is-other-agency-services",max(case when linkid = 'is-other-services-outside-agency' then answer_value_text end) as "is-other-services-outside-agency",max(case when linkid = 'is-sbirt' then answer_value_text end) as "is-sbirt",max(case when linkid = 'is-sbirt-main' then answer_value_text end) as "is-sbirt-main",max(case when linkid = 'is-sbirt-optional' then answer_value_text end) as "is-sbirt-optional",max(case when linkid = 'is-spi' then answer_value_text end) as "is-spi",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'scheduled-ipc-session-1-with-current-time' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time",max(case when linkid = 'scheduled-ipc-session-1-with-current-time-2' then answer_value_text end) as "scheduled-ipc-session-1-with-current-time-2",max(case when linkid = 'task-id-000' then answer_value_text end) as "task-id-000",max(case when linkid = 'task-id-001' then answer_value_text end) as "task-id-001",max(case when linkid = 'task-id-002' then answer_value_text end) as "task-id-002",max(case when linkid = 'task-id-003' then answer_value_text end) as "task-id-003",max(case when linkid = 'task-id-004' then answer_value_text end) as "task-id-004",max(case when linkid = 'task-id-006' then answer_value_text end) as "task-id-006",max(case when linkid = 'task-id-planning-next-steps-pdf' then answer_value_text end) as "task-id-planning-next-steps-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:52.811612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:52.812302 [debug] [Thread-4 (]: On model.engage_analytics.qr_phq_9_s4: Close
[0m09:44:52.812558 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:44:52.812894 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Add Family Member Registration with readable column names
-- Questionnaire ID: 221
-- Source file: questionnaire/generic/registration_info.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff' then answer_value_text end) as "registration_36d39dbe00e24e29f0793ec8f0119aff",max(case when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd' then answer_value_text end) as "registration_middle_name",max(case when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271' then answer_value_text end) as "registration_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7' then answer_value_text end) as "registration_age",max(case when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d' then answer_value_text end) as "registration_surname",max(case when linkid = 'age' then answer_value_text end) as "registration_age_6",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "registration_calculated_age",max(case when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f' then answer_value_text end) as "registration_unique_id",max(case when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0' then answer_value_text end) as "registration_has_this_person_received_engage_services_in_the_pa",max(case when linkid = 'calculated-month' then answer_value_text end) as "registration_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "registration_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "registration_date_of_birth_dob",max(case when linkid = 'e6306275-b989-4375-8527-3a56092081b8' then answer_value_text end) as "registration_first_name",max(case when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd' then answer_value_text end) as "registration_what_was_your_biological_sex_assigned_at_birth",max(case when linkid = 'choice-gender-identity' then answer_value_text end) as "choice-gender-identity",max(case when linkid = 'choice-pronouns' then answer_value_text end) as "choice-pronouns",max(case when linkid = 'do-you-have-medicaid' then answer_value_text end) as "do-you-have-medicaid",max(case when linkid = 'email-address' then answer_value_text end) as "email-address",max(case when linkid = 'medicaid-number' then answer_value_text end) as "medicaid-number",max(case when linkid = 'other-best-represents-how-you-think-of-yourself' then answer_value_text end) as "other-best-represents-how-you-think-of-yourself",max(case when linkid = 'other-biological-sex-at-birth' then answer_value_text end) as "other-biological-sex-at-birth",max(case when linkid = 'other-gender-identity' then answer_value_text end) as "other-gender-identity",max(case when linkid = 'other-pronouns' then answer_value_text end) as "other-pronouns",max(case when linkid = 'other-where-did-you-first-learn-about-engage' then answer_value_text end) as "other-where-did-you-first-learn-about-engage",max(case when linkid = 'phone-number' then answer_value_text end) as "phone-number",max(case when linkid = 'physical-address' then answer_value_text end) as "physical-address",max(case when linkid = 'where-did-you-first-learn-about-engage' then answer_value_text end) as "where-did-you-first-learn-about-engage",max(case when linkid = 'zip-code' then answer_value_text end) as "zip-code"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:52.813294 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8697f0>]}
[0m09:44:52.813638 [info ] [Thread-4 (]: 39 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_phq_9_s4  [[32mCREATE VIEW[0m in 0.65s]
[0m09:44:52.813914 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_phq_9_s4
[0m09:44:52.814105 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sbirt
[0m09:44:52.814338 [info ] [Thread-4 (]: 43 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sbirt .. [RUN]
[0m09:44:52.814542 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_phq_9_s4, now model.engage_analytics.qr_sbirt)
[0m09:44:52.814710 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sbirt
[0m09:44:52.817146 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:44:52.817415 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:52.817675 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:52.817893 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:44:52.819371 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:44:52.819598 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:52.820967 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:44:52.821274 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_tmp" rename to "qr_registration_info"
[0m09:44:52.821600 [debug] [Thread-1 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_tmp" rename to "qr_planning_next_steps"
[0m09:44:52.823113 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:52.823855 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:44:52.824076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:52.824271 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:44:52.824973 [debug] [Thread-1 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:44:52.825164 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: COMMIT
[0m09:44:52.825331 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:44:52.825539 [debug] [Thread-1 (]: On model.engage_analytics.qr_planning_next_steps: COMMIT
[0m09:44:52.826585 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:52.826872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:52.828170 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup"
[0m09:44:52.829300 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup"
[0m09:44:52.829680 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_registration_info"
[0m09:44:52.830061 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_planning_next_steps"
[0m09:44:52.830341 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info__dbt_backup" cascade
[0m09:44:52.830584 [debug] [Thread-1 (]: On model.engage_analytics.qr_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_planning_next_steps__dbt_backup" cascade
[0m09:44:52.831524 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:52.831782 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:52.832729 [debug] [Thread-1 (]: On model.engage_analytics.qr_planning_next_steps: Close
[0m09:44:52.833439 [debug] [Thread-3 (]: On model.engage_analytics.qr_registration_info: Close
[0m09:44:52.833789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646ac00>]}
[0m09:44:52.834203 [info ] [Thread-1 (]: 40 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_planning_next_steps  [[32mCREATE VIEW[0m in 0.66s]
[0m09:44:52.834502 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_planning_next_steps
[0m09:44:52.834712 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:44:52.834930 [info ] [Thread-1 (]: 44 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [RUN]
[0m09:44:52.835150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_planning_next_steps, now model.engage_analytics.qr_sf_pcl_5_s1)
[0m09:44:52.835329 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:44:52.839612 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:44:52.840051 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:52.840440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f9dc0>]}
[0m09:44:52.840684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:52.841109 [info ] [Thread-3 (]: 41 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info  [[32mCREATE VIEW[0m in 0.66s]
[0m09:44:52.841599 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_registration_info
[0m09:44:52.841848 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:44:52.842103 [info ] [Thread-3 (]: 45 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [RUN]
[0m09:44:52.842480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_registration_info, now model.engage_analytics.qr_sf_pcl_5_s2)
[0m09:44:52.842700 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:44:52.845407 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:44:52.845684 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:52.845867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:53.190351 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.622 seconds
[0m09:44:53.192989 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_remove_patient"
[0m09:44:53.194178 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_remove_patient
[0m09:44:53.197374 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_remove_patient"
[0m09:44:53.198011 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:44:53.198217 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: BEGIN
[0m09:44:53.199030 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:53.199255 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:44:53.199505 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- eCBIS Remove Family Form with readable column names
-- Questionnaire ID: 69
-- Source file: questionnaire/generic/remove_patient.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f' then answer_value_text end) as "remove_family_date_of_death",max(case when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a' then answer_value_text end) as "remove_family_give_other_reasons_for_removal",max(case when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5' then answer_value_text end) as "remove_family_age_at_death_year",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b' then answer_value_text end) as "remove_family_a11ebb0dacb34038956b293a41acb85b",max(case when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1' then answer_value_text end) as "remove_family_date_moved_away",max(case when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff' then answer_value_text end) as "remove_family_reason_for_removal",max(case when linkid = 'patient-birthdate' then answer_value_text end) as "remove_family_patientbirthdate",max(case when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec' then answer_value_text end) as "reason_unknown"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:53.202117 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:53.203827 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:44:53.204024 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_tmp" rename to "qr_remove_patient"
[0m09:44:53.204868 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:53.205481 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:44:53.205655 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:44:53.205807 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: COMMIT
[0m09:44:53.206500 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:53.207540 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup"
[0m09:44:53.207783 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_remove_patient"
[0m09:44:53.207965 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_remove_patient"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_remove_patient__dbt_backup" cascade
[0m09:44:53.208455 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:53.209093 [debug] [Thread-2 (]: On model.engage_analytics.qr_remove_patient: Close
[0m09:44:53.209393 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a4dd0>]}
[0m09:44:53.209777 [info ] [Thread-2 (]: 42 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_remove_patient  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:53.210164 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_remove_patient
[0m09:44:53.210377 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:44:53.210624 [info ] [Thread-2 (]: 46 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [RUN]
[0m09:44:53.211004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_remove_patient, now model.engage_analytics.qr_sf_pcl_5_s3)
[0m09:44:53.211268 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:44:53.213766 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:44:53.214008 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:53.214191 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:53.432199 [debug] [Thread-4 (]: SQL status: SELECT 159 in 0.612 seconds
[0m09:44:53.438415 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sbirt"
[0m09:44:53.439138 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sbirt
[0m09:44:53.440998 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sbirt"
[0m09:44:53.441761 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:44:53.441941 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: BEGIN
[0m09:44:53.442997 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:53.443245 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:44:53.444159 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SBIRT with readable column names
-- Questionnaire ID: 212
-- Source file: questionnaire/sbirt.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_drink_alc",max(case when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t",max(case when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e' then answer_value_text end) as "sbirt_have_you_or_someone_else_been_injured_as_a_result_",max(case when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621' then answer_value_text end) as "sbirt_how_often_do_you_have_six_or_more_drinks_on_one_oc",max(case when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_needed_a_f",max(case when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848' then answer_value_text end) as "sbirt_have_you_ever_experienced_withdrawal_symptoms_felt",max(case when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4' then answer_value_text end) as "sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_o",max(case when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_8",max(case when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_had_a_feel",max(case when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1' then answer_value_text end) as "sbirt_how_many_standard_drinks_containing_alcohol_do_you",max(case when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_been_unabl",max(case when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11' then answer_value_text end) as "sbirt_how_often_do_you_have_a_drink_containing_alcohol",max(case when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4' then answer_value_text end) as "sbirt_have_you_neglected_your_family_because_of_your_use",max(case when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267' then answer_value_text end) as "sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use",max(case when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_15",max(case when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990' then answer_value_text end) as "sbirt_have_you_had_medical_problems_as_a_result_of_your_",max(case when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3' then answer_value_text end) as "sbirt_have_you_ever_used_any_drugs_by_injection_nonmedic",max(case when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c' then answer_value_text end) as "sbirt_have_you_engaged_in_illegal_activities_in_order_to",max(case when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_19",max(case when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_20",max(case when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_failed_to_",max(case when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_22",max(case when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41' then answer_value_text end) as "sbirt_does_your_spouse_or_parents_ever_complain_about_yo",max(case when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_24",max(case when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_25",max(case when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_used_t_26",max(case when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9' then answer_value_text end) as "sbirt_are_you_always_able_to_stop_using_drugs_when_you_w",max(case when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995' then answer_value_text end) as "sbirt_how_often_during_the_last_year_have_you_found_that",max(case when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b' then answer_value_text end) as "sbirt_have_you_used_drugs_other_than_those_required_for_",max(case when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88' then answer_value_text end) as "sbirt_has_a_relative_or_friend_or_a_doctor_or_another_he",max(case when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba' then answer_value_text end) as "sbirt_do_you_use_more_than_one_drug_at_a_time",max(case when linkid = '0466b304-2876-409b-ade2-d1c675614854' then answer_value_text end) as "sbirt_please_select_one_substance_you_would_like_to_disc",max(case when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_metha",max(case when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78' then answer_value_text end) as "sbirt_i_would_like_to_offer_an_opportunity_to_start_a_co",max(case when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0' then answer_value_text end) as "sbirt_we_could_start_by_discussing_the_pros_and_cons_of_",max(case when linkid = '39843731-a8e7-4822-bad7-55489947ebeb' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_other",max(case when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_alc",max(case when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_canna",max(case when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_hallu",max(case when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_sedat",max(case when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_inhal",max(case when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_cocai",max(case when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041' then answer_value_text end) as "sbirt_are_you_interested_in_learning_more_about_what_the",max(case when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491' then answer_value_text end) as "sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_al",max(case when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_presc",max(case when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha",max(case when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_47",max(case when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_48",max(case when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_49",max(case when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_50",max(case when linkid = '8427af19-3bad-4713-bad9-b179437fef96' then answer_value_text end) as "sbirt_on_average_how_many_days_per_week_do_you_use_stree",max(case when linkid = '90876967-c973-4bee-9217-8c7482cb12a2' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_52",max(case when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368' then answer_value_text end) as "sbirt_cannabis_marijuana_pot_grass_hash_etc",max(case when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_54",max(case when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_55",max(case when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d' then answer_value_text end) as "sbirt_would_you_be_interested_in_learning_more_about_sub",max(case when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9' then answer_value_text end) as "sbirt_1579996975654c3eb488d6a65d66c6c9",max(case when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812' then answer_value_text end) as "sbirt_things_you_can_do",max(case when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_prescript",max(case when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_methamphe",max(case when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_other_dru",max(case when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_inhalants",max(case when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cannabis_",max(case when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474' then answer_value_text end) as "sbirt_during_the_past_three_months_how_often_have_you_ha_64",max(case when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3' then answer_value_text end) as "sbirt_what_are_some_good_things_about_staying_the_same",max(case when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848' then answer_value_text end) as "sbirt_street_opioids_heroin_opium_etc_or_prescription_op",max(case when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_hallucino",max(case when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_cocaine_l",max(case when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_sedatives",max(case when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509' then answer_value_text end) as "sbirt_what_are_some_good_things_about_making_a_change",max(case when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1' then answer_value_text end) as "sbirt_what_are_your_health_goals_around_substance_use",max(case when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f' then answer_value_text end) as "sbirt_cocaine_coke_crack_etc",max(case when linkid = '1600f791-fd2c-44d8-8384-37973785741b' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed",max(case when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_74",max(case when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_75",max(case when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_76",max(case when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d' then answer_value_text end) as "sbirt_in_the_past_three_months_has_your_use_of_street_op",max(case when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_78",max(case when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299' then answer_value_text end) as "sbirt_other_drugs",max(case when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_80",max(case when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_81",max(case when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_82",max(case when linkid = 'edced328-6f82-458a-bce4-35987bff19fb' then answer_value_text end) as "sbirt_edced3286f82458abce435987bff19fb",max(case when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19' then answer_value_text end) as "sbirt_can_i_share_additional_treatment_options_with_you",max(case when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre",max(case when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3' then answer_value_text end) as "sbirt_prescription_stimulants_just_for_the_feeling_more_",max(case when linkid = '582271e0-892e-4795-ac55-0b73baf828ca' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_87",max(case when linkid = '654d5688-f42a-469b-8494-81115b760e29' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_88",max(case when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_89",max(case when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_90",max(case when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_91",max(case when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_92",max(case when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_93",max(case when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4' then answer_value_text end) as "sbirt_in_the_past_three_months_how_often_have_you_failed_94",max(case when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down",max(case when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_96",max(case when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_97",max(case when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c' then answer_value_text end) as "sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_98",max(case when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_99",max(case when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_100",max(case when linkid = 'ad609c63-366e-476a-b131-610ceed211da' then answer_value_text end) as "sbirt_things_others_can_help_you_do",max(case when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_102",max(case when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac' then answer_value_text end) as "sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_e",max(case when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_104",max(case when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_105",max(case when linkid = '6281fa0d-ef3f-4013-bd31-062371828010' then answer_value_text end) as "sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whipp",max(case when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc' then answer_value_text end) as "sbirt_have_you_ever_tried_and_failed_to_control_cut_down_107",max(case when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe' then answer_value_text end) as "sbirt_sedatives_just_for_the_feeling_more_than_prescribe",max(case when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f' then answer_value_text end) as "sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecs",max(case when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404' then answer_value_text end) as "sbirt_any_other_drugs_to_get_high",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '36af2335-ac86-4864-8a3d-619451160cc5' then answer_value_text end) as "2_times_in_a_day",max(case when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f' then answer_value_text end) as "join_a_community_group_and",max(case when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5' then answer_value_text end) as "therapy",max(case when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528' then answer_value_text end) as "2_days_per_week",max(case when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730' then answer_value_text end) as "field_445adcc0",max(case when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045' then answer_value_text end) as "3_days_per_week",max(case when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb' then answer_value_text end) as "not_ready",max(case when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6' then answer_value_text end) as "quit",max(case when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5' then answer_value_text end) as "20250224",max(case when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3' then answer_value_text end) as "2_times_in_a_day_124",max(case when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d' then answer_value_text end) as "field_859d58d6",max(case when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427' then answer_value_text end) as "field_8a6c4c5b",max(case when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7' then answer_value_text end) as "social_places_you_can_go_to_eg_take_a_walk_at_the_park",max(case when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4' then answer_value_text end) as "internally",max(case when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3' then answer_value_text end) as "work_toward_a_goal",max(case when linkid = 'drug-to-use-alcohol' then answer_value_text end) as "drug-to-use-alcohol",max(case when linkid = 'drug-to-use-marijuana-or-other' then answer_value_text end) as "drug-to-use-marijuana-or-other",max(case when linkid = 'health-goals-do-not-want-to-change' then answer_value_text end) as "health-goals-do-not-want-to-change",max(case when linkid = 'is-drug-dependence' then answer_value_text end) as "is-drug-dependence",max(case when linkid = 'is-high-risk-alcohol' then answer_value_text end) as "is-high-risk-alcohol",max(case when linkid = 'is-high-risk-drug' then answer_value_text end) as "is-high-risk-drug",max(case when linkid = 'is-low-risk-alcohol' then answer_value_text end) as "is-low-risk-alcohol",max(case when linkid = 'is-low-risk-drug' then answer_value_text end) as "is-low-risk-drug",max(case when linkid = 'is-medium-risk-alcohol' then answer_value_text end) as "is-medium-risk-alcohol",max(case when linkid = 'is-medium-risk-drug' then answer_value_text end) as "is-medium-risk-drug",max(case when linkid = 'is-opioid-dependence' then answer_value_text end) as "is-opioid-dependence",max(case when linkid = 'other-drug-list' then answer_value_text end) as "other-drug-list",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender' then answer_value_text end) as "patient-gender",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'score-audit' then answer_value_text end) as "score-audit",max(case when linkid = 'score-dast' then answer_value_text end) as "score-dast",max(case when linkid = 'should-converse-about-substance-use' then answer_value_text end) as "should-converse-about-substance-use",max(case when linkid = 'should-discuss-health-goals' then answer_value_text end) as "should-discuss-health-goals",max(case when linkid = 'show-client-use-with-other-drugs' then answer_value_text end) as "show-client-use-with-other-drugs",max(case when linkid = 'show-discuss-next-steps' then answer_value_text end) as "show-discuss-next-steps",max(case when linkid = 'show-goals' then answer_value_text end) as "show-goals",max(case when linkid = 'show-intervention-when-low-risk' then answer_value_text end) as "show-intervention-when-low-risk",max(case when linkid = 'show-intervention-when-medium-high-risk' then answer_value_text end) as "show-intervention-when-medium-high-risk",max(case when linkid = 'show-is-medium-high-risk' then answer_value_text end) as "show-is-medium-high-risk",max(case when linkid = 'show-summary-for-low-risk' then answer_value_text end) as "show-summary-for-low-risk",max(case when linkid = 'show-things-to-do' then answer_value_text end) as "show-things-to-do",max(case when linkid = 'task-id-sbirt-pdf' then answer_value_text end) as "task-id-sbirt-pdf",max(case when linkid = 'using-opioids-and-low-risk' then answer_value_text end) as "using-opioids-and-low-risk"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:53.445442 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.605 seconds
[0m09:44:53.445734 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.600 seconds
[0m09:44:53.446846 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:44:53.447786 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:44:53.448336 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:44:53.448526 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:44:53.450284 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:44:53.452756 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:44:53.453267 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:44:53.453479 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:44:53.453697 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s1: BEGIN
[0m09:44:53.455180 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:44:53.455390 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:44:53.455585 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_tmp" rename to "qr_sbirt"
[0m09:44:53.455758 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s2: BEGIN
[0m09:44:53.456008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:53.456176 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:44:53.456466 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 1) with readable column names
-- Questionnaire ID: 204
-- Source file: questionnaire/ipc-session-1/sf-pcl-5-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505' then answer_value_text end) as "ipc_s1_taskid_ptsd_pdf",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av_8",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s1_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ptsd_session_1",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_pcptsd_session_1_score",max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s1_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s1_score_meaning_14",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s1_is_ptsd",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:53.456775 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:53.457021 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:44:53.457312 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 2) with readable column names
-- Questionnaire ID: 56
-- Source file: questionnaire/ipc-session-2/sf-pcl-5-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ptsd_session_2",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s2_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_pcptsd_session_2_score",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s2_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s2_score_meaning_13",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s2_is_ptsd",max(case when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:53.457668 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:53.458456 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:44:53.458668 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:44:53.458833 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: COMMIT
[0m09:44:53.459933 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:53.460265 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:53.461938 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:44:53.462166 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:53.463243 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup"
[0m09:44:53.463455 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_tmp" rename to "qr_sf_pcl_5_s1"
[0m09:44:53.464881 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:44:53.465173 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sbirt"
[0m09:44:53.465541 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_tmp" rename to "qr_sf_pcl_5_s2"
[0m09:44:53.465727 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sbirt"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sbirt__dbt_backup" cascade
[0m09:44:53.466374 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:53.466607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:53.467380 [debug] [Thread-4 (]: On model.engage_analytics.qr_sbirt: Close
[0m09:44:53.467594 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:53.468285 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:44:53.468634 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106600890>]}
[0m09:44:53.469332 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:44:53.469575 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:44:53.469869 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:44:53.470046 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s1: COMMIT
[0m09:44:53.470284 [info ] [Thread-4 (]: 43 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sbirt  [[32mCREATE VIEW[0m in 0.65s]
[0m09:44:53.470479 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s2: COMMIT
[0m09:44:53.470831 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sbirt
[0m09:44:53.471197 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:44:53.471800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:53.472032 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:53.471577 [info ] [Thread-4 (]: 47 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [RUN]
[0m09:44:53.473235 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup"
[0m09:44:53.474276 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup"
[0m09:44:53.474481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sbirt, now model.engage_analytics.qr_sf_pcl_5_s4)
[0m09:44:53.474744 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s1"
[0m09:44:53.475030 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s2"
[0m09:44:53.475209 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:44:53.475381 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s1__dbt_backup" cascade
[0m09:44:53.475613 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s2__dbt_backup" cascade
[0m09:44:53.478318 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:44:53.478764 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:53.478992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:53.479407 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:53.479683 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:53.480580 [debug] [Thread-3 (]: On model.engage_analytics.qr_sf_pcl_5_s2: Close
[0m09:44:53.481273 [debug] [Thread-1 (]: On model.engage_analytics.qr_sf_pcl_5_s1: Close
[0m09:44:53.481600 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106600890>]}
[0m09:44:53.481922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675bc50>]}
[0m09:44:53.482423 [info ] [Thread-3 (]: 45 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s2  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:53.483079 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s2
[0m09:44:53.482806 [info ] [Thread-1 (]: 44 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s1  [[32mCREATE VIEW[0m in 0.65s]
[0m09:44:53.483415 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_sociodemographic_survey
[0m09:44:53.483743 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s1
[0m09:44:53.484007 [info ] [Thread-3 (]: 48 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [RUN]
[0m09:44:53.484265 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_spi_subform_1
[0m09:44:53.484496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s2, now model.engage_analytics.qr_sociodemographic_survey)
[0m09:44:53.484744 [info ] [Thread-1 (]: 49 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [RUN]
[0m09:44:53.484946 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_sociodemographic_survey
[0m09:44:53.485135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s1, now model.engage_analytics.qr_spi_subform_1)
[0m09:44:53.487841 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:44:53.488156 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_spi_subform_1
[0m09:44:53.488364 [debug] [Thread-3 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:53.491200 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:44:53.491545 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:53.491753 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:53.492108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:53.836906 [debug] [Thread-2 (]: SQL status: SELECT 21 in 0.622 seconds
[0m09:44:53.840637 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:44:53.841451 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:44:53.880800 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:44:53.881771 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:44:53.882042 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: BEGIN
[0m09:44:53.882876 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:53.883098 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:44:53.883385 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 3) with readable column names
-- Questionnaire ID: 60
-- Source file: questionnaire/ipc-session-3/sf-pcl-5-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ptsd_session_3",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s3_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s3_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s3_score_meaning_12",max(case when linkid = 'is-ptsd' then answer_value_text end) as "ipc_s3_is_ptsd",max(case when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:53.887714 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:53.889411 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:44:53.889608 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_tmp" rename to "qr_sf_pcl_5_s3"
[0m09:44:53.890623 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:53.891431 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:44:53.891645 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:44:53.891820 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: COMMIT
[0m09:44:53.892879 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:53.894166 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup"
[0m09:44:53.894460 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s3"
[0m09:44:53.894635 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s3__dbt_backup" cascade
[0m09:44:53.895415 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:53.896116 [debug] [Thread-2 (]: On model.engage_analytics.qr_sf_pcl_5_s3: Close
[0m09:44:53.896411 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067483b0>]}
[0m09:44:53.896733 [info ] [Thread-2 (]: 46 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s3  [[32mCREATE VIEW[0m in 0.69s]
[0m09:44:53.897006 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s3
[0m09:44:53.897197 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_spi_subform_2
[0m09:44:53.897451 [info ] [Thread-2 (]: 50 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [RUN]
[0m09:44:53.897646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s3, now model.engage_analytics.qr_spi_subform_2)
[0m09:44:53.897816 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_spi_subform_2
[0m09:44:53.900215 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:44:53.900439 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:53.900625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:54.090040 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.611 seconds
[0m09:44:54.093200 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:44:54.094494 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:44:54.096512 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:44:54.096985 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:44:54.097172 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: BEGIN
[0m09:44:54.098050 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:54.098235 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:44:54.098510 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Short-Form PCL-5-8 (IPC Session 4) with readable column names
-- Questionnaire ID: 210
-- Source file: questionnaire/ipc-session-4/sf-pcl-5-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s4_encounter_id_of_ptsd_session_4",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byfee",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_re",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_bylos",max(case when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_ha",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_fe",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av_9",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as "ipc_s4_in_the_past_month_how_much_were_you_bothered_byhav",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as "ipc_s4_score_meaning",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as "ipc_s4_score_meaning_12",max(case when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8' then answer_value_text end) as "sometimes_things_happen_to_people_that_are_unusually_or_espe",max(case when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e' then answer_value_text end) as "i_am_going_to_list_some_of_these_events_please_tell_me_if_y",max(case when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef' then answer_value_text end) as "likely_has_ptsd",max(case when linkid = 'f1.26.1' then answer_value_text end) as "f1.26.1",max(case when linkid = 'f1.27.1' then answer_value_text end) as "f1.27.1",max(case when linkid = 'f1.28.1' then answer_value_text end) as "f1.28.1",max(case when linkid = 'f1.29.1' then answer_value_text end) as "f1.29.1",max(case when linkid = 'f1.30.1' then answer_value_text end) as "f1.30.1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:54.101692 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:54.103503 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:44:54.103743 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_tmp" rename to "qr_sf_pcl_5_s4"
[0m09:44:54.104330 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.612 seconds
[0m09:44:54.105430 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_1"
[0m09:44:54.105752 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:54.106582 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:44:54.106778 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:44:54.106943 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: COMMIT
[0m09:44:54.107298 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_spi_subform_1
[0m09:44:54.109148 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_1"
[0m09:44:54.109433 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:54.109690 [debug] [Thread-3 (]: SQL status: SELECT 25 in 0.618 seconds
[0m09:44:54.111011 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup"
[0m09:44:54.111910 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:44:54.112224 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_sf_pcl_5_s4"
[0m09:44:54.112461 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sf_pcl_5_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sf_pcl_5_s4__dbt_backup" cascade
[0m09:44:54.112703 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:44:54.112900 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: BEGIN
[0m09:44:54.113081 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_sociodemographic_survey
[0m09:44:54.113264 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:54.115567 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_sociodemographic_survey"
[0m09:44:54.116211 [debug] [Thread-4 (]: On model.engage_analytics.qr_sf_pcl_5_s4: Close
[0m09:44:54.116382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m09:44:54.116710 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e69f0>]}
[0m09:44:54.116894 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:44:54.117283 [info ] [Thread-4 (]: 47 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sf_pcl_5_s4  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:54.117761 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 1 with readable column names
-- Questionnaire ID: 104455
-- Source file: questionnaire/spi/spi-subform-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_1",max(case when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab' then answer_value_text end) as "spi_is_low_risk",max(case when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d' then answer_value_text end) as "spi_is_medium_risk",max(case when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b' then answer_value_text end) as "spi_is_high_risk",max(case when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5' then answer_value_text end) as "spi_were_any_of_these_in_the_past_three_months",max(case when linkid = '35062b98-748b-441c-ad74-185823e1bb52' then answer_value_text end) as "spi_in_the_past_month_have_you_been_thinking_about_how",max(case when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb' then answer_value_text end) as "spi_in_the_past_month_have_you_had_these_thoughts_and_",max(case when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23' then answer_value_text end) as "spi_in_the_past_month_have_you_started_to_work_out_or_",max(case when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511' then answer_value_text end) as "spi_in_the_past_month_have_you_wished_you_were_dead_or",max(case when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea' then answer_value_text end) as "spi_have_you_ever_done_anything_started_to_do_anything",max(case when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce' then answer_value_text end) as "spi_in_the_past_month_have_you_actually_had_any_though",max(case when linkid = 'task-id-spi-subform-2' then answer_value_text end) as "spi_taskid_spi_subform_2",max(case when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03' then answer_value_text end) as "spi_43898926e9d5400ea09562a8c7f8dd03",max(case when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837' then answer_value_text end) as "spi_644c00f28b07491192d0f05f5e5cc837",max(case when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9' then answer_value_text end) as "spi_71dbaac9867f4d7fb6d7e1f59402bbf9",max(case when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda' then answer_value_text end) as "spi_7fc39fba84db490daf4e8f772d91ffda",max(case when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42' then answer_value_text end) as "spi_a6601f970a3449d0b181611d6705ca42",max(case when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423' then answer_value_text end) as "spi_c7d21a570fc64e3ab411beceb1fb2423",max(case when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019' then answer_value_text end) as "spi_ecabd308c45a41f78754b1f63a101019",max(case when linkid = 'task-status-spi-subform-2' then answer_value_text end) as "spi_taskstatus_spi_subform_2",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "task-id-spi-subform-3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "task-id-spi-subform-4",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "task-status-spi-subform-3",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "task-status-spi-subform-4"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:54.118113 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:44:54.118377 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_sf_pcl_5_s4
[0m09:44:54.118714 [debug] [Thread-3 (]: On model.engage_analytics.qr_sociodemographic_survey: BEGIN
[0m09:44:54.119055 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_spi_subform_3
[0m09:44:54.119424 [info ] [Thread-4 (]: 51 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [RUN]
[0m09:44:54.119695 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sf_pcl_5_s4, now model.engage_analytics.qr_spi_subform_3)
[0m09:44:54.120038 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:54.120248 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_spi_subform_3
[0m09:44:54.120446 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:44:54.123031 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:44:54.123279 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:44:54.123590 [debug] [Thread-3 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- Sociodemographic Survey with readable column names
-- Questionnaire ID: 1613531
-- Source file: questionnaire/assessments/sociodemographic_survey.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7' then answer_value_text end) as "demographic_if_you_were_not_born_in_the_us_how_long_have_you_l",max(case when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5' then answer_value_text end) as "demographic_please_specify",max(case when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde' then answer_value_text end) as "demographic_please_specify_3",max(case when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe' then answer_value_text end) as "demographic_where_were_you_born",max(case when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af' then answer_value_text end) as "demographic_what_is_the_zip_code_of_where_you_currently_live",max(case when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739' then answer_value_text end) as "demographic_what_was_your_biological_sex_at_birth",max(case when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d' then answer_value_text end) as "demographic_please_enter_the_number_of_years",max(case when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173' then answer_value_text end) as "demographic_we_would_like_to_know_about_what_you_do_are_you",max(case when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4' then answer_value_text end) as "demographic_please_enter_the_number_of_months",max(case when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9' then answer_value_text end) as "demographic_what_is_your_race_andor_ethnicity",max(case when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0' then answer_value_text end) as "demographic_which_of_the_following_best_represents_how_you_thi",max(case when linkid = '92fed595-49f2-4fab-81ff-885941f31e07' then answer_value_text end) as "demographic_where_did_this_client_first_learn_about_engage",max(case when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a' then answer_value_text end) as "demographic_what_is_your_marital_status",max(case when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c' then answer_value_text end) as "demographic_what_term_best_expresses_how_you_describe_your_gen",max(case when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba' then answer_value_text end) as "demographic_what_was_the_highest_grade_or_level_of_school_that",max(case when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f' then answer_value_text end) as "demographic_please_specify_the_us_territorycommonwealth_eg_pue",max(case when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130' then answer_value_text end) as "some_of_the_time",max(case when linkid = 'patient-age' then answer_value_text end) as "patient-age",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as "patient-biological-sex",max(case when linkid = 'patient-dob' then answer_value_text end) as "patient-dob",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as "patient-gender-identity",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as "patient-how-you-think-of-yourself",max(case when linkid = 'patient-name' then answer_value_text end) as "patient-name",max(case when linkid = 'patient-pronouns' then answer_value_text end) as "patient-pronouns",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as "task-id-socio-pdf"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:54.124036 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:54.126045 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:44:54.126512 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:54.126811 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_tmp" rename to "qr_spi_subform_1"
[0m09:44:54.128162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:54.128974 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:44:54.129179 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:44:54.129342 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: COMMIT
[0m09:44:54.129518 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:54.131318 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:44:54.131561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:54.131810 [debug] [Thread-3 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_tmp" rename to "qr_sociodemographic_survey"
[0m09:44:54.133155 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup"
[0m09:44:54.133522 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_1"
[0m09:44:54.133720 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_1__dbt_backup" cascade
[0m09:44:54.134321 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:54.134551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:54.135354 [debug] [Thread-3 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:44:54.136079 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_1: Close
[0m09:44:54.136293 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:44:54.136725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef8320>]}
[0m09:44:54.137010 [debug] [Thread-3 (]: On model.engage_analytics.qr_sociodemographic_survey: COMMIT
[0m09:44:54.137509 [info ] [Thread-1 (]: 49 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_1  [[32mCREATE VIEW[0m in 0.65s]
[0m09:44:54.137866 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_spi_subform_1
[0m09:44:54.138118 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_spi_subform_4
[0m09:44:54.138603 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:54.138428 [info ] [Thread-1 (]: 52 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [RUN]
[0m09:44:54.139842 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup"
[0m09:44:54.140079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_1, now model.engage_analytics.qr_spi_subform_4)
[0m09:44:54.140368 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_sociodemographic_survey"
[0m09:44:54.140701 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_spi_subform_4
[0m09:44:54.140997 [debug] [Thread-3 (]: On model.engage_analytics.qr_sociodemographic_survey: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_sociodemographic_survey"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_sociodemographic_survey__dbt_backup" cascade
[0m09:44:54.143434 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:44:54.143747 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:54.144141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:54.144344 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:54.145338 [debug] [Thread-3 (]: On model.engage_analytics.qr_sociodemographic_survey: Close
[0m09:44:54.145719 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106347d10>]}
[0m09:44:54.146070 [info ] [Thread-3 (]: 48 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_sociodemographic_survey  [[32mCREATE VIEW[0m in 0.66s]
[0m09:44:54.146352 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_sociodemographic_survey
[0m09:44:54.146564 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_start_ipc_s1
[0m09:44:54.146874 [info ] [Thread-3 (]: 53 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [RUN]
[0m09:44:54.147152 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_sociodemographic_survey, now model.engage_analytics.qr_start_ipc_s1)
[0m09:44:54.147344 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_start_ipc_s1
[0m09:44:54.150214 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:44:54.150509 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:54.150696 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:54.515000 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.614 seconds
[0m09:44:54.518119 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_2"
[0m09:44:54.520386 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_spi_subform_2
[0m09:44:54.522569 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_2"
[0m09:44:54.523135 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:44:54.523321 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: BEGIN
[0m09:44:54.524237 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:54.524514 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:44:54.524790 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 2 with readable column names
-- Questionnaire ID: 104453
-- Source file: questionnaire/spi/spi-subform-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_2",max(case when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36' then answer_value_text end) as "spi_did_this_client_also_screen_positive_for_probable_",max(case when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896' then answer_value_text end) as "spi_did_you_discuss_this_clients_severe_mental_health_",max(case when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab",max(case when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f' then answer_value_text end) as "spi_what_is_the_recommended_plan_to_address_the_probab_5",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as "spi_taskid_spi_subform_3",max(case when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50' then answer_value_text end) as "spi_d02eb882411e4bc0af9d08a77fcc3f50",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as "spi_taskstatus_spi_subform_3",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as "spi_taskid_spi_subform_4",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as "spi_taskstatus_spi_subform_4",max(case when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f' then answer_value_text end) as "spi_53b30f1274eb474c941c5f0e81b7eb9f",max(case when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253' then answer_value_text end) as "spi_did_you_discuss_this_clients_suicide_risk_screenin",max(case when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b' then answer_value_text end) as "spi_this_client_scored_in_the_moderate_to_high_range_o",max(case when linkid = '783e2646-c8ea-466d-bba8-85c891a14435' then answer_value_text end) as "spi_783e2646c8ea466dbba885c891a14435"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:54.527892 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:44:54.530548 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:44:54.530765 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_tmp" rename to "qr_spi_subform_2"
[0m09:44:54.531737 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:54.532422 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:44:54.532628 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:44:54.532797 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: COMMIT
[0m09:44:54.534042 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:54.535332 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup"
[0m09:44:54.535612 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_2"
[0m09:44:54.535784 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_2__dbt_backup" cascade
[0m09:44:54.536375 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:54.536998 [debug] [Thread-2 (]: On model.engage_analytics.qr_spi_subform_2: Close
[0m09:44:54.537278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106702c90>]}
[0m09:44:54.537591 [info ] [Thread-2 (]: 50 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_2  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:54.537867 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_spi_subform_2
[0m09:44:54.538114 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_start_ipc_s2
[0m09:44:54.538370 [info ] [Thread-2 (]: 54 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [RUN]
[0m09:44:54.538592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_2, now model.engage_analytics.qr_start_ipc_s2)
[0m09:44:54.538770 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_start_ipc_s2
[0m09:44:54.541232 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:44:54.541483 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:54.541714 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:44:54.722851 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.596 seconds
[0m09:44:54.725168 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_3"
[0m09:44:54.726244 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_spi_subform_3
[0m09:44:54.729846 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_3"
[0m09:44:54.730514 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:44:54.730721 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: BEGIN
[0m09:44:54.731456 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:54.731648 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:44:54.731862 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 3 with readable column names
-- Questionnaire ID: 104454
-- Source file: questionnaire/spi/spi-subform-3.json




  
  

  
  

  
  

  
  
    
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_3"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:54.733913 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:54.735791 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:44:54.736014 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_tmp" rename to "qr_spi_subform_3"
[0m09:44:54.736891 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:54.737516 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:44:54.737682 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:44:54.737830 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: COMMIT
[0m09:44:54.738522 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:54.739770 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup"
[0m09:44:54.740181 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_3"
[0m09:44:54.740425 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_3__dbt_backup" cascade
[0m09:44:54.741012 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:54.741703 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_3: Close
[0m09:44:54.742002 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673e2d0>]}
[0m09:44:54.742322 [info ] [Thread-4 (]: 51 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_3  [[32mCREATE VIEW[0m in 0.62s]
[0m09:44:54.742601 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_spi_subform_3
[0m09:44:54.742792 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_start_ipc_s3
[0m09:44:54.743062 [info ] [Thread-4 (]: 55 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [RUN]
[0m09:44:54.743269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_3, now model.engage_analytics.qr_start_ipc_s3)
[0m09:44:54.743441 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_start_ipc_s3
[0m09:44:54.745909 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:44:54.746165 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:54.746353 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:44:54.751662 [debug] [Thread-1 (]: SQL status: SELECT 231 in 0.607 seconds
[0m09:44:54.754785 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_spi_subform_4"
[0m09:44:54.756370 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_spi_subform_4
[0m09:44:54.758577 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_spi_subform_4"
[0m09:44:54.759193 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:44:54.759387 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: BEGIN
[0m09:44:54.760045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:44:54.760305 [debug] [Thread-3 (]: SQL status: SELECT 111 in 0.610 seconds
[0m09:44:54.760506 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:44:54.763012 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:44:54.764136 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- SPI Subform 4 with readable column names
-- Questionnaire ID: 104394
-- Source file: questionnaire/spi/spi-subform-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as "spi_encounter_id_of_spi_sub_4",max(case when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk_",max(case when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8' then answer_value_text end) as "spi_in_a_few_days_i_would_like_to_meet_for_a_followup_",max(case when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904' then answer_value_text end) as "spi_person_1",max(case when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0' then answer_value_text end) as "spi_when_you_feel_a_suicidal_crisis_arising_go_through",max(case when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185' then answer_value_text end) as "spi_i_would_like_to_make_a_plan_that_will_help_you_man",max(case when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048' then answer_value_text end) as "spi_cce2de12cf6244ff84e89eb4d864d048",max(case when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri",max(case when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb' then answer_value_text end) as "spi_40fbe8d043804efcbb0426fc7d3714eb",max(case when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7' then answer_value_text end) as "spi_the_methods_i_have_thought_about_using_include",max(case when linkid = '808ba31c-cd29-4743-8801-dfce357d5956' then answer_value_text end) as "spi_person_1_11",max(case when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc' then answer_value_text end) as "spi_90cedcbfbf114dc3973342e6900a09fc",max(case when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031' then answer_value_text end) as "spi_92ab6e65f9bd47188af6f731425d3031",max(case when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3' then answer_value_text end) as "spi_9d203bac75fd4f31bed6073502a977f3",max(case when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54' then answer_value_text end) as "spi_additional_hotline_numbers_you_can_contact",max(case when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f' then answer_value_text end) as "spi_taking_pills_i_will_protect_myself_from_this_risk__16",max(case when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969' then answer_value_text end) as "spi_12d89dfd5e434f008446b3af23323969",max(case when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3' then answer_value_text end) as "spi_39de8b745cbc4225b27bc97e72f08af3",max(case when linkid = '437d9ea2-adb5-471a-828b-a0285a282217' then answer_value_text end) as "spi_437d9ea2adb5471a828ba0285a282217",max(case when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd' then answer_value_text end) as "spi_509b140eb1954696bc5ff2fc2d2f77dd",max(case when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7' then answer_value_text end) as "spi_53a575e3aa59408da0dd8df237b68bf7",max(case when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256' then answer_value_text end) as "spi_a6d066a2028649b0b68834696e7fb256",max(case when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4' then answer_value_text end) as "spi_ce56c71d9ea44c8e9e9ad1da93bac1d4",max(case when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect_",max(case when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77' then answer_value_text end) as "spi_person_1_25",max(case when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0' then answer_value_text end) as "spi_person_1_26",max(case when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0' then answer_value_text end) as "spi_beb4ad5f2fd84b80aa93aa9ff1896dd0",max(case when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46' then answer_value_text end) as "spi_c396a3af6f0d4a8ea42b4f47bbce5f46",max(case when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9' then answer_value_text end) as "spi_e45b778dee8c4ee981f48927006160f9",max(case when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003' then answer_value_text end) as "spi_your_local_hotline_number",max(case when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888' then answer_value_text end) as "spi_101d2b7f2b68407daa4930cb4dadc888",max(case when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0' then answer_value_text end) as "spi_14ec8995eee9416f83ad9f44631ac9b0",max(case when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564' then answer_value_text end) as "spi_18d8ee56ffd847119074126ef2cdc564",max(case when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by",max(case when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124' then answer_value_text end) as "spi_5324bdcebaaa45bf935aeb2f65bd7124",max(case when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488' then answer_value_text end) as "spi_68fa6f2e84ec4dbc900e10ede297c488",max(case when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4' then answer_value_text end) as "spi_8891cd7bad1c4030afe46752cd273cf4",max(case when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73' then answer_value_text end) as "spi_using_a_firearm_i_will_protect_myself_from_this_ri_38",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi' then answer_value_text end) as "spi_taskid_spi_navigator",max(case when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0' then answer_value_text end) as "spi_c631e361027c4e4db89448785a3e6dd0",max(case when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410' then answer_value_text end) as "spi_taskid_my_safety_plan_pdf",max(case when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871' then answer_value_text end) as "spi_a1c56f60b8234c15b99da315d2ca1871",max(case when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9' then answer_value_text end) as "spi_ae4fa455f173435abb1b4df1d1316bd9",max(case when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad' then answer_value_text end) as "spi_bc981d8a7f22450babab3acca810ccad",max(case when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db' then answer_value_text end) as "spi_c6c266cc1c8541c097ce9ab491be45db",max(case when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233' then answer_value_text end) as "spi_person_2",max(case when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7' then answer_value_text end) as "spi_7d8621a4dcc84f4892103fb7d0dcc3c7",max(case when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164' then answer_value_text end) as "spi_83661ebe71cf4eab88e3bfecbfe35164",max(case when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12' then answer_value_text end) as "spi_be88b02764b64c3cbf5936a94dc79b12",max(case when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de' then answer_value_text end) as "spi_c3b4cf6e385d40b793804de2f81463de",max(case when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso",max(case when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449' then answer_value_text end) as "spi_going_in_front_of_a_moving_vehicle_i_will_protect__53",max(case when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7' then answer_value_text end) as "spi_ff115c2695b94e0d87ed80817d438fc7",max(case when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596' then answer_value_text end) as "spi_656a57f8f6f04fc5b34771dd8d38f596",max(case when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7' then answer_value_text end) as "spi_f749685963bb4b2f8f7596e44e893bf7",max(case when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0' then answer_value_text end) as "spi_f8861b1c781f4f12b4c8f8110f0c2cc0",max(case when linkid = '15e5007d-028f-4644-8fb6-0346730c3101' then answer_value_text end) as "spi_15e5007d028f46448fb60346730c3101",max(case when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by",max(case when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_60",max(case when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e' then answer_value_text end) as "spi_2b2e05e90c11490cbbff278ba90d7b4e",max(case when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070' then answer_value_text end) as "spi_3e388595a32f46238c9f3c67bad04070",max(case when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123' then answer_value_text end) as "spi_62b0eb1746e54c50a133087cc190a123",max(case when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68' then answer_value_text end) as "spi_cutting_i_will_protect_myself_from_this_risk_by_64",max(case when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609' then answer_value_text end) as "spi_705df2d9af924f4fb51317e01d07b609",max(case when linkid = '7845c436-4904-41fa-9553-2c401935623b' then answer_value_text end) as "spi_7845c436490441fa95532c401935623b",max(case when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe' then answer_value_text end) as "spi_person_2_67",max(case when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95' then answer_value_text end) as "spi_person_2_68",max(case when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966' then answer_value_text end) as "spi_c802f463c8f54056bc458ab8d64a1966",max(case when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99' then answer_value_text end) as "spi_hanging_i_will_protect_myself_from_this_risk_by_70",max(case when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63' then answer_value_text end) as "spi_2a6c5feb8034418b8644142a5e31df63",max(case when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb' then answer_value_text end) as "spi_3785a2648bd544abbf088aa33735c0eb",max(case when linkid = '544a444d-b101-4d56-9351-00bca8ec749e' then answer_value_text end) as "spi_person_2_73",max(case when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea' then answer_value_text end) as "spi_603d1492316f497f967b5c4b1ab983ea",max(case when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f' then answer_value_text end) as "spi_9f3a622ad39b49b084e70bcf4f832a4f",max(case when linkid = 'e9c42647-eefb-42bd-9080-f83630729606' then answer_value_text end) as "spi_e9c42647eefb42bd9080f83630729606",max(case when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by",max(case when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d' then answer_value_text end) as "spi_ee5d4acfecf04e628924cff17a33679d",max(case when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e' then answer_value_text end) as "spi_fe2f09118ddc412ba3e6f216620d147e",max(case when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a' then answer_value_text end) as "spi_370c849b0e0042acbe9d3b4c719ac31a",max(case when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52' then answer_value_text end) as "spi_person_3",max(case when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb' then answer_value_text end) as "spi_08b5e17c5e144b19ac939e479cd2a2bb",max(case when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86' then answer_value_text end) as "spi_13321778b5d44b018eda610cf0007c86",max(case when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3' then answer_value_text end) as "spi_jumping_i_will_protect_myself_from_this_risk_by_84",max(case when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17' then answer_value_text end) as "spi_84018cd89134429c8dfefd6a16e4bd17",max(case when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer",max(case when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604' then answer_value_text end) as "spi_fdd7c3c3f2c343bd8a806b48aa2b9604",max(case when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4' then answer_value_text end) as "spi_8a9424b0c8934371b5c9bc0008be14b4",max(case when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af' then answer_value_text end) as "spi_a5d96f90cd914a5b8862c4e3f88694af",max(case when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3' then answer_value_text end) as "spi_person_3_90",max(case when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb' then answer_value_text end) as "spi_28b2e31aee4d4e998974b616145311eb",max(case when linkid = '53932020-eed8-46f4-8236-d548a6335a59' then answer_value_text end) as "spi_drowning_i_will_protect_myself_from_this_risk_by_92",max(case when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db' then answer_value_text end) as "spi_7e38a614b0a248eab7c7ca2bdc1f00db",max(case when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf' then answer_value_text end) as "spi_c1e99f8bb1ab46d1b205ecbbb4240fdf",max(case when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_95",max(case when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54' then answer_value_text end) as "spi_d4ebe78407d043128a46634c0e338a54",max(case when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47' then answer_value_text end) as "spi_53def3a1a7e5432695f22561c26ecb47",max(case when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b' then answer_value_text end) as "spi_2b96f1d93450423da277060fcfdadc6b",max(case when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5' then answer_value_text end) as "spi_person_4",max(case when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d' then answer_value_text end) as "spi_b36fdd5fccac457ca8eaf9497204ef1d",max(case when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_101",max(case when linkid = 'c5720a67-803f-4917-8261-3738de838418' then answer_value_text end) as "spi_other_ways_i_will_make_my_environment_safer_102",max(case when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5' then answer_value_text end) as "spi_person_3_103",max(case when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa' then answer_value_text end) as "spi_f952feaf7abc4f6fa3bcd10a43ea62fa",max(case when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6' then answer_value_text end) as "spi_bd7644ee28f14f43a65417fd5034d1f6",max(case when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090' then answer_value_text end) as "spi_72e5c1b77ce949bd834bd98b73ba7090",max(case when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33' then answer_value_text end) as "spi_person_4_107",max(case when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a' then answer_value_text end) as "spi_d82c6ae90516451391fa664686779d6a",max(case when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1' then answer_value_text end) as "spi_person_3_109",max(case when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807' then answer_value_text end) as "spi_fc5c673b41d4435286bb043c73ed9807",max(case when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49' then answer_value_text end) as "spi_0397084acd514b3a809d970a2406ea49",max(case when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972' then answer_value_text end) as "spi_6a273a9882ca4d36ade0ce98f7899972",max(case when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f' then answer_value_text end) as "spi_11aadd880cf948b2939d2b3e28191c5f",max(case when linkid = '57e87170-761c-4b57-a09c-d50cab02860c' then answer_value_text end) as "spi_57e87170761c4b57a09cd50cab02860c",max(case when linkid = '965b7874-dd24-4215-acd4-8d241a262638' then answer_value_text end) as "spi_965b7874dd244215acd48d241a262638",max(case when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb' then answer_value_text end) as "spi_bd62b64972094d329bbbdc2b2823aadb",max(case when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709' then answer_value_text end) as "spi_07c2e8dcb48b4bc7b21bc196cce32709",max(case when linkid = '83dfd82f-0277-459d-abe3-e8795750f288' then answer_value_text end) as "spi_person_5",max(case when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f' then answer_value_text end) as "spi_ae94969792ae476a96ccf8b0adc4221f",max(case when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2' then answer_value_text end) as "spi_2c7b6bd736f6495b9f41eb492c07c7b2",max(case when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_121",max(case when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897' then answer_value_text end) as "spi_fefdc90ffe1d4bfbaf9394df8c482897",max(case when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344' then answer_value_text end) as "spi_1fc8f8e7202248d2b41d4e8ad22af344",max(case when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c' then answer_value_text end) as "spi_8c1ac4fe1d7644368f34d315c6c17b9c",max(case when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d' then answer_value_text end) as "spi_person_5_125",max(case when linkid = 'df53c378-27fe-483d-a630-f7b171f72980' then answer_value_text end) as "spi_df53c37827fe483da630f7b171f72980",max(case when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660' then answer_value_text end) as "spi_e552afd32816446e9ff5e898bc813660",max(case when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_128",max(case when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369' then answer_value_text end) as "spi_person_4_129",max(case when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a' then answer_value_text end) as "spi_44f024678ee049f08da75e7ed827125a",max(case when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9' then answer_value_text end) as "spi_82d6b50b0bb240f694b17a4c58df43f9",max(case when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c' then answer_value_text end) as "spi_892337bdd7fd46a7bf7208e87c9f412c",max(case when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b' then answer_value_text end) as "spi_e4a1be29fe8b442391bc6b4f5d730e6b",max(case when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2' then answer_value_text end) as "spi_9f46e0ff05324105be360cfa9d0770f2",max(case when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8' then answer_value_text end) as "spi_86da79f044cb417dab20c7ecc6f8f7c8",max(case when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7' then answer_value_text end) as "spi_ce0fdd416b0941049998a04c5dd9a5b7",max(case when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0' then answer_value_text end) as "spi_3314932c64e44192b583eb31e87da1d0",max(case when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206' then answer_value_text end) as "spi_5e2ab0f5f5d94502befeaba770f0e206",max(case when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240' then answer_value_text end) as "spi_796f544054f84d69b961a5b7e6a63240",max(case when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478' then answer_value_text end) as "spi_9f531e6126cf4223865339c24d6dd478",max(case when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd' then answer_value_text end) as "spi_are_you_willing_to_share_your_plan_with_this_perso_141",max(case when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021' then answer_value_text end) as "spi_4d334b16ea16429994ed32e84ef97021",max(case when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf' then answer_value_text end) as "spi_895fad45c3b547c59edf5f9b9e793fbf",max(case when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc' then answer_value_text end) as "spi_92da95cc50dd4bf0acca4465c07d44cc",max(case when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd' then answer_value_text end) as "spi_person_5_145",max(case when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc' then answer_value_text end) as "spi_f1fef9d72ab94ead9c24c4dc9c7ed4cc",max(case when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2' then answer_value_text end) as "spi_40d6a87f94984cfdb2334610e6de08c2",max(case when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668' then answer_value_text end) as "spi_ac3206ddb60b4cb1a5593a770a685668",max(case when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21' then answer_value_text end) as "spi_f895ed4f50044da49d59c21293674b21",max(case when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8' then answer_value_text end) as "spi_faefef23d2e64777b6288f83921e8fd8",max(case when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c' then answer_value_text end) as "spi_62a0463889284aabb4901a33739b7a5c",max(case when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f' then answer_value_text end) as "spi_bfe595d6325f492ab3b6cc5541e18c3f",max(case when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa' then answer_value_text end) as "spi_40d8ef6402f042ae947877651bd26dfa",max(case when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3' then answer_value_text end) as "spi_249f5ce8ecc04e4396756b01ca1502a3",max(case when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27' then answer_value_text end) as "spi_9b1b11e8608f4ea9911b88aae467ac27",max(case when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4' then answer_value_text end) as "spi_dae7f411758d48009842fc0038a6b4a4",max(case when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14' then answer_value_text end) as "spi_0c308fef8ce54217a8d48e6ff00c8e14",max(case when linkid = '54b75d55-1c43-4552-acbf-d9754831add8' then answer_value_text end) as "spi_54b75d551c434552acbfd9754831add8",max(case when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c' then answer_value_text end) as "spi_9faa2b7818424326bf7f9975bf04dc2c",max(case when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f' then answer_value_text end) as "spi_a320b7874cba457f9c6067ff76c7020f",max(case when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc' then answer_value_text end) as "spi_706fc36fefef4bf9827e7dc100cc92bc",max(case when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a' then answer_value_text end) as "spi_a57b5b3412e54ec882157f316267323a",max(case when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75' then answer_value_text end) as "spi_6bbdb2cfe7f6443a8f4e841e16bb9b75",max(case when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e' then answer_value_text end) as "spi_d617b1e1ea224863a878627f6b81963e",max(case when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc' then answer_value_text end) as "spi_2cedd4dd15e549518674ea4d4eeb7cfc",max(case when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200' then answer_value_text end) as "spi_c0655b118f2147ed8ede95498c2e8200",max(case when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225' then answer_value_text end) as "spi_1895c0a7b0904f499b0c08dca9a7b225",max(case when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c' then answer_value_text end) as "spi_f311f3ca5537413488285e537bb26a9c",max(case when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268' then answer_value_text end) as "spi_1a00c7b7e80d4e908ed4efd8f6d96268",max(case when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e' then answer_value_text end) as "spi_527c0166cc354cc3a9d97eeb0a54635e",max(case when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed' then answer_value_text end) as "spi_41cce38aca5c4e24904a25b1027336ed",max(case when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5' then answer_value_text end) as "spi_e8726638cfdb40aeb72cf1d594f64de5",max(case when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f' then answer_value_text end) as "spi_6ac23c5d0035489585f233c2fbba8f3f",max(case when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99' then answer_value_text end) as "spi_e7ba8485515441b8ac1835410a83cd99",max(case when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81' then answer_value_text end) as "spi_06f9231a999b445982606fbbcdfc5d81",max(case when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444' then answer_value_text end) as "spi_d8615ac796b246a2b3a5b5b83945b444",max(case when linkid = '74d0f0df-e726-4c40-84ce-efece882818b' then answer_value_text end) as "spi_74d0f0dfe7264c4084ceefece882818b",max(case when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d' then answer_value_text end) as "spi_1d0ad82509de4018a680cd0e6bf0983d",max(case when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03' then answer_value_text end) as "spi_d5194db005464bd196d8d56457930c03",max(case when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131' then answer_value_text end) as "spi_9e11ce9790e842f2ba188c4f0720c131",max(case when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0' then answer_value_text end) as "spi_cb75bba90bd84dceba2fd1b21a97c2a0",max(case when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2' then answer_value_text end) as "spi_2f44652fdf2d476e933d75b6ed55f5f2",max(case when linkid = '7b51625b-73b9-472d-9c71-299beb26694f' then answer_value_text end) as "spi_7b51625b73b9472d9c71299beb26694f",max(case when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a' then answer_value_text end) as "spi_13e2f93482ed4b23af6e95523dc3746a",max(case when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248' then answer_value_text end) as "spi_ec54e447c9814dd2aaa4659f8e494248",max(case when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71' then answer_value_text end) as "spi_cf16ca6e8b1b467db807fc5d50339f71",max(case when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d' then answer_value_text end) as "spi_ce18eee3aa6444238db150fe7f00850d",max(case when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c' then answer_value_text end) as "spi_5a79866df1fb4bd8b4c4f18c982bef3c",max(case when linkid = '45772f3f-c610-408b-942b-359769945cf4' then answer_value_text end) as "spi_45772f3fc610408b942b359769945cf4",max(case when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111' then answer_value_text end) as "spi_cebffdf48fd14829884c41cc42bc0111",max(case when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0' then answer_value_text end) as "spi_7ca03155c9ec45e18cd05b86fa444ad0",max(case when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149' then answer_value_text end) as "spi_46c2861b70a94fdf94eae1a01cae3149",max(case when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d' then answer_value_text end) as "spi_8a5b1c7de3ef444385f1fa5213d89f8d",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12' then answer_value_text end) as "paracetamol",max(case when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98' then answer_value_text end) as "tiredness",max(case when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6' then answer_value_text end) as "watching_tv",max(case when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6' then answer_value_text end) as "wait_what",max(case when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by",max(case when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe' then answer_value_text end) as "sleeping",max(case when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f' then answer_value_text end) as "what",max(case when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264' then answer_value_text end) as "what_205",max(case when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d' then answer_value_text end) as "wait",max(case when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05' then answer_value_text end) as "wait_what_207",max(case when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13' then answer_value_text end) as "tiredness_208",max(case when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de' then answer_value_text end) as "toxins_i_will_protect_myself_from_this_risk_by_209",max(case when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8' then answer_value_text end) as "sleeping_210",max(case when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d' then answer_value_text end) as "socialize",max(case when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2' then answer_value_text end) as "yoga_playing_with_dog",max(case when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b' then answer_value_text end) as "watching_tv_213",max(case when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351' then answer_value_text end) as "video_games",max(case when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7' then answer_value_text end) as "wait_215",max(case when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba' then answer_value_text end) as "walking_in_the_park",max(case when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8' then answer_value_text end) as "none",max(case when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9' then answer_value_text end) as "20250204",max(case when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0' then answer_value_text end) as "taking_toxins",max(case when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a' then answer_value_text end) as "tiktok_dance_challenges",max(case when linkid = 'no-response-step-1' then answer_value_text end) as "no-response-step-1",max(case when linkid = 'no-response-step-1-review' then answer_value_text end) as "no-response-step-1-review",max(case when linkid = 'no-response-step-2' then answer_value_text end) as "no-response-step-2",max(case when linkid = 'no-response-step-2-review' then answer_value_text end) as "no-response-step-2-review",max(case when linkid = 'no-response-step-3' then answer_value_text end) as "no-response-step-3",max(case when linkid = 'no-response-step-3-review' then answer_value_text end) as "no-response-step-3-review",max(case when linkid = 'no-response-step-4' then answer_value_text end) as "no-response-step-4",max(case when linkid = 'no-response-step-4-review' then answer_value_text end) as "no-response-step-4-review",max(case when linkid = 'no-response-step-6a' then answer_value_text end) as "no-response-step-6a",max(case when linkid = 'no-response-step-6a-review' then answer_value_text end) as "no-response-step-6a-review",max(case when linkid = 'other-signs-step-1' then answer_value_text end) as "other-signs-step-1"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:54.765537 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_start_ipc_s1
[0m09:44:54.767630 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s1"
[0m09:44:54.768251 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:44:54.768443 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s1: BEGIN
[0m09:44:54.769168 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:54.769348 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:44:54.770005 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 1 with readable column names
-- Questionnaire ID: 55
-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as "ipc_s1_patient_age",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as "ipc_s1_patient_dob",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as "ipc_s1_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as "ipc_s1_in_the_past_6_months",max(case when linkid = 'f1.92.1' then answer_value_text end) as "ipc_s1_f1921",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as "ipc_s1_in_the_past_1_year",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as "ipc_s1_i_noticed_that_when_i_was_asking_about_important_p",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s1_did_you_complete_the_required_assessments_and_the_",max(case when linkid = 'f1.42.2' then answer_value_text end) as "ipc_s1_do_you_think_an_important_persons_death_is_connect",max(case when linkid = 'f1.68.2' then answer_value_text end) as "ipc_s1_are_you_and_someone_else_having_a_strong_disagreem",max(case when linkid = 'f1.69.2' then answer_value_text end) as "ipc_s1_briefly_tell_me_about_the_disagreement",max(case when linkid = 'f1.70.2' then answer_value_text end) as "ipc_s1_how_has_this_disagreement_been_affecting_you",max(case when linkid = 'f1.72.2' then answer_value_text end) as "ipc_s1_have_there_been_any_changes_in_your_life_that_are_",max(case when linkid = 'f1.73.2' then answer_value_text end) as "ipc_s1_what_was_the_change",max(case when linkid = 'f1.74.2' then answer_value_text end) as "ipc_s1_when_did_this_happen",max(case when linkid = 'f1.76.2' then answer_value_text end) as "ipc_s1_if_the_client_did_not_mention_any_close_relationsh",max(case when linkid = 'f1.78.2' then answer_value_text end) as "ipc_s1_would_you_say_you_have_close_relationships",max(case when linkid = 'f1.79.2' then answer_value_text end) as "ipc_s1_has_anything_changed_in_your_life_so_that_now_you_",max(case when linkid = 'f1.88.2' then answer_value_text end) as "ipc_s1_f1882",max(case when linkid = 'f1.89.2' then answer_value_text end) as "ipc_s1_select_the_possible_interpersonal_problem_areas_yo",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as "ipc_s1_your_most_distressing_current_symptoms_began",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as "ipc_s1_taskid_session_1_navigator",max(case when linkid = 'f1.40.2' then answer_value_text end) as "ipc_s1_f1402",max(case when linkid = 'f1.79.3' then answer_value_text end) as "ipc_s1_when_did_this_event_happen",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as "ipc_s1_is_there_anything_else_that_we_did_not_discuss_tha",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s1_taskid_session_2_navigator",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'f1.40.3' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or_",max(case when linkid = 'f1.43.2' then answer_value_text end) as "ipc_s1_tell_me_about_your_relationship_with_this_person_h",max(case when linkid = 'f1.69.3' then answer_value_text end) as "ipc_s1_when_did_this_disagreement_happen",max(case when linkid = 'f1.82.2' then answer_value_text end) as "ipc_s1_do_you_want_to_propose_an_interpersonal_formulatio",max(case when linkid = 'f1.87.2' then answer_value_text end) as "ipc_s1_do_you_agree_with_this",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as "ipc_s1_these_are_the_symptoms_you_said_you_are_currently_",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as "ipc_s1_taskid_mood_pdf",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as "ipc_s1_relationships_eg_talk_with_friends_or_vi",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as "ipc_s1_is_there_anything_that_could_get_in_the_way_of_you",max(case when linkid = 'f1.81.3' then answer_value_text end) as "ipc_s1_f1813",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_provider_pdf",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as "ipc_s1_work_on_my_relationship_with_my_parents_",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as "ipc_s1_f13931",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_client_pdf",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as "ipc_s1_of_these_symptoms_which_are_the_most_distressing",max(case when linkid = 'f1.81.4' then answer_value_text end) as "ipc_s1_f1814",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as "ipc_s1_earlier_than_that_you_noticed_symptoms",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as "ipc_s1_community_activities_eg_go_to_a_recreati",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as "ipc_s1_patient_name",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as "ipc_s1_f13932",max(case when linkid = 'f1.40.5' then answer_value_text end) as "ipc_s1_f1405",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as "ipc_s1_when_did_these_symptoms_begin",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as "ipc_s1_xxx",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "ipc_s1_yesterday_",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as "ipc_s1_patient_gender",max(case when linkid = 'f1.40.6' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__54",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as "ipc_s1_phq9_total",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as "ipc_s1_possible_problem_areas",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing_57",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as "ipc_s1_gad7_total",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as "ipc_s1_hobbies_eg_listen_to_music_play_video_ga",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as "ipc_s1_what_was_going_on_in_your_life_when_you_started_to",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s1_ptsd_total",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as "ipc_s1_zfgh",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as "ipc_s1_do_you_agree_with_this_summary",max(case when linkid = 'f1.40.8' then answer_value_text end) as "ipc_s1_f1408",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_mood_rating_session_1_score",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as "ipc_s1_what_about_before_that_was_there_a_time_before_in_",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as "ipc_s1_religionspirituality_eg_pray_or_go_to_se",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s1_mood_rating_total",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as "ipc_s1_person_1_is",max(case when linkid = 'f1.40.9' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__72",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as "ipc_s1_phq9_total_meaning",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as "ipc_s1_what_were_the_symptoms",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as "ipc_s1_with_my_pastor_",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as "ipc_s1_gad7_total_meaning",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as "ipc_s1_f13941",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as "ipc_s1_ptsd_total_meaning_toggle",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as "ipc_s1_when_did_you_notice_these_symptoms",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as "ipc_s1_other",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as "ipc_s1_mood_rating_comment",max(case when linkid = 'f1.38.4' then answer_value_text end) as "ipc_s1_f1384",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as "ipc_s1_f13942",max(case when linkid = 'f1.40.11' then answer_value_text end) as "ipc_s1_f14011",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as "ipc_s1_what_was_happening_then",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ipc_session_1",max(case when linkid = 'f1.40.12' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__87",max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as "ipc_s1_ex",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_89",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as "ipc_s1_person_2_is",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as "ipc_s1_f13951",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as "ipc_s1_f13952",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as "ipc_s1_gud",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_94",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as "ipc_s1_person_3_is",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as "ipc_s1_f13961",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as "ipc_s1_f13962",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_98",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as "ipc_s1_person_4_is",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as "seeing_someone_be_killed_or_seriously_injured",max(case when linkid = 'f1.38.3' then answer_value_text end) as "f1.38.3",max(case when linkid = 'f1.46.2' then answer_value_text end) as "f1.46.2",max(case when linkid = 'task-id-008' then answer_value_text end) as "task-id-008",max(case when linkid = 'task-id-009' then answer_value_text end) as "task-id-009",max(case when linkid = 'task-id-010' then answer_value_text end) as "task-id-010",max(case when linkid = 'task-id-012' then answer_value_text end) as "task-id-012"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:54.776497 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:44:54.776823 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:44:54.778531 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:44:54.779887 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:44:54.780094 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp" rename to "qr_spi_subform_4"
[0m09:44:54.780355 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp" rename to "qr_start_ipc_s1"
[0m09:44:54.782136 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:54.782795 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:44:54.782978 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:44:54.783129 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m09:44:54.783378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:44:54.784305 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:44:54.784533 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:44:54.784695 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m09:44:54.784878 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:54.786049 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup"
[0m09:44:54.786334 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m09:44:54.786518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:54.786700 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup" cascade
[0m09:44:54.787794 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup"
[0m09:44:54.788078 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m09:44:54.788250 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup" cascade
[0m09:44:54.788513 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:54.789190 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s1: Close
[0m09:44:54.789370 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:44:54.790020 [debug] [Thread-1 (]: On model.engage_analytics.qr_spi_subform_4: Close
[0m09:44:54.790364 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064093d0>]}
[0m09:44:54.790659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671e330>]}
[0m09:44:54.791036 [info ] [Thread-3 (]: 53 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:54.791890 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_start_ipc_s1
[0m09:44:54.792235 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_start_ipc_s4
[0m09:44:54.792956 [info ] [Thread-3 (]: 56 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [RUN]
[0m09:44:54.793236 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_start_ipc_s1, now model.engage_analytics.qr_start_ipc_s4)
[0m09:44:54.793426 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_start_ipc_s4
[0m09:44:54.796093 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:44:54.796385 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m09:44:54.796572 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:44:54.976894 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m09:44:54.978503 [info ] [Thread-1 (]: 52 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [[32mCREATE VIEW[0m in 0.65s]
[0m09:44:54.978920 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_spi_subform_4
[0m09:44:54.979156 [debug] [Thread-1 (]: Began running node model.engage_analytics.practitioners
[0m09:44:54.979403 [info ] [Thread-1 (]: 57 of 59 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m09:44:54.979661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_4, now model.engage_analytics.practitioners)
[0m09:44:54.979855 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.practitioners
[0m09:44:54.982130 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:54.982369 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m09:44:54.982615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:55.000020 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.017 seconds
[0m09:44:55.001080 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:55.001332 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m09:44:55.002029 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m09:44:55.002954 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m09:44:55.003981 [debug] [Thread-1 (]: Began executing node model.engage_analytics.practitioners
[0m09:44:55.006253 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:55.006549 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    
  
    

  create temporary table "practitioners__dbt_tmp094455005386"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

where p._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
)

  );
  
  
[0m09:44:55.008868 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m09:44:55.011405 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:55.011634 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: BEGIN
[0m09:44:55.012502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:55.012775 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:55.012956 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioners__dbt_tmp094455005386'
        
      order by ordinal_position

  
[0m09:44:55.016889 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m09:44:55.018984 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:55.019253 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:55.021458 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:44:55.023165 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:55.023374 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m09:44:55.025189 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m09:44:55.026367 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m09:44:55.027151 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:55.027360 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioners__dbt_tmp094455005386" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" ("id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role")
    (
        select "id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role"
        from "practitioners__dbt_tmp094455005386"
    )
  
[0m09:44:55.028273 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:44:55.029043 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:44:55.029241 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m09:44:55.029398 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m09:44:55.030245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:55.030740 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: Close
[0m09:44:55.031063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066454f0>]}
[0m09:44:55.031399 [info ] [Thread-1 (]: 57 of 59 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mINSERT 0 0[0m in 0.05s]
[0m09:44:55.031719 [debug] [Thread-1 (]: Finished running node model.engage_analytics.practitioners
[0m09:44:55.031958 [debug] [Thread-1 (]: Began running node model.engage_analytics.patient_anon
[0m09:44:55.032222 [info ] [Thread-1 (]: 58 of 59 START sql view model engage_analytics_engage_analytics_mart.patient_anon  [RUN]
[0m09:44:55.032487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioners, now model.engage_analytics.patient_anon)
[0m09:44:55.032669 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.patient_anon
[0m09:44:55.034515 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.patient_anon"
[0m09:44:55.035568 [debug] [Thread-1 (]: Began executing node model.engage_analytics.patient_anon
[0m09:44:55.037631 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.patient_anon"
[0m09:44:55.038222 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:44:55.038431 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: BEGIN
[0m09:44:55.038599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:55.051873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m09:44:55.052160 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:44:55.052453 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized patient view with masked PII fields for data sharing
-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number
-- Pulls phone numbers from registration data when available

with patient_with_registration as (
    select 
        p.*,
        r."phone-number" as registration_phone
    from "airbyte"."engage_analytics_engage_analytics_mart"."patient" p
    left join "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info" r on p.id = r.subject_patient_id
)

select 
    -- Use hashed ID for referential integrity while maintaining privacy
    MD5(p.id::text) as patient_id_hash,
    
    -- Demographic information (non-PII)
    p.gender,
    p.age_years,  -- Age instead of birth_date for privacy
    p.deceased,
    p.active,
    p.registration_date,
    
    -- Masked name fields
    'REDACTED' as name_family_masked,
    'REDACTED' as name_given_masked,
    
    -- Masked contact information (use registration phone if patient phone is null)
    CASE 
        WHEN COALESCE(p.phone_number, p.registration_phone) IS NOT NULL 
            AND LENGTH(COALESCE(p.phone_number, p.registration_phone)) >= 4
        THEN 'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, p.registration_phone), 4)
        ELSE 'NO PHONE'
    END as phone_number_masked,
    
    -- Location and organization (reference IDs only, no PII)
    p.location_id,
    p.practitioner_id,
    p.practitioner_organization_id,
    p.practitioner_careteam_id,
    
    -- Metadata
    p._airbyte_emitted_at,
    CURRENT_TIMESTAMP as anonymized_at

from patient_with_registration p
  );
[0m09:44:55.055353 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:55.057244 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:44:55.057453 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_tmp" rename to "patient_anon"
[0m09:44:55.058526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:55.059171 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:44:55.059354 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:44:55.059506 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: COMMIT
[0m09:44:55.060470 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:55.061733 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup"
[0m09:44:55.062010 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient_anon"
[0m09:44:55.062185 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."patient_anon__dbt_backup" cascade
[0m09:44:55.062861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:55.063637 [debug] [Thread-1 (]: On model.engage_analytics.patient_anon: Close
[0m09:44:55.063960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639a390>]}
[0m09:44:55.064295 [info ] [Thread-1 (]: 58 of 59 OK created sql view model engage_analytics_engage_analytics_mart.patient_anon  [[32mCREATE VIEW[0m in 0.03s]
[0m09:44:55.064587 [debug] [Thread-1 (]: Finished running node model.engage_analytics.patient_anon
[0m09:44:55.064784 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_registration_info_anon
[0m09:44:55.064998 [info ] [Thread-1 (]: 59 of 59 START sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [RUN]
[0m09:44:55.065260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient_anon, now model.engage_analytics.qr_registration_info_anon)
[0m09:44:55.065482 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_registration_info_anon
[0m09:44:55.067156 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_registration_info_anon"
[0m09:44:55.068046 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_registration_info_anon
[0m09:44:55.069993 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_registration_info_anon"
[0m09:44:55.070994 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:44:55.071206 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: BEGIN
[0m09:44:55.071511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:55.086856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:44:55.087150 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:44:55.087401 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp"
    
    
  as (
    

-- Anonymized registration info with masked PII fields
-- Masks: Unique ID, Names, DOB, Phone, Email, Physical address, Zip code, Medicaid number

select 
    -- Non-PII identifiers (hashed for referential integrity)
    MD5(qr_id::text) as qr_id_hash,
    questionnaire_id,
    MD5(subject_patient_id::text) as subject_patient_id_hash,
    encounter_id,
    author_practitioner_id,
    
    -- Location and organization references (non-PII)
    practitioner_location_id,
    practitioner_organization_id,
    practitioner_id,
    practitioner_careteam_id,
    
    -- Application metadata
    application_version,
    
    -- Masked PII fields
    'REDACTED' as registration_unique_id_masked,
    'REDACTED' as registration_first_name_masked,
    'REDACTED' as registration_middle_name_masked,
    'REDACTED' as registration_surname_masked,
    
    -- Age fields (keep age, mask DOB)
    registration_age,
    registration_age_6,
    registration_calculated_age,
    'REDACTED' as registration_date_of_birth_dob_masked,
    
    -- Masked contact information
    'REDACTED' as "email-address_masked",
    CASE 
        WHEN "phone-number" IS NOT NULL AND LENGTH("phone-number") >= 4
        THEN 'XXX-XXX-' || RIGHT("phone-number", 4)
        WHEN "phone-number" IS NOT NULL
        THEN 'XXX-XXX-' || "phone-number"
        ELSE 'NO PHONE'
    END as "phone-number_masked",
    'REDACTED' as "physical-address_masked",
    CASE 
        WHEN "zip-code" IS NOT NULL 
        THEN LEFT("zip-code", 3) || 'XX'
        ELSE NULL
    END as "zip-code_masked",
    
    -- Masked Medicaid information
    CASE 
        WHEN "do-you-have-medicaid" = 'Yes' 
        THEN 'Yes'
        ELSE "do-you-have-medicaid"
    END as "do-you-have-medicaid",
    'REDACTED' as "medicaid-number_masked",
    
    -- Non-PII demographic fields
    registration_which_of_the_following_best_represents_how_you_thi,
    registration_what_was_your_biological_sex_assigned_at_birth,
    "choice-gender-identity",
    "choice-pronouns",
    "other-best-represents-how-you-think-of-yourself",
    
    -- Service history (non-PII)
    registration_has_this_person_received_engage_services_in_the_pa,
    
    -- Date components (non-specific)
    registration_calculated_month,
    registration_calculated_year,
    
    -- Metadata
    CURRENT_TIMESTAMP as anonymized_at

from "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info"
  );
[0m09:44:55.089818 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:44:55.092691 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:44:55.092959 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_tmp" rename to "qr_registration_info_anon"
[0m09:44:55.093991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:55.094695 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:44:55.094916 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:44:55.095078 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: COMMIT
[0m09:44:55.096065 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:55.097265 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup"
[0m09:44:55.097540 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_registration_info_anon"
[0m09:44:55.097712 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_registration_info_anon"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_registration_info_anon__dbt_backup" cascade
[0m09:44:55.098306 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:55.098971 [debug] [Thread-1 (]: On model.engage_analytics.qr_registration_info_anon: Close
[0m09:44:55.099269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063383e0>]}
[0m09:44:55.099582 [info ] [Thread-1 (]: 59 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_registration_info_anon  [[32mCREATE VIEW[0m in 0.03s]
[0m09:44:55.099852 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_registration_info_anon
[0m09:44:55.162338 [debug] [Thread-2 (]: SQL status: SELECT 91 in 0.621 seconds
[0m09:44:55.163937 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:44:55.164441 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_start_ipc_s2
[0m09:44:55.166326 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s2"
[0m09:44:55.167274 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:44:55.167496 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: BEGIN
[0m09:44:55.168199 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:55.168401 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:44:55.168953 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 2 with readable column names
-- Questionnaire ID: 58
-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "ipc_s2_phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "ipc_s2_gad7_total_meaning",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s2_ptsd_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as "ipc_s2_phq9_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as "ipc_s2_summary_when_1",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as "ipc_s2_most_distressing_symptoms",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as "ipc_s2_selected_problem_area",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as "ipc_s2_ptsd_total_meaning_toggle",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as "ipc_s2_gad7_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s2_taskid_session_2_navigator",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as "ipc_s2_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s2_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s2_taskid_session_3_navigator",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as "ipc_s2_have_you_proposed_the_interpersonal_formulation_in",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_provider_pdf",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s2_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as "ipc_s2_a4a9cad504db44e59a9d0f1bf40ca840",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s2_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s2_747188c84fc043ea92b49baa32567f73",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as "ipc_s2_did_the_person_ever_hit_kick_push_or_slap_you",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as "ipc_s2_do_you_agree_with_this",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ipc_session_2",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s2_3d2ccf9a0e7b48a0854044d43b6dacfe",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area_28",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s2_6fb0c7a5a21143ecaf7b5f1079399133",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_mood_rating_session_1_score",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s2_did_you_ever_hit_kick_push_or_slap_the_person",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as "ipc_s2_do_you_still_think_that",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s2_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s2_232484cf1aee4bfaa66e61494587a16a",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s2_9ed77f2a0d5a434db153d8deadfbc3f8",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s2_3bfee97a6a0e4cd0bdb77ffa8d36191f",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree_37",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__39",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__40",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__41",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as "ipc_s2_287593c3417445afa99871d249230943",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s2_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s2_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s2_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s2_665e1595f16948159d24dac265f1809b",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s2_bc8f199a59f04184864db1c0befd26df",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s2_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s2_e17756cd48614dde859cf90241977246",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s2_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as "ipc_s2_is_any_of_the_2_question_above_is_true",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as "ipc_s2_2ef63cf4b37e4216a8e1db6d1b91cc2a",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s2_3e0b76f9090243bab8580b1505e9d168",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s2_9cc2834b0d2843d08811509995cfcdb8",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s2_a7f10195b8594670abbca2498c4fe45f",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__57",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s2_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s2_547a07c2f94c4956997f0439626d0251",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s2_6c1b2aa7f2444d5abfc6e0faef33bfe6",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s2_a77f07b379134708a35414e503a948f1",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s2_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s2_example_skills_63",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s2_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s2_eb8828db167447e7ba9ae3c161160b65",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s2_example_skills_66",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s2_4c95559d86ff4b87a271e52388072a53",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s2_bed17079d1e54bbeaf073d7b6a86243e",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__69",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__70",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__71",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s2_example_skills_72",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s2_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__77",max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__78",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__79",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = 'task-id-013' then answer_value_text end) as "task-id-013",max(case when linkid = 'task-id-014' then answer_value_text end) as "task-id-014",max(case when linkid = 'task-id-015' then answer_value_text end) as "task-id-015",max(case when linkid = 'task-id-016' then answer_value_text end) as "task-id-016",max(case when linkid = 'task-id-018' then answer_value_text end) as "task-id-018"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:55.174733 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:44:55.176406 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:44:55.176613 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp" rename to "qr_start_ipc_s2"
[0m09:44:55.178245 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:55.178998 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:44:55.179189 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:44:55.179405 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m09:44:55.180575 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:55.181737 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup"
[0m09:44:55.182001 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m09:44:55.182164 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup" cascade
[0m09:44:55.182807 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:55.183450 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s2: Close
[0m09:44:55.183762 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106669ee0>]}
[0m09:44:55.184280 [info ] [Thread-2 (]: 54 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [[32mCREATE VIEW[0m in 0.65s]
[0m09:44:55.184586 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_start_ipc_s2
[0m09:44:55.363568 [debug] [Thread-4 (]: SQL status: SELECT 97 in 0.617 seconds
[0m09:44:55.367662 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:44:55.368379 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_start_ipc_s3
[0m09:44:55.370546 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s3"
[0m09:44:55.371481 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:44:55.371730 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: BEGIN
[0m09:44:55.372522 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:55.372732 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:44:55.373277 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 3 with readable column names
-- Questionnaire ID: 208
-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as "ipc_s3_phq9_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as "ipc_s3_gad7_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as "ipc_s3_ptsd_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as "ipc_s3_ptsd_total_meaning",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s3_taskid_session_3_navigator",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s3_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s3_taskid_session_4_navigator",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as "ipc_s3_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s3_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_provider_pdf",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s3_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ipc_session_3",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_16",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s3_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_18",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s3_observation_id_of_mood_rating_session_3_score",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as "ipc_s3_1b59ddeb483d4b1baf53f3942204589a",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s3_did_you_ever_hit_kick_push_or_slap_the_personno",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s3_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_23",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as "ipc_s3_4554f4b2d15e47e7a10dd77939dd3afc",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_25",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as "ipc_s3_f9a9f4928eb84c718ec6f80ab596430b",max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__28",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__29",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__30",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s3_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as "ipc_s3_59744d4501004d62b1055cbecd973ffd",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as "ipc_s3_6b5fa4342fc34e4bad1189f6260a81f2",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as "ipc_s3_77fc70ba6cac494cb27a77ebce2289e5",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s3_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s3_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as "ipc_s3_has_anything_changed_since_the_last_time_we_met",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s3_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_40",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as "ipc_s3_4ad7384fa3324e4193180d3f9e540ee7",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as "ipc_s3_stage_identified_in_session_2",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_43",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_44",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_45",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as "ipc_s3_b24118e231c54e23af3a1722af72c299",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as "ipc_s3_68b3cbf5b9ef4da49ac1bcbc20f04473",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as "ipc_s3_9e995f48b09249b2a9e4c7e754e446e5",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__49",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s3_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as "ipc_s3_e8b8e5504d6542beacb92f4ac17c7f49",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s3_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s3_example_skills_53",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s3_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s3_example_skills_55",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_56",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_57",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_58",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s3_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_60",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as "ipc_s3_920de190557a423391a34bf293f18214",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as "ipc_s3_95121ef1bfe540ce841c524334644148",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as "ipc_s3_e1a13d53b867440f8622bccebf54f176",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s3_547a07c2f94c4956997f0439626d0251",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as "ipc_s3_8ac792f53f3c49d3a80063c662bf00cd",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__66",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__67",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__68",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s3_a77f07b379134708a35414e503a948f1",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s3_example_skills_70",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_71",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s3_4c95559d86ff4b87a271e52388072a53",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__73",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_77",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as "ipc_s3_8c82f7573f404b09bdf478ee376f75a8",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s3_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__82",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__83",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "gad7_total_meaning",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person_91",max(case when linkid = 'task-id-019' then answer_value_text end) as "task-id-019",max(case when linkid = 'task-id-020' then answer_value_text end) as "task-id-020",max(case when linkid = 'task-id-021' then answer_value_text end) as "task-id-021",max(case when linkid = 'task-id-022' then answer_value_text end) as "task-id-022",max(case when linkid = 'task-id-023' then answer_value_text end) as "task-id-023",max(case when linkid = 'task-id-024' then answer_value_text end) as "task-id-024"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:55.379173 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:44:55.380753 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:44:55.380942 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp" rename to "qr_start_ipc_s3"
[0m09:44:55.382400 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:55.383002 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:44:55.383185 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:44:55.383337 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m09:44:55.384397 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:55.385779 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup"
[0m09:44:55.386146 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m09:44:55.386331 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup" cascade
[0m09:44:55.386985 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:55.387691 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s3: Close
[0m09:44:55.387974 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665fce0>]}
[0m09:44:55.388289 [info ] [Thread-4 (]: 55 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m09:44:55.388555 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_start_ipc_s3
[0m09:44:55.395857 [debug] [Thread-3 (]: SQL status: SELECT 42 in 0.599 seconds
[0m09:44:55.397522 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:44:55.398760 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_start_ipc_s4
[0m09:44:55.400756 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s4"
[0m09:44:55.401532 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:44:55.401738 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s4: BEGIN
[0m09:44:55.402477 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:44:55.402663 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:44:55.403044 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 4 with readable column names
-- Questionnaire ID: 63
-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as "ipc_s4_phq9_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as "ipc_s4_gad7_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as "ipc_s4_ptsd_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s4_taskid_session_4_navigator",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_provider_pdf",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as "ipc_s4_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_client_pdf",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as "ipc_s4_what_we_know_is_that_symptoms_can_come_back_in_the",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s4_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as "ipc_s4_after_todays_session_i_can_refer_you_for_clinical_",max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as "ipc_s4_after_todays_session_i_will_be_referring_you_for_a",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri_14",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as "ipc_s4_how_does_it_make_you_feel_to_know_that_today_is_ou",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as "ipc_s4_how_do_you_feel_about_today_being_our_last_session",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as "ipc_s4_how_would_you_know_if_your_symptoms_are_coming_bac",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that_",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as "ipc_s4_please_select_how_you_would_like_to_proceed_with_t",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that__21",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s_22",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y_23",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s4_mood_rating_total",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as "ipc_s4_i_am_going_to_provide_you_with_our_agencys_contact",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard_28",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that_",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that__30",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as "ipc_s4_7fef53bc56db47ce8cba8efd4bcbc318",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "did_you_discuss_this_clients_severe_mental_health_screening",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "what_is_the_recommended_plan_to_address_the_probable_severe",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as "feeling_changed",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "referral_details_if_the_client_is_referred_out",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as "rerer",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as "20241031",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as "20250201",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as "is-connected-to-clinical-care-details",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as "is-connected-to-clinical-care-question"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m09:44:55.407265 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:55.410022 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:44:55.410228 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp" rename to "qr_start_ipc_s4"
[0m09:44:55.411430 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:55.412056 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:44:55.412235 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:44:55.412389 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m09:44:55.413184 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:55.414543 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup"
[0m09:44:55.414912 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m09:44:55.415112 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup" cascade
[0m09:44:55.415685 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:44:55.416434 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s4: Close
[0m09:44:55.416744 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106772690>]}
[0m09:44:55.417067 [info ] [Thread-3 (]: 56 of 59 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [[32mCREATE VIEW[0m in 0.62s]
[0m09:44:55.417441 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_start_ipc_s4
[0m09:44:55.418264 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:55.418485 [debug] [MainThread]: On master: BEGIN
[0m09:44:55.418632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:55.432700 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:44:55.433028 [debug] [MainThread]: On master: COMMIT
[0m09:44:55.433199 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:55.433346 [debug] [MainThread]: On master: COMMIT
[0m09:44:55.433838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:44:55.434085 [debug] [MainThread]: On master: Close
[0m09:44:55.434323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:55.434468 [debug] [MainThread]: Connection 'model.engage_analytics.qr_registration_info_anon' was properly closed.
[0m09:44:55.434597 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s2' was properly closed.
[0m09:44:55.434765 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s4' was properly closed.
[0m09:44:55.434889 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s3' was properly closed.
[0m09:44:55.435176 [info ] [MainThread]: 
[0m09:44:55.435350 [info ] [MainThread]: Finished running 18 incremental models, 41 view models in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m09:44:55.438661 [debug] [MainThread]: Command end result
[0m09:44:55.467251 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m09:44:55.468839 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m09:44:55.474652 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m09:44:55.474893 [info ] [MainThread]: 
[0m09:44:55.475113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:55.475292 [info ] [MainThread]: 
[0m09:44:55.475478 [info ] [MainThread]: Done. PASS=59 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=59
[0m09:44:55.475896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8330255, "process_in_blocks": "0", "process_kernel_time": 0.42393, "process_mem_max_rss": "140165120", "process_out_blocks": "0", "process_user_time": 2.653071}
[0m09:44:55.476161 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:55.476111 after 7.83 seconds
[0m09:44:55.476374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105602960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104300710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ebe30>]}
[0m09:44:55.476588 [debug] [MainThread]: Flushing usage events
[0m09:44:55.600801 [debug] [MainThread]: An error was encountered while trying to flush usage events

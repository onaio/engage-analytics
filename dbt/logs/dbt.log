[0m22:53:42.991100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121eb080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ea8a0>]}


============================== 22:53:43.012273 | f9dd0100-243c-4724-96b6-d7b09bf17d16 ==============================
[0m22:53:43.012273 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:53:43.012621 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '/Users/mberg/github/engage-analytics/dbt', 'warn_error': 'None', 'empty': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m22:53:43.050199 [info ] [MainThread]: dbt version: 1.10.11
[0m22:53:43.050456 [info ] [MainThread]: python version: 3.12.9
[0m22:53:43.050598 [info ] [MainThread]: python path: /Users/mberg/.venv/bin/python3
[0m22:53:43.050725 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m22:53:44.645136 [info ] [MainThread]: Using profiles dir at /Users/mberg/github/engage-analytics/dbt
[0m22:53:44.645489 [info ] [MainThread]: Using profiles.yml file at /Users/mberg/github/engage-analytics/dbt/profiles.yml
[0m22:53:44.645686 [info ] [MainThread]: Using dbt_project.yml file at /Users/mberg/github/engage-analytics/dbt/dbt_project.yml
[0m22:53:44.646533 [info ] [MainThread]: adapter type: postgres
[0m22:53:44.646731 [info ] [MainThread]: adapter version: 1.9.1
[0m22:53:44.701586 [info ] [MainThread]: Configuration:
[0m22:53:44.701819 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:53:44.701963 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:53:44.702088 [info ] [MainThread]: Required dependencies:
[0m22:53:44.702292 [debug] [MainThread]: Executing "git --help"
[0m22:53:44.710145 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:53:44.710765 [debug] [MainThread]: STDERR: "b''"
[0m22:53:44.710963 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:53:44.711200 [info ] [MainThread]: Connection:
[0m22:53:44.711450 [info ] [MainThread]:   host: localhost
[0m22:53:44.711588 [info ] [MainThread]:   port: 5432
[0m22:53:44.711790 [info ] [MainThread]:   user: postgres
[0m22:53:44.711964 [info ] [MainThread]:   database: airbyte
[0m22:53:44.712093 [info ] [MainThread]:   schema: engage_analytics
[0m22:53:44.712216 [info ] [MainThread]:   connect_timeout: 30
[0m22:53:44.712335 [info ] [MainThread]:   role: None
[0m22:53:44.712450 [info ] [MainThread]:   search_path: None
[0m22:53:44.712565 [info ] [MainThread]:   keepalives_idle: 0
[0m22:53:44.712677 [info ] [MainThread]:   sslmode: prefer
[0m22:53:44.712984 [info ] [MainThread]:   sslcert: None
[0m22:53:44.713179 [info ] [MainThread]:   sslkey: None
[0m22:53:44.713306 [info ] [MainThread]:   sslrootcert: None
[0m22:53:44.713424 [info ] [MainThread]:   application_name: dbt
[0m22:53:44.713543 [info ] [MainThread]:   retries: 1
[0m22:53:44.713898 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:53:44.754775 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:53:44.791045 [debug] [MainThread]: Using postgres connection "debug"
[0m22:53:44.791298 [debug] [MainThread]: On debug: select 1 as id
[0m22:53:44.791438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:44.812095 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m22:53:44.812730 [debug] [MainThread]: On debug: Close
[0m22:53:44.812931 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:53:44.813099 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:53:44.813467 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8698946, "process_in_blocks": "0", "process_kernel_time": 0.400666, "process_mem_max_rss": "150700032", "process_out_blocks": "0", "process_user_time": 1.791207}
[0m22:53:44.813749 [debug] [MainThread]: Command `dbt debug` succeeded at 22:53:44.813694 after 1.87 seconds
[0m22:53:44.813913 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:53:44.814101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bdc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11440ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11440cec0>]}
[0m22:53:44.814314 [debug] [MainThread]: Flushing usage events
[0m22:53:44.891088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:55.447404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c60c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056355b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056352b0>]}


============================== 22:53:55.451107 | 60babff9-1926-48bd-9fde-c42ddb949788 ==============================
[0m22:53:55.451107 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:53:55.451482 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt list', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '/Users/mberg/github/engage-analytics/dbt', 'introspect': 'True', 'write_json': 'True', 'empty': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m22:53:55.549985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60babff9-1926-48bd-9fde-c42ddb949788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102043350>]}
[0m22:53:55.581164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60babff9-1926-48bd-9fde-c42ddb949788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105664200>]}
[0m22:53:55.581961 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:53:55.630978 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/mberg/github/engage-analytics/dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/mberg/github/engage-analytics/dbt/dbt_packages/dbt_utils
[0m22:53:55.631540 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.21990784, "process_in_blocks": "0", "process_kernel_time": 0.12484, "process_mem_max_rss": "113033216", "process_out_blocks": "0", "process_user_time": 0.807946}
[0m22:53:55.631784 [debug] [MainThread]: Command `dbt list` failed at 22:53:55.631741 after 0.22 seconds
[0m22:53:55.631992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055111c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c80ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105664b00>]}
[0m22:53:55.632184 [debug] [MainThread]: Flushing usage events
[0m22:53:55.691885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:00.793596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947ce00>]}


============================== 22:54:00.797377 | 0f6fe83c-6f74-4bc0-ad4f-1aef7245b72c ==============================
[0m22:54:00.797377 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:54:00.797722 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '/Users/mberg/github/engage-analytics/dbt', 'use_colors': 'True', 'introspect': 'True', 'empty': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m22:54:00.855138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f6fe83c-6f74-4bc0-ad4f-1aef7245b72c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f6270>]}
[0m22:54:00.916976 [debug] [MainThread]: Set downloads directory='/var/folders/vy/qxzt2g1x6x52s1322tzx6r4r0000gn/T/dbt-downloads-kkf8v97v'
[0m22:54:00.917776 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:54:00.990438 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:54:00.990938 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:54:01.015436 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:54:01.017917 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:54:01.156214 [info ] [MainThread]: Installed from version 1.3.0
[0m22:54:01.156482 [info ] [MainThread]: Up to date!
[0m22:54:01.156684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0f6fe83c-6f74-4bc0-ad4f-1aef7245b72c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a2fc0>]}
[0m22:54:01.157544 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3980305, "process_in_blocks": "0", "process_kernel_time": 0.139034, "process_mem_max_rss": "112574464", "process_out_blocks": "0", "process_user_time": 0.749398}
[0m22:54:01.157891 [debug] [MainThread]: Command `dbt deps` succeeded at 22:54:01.157834 after 0.40 seconds
[0m22:54:01.158094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef8890>]}
[0m22:54:01.158267 [debug] [MainThread]: Flushing usage events
[0m22:54:01.237977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:05.529258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075aa930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289095e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128909310>]}


============================== 22:54:05.532270 | b223652e-96df-4240-a489-d51be45dc528 ==============================
[0m22:54:05.532270 [info ] [MainThread]: Running with dbt=1.10.11
[0m22:54:05.532594 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt list', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '/Users/mberg/github/engage-analytics/dbt', 'warn_error': 'None', 'empty': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m22:54:05.614046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b223652e-96df-4240-a489-d51be45dc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105523230>]}
[0m22:54:05.643913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b223652e-96df-4240-a489-d51be45dc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128dcd100>]}
[0m22:54:05.644439 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:54:05.691309 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m22:54:05.691817 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:54:05.692010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b223652e-96df-4240-a489-d51be45dc528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289aa810>]}
[0m22:54:06.258137 [error] [MainThread]: Encountered an error:
Compilation Error in model qr_ipc_56 (models/marts/qr_wide/qr_ipc_56.sql)
  Encountered unknown tag 'config'.
    line 1
      {% config(materialized='view') %}
[0m22:54:06.258558 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.76267004, "process_in_blocks": "0", "process_kernel_time": 0.127243, "process_mem_max_rss": "122372096", "process_out_blocks": "0", "process_user_time": 1.308743}
[0m22:54:06.258783 [debug] [MainThread]: Command `dbt list` failed at 22:54:06.258740 after 0.76 seconds
[0m22:54:06.258976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1286e5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1299342c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128eb6630>]}
[0m22:54:06.259153 [debug] [MainThread]: Flushing usage events
[0m22:54:06.570583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:30.181909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a212e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a20fe0>]}


============================== 23:21:30.185302 | 9509e2ac-181f-4eed-8f4b-eb74601ddf7f ==============================
[0m23:21:30.185302 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:21:30.185675 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m23:21:30.283172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9509e2ac-181f-4eed-8f4b-eb74601ddf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dbc680>]}
[0m23:21:30.312801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9509e2ac-181f-4eed-8f4b-eb74601ddf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e9e80>]}
[0m23:21:30.313649 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:21:30.364582 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:21:30.365196 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:21:30.365409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9509e2ac-181f-4eed-8f4b-eb74601ddf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113999ca0>]}
[0m23:21:30.920722 [error] [MainThread]: Encountered an error:
Compilation Error in model qr_ipc_56 (models/marts/qr_wide/qr_ipc_56.sql)
  unexpected '}'
    line 1
      {{ config(materialized='view') %}
[0m23:21:30.921192 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.7724172, "process_in_blocks": "0", "process_kernel_time": 0.130591, "process_mem_max_rss": "122798080", "process_out_blocks": "0", "process_user_time": 1.302217}
[0m23:21:30.921440 [debug] [MainThread]: Command `dbt compile` failed at 23:21:30.921395 after 0.77 seconds
[0m23:21:30.921641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113999cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11475b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148f9f10>]}
[0m23:21:30.921834 [debug] [MainThread]: Flushing usage events
[0m23:21:30.998639 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:41.469033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ba8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112421340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112421070>]}


============================== 23:21:41.472243 | 78d12aa9-faf1-4e3b-9185-df502829d5ea ==============================
[0m23:21:41.472243 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:21:41.472589 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select stg_questionnaire_response', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'introspect': 'True', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m23:21:41.556136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78d12aa9-faf1-4e3b-9185-df502829d5ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124fcd40>]}
[0m23:21:41.584844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78d12aa9-faf1-4e3b-9185-df502829d5ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111822cc0>]}
[0m23:21:41.585370 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:21:41.631681 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:21:41.632166 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:21:41.632362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78d12aa9-faf1-4e3b-9185-df502829d5ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112423bc0>]}
[0m23:21:42.172184 [error] [MainThread]: Encountered an error:
Compilation Error in model qr_ipc_56 (models/marts/qr_wide/qr_ipc_56.sql)
  unexpected '}'
    line 1
      {{ config(materialized='view') %}
[0m23:21:42.172688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73623145, "process_in_blocks": "0", "process_kernel_time": 0.112554, "process_mem_max_rss": "122404864", "process_out_blocks": "0", "process_user_time": 1.299609}
[0m23:21:42.172931 [debug] [MainThread]: Command `dbt run` failed at 23:21:42.172885 after 0.74 seconds
[0m23:21:42.173136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113541d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134c93d0>]}
[0m23:21:42.173386 [debug] [MainThread]: Flushing usage events
[0m23:21:42.232347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:05.758187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11077d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111721370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111721070>]}


============================== 23:22:05.761398 | 7ffb4d7f-3c42-405e-ad59-daf32d64176d ==============================
[0m23:22:05.761398 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:22:05.761731 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m23:22:05.843394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ffb4d7f-3c42-405e-ad59-daf32d64176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105d75c0>]}
[0m23:22:05.873514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ffb4d7f-3c42-405e-ad59-daf32d64176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a4500>]}
[0m23:22:05.874125 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:22:05.921184 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:22:05.921784 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:22:05.922022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ffb4d7f-3c42-405e-ad59-daf32d64176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105246cc0>]}
[0m23:22:06.469711 [error] [MainThread]: Encountered an error:
Compilation Error in model qr_ipc_57 (models/marts/qr_wide/qr_ipc_57.sql)
  unexpected '}'
    line 1
      {{ config(materialized='view') %}
[0m23:22:06.470144 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.74552244, "process_in_blocks": "0", "process_kernel_time": 0.125836, "process_mem_max_rss": "122257408", "process_out_blocks": "0", "process_user_time": 1.311321}
[0m23:22:06.470376 [debug] [MainThread]: Command `dbt compile` failed at 23:22:06.470332 after 0.75 seconds
[0m23:22:06.470618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117211f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11290af60>]}
[0m23:22:06.470805 [debug] [MainThread]: Flushing usage events
[0m23:22:06.537538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:22.127690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021cde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c5040>]}


============================== 23:22:22.130920 | 15be4fdc-a1dd-4f54-a5d4-5a155b12e006 ==============================
[0m23:22:22.130920 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:22:22.131268 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False', 'introspect': 'True', 'profiles_dir': '.', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m23:22:22.213705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15be4fdc-a1dd-4f54-a5d4-5a155b12e006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057263c0>]}
[0m23:22:22.244837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15be4fdc-a1dd-4f54-a5d4-5a155b12e006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe9f40>]}
[0m23:22:22.245499 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:22:22.292540 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:22:22.293091 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:22:22.293283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15be4fdc-a1dd-4f54-a5d4-5a155b12e006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec1ac0>]}
[0m23:22:23.023345 [error] [MainThread]: Encountered an error:
Parsing Error
  Failed to render models/sources/engage_dataset.yml from project engage_analytics: Parsing Error
    Env var required but not provided: 'DBT_DATABASE'
[0m23:22:23.023800 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.9318405, "process_in_blocks": "0", "process_kernel_time": 0.121611, "process_mem_max_rss": "123551744", "process_out_blocks": "0", "process_user_time": 1.495382}
[0m23:22:23.024063 [debug] [MainThread]: Command `dbt compile` failed at 23:22:23.024016 after 0.93 seconds
[0m23:22:23.024245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021cde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106833110>]}
[0m23:22:23.024432 [debug] [MainThread]: Flushing usage events
[0m23:22:23.087226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:36.080671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105511970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e213a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e210a0>]}


============================== 23:22:36.083862 | 772fac4f-c5a7-432c-a815-d7e3513765b8 ==============================
[0m23:22:36.083862 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:22:36.084172 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m23:22:36.167160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '772fac4f-c5a7-432c-a815-d7e3513765b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630fa40>]}
[0m23:22:36.197014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '772fac4f-c5a7-432c-a815-d7e3513765b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ec140>]}
[0m23:22:36.197579 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:22:36.245473 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:22:36.245994 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:22:36.246200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '772fac4f-c5a7-432c-a815-d7e3513765b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c7bc0>]}
[0m23:22:37.079482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '772fac4f-c5a7-432c-a815-d7e3513765b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3fcb0>]}
[0m23:22:37.125130 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:22:37.126711 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:22:37.143487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '772fac4f-c5a7-432c-a815-d7e3513765b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f13bf0>]}
[0m23:22:37.143796 [info ] [MainThread]: Found 84 models, 12 sources, 557 macros
[0m23:22:37.143968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772fac4f-c5a7-432c-a815-d7e3513765b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef6600>]}
[0m23:22:37.145986 [info ] [MainThread]: 
[0m23:22:37.146183 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:22:37.146323 [info ] [MainThread]: 
[0m23:22:37.146581 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:22:37.150225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m23:22:37.153550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m23:22:37.154743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_int'
[0m23:22:37.177301 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:22:37.177548 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m23:22:37.177768 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:22:37.178016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:37.178202 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:22:37.178407 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m23:22:37.179407 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m23:22:37.179582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:37.179763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:37.206659 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m23:22:37.206929 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m23:22:37.207163 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m23:22:37.207339 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:22:37.207532 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:22:37.207700 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:22:37.207878 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m23:22:37.208059 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m23:22:37.208229 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m23:22:37.211987 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m23:22:37.212199 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m23:22:37.212343 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m23:22:37.213077 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m23:22:37.213769 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m23:22:37.214344 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m23:22:37.215006 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m23:22:37.215220 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m23:22:37.215604 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m23:22:37.220180 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:37.220402 [debug] [MainThread]: On master: BEGIN
[0m23:22:37.220572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:37.228586 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:22:37.228826 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:37.229011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:22:37.232730 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:22:37.233372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772fac4f-c5a7-432c-a815-d7e3513765b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6e180>]}
[0m23:22:37.233673 [debug] [MainThread]: On master: ROLLBACK
[0m23:22:37.234076 [debug] [MainThread]: On master: Close
[0m23:22:37.236888 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m23:22:37.237115 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m23:22:37.237334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_careplans)
[0m23:22:37.237516 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m23:22:37.237764 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m23:22:37.237932 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_careteams)
[0m23:22:37.238103 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m23:22:37.238273 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_encounter)
[0m23:22:37.238504 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m23:22:37.238675 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m23:22:37.243056 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m23:22:37.243304 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m23:22:37.243487 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m23:22:37.246442 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m23:22:37.281154 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m23:22:37.284014 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m23:22:37.285029 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m23:22:37.285476 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m23:22:37.285679 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m23:22:37.285853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_organization_affiliations)
[0m23:22:37.286017 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m23:22:37.288392 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m23:22:37.288625 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m23:22:37.288843 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m23:22:37.289099 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m23:22:37.289486 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m23:22:37.289944 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m23:22:37.290279 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m23:22:37.290489 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_organizations
[0m23:22:37.290651 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m23:22:37.290830 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_patient
[0m23:22:37.291039 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_practitioner
[0m23:22:37.291300 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_organizations)
[0m23:22:37.291646 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m23:22:37.291824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_patient)
[0m23:22:37.292019 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_practitioner)
[0m23:22:37.292223 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_organizations
[0m23:22:37.292404 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m23:22:37.292575 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_patient
[0m23:22:37.292733 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m23:22:37.294996 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m23:22:37.295208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_practitioner_roles)
[0m23:22:37.297451 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m23:22:37.299463 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m23:22:37.299816 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m23:22:37.300258 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_organizations
[0m23:22:37.302541 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m23:22:37.302776 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_patient
[0m23:22:37.303129 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_organizations
[0m23:22:37.303325 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_practitioner
[0m23:22:37.303606 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_patient
[0m23:22:37.303804 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m23:22:37.304122 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_practitioner
[0m23:22:37.304281 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m23:22:37.304503 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_task
[0m23:22:37.304704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_questionnaire_response)
[0m23:22:37.304904 [debug] [Thread-3 (]: Began running node model.engage_analytics.unnested_careteams
[0m23:22:37.305177 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m23:22:37.305343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.stg_task)
[0m23:22:37.305505 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m23:22:37.305660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.unnested_careteams)
[0m23:22:37.305821 [debug] [Thread-1 (]: Began running node model.engage_analytics.encounters
[0m23:22:37.305979 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_task
[0m23:22:37.307654 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m23:22:37.307823 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m23:22:37.308007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.encounters)
[0m23:22:37.310103 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m23:22:37.312401 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m23:22:37.312650 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.encounters
[0m23:22:37.312881 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m23:22:37.315254 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:22:37.315493 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_task
[0m23:22:37.315776 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m23:22:37.315978 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m23:22:37.316255 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_task
[0m23:22:37.316440 [debug] [Thread-4 (]: Began running node model.engage_analytics.organization_affiliations
[0m23:22:37.316672 [debug] [Thread-3 (]: Began executing node model.engage_analytics.unnested_careteams
[0m23:22:37.316820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.317010 [debug] [Thread-2 (]: Began running node model.engage_analytics.organizations
[0m23:22:37.317199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.organization_affiliations)
[0m23:22:37.317510 [debug] [Thread-3 (]: Finished running node model.engage_analytics.unnested_careteams
[0m23:22:37.317756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.organizations)
[0m23:22:37.317931 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m23:22:37.318123 [debug] [Thread-3 (]: Began running node model.engage_analytics.patient
[0m23:22:37.318310 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.organizations
[0m23:22:37.320302 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m23:22:37.320515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.patient)
[0m23:22:37.322350 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:22:37.322676 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.patient
[0m23:22:37.322959 [debug] [Thread-2 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m23:22:37.325148 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m23:22:37.325385 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.325569 [debug] [Thread-4 (]: Began executing node model.engage_analytics.organization_affiliations
[0m23:22:37.325987 [debug] [Thread-4 (]: Finished running node model.engage_analytics.organization_affiliations
[0m23:22:37.326189 [debug] [Thread-4 (]: Began running node model.engage_analytics.practitioner_role
[0m23:22:37.326468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.practitioner_role)
[0m23:22:37.326661 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.practitioner_role
[0m23:22:37.328469 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m23:22:37.328695 [debug] [Thread-3 (]: Began executing node model.engage_analytics.patient
[0m23:22:37.329005 [debug] [Thread-3 (]: Finished running node model.engage_analytics.patient
[0m23:22:37.329302 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m23:22:37.329566 [debug] [Thread-4 (]: Began executing node model.engage_analytics.practitioner_role
[0m23:22:37.329798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.int_qr_answers_long)
[0m23:22:37.330283 [debug] [Thread-4 (]: Finished running node model.engage_analytics.practitioner_role
[0m23:22:37.330504 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_stg.stg_encounter" does not exist
LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                     ^

[0m23:22:37.330746 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m23:22:37.330967 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_header
[0m23:22:37.332711 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m23:22:37.332966 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.int_qr_header)
[0m23:22:37.333212 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_header
[0m23:22:37.334588 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m23:22:37.335525 [debug] [Thread-1 (]: On model.engage_analytics.encounters: Close
[0m23:22:37.335755 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_stg.stg_organizations" does not exist
LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                     ^

[0m23:22:37.336756 [debug] [Thread-2 (]: On model.engage_analytics.organizations: Close
[0m23:22:37.337529 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m23:22:37.337735 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_header
[0m23:22:37.338083 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m23:22:37.338530 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_header
[0m23:22:37.338888 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_tags
[0m23:22:37.339222 [debug] [Thread-4 (]: Began running node model.engage_analytics.current_practitioner_role
[0m23:22:37.339673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.int_qr_tags)
[0m23:22:37.339922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.current_practitioner_role)
[0m23:22:37.340150 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m23:22:37.340352 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m23:22:37.342291 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m23:22:37.344705 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m23:22:37.345147 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_tags
[0m23:22:37.345364 [debug] [Thread-4 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m23:22:37.345692 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_tags
[0m23:22:37.346053 [debug] [Thread-4 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m23:22:37.346289 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_104394
[0m23:22:37.346551 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_104453
[0m23:22:37.347213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.qr_ipc_104394)
[0m23:22:37.347497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.qr_ipc_104453)
[0m23:22:37.347729 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_104394
[0m23:22:37.347950 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_104453
[0m23:22:37.349789 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:22:37.351871 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:22:37.352149 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.352393 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.352574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.352794 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:22:37.356079 [debug] [Thread-2 (]: Database Error in model organizations (models/marts/resources/organizations.sql)
  relation "engage_analytics_engage_analytics_stg.stg_organizations" does not exist
  LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                       ^
[0m23:22:37.356399 [debug] [Thread-2 (]: Finished running node model.engage_analytics.organizations
[0m23:22:37.356614 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_104454
[0m23:22:37.356809 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.organizations' to be skipped because of status 'error'.  Reason: Database Error in model organizations (models/marts/resources/organizations.sql)
  relation "engage_analytics_engage_analytics_stg.stg_organizations" does not exist
  LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                       ^.
[0m23:22:37.357017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.qr_ipc_104454)
[0m23:22:37.357776 [debug] [Thread-1 (]: Database Error in model encounters (models/marts/resources/encounters.sql)
  relation "engage_analytics_engage_analytics_stg.stg_encounter" does not exist
  LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                       ^
[0m23:22:37.358264 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_104454
[0m23:22:37.358509 [debug] [Thread-1 (]: Finished running node model.engage_analytics.encounters
[0m23:22:37.360639 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:22:37.360927 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_104455
[0m23:22:37.361136 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.encounters' to be skipped because of status 'error'.  Reason: Database Error in model encounters (models/marts/resources/encounters.sql)
  relation "engage_analytics_engage_analytics_stg.stg_encounter" does not exist
  LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                       ^.
[0m23:22:37.361349 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.361675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.qr_ipc_104455)
[0m23:22:37.361933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.362129 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_104455
[0m23:22:37.364178 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:22:37.364476 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.364717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.365643 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.366536 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104394: Close
[0m23:22:37.366797 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.367960 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: Close
[0m23:22:37.368860 [debug] [Thread-3 (]: Database Error in model qr_ipc_104394 (models/marts/qr_wide/qr_ipc_104394.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.369576 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_104394
[0m23:22:37.369846 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_202
[0m23:22:37.370155 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104394, now model.engage_analytics.qr_ipc_202)
[0m23:22:37.370444 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_202
[0m23:22:37.372681 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:22:37.373665 [debug] [Thread-4 (]: Database Error in model qr_ipc_104453 (models/marts/qr_wide/qr_ipc_104453.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.373929 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_104394' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_104394 (models/marts/qr_wide/qr_ipc_104394.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.374162 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.374358 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.374651 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_104453
[0m23:22:37.374856 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.375081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.375857 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: Close
[0m23:22:37.376074 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_203
[0m23:22:37.377009 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: Close
[0m23:22:37.377234 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_104453' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_104453 (models/marts/qr_wide/qr_ipc_104453.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.378484 [debug] [Thread-2 (]: Database Error in model qr_ipc_104454 (models/marts/qr_wide/qr_ipc_104454.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.378724 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104453, now model.engage_analytics.qr_ipc_203)
[0m23:22:37.379779 [debug] [Thread-1 (]: Database Error in model qr_ipc_104455 (models/marts/qr_wide/qr_ipc_104455.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.380178 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_104454
[0m23:22:37.380386 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_203
[0m23:22:37.380615 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_104455
[0m23:22:37.380822 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_204
[0m23:22:37.382748 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:22:37.382991 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_104454' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_104454 (models/marts/qr_wide/qr_ipc_104454.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.383294 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_205
[0m23:22:37.383514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104454, now model.engage_analytics.qr_ipc_204)
[0m23:22:37.383740 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.383966 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_104455' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_104455 (models/marts/qr_wide/qr_ipc_104455.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.384158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104455, now model.engage_analytics.qr_ipc_205)
[0m23:22:37.384350 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_204
[0m23:22:37.384578 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.384781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.385049 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_205
[0m23:22:37.387024 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:22:37.388967 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: Close
[0m23:22:37.391342 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:22:37.391606 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.392186 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.393047 [debug] [Thread-3 (]: Database Error in model qr_ipc_202 (models/marts/qr_wide/qr_ipc_202.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.393244 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.393404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.393637 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_202
[0m23:22:37.394041 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_206
[0m23:22:37.394230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_202, now model.engage_analytics.qr_ipc_206)
[0m23:22:37.394388 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_206
[0m23:22:37.396261 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:22:37.396523 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_202' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_202 (models/marts/qr_wide/qr_ipc_202.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.396782 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.397151 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.397822 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.398632 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_203: Close
[0m23:22:37.399786 [debug] [Thread-4 (]: Database Error in model qr_ipc_203 (models/marts/qr_wide/qr_ipc_203.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.400086 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_203
[0m23:22:37.400293 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_207
[0m23:22:37.400553 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_203' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_203 (models/marts/qr_wide/qr_ipc_203.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.400828 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_203, now model.engage_analytics.qr_ipc_207)
[0m23:22:37.401130 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_207
[0m23:22:37.403328 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:22:37.403560 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.403722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.404956 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.405249 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.405480 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.406240 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: Close
[0m23:22:37.406950 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_204: Close
[0m23:22:37.407593 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: Close
[0m23:22:37.409650 [debug] [Thread-3 (]: Database Error in model qr_ipc_206 (models/marts/qr_wide/qr_ipc_206.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.410481 [debug] [Thread-2 (]: Database Error in model qr_ipc_204 (models/marts/qr_wide/qr_ipc_204.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.410774 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_206
[0m23:22:37.411077 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_204
[0m23:22:37.411972 [debug] [Thread-1 (]: Database Error in model qr_ipc_205 (models/marts/qr_wide/qr_ipc_205.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.412277 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.412628 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_208
[0m23:22:37.412915 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_206' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_206 (models/marts/qr_wide/qr_ipc_206.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.413253 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_209
[0m23:22:37.413539 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_205
[0m23:22:37.414263 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_207: Close
[0m23:22:37.414697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_206, now model.engage_analytics.qr_ipc_208)
[0m23:22:37.414934 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_204' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_204 (models/marts/qr_wide/qr_ipc_204.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.415106 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_204, now model.engage_analytics.qr_ipc_209)
[0m23:22:37.415307 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_210
[0m23:22:37.415812 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_208
[0m23:22:37.416126 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_205' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_205 (models/marts/qr_wide/qr_ipc_205.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.417009 [debug] [Thread-4 (]: Database Error in model qr_ipc_207 (models/marts/qr_wide/qr_ipc_207.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.417224 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_209
[0m23:22:37.417453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_205, now model.engage_analytics.qr_ipc_210)
[0m23:22:37.419629 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:22:37.419984 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_207
[0m23:22:37.421919 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:22:37.422162 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_210
[0m23:22:37.422339 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.422564 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_211
[0m23:22:37.422773 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_207' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_207 (models/marts/qr_wide/qr_ipc_207.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.422987 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.425092 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:22:37.425294 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.425485 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_207, now model.engage_analytics.qr_ipc_211)
[0m23:22:37.425723 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.425920 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.426218 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_211
[0m23:22:37.426500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.428577 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:22:37.428893 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.429064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.440526 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.440800 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.441627 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: Close
[0m23:22:37.442348 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_209: Close
[0m23:22:37.443445 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.443766 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.444755 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: Close
[0m23:22:37.445619 [debug] [Thread-3 (]: Database Error in model qr_ipc_208 (models/marts/qr_wide/qr_ipc_208.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.446327 [debug] [Thread-2 (]: Database Error in model qr_ipc_209 (models/marts/qr_wide/qr_ipc_209.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.447013 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_211: Close
[0m23:22:37.447297 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_208
[0m23:22:37.447522 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_209
[0m23:22:37.448314 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_212
[0m23:22:37.449066 [debug] [Thread-4 (]: Database Error in model qr_ipc_211 (models/marts/qr_wide/qr_ipc_211.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.449255 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_208' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_208 (models/marts/qr_wide/qr_ipc_208.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.449950 [debug] [Thread-1 (]: Database Error in model qr_ipc_210 (models/marts/qr_wide/qr_ipc_210.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.450259 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_221
[0m23:22:37.450522 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_208, now model.engage_analytics.qr_ipc_212)
[0m23:22:37.450798 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_211
[0m23:22:37.451003 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_209' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_209 (models/marts/qr_wide/qr_ipc_209.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.451234 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_210
[0m23:22:37.451396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_209, now model.engage_analytics.qr_ipc_221)
[0m23:22:37.451560 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_212
[0m23:22:37.451765 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_23451
[0m23:22:37.451945 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_211' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_211 (models/marts/qr_wide/qr_ipc_211.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.452143 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_54
[0m23:22:37.452290 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_221
[0m23:22:37.455639 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:22:37.455879 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_211, now model.engage_analytics.qr_ipc_23451)
[0m23:22:37.456088 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_210' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_210 (models/marts/qr_wide/qr_ipc_210.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.456279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_210, now model.engage_analytics.qr_ipc_54)
[0m23:22:37.457998 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:22:37.458205 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.458392 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_23451
[0m23:22:37.458578 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_54
[0m23:22:37.458768 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.458977 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.461111 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:22:37.462827 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:22:37.463024 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.463395 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.463662 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.463921 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.464099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.484125 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.484434 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.485256 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_23451: Close
[0m23:22:37.485443 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.485644 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.486373 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_221: Close
[0m23:22:37.487266 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_212: Close
[0m23:22:37.488416 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_54: Close
[0m23:22:37.490312 [debug] [Thread-1 (]: Database Error in model qr_ipc_54 (models/marts/qr_wide/qr_ipc_54.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.490734 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_54
[0m23:22:37.491646 [debug] [Thread-4 (]: Database Error in model qr_ipc_23451 (models/marts/qr_wide/qr_ipc_23451.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.491905 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_55
[0m23:22:37.492635 [debug] [Thread-2 (]: Database Error in model qr_ipc_221 (models/marts/qr_wide/qr_ipc_221.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.492825 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_54' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_54 (models/marts/qr_wide/qr_ipc_54.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.493526 [debug] [Thread-3 (]: Database Error in model qr_ipc_212 (models/marts/qr_wide/qr_ipc_212.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.493777 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_23451
[0m23:22:37.493981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_54, now model.engage_analytics.qr_ipc_55)
[0m23:22:37.494213 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_221
[0m23:22:37.494464 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_212
[0m23:22:37.494654 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_56
[0m23:22:37.494802 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_55
[0m23:22:37.494953 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_23451' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_23451 (models/marts/qr_wide/qr_ipc_23451.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.495155 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_57
[0m23:22:37.495331 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_58
[0m23:22:37.495492 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_23451, now model.engage_analytics.qr_ipc_56)
[0m23:22:37.497892 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:22:37.498191 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_221' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_221 (models/marts/qr_wide/qr_ipc_221.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.498389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_221, now model.engage_analytics.qr_ipc_57)
[0m23:22:37.498557 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_212, now model.engage_analytics.qr_ipc_58)
[0m23:22:37.498749 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_56
[0m23:22:37.498918 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.499114 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_212' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_212 (models/marts/qr_wide/qr_ipc_212.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.499272 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_57
[0m23:22:37.499415 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_58
[0m23:22:37.501307 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:22:37.501489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.503141 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:22:37.504755 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:22:37.504951 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.505314 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.505522 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.505676 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.505819 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.505956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.525779 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.526078 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.526288 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.527084 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: Close
[0m23:22:37.527366 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.528062 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_57: Close
[0m23:22:37.528728 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: Close
[0m23:22:37.529463 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: Close
[0m23:22:37.531593 [debug] [Thread-2 (]: Database Error in model qr_ipc_57 (models/marts/qr_wide/qr_ipc_57.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.531880 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_57
[0m23:22:37.532196 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_59
[0m23:22:37.532467 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_57, now model.engage_analytics.qr_ipc_59)
[0m23:22:37.532714 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_57' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_57 (models/marts/qr_wide/qr_ipc_57.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.533476 [debug] [Thread-3 (]: Database Error in model qr_ipc_58 (models/marts/qr_wide/qr_ipc_58.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.533692 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_59
[0m23:22:37.534453 [debug] [Thread-1 (]: Database Error in model qr_ipc_55 (models/marts/qr_wide/qr_ipc_55.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.535233 [debug] [Thread-4 (]: Database Error in model qr_ipc_56 (models/marts/qr_wide/qr_ipc_56.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.535500 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_58
[0m23:22:37.538862 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:22:37.539176 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_55
[0m23:22:37.539395 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_56
[0m23:22:37.539699 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_60
[0m23:22:37.539908 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.540111 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_58' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_58 (models/marts/qr_wide/qr_ipc_58.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.540323 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_61
[0m23:22:37.540505 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_62
[0m23:22:37.540681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_58, now model.engage_analytics.qr_ipc_60)
[0m23:22:37.540868 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.541052 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_55' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_55 (models/marts/qr_wide/qr_ipc_55.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.541312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_55, now model.engage_analytics.qr_ipc_61)
[0m23:22:37.541470 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_56, now model.engage_analytics.qr_ipc_62)
[0m23:22:37.541626 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_60
[0m23:22:37.541970 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_56' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_56 (models/marts/qr_wide/qr_ipc_56.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.542198 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_61
[0m23:22:37.542357 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_62
[0m23:22:37.544376 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:22:37.546189 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:22:37.547911 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:22:37.548116 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.548291 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.548497 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.548688 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.548844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.549042 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.550580 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.551578 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_59: Close
[0m23:22:37.552827 [debug] [Thread-2 (]: Database Error in model qr_ipc_59 (models/marts/qr_wide/qr_ipc_59.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.553144 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_59
[0m23:22:37.553355 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_63
[0m23:22:37.553537 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_59, now model.engage_analytics.qr_ipc_63)
[0m23:22:37.553695 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_63
[0m23:22:37.555582 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:22:37.555764 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.555918 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.556170 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_59' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_59 (models/marts/qr_wide/qr_ipc_59.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.561312 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.561599 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.561799 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.562522 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: Close
[0m23:22:37.563209 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_60: Close
[0m23:22:37.564064 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_62: Close
[0m23:22:37.564484 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.566459 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_63: Close
[0m23:22:37.567753 [debug] [Thread-2 (]: Database Error in model qr_ipc_63 (models/marts/qr_wide/qr_ipc_63.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.568587 [debug] [Thread-1 (]: Database Error in model qr_ipc_61 (models/marts/qr_wide/qr_ipc_61.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.568876 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_63
[0m23:22:37.569568 [debug] [Thread-4 (]: Database Error in model qr_ipc_62 (models/marts/qr_wide/qr_ipc_62.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.569814 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_61
[0m23:22:37.570486 [debug] [Thread-3 (]: Database Error in model qr_ipc_60 (models/marts/qr_wide/qr_ipc_60.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.570706 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_69
[0m23:22:37.570918 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_62
[0m23:22:37.571071 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_63' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_63 (models/marts/qr_wide/qr_ipc_63.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.571259 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_104394
[0m23:22:37.571454 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_60
[0m23:22:37.571658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_63, now model.engage_analytics.qr_ipc_69)
[0m23:22:37.571892 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_104453
[0m23:22:37.572106 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_61' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_61 (models/marts/qr_wide/qr_ipc_61.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.572286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_61, now model.engage_analytics.qr_104394)
[0m23:22:37.572481 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_104454
[0m23:22:37.572634 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_69
[0m23:22:37.572786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_62, now model.engage_analytics.qr_104453)
[0m23:22:37.572971 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_62' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_62 (models/marts/qr_wide/qr_ipc_62.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.573129 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_104394
[0m23:22:37.573278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_60, now model.engage_analytics.qr_104454)
[0m23:22:37.575297 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:22:37.575485 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_104453
[0m23:22:37.575676 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_60' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_60 (models/marts/qr_wide/qr_ipc_60.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.577587 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:22:37.577778 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_104454
[0m23:22:37.577943 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.579849 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:22:37.580099 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.583050 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:22:37.583249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.583427 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.583581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.583734 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.583990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.584298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.605580 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.605904 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.606153 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.606961 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: Close
[0m23:22:37.607140 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.607990 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: Close
[0m23:22:37.608669 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: Close
[0m23:22:37.609790 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: Close
[0m23:22:37.610992 [debug] [Thread-4 (]: Database Error in model qr_104453 (models/marts/qr_wide/qr_104453.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.612578 [debug] [Thread-2 (]: Database Error in model qr_ipc_69 (models/marts/qr_wide/qr_ipc_69.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.613375 [debug] [Thread-1 (]: Database Error in model qr_104394 (models/marts/qr_wide/qr_104394.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.613702 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_104453
[0m23:22:37.614386 [debug] [Thread-3 (]: Database Error in model qr_104454 (models/marts/qr_wide/qr_104454.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.614637 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_69
[0m23:22:37.614853 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_104394
[0m23:22:37.616101 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_1613532
[0m23:22:37.616333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104394, now model.engage_analytics.qr_1613532)
[0m23:22:37.615060 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_104455
[0m23:22:37.615770 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_1613531
[0m23:22:37.616510 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_1613532
[0m23:22:37.615488 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_104454
[0m23:22:37.616929 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104453, now model.engage_analytics.qr_104455)
[0m23:22:37.615254 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_104453' to be skipped because of status 'error'.  Reason: Database Error in model qr_104453 (models/marts/qr_wide/qr_104453.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.617302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_69, now model.engage_analytics.qr_1613531)
[0m23:22:37.620099 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:22:37.620459 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m23:22:37.620673 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_104455
[0m23:22:37.620932 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_ipc_69' to be skipped because of status 'error'.  Reason: Database Error in model qr_ipc_69 (models/marts/qr_wide/qr_ipc_69.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.621110 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_1613531
[0m23:22:37.621282 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.621476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104454, now model.engage_analytics.qr_1_month_follow_up)
[0m23:22:37.623790 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:22:37.624024 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_104394' to be skipped because of status 'error'.  Reason: Database Error in model qr_104394 (models/marts/qr_wide/qr_104394.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.625906 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:22:37.626138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.626301 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m23:22:37.626465 [debug] [Thread-4 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.626663 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_104454' to be skipped because of status 'error'.  Reason: Database Error in model qr_104454 (models/marts/qr_wide/qr_104454.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.626834 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.629346 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:22:37.629607 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.629918 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.630197 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.630588 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.634797 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.635964 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: Close
[0m23:22:37.637191 [debug] [Thread-1 (]: Database Error in model qr_1613532 (models/marts/qr_wide/qr_1613532.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.637535 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_1613532
[0m23:22:37.637916 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_202
[0m23:22:37.638180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613532, now model.engage_analytics.qr_202)
[0m23:22:37.638363 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_202
[0m23:22:37.640849 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:22:37.641089 [debug] [Thread-1 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.641293 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_1613532' to be skipped because of status 'error'.  Reason: Database Error in model qr_1613532 (models/marts/qr_wide/qr_1613532.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.641457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.642563 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.642768 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.648883 [debug] [Thread-4 (]: On model.engage_analytics.qr_104455: Close
[0m23:22:37.654483 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.655639 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m23:22:37.657324 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: Close
[0m23:22:37.658687 [debug] [Thread-4 (]: Database Error in model qr_104455 (models/marts/qr_wide/qr_104455.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.661289 [debug] [Thread-3 (]: Database Error in model qr_1_month_follow_up (models/marts/qr_wide/qr_1_month_follow_up.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.661804 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_104455
[0m23:22:37.662532 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m23:22:37.662857 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_203
[0m23:22:37.663068 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.663322 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_204
[0m23:22:37.663548 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_104455' to be skipped because of status 'error'.  Reason: Database Error in model qr_104455 (models/marts/qr_wide/qr_104455.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.663804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104455, now model.engage_analytics.qr_203)
[0m23:22:37.664598 [debug] [Thread-2 (]: Database Error in model qr_1613531 (models/marts/qr_wide/qr_1613531.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.665399 [debug] [Thread-1 (]: On model.engage_analytics.qr_202: Close
[0m23:22:37.665652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_204)
[0m23:22:37.666005 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_1_month_follow_up' to be skipped because of status 'error'.  Reason: Database Error in model qr_1_month_follow_up (models/marts/qr_wide/qr_1_month_follow_up.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.666290 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_203
[0m23:22:37.666639 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_1613531
[0m23:22:37.666885 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_204
[0m23:22:37.669908 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:22:37.670862 [debug] [Thread-1 (]: Database Error in model qr_202 (models/marts/qr_wide/qr_202.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.671152 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_205
[0m23:22:37.671380 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_1613531' to be skipped because of status 'error'.  Reason: Database Error in model qr_1613531 (models/marts/qr_wide/qr_1613531.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.674789 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:22:37.675116 [debug] [Thread-4 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.675496 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_202
[0m23:22:37.675730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613531, now model.engage_analytics.qr_205)
[0m23:22:37.676004 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.676181 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.676390 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_206
[0m23:22:37.676548 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_205
[0m23:22:37.676717 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_202' to be skipped because of status 'error'.  Reason: Database Error in model qr_202 (models/marts/qr_wide/qr_202.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.676886 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.677167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_202, now model.engage_analytics.qr_206)
[0m23:22:37.679785 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:22:37.680370 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_206
[0m23:22:37.680616 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.683893 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:22:37.684170 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.684574 [debug] [Thread-1 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.684935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.685620 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.686589 [debug] [Thread-4 (]: On model.engage_analytics.qr_203: Close
[0m23:22:37.688074 [debug] [Thread-4 (]: Database Error in model qr_203 (models/marts/qr_wide/qr_203.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.688452 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_203
[0m23:22:37.688730 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_207
[0m23:22:37.688954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_203, now model.engage_analytics.qr_207)
[0m23:22:37.689189 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_203' to be skipped because of status 'error'.  Reason: Database Error in model qr_203 (models/marts/qr_wide/qr_203.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.689383 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_207
[0m23:22:37.689813 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.692288 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:22:37.693077 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: Close
[0m23:22:37.693276 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.693801 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.694770 [debug] [Thread-3 (]: Database Error in model qr_204 (models/marts/qr_wide/qr_204.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.695077 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_204
[0m23:22:37.695299 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_208
[0m23:22:37.695559 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_204' to be skipped because of status 'error'.  Reason: Database Error in model qr_204 (models/marts/qr_wide/qr_204.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.695807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_204, now model.engage_analytics.qr_208)
[0m23:22:37.696249 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_208
[0m23:22:37.698651 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:22:37.698863 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.699028 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.699253 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.699613 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.700429 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: Close
[0m23:22:37.701296 [debug] [Thread-1 (]: On model.engage_analytics.qr_206: Close
[0m23:22:37.702917 [debug] [Thread-2 (]: Database Error in model qr_205 (models/marts/qr_wide/qr_205.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.703246 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_205
[0m23:22:37.703456 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_209
[0m23:22:37.703631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_205, now model.engage_analytics.qr_209)
[0m23:22:37.703784 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_209
[0m23:22:37.705931 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:22:37.706147 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.706313 [debug] [Thread-2 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.706492 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_205' to be skipped because of status 'error'.  Reason: Database Error in model qr_205 (models/marts/qr_wide/qr_205.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.707437 [debug] [Thread-1 (]: Database Error in model qr_206 (models/marts/qr_wide/qr_206.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.708253 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: Close
[0m23:22:37.708481 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.708737 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.709072 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_206
[0m23:22:37.710136 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: Close
[0m23:22:37.711087 [debug] [Thread-4 (]: Database Error in model qr_207 (models/marts/qr_wide/qr_207.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.711425 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_210
[0m23:22:37.711717 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_206' to be skipped because of status 'error'.  Reason: Database Error in model qr_206 (models/marts/qr_wide/qr_206.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.712626 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_207
[0m23:22:37.713650 [debug] [Thread-3 (]: Database Error in model qr_208 (models/marts/qr_wide/qr_208.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.713897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_206, now model.engage_analytics.qr_210)
[0m23:22:37.714208 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_211
[0m23:22:37.714463 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_208
[0m23:22:37.714628 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_207' to be skipped because of status 'error'.  Reason: Database Error in model qr_207 (models/marts/qr_wide/qr_207.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.714797 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_210
[0m23:22:37.714978 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_207, now model.engage_analytics.qr_211)
[0m23:22:37.715260 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_212
[0m23:22:37.715546 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_208' to be skipped because of status 'error'.  Reason: Database Error in model qr_208 (models/marts/qr_wide/qr_208.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.717799 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:22:37.718072 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_211
[0m23:22:37.718380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_208, now model.engage_analytics.qr_212)
[0m23:22:37.718668 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.721080 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:22:37.721297 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.721513 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_212
[0m23:22:37.721809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.722031 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.722817 [debug] [Thread-2 (]: On model.engage_analytics.qr_209: Close
[0m23:22:37.726182 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:22:37.726518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.727803 [debug] [Thread-2 (]: Database Error in model qr_209 (models/marts/qr_wide/qr_209.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.728011 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.728418 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_209
[0m23:22:37.728667 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.728943 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_221
[0m23:22:37.729305 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_209' to be skipped because of status 'error'.  Reason: Database Error in model qr_209 (models/marts/qr_wide/qr_209.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.729626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_209, now model.engage_analytics.qr_221)
[0m23:22:37.730294 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_221
[0m23:22:37.732762 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:22:37.732983 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.733174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.735193 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.736068 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: Close
[0m23:22:37.737240 [debug] [Thread-1 (]: Database Error in model qr_210 (models/marts/qr_wide/qr_210.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.737521 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_210
[0m23:22:37.737726 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_23451
[0m23:22:37.738012 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_210' to be skipped because of status 'error'.  Reason: Database Error in model qr_210 (models/marts/qr_wide/qr_210.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.738260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_210, now model.engage_analytics.qr_23451)
[0m23:22:37.738665 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_23451
[0m23:22:37.741322 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:22:37.741637 [debug] [Thread-1 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.741806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.742347 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.743184 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: Close
[0m23:22:37.743466 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.744048 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.744847 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: Close
[0m23:22:37.745620 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: Close
[0m23:22:37.747087 [debug] [Thread-3 (]: Database Error in model qr_212 (models/marts/qr_wide/qr_212.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.747413 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_212
[0m23:22:37.747632 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_54
[0m23:22:37.747833 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_212, now model.engage_analytics.qr_54)
[0m23:22:37.748666 [debug] [Thread-4 (]: Database Error in model qr_211 (models/marts/qr_wide/qr_211.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.749298 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_212' to be skipped because of status 'error'.  Reason: Database Error in model qr_212 (models/marts/qr_wide/qr_212.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.749494 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_54
[0m23:22:37.749792 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_211
[0m23:22:37.750730 [debug] [Thread-2 (]: Database Error in model qr_221 (models/marts/qr_wide/qr_221.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.753206 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:22:37.753409 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.753652 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_55
[0m23:22:37.753861 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_211' to be skipped because of status 'error'.  Reason: Database Error in model qr_211 (models/marts/qr_wide/qr_211.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.754137 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_221
[0m23:22:37.754337 [debug] [Thread-3 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.755302 [debug] [Thread-1 (]: On model.engage_analytics.qr_23451: Close
[0m23:22:37.755533 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_211, now model.engage_analytics.qr_55)
[0m23:22:37.755784 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_56
[0m23:22:37.755941 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.756105 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_221' to be skipped because of status 'error'.  Reason: Database Error in model qr_221 (models/marts/qr_wide/qr_221.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.756601 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_55
[0m23:22:37.756895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_221, now model.engage_analytics.qr_56)
[0m23:22:37.757839 [debug] [Thread-1 (]: Database Error in model qr_23451 (models/marts/qr_wide/qr_23451.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.760090 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:22:37.760306 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_56
[0m23:22:37.760545 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_23451
[0m23:22:37.760713 [debug] [Thread-4 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.762659 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:22:37.762888 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_57
[0m23:22:37.763047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.763381 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_23451' to be skipped because of status 'error'.  Reason: Database Error in model qr_23451 (models/marts/qr_wide/qr_23451.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.763559 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.763750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_23451, now model.engage_analytics.qr_57)
[0m23:22:37.764157 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.764419 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_57
[0m23:22:37.764642 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.767334 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:22:37.768218 [debug] [Thread-3 (]: On model.engage_analytics.qr_54: Close
[0m23:22:37.768432 [debug] [Thread-1 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.768959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.769875 [debug] [Thread-3 (]: Database Error in model qr_54 (models/marts/qr_wide/qr_54.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.770156 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_54
[0m23:22:37.770362 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_58
[0m23:22:37.770540 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_54, now model.engage_analytics.qr_58)
[0m23:22:37.770800 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_54' to be skipped because of status 'error'.  Reason: Database Error in model qr_54 (models/marts/qr_wide/qr_54.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.771046 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_58
[0m23:22:37.773557 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:22:37.773813 [debug] [Thread-3 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.773988 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.774706 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.775707 [debug] [Thread-4 (]: On model.engage_analytics.qr_55: Close
[0m23:22:37.775927 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.777094 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: Close
[0m23:22:37.777357 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.778471 [debug] [Thread-1 (]: On model.engage_analytics.qr_57: Close
[0m23:22:37.779299 [debug] [Thread-4 (]: Database Error in model qr_55 (models/marts/qr_wide/qr_55.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.779992 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_55
[0m23:22:37.780366 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_59
[0m23:22:37.780591 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_55, now model.engage_analytics.qr_59)
[0m23:22:37.780754 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_59
[0m23:22:37.781672 [debug] [Thread-1 (]: Database Error in model qr_57 (models/marts/qr_wide/qr_57.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.781921 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_55' to be skipped because of status 'error'.  Reason: Database Error in model qr_55 (models/marts/qr_wide/qr_55.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.785241 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:22:37.785505 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.785868 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_57
[0m23:22:37.786765 [debug] [Thread-2 (]: Database Error in model qr_56 (models/marts/qr_wide/qr_56.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.786997 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.787970 [debug] [Thread-3 (]: On model.engage_analytics.qr_58: Close
[0m23:22:37.788228 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_60
[0m23:22:37.788499 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_57' to be skipped because of status 'error'.  Reason: Database Error in model qr_57 (models/marts/qr_wide/qr_57.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.788755 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_56
[0m23:22:37.788961 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.789182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_57, now model.engage_analytics.qr_60)
[0m23:22:37.789458 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_61
[0m23:22:37.789940 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_56' to be skipped because of status 'error'.  Reason: Database Error in model qr_56 (models/marts/qr_wide/qr_56.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.790901 [debug] [Thread-3 (]: Database Error in model qr_58 (models/marts/qr_wide/qr_58.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.791156 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_60
[0m23:22:37.791350 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_56, now model.engage_analytics.qr_61)
[0m23:22:37.791639 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_58
[0m23:22:37.793955 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:22:37.794163 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_61
[0m23:22:37.794376 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_62
[0m23:22:37.794545 [debug] [Thread-1 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.794745 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_58' to be skipped because of status 'error'.  Reason: Database Error in model qr_58 (models/marts/qr_wide/qr_58.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.797019 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:22:37.797340 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_58, now model.engage_analytics.qr_62)
[0m23:22:37.797586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.797817 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.798020 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.798186 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_62
[0m23:22:37.798478 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.799248 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: Close
[0m23:22:37.801652 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:22:37.803012 [debug] [Thread-4 (]: Database Error in model qr_59 (models/marts/qr_wide/qr_59.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.803306 [debug] [Thread-3 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.803705 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_59
[0m23:22:37.803926 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.804200 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_63
[0m23:22:37.804490 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_59' to be skipped because of status 'error'.  Reason: Database Error in model qr_59 (models/marts/qr_wide/qr_59.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.804805 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_59, now model.engage_analytics.qr_63)
[0m23:22:37.805083 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_63
[0m23:22:37.805289 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.807544 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:22:37.808492 [debug] [Thread-1 (]: On model.engage_analytics.qr_60: Close
[0m23:22:37.808763 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.808980 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.810165 [debug] [Thread-1 (]: Database Error in model qr_60 (models/marts/qr_wide/qr_60.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.811153 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: Close
[0m23:22:37.811380 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.811544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.811812 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_60
[0m23:22:37.812533 [debug] [Thread-3 (]: On model.engage_analytics.qr_62: Close
[0m23:22:37.813220 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_69
[0m23:22:37.813464 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_60' to be skipped because of status 'error'.  Reason: Database Error in model qr_60 (models/marts/qr_wide/qr_60.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.814327 [debug] [Thread-2 (]: Database Error in model qr_61 (models/marts/qr_wide/qr_61.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.814632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_60, now model.engage_analytics.qr_69)
[0m23:22:37.815277 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_61
[0m23:22:37.816113 [debug] [Thread-3 (]: Database Error in model qr_62 (models/marts/qr_wide/qr_62.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.816287 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_69
[0m23:22:37.816497 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:22:37.816721 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_62
[0m23:22:37.816877 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_61' to be skipped because of status 'error'.  Reason: Database Error in model qr_61 (models/marts/qr_wide/qr_61.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.819148 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:22:37.819419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_61, now model.engage_analytics.qr_q_common_mental_health_symptoms)
[0m23:22:37.819652 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:22:37.819872 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_62' to be skipped because of status 'error'.  Reason: Database Error in model qr_62 (models/marts/qr_wide/qr_62.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.820075 [debug] [Thread-1 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.820271 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:22:37.820436 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.820617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_62, now model.engage_analytics.qr_q_financial_wellness_tool)
[0m23:22:37.820812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.823145 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:22:37.824041 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: Close
[0m23:22:37.824249 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:22:37.824571 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.826980 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:22:37.827283 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:37.828095 [debug] [Thread-4 (]: Database Error in model qr_63 (models/marts/qr_wide/qr_63.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.828300 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.828703 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_63
[0m23:22:37.828891 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:37.829108 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_q_planning_next_steps
[0m23:22:37.829414 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_63' to be skipped because of status 'error'.  Reason: Database Error in model qr_63 (models/marts/qr_wide/qr_63.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.829657 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_63, now model.engage_analytics.qr_q_planning_next_steps)
[0m23:22:37.829999 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_q_planning_next_steps
[0m23:22:37.833559 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:22:37.833821 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:22:37.834001 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:22:37.835232 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.836167 [debug] [Thread-1 (]: On model.engage_analytics.qr_69: Close
[0m23:22:37.837347 [debug] [Thread-1 (]: Database Error in model qr_69 (models/marts/qr_wide/qr_69.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.837677 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_69
[0m23:22:37.838043 [debug] [Thread-1 (]: Began running node model.engage_analytics.practitioners
[0m23:22:37.838311 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_69' to be skipped because of status 'error'.  Reason: Database Error in model qr_69 (models/marts/qr_wide/qr_69.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.838513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_69, now model.engage_analytics.practitioners)
[0m23:22:37.838852 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.839045 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.practitioners
[0m23:22:37.839204 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.839967 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_financial_wellness_tool: Close
[0m23:22:37.842066 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:22:37.842776 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: Close
[0m23:22:37.843364 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m23:22:37.844694 [debug] [Thread-2 (]: Database Error in model qr_q_common_mental_health_symptoms (models/marts/qr_wide/qr_q_common_mental_health_symptoms.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.845524 [debug] [Thread-3 (]: Database Error in model qr_q_financial_wellness_tool (models/marts/qr_wide/qr_q_financial_wellness_tool.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.845771 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                 ^

[0m23:22:37.845968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:37.846279 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:22:37.846555 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:22:37.847286 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: Close
[0m23:22:37.847707 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_q_common_mental_health_symptoms' to be skipped because of status 'error'.  Reason: Database Error in model qr_q_common_mental_health_symptoms (models/marts/qr_wide/qr_q_common_mental_health_symptoms.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.848917 [debug] [Thread-4 (]: Database Error in model qr_q_planning_next_steps (models/marts/qr_wide/qr_q_planning_next_steps.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^
[0m23:22:37.849192 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_q_financial_wellness_tool' to be skipped because of status 'error'.  Reason: Database Error in model qr_q_financial_wellness_tool (models/marts/qr_wide/qr_q_financial_wellness_tool.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.849463 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_q_planning_next_steps
[0m23:22:37.849852 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_q_planning_next_steps' to be skipped because of status 'error'.  Reason: Database Error in model qr_q_planning_next_steps (models/marts/qr_wide/qr_q_planning_next_steps.sql)
  relation "engage_analytics_engage_analytics_int.int_qr_answers_long" does not exist
  LINE 6:     from "airbyte"."engage_analytics_engage_analytics_int"."...
                   ^.
[0m23:22:37.854050 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "engage_analytics_engage_analytics_stg.stg_practitioner" does not exist
LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                     ^

[0m23:22:37.854768 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: Close
[0m23:22:37.855813 [debug] [Thread-1 (]: Database Error in model practitioners (models/marts/resources/practitioners.sql)
  relation "engage_analytics_engage_analytics_stg.stg_practitioner" does not exist
  LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                       ^
[0m23:22:37.856064 [debug] [Thread-1 (]: Finished running node model.engage_analytics.practitioners
[0m23:22:37.856294 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.practitioners' to be skipped because of status 'error'.  Reason: Database Error in model practitioners (models/marts/resources/practitioners.sql)
  relation "engage_analytics_engage_analytics_stg.stg_practitioner" does not exist
  LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                       ^.
[0m23:22:37.856544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:37.856840 [debug] [MainThread]: Connection 'model.engage_analytics.practitioners' was properly closed.
[0m23:22:37.856998 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_common_mental_health_symptoms' was properly closed.
[0m23:22:37.857125 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_financial_wellness_tool' was properly closed.
[0m23:22:37.857242 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_planning_next_steps' was properly closed.
[0m23:22:37.857475 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model practitioners (models/marts/resources/practitioners.sql)
    relation "engage_analytics_engage_analytics_stg.stg_practitioner" does not exist
    LINE 5:         from "airbyte"."engage_analytics_engage_analytics_st...
                         ^
[0m23:22:37.857816 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.8121608, "process_in_blocks": "0", "process_kernel_time": 0.218757, "process_mem_max_rss": "139739136", "process_out_blocks": "0", "process_user_time": 2.499909}
[0m23:22:37.858030 [debug] [MainThread]: Command `dbt compile` failed at 23:22:37.857993 after 1.81 seconds
[0m23:22:37.858209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e21550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbd0d0>]}
[0m23:22:37.858440 [debug] [MainThread]: Flushing usage events
[0m23:22:37.942260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:02.623692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1019221e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106309310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f3470>]}


============================== 23:23:02.626846 | 0eac0ae8-c62a-4548-bce8-abcacd193979 ==============================
[0m23:23:02.626846 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:23:02.627161 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select staging', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '.', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m23:23:02.710263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d2b7d0>]}
[0m23:23:02.741569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a73e90>]}
[0m23:23:02.742098 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:23:02.791091 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:23:02.853666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:02.853939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:02.872852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e43080>]}
[0m23:23:02.921339 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:23:02.922903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:23:02.937511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071509b0>]}
[0m23:23:02.937853 [info ] [MainThread]: Found 84 models, 12 sources, 557 macros
[0m23:23:02.938034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d1820>]}
[0m23:23:02.939442 [info ] [MainThread]: 
[0m23:23:02.939621 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:23:02.939748 [info ] [MainThread]: 
[0m23:23:02.940013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:02.942119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:23:02.967775 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:23:02.968060 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:23:02.968214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:02.984256 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m23:23:02.984947 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:23:02.985303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now create_airbyte_engage_analytics_engage_analytics_stg)
[0m23:23:02.985914 [debug] [ThreadPool]: Creating schema "database: "airbyte"
schema: "engage_analytics_engage_analytics_stg"
"
[0m23:23:02.988828 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:02.989030 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m23:23:02.989169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:02.997131 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:23:02.997352 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:02.997498 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "create_airbyte_engage_analytics_engage_analytics_stg"} */
create schema if not exists "engage_analytics_engage_analytics_stg"
[0m23:23:02.998225 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:23:02.998754 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_stg: COMMIT
[0m23:23:02.998917 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:02.999049 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_stg: COMMIT
[0m23:23:03.000056 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:23:03.000255 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_stg: Close
[0m23:23:03.002870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airbyte_engage_analytics_engage_analytics_stg, now list_airbyte_engage_analytics_engage_analytics_int)
[0m23:23:03.003143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m23:23:03.005989 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:03.006214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m23:23:03.007173 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:03.007343 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m23:23:03.008147 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:03.008291 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m23:23:03.008418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:03.008546 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m23:23:03.008661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:03.008893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:03.027102 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m23:23:03.027334 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m23:23:03.027512 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:03.027641 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m23:23:03.027787 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:03.027985 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m23:23:03.028140 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:03.028287 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m23:23:03.028481 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m23:23:03.030192 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:23:03.030905 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m23:23:03.031121 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:23:03.031347 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:23:03.031930 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m23:23:03.032079 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m23:23:03.032570 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m23:23:03.033059 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m23:23:03.033286 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m23:23:03.037749 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:03.037971 [debug] [MainThread]: On master: BEGIN
[0m23:23:03.038111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:03.046655 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:23:03.046898 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:03.047081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:23:03.048958 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:23:03.049628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c24e0>]}
[0m23:23:03.049875 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:03.050552 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:03.050788 [debug] [MainThread]: On master: BEGIN
[0m23:23:03.051600 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:23:03.051778 [debug] [MainThread]: On master: COMMIT
[0m23:23:03.051923 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:03.052054 [debug] [MainThread]: On master: COMMIT
[0m23:23:03.052551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:03.052760 [debug] [MainThread]: On master: Close
[0m23:23:03.055080 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m23:23:03.055369 [info ] [Thread-1 (]: 1 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m23:23:03.055596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_careplans)
[0m23:23:03.055863 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m23:23:03.056100 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m23:23:03.056259 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m23:23:03.056509 [info ] [Thread-2 (]: 2 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m23:23:03.064233 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m23:23:03.064482 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m23:23:03.064732 [info ] [Thread-3 (]: 3 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m23:23:03.065069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_careteams)
[0m23:23:03.065456 [info ] [Thread-4 (]: 4 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m23:23:03.065772 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_encounter)
[0m23:23:03.065989 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m23:23:03.066249 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m23:23:03.066431 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m23:23:03.066589 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m23:23:03.068955 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m23:23:03.069209 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m23:23:03.071374 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m23:23:03.091541 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m23:23:03.100626 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m23:23:03.101252 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m23:23:03.102943 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m23:23:03.103278 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m23:23:03.105946 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m23:23:03.106446 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m23:23:03.137055 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m23:23:03.137385 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:23:03.137787 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:23:03.138036 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m23:23:03.138283 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:23:03.138554 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m23:23:03.138783 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:23:03.138946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:03.139117 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m23:23:03.139267 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:03.139412 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m23:23:03.139662 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:03.139915 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:23:03.160736 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m23:23:03.161053 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:23:03.161252 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


  );
  
  
[0m23:23:03.161498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m23:23:03.161716 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m23:23:03.161953 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m23:23:03.162208 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:23:03.162416 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:23:03.162643 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:23:03.162874 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


  );
  
  
[0m23:23:03.163085 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  );
  
  
[0m23:23:03.163288 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

  );
  
  
[0m23:23:03.165768 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.004 seconds
[0m23:23:03.174271 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.011 seconds
[0m23:23:03.174644 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m23:23:03.175390 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m23:23:03.175595 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:23:03.175937 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:23:03.176125 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m23:23:03.176360 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m23:23:03.178960 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:03.179199 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:23:03.180138 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m23:23:03.180479 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m23:23:03.182309 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b61e0>]}
[0m23:23:03.182518 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c25a0>]}
[0m23:23:03.182856 [info ] [Thread-2 (]: 2 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mSELECT 11[0m in 0.12s]
[0m23:23:03.183384 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m23:23:03.183105 [info ] [Thread-4 (]: 4 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mSELECT 15[0m in 0.11s]
[0m23:23:03.183650 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m23:23:03.183941 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m23:23:03.184327 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_organizations
[0m23:23:03.184152 [info ] [Thread-2 (]: 5 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m23:23:03.184601 [info ] [Thread-4 (]: 6 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m23:23:03.184820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_organization_affiliations)
[0m23:23:03.185009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_organizations)
[0m23:23:03.185183 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m23:23:03.185342 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_organizations
[0m23:23:03.187908 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m23:23:03.190185 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m23:23:03.191058 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_organizations
[0m23:23:03.191280 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m23:23:03.192958 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m23:23:03.194885 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m23:23:03.195198 [debug] [Thread-3 (]: SQL status: SELECT 1082 in 0.032 seconds
[0m23:23:03.195985 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m23:23:03.196184 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:23:03.196386 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m23:23:03.196610 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:23:03.196821 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:23:03.197014 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m23:23:03.197238 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m23:23:03.197441 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:03.197647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:03.199335 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:23:03.199796 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m23:23:03.200089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776b6e0>]}
[0m23:23:03.200409 [info ] [Thread-3 (]: 3 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mSELECT 1082[0m in 0.13s]
[0m23:23:03.200671 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m23:23:03.200856 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_patient
[0m23:23:03.201065 [info ] [Thread-3 (]: 7 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m23:23:03.201264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_patient)
[0m23:23:03.201429 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_patient
[0m23:23:03.203896 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m23:23:03.204333 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_patient
[0m23:23:03.205926 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m23:23:03.206542 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:23:03.206810 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: BEGIN
[0m23:23:03.207015 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:23:03.207218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:03.207414 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:23:03.207605 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:23:03.207897 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:23:03.208125 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  );
  
  
[0m23:23:03.208393 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


  );
  
  
[0m23:23:03.211894 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.003 seconds
[0m23:23:03.212135 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.003 seconds
[0m23:23:03.213735 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m23:23:03.214514 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m23:23:03.214780 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:23:03.214996 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:23:03.215187 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m23:23:03.215384 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m23:23:03.215561 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:23:03.215757 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:23:03.215964 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  );
  
  
[0m23:23:03.216990 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:03.217262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:03.217694 [debug] [Thread-4 (]: On model.engage_analytics.stg_organizations: Close
[0m23:23:03.218073 [debug] [Thread-2 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m23:23:03.218457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b0ec0>]}
[0m23:23:03.218759 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107687290>]}
[0m23:23:03.219141 [info ] [Thread-4 (]: 6 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mSELECT 13[0m in 0.03s]
[0m23:23:03.219622 [info ] [Thread-2 (]: 5 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mSELECT 12[0m in 0.03s]
[0m23:23:03.219997 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_organizations
[0m23:23:03.220296 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m23:23:03.220533 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_practitioner
[0m23:23:03.220789 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m23:23:03.221056 [info ] [Thread-4 (]: 8 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m23:23:03.221338 [info ] [Thread-2 (]: 9 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m23:23:03.221588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_practitioner)
[0m23:23:03.221824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_practitioner_roles)
[0m23:23:03.222029 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m23:23:03.222224 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m23:23:03.224608 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m23:23:03.224867 [debug] [Thread-1 (]: SQL status: SELECT 588 in 0.061 seconds
[0m23:23:03.227206 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m23:23:03.228025 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m23:23:03.228319 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:23:03.228525 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m23:23:03.228834 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m23:23:03.230827 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m23:23:03.231097 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_practitioner
[0m23:23:03.232933 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m23:23:03.233143 [debug] [Thread-3 (]: SQL status: SELECT 400 in 0.017 seconds
[0m23:23:03.233339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:23:03.234065 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: COMMIT
[0m23:23:03.234445 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m23:23:03.234647 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:23:03.234828 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:23:03.235024 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:23:03.235198 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: COMMIT
[0m23:23:03.235453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107750b60>]}
[0m23:23:03.235637 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m23:23:03.235807 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m23:23:03.236187 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mSELECT 588[0m in 0.18s]
[0m23:23:03.236413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:03.236636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:03.236839 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:03.237069 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m23:23:03.237534 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: Close
[0m23:23:03.237724 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m23:23:03.238179 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e2f60>]}
[0m23:23:03.237982 [info ] [Thread-1 (]: 10 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m23:23:03.238536 [info ] [Thread-3 (]: 7 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mSELECT 400[0m in 0.04s]
[0m23:23:03.238807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_questionnaire_response)
[0m23:23:03.239091 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_patient
[0m23:23:03.239300 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m23:23:03.239553 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_task
[0m23:23:03.241559 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m23:23:03.241918 [info ] [Thread-3 (]: 11 of 11 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m23:23:03.242285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.stg_task)
[0m23:23:03.242525 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_task
[0m23:23:03.244788 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m23:23:03.245108 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m23:23:03.247173 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m23:23:03.247536 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_task
[0m23:23:03.249972 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m23:23:03.250250 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m23:23:03.250509 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m23:23:03.250728 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:23:03.250998 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:23:03.251238 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:23:03.251487 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  );
  
  
[0m23:23:03.251775 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


  );
  
  
[0m23:23:03.252047 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:23:03.252247 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m23:23:03.252559 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: BEGIN
[0m23:23:03.252740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:03.252906 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:03.255504 [debug] [Thread-2 (]: SQL status: SELECT 72 in 0.003 seconds
[0m23:23:03.255768 [debug] [Thread-4 (]: SQL status: SELECT 72 in 0.003 seconds
[0m23:23:03.256600 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m23:23:03.257322 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m23:23:03.257562 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:23:03.257777 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:23:03.257961 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m23:23:03.258128 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m23:23:03.259251 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:03.259438 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:03.259899 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m23:23:03.260321 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner: Close
[0m23:23:03.260638 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b4ad0>]}
[0m23:23:03.260887 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107812630>]}
[0m23:23:03.261271 [info ] [Thread-2 (]: 9 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mSELECT 72[0m in 0.04s]
[0m23:23:03.261983 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m23:23:03.261626 [info ] [Thread-4 (]: 8 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mSELECT 72[0m in 0.04s]
[0m23:23:03.262444 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_practitioner
[0m23:23:03.262658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:23:03.262890 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:23:03.263081 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:23:03.263286 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:23:03.263505 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  );
  
  
[0m23:23:03.263789 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_stg"."stg_task"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  );
  
  
[0m23:23:03.964929 [debug] [Thread-3 (]: SQL status: SELECT 18096 in 0.701 seconds
[0m23:23:03.965897 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: COMMIT
[0m23:23:03.966109 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:23:03.966296 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: COMMIT
[0m23:23:03.975702 [debug] [Thread-1 (]: SQL status: SELECT 2350 in 0.712 seconds
[0m23:23:03.976021 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m23:23:03.976904 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m23:23:03.977435 [debug] [Thread-3 (]: On model.engage_analytics.stg_task: Close
[0m23:23:03.977644 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:23:03.977851 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m23:23:03.978139 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107810950>]}
[0m23:23:03.978609 [info ] [Thread-3 (]: 11 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mSELECT 18096[0m in 0.74s]
[0m23:23:03.978930 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_task
[0m23:23:03.979117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:03.979550 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m23:23:03.979851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eac0ae8-c62a-4548-bce8-abcacd193979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078132c0>]}
[0m23:23:03.980143 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mSELECT 2350[0m in 0.74s]
[0m23:23:03.980401 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m23:23:03.981140 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:03.981341 [debug] [MainThread]: On master: BEGIN
[0m23:23:03.981476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:03.987799 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:23:03.987964 [debug] [MainThread]: On master: COMMIT
[0m23:23:03.988101 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:03.988225 [debug] [MainThread]: On master: COMMIT
[0m23:23:03.988638 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:03.988907 [debug] [MainThread]: On master: Close
[0m23:23:03.989152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:03.989288 [debug] [MainThread]: Connection 'model.engage_analytics.stg_questionnaire_response' was properly closed.
[0m23:23:03.989417 [debug] [MainThread]: Connection 'model.engage_analytics.stg_practitioner_roles' was properly closed.
[0m23:23:03.989535 [debug] [MainThread]: Connection 'model.engage_analytics.stg_task' was properly closed.
[0m23:23:03.989650 [debug] [MainThread]: Connection 'model.engage_analytics.stg_practitioner' was properly closed.
[0m23:23:03.989840 [info ] [MainThread]: 
[0m23:23:03.989995 [info ] [MainThread]: Finished running 11 incremental models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m23:23:03.990822 [debug] [MainThread]: Command end result
[0m23:23:04.017931 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:23:04.019493 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:23:04.023092 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m23:23:04.023297 [info ] [MainThread]: 
[0m23:23:04.023534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:04.023817 [info ] [MainThread]: 
[0m23:23:04.023997 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m23:23:04.024357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4336483, "process_in_blocks": "0", "process_kernel_time": 0.170134, "process_mem_max_rss": "133857280", "process_out_blocks": "0", "process_user_time": 1.259268}
[0m23:23:04.024593 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:04.024550 after 1.43 seconds
[0m23:23:04.024795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1019221e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f03e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105912fc0>]}
[0m23:23:04.024986 [debug] [MainThread]: Flushing usage events
[0m23:23:04.095411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:21.105651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039a3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e90d0>]}


============================== 23:23:21.109501 | 0da36088-fcf5-4ca8-9124-6112563c5a9f ==============================
[0m23:23:21.109501 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:23:21.109937 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select intermediate', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'empty': 'False', 'profiles_dir': '.', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m23:23:21.195028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7a060>]}
[0m23:23:21.226615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105934110>]}
[0m23:23:21.227199 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:23:21.276129 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:23:21.336765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:21.337077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:21.355462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107934a70>]}
[0m23:23:21.432497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:23:21.434800 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:23:21.447306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d30e0>]}
[0m23:23:21.447689 [info ] [MainThread]: Found 84 models, 12 sources, 557 macros
[0m23:23:21.447888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b5ca40>]}
[0m23:23:21.449224 [info ] [MainThread]: 
[0m23:23:21.449418 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:23:21.449559 [info ] [MainThread]: 
[0m23:23:21.449820 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:21.451812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:23:21.475652 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:23:21.475905 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:23:21.476054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:21.493946 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m23:23:21.494736 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:23:21.495097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now create_airbyte_engage_analytics_engage_analytics_int)
[0m23:23:21.495360 [debug] [ThreadPool]: Creating schema "database: "airbyte"
schema: "engage_analytics_engage_analytics_int"
"
[0m23:23:21.498200 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:21.498416 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m23:23:21.498557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:21.506510 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:23:21.506774 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:21.506917 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "create_airbyte_engage_analytics_engage_analytics_int"} */
create schema if not exists "engage_analytics_engage_analytics_int"
[0m23:23:21.507489 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m23:23:21.507977 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_int: COMMIT
[0m23:23:21.508126 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:21.508248 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_int: COMMIT
[0m23:23:21.509057 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:23:21.509329 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_int: Close
[0m23:23:21.511965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airbyte_engage_analytics_engage_analytics_int, now list_airbyte_engage_analytics_engage_analytics_int)
[0m23:23:21.512334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m23:23:21.515293 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:21.515635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m23:23:21.516557 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:21.516727 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m23:23:21.517532 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:21.517755 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m23:23:21.517895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:21.518031 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m23:23:21.518151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:21.518374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:21.534064 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m23:23:21.534259 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:21.534445 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:23:21.534722 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m23:23:21.534942 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:23:21.535132 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:21.535398 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:21.535568 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m23:23:21.535751 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m23:23:21.537176 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m23:23:21.537964 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m23:23:21.538214 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:23:21.538418 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:23:21.539068 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m23:23:21.539222 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m23:23:21.539737 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m23:23:21.540725 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m23:23:21.540891 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m23:23:21.545309 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:21.545531 [debug] [MainThread]: On master: BEGIN
[0m23:23:21.545669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:21.553295 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:23:21.553566 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:21.553804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:23:21.556219 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:23:21.556937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a4770>]}
[0m23:23:21.557188 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:21.557693 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:21.557853 [debug] [MainThread]: On master: BEGIN
[0m23:23:21.558610 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:23:21.558837 [debug] [MainThread]: On master: COMMIT
[0m23:23:21.558982 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:21.559107 [debug] [MainThread]: On master: COMMIT
[0m23:23:21.559590 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:21.559725 [debug] [MainThread]: On master: Close
[0m23:23:21.560981 [debug] [Thread-1 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m23:23:21.562226 [debug] [Thread-2 (]: Began running node model.engage_analytics.int_qr_header
[0m23:23:21.562569 [info ] [Thread-1 (]: 1 of 3 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m23:23:21.562817 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_tags
[0m23:23:21.563013 [info ] [Thread-2 (]: 2 of 3 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m23:23:21.563263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.int_qr_answers_long)
[0m23:23:21.563497 [info ] [Thread-3 (]: 3 of 3 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m23:23:21.563697 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.int_qr_header)
[0m23:23:21.563870 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m23:23:21.564031 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.int_qr_tags)
[0m23:23:21.564185 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.int_qr_header
[0m23:23:21.568037 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m23:23:21.568260 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m23:23:21.569707 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m23:23:21.578212 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m23:23:21.578764 [debug] [Thread-1 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m23:23:21.584279 [debug] [Thread-2 (]: Began executing node model.engage_analytics.int_qr_header
[0m23:23:21.595965 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_tags
[0m23:23:21.597523 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m23:23:21.599435 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m23:23:21.619177 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m23:23:21.619853 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:23:21.620053 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m23:23:21.620218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:21.620496 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:23:21.620696 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:23:21.620926 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m23:23:21.621169 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m23:23:21.621430 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:21.621607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:21.633010 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:23:21.633328 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:23:21.633601 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:23:21.633792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:23:21.633986 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:23:21.634254 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m23:23:21.634590 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:23:21.634784 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m23:23:21.635092 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m23:23:21.636606 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:21.675120 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m23:23:21.677593 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:23:21.679227 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:23:21.679591 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m23:23:21.679949 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m23:23:21.681296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:21.681591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:21.689824 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m23:23:21.690506 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m23:23:21.690762 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:23:21.690955 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:23:21.691202 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m23:23:21.691380 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m23:23:21.692504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:21.692834 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:21.696188 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m23:23:21.697452 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m23:23:21.700257 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:23:21.700655 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:23:21.700909 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m23:23:21.701131 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m23:23:21.701994 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:21.702236 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:21.703679 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m23:23:21.704445 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: Close
[0m23:23:21.705842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085027b0>]}
[0m23:23:21.706093 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108614080>]}
[0m23:23:21.706489 [info ] [Thread-1 (]: 1 of 3 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.14s]
[0m23:23:21.707235 [debug] [Thread-1 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m23:23:21.706964 [info ] [Thread-2 (]: 2 of 3 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.14s]
[0m23:23:21.707651 [debug] [Thread-2 (]: Finished running node model.engage_analytics.int_qr_header
[0m23:23:21.724079 [debug] [Thread-3 (]: SQL status: SELECT 2350 in 0.089 seconds
[0m23:23:21.726856 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m23:23:21.727109 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:23:21.727271 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m23:23:21.728803 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:21.729295 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: Close
[0m23:23:21.729606 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0da36088-fcf5-4ca8-9124-6112563c5a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863a630>]}
[0m23:23:21.730012 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mSELECT 2350[0m in 0.17s]
[0m23:23:21.730521 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_tags
[0m23:23:21.731536 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:21.731796 [debug] [MainThread]: On master: BEGIN
[0m23:23:21.731960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:21.738761 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:23:21.738985 [debug] [MainThread]: On master: COMMIT
[0m23:23:21.739123 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:21.739248 [debug] [MainThread]: On master: COMMIT
[0m23:23:21.739718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:21.739977 [debug] [MainThread]: On master: Close
[0m23:23:21.740214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:21.740358 [debug] [MainThread]: Connection 'model.engage_analytics.int_qr_answers_long' was properly closed.
[0m23:23:21.740476 [debug] [MainThread]: Connection 'model.engage_analytics.int_qr_header' was properly closed.
[0m23:23:21.740589 [debug] [MainThread]: Connection 'model.engage_analytics.int_qr_tags' was properly closed.
[0m23:23:21.740765 [info ] [MainThread]: 
[0m23:23:21.740914 [info ] [MainThread]: Finished running 1 incremental model, 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:23:21.741326 [debug] [MainThread]: Command end result
[0m23:23:21.765582 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:23:21.767074 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:23:21.770099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m23:23:21.770300 [info ] [MainThread]: 
[0m23:23:21.770486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:21.770630 [info ] [MainThread]: 
[0m23:23:21.770775 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:23:21.771070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.702243, "process_in_blocks": "0", "process_kernel_time": 0.164374, "process_mem_max_rss": "133808128", "process_out_blocks": "0", "process_user_time": 1.170722}
[0m23:23:21.771274 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:21.771237 after 0.70 seconds
[0m23:23:21.771474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108400800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a53d0>]}
[0m23:23:21.771643 [debug] [MainThread]: Flushing usage events
[0m23:23:21.825341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:50.072248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f095e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f092e0>]}


============================== 23:23:50.075424 | dfed165a-fdc5-4166-9bb5-d2a9ce86512d ==============================
[0m23:23:50.075424 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:23:50.075826 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select marts', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m23:23:50.164795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108179640>]}
[0m23:23:50.195856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a40db20>]}
[0m23:23:50.196458 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:23:50.242136 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:23:50.324083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:23:50.324376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:23:50.343213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a499070>]}
[0m23:23:50.397535 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:23:50.398995 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:23:50.413114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad559a0>]}
[0m23:23:50.413413 [info ] [MainThread]: Found 84 models, 12 sources, 557 macros
[0m23:23:50.413608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad2a600>]}
[0m23:23:50.416024 [info ] [MainThread]: 
[0m23:23:50.416233 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:23:50.416410 [info ] [MainThread]: 
[0m23:23:50.416664 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:50.420020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:23:50.444163 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:23:50.444471 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:23:50.444654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:50.465938 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m23:23:50.466733 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:23:50.467232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now create_airbyte_engage_analytics_engage_analytics_mart)
[0m23:23:50.467527 [debug] [ThreadPool]: Creating schema "database: "airbyte"
schema: "engage_analytics_engage_analytics_mart"
"
[0m23:23:50.470552 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:50.470796 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m23:23:50.470928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:50.477747 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:23:50.477997 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:50.478149 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "create_airbyte_engage_analytics_engage_analytics_mart"} */
create schema if not exists "engage_analytics_engage_analytics_mart"
[0m23:23:50.478677 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m23:23:50.479225 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_mart: COMMIT
[0m23:23:50.479404 [debug] [ThreadPool]: Using postgres connection "create_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:50.479537 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_mart: COMMIT
[0m23:23:50.480183 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:23:50.480396 [debug] [ThreadPool]: On create_airbyte_engage_analytics_engage_analytics_mart: Close
[0m23:23:50.483066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airbyte_engage_analytics_engage_analytics_mart, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m23:23:50.485824 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:50.486017 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m23:23:50.486213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:50.486551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m23:23:50.486932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_int'
[0m23:23:50.487988 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:50.488956 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:50.489136 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m23:23:50.489303 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m23:23:50.489460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:50.489591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:50.499164 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m23:23:50.499469 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:23:50.499666 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m23:23:50.499997 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m23:23:50.500131 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:23:50.500271 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m23:23:50.500439 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m23:23:50.500745 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:23:50.500944 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m23:23:50.501693 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:23:50.502324 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m23:23:50.502587 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m23:23:50.502840 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m23:23:50.503523 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m23:23:50.503713 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m23:23:50.504515 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m23:23:50.504665 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m23:23:50.505217 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m23:23:50.510925 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:50.511167 [debug] [MainThread]: On master: BEGIN
[0m23:23:50.511293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:50.518268 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:23:50.518504 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:50.518698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:23:50.520699 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m23:23:50.521564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959c470>]}
[0m23:23:50.521812 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:50.522356 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:50.522494 [debug] [MainThread]: On master: BEGIN
[0m23:23:50.523086 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:23:50.523260 [debug] [MainThread]: On master: COMMIT
[0m23:23:50.523403 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:50.523522 [debug] [MainThread]: On master: COMMIT
[0m23:23:50.523877 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:50.524032 [debug] [MainThread]: On master: Close
[0m23:23:50.525688 [debug] [Thread-1 (]: Began running node model.engage_analytics.encounters
[0m23:23:50.526042 [info ] [Thread-1 (]: 1 of 70 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m23:23:50.526355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.encounters)
[0m23:23:50.526563 [debug] [Thread-2 (]: Began running node model.engage_analytics.organization_affiliations
[0m23:23:50.526746 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.encounters
[0m23:23:50.526908 [debug] [Thread-3 (]: Began running node model.engage_analytics.organizations
[0m23:23:50.527093 [debug] [Thread-4 (]: Began running node model.engage_analytics.patient
[0m23:23:50.527320 [info ] [Thread-2 (]: 2 of 70 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m23:23:50.540363 [info ] [Thread-3 (]: 3 of 70 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m23:23:50.541653 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:23:50.541895 [info ] [Thread-4 (]: 4 of 70 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m23:23:50.542132 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.organization_affiliations)
[0m23:23:50.542310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.organizations)
[0m23:23:50.542584 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m23:23:50.542794 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.patient'
[0m23:23:50.542949 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m23:23:50.543096 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.organizations
[0m23:23:50.543248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:50.543394 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.patient
[0m23:23:50.545487 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m23:23:50.547085 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:23:50.549222 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m23:23:50.549521 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m23:23:50.549799 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:50.550094 [debug] [Thread-2 (]: Began executing node model.engage_analytics.organization_affiliations
[0m23:23:50.556628 [debug] [Thread-4 (]: Began executing node model.engage_analytics.patient
[0m23:23:50.602890 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.060 seconds
[0m23:23:50.612994 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m23:23:50.613810 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:23:50.616065 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m23:23:50.616357 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.066 seconds
[0m23:23:50.616862 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m23:23:50.617820 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m23:23:50.618303 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:23:50.618552 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m23:23:50.618752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:50.619145 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:23:50.619314 [debug] [Thread-4 (]: On model.engage_analytics.patient: BEGIN
[0m23:23:50.619469 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:23:50.619698 [debug] [Thread-3 (]: Began executing node model.engage_analytics.organizations
[0m23:23:50.621532 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m23:23:50.622007 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:23:50.622193 [debug] [Thread-3 (]: On model.engage_analytics.organizations: BEGIN
[0m23:23:50.623427 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:50.623666 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:23:50.623861 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

  );
  
  
[0m23:23:50.624812 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m23:23:50.625674 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:23:50.625864 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m23:23:50.626621 [debug] [Thread-3 (]: SQL status: SELECT 13 in 0.003 seconds
[0m23:23:50.634993 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m23:23:50.635271 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m23:23:50.635521 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m23:23:50.635715 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:23:50.636501 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:23:50.636752 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m23:23:50.636976 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:23:50.637166 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m23:23:50.637353 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m23:23:50.637526 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:23:50.637692 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

  );
  
  
[0m23:23:50.638228 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_mart"."patient"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


  );
  
  
[0m23:23:50.638524 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:50.639541 [debug] [Thread-3 (]: On model.engage_analytics.organizations: Close
[0m23:23:50.639807 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:23:50.641843 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m23:23:50.643046 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebec00>]}
[0m23:23:50.643429 [debug] [Thread-1 (]: Began executing node model.engage_analytics.encounters
[0m23:23:50.645399 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m23:23:50.645646 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.007 seconds
[0m23:23:50.645991 [info ] [Thread-3 (]: 3 of 70 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mSELECT 13[0m in 0.10s]
[0m23:23:50.646757 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m23:23:50.647032 [debug] [Thread-3 (]: Finished running node model.engage_analytics.organizations
[0m23:23:50.647245 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:23:50.647448 [debug] [Thread-3 (]: Began running node model.engage_analytics.practitioner_role
[0m23:23:50.647658 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:23:50.647854 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m23:23:50.648076 [info ] [Thread-3 (]: 5 of 70 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m23:23:50.648265 [debug] [Thread-1 (]: On model.engage_analytics.encounters: BEGIN
[0m23:23:50.648490 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.practitioner_role)
[0m23:23:50.648732 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.practitioner_role
[0m23:23:50.650774 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m23:23:50.650999 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:23:50.651280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m23:23:50.651749 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: Close
[0m23:23:50.651967 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:23:50.652343 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

  );
  
  
[0m23:23:50.652682 [debug] [Thread-3 (]: Began executing node model.engage_analytics.practitioner_role
[0m23:23:50.652991 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6e8f20>]}
[0m23:23:50.654830 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m23:23:50.655064 [debug] [Thread-4 (]: SQL status: SELECT 400 in 0.016 seconds
[0m23:23:50.655389 [info ] [Thread-2 (]: 2 of 70 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mSELECT 12[0m in 0.11s]
[0m23:23:50.656245 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m23:23:50.656589 [debug] [Thread-2 (]: Finished running node model.engage_analytics.organization_affiliations
[0m23:23:50.656803 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:23:50.657022 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:23:50.657217 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_104394
[0m23:23:50.657447 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m23:23:50.657626 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m23:23:50.657846 [info ] [Thread-2 (]: 6 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_104394 .. [RUN]
[0m23:23:50.658120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:50.658397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.qr_104394)
[0m23:23:50.658754 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_104394
[0m23:23:50.658960 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:50.664457 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:23:50.664972 [debug] [Thread-4 (]: On model.engage_analytics.patient: Close
[0m23:23:50.665214 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:50.665474 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:23:50.665685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:50.665947 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107781af0>]}
[0m23:23:50.666168 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:23:50.666610 [info ] [Thread-4 (]: 4 of 70 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mSELECT 400[0m in 0.12s]
[0m23:23:50.666906 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

  );
  
  
[0m23:23:50.667260 [debug] [Thread-4 (]: Finished running node model.engage_analytics.patient
[0m23:23:50.667546 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_104453
[0m23:23:50.667842 [info ] [Thread-4 (]: 7 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_104453 .. [RUN]
[0m23:23:50.668066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.qr_104453)
[0m23:23:50.668236 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_104453
[0m23:23:50.671357 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:23:50.671596 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:50.671814 [debug] [Thread-3 (]: SQL status: SELECT 72 in 0.004 seconds
[0m23:23:50.672029 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:50.672756 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m23:23:50.673064 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:23:50.673253 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m23:23:50.674572 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:50.674981 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: Close
[0m23:23:50.675354 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b953890>]}
[0m23:23:50.675626 [debug] [Thread-1 (]: SQL status: SELECT 1082 in 0.022 seconds
[0m23:23:50.675967 [info ] [Thread-3 (]: 5 of 70 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mSELECT 72[0m in 0.03s]
[0m23:23:50.676895 [debug] [Thread-1 (]: On model.engage_analytics.encounters: COMMIT
[0m23:23:50.677223 [debug] [Thread-3 (]: Finished running node model.engage_analytics.practitioner_role
[0m23:23:50.677513 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:23:50.677801 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_104454
[0m23:23:50.678004 [debug] [Thread-1 (]: On model.engage_analytics.encounters: COMMIT
[0m23:23:50.678356 [info ] [Thread-3 (]: 8 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_104454 .. [RUN]
[0m23:23:50.678618 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.qr_104454)
[0m23:23:50.678788 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_104454
[0m23:23:50.681109 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:23:50.681344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:23:50.681550 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:50.681933 [debug] [Thread-1 (]: On model.engage_analytics.encounters: Close
[0m23:23:50.682108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:50.682630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0b710>]}
[0m23:23:50.683199 [info ] [Thread-1 (]: 1 of 70 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mSELECT 1082[0m in 0.16s]
[0m23:23:50.683933 [debug] [Thread-1 (]: Finished running node model.engage_analytics.encounters
[0m23:23:50.684287 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_104455
[0m23:23:50.684584 [info ] [Thread-1 (]: 9 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_104455 .. [RUN]
[0m23:23:50.684917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.qr_104455)
[0m23:23:50.685212 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_104455
[0m23:23:50.687682 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:23:50.687933 [debug] [Thread-1 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:50.688115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:51.478901 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.807 seconds
[0m23:23:51.481398 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_104453"
[0m23:23:51.482065 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_104453
[0m23:23:51.489034 [debug] [Thread-2 (]: SQL status: SELECT 231 in 0.823 seconds
[0m23:23:51.491703 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_104453"
[0m23:23:51.491950 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.810 seconds
[0m23:23:51.498481 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.810 seconds
[0m23:23:51.503692 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_104394"
[0m23:23:51.504962 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_104454"
[0m23:23:51.506628 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_104455"
[0m23:23:51.507166 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:23:51.507428 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: BEGIN
[0m23:23:51.507811 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_104394
[0m23:23:51.508125 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_104454
[0m23:23:51.509767 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_104394"
[0m23:23:51.509969 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_104455
[0m23:23:51.510181 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:23:51.511904 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_104454"
[0m23:23:51.513444 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_104455"
[0m23:23:51.513652 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:23:51.514146 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 2 (id: ipc-104453, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896'
        then answer_value_text
      else null
      end
    )
    
      
            as "27b1e829-9ad9-41c2-8cb5-01ce1f469896"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c804862-f4b9-49df-aae4-c7802e723c76"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b'
        then answer_value_text
      else null
      end
    )
    
      
            as "2dd6c90f-ea68-45ba-9d30-58e02ab0812b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253'
        then answer_value_text
      else null
      end
    )
    
      
            as "f4b782e5-18e1-4edf-a3ff-409feb207253"
      
    
    ,
  
    max(
      
      case
      when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f'
        then answer_value_text
      else null
      end
    )
    
      
            as "53b30f12-74eb-474c-941c-5f0e81b7eb9f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '783e2646-c8ea-466d-bba8-85c891a14435'
        then answer_value_text
      else null
      end
    )
    
      
            as "783e2646-c8ea-466d-bba8-85c891a14435"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "ed537539-d317-43fc-a4b3-38de5e15ea4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36'
        then answer_value_text
      else null
      end
    )
    
      
            as "18c6510f-b294-4741-ae43-9cbbc4ba7e36"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50'
        then answer_value_text
      else null
      end
    )
    
      
            as "d02eb882-411e-4bc0-af9d-08a77fcc3f50"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:51.514683 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:23:51.514926 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: BEGIN
[0m23:23:51.515198 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:23:51.515477 [debug] [Thread-1 (]: On model.engage_analytics.qr_104455: BEGIN
[0m23:23:51.515699 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:51.515933 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:23:51.516186 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:23:51.516451 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: BEGIN
[0m23:23:51.516636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:51.516852 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 3 (id: ipc-104454, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:51.517176 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:23:51.517470 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:51.517841 [debug] [Thread-1 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 1 (id: ipc-104455, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda'
        then answer_value_text
      else null
      end
    )
    
      
            as "7fc39fba-84db-490d-af4e-8f772d91ffda"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423'
        then answer_value_text
      else null
      end
    )
    
      
            as "c7d21a57-0fc6-4e3a-b411-beceb1fb2423"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837'
        then answer_value_text
      else null
      end
    )
    
      
            as "644c00f2-8b07-4911-92d0-f05f5e5cc837"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03'
        then answer_value_text
      else null
      end
    )
    
      
            as "43898926-e9d5-400e-a095-62a8c7f8dd03"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6601f97-0a34-49d0-b181-611d6705ca42"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e9233a-9ab1-410a-b5e3-b30867355cea"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019'
        then answer_value_text
      else null
      end
    )
    
      
            as "ecabd308-c45a-41f7-8754-b1f63a101019"
      
    
    ,
  
    max(
      
      case
      when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "2897fef9-abcf-4bb3-b33f-2accae4c06c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f85f2ef-d781-4001-8df5-99a9ac5a656b"
      
    
    ,
  
    max(
      
      case
      when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511'
        then answer_value_text
      else null
      end
    )
    
      
            as "7cc2e8a9-197a-42ea-9431-ba01eefc6511"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2a74544-b333-4767-b3e3-7772413419ce"
      
    
    ,
  
    max(
      
      case
      when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb'
        then answer_value_text
      else null
      end
    )
    
      
            as "41aee132-ab8e-4d64-a322-eed88f900edb"
      
    
    ,
  
    max(
      
      case
      when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d'
        then answer_value_text
      else null
      end
    )
    
      
            as "06e33f1f-7202-4d5e-94d1-efbeabaa3e7d"
      
    
    ,
  
    max(
      
      case
      when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9'
        then answer_value_text
      else null
      end
    )
    
      
            as "71dbaac9-867f-4d7f-b6d7-e1f59402bbf9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '35062b98-748b-441c-ad74-185823e1bb52'
        then answer_value_text
      else null
      end
    )
    
      
            as "35062b98-748b-441c-ad74-185823e1bb52"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "d60ed1ee-79c9-444f-aff7-d346974426ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23'
        then answer_value_text
      else null
      end
    )
    
      
            as "567e992d-fb9e-4608-9be1-9277beae3c23"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:51.518232 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:23:51.518411 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:23:51.520005 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 4 (id: ipc-104394, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1d9c871-c1f8-41cc-8c54-edd4e5b162fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa'
        then answer_value_text
      else null
      end
    )
    
      
            as "f952feaf-7abc-4f6f-a3bc-d10a43ea62fa"
      
    
    ,
  
    max(
      
      case
      when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "3785a264-8bd5-44ab-bf08-8aa33735c0eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0'
        then answer_value_text
      else null
      end
    )
    
      
            as "e510a8cf-0bc7-4577-b9ee-ca758d431aa0"
      
    
    ,
  
    max(
      
      case
      when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9d203bac-75fd-4f31-bed6-073502a977f3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd7644ee-28f1-4f43-a654-17fd5034d1f6"
      
    
    ,
  
    max(
      
      case
      when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "14ec8995-eee9-416f-83ad-9f44631ac9b0"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ca03155-c9ec-45e1-8cd0-5b86fa444ad0"
      
    
    ,
  
    max(
      
      case
      when linkid = '54b75d55-1c43-4552-acbf-d9754831add8'
        then answer_value_text
      else null
      end
    )
    
      
            as "54b75d55-1c43-4552-acbf-d9754831add8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46'
        then answer_value_text
      else null
      end
    )
    
      
            as "c396a3af-6f0d-4a8e-a42b-4f47bbce5f46"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e388595-a32f-4623-8c9f-3c67bad04070"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "cf896559-dff5-4704-94a0-6a6aedee53c5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7496859-63bb-4b2f-8f75-96e44e893bf7"
      
    
    ,
  
    max(
      
      case
      when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05'
        then answer_value_text
      else null
      end
    )
    
      
            as "65252389-fa9e-4ef4-93ca-e952c77c4c05"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf"
      
    
    ,
  
    max(
      
      case
      when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "3314932c-64e4-4192-b583-eb31e87da1d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99'
        then answer_value_text
      else null
      end
    )
    
      
            as "e7ba8485-5154-41b8-ac18-35410a83cd99"
      
    
    ,
  
    max(
      
      case
      when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564'
        then answer_value_text
      else null
      end
    )
    
      
            as "18d8ee56-ffd8-4711-9074-126ef2cdc564"
      
    
    ,
  
    max(
      
      case
      when linkid = '74d0f0df-e726-4c40-84ce-efece882818b'
        then answer_value_text
      else null
      end
    )
    
      
            as "74d0f0df-e726-4c40-84ce-efece882818b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131'
        then answer_value_text
      else null
      end
    )
    
      
            as "9e11ce97-90e8-42f2-ba18-8c4f0720c131"
      
    
    ,
  
    max(
      
      case
      when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2'
        then answer_value_text
      else null
      end
    )
    
      
            as "40d6a87f-9498-4cfd-b233-4610e6de08c2"
      
    
    ,
  
    max(
      
      case
      when linkid = '57e87170-761c-4b57-a09c-d50cab02860c'
        then answer_value_text
      else null
      end
    )
    
      
            as "57e87170-761c-4b57-a09c-d50cab02860c"
      
    
    ,
  
    max(
      
      case
      when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264'
        then answer_value_text
      else null
      end
    )
    
      
            as "5056d0ba-67ac-4eab-b05d-d42941f7b264"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b2e05e9-0c11-490c-bbff-278ba90d7b4e"
      
    
    ,
  
    max(
      
      case
      when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3'
        then answer_value_text
      else null
      end
    )
    
      
            as "249f5ce8-ecc0-4e43-9675-6b01ca1502a3"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f46e0ff-0532-4105-be36-0cfa9d0770f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49'
        then answer_value_text
      else null
      end
    )
    
      
            as "0397084a-cd51-4b3a-809d-970a2406ea49"
      
    
    ,
  
    max(
      
      case
      when linkid = '808ba31c-cd29-4743-8801-dfce357d5956'
        then answer_value_text
      else null
      end
    )
    
      
            as "808ba31c-cd29-4743-8801-dfce357d5956"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d82c6ae9-0516-4513-91fa-664686779d6a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc981d8a-7f22-450b-abab-3acca810ccad"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba'
        then answer_value_text
      else null
      end
    )
    
      
            as "d0aa3679-e465-4225-85d6-5822efb10eba"
      
    
    ,
  
    max(
      
      case
      when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "86da79f0-44cb-417d-ab20-c7ecc6f8f7c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36'
        then answer_value_text
      else null
      end
    )
    
      
            as "24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36"
      
    
    ,
  
    max(
      
      case
      when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149'
        then answer_value_text
      else null
      end
    )
    
      
            as "46c2861b-70a9-4fdf-94ea-e1a01cae3149"
      
    
    ,
  
    max(
      
      case
      when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed'
        then answer_value_text
      else null
      end
    )
    
      
            as "41cce38a-ca5c-4e24-904a-25b1027336ed"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2572206-b47c-4d1e-85cb-812d13a60a85"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd62b649-7209-4d32-9bbb-dc2b2823aadb"
      
    
    ,
  
    max(
      
      case
      when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47'
        then answer_value_text
      else null
      end
    )
    
      
            as "53def3a1-a7e5-4326-95f2-2561c26ecb47"
      
    
    ,
  
    max(
      
      case
      when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6'
        then answer_value_text
      else null
      end
    )
    
      
            as "33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496'
        then answer_value_text
      else null
      end
    )
    
      
            as "b6f126dd-eac5-42e4-8896-e7400b0c0496"
      
    
    ,
  
    max(
      
      case
      when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd'
        then answer_value_text
      else null
      end
    )
    
      
            as "509b140e-b195-4696-bc5f-f2fc2d2f77dd"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae4fa455-f173-435a-bb1b-4df1d1316bd9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6262800-1e24-4348-9bf2-9bb070d2f20a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae949697-92ae-476a-96cc-f8b0adc4221f"
      
    
    ,
  
    max(
      
      case
      when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031'
        then answer_value_text
      else null
      end
    )
    
      
            as "92ab6e65-f9bd-4718-8af6-f731425d3031"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec54e447-c981-4dd2-aaa4-659f8e494248"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a1c4c0d-158f-494c-a33f-1f7f8e41f21f"
      
    
    ,
  
    max(
      
      case
      when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596'
        then answer_value_text
      else null
      end
    )
    
      
            as "656a57f8-f6f0-4fc5-b347-71dd8d38f596"
      
    
    ,
  
    max(
      
      case
      when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "245e5273-e28b-41d2-a152-1f70d85576c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41'
        then answer_value_text
      else null
      end
    )
    
      
            as "2728e75c-a0e9-4cd9-8d35-962e4f71bf41"
      
    
    ,
  
    max(
      
      case
      when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99'
        then answer_value_text
      else null
      end
    )
    
      
            as "22c11dbc-73e0-4470-9ef6-d9bd01f48c99"
      
    
    ,
  
    max(
      
      case
      when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17'
        then answer_value_text
      else null
      end
    )
    
      
            as "84018cd8-9134-429c-8dfe-fd6a16e4bd17"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21'
        then answer_value_text
      else null
      end
    )
    
      
            as "f895ed4f-5004-4da4-9d59-c21293674b21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c5720a67-803f-4917-8261-3738de838418'
        then answer_value_text
      else null
      end
    )
    
      
            as "c5720a67-803f-4917-8261-3738de838418"
      
    
    ,
  
    max(
      
      case
      when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db'
        then answer_value_text
      else null
      end
    )
    
      
            as "7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db"
      
    
    ,
  
    max(
      
      case
      when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12'
        then answer_value_text
      else null
      end
    )
    
      
            as "be88b027-64b6-4c3c-bf59-36a94dc79b12"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "a0017b28-0aa9-4926-a7be-813f0a5e6bd0"
      
    
    ,
  
    max(
      
      case
      when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12'
        then answer_value_text
      else null
      end
    )
    
      
            as "01353b1d-f816-41c1-b330-910e9a76ed12"
      
    
    ,
  
    max(
      
      case
      when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13'
        then answer_value_text
      else null
      end
    )
    
      
            as "658e8c22-d6ba-480a-81e0-dc4b6164de13"
      
    
    ,
  
    max(
      
      case
      when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240'
        then answer_value_text
      else null
      end
    )
    
      
            as "796f5440-54f8-4d69-b961-a5b7e6a63240"
      
    
    ,
  
    max(
      
      case
      when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206'
        then answer_value_text
      else null
      end
    )
    
      
            as "5e2ab0f5-f5d9-4502-befe-aba770f0e206"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-4-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-4-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966'
        then answer_value_text
      else null
      end
    )
    
      
            as "c802f463-c8f5-4056-bc45-8ab8d64a1966"
      
    
    ,
  
    max(
      
      case
      when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "706fc36f-efef-4bf9-827e-7dc100cc92bc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c631e361-027c-4e4d-b894-48785a3e6dd0"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ac23c5d-0035-4895-85f2-33c2fbba8f3f"
      
    
    ,
  
    max(
      
      case
      when linkid = '45772f3f-c610-408b-942b-359769945cf4'
        then answer_value_text
      else null
      end
    )
    
      
            as "45772f3f-c610-408b-942b-359769945cf4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "dae7f411-758d-4800-9842-fc0038a6b4a4"
      
    
    ,
  
    max(
      
      case
      when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807'
        then answer_value_text
      else null
      end
    )
    
      
            as "fc5c673b-41d4-4352-86bb-043c73ed9807"
      
    
    ,
  
    max(
      
      case
      when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "229e58ac-a18a-48dd-be10-f8b024a74eb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8726638-cfdb-40ae-b72c-f1d594f64de5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b'
        then answer_value_text
      else null
      end
    )
    
      
            as "b676a0c2-cda0-4762-be79-2a94205ee68b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe2f0911-8ddc-412b-a3e6-f216620d147e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5ab53d4-824c-460f-8939-b86ff3cd97a3"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b51625b-73b9-472d-9c71-299beb26694f'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b51625b-73b9-472d-9c71-299beb26694f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec2a78e1-e70b-4f66-86b1-561cffaf9ffd"
      
    
    ,
  
    max(
      
      case
      when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a'
        then answer_value_text
      else null
      end
    )
    
      
            as "44f02467-8ee0-49f0-8da7-5e7ed827125a"
      
    
    ,
  
    max(
      
      case
      when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73'
        then answer_value_text
      else null
      end
    )
    
      
            as "88e9b865-b81a-494b-aef2-39e803b94e73"
      
    
    ,
  
    max(
      
      case
      when linkid = '7845c436-4904-41fa-9553-2c401935623b'
        then answer_value_text
      else null
      end
    )
    
      
            as "7845c436-4904-41fa-9553-2c401935623b"
      
    
    ,
  
    max(
      
      case
      when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c'
        then answer_value_text
      else null
      end
    )
    
      
            as "892337bd-d7fd-46a7-bf72-08e87c9f412c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03'
        then answer_value_text
      else null
      end
    )
    
      
            as "d5194db0-0546-4bd1-96d8-d56457930c03"
      
    
    ,
  
    max(
      
      case
      when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa'
        then answer_value_text
      else null
      end
    )
    
      
            as "40d8ef64-02f0-42ae-9478-77651bd26dfa"
      
    
    ,
  
    max(
      
      case
      when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c'
        then answer_value_text
      else null
      end
    )
    
      
            as "9faa2b78-1842-4326-bf7f-9975bf04dc2c"
      
    
    ,
  
    max(
      
      case
      when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a'
        then answer_value_text
      else null
      end
    )
    
      
            as "370c849b-0e00-42ac-be9d-3b4c719ac31a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-spi"
      
    
    ,
  
    max(
      
      case
      when linkid = 'df53c378-27fe-483d-a630-f7b171f72980'
        then answer_value_text
      else null
      end
    )
    
      
            as "df53c378-27fe-483d-a630-f7b171f72980"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95'
        then answer_value_text
      else null
      end
    )
    
      
            as "d1c2fae1-f0f5-4333-97f6-2220d2ff3d95"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac3206dd-b60b-4cb1-a559-3a770a685668"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491'
        then answer_value_text
      else null
      end
    )
    
      
            as "f39df336-a0b8-4d0b-9bd2-6c4284985491"
      
    
    ,
  
    max(
      
      case
      when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8'
        then answer_value_text
      else null
      end
    )
    
      
            as "faefef23-d2e6-4777-b628-8f83921e8fd8"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c308fef-8ce5-4217-a8d4-8e6ff00c8e14"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a57b5b34-12e5-4ec8-8215-7f316267323a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0'
        then answer_value_text
      else null
      end
    )
    
      
            as "cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0"
      
    
    ,
  
    max(
      
      case
      when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6'
        then answer_value_text
      else null
      end
    )
    
      
            as "2e03fdf1-5274-494d-88e9-dd4b41ec90e6"
      
    
    ,
  
    max(
      
      case
      when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123'
        then answer_value_text
      else null
      end
    )
    
      
            as "62b0eb17-46e5-4c50-a133-087cc190a123"
      
    
    ,
  
    max(
      
      case
      when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d'
        then answer_value_text
      else null
      end
    )
    
      
            as "991ba845-38e5-4622-8528-dfeefbf20d3d"
      
    
    ,
  
    max(
      
      case
      when linkid = '83dfd82f-0277-459d-abe3-e8795750f288'
        then answer_value_text
      else null
      end
    )
    
      
            as "83dfd82f-0277-459d-abe3-e8795750f288"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d'
        then answer_value_text
      else null
      end
    )
    
      
            as "b36fdd5f-ccac-457c-a8ea-f9497204ef1d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7513e58-a495-49d7-a549-ba4d84fb5003"
      
    
    ,
  
    max(
      
      case
      when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888'
        then answer_value_text
      else null
      end
    )
    
      
            as "101d2b7f-2b68-407d-aa49-30cb4dadc888"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af'
        then answer_value_text
      else null
      end
    )
    
      
            as "a5d96f90-cd91-4a5b-8862-c4e3f88694af"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ea8d78b-3288-4ec8-8288-459c03df64f0"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b96f1d9-3450-423d-a277-060fcfdadc6b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369'
        then answer_value_text
      else null
      end
    )
    
      
            as "9aeae470-6ea4-4e7f-9644-ed0375fb6369"
      
    
    ,
  
    max(
      
      case
      when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98'
        then answer_value_text
      else null
      end
    )
    
      
            as "176aeeb0-e173-482a-b3eb-60f59bc04f98"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-6a-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-6a-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-1-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-1-review"
      
    
    ,
  
    max(
      
      case
      when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7'
        then answer_value_text
      else null
      end
    )
    
      
            as "53072f88-a81c-4f18-a49f-f85f64fb5be7"
      
    
    ,
  
    max(
      
      case
      when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021'
        then answer_value_text
      else null
      end
    )
    
      
            as "4d334b16-ea16-4299-94ed-32e84ef97021"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "cf16ca6e-8b1b-467d-b807-fc5d50339f71"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f531e61-26cf-4223-8653-39c24d6dd478"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c'
        then answer_value_text
      else null
      end
    )
    
      
            as "f311f3ca-5537-4134-8828-5e537bb26a9c"
      
    
    ,
  
    max(
      
      case
      when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27'
        then answer_value_text
      else null
      end
    )
    
      
            as "9b1b11e8-608f-4ea9-911b-88aae467ac27"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a25cb682-be35-4909-965e-01b8c2d036a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9'
        then answer_value_text
      else null
      end
    )
    
      
            as "e45b778d-ee8c-4ee9-81f4-8927006160f9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048'
        then answer_value_text
      else null
      end
    )
    
      
            as "cce2de12-cf62-44ff-84e8-9eb4d864d048"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc"
      
    
    ,
  
    max(
      
      case
      when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52'
        then answer_value_text
      else null
      end
    )
    
      
            as "5151ea93-a0f2-478d-adb6-f31374107b52"
      
    
    ,
  
    max(
      
      case
      when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090'
        then answer_value_text
      else null
      end
    )
    
      
            as "72e5c1b7-7ce9-49bd-834b-d98b73ba7090"
      
    
    ,
  
    max(
      
      case
      when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233'
        then answer_value_text
      else null
      end
    )
    
      
            as "5846d53f-171d-47c4-89ad-4016c3be8233"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660'
        then answer_value_text
      else null
      end
    )
    
      
            as "e552afd3-2816-446e-9ff5-e898bc813660"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db'
        then answer_value_text
      else null
      end
    )
    
      
            as "c6c266cc-1c85-41c0-97ce-9ab491be45db"
      
    
    ,
  
    max(
      
      case
      when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331'
        then answer_value_text
      else null
      end
    )
    
      
            as "3ab931b8-6bfd-4e5f-b86b-3c7377907331"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897'
        then answer_value_text
      else null
      end
    )
    
      
            as "fefdc90f-fe1d-4bfb-af93-94df8c482897"
      
    
    ,
  
    max(
      
      case
      when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164'
        then answer_value_text
      else null
      end
    )
    
      
            as "83661ebe-71cf-4eab-88e3-bfecbfe35164"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449'
        then answer_value_text
      else null
      end
    )
    
      
            as "fd1498e5-abf7-4ebe-9252-97994d6b9449"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-6a'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-6a"
      
    
    ,
  
    max(
      
      case
      when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "92da95cc-50dd-4bf0-acca-4465c07d44cc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111'
        then answer_value_text
      else null
      end
    )
    
      
            as "cebffdf4-8fd1-4829-884c-41cc42bc0111"
      
    
    ,
  
    max(
      
      case
      when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5'
        then answer_value_text
      else null
      end
    )
    
      
            as "52ef2ff5-ced6-418a-b9e7-f2ef47123df5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9c42647-eefb-42bd-9080-f83630729606'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9c42647-eefb-42bd-9080-f83630729606"
      
    
    ,
  
    max(
      
      case
      when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a'
        then answer_value_text
      else null
      end
    )
    
      
            as "13e2f934-82ed-4b23-af6e-95523dc3746a"
      
    
    ,
  
    max(
      
      case
      when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8891cd7b-ad1c-4030-afe4-6752cd273cf4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "cece37bc-897b-4b48-a9c9-59ecc9f997f7"
      
    
    ,
  
    max(
      
      case
      when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d'
        then answer_value_text
      else null
      end
    )
    
      
            as "58721b3d-88ae-4888-b5ec-ef7dfe30fb3d"
      
    
    ,
  
    max(
      
      case
      when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "895fad45-c3b5-47c5-9edf-5f9b9e793fbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a33cdecd-b7e6-45d8-94b6-52fa80c64a6d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39'
        then answer_value_text
      else null
      end
    )
    
      
            as "f14c3c34-f80a-4481-9d9c-9b05267d4c39"
      
    
    ,
  
    max(
      
      case
      when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9'
        then answer_value_text
      else null
      end
    )
    
      
            as "82d6b50b-0bb2-40f6-94b1-7a4c58df43f9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268'
        then answer_value_text
      else null
      end
    )
    
      
            as "1a00c7b7-e80d-4e90-8ed4-efd8f6d96268"
      
    
    ,
  
    max(
      
      case
      when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709'
        then answer_value_text
      else null
      end
    )
    
      
            as "07c2e8dc-b48b-4bc7-b21b-c196cce32709"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf'
        then answer_value_text
      else null
      end
    )
    
      
            as "dfa1f239-2a4c-40bd-ab15-561f6d87febf"
      
    
    ,
  
    max(
      
      case
      when linkid = '53932020-eed8-46f4-8236-d548a6335a59'
        then answer_value_text
      else null
      end
    )
    
      
            as "53932020-eed8-46f4-8236-d548a6335a59"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a1155e2-6c49-4f82-a9fc-2807ee298410"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce18eee3-aa64-4423-8db1-50fe7f00850d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b'
        then answer_value_text
      else null
      end
    )
    
      
            as "c37407c5-003a-4b7c-b6a3-e10ef146a47b"
      
    
    ,
  
    max(
      
      case
      when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3'
        then answer_value_text
      else null
      end
    )
    
      
            as "39de8b74-5cbc-4225-b27b-c97e72f08af3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f'
        then answer_value_text
      else null
      end
    )
    
      
            as "bfe595d6-325f-492a-b3b6-cc5541e18c3f"
      
    
    ,
  
    max(
      
      case
      when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc'
        then answer_value_text
      else null
      end
    )
    
      
            as "2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a320b787-4cba-457f-9c60-67ff76c7020f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9e056c2-0469-4523-a28f-1000fed1a4f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e'
        then answer_value_text
      else null
      end
    )
    
      
            as "527c0166-cc35-4cc3-a9d9-7eeb0a54635e"
      
    
    ,
  
    max(
      
      case
      when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7"
      
    
    ,
  
    max(
      
      case
      when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124'
        then answer_value_text
      else null
      end
    )
    
      
            as "5324bdce-baaa-45bf-935a-eb2f65bd7124"
      
    
    ,
  
    max(
      
      case
      when linkid = '544a444d-b101-4d56-9351-00bca8ec749e'
        then answer_value_text
      else null
      end
    )
    
      
            as "544a444d-b101-4d56-9351-00bca8ec749e"
      
    
    ,
  
    max(
      
      case
      when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86'
        then answer_value_text
      else null
      end
    )
    
      
            as "13321778-b5d4-4b01-8eda-610cf0007c86"
      
    
    ,
  
    max(
      
      case
      when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc'
        then answer_value_text
      else null
      end
    )
    
      
            as "90cedcbf-bf11-4dc3-9733-42e6900a09fc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200'
        then answer_value_text
      else null
      end
    )
    
      
            as "c0655b11-8f21-47ed-8ede-95498c2e8200"
      
    
    ,
  
    max(
      
      case
      when linkid = '15e5007d-028f-4644-8fb6-0346730c3101'
        then answer_value_text
      else null
      end
    )
    
      
            as "15e5007d-028f-4644-8fb6-0346730c3101"
      
    
    ,
  
    max(
      
      case
      when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c'
        then answer_value_text
      else null
      end
    )
    
      
            as "8c1ac4fe-1d76-4436-8f34-d315c6c17b9c"
      
    
    ,
  
    max(
      
      case
      when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "87dab385-fe6b-44ce-b6b2-5771c41d82c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "40fbe8d0-4380-4efc-bb04-26fc7d3714eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3b4cf6e-385d-40b7-9380-4de2f81463de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185'
        then answer_value_text
      else null
      end
    )
    
      
            as "a842d271-cd48-47c7-963e-dcd0376ef185"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f3a622a-d39b-49b0-84e7-0bcf4f832a4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "69d5aec4-65d3-44b1-99ba-badd201769c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75'
        then answer_value_text
      else null
      end
    )
    
      
            as "6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0'
        then answer_value_text
      else null
      end
    )
    
      
            as "f8861b1c-781f-4f12-b4c8-f8110f0c2cc0"
      
    
    ,
  
    max(
      
      case
      when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7'
        then answer_value_text
      else null
      end
    )
    
      
            as "53a575e3-aa59-408d-a0dd-8df237b68bf7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531'
        then answer_value_text
      else null
      end
    )
    
      
            as "a3670632-ce8f-468a-b2f3-6934245d3531"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a9424b0-c893-4371-b5c9-bc0008be14b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54'
        then answer_value_text
      else null
      end
    )
    
      
            as "fba783e8-91d0-4a49-ba80-c55fa9e41a54"
      
    
    ,
  
    max(
      
      case
      when linkid = '437d9ea2-adb5-471a-828b-a0285a282217'
        then answer_value_text
      else null
      end
    )
    
      
            as "437d9ea2-adb5-471a-828b-a0285a282217"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14'
        then answer_value_text
      else null
      end
    )
    
      
            as "cecb89ae-abce-411c-b4ce-f84ebf59ca14"
      
    
    ,
  
    max(
      
      case
      when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea95a315-f903-4351-87ed-c1e7e7b74198"
      
    
    ,
  
    max(
      
      case
      when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd'
        then answer_value_text
      else null
      end
    )
    
      
            as "98407058-4855-44cc-ac45-6e0d0c072fdd"
      
    
    ,
  
    max(
      
      case
      when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609'
        then answer_value_text
      else null
      end
    )
    
      
            as "705df2d9-af92-4f4f-b513-17e01d07b609"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7'
        then answer_value_text
      else null
      end
    )
    
      
            as "ff115c26-95b9-4e0d-87ed-80817d438fc7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604'
        then answer_value_text
      else null
      end
    )
    
      
            as "fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604"
      
    
    ,
  
    max(
      
      case
      when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "28b2e31a-ee4d-4e99-8974-b616145311eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4a1be29-fe8b-4423-91bc-6b4f5d730e6b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-2-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-2-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e'
        then answer_value_text
      else null
      end
    )
    
      
            as "d617b1e1-ea22-4863-a878-627f6b81963e"
      
    
    ,
  
    max(
      
      case
      when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5a79866d-f1fb-4bd8-b4c4-f18c982bef3c"
      
    
    ,
  
    max(
      
      case
      when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63'
        then answer_value_text
      else null
      end
    )
    
      
            as "2a6c5feb-8034-418b-8644-142a5e31df63"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "d3340d7e-9b84-4559-8a11-bed5a662a6f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb'
        then answer_value_text
      else null
      end
    )
    
      
            as "08b5e17c-5e14-4b19-ac93-9e479cd2a2bb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d'
        then answer_value_text
      else null
      end
    )
    
      
            as "ee5d4acf-ecf0-4e62-8924-cff17a33679d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4ebe784-07d0-4312-8a46-634c0e338a54"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444'
        then answer_value_text
      else null
      end
    )
    
      
            as "d8615ac7-96b2-46a2-b3a5-b5b83945b444"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "db779cb5-5335-4eb6-8ccc-47ec94c626c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea'
        then answer_value_text
      else null
      end
    )
    
      
            as "603d1492-316f-497f-967b-5c4b1ab983ea"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a273a98-82ca-4d36-ade0-ce98f7899972"
      
    
    ,
  
    max(
      
      case
      when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81'
        then answer_value_text
      else null
      end
    )
    
      
            as "06f9231a-999b-4459-8260-6fbbcdfc5d81"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-signs-step-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-signs-step-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7e42cdb-a42b-4d22-b7a6-204de5305351"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-3-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-3-review"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b247120-23cf-45fc-9e4d-d959f0dda79f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77'
        then answer_value_text
      else null
      end
    )
    
      
            as "d1efad02-3686-4ce3-a96d-68d8c638ff77"
      
    
    ,
  
    max(
      
      case
      when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942'
        then answer_value_text
      else null
      end
    )
    
      
            as "20cae99e-ab90-4d75-92a2-c0af5dd60942"
      
    
    ,
  
    max(
      
      case
      when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969'
        then answer_value_text
      else null
      end
    )
    
      
            as "12d89dfd-5e43-4f00-8446-b3af23323969"
      
    
    ,
  
    max(
      
      case
      when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c'
        then answer_value_text
      else null
      end
    )
    
      
            as "62a04638-8928-4aab-b490-1a33739b7a5c"
      
    
    ,
  
    max(
      
      case
      when linkid = '965b7874-dd24-4215-acd4-8d241a262638'
        then answer_value_text
      else null
      end
    )
    
      
            as "965b7874-dd24-4215-acd4-8d241a262638"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6d066a2-0286-49b0-b688-34696e7fb256"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f44652f-df2d-476e-933d-75b6ed55f5f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68'
        then answer_value_text
      else null
      end
    )
    
      
            as "6f68c416-a5de-4f68-8ad0-33c6e85a9a68"
      
    
    ,
  
    max(
      
      case
      when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225'
        then answer_value_text
      else null
      end
    )
    
      
            as "1895c0a7-b090-4f49-9b0c-08dca9a7b225"
      
    
    ,
  
    max(
      
      case
      when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2'
        then answer_value_text
      else null
      end
    )
    
      
            as "2c7b6bd7-36f6-495b-9f41-eb492c07c7b2"
      
    
    ,
  
    max(
      
      case
      when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904'
        then answer_value_text
      else null
      end
    )
    
      
            as "36dd1467-a7a1-428c-bdca-17d352a79904"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce0fdd41-6b09-4104-9998-a04c5dd9a5b7"
      
    
    ,
  
    max(
      
      case
      when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de'
        then answer_value_text
      else null
      end
    )
    
      
            as "68608473-77e6-4341-9f1b-d4d18b17d3de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871'
        then answer_value_text
      else null
      end
    )
    
      
            as "a1c56f60-b823-4c15-b99d-a315d2ca1871"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9'
        then answer_value_text
      else null
      end
    )
    
      
            as "dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33'
        then answer_value_text
      else null
      end
    )
    
      
            as "a20b29af-3317-415e-9c6e-d9f3bbc4df33"
      
    
    ,
  
    max(
      
      case
      when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f'
        then answer_value_text
      else null
      end
    )
    
      
            as "11aadd88-0cf9-48b2-939d-2b3e28191c5f"
      
    
    ,
  
    max(
      
      case
      when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488'
        then answer_value_text
      else null
      end
    )
    
      
            as "68fa6f2e-84ec-4dbc-900e-10ede297c488"
      
    
    ,
  
    max(
      
      case
      when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d'
        then answer_value_text
      else null
      end
    )
    
      
            as "1d0ad825-09de-4018-a680-cd0e6bf0983d"
      
    
    ,
  
    max(
      
      case
      when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344'
        then answer_value_text
      else null
      end
    )
    
      
            as "1fc8f8e7-2022-48d2-b41d-4e8ad22af344"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:51.521631 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:51.521841 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:23:51.525369 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:23:51.527472 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:23:51.528910 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:23:51.529102 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_tmp" rename to "qr_104453"
[0m23:23:51.529292 [debug] [Thread-1 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_tmp" rename to "qr_104455"
[0m23:23:51.529473 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_tmp" rename to "qr_104454"
[0m23:23:51.530399 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:51.530635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:51.530827 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:51.531512 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: COMMIT
[0m23:23:51.532061 [debug] [Thread-1 (]: On model.engage_analytics.qr_104455: COMMIT
[0m23:23:51.532591 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: COMMIT
[0m23:23:51.532807 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:23:51.532998 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:23:51.533175 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:23:51.533341 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: COMMIT
[0m23:23:51.533504 [debug] [Thread-1 (]: On model.engage_analytics.qr_104455: COMMIT
[0m23:23:51.533657 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: COMMIT
[0m23:23:51.534869 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:51.535157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:51.535364 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:51.538431 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_backup"
[0m23:23:51.538668 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m23:23:51.539761 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_backup"
[0m23:23:51.540809 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_backup"
[0m23:23:51.543113 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:23:51.544552 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:23:51.544838 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:23:51.545079 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:23:51.545270 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_backup" cascade
[0m23:23:51.545440 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_tmp" rename to "qr_104394"
[0m23:23:51.545609 [debug] [Thread-1 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_backup" cascade
[0m23:23:51.545768 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_backup" cascade
[0m23:23:51.546492 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:51.546662 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:51.547327 [debug] [Thread-3 (]: On model.engage_analytics.qr_104454: Close
[0m23:23:51.547506 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:51.548066 [debug] [Thread-1 (]: On model.engage_analytics.qr_104455: Close
[0m23:23:51.548736 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: Close
[0m23:23:51.549077 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b96be60>]}
[0m23:23:51.549250 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:23:51.549436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a1130>]}
[0m23:23:51.549825 [info ] [Thread-3 (]: 8 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_104454  [[32mCREATE VIEW[0m in 0.87s]
[0m23:23:51.550248 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b96b9b0>]}
[0m23:23:51.550992 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: COMMIT
[0m23:23:51.551369 [info ] [Thread-1 (]: 9 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_104455  [[32mCREATE VIEW[0m in 0.86s]
[0m23:23:51.551718 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_104454
[0m23:23:51.552029 [info ] [Thread-4 (]: 7 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_104453  [[32mCREATE VIEW[0m in 0.88s]
[0m23:23:51.552237 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:23:51.552464 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_104455
[0m23:23:51.552665 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_1613531
[0m23:23:51.552956 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_104453
[0m23:23:51.553129 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: COMMIT
[0m23:23:51.553302 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_1613532
[0m23:23:51.553515 [info ] [Thread-3 (]: 10 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_1613531  [RUN]
[0m23:23:51.553737 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m23:23:51.553991 [info ] [Thread-1 (]: 11 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_1613532  [RUN]
[0m23:23:51.554213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104454, now model.engage_analytics.qr_1613531)
[0m23:23:51.554514 [info ] [Thread-4 (]: 12 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m23:23:51.554835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104455, now model.engage_analytics.qr_1613532)
[0m23:23:51.555075 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:51.555298 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_1613531
[0m23:23:51.555521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104453, now model.engage_analytics.qr_1_month_follow_up)
[0m23:23:51.555736 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_1613532
[0m23:23:51.557008 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_backup"
[0m23:23:51.559341 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:23:51.559552 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m23:23:51.562465 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:23:51.562783 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:23:51.563040 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:51.565240 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:23:51.565462 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:51.565653 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_backup" cascade
[0m23:23:51.565819 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:51.565989 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:51.566139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:51.566479 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:51.566876 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:51.567586 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: Close
[0m23:23:51.567910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b983ef0>]}
[0m23:23:51.568351 [info ] [Thread-2 (]: 6 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_104394  [[32mCREATE VIEW[0m in 0.91s]
[0m23:23:51.568649 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_104394
[0m23:23:51.568849 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_202
[0m23:23:51.569186 [info ] [Thread-2 (]: 13 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_202 .... [RUN]
[0m23:23:51.569501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104394, now model.engage_analytics.qr_202)
[0m23:23:51.569683 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_202
[0m23:23:51.572123 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:23:51.572376 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:51.572554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:52.108047 [debug] [Thread-2 (]: SQL status: SELECT 18 in 0.535 seconds
[0m23:23:52.111597 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_202"
[0m23:23:52.112345 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_202
[0m23:23:52.114045 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_202"
[0m23:23:52.114335 [debug] [Thread-3 (]: SQL status: SELECT 25 in 0.548 seconds
[0m23:23:52.114540 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.548 seconds
[0m23:23:52.114761 [debug] [Thread-1 (]: SQL status: SELECT 37 in 0.549 seconds
[0m23:23:52.116353 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_1613531"
[0m23:23:52.117204 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m23:23:52.119061 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_1613532"
[0m23:23:52.119549 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:23:52.119934 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m23:23:52.120148 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: BEGIN
[0m23:23:52.121714 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m23:23:52.121992 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_1613531
[0m23:23:52.122220 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_1613532
[0m23:23:52.122510 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:52.124236 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_1613531"
[0m23:23:52.126276 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_1613532"
[0m23:23:52.126501 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:23:52.126754 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:23:52.127186 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 1) (id: ipc-202, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-gad-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-gad-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9'
        then answer_value_text
      else null
      end
    )
    
      
            as "69f16284-b8a8-4a24-ab79-03bde5bcfbe9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603'
        then answer_value_text
      else null
      end
    )
    
      
            as "829e6d32-3fa7-4d16-909b-b198aea54603"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "583c5b02-b26c-4821-8da8-7ed9066d9d5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:52.127564 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m23:23:52.127764 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:23:52.127943 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:23:52.128156 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613531: BEGIN
[0m23:23:52.128321 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: BEGIN
[0m23:23:52.128583 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:52.128814 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:23:52.129015 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:52.129283 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- 1 month follow up (id: 1-month-follow-up, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'completed-all-recommended-interventions'
        then answer_value_text
      else null
      end
    )
    
      
            as "completed-all-recommended-interventions"
      
    
    ,
  
    max(
      
      case
      when linkid = 'schedule-this-meeting'
        then answer_value_text
      else null
      end
    )
    
      
            as "schedule-this-meeting"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:52.129519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:52.129686 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:23:52.129869 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:23:52.130217 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Sociodemographic Survey (id: 1613531, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cce9788-d7e7-4456-d455-5bd8dc3d2f2a"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b68e9a3-703a-4b57-876e-8dd400826db9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4afce83-4279-4d19-8a8b-1e0b7e1ba73c"
      
    
    ,
  
    max(
      
      case
      when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4'
        then answer_value_text
      else null
      end
    )
    
      
            as "6e621fcc-a25c-4070-8fda-894bb9df68e4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f'
        then answer_value_text
      else null
      end
    )
    
      
            as "f11fe547-9be9-4693-8a85-f252e4a6262f"
      
    
    ,
  
    max(
      
      case
      when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173'
        then answer_value_text
      else null
      end
    )
    
      
            as "5b133a13-0303-4d2f-8884-ffa931d2c173"
      
    
    ,
  
    max(
      
      case
      when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7'
        then answer_value_text
      else null
      end
    )
    
      
            as "05990b62-11a8-4ab7-8988-1d2a17edcff7"
      
    
    ,
  
    max(
      
      case
      when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5'
        then answer_value_text
      else null
      end
    )
    
      
            as "0e027468-c1e9-4977-f5f5-1cfa00ab8af5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "8f600ee9-8d17-43df-ed68-c9a7de2da7d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-socio-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-socio-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba'
        then answer_value_text
      else null
      end
    )
    
      
            as "d7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f8a7973-d9bb-493b-aa68-fb01e0f1aefe"
      
    
    ,
  
    max(
      
      case
      when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde'
        then answer_value_text
      else null
      end
    )
    
      
            as "1fdf1a17-7af6-413f-81e9-cf6823fe7fde"
      
    
    ,
  
    max(
      
      case
      when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af'
        then answer_value_text
      else null
      end
    )
    
      
            as "3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af"
      
    
    ,
  
    max(
      
      case
      when linkid = '92fed595-49f2-4fab-81ff-885941f31e07'
        then answer_value_text
      else null
      end
    )
    
      
            as "92fed595-49f2-4fab-81ff-885941f31e07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130'
        then answer_value_text
      else null
      end
    )
    
      
            as "66d30814-73ea-4fa4-edf8-d0d79378b130"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-biological-sex'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-biological-sex"
      
    
    ,
  
    max(
      
      case
      when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739'
        then answer_value_text
      else null
      end
    )
    
      
            as "3960c72d-b6e7-418e-86e9-f8348a49e739"
      
    
    ,
  
    max(
      
      case
      when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d'
        then answer_value_text
      else null
      end
    )
    
      
            as "4baa9e68-fe7a-489a-8b03-cc045b53d93d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:52.130812 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mental Wellness Tool (id: 1613532, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'q1-to-q3-negative'
        then answer_value_text
      else null
      end
    )
    
      
            as "q1-to-q3-negative"
      
    
    ,
  
    max(
      
      case
      when linkid = 'suicide-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "suicide-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'severe-mental-health'
        then answer_value_text
      else null
      end
    )
    
      
            as "severe-mental-health"
      
    
    ,
  
    max(
      
      case
      when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63'
        then answer_value_text
      else null
      end
    )
    
      
            as "59ae2c65-3a25-4acb-9db5-7aa035c54a63"
      
    
    ,
  
    max(
      
      case
      when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc'
        then answer_value_text
      else null
      end
    )
    
      
            as "2c50fee4-7a5d-4d62-80aa-73329934d7dc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-mental-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-mental-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = 'alcohol-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "alcohol-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642'
        then answer_value_text
      else null
      end
    )
    
      
            as "156fce37-203f-4760-a9f9-1b8ab0ae0642"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-socio-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-socio-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a051272-efb0-4f1f-acc7-f5038989207f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588'
        then answer_value_text
      else null
      end
    )
    
      
            as "4602f806-3bf4-4f16-bee1-c2e690dca588"
      
    
    ,
  
    max(
      
      case
      when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab'
        then answer_value_text
      else null
      end
    )
    
      
            as "364e4271-e89d-4206-85a1-45ad595e4cab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f'
        then answer_value_text
      else null
      end
    )
    
      
            as "97f2ed48-11d2-4417-a4b2-57a333c5157f"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e7579d-ac74-4d72-955b-1a3675a2e656"
      
    
    ,
  
    max(
      
      case
      when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29'
        then answer_value_text
      else null
      end
    )
    
      
            as "80499f94-3f2a-4f0f-9a21-7fa252b33e29"
      
    
    ,
  
    max(
      
      case
      when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20'
        then answer_value_text
      else null
      end
    )
    
      
            as "69a559db-c97b-4bcb-aae4-81465fdd1d20"
      
    
    ,
  
    max(
      
      case
      when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "99f0d10e-9522-457f-8432-fd489c53acb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b9ecb840-8515-4091-8cef-863ed297012e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'common-mental-health'
        then answer_value_text
      else null
      end
    )
    
      
            as "common-mental-health"
      
    
    ,
  
    max(
      
      case
      when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73'
        then answer_value_text
      else null
      end
    )
    
      
            as "94f913ce-e837-48b3-906d-a0613ac72b73"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77'
        then answer_value_text
      else null
      end
    )
    
      
            as "a669eaea-2f12-49ff-ac91-d54009d6ab77"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d'
        then answer_value_text
      else null
      end
    )
    
      
            as "f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20'
        then answer_value_text
      else null
      end
    )
    
      
            as "11e90302-2ae0-4e7d-be11-754b2a91ab20"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-biological-sex'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-biological-sex"
      
    
    ,
  
    max(
      
      case
      when linkid = 'how-many-drinks'
        then answer_value_text
      else null
      end
    )
    
      
            as "how-many-drinks"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-common-mental-health-form'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-common-mental-health-form"
      
    
    ,
  
    max(
      
      case
      when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6'
        then answer_value_text
      else null
      end
    )
    
      
            as "0ee3228d-28b6-4c88-8119-808fc121aaa6"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e9014d1-e07c-492e-897a-3bf7e8f6f018"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-mwtool-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-mwtool-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:52.131226 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:52.132964 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:23:52.133203 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:52.133415 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_tmp" rename to "qr_202"
[0m23:23:52.135014 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:23:52.135262 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:23:52.135474 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:23:52.135673 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m23:23:52.137220 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:23:52.137415 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:23:52.138770 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:23:52.138991 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_tmp" rename to "qr_1613532"
[0m23:23:52.139599 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: COMMIT
[0m23:23:52.139780 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:52.139945 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_tmp" rename to "qr_1613531"
[0m23:23:52.140143 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:23:52.140863 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m23:23:52.141179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:52.141390 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: COMMIT
[0m23:23:52.141576 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:23:52.142226 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: COMMIT
[0m23:23:52.142413 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:52.142618 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m23:23:52.142807 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:23:52.143375 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613531: COMMIT
[0m23:23:52.143559 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:52.143741 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: COMMIT
[0m23:23:52.143905 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:23:52.145053 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_backup"
[0m23:23:52.145270 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:52.145437 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613531: COMMIT
[0m23:23:52.145700 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:23:52.145875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:52.146909 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m23:23:52.147345 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_backup" cascade
[0m23:23:52.148490 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_backup"
[0m23:23:52.148681 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:52.148936 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:23:52.149232 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:23:52.150332 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_backup"
[0m23:23:52.150520 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:52.150688 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m23:23:52.150868 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_backup" cascade
[0m23:23:52.151206 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:23:52.151892 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: Close
[0m23:23:52.152131 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_backup" cascade
[0m23:23:52.152491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f2390>]}
[0m23:23:52.152730 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:52.152936 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:52.153161 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:52.154007 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613532: Close
[0m23:23:52.153423 [info ] [Thread-2 (]: 13 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_202  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:52.154673 [debug] [Thread-4 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m23:23:52.155242 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613531: Close
[0m23:23:52.155509 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_202
[0m23:23:52.155745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4a840>]}
[0m23:23:52.156058 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9cb440>]}
[0m23:23:52.156321 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_203
[0m23:23:52.156593 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba0c740>]}
[0m23:23:52.157029 [info ] [Thread-1 (]: 11 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_1613532  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:52.157459 [info ] [Thread-4 (]: 12 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:52.157690 [info ] [Thread-2 (]: 14 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_203 .... [RUN]
[0m23:23:52.158091 [info ] [Thread-3 (]: 10 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_1613531  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:52.158486 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_1613532
[0m23:23:52.158854 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m23:23:52.159130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_202, now model.engage_analytics.qr_203)
[0m23:23:52.159409 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_1613531
[0m23:23:52.159680 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_204
[0m23:23:52.159967 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_205
[0m23:23:52.160181 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_203
[0m23:23:52.160382 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_206
[0m23:23:52.160635 [info ] [Thread-1 (]: 15 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_204 .... [RUN]
[0m23:23:52.160885 [info ] [Thread-4 (]: 16 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_205 .... [RUN]
[0m23:23:52.164365 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:23:52.164659 [info ] [Thread-3 (]: 17 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_206 .... [RUN]
[0m23:23:52.164968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613532, now model.engage_analytics.qr_204)
[0m23:23:52.165207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_205)
[0m23:23:52.165416 [debug] [Thread-2 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:52.165625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613531, now model.engage_analytics.qr_206)
[0m23:23:52.165818 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_204
[0m23:23:52.165983 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_205
[0m23:23:52.166153 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:52.166330 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_206
[0m23:23:52.168685 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:23:52.170973 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:23:52.173272 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:23:52.173507 [debug] [Thread-1 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:52.173705 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:52.173894 [debug] [Thread-3 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:52.174403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:52.174660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:52.174833 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:52.710639 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.544 seconds
[0m23:23:52.711960 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_203"
[0m23:23:52.712481 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_203
[0m23:23:52.714201 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_203"
[0m23:23:52.714670 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:23:52.714848 [debug] [Thread-2 (]: On model.engage_analytics.qr_203: BEGIN
[0m23:23:52.715760 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:52.716041 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:23:52.716302 [debug] [Thread-2 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 1) (id: ipc-203, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727'
        then answer_value_text
      else null
      end
    )
    
      
            as "8085cded-8e0f-497f-9e3d-5fab3981d727"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "d58c8907-06c6-4071-aa6c-b2b95d2169c7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:52.716816 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.542 seconds
[0m23:23:52.718780 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_205"
[0m23:23:52.719521 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_205
[0m23:23:52.721103 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_205"
[0m23:23:52.721315 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.546 seconds
[0m23:23:52.721512 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:23:52.721674 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.547 seconds
[0m23:23:52.722651 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_206"
[0m23:23:52.724021 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:23:52.725861 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_204"
[0m23:23:52.726143 [debug] [Thread-2 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_tmp" rename to "qr_203"
[0m23:23:52.726372 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:23:52.726794 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_206
[0m23:23:52.727006 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: BEGIN
[0m23:23:52.729307 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_206"
[0m23:23:52.729525 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_204
[0m23:23:52.729738 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:23:52.731350 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_204"
[0m23:23:52.731575 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:23:52.732171 [debug] [Thread-2 (]: On model.engage_analytics.qr_203: COMMIT
[0m23:23:52.732426 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:23:52.732643 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:23:52.732831 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:23:52.733108 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 2) (id: ipc-205, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-gad-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-gad-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110'
        then answer_value_text
      else null
      end
    )
    
      
            as "510776d6-8b4e-446b-abe7-80aee8ecb110"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23'
        then answer_value_text
      else null
      end
    )
    
      
            as "37e0bcfd-f6d1-4b35-9556-4d458a717a23"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:52.733392 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:23:52.733587 [debug] [Thread-2 (]: On model.engage_analytics.qr_203: COMMIT
[0m23:23:52.733798 [debug] [Thread-3 (]: On model.engage_analytics.qr_206: BEGIN
[0m23:23:52.734280 [debug] [Thread-1 (]: On model.engage_analytics.qr_204: BEGIN
[0m23:23:52.734903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:52.735183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:52.735403 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:23:52.735589 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:52.735783 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:23:52.736026 [debug] [Thread-3 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 2) (id: ipc-206, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07'
        then answer_value_text
      else null
      end
    )
    
      
            as "85a3f14c-e4d8-4c45-9088-967ec4ea0d07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:52.737279 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_backup"
[0m23:23:52.737488 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:52.737861 [debug] [Thread-1 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 1) (id: ipc-204, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '16d05294-fee9-4d42-8447-0d578a5de192'
        then answer_value_text
      else null
      end
    )
    
      
            as "16d05294-fee9-4d42-8447-0d578a5de192"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f'
        then answer_value_text
      else null
      end
    )
    
      
            as "790391ba-cf9f-4ef6-be11-b5a7b468819f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7934aa5-17f0-4320-8f65-e7a7f72c5161"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d74aecd2-f0c4-4207-b396-b2c6d780be4a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505'
        then answer_value_text
      else null
      end
    )
    
      
            as "2171a88a-4e4d-44c4-b6b3-389723e9b505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-ptsd-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-ptsd-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:52.738409 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:23:52.740037 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:23:52.740241 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:52.740437 [debug] [Thread-2 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_backup" cascade
[0m23:23:52.740618 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_tmp" rename to "qr_205"
[0m23:23:52.742073 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:23:52.742378 [debug] [Thread-3 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_tmp" rename to "qr_206"
[0m23:23:52.742728 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:52.743523 [debug] [Thread-2 (]: On model.engage_analytics.qr_203: Close
[0m23:23:52.743733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:52.743916 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:23:52.744087 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:52.744358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8ee70>]}
[0m23:23:52.745799 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:23:52.746388 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: COMMIT
[0m23:23:52.746914 [debug] [Thread-3 (]: On model.engage_analytics.qr_206: COMMIT
[0m23:23:52.747389 [debug] [Thread-1 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_tmp" rename to "qr_204"
[0m23:23:52.747238 [info ] [Thread-2 (]: 14 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_203  [[32mCREATE VIEW[0m in 0.59s]
[0m23:23:52.747610 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:23:52.747777 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:23:52.748025 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_203
[0m23:23:52.748188 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: COMMIT
[0m23:23:52.748342 [debug] [Thread-3 (]: On model.engage_analytics.qr_206: COMMIT
[0m23:23:52.748524 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_207
[0m23:23:52.748829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:52.749230 [info ] [Thread-2 (]: 18 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_207 .... [RUN]
[0m23:23:52.749975 [debug] [Thread-1 (]: On model.engage_analytics.qr_204: COMMIT
[0m23:23:52.750250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_203, now model.engage_analytics.qr_207)
[0m23:23:52.750450 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:52.750652 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:52.750886 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:23:52.751088 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_207
[0m23:23:52.752310 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_backup"
[0m23:23:52.753377 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_backup"
[0m23:23:52.753578 [debug] [Thread-1 (]: On model.engage_analytics.qr_204: COMMIT
[0m23:23:52.755872 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:23:52.756181 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:23:52.756450 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:23:52.756726 [debug] [Thread-2 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:52.756968 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_backup" cascade
[0m23:23:52.757171 [debug] [Thread-3 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_backup" cascade
[0m23:23:52.757428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:52.757637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:52.759873 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_backup"
[0m23:23:52.760149 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:23:52.760373 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:23:52.760764 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:23:52.761498 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: Close
[0m23:23:52.762259 [debug] [Thread-3 (]: On model.engage_analytics.qr_206: Close
[0m23:23:52.762504 [debug] [Thread-1 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_backup" cascade
[0m23:23:52.762862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10babd2e0>]}
[0m23:23:52.763127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7af90>]}
[0m23:23:52.763536 [info ] [Thread-3 (]: 17 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_206  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:52.764013 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:52.764259 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_206
[0m23:23:52.763773 [info ] [Thread-4 (]: 16 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_205  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:52.764932 [debug] [Thread-1 (]: On model.engage_analytics.qr_204: Close
[0m23:23:52.765141 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_208
[0m23:23:52.765406 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_205
[0m23:23:52.765687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a0140>]}
[0m23:23:52.765977 [info ] [Thread-3 (]: 19 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_208 .... [RUN]
[0m23:23:52.766278 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_209
[0m23:23:52.766673 [info ] [Thread-1 (]: 15 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_204  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:52.766948 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_206, now model.engage_analytics.qr_208)
[0m23:23:52.767251 [info ] [Thread-4 (]: 20 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_209 .... [RUN]
[0m23:23:52.767611 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_204
[0m23:23:52.767830 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_208
[0m23:23:52.768127 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_205, now model.engage_analytics.qr_209)
[0m23:23:52.768367 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_210
[0m23:23:52.770703 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:23:52.771012 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_209
[0m23:23:52.771330 [info ] [Thread-1 (]: 21 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_210 .... [RUN]
[0m23:23:52.771597 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:52.773840 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:23:52.774094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_204, now model.engage_analytics.qr_210)
[0m23:23:52.774277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:52.774456 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:52.774634 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_210
[0m23:23:52.774945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:52.777332 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:23:52.777705 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:52.777889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:53.287915 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.530 seconds
[0m23:23:53.289024 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_207"
[0m23:23:53.289508 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_207
[0m23:23:53.291299 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_207"
[0m23:23:53.291698 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:23:53.291864 [debug] [Thread-2 (]: On model.engage_analytics.qr_207: BEGIN
[0m23:23:53.293010 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:53.293327 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:23:53.293562 [debug] [Thread-2 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 3) (id: ipc-207, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "2fb4f2f4-23b5-4f36-b444-683563ea4fb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:53.295929 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:53.297584 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:23:53.297788 [debug] [Thread-2 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_tmp" rename to "qr_207"
[0m23:23:53.298704 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:53.299504 [debug] [Thread-2 (]: On model.engage_analytics.qr_207: COMMIT
[0m23:23:53.299764 [debug] [Thread-3 (]: SQL status: SELECT 97 in 0.525 seconds
[0m23:23:53.300060 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:23:53.304253 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_208"
[0m23:23:53.304579 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.530 seconds
[0m23:23:53.304795 [debug] [Thread-2 (]: On model.engage_analytics.qr_207: COMMIT
[0m23:23:53.304951 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.527 seconds
[0m23:23:53.305938 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_209"
[0m23:23:53.307508 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_210"
[0m23:23:53.307819 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:53.308152 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_209
[0m23:23:53.309402 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_backup"
[0m23:23:53.309604 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_208
[0m23:23:53.311265 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_209"
[0m23:23:53.311644 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:23:53.311850 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_210
[0m23:23:53.313408 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_208"
[0m23:23:53.313670 [debug] [Thread-2 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_backup" cascade
[0m23:23:53.315194 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_210"
[0m23:23:53.315575 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:23:53.315825 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: BEGIN
[0m23:23:53.316102 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:53.316395 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:53.316639 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:23:53.317340 [debug] [Thread-2 (]: On model.engage_analytics.qr_207: Close
[0m23:23:53.317537 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:23:53.317720 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:23:53.317884 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: BEGIN
[0m23:23:53.318124 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 4) (id: ipc-209, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990'
        then answer_value_text
      else null
      end
    )
    
      
            as "c04706e8-4a1e-4e6a-ac6e-be9dd8274990"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:53.318435 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb482f0>]}
[0m23:23:53.318598 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: BEGIN
[0m23:23:53.319040 [info ] [Thread-2 (]: 18 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_207  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:53.319467 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_207
[0m23:23:53.319726 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:53.320137 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_211
[0m23:23:53.320415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:53.320645 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:23:53.321003 [info ] [Thread-2 (]: 22 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_211 .... [RUN]
[0m23:23:53.321215 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:53.321412 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:23:53.322201 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 3 (id: ipc-208, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '6930d457-7bec-4983-832b-3220b163f505'
        then answer_value_text
      else null
      end
    )
    
      
            as "6930d457-7bec-4983-832b-3220b163f505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243'
        then answer_value_text
      else null
      end
    )
    
      
            as "57a5ca78-4761-466a-bba4-c0c84eab5243"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9543e3c-cbff-4d2a-b3df-bf96e509d9ca"
      
    
    ,
  
    max(
      
      case
      when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a'
        then answer_value_text
      else null
      end
    )
    
      
            as "1b59ddeb-483d-4b1b-af53-f3942204589a"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ed77f2a-0d5a-434d-b153-d8deadfbc3f8"
      
    
    ,
  
    max(
      
      case
      when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "0a15f38b-027a-42ff-b1e8-ca5e2b313f71"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19'
        then answer_value_text
      else null
      end
    )
    
      
            as "70e4d965-a614-4dc5-b2fa-4035f0444b19"
      
    
    ,
  
    max(
      
      case
      when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553'
        then answer_value_text
      else null
      end
    )
    
      
            as "601055c1-efe3-47d4-9510-1ed0cc565553"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ad7384f-a332-4e41-9318-0d3f9e540ee7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1755ad4-b33a-44a3-b562-4206a582c28a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "2fb4f2f4-23b5-4f36-b444-683563ea4fb3"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f1e5102-4441-49d8-9fbc-4ea6df196b43"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a126244-6ec2-4c81-a6d4-409dff788019"
      
    
    ,
  
    max(
      
      case
      when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473'
        then answer_value_text
      else null
      end
    )
    
      
            as "68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e17756cd-4861-4dde-859c-f90241977246'
        then answer_value_text
      else null
      end
    )
    
      
            as "e17756cd-4861-4dde-859c-f90241977246"
      
    
    ,
  
    max(
      
      case
      when linkid = '95121ef1-bfe5-40ce-841c-524334644148'
        then answer_value_text
      else null
      end
    )
    
      
            as "95121ef1-bfe5-40ce-841c-524334644148"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb78f289-5f7d-4c89-9ddf-6b393a268462"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f926bba-38b5-4b20-8852-5b9e317bb010"
      
    
    ,
  
    max(
      
      case
      when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263'
        then answer_value_text
      else null
      end
    )
    
      
            as "86bdafab-bb90-429e-8bc5-a90dc46e7263"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-2"
      
    
    ,
  
    max(
      
      case
      when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73'
        then answer_value_text
      else null
      end
    )
    
      
            as "747188c8-4fc0-43ea-92b4-9baa32567f73"
      
    
    ,
  
    max(
      
      case
      when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b'
        then answer_value_text
      else null
      end
    )
    
      
            as "55092b78-a252-44ed-9dcb-2fc78570dc8b"
      
    
    ,
  
    max(
      
      case
      when linkid = '547a07c2-f94c-4956-997f-0439626d0251'
        then answer_value_text
      else null
      end
    )
    
      
            as "547a07c2-f94c-4956-997f-0439626d0251"
      
    
    ,
  
    max(
      
      case
      when linkid = '920de190-557a-4233-91a3-4bf293f18214'
        then answer_value_text
      else null
      end
    )
    
      
            as "920de190-557a-4233-91a3-4bf293f18214"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ff4b5cb-2c44-434b-90e9-85c61a858097"
      
    
    ,
  
    max(
      
      case
      when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414'
        then answer_value_text
      else null
      end
    )
    
      
            as "83176bb3-c0cb-445a-a91b-6711635b1414"
      
    
    ,
  
    max(
      
      case
      when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90'
        then answer_value_text
      else null
      end
    )
    
      
            as "10cd5560-6c41-41a6-94c5-af74ce96dc90"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-021'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-021"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9'
        then answer_value_text
      else null
      end
    )
    
      
            as "a24c89ff-1e14-403c-8dfa-26fc6c1103d9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb8828db-1674-47e7-ba9a-e3c161160b65"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f63637c-1de2-4851-a088-c3b08152447e'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f63637c-1de2-4851-a088-c3b08152447e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44'
        then answer_value_text
      else null
      end
    )
    
      
            as "eea0b1ca-5582-4b45-b5cf-36bc0665ba44"
      
    
    ,
  
    max(
      
      case
      when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975'
        then answer_value_text
      else null
      end
    )
    
      
            as "5db949bd-4ebf-4d52-b850-8e951455e975"
      
    
    ,
  
    max(
      
      case
      when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "8c82f757-3f40-4b09-bdf4-78ee376f75a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c'
        then answer_value_text
      else null
      end
    )
    
      
            as "1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e0b76f9-0902-43ba-b858-0b1505e9d168"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359'
        then answer_value_text
      else null
      end
    )
    
      
            as "e245b7d9-955a-4c4b-a107-e2bf5d6d2359"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a77f07b3-7913-4708-a354-14e503a948f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd'
        then answer_value_text
      else null
      end
    )
    
      
            as "8ac792f5-3f3c-49d3-a800-63c662bf00cd"
      
    
    ,
  
    max(
      
      case
      when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3'
        then answer_value_text
      else null
      end
    )
    
      
            as "50cf6a9c-a837-4531-a13a-47381657c2b3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "c91209cc-1b2c-43f0-83f0-4704418ae2d5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc8f199a-59f0-4184-864d-b1c0befd26df"
      
    
    ,
  
    max(
      
      case
      when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593'
        then answer_value_text
      else null
      end
    )
    
      
            as "43801cc4-c61f-4ee0-82ad-cf6f1f799593"
      
    
    ,
  
    max(
      
      case
      when linkid = '4442589a-51b2-48c3-8297-b805e525642c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4442589a-51b2-48c3-8297-b805e525642c"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c95559d-86ff-4b87-a271-e52388072a53'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c95559d-86ff-4b87-a271-e52388072a53"
      
    
    ,
  
    max(
      
      case
      when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "451acc1a-26f4-4374-96da-09bfb47365a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cc2834b-0d28-43d0-8811-509995cfcdb8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299'
        then answer_value_text
      else null
      end
    )
    
      
            as "b24118e2-31c5-4e23-af3a-1722af72c299"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-1"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f7b6563-47b1-4ad4-abc3-cffdae40a57a"
      
    
    ,
  
    max(
      
      case
      when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-019'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-019"
      
    
    ,
  
    max(
      
      case
      when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5'
        then answer_value_text
      else null
      end
    )
    
      
            as "9e995f48-b092-49b2-a9e4-c7e754e446e5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9a9f492-8eb8-4c71-8ec6-f80ab596430b"
      
    
    ,
  
    max(
      
      case
      when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc'
        then answer_value_text
      else null
      end
    )
    
      
            as "1b3394a9-eaff-4871-9537-0d29f5712adc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc'
        then answer_value_text
      else null
      end
    )
    
      
            as "4554f4b2-d15e-47e7-a10d-d77939dd3afc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7f10195-b859-4670-abbc-a2498c4fe45f"
      
    
    ,
  
    max(
      
      case
      when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a'
        then answer_value_text
      else null
      end
    )
    
      
            as "232484cf-1aee-4bfa-a66e-61494587a16a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac6eb49b-3d37-4bac-8d27-1e1ad01018ce"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8b8e550-4d65-42be-acb9-2f4ac17c7f49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bed17079-d1e5-4bbe-af07-3d7b6a86243e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '665e1595-f169-4815-9d24-dac265f1809b'
        then answer_value_text
      else null
      end
    )
    
      
            as "665e1595-f169-4815-9d24-dac265f1809b"
      
    
    ,
  
    max(
      
      case
      when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21'
        then answer_value_text
      else null
      end
    )
    
      
            as "99079ebd-1665-4503-bb37-8de493dd4a21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-022'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-022"
      
    
    ,
  
    max(
      
      case
      when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef'
        then answer_value_text
      else null
      end
    )
    
      
            as "058278e4-33d6-4c0f-8127-ccf923bcc7ef"
      
    
    ,
  
    max(
      
      case
      when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd'
        then answer_value_text
      else null
      end
    )
    
      
            as "59744d45-0100-4d62-b105-5cbecd973ffd"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ecf12a4-a246-4b79-b281-65b3676ca3a4"
      
    
    ,
  
    max(
      
      case
      when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5'
        then answer_value_text
      else null
      end
    )
    
      
            as "77fc70ba-6cac-494c-b27a-77ebce2289e5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb0c7a5-a211-43ec-af7b-5f1079399133"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-024'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-024"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9'
        then answer_value_text
      else null
      end
    )
    
      
            as "969c0120-0b86-40e5-8881-6a145fe90aa9"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c9f8c1d-5827-4d21-bd33-3240fade93ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "6b5fa434-2fc3-4e4b-ad11-89f6260a81f2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6befba3-6d25-47ae-9cac-409dfae832a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92'
        then answer_value_text
      else null
      end
    )
    
      
            as "b31c0187-3e54-4fcf-9763-8b3f3850be92"
      
    
    ,
  
    max(
      
      case
      when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53'
        then answer_value_text
      else null
      end
    )
    
      
            as "9082f0ba-b8e5-495a-a2a4-b30918e19d53"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60'
        then answer_value_text
      else null
      end
    )
    
      
            as "b95949ec-f2ee-4d04-9e52-fb61dac18e60"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-020'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-020"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-023'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-023"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1a13d53-b867-440f-8622-bccebf54f176"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:53.323091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_207, now model.engage_analytics.qr_211)
[0m23:23:53.324755 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:23:53.325097 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 4) (id: ipc-210, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11'
        then answer_value_text
      else null
      end
    )
    
      
            as "62b55d32-de8e-4abd-8489-4e3aa9270e11"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e'
        then answer_value_text
      else null
      end
    )
    
      
            as "d590116a-ec42-46e3-8ab6-6259307af17e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8'
        then answer_value_text
      else null
      end
    )
    
      
            as "a4b58f6e-3046-4a11-9e9e-e6b1547594e8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef'
        then answer_value_text
      else null
      end
    )
    
      
            as "d5a448fb-4db7-45e8-858b-f2d2e7cb0eef"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:53.325546 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_211
[0m23:23:53.325809 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_tmp" rename to "qr_209"
[0m23:23:53.328396 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:23:53.328723 [debug] [Thread-2 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:53.328961 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:53.329169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:53.329353 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:53.330830 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:23:53.331582 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: COMMIT
[0m23:23:53.331762 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:23:53.331920 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_tmp" rename to "qr_210"
[0m23:23:53.332148 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:23:53.334359 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:23:53.334659 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: COMMIT
[0m23:23:53.334890 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_tmp" rename to "qr_208"
[0m23:23:53.335279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:53.335917 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: COMMIT
[0m23:23:53.336109 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:53.336293 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:23:53.336455 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:53.337623 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_backup"
[0m23:23:53.337824 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: COMMIT
[0m23:23:53.338521 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: COMMIT
[0m23:23:53.338943 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:23:53.339224 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:23:53.339412 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_backup" cascade
[0m23:23:53.339638 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: COMMIT
[0m23:23:53.339850 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:53.341114 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_backup"
[0m23:23:53.341347 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:53.341634 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:23:53.341958 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:23:53.343208 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_backup"
[0m23:23:53.343887 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: Close
[0m23:23:53.344117 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_backup" cascade
[0m23:23:53.344418 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:23:53.344742 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe7ec0>]}
[0m23:23:53.344932 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_backup" cascade
[0m23:23:53.345131 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:53.345454 [info ] [Thread-4 (]: 20 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_209  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:53.346234 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: Close
[0m23:23:53.346455 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:53.346750 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_209
[0m23:23:53.347560 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: Close
[0m23:23:53.347803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba43b0>]}
[0m23:23:53.348017 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_212
[0m23:23:53.348291 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbde420>]}
[0m23:23:53.348629 [info ] [Thread-1 (]: 21 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_210  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:53.348916 [info ] [Thread-4 (]: 23 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_212 .... [RUN]
[0m23:23:53.349403 [info ] [Thread-3 (]: 19 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_208  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:53.349699 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_210
[0m23:23:53.349951 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_209, now model.engage_analytics.qr_212)
[0m23:23:53.350255 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_208
[0m23:23:53.350492 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_221
[0m23:23:53.350723 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_212
[0m23:23:53.350971 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_23451
[0m23:23:53.351259 [info ] [Thread-1 (]: 24 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_221 .... [RUN]
[0m23:23:53.353692 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:23:53.354026 [info ] [Thread-3 (]: 25 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_23451 .. [RUN]
[0m23:23:53.354297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_210, now model.engage_analytics.qr_221)
[0m23:23:53.354494 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:53.354683 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_208, now model.engage_analytics.qr_23451)
[0m23:23:53.354863 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_221
[0m23:23:53.355027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:53.355184 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_23451
[0m23:23:53.357398 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:23:53.360183 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:23:53.360552 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:53.360769 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:53.360937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:53.361093 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:53.901083 [debug] [Thread-2 (]: SQL status: SELECT 13 in 0.572 seconds
[0m23:23:53.902451 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_211"
[0m23:23:53.902950 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_211
[0m23:23:53.904761 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_211"
[0m23:23:53.905192 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:23:53.905366 [debug] [Thread-2 (]: On model.engage_analytics.qr_211: BEGIN
[0m23:23:53.906258 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:53.906436 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:23:53.906683 [debug] [Thread-2 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 4) (id: ipc-211, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2'
        then answer_value_text
      else null
      end
    )
    
      
            as "01a4984f-7b50-47bb-9ae1-1b81ee4d6df2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b'
        then answer_value_text
      else null
      end
    )
    
      
            as "11d368a4-7f34-46d5-a8d0-6deed381945b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792'
        then answer_value_text
      else null
      end
    )
    
      
            as "4b86c897-4d68-405b-aa08-760ed6ff6792"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:53.909303 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:53.911235 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:23:53.911466 [debug] [Thread-2 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_tmp" rename to "qr_211"
[0m23:23:53.912389 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:53.913095 [debug] [Thread-2 (]: On model.engage_analytics.qr_211: COMMIT
[0m23:23:53.913290 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:23:53.913452 [debug] [Thread-2 (]: On model.engage_analytics.qr_211: COMMIT
[0m23:23:53.914407 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:53.916289 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_backup"
[0m23:23:53.916665 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:23:53.916836 [debug] [Thread-2 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_backup" cascade
[0m23:23:53.917595 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:53.918426 [debug] [Thread-2 (]: On model.engage_analytics.qr_211: Close
[0m23:23:53.918745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc4a5a0>]}
[0m23:23:53.919061 [info ] [Thread-2 (]: 22 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_211  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:53.919327 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_211
[0m23:23:53.919516 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_54
[0m23:23:53.919719 [info ] [Thread-2 (]: 26 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_54 ..... [RUN]
[0m23:23:53.919937 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.559 seconds
[0m23:23:53.920168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_211, now model.engage_analytics.qr_54)
[0m23:23:53.921158 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_23451"
[0m23:23:53.921354 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_54
[0m23:23:53.923879 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:23:53.924126 [debug] [Thread-2 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:53.924344 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:53.924650 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_23451
[0m23:23:53.926620 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_23451"
[0m23:23:53.926902 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.566 seconds
[0m23:23:53.927128 [debug] [Thread-4 (]: SQL status: SELECT 159 in 0.572 seconds
[0m23:23:53.928889 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_221"
[0m23:23:53.934543 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_212"
[0m23:23:53.934895 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:23:53.935125 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: BEGIN
[0m23:23:53.935402 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_221
[0m23:23:53.975816 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_221"
[0m23:23:53.976161 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m23:23:53.976351 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_212
[0m23:23:53.976571 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:23:53.978151 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_212"
[0m23:23:53.978409 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Discuss Confidentiality (id: ipc-23451, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:53.978800 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:23:53.979070 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: BEGIN
[0m23:23:53.979389 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:23:53.979580 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: BEGIN
[0m23:23:53.979824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:53.980031 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:23:53.980396 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Add Family Member Registration (id: ipc-221, url: n/a, version: 0.0.3)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9aa068d-8d94-4b3d-b9da-ce05a59cecdd"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6306275-b989-4375-8527-3a56092081b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6306275-b989-4375-8527-3a56092081b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-best-represents-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-best-represents-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = 'do-you-have-medicaid'
        then answer_value_text
      else null
      end
    )
    
      
            as "do-you-have-medicaid"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d'
        then answer_value_text
      else null
      end
    )
    
      
            as "8fb87910-d900-4eea-dbba-dcf76ee6806d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'choice-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "choice-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'medicaid-number'
        then answer_value_text
      else null
      end
    )
    
      
            as "medicaid-number"
      
    
    ,
  
    max(
      
      case
      when linkid = 'physical-address'
        then answer_value_text
      else null
      end
    )
    
      
            as "physical-address"
      
    
    ,
  
    max(
      
      case
      when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271'
        then answer_value_text
      else null
      end
    )
    
      
            as "77e32953-0679-48b5-f004-1ab4a4ac0271"
      
    
    ,
  
    max(
      
      case
      when linkid = 'choice-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "choice-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'zip-code'
        then answer_value_text
      else null
      end
    )
    
      
            as "zip-code"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'phone-number'
        then answer_value_text
      else null
      end
    )
    
      
            as "phone-number"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-biological-sex-at-birth'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-biological-sex-at-birth"
      
    
    ,
  
    max(
      
      case
      when linkid = 'where-did-you-first-learn-about-engage'
        then answer_value_text
      else null
      end
    )
    
      
            as "where-did-you-first-learn-about-engage"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-where-did-you-first-learn-about-engage'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-where-did-you-first-learn-about-engage"
      
    
    ,
  
    max(
      
      case
      when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff'
        then answer_value_text
      else null
      end
    )
    
      
            as "36d39dbe-00e2-4e29-f079-3ec8f0119aff"
      
    
    ,
  
    max(
      
      case
      when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd'
        then answer_value_text
      else null
      end
    )
    
      
            as "597f4425-72b3-4bc4-8f38-b742aa3e99cd"
      
    
    ,
  
    max(
      
      case
      when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7'
        then answer_value_text
      else null
      end
    )
    
      
            as "8460d986-ef71-4997-80ee-7887d8c345e7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c31ef6d1-336b-4260-9881-67ba7b477ae0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'email-address'
        then answer_value_text
      else null
      end
    )
    
      
            as "email-address"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f'
        then answer_value_text
      else null
      end
    )
    
      
            as "c02a80e7-ebf0-48b5-9752-28a48dba487f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'age'
        then answer_value_text
      else null
      end
    )
    
      
            as "age"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:53.980828 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:53.981047 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:53.981251 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:23:53.982733 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:23:53.983875 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SBIRT (id: ipc-212, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'is-drug-dependence'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-drug-dependence"
      
    
    ,
  
    max(
      
      case
      when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812'
        then answer_value_text
      else null
      end
    )
    
      
            as "287b1b6c-fe58-4245-90dc-87d72d296812"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ad609c63-366e-476a-b131-610ceed211da'
        then answer_value_text
      else null
      end
    )
    
      
            as "ad609c63-366e-476a-b131-610ceed211da"
      
    
    ,
  
    max(
      
      case
      when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3'
        then answer_value_text
      else null
      end
    )
    
      
            as "38eb7cfd-8f4a-4743-b856-c8ddd529dac3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19'
        then answer_value_text
      else null
      end
    )
    
      
            as "ff55dd63-f51c-420b-97a0-f957d31d6b19"
      
    
    ,
  
    max(
      
      case
      when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2'
        then answer_value_text
      else null
      end
    )
    
      
            as "958d0ff5-edd9-4d25-9f4d-4ff29289bbe2"
      
    
    ,
  
    max(
      
      case
      when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4'
        then answer_value_text
      else null
      end
    )
    
      
            as "86daa888-2174-4fdc-9200-cbfdbe430ab4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-is-medium-high-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-is-medium-high-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae15db19-8d0c-465a-a925-3e0503f0a25b"
      
    
    ,
  
    max(
      
      case
      when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116'
        then answer_value_text
      else null
      end
    )
    
      
            as "73b23b0b-ff20-4eb9-aebb-a34432897116"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "b11bfd65-1f8d-4dee-8a9e-b2044382c0d5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2c84a83-1568-4593-9ea4-4f6c3978edd6"
      
    
    ,
  
    max(
      
      case
      when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515'
        then answer_value_text
      else null
      end
    )
    
      
            as "28edfdea-ec6f-4d33-80e2-6d7323b3b515"
      
    
    ,
  
    max(
      
      case
      when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78'
        then answer_value_text
      else null
      end
    )
    
      
            as "19d44e35-f7b5-43e3-be3b-fdb820503f78"
      
    
    ,
  
    max(
      
      case
      when linkid = '39843731-a8e7-4822-bad7-55489947ebeb'
        then answer_value_text
      else null
      end
    )
    
      
            as "39843731-a8e7-4822-bad7-55489947ebeb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491'
        then answer_value_text
      else null
      end
    )
    
      
            as "db7cc8b8-b558-41c8-9849-a80252710491"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    ,
  
    max(
      
      case
      when linkid = 'should-discuss-health-goals'
        then answer_value_text
      else null
      end
    )
    
      
            as "should-discuss-health-goals"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f1fb719-c235-4826-a53e-24502bc620cc"
      
    
    ,
  
    max(
      
      case
      when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3'
        then answer_value_text
      else null
      end
    )
    
      
            as "7f8ade46-1d91-40a0-b67e-015a5a6aadc3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb'
        then answer_value_text
      else null
      end
    )
    
      
            as "2336b352-cd6b-4044-8879-a5425c4ae5cb"
      
    
    ,
  
    max(
      
      case
      when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3'
        then answer_value_text
      else null
      end
    )
    
      
            as "48d61a4b-d87d-4661-96dd-42766dbe8cc3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4317308-24ec-4ce6-8659-54d4f1aa7e96"
      
    
    ,
  
    max(
      
      case
      when linkid = '0466b304-2876-409b-ade2-d1c675614854'
        then answer_value_text
      else null
      end
    )
    
      
            as "0466b304-2876-409b-ade2-d1c675614854"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-medium-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-medium-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f'
        then answer_value_text
      else null
      end
    )
    
      
            as "687cad76-ce92-4dca-b94f-58070b33da6f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'using-opioids-and-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "using-opioids-and-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474'
        then answer_value_text
      else null
      end
    )
    
      
            as "88accd91-b2ff-4bba-a5b1-58eaef458474"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "d169ab54-4544-4d1a-8687-6abc289982a4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41'
        then answer_value_text
      else null
      end
    )
    
      
            as "daf9b1ff-06c5-45a7-a3d1-26977a2e2b41"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7'
        then answer_value_text
      else null
      end
    )
    
      
            as "b87d6054-9f94-456f-b7f6-67c73be8acc7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa901327-bb55-4e04-a72b-5bcc7eb22404"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-discuss-next-steps'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-discuss-next-steps"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990'
        then answer_value_text
      else null
      end
    )
    
      
            as "c0911201-29b6-4cff-8cf8-fca31dc2b990"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d'
        then answer_value_text
      else null
      end
    )
    
      
            as "d11e0ac3-5faf-4986-a633-22efa8c74c4d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7444114-6b17-4300-80a1-a6376fd135d4"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c5e1af3-63d6-4283-9ea3-ef2b49314b1a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671'
        then answer_value_text
      else null
      end
    )
    
      
            as "092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197'
        then answer_value_text
      else null
      end
    )
    
      
            as "dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ab8f95f3-3ca8-439f-afc2-c95a0853f9f4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40'
        then answer_value_text
      else null
      end
    )
    
      
            as "da17f7fc-0919-44cb-a41c-fa8480bd3c40"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49'
        then answer_value_text
      else null
      end
    )
    
      
            as "db4b99b9-2cae-4833-bb08-fe7e94156b49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "ba444442-73b2-44be-b55e-c8f9fba8f7a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '1600f791-fd2c-44d8-8384-37973785741b'
        then answer_value_text
      else null
      end
    )
    
      
            as "1600f791-fd2c-44d8-8384-37973785741b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "eaa83f10-5cad-4c71-96b9-528e45af44fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-drug-list'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-drug-list"
      
    
    ,
  
    max(
      
      case
      when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848'
        then answer_value_text
      else null
      end
    )
    
      
            as "abb64c97-d3a9-45a2-bec2-11f6c4dc8848"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a36058d0-3ac9-4cf6-aabb-6b4859dc985d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267'
        then answer_value_text
      else null
      end
    )
    
      
            as "b81b6e43-3b57-489e-8ea9-f35d82f9f267"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-opioid-dependence'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-opioid-dependence"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-low-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-low-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = 'score-audit'
        then answer_value_text
      else null
      end
    )
    
      
            as "score-audit"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-high-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-high-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11'
        then answer_value_text
      else null
      end
    )
    
      
            as "a713e390-f199-4ed4-9a27-b9938fbf8b11"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec346c72-9835-4b5a-8088-1797a200f995"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-medium-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-medium-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e'
        then answer_value_text
      else null
      end
    )
    
      
            as "232a2454-1d23-4ec9-b4ee-65e3a48afb3e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1d97a4-bb16-4c46-bcee-5593f472b53b"
      
    
    ,
  
    max(
      
      case
      when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "272246d4-b9c5-4a8b-a349-12f75cf888d0"
      
    
    ,
  
    max(
      
      case
      when linkid = '36af2335-ac86-4864-8a3d-619451160cc5'
        then answer_value_text
      else null
      end
    )
    
      
            as "36af2335-ac86-4864-8a3d-619451160cc5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ad8b269-9415-4551-8d00-9be8812bde01"
      
    
    ,
  
    max(
      
      case
      when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41'
        then answer_value_text
      else null
      end
    )
    
      
            as "49ee0853-7d07-40af-a139-7cacc302ee41"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c08dae42-df65-4dba-98c6-47f9e5dafcb0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c'
        then answer_value_text
      else null
      end
    )
    
      
            as "c6c7bd0c-812d-4931-b94c-929aa04dc45c"
      
    
    ,
  
    max(
      
      case
      when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e'
        then answer_value_text
      else null
      end
    )
    
      
            as "705b4c26-4479-4d6a-adbe-b8ebdbad302e"
      
    
    ,
  
    max(
      
      case
      when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b'
        then answer_value_text
      else null
      end
    )
    
      
            as "9dfe8a90-6551-4ae4-bcfb-c839e429a87b"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ee9b164-9830-4f7a-8317-28e0cfc1852c"
      
    
    ,
  
    max(
      
      case
      when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "1bc8823a-bbb1-444a-ad1b-dc09f57038ce"
      
    
    ,
  
    max(
      
      case
      when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5'
        then answer_value_text
      else null
      end
    )
    
      
            as "724d0558-550c-4edc-a1d6-3bd1285bc8a5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a"
      
    
    ,
  
    max(
      
      case
      when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e'
        then answer_value_text
      else null
      end
    )
    
      
            as "54f4cac5-ac52-4caa-a6b9-f8b4a412d92e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef06e3fc-45f0-40a3-aca9-43293339689b"
      
    
    ,
  
    max(
      
      case
      when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d'
        then answer_value_text
      else null
      end
    )
    
      
            as "859d58d6-ee56-4ede-9773-0b7650d7c66d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-things-to-do'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-things-to-do"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-goals'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-goals"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844'
        then answer_value_text
      else null
      end
    )
    
      
            as "da46a37c-1678-4f34-80b5-f69589bc8844"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88'
        then answer_value_text
      else null
      end
    )
    
      
            as "f53db683-31e1-4d83-82c4-7e3a02f9ee88"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-sbirt-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-sbirt-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7443184-d141-4bce-93fc-c393132c73b1"
      
    
    ,
  
    max(
      
      case
      when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a'
        then answer_value_text
      else null
      end
    )
    
      
            as "21a9c779-27be-4c08-b9ab-b0d84964145a"
      
    
    ,
  
    max(
      
      case
      when linkid = '654d5688-f42a-469b-8494-81115b760e29'
        then answer_value_text
      else null
      end
    )
    
      
            as "654d5688-f42a-469b-8494-81115b760e29"
      
    
    ,
  
    max(
      
      case
      when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "1eb189a2-2ae1-4a27-b4cf-9161447ff8b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6d0780b-f202-416d-8d9b-c418a4bdb5d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e'
        then answer_value_text
      else null
      end
    )
    
      
            as "c93222e9-84f3-44a3-a87d-d92dafdc558e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4bd2450-08cb-410f-8f81-743d84749347"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-intervention-when-medium-high-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-intervention-when-medium-high-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04'
        then answer_value_text
      else null
      end
    )
    
      
            as "893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb3e9da-948e-4d05-8cad-58d293f557f6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e06c266d-8bd5-4232-85dc-f61a9d33aff2"
      
    
    ,
  
    max(
      
      case
      when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef'
        then answer_value_text
      else null
      end
    )
    
      
            as "9724b66b-2162-4984-b352-0bc27bcfdfef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1'
        then answer_value_text
      else null
      end
    )
    
      
            as "fae920b4-84d9-4576-9fac-51cba163ffd1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9fc5555-b1e6-4251-8047-13162c0b0cca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5787dda-4b43-4ae0-8cea-3062732f5a9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509'
        then answer_value_text
      else null
      end
    )
    
      
            as "ebf2e364-e7d7-44ec-a463-757c8e24d509"
      
    
    ,
  
    max(
      
      case
      when linkid = 'health-goals-do-not-want-to-change'
        then answer_value_text
      else null
      end
    )
    
      
            as "health-goals-do-not-want-to-change"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-low-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-low-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e1d29fe-7774-4731-bf50-ce5faaf0a528"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9a44d1a-ecf7-43af-835c-f4b5f73828d3"
      
    
    ,
  
    max(
      
      case
      when linkid = '582271e0-892e-4795-ac55-0b73baf828ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "582271e0-892e-4795-ac55-0b73baf828ca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db'
        then answer_value_text
      else null
      end
    )
    
      
            as "da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db"
      
    
    ,
  
    max(
      
      case
      when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f'
        then answer_value_text
      else null
      end
    )
    
      
            as "380d715b-abd0-4808-9ec4-0a1aabf9a33f"
      
    
    ,
  
    max(
      
      case
      when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5'
        then answer_value_text
      else null
      end
    )
    
      
            as "386eb911-a4c5-4207-9dab-8d5973069ac5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-to-use-marijuana-or-other'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-to-use-marijuana-or-other"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-to-use-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-to-use-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '6281fa0d-ef3f-4013-bd31-062371828010'
        then answer_value_text
      else null
      end
    )
    
      
            as "6281fa0d-ef3f-4013-bd31-062371828010"
      
    
    ,
  
    max(
      
      case
      when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "0eb07ad0-c8fa-49b6-9c27-064d844b6c4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5fa54c70-1483-4dfa-92fc-22ec4d90593c"
      
    
    ,
  
    max(
      
      case
      when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb'
        then answer_value_text
      else null
      end
    )
    
      
            as "5de2f3d9-de95-4871-919e-a00bb4f346bb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa01eb31-553b-415c-bb90-1ec8d07e979e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b8c1391-ba62-4800-ab3d-287fd7a9a3a5"
      
    
    ,
  
    max(
      
      case
      when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1'
        then answer_value_text
      else null
      end
    )
    
      
            as "94dc51b7-59e3-4276-9afe-9b18cb7a08e1"
      
    
    ,
  
    max(
      
      case
      when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3'
        then answer_value_text
      else null
      end
    )
    
      
            as "7baaf5ce-f19b-4a40-980e-cfe53efac3f3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1d9ecfa-c456-4109-8807-b8e26ffb69aa"
      
    
    ,
  
    max(
      
      case
      when linkid = 'edced328-6f82-458a-bce4-35987bff19fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "edced328-6f82-458a-bce4-35987bff19fb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8'
        then answer_value_text
      else null
      end
    )
    
      
            as "a44b78b7-d5ab-49a8-958d-5545072692d8"
      
    
    ,
  
    max(
      
      case
      when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e'
        then answer_value_text
      else null
      end
    )
    
      
            as "642b120d-78f5-4ec6-9cbf-d3b9e336083e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041'
        then answer_value_text
      else null
      end
    )
    
      
            as "af4330a4-7bc7-48db-bce8-364b0ff4b041"
      
    
    ,
  
    max(
      
      case
      when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa'
        then answer_value_text
      else null
      end
    )
    
      
            as "2badbdc1-2d13-4368-b803-c2eb7a2647aa"
      
    
    ,
  
    max(
      
      case
      when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045'
        then answer_value_text
      else null
      end
    )
    
      
            as "590f26f6-d5e5-4b56-b3a8-415e038dc045"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "ba10b935-7861-4ce4-a2c6-88bdd97709fb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084'
        then answer_value_text
      else null
      end
    )
    
      
            as "fac09a6e-c280-426d-94a1-0aa707e35084"
      
    
    ,
  
    max(
      
      case
      when linkid = 'score-dast'
        then answer_value_text
      else null
      end
    )
    
      
            as "score-dast"
      
    
    ,
  
    max(
      
      case
      when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368'
        then answer_value_text
      else null
      end
    )
    
      
            as "9d8d7688-d1ed-4851-a6ea-59bc296f5368"
      
    
    ,
  
    max(
      
      case
      when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985'
        then answer_value_text
      else null
      end
    )
    
      
            as "818b51b8-c7b3-4d64-8142-1c0798662985"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3e99643-32dc-4e2e-983c-e694159623e3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'should-converse-about-substance-use'
        then answer_value_text
      else null
      end
    )
    
      
            as "should-converse-about-substance-use"
      
    
    ,
  
    max(
      
      case
      when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3'
        then answer_value_text
      else null
      end
    )
    
      
            as "43dead8d-380d-4214-80f1-a1961b916bd3"
      
    
    ,
  
    max(
      
      case
      when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96'
        then answer_value_text
      else null
      end
    )
    
      
            as "8bcb58a6-5720-4746-b0d0-22d6b6ec7c96"
      
    
    ,
  
    max(
      
      case
      when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848'
        then answer_value_text
      else null
      end
    )
    
      
            as "71679b91-ee7b-4eda-9f9d-cf85645ee848"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-intervention-when-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-intervention-when-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427"
      
    
    ,
  
    max(
      
      case
      when linkid = '8427af19-3bad-4713-bad9-b179437fef96'
        then answer_value_text
      else null
      end
    )
    
      
            as "8427af19-3bad-4713-bad9-b179437fef96"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8e7d8b0-88e2-4bae-8990-c3ae94165ef9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba'
        then answer_value_text
      else null
      end
    )
    
      
            as "fd89df57-4b13-432f-a5b9-d54918f8d4ba"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-high-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-high-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9'
        then answer_value_text
      else null
      end
    )
    
      
            as "15799969-7565-4c3e-b488-d6a65d66c6c9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4"
      
    
    ,
  
    max(
      
      case
      when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd'
        then answer_value_text
      else null
      end
    )
    
      
            as "9346e7e0-e74b-452a-addc-e6ad13d016dd"
      
    
    ,
  
    max(
      
      case
      when linkid = '90876967-c973-4bee-9217-8c7482cb12a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "90876967-c973-4bee-9217-8c7482cb12a2"
      
    
    ,
  
    max(
      
      case
      when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e2b0891-5355-4ffd-8a18-66193a0dbfbe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-summary-for-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-summary-for-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299'
        then answer_value_text
      else null
      end
    )
    
      
            as "c5437ab8-5d0c-4157-b06a-b5ec491dc299"
      
    
    ,
  
    max(
      
      case
      when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621'
        then answer_value_text
      else null
      end
    )
    
      
            as "67c70e9e-2e10-4d4a-b354-95621a05c621"
      
    
    ,
  
    max(
      
      case
      when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f'
        then answer_value_text
      else null
      end
    )
    
      
            as "49bafbbf-8110-46a0-83f4-802cb1b6fd0f"
      
    
    ,
  
    max(
      
      case
      when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069'
        then answer_value_text
      else null
      end
    )
    
      
            as "6f1dfe02-2dbb-4371-ab06-a8c915495069"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-client-use-with-other-drugs'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-client-use-with-other-drugs"
      
    
    ,
  
    max(
      
      case
      when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730'
        then answer_value_text
      else null
      end
    )
    
      
            as "445adcc0-9c5f-4647-b339-fcb5835f1730"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:53.985069 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:23:53.985237 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_tmp" rename to "qr_23451"
[0m23:23:53.986829 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:23:53.987116 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_tmp" rename to "qr_221"
[0m23:23:53.987702 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:53.988416 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: COMMIT
[0m23:23:53.988664 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:23:53.988843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:23:53.989015 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: COMMIT
[0m23:23:53.989672 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: COMMIT
[0m23:23:53.989896 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:23:53.990046 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: COMMIT
[0m23:23:53.991046 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:53.991258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:53.992462 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_backup"
[0m23:23:53.993509 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_backup"
[0m23:23:53.993697 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:23:53.994023 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:23:53.994384 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:23:53.995938 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:23:53.996209 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_backup" cascade
[0m23:23:53.996439 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_backup" cascade
[0m23:23:53.996640 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_tmp" rename to "qr_212"
[0m23:23:53.997429 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:53.998137 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: Close
[0m23:23:53.998323 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:53.998952 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: Close
[0m23:23:53.999243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc76960>]}
[0m23:23:53.999807 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:23:54.000378 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: COMMIT
[0m23:23:54.000602 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:23:54.000800 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: COMMIT
[0m23:23:54.001062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb1ab70>]}
[0m23:23:54.002419 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:54.004151 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_backup"
[0m23:23:54.004668 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:23:54.004871 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_backup" cascade
[0m23:23:54.005951 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:54.006685 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: Close
[0m23:23:54.007008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc425a0>]}
[0m23:23:54.086562 [debug] [Thread-3 (]: An error was encountered while trying to send an event
[0m23:23:54.086965 [info ] [Thread-1 (]: 24 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_221  [[32mCREATE VIEW[0m in 0.65s]
[0m23:23:54.087240 [info ] [Thread-4 (]: 23 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_212  [[32mCREATE VIEW[0m in 0.66s]
[0m23:23:54.087655 [info ] [Thread-3 (]: 25 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_23451  [[32mCREATE VIEW[0m in 0.64s]
[0m23:23:54.087941 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_221
[0m23:23:54.088201 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_212
[0m23:23:54.088408 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_23451
[0m23:23:54.088592 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_55
[0m23:23:54.088752 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_56
[0m23:23:54.088937 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_57
[0m23:23:54.089125 [info ] [Thread-1 (]: 27 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_55 ..... [RUN]
[0m23:23:54.089368 [info ] [Thread-4 (]: 28 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_56 ..... [RUN]
[0m23:23:54.089796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_221, now model.engage_analytics.qr_55)
[0m23:23:54.089568 [info ] [Thread-3 (]: 29 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_57 ..... [RUN]
[0m23:23:54.090095 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_212, now model.engage_analytics.qr_56)
[0m23:23:54.090310 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_55
[0m23:23:54.090516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_23451, now model.engage_analytics.qr_57)
[0m23:23:54.090693 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_56
[0m23:23:54.093860 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:23:54.094090 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_57
[0m23:23:54.095985 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:23:54.096223 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:54.098279 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:23:54.098489 [debug] [Thread-4 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:54.098665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:54.098828 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:54.098979 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:54.099228 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:54.457998 [debug] [Thread-2 (]: SQL status: SELECT 21 in 0.534 seconds
[0m23:23:54.459682 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_54"
[0m23:23:54.460399 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_54
[0m23:23:54.462240 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_54"
[0m23:23:54.462719 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:23:54.462892 [debug] [Thread-2 (]: On model.engage_analytics.qr_54: BEGIN
[0m23:23:54.463803 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:54.464053 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:23:54.464366 [debug] [Thread-2 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 1) (id: ipc-54, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0'
        then answer_value_text
      else null
      end
    )
    
      
            as "0cfe26b9-8cd8-4d03-938f-991ebab4b3c0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5675128-0cd4-423f-840c-8dcff1e2a429"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a05b4fe-b514-4751-91be-adb1b278430c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-phq-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-phq-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:54.467414 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:54.469025 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:23:54.469203 [debug] [Thread-2 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_tmp" rename to "qr_54"
[0m23:23:54.470024 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:54.470598 [debug] [Thread-2 (]: On model.engage_analytics.qr_54: COMMIT
[0m23:23:54.470760 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:23:54.470900 [debug] [Thread-2 (]: On model.engage_analytics.qr_54: COMMIT
[0m23:23:54.471779 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:54.473094 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_backup"
[0m23:23:54.473373 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:23:54.473536 [debug] [Thread-2 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_backup" cascade
[0m23:23:54.474074 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:54.474693 [debug] [Thread-2 (]: On model.engage_analytics.qr_54: Close
[0m23:23:54.474964 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb6fad0>]}
[0m23:23:54.475306 [info ] [Thread-2 (]: 26 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_54  [[32mCREATE VIEW[0m in 0.55s]
[0m23:23:54.475552 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_54
[0m23:23:54.475730 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_58
[0m23:23:54.475950 [info ] [Thread-2 (]: 30 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_58 ..... [RUN]
[0m23:23:54.476136 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_54, now model.engage_analytics.qr_58)
[0m23:23:54.476289 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_58
[0m23:23:54.478571 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:23:54.478812 [debug] [Thread-2 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:54.478990 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:54.632881 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.533 seconds
[0m23:23:54.635799 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_57"
[0m23:23:54.636158 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.537 seconds
[0m23:23:54.637867 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_56"
[0m23:23:54.638313 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_57
[0m23:23:54.640809 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_57"
[0m23:23:54.641231 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_56
[0m23:23:54.643131 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_56"
[0m23:23:54.643628 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:23:54.643828 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: BEGIN
[0m23:23:54.644020 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:23:54.644227 [debug] [Thread-4 (]: On model.engage_analytics.qr_56: BEGIN
[0m23:23:54.644915 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:54.645171 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:54.645391 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:23:54.645594 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:23:54.645922 [debug] [Thread-4 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 2) (id: ipc-56, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4'
        then answer_value_text
      else null
      end
    )
    
      
            as "c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d'
        then answer_value_text
      else null
      end
    )
    
      
            as "dd349377-e542-4b4f-8fba-795f91431f7d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-ptsd-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-ptsd-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb'
        then answer_value_text
      else null
      end
    )
    
      
            as "9de6571c-3f74-4694-a567-ac5c897f96cb"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "931dc4ee-b677-4812-9372-3fea7012e9bc"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:54.646358 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 2) (id: ipc-57, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "7239b680-ef7a-4f9f-87ff-a77bf21d96d4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172'
        then answer_value_text
      else null
      end
    )
    
      
            as "7afb89dc-d53b-4dc3-a185-43dbb4854172"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a07491bd-039d-417b-9caf-0af536316594'
        then answer_value_text
      else null
      end
    )
    
      
            as "a07491bd-039d-417b-9caf-0af536316594"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-phq-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-phq-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:54.646728 [debug] [Thread-1 (]: SQL status: SELECT 111 in 0.548 seconds
[0m23:23:54.650989 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_55"
[0m23:23:54.651272 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:23:54.651542 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:23:54.653249 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:23:54.654624 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:23:54.654892 [debug] [Thread-4 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_tmp" rename to "qr_56"
[0m23:23:54.655192 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_tmp" rename to "qr_57"
[0m23:23:54.655411 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_55
[0m23:23:54.657114 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_55"
[0m23:23:54.657370 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:23:54.658002 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: COMMIT
[0m23:23:54.658182 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:23:54.658349 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:23:54.658508 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: COMMIT
[0m23:23:54.659067 [debug] [Thread-4 (]: On model.engage_analytics.qr_56: COMMIT
[0m23:23:54.659260 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:23:54.659439 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:23:54.659603 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: BEGIN
[0m23:23:54.659766 [debug] [Thread-4 (]: On model.engage_analytics.qr_56: COMMIT
[0m23:23:54.660428 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:54.660682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:54.660862 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:54.662352 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_backup"
[0m23:23:54.662539 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:23:54.663485 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_backup"
[0m23:23:54.663768 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:23:54.664580 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 1 (id: ipc-55, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.73.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.73.2"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b0a751e-936e-40e8-9076-c7fe1e818c1f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.43.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.43.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '69125945-bec7-4810-985a-8c1052e8d039'
        then answer_value_text
      else null
      end
    )
    
      
            as "69125945-bec7-4810-985a-8c1052e8d039"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.88.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.88.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-012'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-012"
      
    
    ,
  
    max(
      
      case
      when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67'
        then answer_value_text
      else null
      end
    )
    
      
            as "47eaf38f-c74e-484a-af95-b0002074bf67"
      
    
    ,
  
    max(
      
      case
      when linkid = '16333904-aad5-4166-9593-b7286c7b20b2'
        then answer_value_text
      else null
      end
    )
    
      
            as "16333904-aad5-4166-9593-b7286c7b20b2"
      
    
    ,
  
    max(
      
      case
      when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727'
        then answer_value_text
      else null
      end
    )
    
      
            as "8085cded-8e0f-497f-9e3d-5fab3981d727"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.82.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.82.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204'
        then answer_value_text
      else null
      end
    )
    
      
            as "d126d866-b8c4-4288-84ff-49a40f20e204"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.87.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.87.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a88cb2bf-e23b-423b-9a22-ab94678ccc3a"
      
    
    ,
  
    max(
      
      case
      when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89'
        then answer_value_text
      else null
      end
    )
    
      
            as "31a9e716-52ce-4651-bb17-26f442e2ab89"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c'
        then answer_value_text
      else null
      end
    )
    
      
            as "1ae11d83-35d4-41c0-a804-5ddf6b1c388c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-008'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-008"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd69a7a1-ec17-4f43-8597-26c59732261b"
      
    
    ,
  
    max(
      
      case
      when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a'
        then answer_value_text
      else null
      end
    )
    
      
            as "13d72f63-dd18-41f9-bf46-44981f2f804a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.68.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.68.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.78.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.78.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.92.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.92.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-1"
      
    
    ,
  
    max(
      
      case
      when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "82cdd7f0-f3d1-4eba-a31e-c6ad367742f4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.2"
      
    
    ,
  
    max(
      
      case
      when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b'
        then answer_value_text
      else null
      end
    )
    
      
            as "0de42ce5-6d9f-40ec-b67b-3d3b975d363b"
      
    
    ,
  
    max(
      
      case
      when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "78bc8272-eba1-48a8-a2f4-0e47304887b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.81.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.81.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892'
        then answer_value_text
      else null
      end
    )
    
      
            as "b1b6bebb-0cb7-4029-b320-01d3270ee892"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '07b722c9-210e-491a-8933-2e9aab3474af'
        then answer_value_text
      else null
      end
    )
    
      
            as "07b722c9-210e-491a-8933-2e9aab3474af"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '1809cb03-235d-4855-b201-7b296b160e37'
        then answer_value_text
      else null
      end
    )
    
      
            as "1809cb03-235d-4855-b201-7b296b160e37"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-009'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-009"
      
    
    ,
  
    max(
      
      case
      when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "24f9ed3b-3706-43fb-9779-07a9c2077e9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523'
        then answer_value_text
      else null
      end
    )
    
      
            as "69ed5884-0814-4ae0-a7f1-ecf730710523"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123'
        then answer_value_text
      else null
      end
    )
    
      
            as "347d89f5-1bad-4ba5-8f45-e63972b02123"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d'
        then answer_value_text
      else null
      end
    )
    
      
            as "c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.11'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.11"
      
    
    ,
  
    max(
      
      case
      when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73'
        then answer_value_text
      else null
      end
    )
    
      
            as "798d2c43-5b9f-436f-9fa2-f360cbeeea73"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7b59772-0272-41f6-ba66-16b09a832fc1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.79.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.79.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.12'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.12"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037'
        then answer_value_text
      else null
      end
    )
    
      
            as "f11ace93-5d84-4cc5-8598-58f9c5623037"
      
    
    ,
  
    max(
      
      case
      when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690'
        then answer_value_text
      else null
      end
    )
    
      
            as "54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408'
        then answer_value_text
      else null
      end
    )
    
      
            as "19416221-7c67-44d7-9b9b-b88364ea7408"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf'
        then answer_value_text
      else null
      end
    )
    
      
            as "80344998-41e2-4669-a77e-1fdaebe88bcf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.89.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.89.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.38.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.38.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2629251-1266-4760-a539-f0e680df651b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2629251-1266-4760-a539-f0e680df651b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-010'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-010"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.72.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.72.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b'
        then answer_value_text
      else null
      end
    )
    
      
            as "b322e52d-99f3-48e0-bda0-09d95228ae7b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8bfb690-b135-4b0f-9291-f6247611ce52"
      
    
    ,
  
    max(
      
      case
      when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5e65c0dc-5524-4f3d-8404-a7427a34e61c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "d58c8907-06c6-4071-aa6c-b2b95d2169c7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685'
        then answer_value_text
      else null
      end
    )
    
      
            as "0627ed93-c89d-48ae-bde2-bd013dc58685"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.38.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.38.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655'
        then answer_value_text
      else null
      end
    )
    
      
            as "d6c7419a-9082-4579-8678-44e866ab3655"
      
    
    ,
  
    max(
      
      case
      when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface'
        then answer_value_text
      else null
      end
    )
    
      
            as "528fa2c7-7a88-4d4e-b2ba-38c1384aface"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.9'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.74.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.74.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe689023-f019-483b-ba7c-8ff0e16129d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '042e5415-93de-419d-9bac-632596939280'
        then answer_value_text
      else null
      end
    )
    
      
            as "042e5415-93de-419d-9bac-632596939280"
      
    
    ,
  
    max(
      
      case
      when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b'
        then answer_value_text
      else null
      end
    )
    
      
            as "37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.42.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.42.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd785881-7e04-4093-b191-d845edea4c9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.46.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.46.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd'
        then answer_value_text
      else null
      end
    )
    
      
            as "5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd"
      
    
    ,
  
    max(
      
      case
      when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801'
        then answer_value_text
      else null
      end
    )
    
      
            as "10151d1b-3cd2-4f10-b1e5-d6b20112d801"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a8b5e1e-fa6b-472b-ade7-ee8f5286a759"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a2ac26a-8d30-4c28-be11-f684f415f661"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.70.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.70.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.5'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.81.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.81.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d'
        then answer_value_text
      else null
      end
    )
    
      
            as "6409c231-50c1-45fc-808e-f0bd015db97d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.69.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.69.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.8'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.8"
      
    
    ,
  
    max(
      
      case
      when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92'
        then answer_value_text
      else null
      end
    )
    
      
            as "6099951a-c965-40f9-ad61-66e7a39a6b92"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.76.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.76.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.69.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.69.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45'
        then answer_value_text
      else null
      end
    )
    
      
            as "acd9d89b-0d67-415e-a3a4-b132ab304c45"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.79.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.79.2"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:54.665519 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:23:54.665713 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_backup" cascade
[0m23:23:54.666195 [debug] [Thread-4 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_backup" cascade
[0m23:23:54.666823 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:54.667013 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:54.667745 [debug] [Thread-4 (]: On model.engage_analytics.qr_56: Close
[0m23:23:54.668454 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: Close
[0m23:23:54.668754 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baf15b0>]}
[0m23:23:54.669115 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7a540>]}
[0m23:23:54.669419 [info ] [Thread-4 (]: 28 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_56  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:54.669705 [info ] [Thread-3 (]: 29 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_57  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:54.669973 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_56
[0m23:23:54.670207 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_57
[0m23:23:54.670401 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_59
[0m23:23:54.670605 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_60
[0m23:23:54.670818 [info ] [Thread-4 (]: 31 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_59 ..... [RUN]
[0m23:23:54.671221 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_56, now model.engage_analytics.qr_59)
[0m23:23:54.671388 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_59
[0m23:23:54.673858 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:23:54.671006 [info ] [Thread-3 (]: 32 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_60 ..... [RUN]
[0m23:23:54.674213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:23:54.674446 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:54.674727 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_57, now model.engage_analytics.qr_60)
[0m23:23:54.676464 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:23:54.676671 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:54.676911 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_60
[0m23:23:54.677116 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_tmp" rename to "qr_55"
[0m23:23:54.679460 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:23:54.679723 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:54.679891 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:54.681263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:54.682197 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: COMMIT
[0m23:23:54.682466 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:23:54.682637 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: COMMIT
[0m23:23:54.683674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:54.684881 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_backup"
[0m23:23:54.685387 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:23:54.685665 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_backup" cascade
[0m23:23:54.686284 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:54.687000 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: Close
[0m23:23:54.687309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baec7d0>]}
[0m23:23:54.687621 [info ] [Thread-1 (]: 27 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_55  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:54.687886 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_55
[0m23:23:54.688073 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_61
[0m23:23:54.688275 [info ] [Thread-1 (]: 33 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_61 ..... [RUN]
[0m23:23:54.688476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_55, now model.engage_analytics.qr_61)
[0m23:23:54.688642 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_61
[0m23:23:54.691279 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:23:54.691604 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:54.691776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:55.021197 [debug] [Thread-2 (]: SQL status: SELECT 91 in 0.541 seconds
[0m23:23:55.028001 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_58"
[0m23:23:55.028670 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_58
[0m23:23:55.030339 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_58"
[0m23:23:55.030769 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:23:55.030931 [debug] [Thread-2 (]: On model.engage_analytics.qr_58: BEGIN
[0m23:23:55.031666 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:55.031824 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:23:55.032537 [debug] [Thread-2 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 2 (id: ipc-58, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '6930d457-7bec-4983-832b-3220b163f505'
        then answer_value_text
      else null
      end
    )
    
      
            as "6930d457-7bec-4983-832b-3220b163f505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9543e3c-cbff-4d2a-b3df-bf96e509d9ca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-015'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-015"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ed77f2a-0d5a-434d-b153-d8deadfbc3f8"
      
    
    ,
  
    max(
      
      case
      when linkid = '62cd085f-52d4-44de-881c-93058f201559'
        then answer_value_text
      else null
      end
    )
    
      
            as "62cd085f-52d4-44de-881c-93058f201559"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840'
        then answer_value_text
      else null
      end
    )
    
      
            as "a4a9cad5-04db-44e5-9a9d-0f1bf40ca840"
      
    
    ,
  
    max(
      
      case
      when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "0a15f38b-027a-42ff-b1e8-ca5e2b313f71"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1755ad4-b33a-44a3-b562-4206a582c28a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51'
        then answer_value_text
      else null
      end
    )
    
      
            as "301ae5ab-7dac-4414-a80a-f8784ba6bf51"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10'
        then answer_value_text
      else null
      end
    )
    
      
            as "d8eb3c09-b97d-4d55-9590-e6ce932a7a10"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "a9314459-f6d9-4ebb-84e7-f1a1968cfd7c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e17756cd-4861-4dde-859c-f90241977246'
        then answer_value_text
      else null
      end
    )
    
      
            as "e17756cd-4861-4dde-859c-f90241977246"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083'
        then answer_value_text
      else null
      end
    )
    
      
            as "f39b0b39-2058-4c29-a183-aac5dc70e083"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-016'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-016"
      
    
    ,
  
    max(
      
      case
      when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875'
        then answer_value_text
      else null
      end
    )
    
      
            as "9eac8fed-4265-447f-bbde-0986c34f3875"
      
    
    ,
  
    max(
      
      case
      when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263'
        then answer_value_text
      else null
      end
    )
    
      
            as "86bdafab-bb90-429e-8bc5-a90dc46e7263"
      
    
    ,
  
    max(
      
      case
      when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73'
        then answer_value_text
      else null
      end
    )
    
      
            as "747188c8-4fc0-43ea-92b4-9baa32567f73"
      
    
    ,
  
    max(
      
      case
      when linkid = '547a07c2-f94c-4956-997f-0439626d0251'
        then answer_value_text
      else null
      end
    )
    
      
            as "547a07c2-f94c-4956-997f-0439626d0251"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c"
      
    
    ,
  
    max(
      
      case
      when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740'
        then answer_value_text
      else null
      end
    )
    
      
            as "2a5d7010-a84b-414c-adcb-ad0f49a95740"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-013'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-013"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ff4b5cb-2c44-434b-90e9-85c61a858097"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef"
      
    
    ,
  
    max(
      
      case
      when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414'
        then answer_value_text
      else null
      end
    )
    
      
            as "83176bb3-c0cb-445a-a91b-6711635b1414"
      
    
    ,
  
    max(
      
      case
      when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90'
        then answer_value_text
      else null
      end
    )
    
      
            as "10cd5560-6c41-41a6-94c5-af74ce96dc90"
      
    
    ,
  
    max(
      
      case
      when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07'
        then answer_value_text
      else null
      end
    )
    
      
            as "85a3f14c-e4d8-4c45-9088-967ec4ea0d07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb8828db-1674-47e7-ba9a-e3c161160b65"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f63637c-1de2-4851-a088-c3b08152447e'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f63637c-1de2-4851-a088-c3b08152447e"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b80fd6e-3e52-4d1f-aa19-bbfdd912d724"
      
    
    ,
  
    max(
      
      case
      when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3'
        then answer_value_text
      else null
      end
    )
    
      
            as "0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44'
        then answer_value_text
      else null
      end
    )
    
      
            as "eea0b1ca-5582-4b45-b5cf-36bc0665ba44"
      
    
    ,
  
    max(
      
      case
      when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3'
        then answer_value_text
      else null
      end
    )
    
      
            as "94e90f68-ea59-4837-b0ad-452f5f0336c3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac0ade27-9e9a-42a9-8ec6-4e7e79830299"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e0b76f9-0902-43ba-b858-0b1505e9d168"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359'
        then answer_value_text
      else null
      end
    )
    
      
            as "e245b7d9-955a-4c4b-a107-e2bf5d6d2359"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a77f07b3-7913-4708-a354-14e503a948f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "5817d327-373e-4fc0-9bac-b64e408b0e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260'
        then answer_value_text
      else null
      end
    )
    
      
            as "52f7924d-1c66-4049-8611-26d4e7bcb260"
      
    
    ,
  
    max(
      
      case
      when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3'
        then answer_value_text
      else null
      end
    )
    
      
            as "50cf6a9c-a837-4531-a13a-47381657c2b3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "c91209cc-1b2c-43f0-83f0-4704418ae2d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '044d9000-1935-4b35-9947-d668de09f10b'
        then answer_value_text
      else null
      end
    )
    
      
            as "044d9000-1935-4b35-9947-d668de09f10b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc8f199a-59f0-4184-864d-b1c0befd26df"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c95559d-86ff-4b87-a271-e52388072a53'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c95559d-86ff-4b87-a271-e52388072a53"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444'
        then answer_value_text
      else null
      end
    )
    
      
            as "e73f462c-e543-4a3d-849d-dbedcb831444"
      
    
    ,
  
    max(
      
      case
      when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a'
        then answer_value_text
      else null
      end
    )
    
      
            as "63ac8d07-518c-4791-849a-a9e2c282ce9a"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cc2834b-0d28-43d0-8811-509995cfcdb8"
      
    
    ,
  
    max(
      
      case
      when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c'
        then answer_value_text
      else null
      end
    )
    
      
            as "2efaba4d-f5af-45f3-9340-1ba9b3fffc1c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-018'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-018"
      
    
    ,
  
    max(
      
      case
      when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f"
      
    
    ,
  
    max(
      
      case
      when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8'
        then answer_value_text
      else null
      end
    )
    
      
            as "126c7309-8143-4c33-857f-41cc6bed09d8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-014'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-014"
      
    
    ,
  
    max(
      
      case
      when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03'
        then answer_value_text
      else null
      end
    )
    
      
            as "5d0b76c5-a416-45a4-a8fc-9889ea840a03"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7f10195-b859-4670-abbc-a2498c4fe45f"
      
    
    ,
  
    max(
      
      case
      when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a'
        then answer_value_text
      else null
      end
    )
    
      
            as "232484cf-1aee-4bfa-a66e-61494587a16a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "96171fdd-a424-4c09-91e8-31986ac315f7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bed17079-d1e5-4bbe-af07-3d7b6a86243e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '665e1595-f169-4815-9d24-dac265f1809b'
        then answer_value_text
      else null
      end
    )
    
      
            as "665e1595-f169-4815-9d24-dac265f1809b"
      
    
    ,
  
    max(
      
      case
      when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21'
        then answer_value_text
      else null
      end
    )
    
      
            as "99079ebd-1665-4503-bb37-8de493dd4a21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ecd82c04-48de-48ec-8efe-24cbe04cbe4b"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ff6f541-cb58-48d3-b7eb-24ab667f0a94"
      
    
    ,
  
    max(
      
      case
      when linkid = '287593c3-4174-45af-a998-71d249230943'
        then answer_value_text
      else null
      end
    )
    
      
            as "287593c3-4174-45af-a998-71d249230943"
      
    
    ,
  
    max(
      
      case
      when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc'
        then answer_value_text
      else null
      end
    )
    
      
            as "62c9e3f2-30aa-46b0-9190-aa36a1804fdc"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f9608db-8796-4f45-89b7-741585b8a362'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f9608db-8796-4f45-89b7-741585b8a362"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f82f76f4-648a-453a-916d-28795448a758'
        then answer_value_text
      else null
      end
    )
    
      
            as "f82f76f4-648a-453a-916d-28795448a758"
      
    
    ,
  
    max(
      
      case
      when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a'
        then answer_value_text
      else null
      end
    )
    
      
            as "2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb0c7a5-a211-43ec-af7b-5f1079399133"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c0d6638-9b65-4016-b3f0-4008f8e462c2"
      
    
    ,
  
    max(
      
      case
      when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92'
        then answer_value_text
      else null
      end
    )
    
      
            as "6099951a-c965-40f9-ad61-66e7a39a6b92"
      
    
    ,
  
    max(
      
      case
      when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00'
        then answer_value_text
      else null
      end
    )
    
      
            as "0984569b-3fd6-4c4e-a391-e68e73b46f00"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c9f8c1d-5827-4d21-bd33-3240fade93ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6befba3-6d25-47ae-9cac-409dfae832a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93'
        then answer_value_text
      else null
      end
    )
    
      
            as "b93eafea-8b01-4b21-994b-c45113622a93"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92'
        then answer_value_text
      else null
      end
    )
    
      
            as "b31c0187-3e54-4fcf-9763-8b3f3850be92"
      
    
    ,
  
    max(
      
      case
      when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54'
        then answer_value_text
      else null
      end
    )
    
      
            as "3abecf2a-c87b-4fad-96eb-e9abc37e9c54"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:55.039041 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:23:55.040786 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:23:55.040975 [debug] [Thread-2 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_tmp" rename to "qr_58"
[0m23:23:55.042786 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:55.043531 [debug] [Thread-2 (]: On model.engage_analytics.qr_58: COMMIT
[0m23:23:55.043722 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:23:55.043882 [debug] [Thread-2 (]: On model.engage_analytics.qr_58: COMMIT
[0m23:23:55.044881 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:55.046007 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_backup"
[0m23:23:55.046274 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:23:55.046440 [debug] [Thread-2 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_backup" cascade
[0m23:23:55.047097 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:55.047844 [debug] [Thread-2 (]: On model.engage_analytics.qr_58: Close
[0m23:23:55.048150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9eae70>]}
[0m23:23:55.048464 [info ] [Thread-2 (]: 30 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_58  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:55.048738 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_58
[0m23:23:55.048927 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_62
[0m23:23:55.049277 [info ] [Thread-2 (]: 34 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_62 ..... [RUN]
[0m23:23:55.049631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_58, now model.engage_analytics.qr_62)
[0m23:23:55.049818 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_62
[0m23:23:55.052149 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:23:55.052379 [debug] [Thread-2 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:55.052547 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:55.219117 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.539 seconds
[0m23:23:55.222925 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_60"
[0m23:23:55.223285 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.547 seconds
[0m23:23:55.224636 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_59"
[0m23:23:55.225243 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_59
[0m23:23:55.225518 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_60
[0m23:23:55.227332 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_59"
[0m23:23:55.228917 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_60"
[0m23:23:55.229485 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:23:55.229703 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: BEGIN
[0m23:23:55.229981 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:23:55.230191 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: BEGIN
[0m23:23:55.230397 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:55.230592 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:23:55.230844 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 3) (id: ipc-59, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402'
        then answer_value_text
      else null
      end
    )
    
      
            as "d34c5839-fad9-4824-b2dc-9e0161647402"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = '534c4998-b964-4101-b919-ff3c26af9714'
        then answer_value_text
      else null
      end
    )
    
      
            as "534c4998-b964-4101-b919-ff3c26af9714"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:55.231144 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:55.231326 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:23:55.231630 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 3) (id: ipc-60, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d'
        then answer_value_text
      else null
      end
    )
    
      
            as "cbad1c80-ab95-4720-ba6a-0eadd718905d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4c58005-803f-4bc3-adaa-1f84c5824b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49'
        then answer_value_text
      else null
      end
    )
    
      
            as "a51fba17-fccd-4b65-ada3-5c50a75e5d49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5002611-caf9-4792-8d10-e7870459ea17"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:55.233891 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:55.235656 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:23:55.235916 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:23:55.236155 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_tmp" rename to "qr_59"
[0m23:23:55.238679 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:23:55.238986 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.547 seconds
[0m23:23:55.239289 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_tmp" rename to "qr_60"
[0m23:23:55.240666 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_61"
[0m23:23:55.240894 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:23:55.241618 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: COMMIT
[0m23:23:55.241819 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:23:55.241975 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: COMMIT
[0m23:23:55.242142 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:55.242851 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: COMMIT
[0m23:23:55.243327 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:55.243584 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:23:55.244779 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_backup"
[0m23:23:55.244955 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: COMMIT
[0m23:23:55.245224 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:23:55.245444 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_61
[0m23:23:55.245646 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_backup" cascade
[0m23:23:55.247366 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_61"
[0m23:23:55.247602 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:55.248844 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_backup"
[0m23:23:55.249055 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:55.249365 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:23:55.250152 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: Close
[0m23:23:55.250414 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:23:55.250606 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_backup" cascade
[0m23:23:55.251002 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9ee390>]}
[0m23:23:55.251328 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: BEGIN
[0m23:23:55.251745 [info ] [Thread-4 (]: 31 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_59  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:55.252154 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_59
[0m23:23:55.252397 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_63
[0m23:23:55.252638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:55.253044 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:55.252891 [info ] [Thread-4 (]: 35 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_63 ..... [RUN]
[0m23:23:55.253302 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:23:55.254029 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: Close
[0m23:23:55.254238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_59, now model.engage_analytics.qr_63)
[0m23:23:55.254514 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 3) (id: ipc-61, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1'
        then answer_value_text
      else null
      end
    )
    
      
            as "45f52042-6802-4d9c-9f86-6578923d0fd1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9'
        then answer_value_text
      else null
      end
    )
    
      
            as "4650a511-2184-4b0b-9e43-54f45f4340a9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e'
        then answer_value_text
      else null
      end
    )
    
      
            as "55d78cf4-0963-4c44-af44-6004a8abbb3e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:55.254883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b973fe0>]}
[0m23:23:55.255105 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_63
[0m23:23:55.257768 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:23:55.258042 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:23:55.258559 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:55.258359 [info ] [Thread-3 (]: 32 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_60  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:55.260246 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:23:55.260494 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:55.260783 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_60
[0m23:23:55.260960 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_tmp" rename to "qr_61"
[0m23:23:55.261229 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_69
[0m23:23:55.261554 [info ] [Thread-3 (]: 36 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_69 ..... [RUN]
[0m23:23:55.261842 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_60, now model.engage_analytics.qr_69)
[0m23:23:55.262094 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_69
[0m23:23:55.262288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:55.264659 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:23:55.265370 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: COMMIT
[0m23:23:55.265568 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:55.265743 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:23:55.265898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:55.266048 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: COMMIT
[0m23:23:55.267527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:55.268764 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_backup"
[0m23:23:55.269059 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:23:55.269362 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_backup" cascade
[0m23:23:55.270164 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:55.270891 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: Close
[0m23:23:55.271192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0efbc0>]}
[0m23:23:55.271508 [info ] [Thread-1 (]: 33 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_61  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:55.271770 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_61
[0m23:23:55.271957 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_104394
[0m23:23:55.272226 [info ] [Thread-1 (]: 37 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104394  [RUN]
[0m23:23:55.272440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_61, now model.engage_analytics.qr_ipc_104394)
[0m23:23:55.272610 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_104394
[0m23:23:55.275081 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:23:55.275378 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:55.275563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:55.654906 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.602 seconds
[0m23:23:55.657364 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_62"
[0m23:23:55.657924 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_62
[0m23:23:55.659696 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_62"
[0m23:23:55.660099 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:23:55.660266 [debug] [Thread-2 (]: On model.engage_analytics.qr_62: BEGIN
[0m23:23:55.660982 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:55.661142 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:23:55.661399 [debug] [Thread-2 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 4) (id: ipc-62, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e626219-c0e4-465e-92e6-9e976c52614c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4155e07-1d18-448f-8111-182bf4149672'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4155e07-1d18-448f-8111-182bf4149672"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:55.663880 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:55.665515 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:23:55.665711 [debug] [Thread-2 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_tmp" rename to "qr_62"
[0m23:23:55.666654 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:55.667293 [debug] [Thread-2 (]: On model.engage_analytics.qr_62: COMMIT
[0m23:23:55.667479 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:23:55.667640 [debug] [Thread-2 (]: On model.engage_analytics.qr_62: COMMIT
[0m23:23:55.668796 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:55.669834 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_backup"
[0m23:23:55.670091 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:23:55.670261 [debug] [Thread-2 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_backup" cascade
[0m23:23:55.670892 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:55.671724 [debug] [Thread-2 (]: On model.engage_analytics.qr_62: Close
[0m23:23:55.672032 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6e08c0>]}
[0m23:23:55.672356 [info ] [Thread-2 (]: 34 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_62  [[32mCREATE VIEW[0m in 0.62s]
[0m23:23:55.672628 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_62
[0m23:23:55.672819 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_104453
[0m23:23:55.673097 [info ] [Thread-2 (]: 38 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104453  [RUN]
[0m23:23:55.673328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_62, now model.engage_analytics.qr_ipc_104453)
[0m23:23:55.673491 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_104453
[0m23:23:55.675646 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:23:55.676012 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:55.676276 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:55.865266 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.599 seconds
[0m23:23:55.866661 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_69"
[0m23:23:55.867171 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_69
[0m23:23:55.869072 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_69"
[0m23:23:55.869548 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:23:55.869728 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: BEGIN
[0m23:23:55.870516 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:55.870682 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:23:55.870913 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- eCBIS Remove Family Form (id: ipc-69, url: n/a, version: 0.0.2)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f'
        then answer_value_text
      else null
      end
    )
    
      
            as "17b7fda5-514c-4408-88e7-52313ab0ef2f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-birthdate'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-birthdate"
      
    
    ,
  
    max(
      
      case
      when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "98ac4694-590e-4cc2-83f3-cc6455e688c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a'
        then answer_value_text
      else null
      end
    )
    
      
            as "8489d249-1ef3-4edb-aa99-b5713fd2cb0a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd73cfdf-6d70-4b42-8887-21e27db0b9ec"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff'
        then answer_value_text
      else null
      end
    )
    
      
            as "f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1'
        then answer_value_text
      else null
      end
    )
    
      
            as "b6c21488-87b8-4213-8cd0-d482367669c1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:55.873574 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:55.873839 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.613 seconds
[0m23:23:55.875624 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:23:55.875925 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.600 seconds
[0m23:23:55.878036 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_63"
[0m23:23:55.878274 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_tmp" rename to "qr_69"
[0m23:23:55.878882 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104394"
[0m23:23:55.879413 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_104394
[0m23:23:55.879623 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_63
[0m23:23:55.882056 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104394"
[0m23:23:55.882263 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:23:55.884198 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_63"
[0m23:23:55.884964 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: COMMIT
[0m23:23:55.885271 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:23:55.885608 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: COMMIT
[0m23:23:55.885871 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:23:55.886057 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: BEGIN
[0m23:23:55.886265 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:23:55.886495 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: BEGIN
[0m23:23:55.886741 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:55.887907 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_backup"
[0m23:23:55.888111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:55.888419 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:23:55.888609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:23:55.888795 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:23:55.889014 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_backup" cascade
[0m23:23:55.889225 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:23:55.889414 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_tmp"
    
    
  as (
    
-- SPI Subform 4 (id: ipc-104394, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:55.889904 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 4 (id: ipc-63, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-connected-to-clinical-care-details'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-connected-to-clinical-care-details"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-connected-to-clinical-care-question'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-connected-to-clinical-care-question"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de'
        then answer_value_text
      else null
      end
    )
    
      
            as "b46d08e9-6af9-47be-a09a-afd0cfdf41de"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b12311e-d9a3-40b4-bb18-5cc6135a3850"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa8d0648-9550-489a-9543-4f00d43ba1fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490'
        then answer_value_text
      else null
      end
    )
    
      
            as "e67ca22d-e803-4790-bbce-126f2c863490"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "cb8337b0-c822-4374-895b-ee875da4d7f6"
      
    
    ,
  
    max(
      
      case
      when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "978ba6cf-b149-49e2-89c3-89a0e18461bc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588'
        then answer_value_text
      else null
      end
    )
    
      
            as "4602f806-3bf4-4f16-bee1-c2e690dca588"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b'
        then answer_value_text
      else null
      end
    )
    
      
            as "a3831bfc-0175-4e5a-8d8d-7313c7f2b69b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6'
        then answer_value_text
      else null
      end
    )
    
      
            as "a8c2cacf-7ee5-4076-af42-19d0eba0e6d6"
      
    
    ,
  
    max(
      
      case
      when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef'
        then answer_value_text
      else null
      end
    )
    
      
            as "3ce3bf84-176e-40bc-8075-1517a03c6bef"
      
    
    ,
  
    max(
      
      case
      when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "39dfd1f4-01db-4057-9734-4f2fbd83b8fe"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e7579d-ac74-4d72-955b-1a3675a2e656"
      
    
    ,
  
    max(
      
      case
      when linkid = '749d2a97-4195-4516-8079-60638a4d9e82'
        then answer_value_text
      else null
      end
    )
    
      
            as "749d2a97-4195-4516-8079-60638a4d9e82"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc'
        then answer_value_text
      else null
      end
    )
    
      
            as "ca41ccab-5f0b-4538-b394-ad342a0b5bdc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c457ea8-c60d-49f7-b166-ebabf737ab22"
      
    
    ,
  
    max(
      
      case
      when linkid = '7db481df-19e5-400c-a206-4811b39485d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "7db481df-19e5-400c-a206-4811b39485d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99'
        then answer_value_text
      else null
      end
    )
    
      
            as "936d5c53-d176-4c63-9a3a-e9e7f9db3f99"
      
    
    ,
  
    max(
      
      case
      when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f'
        then answer_value_text
      else null
      end
    )
    
      
            as "19dd65c2-8709-4745-81f2-4d4843c4307f"
      
    
    ,
  
    max(
      
      case
      when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318'
        then answer_value_text
      else null
      end
    )
    
      
            as "7fef53bc-56db-47ce-8cba-8efd4bcbc318"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a302513b-141a-4316-9546-d013212a361e'
        then answer_value_text
      else null
      end
    )
    
      
            as "a302513b-141a-4316-9546-d013212a361e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "6d9345d7-61a0-425b-8496-8b08d68175d0"
      
    
    ,
  
    max(
      
      case
      when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74'
        then answer_value_text
      else null
      end
    )
    
      
            as "49a270cd-b72b-42a6-92e3-c139f7a85d74"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036'
        then answer_value_text
      else null
      end
    )
    
      
            as "dd000285-7c36-44b4-82e6-4e8826665036"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b65857a-5c04-4414-833d-10602f04d299'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b65857a-5c04-4414-833d-10602f04d299"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec39511c-de47-469d-ac44-973e3fc08532"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa30ce6c-4153-46d8-a4af-83012eafa23d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19'
        then answer_value_text
      else null
      end
    )
    
      
            as "9b602b02-e5f9-4795-9fb9-fc7ae4353a19"
      
    
    ,
  
    max(
      
      case
      when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7'
        then answer_value_text
      else null
      end
    )
    
      
            as "83a63af9-6f49-4fad-bca9-80776fc97be7"
      
    
    ,
  
    max(
      
      case
      when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de'
        then answer_value_text
      else null
      end
    )
    
      
            as "9a02423f-9848-4254-b427-3dfa8819d0de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824'
        then answer_value_text
      else null
      end
    )
    
      
            as "05617430-b835-4ebd-8d6a-ff58ef6d2824"
      
    
    ,
  
    max(
      
      case
      when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "9848888d-1ec0-4d43-b53f-7613ba5144fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e9014d1-e07c-492e-897a-3bf7e8f6f018"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:23:55.890414 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:55.891544 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: Close
[0m23:23:55.891797 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:55.892160 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d9640>]}
[0m23:23:55.893804 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:23:55.894267 [info ] [Thread-3 (]: 36 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_69  [[32mCREATE VIEW[0m in 0.63s]
[0m23:23:55.894562 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_tmp" rename to "qr_ipc_104394"
[0m23:23:55.894765 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:23:55.895079 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_69
[0m23:23:55.896762 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:23:55.896978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:23:55.897231 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_104454
[0m23:23:55.897511 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_tmp" rename to "qr_63"
[0m23:23:55.898178 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: COMMIT
[0m23:23:55.898456 [info ] [Thread-3 (]: 39 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104454  [RUN]
[0m23:23:55.898757 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:23:55.898970 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_69, now model.engage_analytics.qr_ipc_104454)
[0m23:23:55.899145 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: COMMIT
[0m23:23:55.899319 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_104454
[0m23:23:55.901634 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:23:55.901916 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:23:55.902157 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:55.902422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:23:55.903158 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: COMMIT
[0m23:23:55.903360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:55.904526 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_backup"
[0m23:23:55.904734 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:23:55.905125 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:23:55.905333 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: COMMIT
[0m23:23:55.905542 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_backup" cascade
[0m23:23:55.906234 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:55.906961 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: Close
[0m23:23:55.907173 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:55.908517 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_backup"
[0m23:23:55.908832 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:23:55.909010 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_backup" cascade
[0m23:23:55.909317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a439670>]}
[0m23:23:55.909842 [info ] [Thread-1 (]: 37 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104394  [[32mCREATE VIEW[0m in 0.64s]
[0m23:23:55.910130 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_104394
[0m23:23:55.910377 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:55.910650 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_104455
[0m23:23:55.911388 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: Close
[0m23:23:55.911625 [info ] [Thread-1 (]: 40 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104455  [RUN]
[0m23:23:55.912087 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9aa270>]}
[0m23:23:55.912316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104394, now model.engage_analytics.qr_ipc_104455)
[0m23:23:55.912703 [info ] [Thread-4 (]: 35 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_63  [[32mCREATE VIEW[0m in 0.66s]
[0m23:23:55.912898 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_104455
[0m23:23:55.913151 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_63
[0m23:23:55.915269 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:23:55.915510 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_202
[0m23:23:55.915757 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:55.916071 [info ] [Thread-4 (]: 41 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_202  [RUN]
[0m23:23:55.916321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:55.916549 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_63, now model.engage_analytics.qr_ipc_202)
[0m23:23:55.916807 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_202
[0m23:23:55.919968 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:23:55.920206 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:55.920370 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:56.246127 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.570 seconds
[0m23:23:56.246974 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104453"
[0m23:23:56.247617 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_104453
[0m23:23:56.249598 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104453"
[0m23:23:56.250066 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:23:56.250250 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: BEGIN
[0m23:23:56.251037 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:56.251306 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:23:56.251500 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_tmp"
    
    
  as (
    
-- SPI Subform 2 (id: ipc-104453, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:56.252713 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:56.254338 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:23:56.254543 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_tmp" rename to "qr_ipc_104453"
[0m23:23:56.255272 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:56.256059 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: COMMIT
[0m23:23:56.256279 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:23:56.256523 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: COMMIT
[0m23:23:56.257524 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:56.258616 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_backup"
[0m23:23:56.258869 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:23:56.259034 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_backup" cascade
[0m23:23:56.259701 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:56.260466 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: Close
[0m23:23:56.260761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc25e20>]}
[0m23:23:56.261082 [info ] [Thread-2 (]: 38 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104453  [[32mCREATE VIEW[0m in 0.59s]
[0m23:23:56.261342 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_104453
[0m23:23:56.261531 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_203
[0m23:23:56.261815 [info ] [Thread-2 (]: 42 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_203  [RUN]
[0m23:23:56.262071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104453, now model.engage_analytics.qr_ipc_203)
[0m23:23:56.262241 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_203
[0m23:23:56.264284 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:23:56.264501 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:56.264665 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:56.448898 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.545 seconds
[0m23:23:56.451169 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104454"
[0m23:23:56.451828 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_104454
[0m23:23:56.453788 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104454"
[0m23:23:56.454098 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.538 seconds
[0m23:23:56.454757 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104455"
[0m23:23:56.455072 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:23:56.455245 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: BEGIN
[0m23:23:56.455496 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_104455
[0m23:23:56.457243 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104455"
[0m23:23:56.457473 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m23:23:56.457723 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:23:56.457938 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_tmp"
    
    
  as (
    
-- SPI Subform 3 (id: ipc-104454, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:56.458186 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:23:56.458434 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.538 seconds
[0m23:23:56.458700 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: BEGIN
[0m23:23:56.459365 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_202"
[0m23:23:56.459585 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:56.461119 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:23:56.461307 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_tmp" rename to "qr_ipc_104454"
[0m23:23:56.461479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:23:56.461671 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:23:56.461852 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_tmp"
    
    
  as (
    
-- SPI Subform 1 (id: ipc-104455, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:56.462116 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_202
[0m23:23:56.462290 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:56.463940 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_202"
[0m23:23:56.464188 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:56.464825 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: COMMIT
[0m23:23:56.467080 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:23:56.467335 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:23:56.467556 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_tmp" rename to "qr_ipc_104455"
[0m23:23:56.467816 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: COMMIT
[0m23:23:56.468050 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:23:56.468210 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_202: BEGIN
[0m23:23:56.468483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:56.469092 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: COMMIT
[0m23:23:56.469268 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:56.469423 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:56.469575 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:23:56.470743 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_backup"
[0m23:23:56.470948 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:23:56.471114 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: COMMIT
[0m23:23:56.471358 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:23:56.471542 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 1) (id: ipc-202, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:56.471746 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_backup" cascade
[0m23:23:56.472287 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:56.472452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:56.473096 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: Close
[0m23:23:56.474135 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_backup"
[0m23:23:56.474291 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:56.474550 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:23:56.474883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b90b740>]}
[0m23:23:56.476413 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:23:56.476642 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_backup" cascade
[0m23:23:56.477019 [info ] [Thread-3 (]: 39 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104454  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:56.477260 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_tmp" rename to "qr_ipc_202"
[0m23:23:56.477574 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_104454
[0m23:23:56.477813 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_204
[0m23:23:56.478015 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:56.478575 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:56.478304 [info ] [Thread-3 (]: 43 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_204  [RUN]
[0m23:23:56.479384 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: Close
[0m23:23:56.480024 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_202: COMMIT
[0m23:23:56.480226 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104454, now model.engage_analytics.qr_ipc_204)
[0m23:23:56.480427 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:23:56.480654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b95c8f0>]}
[0m23:23:56.480823 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_204
[0m23:23:56.480999 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_202: COMMIT
[0m23:23:56.483323 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:23:56.481283 [info ] [Thread-1 (]: 40 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104455  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:56.483743 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:56.484086 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_104455
[0m23:23:56.484340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:56.484587 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_205
[0m23:23:56.484832 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:56.485163 [info ] [Thread-1 (]: 44 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_205  [RUN]
[0m23:23:56.486473 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_backup"
[0m23:23:56.486717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104455, now model.engage_analytics.qr_ipc_205)
[0m23:23:56.486990 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:23:56.487168 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_205
[0m23:23:56.487336 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_backup" cascade
[0m23:23:56.490971 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:23:56.491368 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:56.491640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:56.491984 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:56.492858 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_202: Close
[0m23:23:56.493169 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbbbc50>]}
[0m23:23:56.493487 [info ] [Thread-4 (]: 41 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_202  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:56.493754 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_202
[0m23:23:56.493948 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_206
[0m23:23:56.494209 [info ] [Thread-4 (]: 45 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_206  [RUN]
[0m23:23:56.494408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_202, now model.engage_analytics.qr_ipc_206)
[0m23:23:56.494568 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_206
[0m23:23:56.496755 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:23:56.496975 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:56.497133 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:56.839962 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.575 seconds
[0m23:23:56.840793 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_203"
[0m23:23:56.841456 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_203
[0m23:23:56.843531 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_203"
[0m23:23:56.844014 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:23:56.844196 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: BEGIN
[0m23:23:56.844939 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:56.845174 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:23:56.845352 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 1) (id: ipc-203, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:56.846390 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:56.849200 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:23:56.849448 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_tmp" rename to "qr_ipc_203"
[0m23:23:56.850209 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:56.850885 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: COMMIT
[0m23:23:56.851076 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:23:56.851233 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: COMMIT
[0m23:23:56.852162 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:56.853459 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_backup"
[0m23:23:56.853810 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:23:56.853987 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_backup" cascade
[0m23:23:56.854638 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:56.855288 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: Close
[0m23:23:56.855559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba38080>]}
[0m23:23:56.855866 [info ] [Thread-2 (]: 42 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_203  [[32mCREATE VIEW[0m in 0.59s]
[0m23:23:56.856116 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_203
[0m23:23:56.856303 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_207
[0m23:23:56.856508 [info ] [Thread-2 (]: 46 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_207  [RUN]
[0m23:23:56.856712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_203, now model.engage_analytics.qr_ipc_207)
[0m23:23:56.856879 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_207
[0m23:23:56.859005 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:23:56.859354 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:56.859699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:57.078283 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.594 seconds
[0m23:23:57.079123 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_204"
[0m23:23:57.079655 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_204
[0m23:23:57.081540 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_204"
[0m23:23:57.081786 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.590 seconds
[0m23:23:57.082568 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_205"
[0m23:23:57.083275 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_205
[0m23:23:57.085533 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_205"
[0m23:23:57.085867 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:23:57.086208 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.589 seconds
[0m23:23:57.086438 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_204: BEGIN
[0m23:23:57.087188 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_206"
[0m23:23:57.087500 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:23:57.087770 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: BEGIN
[0m23:23:57.087959 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:57.088278 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:23:57.088550 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 1) (id: ipc-204, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:57.088772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:57.088978 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_206
[0m23:23:57.089229 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:23:57.091166 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_206"
[0m23:23:57.091435 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:57.091637 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 2) (id: ipc-205, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:57.093243 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:23:57.093540 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_tmp" rename to "qr_ipc_204"
[0m23:23:57.093890 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:23:57.094070 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_206: BEGIN
[0m23:23:57.094394 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:57.094975 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_204: COMMIT
[0m23:23:57.095190 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:57.095414 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:23:57.095599 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:57.097156 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:23:57.097357 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_204: COMMIT
[0m23:23:57.097808 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:23:57.097991 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_tmp" rename to "qr_ipc_205"
[0m23:23:57.098200 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 2) (id: ipc-206, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:57.098926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:57.099162 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:57.099778 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: COMMIT
[0m23:23:57.099950 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:57.101085 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_backup"
[0m23:23:57.101331 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:23:57.103336 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:23:57.103604 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:23:57.103773 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: COMMIT
[0m23:23:57.103951 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_tmp" rename to "qr_ipc_206"
[0m23:23:57.104127 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_backup" cascade
[0m23:23:57.104776 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:57.105001 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:57.105645 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_204: Close
[0m23:23:57.105804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:57.106401 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_206: COMMIT
[0m23:23:57.107520 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_backup"
[0m23:23:57.107791 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbba360>]}
[0m23:23:57.107992 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:23:57.108260 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:23:57.108585 [info ] [Thread-3 (]: 43 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_204  [[32mCREATE VIEW[0m in 0.63s]
[0m23:23:57.108807 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_206: COMMIT
[0m23:23:57.109025 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_backup" cascade
[0m23:23:57.109365 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_204
[0m23:23:57.109669 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_208
[0m23:23:57.110127 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:57.110330 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:57.109926 [info ] [Thread-3 (]: 47 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_208  [RUN]
[0m23:23:57.111050 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_205: Close
[0m23:23:57.112134 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_backup"
[0m23:23:57.112329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_204, now model.engage_analytics.qr_ipc_208)
[0m23:23:57.112605 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:23:57.112834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb13c50>]}
[0m23:23:57.113025 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_208
[0m23:23:57.113200 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_backup" cascade
[0m23:23:57.115501 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:23:57.113489 [info ] [Thread-1 (]: 44 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_205  [[32mCREATE VIEW[0m in 0.63s]
[0m23:23:57.115833 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:57.116167 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_205
[0m23:23:57.116378 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:57.116547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:57.116747 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_209
[0m23:23:57.117510 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_206: Close
[0m23:23:57.117900 [info ] [Thread-1 (]: 48 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_209  [RUN]
[0m23:23:57.118230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_205, now model.engage_analytics.qr_ipc_209)
[0m23:23:57.118541 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba378c0>]}
[0m23:23:57.118774 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_209
[0m23:23:57.119113 [info ] [Thread-4 (]: 45 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_206  [[32mCREATE VIEW[0m in 0.62s]
[0m23:23:57.121260 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:23:57.121702 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_206
[0m23:23:57.121931 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:57.122152 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_210
[0m23:23:57.122359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:57.122582 [info ] [Thread-4 (]: 49 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_210  [RUN]
[0m23:23:57.122894 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_206, now model.engage_analytics.qr_ipc_210)
[0m23:23:57.123135 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_210
[0m23:23:57.125070 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:23:57.125388 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:57.125620 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:57.455898 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.596 seconds
[0m23:23:57.456722 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_207"
[0m23:23:57.457230 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_207
[0m23:23:57.459359 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_207"
[0m23:23:57.459908 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:23:57.460095 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: BEGIN
[0m23:23:57.460777 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:57.460944 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:23:57.461115 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 3) (id: ipc-207, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:57.462288 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:57.464021 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:23:57.464263 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_tmp" rename to "qr_ipc_207"
[0m23:23:57.465269 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:57.466006 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: COMMIT
[0m23:23:57.466209 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:23:57.466371 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: COMMIT
[0m23:23:57.467089 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:57.468218 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_backup"
[0m23:23:57.469269 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:23:57.469441 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_backup" cascade
[0m23:23:57.470131 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:57.470892 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: Close
[0m23:23:57.471196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc8a4e0>]}
[0m23:23:57.471513 [info ] [Thread-2 (]: 46 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_207  [[32mCREATE VIEW[0m in 0.61s]
[0m23:23:57.471777 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_207
[0m23:23:57.471967 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_211
[0m23:23:57.472166 [info ] [Thread-2 (]: 50 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_211  [RUN]
[0m23:23:57.472436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_207, now model.engage_analytics.qr_ipc_211)
[0m23:23:57.472598 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_211
[0m23:23:57.511052 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:23:57.511347 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:57.511527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:57.661907 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.536 seconds
[0m23:23:57.662750 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_210"
[0m23:23:57.663046 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.541 seconds
[0m23:23:57.663592 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_209"
[0m23:23:57.663982 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_209
[0m23:23:57.665913 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_209"
[0m23:23:57.666204 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.550 seconds
[0m23:23:57.666449 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_210
[0m23:23:57.667186 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_208"
[0m23:23:57.669047 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_210"
[0m23:23:57.669535 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:23:57.669753 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_208
[0m23:23:57.670053 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_209: BEGIN
[0m23:23:57.672085 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_208"
[0m23:23:57.672412 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:23:57.672634 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_210: BEGIN
[0m23:23:57.672889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:57.673087 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:23:57.673280 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 4) (id: ipc-209, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:57.673545 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:57.673832 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:23:57.674075 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:23:57.674334 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 4) (id: ipc-210, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:57.674814 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: BEGIN
[0m23:23:57.675307 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:57.677172 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:23:57.677400 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:57.677622 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m23:23:57.677823 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_tmp" rename to "qr_ipc_209"
[0m23:23:57.679212 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:23:57.679408 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:23:57.679616 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_tmp" rename to "qr_ipc_210"
[0m23:23:57.679810 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_tmp"
    
    
  as (
    
-- IPC Session 3 (id: ipc-208, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:57.680212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:57.680839 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_209: COMMIT
[0m23:23:57.681019 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:57.681194 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:57.681441 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:23:57.682732 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:23:57.683290 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_210: COMMIT
[0m23:23:57.683475 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_209: COMMIT
[0m23:23:57.683657 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_tmp" rename to "qr_ipc_208"
[0m23:23:57.683830 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:23:57.684024 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_210: COMMIT
[0m23:23:57.684476 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:57.685085 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: COMMIT
[0m23:23:57.685357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:57.685606 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:23:57.685776 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:57.686850 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_backup"
[0m23:23:57.687015 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: COMMIT
[0m23:23:57.688281 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_backup"
[0m23:23:57.689351 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:23:57.689715 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:23:57.689926 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_backup" cascade
[0m23:23:57.690131 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_backup" cascade
[0m23:23:57.690355 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:57.691507 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_backup"
[0m23:23:57.691725 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:57.691991 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:23:57.692149 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:23:57.692918 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_209: Close
[0m23:23:57.693202 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_backup" cascade
[0m23:23:57.694000 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_210: Close
[0m23:23:57.694334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad17ec0>]}
[0m23:23:57.694650 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba2e870>]}
[0m23:23:57.694901 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:57.695203 [info ] [Thread-1 (]: 48 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_209  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:57.695544 [info ] [Thread-4 (]: 49 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_210  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:57.696302 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_208: Close
[0m23:23:57.696604 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_209
[0m23:23:57.696882 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_210
[0m23:23:57.697152 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_212
[0m23:23:57.697411 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba2e0f0>]}
[0m23:23:57.697759 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_221
[0m23:23:57.698061 [info ] [Thread-1 (]: 51 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_212  [RUN]
[0m23:23:57.698436 [info ] [Thread-3 (]: 47 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_208  [[32mCREATE VIEW[0m in 0.59s]
[0m23:23:57.698867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_209, now model.engage_analytics.qr_ipc_212)
[0m23:23:57.698640 [info ] [Thread-4 (]: 52 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_221  [RUN]
[0m23:23:57.699149 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_208
[0m23:23:57.699320 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_212
[0m23:23:57.699494 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_210, now model.engage_analytics.qr_ipc_221)
[0m23:23:57.699685 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_23451
[0m23:23:57.701895 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:23:57.702167 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_221
[0m23:23:57.702439 [info ] [Thread-3 (]: 53 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_23451  [RUN]
[0m23:23:57.702665 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:57.704634 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:23:57.704936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_208, now model.engage_analytics.qr_ipc_23451)
[0m23:23:57.705171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:57.705356 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:57.705528 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_23451
[0m23:23:57.705792 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:57.707859 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:23:57.708246 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:57.708427 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:58.061549 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.550 seconds
[0m23:23:58.062345 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_211"
[0m23:23:58.062825 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_211
[0m23:23:58.064706 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_211"
[0m23:23:58.065132 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:23:58.065293 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: BEGIN
[0m23:23:58.065974 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:58.066242 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:23:58.066426 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 4) (id: ipc-211, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:58.067533 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:58.069009 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:23:58.069182 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_tmp" rename to "qr_ipc_211"
[0m23:23:58.069732 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:58.070347 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: COMMIT
[0m23:23:58.070516 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:23:58.070695 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: COMMIT
[0m23:23:58.071617 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:58.072860 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_backup"
[0m23:23:58.073156 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:23:58.073332 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_backup" cascade
[0m23:23:58.073959 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:58.074607 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: Close
[0m23:23:58.074897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a4050>]}
[0m23:23:58.075211 [info ] [Thread-2 (]: 50 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_211  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:58.075472 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_211
[0m23:23:58.075662 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_54
[0m23:23:58.076034 [info ] [Thread-2 (]: 54 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_54 . [RUN]
[0m23:23:58.076268 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_211, now model.engage_analytics.qr_ipc_54)
[0m23:23:58.076442 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_54
[0m23:23:58.078439 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:23:58.078706 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:58.078866 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:58.244502 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.539 seconds
[0m23:23:58.245336 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_212"
[0m23:23:58.245816 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_212
[0m23:23:58.248969 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_212"
[0m23:23:58.249303 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.543 seconds
[0m23:23:58.249640 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.541 seconds
[0m23:23:58.250431 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_221"
[0m23:23:58.251139 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_23451"
[0m23:23:58.251739 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:23:58.252120 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: BEGIN
[0m23:23:58.252442 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_221
[0m23:23:58.254348 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_221"
[0m23:23:58.254576 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_23451
[0m23:23:58.254792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:23:58.256474 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_23451"
[0m23:23:58.256695 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:23:58.256962 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:23:58.257150 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_tmp"
    
    
  as (
    
-- SBIRT (id: ipc-212, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:58.257339 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: BEGIN
[0m23:23:58.257563 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:23:58.257716 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: BEGIN
[0m23:23:58.257949 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:58.258142 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:23:58.258307 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:58.258556 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_tmp"
    
    
  as (
    
-- Add Family Member Registration (id: ipc-221, url: n/a, version: 0.0.3)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:58.258825 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:58.258997 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:23:58.260709 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:23:58.260955 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:23:58.261158 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_tmp"
    
    
  as (
    
-- Discuss Confidentiality (id: ipc-23451, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:58.261369 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_tmp" rename to "qr_ipc_212"
[0m23:23:58.262820 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:23:58.263137 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_tmp" rename to "qr_ipc_221"
[0m23:23:58.263589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:58.263820 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:58.264015 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:58.264604 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: COMMIT
[0m23:23:58.265138 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: COMMIT
[0m23:23:58.266553 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:23:58.266746 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:23:58.266922 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:23:58.267105 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_tmp" rename to "qr_ipc_23451"
[0m23:23:58.267275 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: COMMIT
[0m23:23:58.267430 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: COMMIT
[0m23:23:58.268255 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:58.269010 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: COMMIT
[0m23:23:58.269302 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:23:58.269496 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:58.269693 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: COMMIT
[0m23:23:58.269862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:23:58.271080 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_backup"
[0m23:23:58.272338 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_backup"
[0m23:23:58.272561 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:58.272850 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:23:58.273120 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:23:58.274202 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_backup"
[0m23:23:58.274368 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_backup" cascade
[0m23:23:58.274541 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_backup" cascade
[0m23:23:58.274780 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:23:58.274980 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_backup" cascade
[0m23:23:58.275396 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:58.275570 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:58.276204 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: Close
[0m23:23:58.276367 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:58.276907 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: Close
[0m23:23:58.277542 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: Close
[0m23:23:58.277793 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7aae0>]}
[0m23:23:58.278041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599a6c0>]}
[0m23:23:58.278419 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc2e40>]}
[0m23:23:58.278785 [info ] [Thread-4 (]: 52 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_221  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:58.279125 [info ] [Thread-1 (]: 51 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_212  [[32mCREATE VIEW[0m in 0.58s]
[0m23:23:58.279824 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_221
[0m23:23:58.280194 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_212
[0m23:23:58.280688 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_55
[0m23:23:58.281087 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_56
[0m23:23:58.281623 [info ] [Thread-4 (]: 55 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_55 . [RUN]
[0m23:23:58.281937 [info ] [Thread-1 (]: 56 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_56 . [RUN]
[0m23:23:58.282204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_221, now model.engage_analytics.qr_ipc_55)
[0m23:23:58.282457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_212, now model.engage_analytics.qr_ipc_56)
[0m23:23:58.282676 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_55
[0m23:23:58.282868 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_56
[0m23:23:58.285972 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:23:58.287675 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:23:58.287877 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:58.288054 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:58.288214 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:58.288361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:58.392703 [debug] [Thread-3 (]: An error was encountered while trying to send an event
[0m23:23:58.393359 [info ] [Thread-3 (]: 53 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_23451  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:58.393674 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_23451
[0m23:23:58.393888 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_57
[0m23:23:58.394112 [info ] [Thread-3 (]: 57 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_57 . [RUN]
[0m23:23:58.394359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_23451, now model.engage_analytics.qr_ipc_57)
[0m23:23:58.394589 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_57
[0m23:23:58.396787 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:23:58.397019 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:58.397193 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:58.670446 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.591 seconds
[0m23:23:58.671407 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_54"
[0m23:23:58.671900 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_54
[0m23:23:58.673950 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_54"
[0m23:23:58.674468 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:23:58.674651 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: BEGIN
[0m23:23:58.675533 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:58.675777 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:23:58.675967 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 1) (id: ipc-54, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:58.677156 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:58.678774 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:23:58.679040 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_tmp" rename to "qr_ipc_54"
[0m23:23:58.679738 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:58.680364 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: COMMIT
[0m23:23:58.680542 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:23:58.680693 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: COMMIT
[0m23:23:58.681481 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:58.682929 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_backup"
[0m23:23:58.683210 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:23:58.683384 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_backup" cascade
[0m23:23:58.684060 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:58.684955 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: Close
[0m23:23:58.685283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9aa720>]}
[0m23:23:58.685612 [info ] [Thread-2 (]: 54 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_54  [[32mCREATE VIEW[0m in 0.61s]
[0m23:23:58.685881 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_54
[0m23:23:58.686071 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_58
[0m23:23:58.686272 [info ] [Thread-2 (]: 58 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_58 . [RUN]
[0m23:23:58.686499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_54, now model.engage_analytics.qr_ipc_58)
[0m23:23:58.686658 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_58
[0m23:23:58.688716 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:23:58.688929 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:58.689089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:58.874519 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.586 seconds
[0m23:23:58.875370 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_55"
[0m23:23:58.875863 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_55
[0m23:23:58.876227 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.588 seconds
[0m23:23:58.878332 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_55"
[0m23:23:58.879052 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_56"
[0m23:23:58.879579 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:23:58.879795 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_56
[0m23:23:58.879981 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: BEGIN
[0m23:23:58.881727 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_56"
[0m23:23:58.882189 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:23:58.882376 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_56: BEGIN
[0m23:23:58.882552 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:58.882738 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:23:58.882915 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_tmp"
    
    
  as (
    
-- IPC Session 1 (id: ipc-55, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:58.883093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:58.883261 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:23:58.883428 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_tmp"
    
    
  as (
    

-- Short-Form PCL-5-8 (IPC Session 2) (id: ipc-56, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:58.884344 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:58.884622 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:58.887136 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:23:58.888604 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:23:58.888810 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_tmp" rename to "qr_ipc_55"
[0m23:23:58.889051 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_tmp" rename to "qr_ipc_56"
[0m23:23:58.889821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:58.890132 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:58.890789 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_56: COMMIT
[0m23:23:58.891414 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: COMMIT
[0m23:23:58.891625 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:23:58.891872 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:23:58.892103 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_56: COMMIT
[0m23:23:58.892315 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: COMMIT
[0m23:23:58.893303 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:58.893504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:58.894659 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_backup"
[0m23:23:58.895649 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_backup"
[0m23:23:58.896077 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:23:58.896396 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:23:58.896602 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_backup" cascade
[0m23:23:58.896788 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_backup" cascade
[0m23:23:58.897518 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:58.897736 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:58.898469 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_56: Close
[0m23:23:58.899069 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: Close
[0m23:23:58.899572 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0dfe60>]}
[0m23:23:58.899945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6e5a90>]}
[0m23:23:58.900379 [info ] [Thread-4 (]: 55 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_55  [[32mCREATE VIEW[0m in 0.62s]
[0m23:23:58.900863 [info ] [Thread-1 (]: 56 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_56  [[32mCREATE VIEW[0m in 0.62s]
[0m23:23:58.901688 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_55
[0m23:23:58.902021 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_56
[0m23:23:58.902235 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_59
[0m23:23:58.902459 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_60
[0m23:23:58.902702 [info ] [Thread-4 (]: 59 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_59 . [RUN]
[0m23:23:58.903096 [info ] [Thread-1 (]: 60 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_60 . [RUN]
[0m23:23:58.903400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_55, now model.engage_analytics.qr_ipc_59)
[0m23:23:58.903610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_56, now model.engage_analytics.qr_ipc_60)
[0m23:23:58.903805 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_59
[0m23:23:58.903968 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_60
[0m23:23:58.906079 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:23:58.907949 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:23:58.908160 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:58.908342 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:58.908502 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:58.908650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:58.980492 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.583 seconds
[0m23:23:58.981336 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_57"
[0m23:23:58.981846 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_57
[0m23:23:58.984067 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_57"
[0m23:23:58.984662 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:23:58.984851 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: BEGIN
[0m23:23:58.985508 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:58.985667 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:23:58.985827 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 2) (id: ipc-57, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:58.986902 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:58.988415 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:23:58.988604 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_tmp" rename to "qr_ipc_57"
[0m23:23:58.989363 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:58.990024 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: COMMIT
[0m23:23:58.990219 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:23:58.990382 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: COMMIT
[0m23:23:58.991475 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:58.992665 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_backup"
[0m23:23:58.992975 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:23:58.993134 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_backup" cascade
[0m23:23:58.993709 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:58.994400 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: Close
[0m23:23:58.994696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2b9e0>]}
[0m23:23:58.995095 [info ] [Thread-3 (]: 57 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_57  [[32mCREATE VIEW[0m in 0.60s]
[0m23:23:58.995393 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_57
[0m23:23:58.995590 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_61
[0m23:23:58.995933 [info ] [Thread-3 (]: 61 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_61 . [RUN]
[0m23:23:58.996325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_57, now model.engage_analytics.qr_ipc_61)
[0m23:23:58.996524 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_61
[0m23:23:58.999675 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:23:58.999927 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:59.000103 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:59.246670 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.557 seconds
[0m23:23:59.247509 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_58"
[0m23:23:59.248027 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_58
[0m23:23:59.250137 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_58"
[0m23:23:59.250587 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:23:59.250753 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: BEGIN
[0m23:23:59.251558 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:59.251773 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:23:59.251958 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_tmp"
    
    
  as (
    
-- IPC Session 2 (id: ipc-58, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:59.253097 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:59.254721 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:23:59.254914 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_tmp" rename to "qr_ipc_58"
[0m23:23:59.255686 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:59.256357 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: COMMIT
[0m23:23:59.256548 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:23:59.256708 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: COMMIT
[0m23:23:59.257520 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:59.258769 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_backup"
[0m23:23:59.259093 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:23:59.259316 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_backup" cascade
[0m23:23:59.259960 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:59.260675 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: Close
[0m23:23:59.260967 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2a5d0>]}
[0m23:23:59.261298 [info ] [Thread-2 (]: 58 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_58  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:59.261608 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_58
[0m23:23:59.261800 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_62
[0m23:23:59.262028 [info ] [Thread-2 (]: 62 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_62 . [RUN]
[0m23:23:59.262227 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_58, now model.engage_analytics.qr_ipc_62)
[0m23:23:59.262381 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_62
[0m23:23:59.264415 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:23:59.264645 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:59.264814 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:23:59.454912 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.546 seconds
[0m23:23:59.455699 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_59"
[0m23:23:59.455925 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.547 seconds
[0m23:23:59.456508 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_60"
[0m23:23:59.456960 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_60
[0m23:23:59.457133 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_59
[0m23:23:59.459108 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_60"
[0m23:23:59.460983 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_59"
[0m23:23:59.461413 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:23:59.461583 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: BEGIN
[0m23:23:59.461827 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:23:59.462004 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: BEGIN
[0m23:23:59.462261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:59.462429 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:23:59.462590 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:59.462761 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 3) (id: ipc-60, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:59.462936 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:23:59.463163 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 3) (id: ipc-59, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:59.463988 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:59.464157 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:59.465604 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:23:59.466947 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:23:59.467129 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_tmp" rename to "qr_ipc_60"
[0m23:23:59.467339 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_tmp" rename to "qr_ipc_59"
[0m23:23:59.468117 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:59.468315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:23:59.468938 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: COMMIT
[0m23:23:59.470432 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: COMMIT
[0m23:23:59.470610 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:23:59.470764 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:23:59.470913 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: COMMIT
[0m23:23:59.471073 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: COMMIT
[0m23:23:59.472131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:59.472341 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:59.473419 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_backup"
[0m23:23:59.474397 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_backup"
[0m23:23:59.474656 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:23:59.474906 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:23:59.475085 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_backup" cascade
[0m23:23:59.475250 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_backup" cascade
[0m23:23:59.475818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:59.476131 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:23:59.476795 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: Close
[0m23:23:59.477430 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: Close
[0m23:23:59.477826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc25310>]}
[0m23:23:59.478233 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbde3c0>]}
[0m23:23:59.478595 [info ] [Thread-1 (]: 60 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_60  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:59.479008 [info ] [Thread-4 (]: 59 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_59  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:59.479326 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_60
[0m23:23:59.479613 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_59
[0m23:23:59.479830 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_63
[0m23:23:59.480062 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_69
[0m23:23:59.480355 [info ] [Thread-1 (]: 63 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_63 . [RUN]
[0m23:23:59.480660 [info ] [Thread-4 (]: 64 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_69 . [RUN]
[0m23:23:59.480925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_60, now model.engage_analytics.qr_ipc_63)
[0m23:23:59.481159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_59, now model.engage_analytics.qr_ipc_69)
[0m23:23:59.481358 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_63
[0m23:23:59.481530 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_69
[0m23:23:59.483695 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:23:59.485880 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:23:59.486146 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:59.486330 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:59.486493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:59.486638 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:23:59.547272 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.547 seconds
[0m23:23:59.548111 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_61"
[0m23:23:59.548597 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_61
[0m23:23:59.550669 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_61"
[0m23:23:59.551237 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:23:59.551421 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: BEGIN
[0m23:23:59.552097 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:23:59.552306 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:23:59.552485 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 3) (id: ipc-61, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:59.553458 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:59.554833 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:23:59.555001 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_tmp" rename to "qr_ipc_61"
[0m23:23:59.555443 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:59.555970 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: COMMIT
[0m23:23:59.556125 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:23:59.556327 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: COMMIT
[0m23:23:59.557677 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:59.558916 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_backup"
[0m23:23:59.559236 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:23:59.559411 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_backup" cascade
[0m23:23:59.560004 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:59.560639 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: Close
[0m23:23:59.560921 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae8980>]}
[0m23:23:59.561225 [info ] [Thread-3 (]: 61 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_61  [[32mCREATE VIEW[0m in 0.56s]
[0m23:23:59.561482 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_61
[0m23:23:59.561677 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:23:59.561918 [info ] [Thread-3 (]: 65 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_q_common_mental_health_symptoms  [RUN]
[0m23:23:59.562119 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_61, now model.engage_analytics.qr_q_common_mental_health_symptoms)
[0m23:23:59.562282 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:23:59.564628 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:23:59.564915 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:59.565085 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:23:59.813815 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.549 seconds
[0m23:23:59.815846 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_62"
[0m23:23:59.817195 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_62
[0m23:23:59.821474 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_62"
[0m23:23:59.822066 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:23:59.822261 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: BEGIN
[0m23:23:59.823145 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:23:59.823424 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:23:59.823611 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 4) (id: ipc-62, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:23:59.824689 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:23:59.826248 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:23:59.826439 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_tmp" rename to "qr_ipc_62"
[0m23:23:59.827115 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:23:59.827872 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: COMMIT
[0m23:23:59.828092 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:23:59.828259 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: COMMIT
[0m23:23:59.829067 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:23:59.830234 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_backup"
[0m23:23:59.830496 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:23:59.830659 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_backup" cascade
[0m23:23:59.831252 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:23:59.832067 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: Close
[0m23:23:59.832367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe43b0>]}
[0m23:23:59.832725 [info ] [Thread-2 (]: 62 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_62  [[32mCREATE VIEW[0m in 0.57s]
[0m23:23:59.832976 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_62
[0m23:23:59.833162 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:23:59.833571 [info ] [Thread-2 (]: 66 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_q_financial_wellness_tool  [RUN]
[0m23:23:59.833777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_62, now model.engage_analytics.qr_q_financial_wellness_tool)
[0m23:23:59.833941 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:23:59.836252 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:23:59.836482 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:23:59.836654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:00.033007 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.546 seconds
[0m23:24:00.033907 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_69"
[0m23:24:00.034489 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_69
[0m23:24:00.036700 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_69"
[0m23:24:00.036971 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.550 seconds
[0m23:24:00.037758 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_63"
[0m23:24:00.038160 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:00.038434 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: BEGIN
[0m23:24:00.038805 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_63
[0m23:24:00.040809 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_63"
[0m23:24:00.041092 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:00.041348 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:00.041629 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_tmp"
    
    
  as (
    
-- eCBIS Remove Family Form (id: ipc-69, url: n/a, version: 0.0.2)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:00.041966 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:00.042175 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: BEGIN
[0m23:24:00.042952 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:00.043176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:00.044779 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:00.045060 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:00.045302 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_tmp" rename to "qr_ipc_69"
[0m23:24:00.045528 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_tmp"
    
    
  as (
    
-- IPC Session 4 (id: ipc-63, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:00.046168 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:24:00.046797 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: COMMIT
[0m23:24:00.046976 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:00.047150 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: COMMIT
[0m23:24:00.047403 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:00.049079 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:00.049300 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:00.049490 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_tmp" rename to "qr_ipc_63"
[0m23:24:00.050638 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_backup"
[0m23:24:00.051088 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:00.051277 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_backup" cascade
[0m23:24:00.051448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:00.052062 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: COMMIT
[0m23:24:00.052243 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:00.052416 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:00.053240 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: Close
[0m23:24:00.053466 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: COMMIT
[0m23:24:00.053933 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb92cc0>]}
[0m23:24:00.054403 [info ] [Thread-4 (]: 64 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_69  [[32mCREATE VIEW[0m in 0.57s]
[0m23:24:00.054693 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_69
[0m23:24:00.054902 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_q_planning_next_steps
[0m23:24:00.055110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:00.055337 [info ] [Thread-4 (]: 67 of 70 START sql view model engage_analytics_engage_analytics_mart.qr_q_planning_next_steps  [RUN]
[0m23:24:00.057461 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_backup"
[0m23:24:00.057693 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_69, now model.engage_analytics.qr_q_planning_next_steps)
[0m23:24:00.057965 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:00.058142 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_q_planning_next_steps
[0m23:24:00.058323 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_backup" cascade
[0m23:24:00.060869 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:00.061233 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:00.061456 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:00.061695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:00.062405 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: Close
[0m23:24:00.062705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba39640>]}
[0m23:24:00.063013 [info ] [Thread-1 (]: 63 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_63  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:00.063282 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_63
[0m23:24:00.063468 [debug] [Thread-1 (]: Began running node model.engage_analytics.unnested_careteams
[0m23:24:00.063694 [info ] [Thread-1 (]: 68 of 70 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m23:24:00.063889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_63, now model.engage_analytics.unnested_careteams)
[0m23:24:00.064048 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m23:24:00.065547 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m23:24:00.066118 [debug] [Thread-1 (]: Began executing node model.engage_analytics.unnested_careteams
[0m23:24:00.068188 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m23:24:00.068638 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:00.068818 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m23:24:00.068974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:00.075623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:24:00.075917 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:00.076105 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m23:24:00.077714 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:00.079515 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:00.079734 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m23:24:00.080483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:00.081200 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m23:24:00.081391 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:00.081549 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m23:24:00.082394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:00.083553 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m23:24:00.083804 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:00.083968 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m23:24:00.084502 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:00.085267 [debug] [Thread-1 (]: On model.engage_analytics.unnested_careteams: Close
[0m23:24:00.085576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb4d340>]}
[0m23:24:00.085893 [info ] [Thread-1 (]: 68 of 70 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.02s]
[0m23:24:00.086153 [debug] [Thread-1 (]: Finished running node model.engage_analytics.unnested_careteams
[0m23:24:00.086343 [debug] [Thread-1 (]: Began running node model.engage_analytics.current_practitioner_role
[0m23:24:00.086585 [info ] [Thread-1 (]: 69 of 70 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m23:24:00.086788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.current_practitioner_role)
[0m23:24:00.086950 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m23:24:00.088375 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m23:24:00.088881 [debug] [Thread-1 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m23:24:00.091006 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m23:24:00.091428 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:00.091591 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m23:24:00.091764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:00.098817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:24:00.099105 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:00.099283 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m23:24:00.101277 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:00.102975 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:00.103206 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m23:24:00.103970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:00.104573 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m23:24:00.104753 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:00.104911 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m23:24:00.106334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:00.108620 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m23:24:00.109097 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:00.109306 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m23:24:00.110319 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:00.111110 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: Close
[0m23:24:00.111420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba97620>]}
[0m23:24:00.111733 [info ] [Thread-1 (]: 69 of 70 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.02s]
[0m23:24:00.111985 [debug] [Thread-1 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m23:24:00.112261 [debug] [Thread-1 (]: Began running node model.engage_analytics.practitioners
[0m23:24:00.112462 [info ] [Thread-1 (]: 70 of 70 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m23:24:00.112663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.practitioners)
[0m23:24:00.112891 [debug] [Thread-3 (]: SQL status: SELECT 36 in 0.548 seconds
[0m23:24:00.113134 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.practitioners
[0m23:24:00.115085 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:00.117411 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:00.117741 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m23:24:00.117901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:00.118553 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:24:00.120772 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:00.121339 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:00.121526 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: BEGIN
[0m23:24:00.122171 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:00.122339 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:00.122723 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Common Mental Health Symptoms (id: q-common-mental-health-symptoms, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879"
      
    
    ,
  
    max(
      
      case
      when linkid = '16d05294-fee9-4d42-8447-0d578a5de192'
        then answer_value_text
      else null
      end
    )
    
      
            as "16d05294-fee9-4d42-8447-0d578a5de192"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603'
        then answer_value_text
      else null
      end
    )
    
      
            as "829e6d32-3fa7-4d16-909b-b198aea54603"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-common-mental-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-common-mental-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "583c5b02-b26c-4821-8da8-7ed9066d9d5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a05b4fe-b514-4751-91be-adb1b278430c"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-pcl-5-to-8-questions'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-pcl-5-to-8-questions"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:00.125256 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m23:24:00.126152 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:00.126357 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m23:24:00.126583 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:00.128219 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:00.128419 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:24:00.128604 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_tmp" rename to "qr_q_common_mental_health_symptoms"
[0m23:24:00.129603 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m23:24:00.130056 [debug] [Thread-1 (]: Began executing node model.engage_analytics.practitioners
[0m23:24:00.132205 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m23:24:00.132469 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:24:00.133292 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: COMMIT
[0m23:24:00.133513 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:00.133684 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: COMMIT
[0m23:24:00.134035 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:00.134270 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: BEGIN
[0m23:24:00.134637 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:00.134860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:00.136010 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_backup"
[0m23:24:00.136189 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:00.136463 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:00.136668 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
  
    

  create  table "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

  );
  
  
[0m23:24:00.136873 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_backup" cascade
[0m23:24:00.137442 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:00.138242 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: Close
[0m23:24:00.138549 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b69c620>]}
[0m23:24:00.138878 [info ] [Thread-3 (]: 65 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:00.139146 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:24:00.142875 [debug] [Thread-1 (]: SQL status: SELECT 73 in 0.006 seconds
[0m23:24:00.143665 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m23:24:00.143864 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:00.144025 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m23:24:00.144976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:00.145335 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: Close
[0m23:24:00.145599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb48290>]}
[0m23:24:00.145902 [info ] [Thread-1 (]: 70 of 70 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mSELECT 73[0m in 0.03s]
[0m23:24:00.146151 [debug] [Thread-1 (]: Finished running node model.engage_analytics.practitioners
[0m23:24:00.421248 [debug] [Thread-2 (]: SQL status: SELECT 23 in 0.585 seconds
[0m23:24:00.423340 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:00.423990 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:24:00.425927 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:00.426326 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:00.426491 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_financial_wellness_tool: BEGIN
[0m23:24:00.427202 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:00.427415 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:00.427737 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Financial Wellness Tool (id: q-financial-wellness-tool, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'moderate-housing-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-housing-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'overall-financial-hardship'
        then answer_value_text
      else null
      end
    )
    
      
            as "overall-financial-hardship"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-medical-hardships'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-medical-hardships"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "cdef0123-4567-89ab-cdef-0123456789ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '51234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "51234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '31234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "31234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '91234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "91234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-housing-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-housing-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-food-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-food-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-debt'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-debt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c1234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-paying-bills'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-paying-bills"
      
    
    ,
  
    max(
      
      case
      when linkid = '3456789a-bcde-f012-3456-789abcdef012'
        then answer_value_text
      else null
      end
    )
    
      
            as "3456789a-bcde-f012-3456-789abcdef012"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-debt'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-debt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-food-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-food-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = '61234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "61234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '6789abcd-ef01-2345-6789-abcdef012345'
        then answer_value_text
      else null
      end
    )
    
      
            as "6789abcd-ef01-2345-6789-abcdef012345"
      
    
    ,
  
    max(
      
      case
      when linkid = '21234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "21234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-financial-hardship'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-financial-hardship"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-paying-bills'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-paying-bills"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f0123456-789a-bcde-f012-3456789abcde'
        then answer_value_text
      else null
      end
    )
    
      
            as "f0123456-789a-bcde-f012-3456789abcde"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:00.431109 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:00.433396 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:00.433579 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_tmp" rename to "qr_q_financial_wellness_tool"
[0m23:24:00.434443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:00.435032 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_financial_wellness_tool: COMMIT
[0m23:24:00.435210 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:00.435363 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_financial_wellness_tool: COMMIT
[0m23:24:00.436236 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:00.437347 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_backup"
[0m23:24:00.437594 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:00.437750 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_backup" cascade
[0m23:24:00.438378 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:00.439125 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_financial_wellness_tool: Close
[0m23:24:00.439446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b984140>]}
[0m23:24:00.439772 [info ] [Thread-2 (]: 66 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_financial_wellness_tool  [[32mCREATE VIEW[0m in 0.61s]
[0m23:24:00.440039 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:24:00.639495 [debug] [Thread-4 (]: SQL status: SELECT 66 in 0.578 seconds
[0m23:24:00.642334 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:00.642881 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_q_planning_next_steps
[0m23:24:00.645610 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:00.646344 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:00.646690 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: BEGIN
[0m23:24:00.647539 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:00.647702 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:00.648250 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Planning Next Steps (id: q-planning-next-steps, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d'
        then answer_value_text
      else null
      end
    )
    
      
            as "2cb66889-3c74-40ff-be3d-183fdb17ce2d"
      
    
    ,
  
    max(
      
      case
      when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd34f5b1-8dff-4fd1-b1a0-a1356789abcd"
      
    
    ,
  
    max(
      
      case
      when linkid = '69712544-6237-4962-a455-ee6e9ee80000'
        then answer_value_text
      else null
      end
    )
    
      
            as "69712544-6237-4962-a455-ee6e9ee80000"
      
    
    ,
  
    max(
      
      case
      when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7'
        then answer_value_text
      else null
      end
    )
    
      
            as "12894a06-d244-4426-06f5-f2a3b4c5d6e7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt-optional'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt-optional"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-other-services-outside-agency'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-other-services-outside-agency"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt-main'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt-main"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc23e4a0-7cee-4ec0-a09f-902456789abc"
      
    
    ,
  
    max(
      
      case
      when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "1d2fdd10-a4d1-43e0-8042-8772146e63f7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a'
        then answer_value_text
      else null
      end
    )
    
      
            as "de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-002'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-002"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i'
        then answer_value_text
      else null
      end
    )
    
      
            as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7"
      
    
    ,
  
    max(
      
      case
      when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "45b67d39-0577-4759-3928-52c3d4e5f6a7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-000'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-000"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-003'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-003"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100'
        then answer_value_text
      else null
      end
    )
    
      
            as "f4e3d2c1-b0a9-4988-7766-554433221100"
      
    
    ,
  
    max(
      
      case
      when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01'
        then answer_value_text
      else null
      end
    )
    
      
            as "34ab6c28-f466-4648-2817-1eacbdcedf01"
      
    
    ,
  
    max(
      
      case
      when linkid = 'scheduled-ipc-session-1-with-current-time'
        then answer_value_text
      else null
      end
    )
    
      
            as "scheduled-ipc-session-1-with-current-time"
      
    
    ,
  
    max(
      
      case
      when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123'
        then answer_value_text
      else null
      end
    )
    
      
            as "45bc7d39-0577-4759-3928-2fbdcedf0123"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc-main'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc-main"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc"
      
    
    ,
  
    max(
      
      case
      when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4"
      
    
    ,
  
    max(
      
      case
      when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e'
        then answer_value_text
      else null
      end
    )
    
      
            as "76ba8dbe-5456-4de4-bdde-4b8059ecfa0e"
      
    
    ,
  
    max(
      
      case
      when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106'
        then answer_value_text
      else null
      end
    )
    
      
            as "950d904a-da1a-4ccd-988d-ea6b463ee106"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-004'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-004"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-spi'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-spi"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-planning-next-steps-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-planning-next-steps-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "ab12d39f-6bdd-4dbf-9f8e-8f13456789ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90'
        then answer_value_text
      else null
      end
    )
    
      
            as "de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90"
      
    
    ,
  
    max(
      
      case
      when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "34a56c28-f466-4648-2817-41b2c3d4e5f6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-006'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-006"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-fws'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-fws"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f"
      
    
    ,
  
    max(
      
      case
      when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574'
        then answer_value_text
      else null
      end
    )
    
      
            as "9311146c-720d-47f6-b902-aeecaf3c0574"
      
    
    ,
  
    max(
      
      case
      when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f'
        then answer_value_text
      else null
      end
    )
    
      
            as "256b56d8-c4c2-4313-9e2d-6720941be85f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g"
      
    
    ,
  
    max(
      
      case
      when linkid = 'financial-hardships-list'
        then answer_value_text
      else null
      end
    )
    
      
            as "financial-hardships-list"
      
    
    ,
  
    max(
      
      case
      when linkid = 'scheduled-ipc-session-1-with-current-time-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "scheduled-ipc-session-1-with-current-time-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-001'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-001"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-mhs'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-mhs"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-other-agency-services'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-other-agency-services"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d373ba7-14fa-43bb-bd27-52fad3d2783f"
      
    
    ,
  
    max(
      
      case
      when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345'
        then answer_value_text
      else null
      end
    )
    
      
            as "56cd8e4a-1688-486a-4a39-3acedf012345"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "f06728e4-b022-4204-e4d3-d0e1f2a3b4c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9'
        then answer_value_text
      else null
      end
    )
    
      
            as "34ab6c28-f466-4648-2817-14c5d6e7f8a9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc-optional'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc-optional"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:00.653833 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:00.655597 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:00.655799 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_tmp" rename to "qr_q_planning_next_steps"
[0m23:24:00.657104 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:00.657827 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: COMMIT
[0m23:24:00.658036 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:00.658205 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: COMMIT
[0m23:24:00.659104 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:00.660487 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_backup"
[0m23:24:00.660765 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:00.660936 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_backup" cascade
[0m23:24:00.661488 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:00.662134 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_planning_next_steps: Close
[0m23:24:00.662421 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfed165a-fdc5-4166-9bb5-d2a9ce86512d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8df70>]}
[0m23:24:00.662731 [info ] [Thread-4 (]: 67 of 70 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_planning_next_steps  [[32mCREATE VIEW[0m in 0.60s]
[0m23:24:00.662995 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_q_planning_next_steps
[0m23:24:00.663796 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:00.663947 [debug] [MainThread]: On master: BEGIN
[0m23:24:00.664080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:24:00.670697 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:24:00.671006 [debug] [MainThread]: On master: COMMIT
[0m23:24:00.671168 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:00.671302 [debug] [MainThread]: On master: COMMIT
[0m23:24:00.671715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:24:00.671900 [debug] [MainThread]: On master: Close
[0m23:24:00.672125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:00.672262 [debug] [MainThread]: Connection 'model.engage_analytics.practitioners' was properly closed.
[0m23:24:00.672382 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_financial_wellness_tool' was properly closed.
[0m23:24:00.672501 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_common_mental_health_symptoms' was properly closed.
[0m23:24:00.672613 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_planning_next_steps' was properly closed.
[0m23:24:00.672892 [info ] [MainThread]: 
[0m23:24:00.673059 [info ] [MainThread]: Finished running 6 incremental models, 64 view models in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m23:24:00.676844 [debug] [MainThread]: Command end result
[0m23:24:00.714324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:24:00.715648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:24:00.729366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m23:24:00.729667 [info ] [MainThread]: 
[0m23:24:00.729949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:24:00.730178 [info ] [MainThread]: 
[0m23:24:00.730347 [info ] [MainThread]: Done. PASS=70 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=70
[0m23:24:00.730738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.692442, "process_in_blocks": "0", "process_kernel_time": 0.295142, "process_mem_max_rss": "138903552", "process_out_blocks": "0", "process_user_time": 2.535587}
[0m23:24:00.730963 [debug] [MainThread]: Command `dbt run` succeeded at 23:24:00.730924 after 10.69 seconds
[0m23:24:00.731148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f09460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baeb080>]}
[0m23:24:00.731334 [debug] [MainThread]: Flushing usage events
[0m23:24:00.811151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:24:35.080255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a31400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107509280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107508f80>]}


============================== 23:24:35.083364 | 81b662e7-633f-40a1-85ba-b7737743df1a ==============================
[0m23:24:35.083364 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:24:35.083710 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m23:24:35.176574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103efb530>]}
[0m23:24:35.208858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708c470>]}
[0m23:24:35.209767 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:24:35.263241 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:24:35.349662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:24:35.349934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:24:35.400467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad6de0>]}
[0m23:24:35.457816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:24:35.459543 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:24:35.474591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083efad0>]}
[0m23:24:35.474955 [info ] [MainThread]: Found 84 models, 12 sources, 557 macros
[0m23:24:35.475143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cd190>]}
[0m23:24:35.477577 [info ] [MainThread]: 
[0m23:24:35.477842 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:24:35.477983 [info ] [MainThread]: 
[0m23:24:35.478232 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:24:35.481984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:24:35.482331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:24:35.489018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:24:35.511505 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:24:35.511770 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:24:35.511955 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:24:35.512109 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:24:35.512274 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:24:35.512442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:35.512584 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:24:35.512717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:35.512963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:35.539633 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.027 seconds
[0m23:24:35.539914 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.027 seconds
[0m23:24:35.540673 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:24:35.541215 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:24:35.541363 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.029 seconds
[0m23:24:35.542298 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:24:35.545100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m23:24:35.545420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m23:24:35.548336 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:24:35.548624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m23:24:35.549573 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:24:35.549746 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m23:24:35.550548 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:24:35.551436 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m23:24:35.551592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:35.551730 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m23:24:35.551855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:35.552122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:35.567198 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m23:24:35.567463 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m23:24:35.567685 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:24:35.567886 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:24:35.568054 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m23:24:35.568277 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m23:24:35.568532 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:24:35.568733 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:24:35.568900 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m23:24:35.570339 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m23:24:35.571113 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m23:24:35.571335 [debug] [ThreadPool]: SQL status: SELECT 70 in 0.003 seconds
[0m23:24:35.571558 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m23:24:35.572673 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m23:24:35.572891 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m23:24:35.573585 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m23:24:35.574614 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m23:24:35.577943 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m23:24:35.582241 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:35.582443 [debug] [MainThread]: On master: BEGIN
[0m23:24:35.582569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:24:35.592491 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:24:35.592699 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:35.592886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:24:35.595701 [debug] [MainThread]: SQL status: SELECT 106 in 0.003 seconds
[0m23:24:35.603088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108194ec0>]}
[0m23:24:35.603324 [debug] [MainThread]: On master: ROLLBACK
[0m23:24:35.604496 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:35.604643 [debug] [MainThread]: On master: BEGIN
[0m23:24:35.606118 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:24:35.606281 [debug] [MainThread]: On master: COMMIT
[0m23:24:35.606415 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:35.606539 [debug] [MainThread]: On master: COMMIT
[0m23:24:35.607076 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:24:35.607212 [debug] [MainThread]: On master: Close
[0m23:24:35.608909 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m23:24:35.609377 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m23:24:35.609629 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m23:24:35.609163 [info ] [Thread-1 (]: 1 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m23:24:35.609888 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m23:24:35.610134 [info ] [Thread-2 (]: 2 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m23:24:35.610403 [info ] [Thread-3 (]: 3 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m23:24:35.610640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_careplans)
[0m23:24:35.610846 [info ] [Thread-4 (]: 4 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m23:24:35.611206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_careteams)
[0m23:24:35.611404 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_encounter)
[0m23:24:35.611568 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m23:24:35.611900 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m23:24:35.612176 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m23:24:35.612377 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m23:24:35.621015 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m23:24:35.621258 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m23:24:35.623298 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m23:24:35.625323 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m23:24:35.628706 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m23:24:35.629131 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m23:24:35.647706 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m23:24:35.654371 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m23:24:35.687216 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m23:24:35.688642 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:24:35.689475 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:24:35.691341 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:24:35.693076 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:24:35.693309 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

    
  
    

  create temporary table "stg_careplans__dbt_tmp232435643251"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans")

  );
  
  
[0m23:24:35.693541 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

    
  
    

  create temporary table "stg_encounter__dbt_tmp232435656325"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter")

  );
  
  
[0m23:24:35.693758 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

    
  
    

  create temporary table "stg_careteams__dbt_tmp232435690731"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams")

  );
  
  
[0m23:24:35.693968 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

    
  
    

  create temporary table "stg_locations__dbt_tmp232435692393"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations")

  );
  
  
[0m23:24:35.694184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:35.694327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:35.694469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:35.694608 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:24:35.716935 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.022 seconds
[0m23:24:35.717289 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.023 seconds
[0m23:24:35.721740 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.027 seconds
[0m23:24:35.724618 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:24:35.726035 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:24:35.726213 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m23:24:35.727476 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:24:35.727670 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m23:24:35.727838 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m23:24:35.729079 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:24:35.729260 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m23:24:35.729563 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m23:24:35.730032 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:35.730239 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:24:35.730427 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams__dbt_tmp232435690731'
        
      order by ordinal_position

  
[0m23:24:35.730640 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:35.730860 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:35.731135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:35.731352 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:24:35.731587 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:24:35.731776 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:24:35.731961 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter__dbt_tmp232435656325'
        
      order by ordinal_position

  
[0m23:24:35.732151 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations__dbt_tmp232435692393'
        
      order by ordinal_position

  
[0m23:24:35.732330 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans__dbt_tmp232435643251'
        
      order by ordinal_position

  
[0m23:24:35.735393 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.005 seconds
[0m23:24:35.738199 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:24:35.738482 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.006 seconds
[0m23:24:35.738739 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.738958 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.006 seconds
[0m23:24:35.739219 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.007 seconds
[0m23:24:35.741957 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:24:35.743710 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:24:35.745543 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:24:35.745793 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.745997 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.004 seconds
[0m23:24:35.746209 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.746414 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.750382 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:24:35.750706 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.004 seconds
[0m23:24:35.751108 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.752966 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:24:35.753334 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.753595 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.003 seconds
[0m23:24:35.753816 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.003 seconds
[0m23:24:35.755473 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:24:35.755742 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m23:24:35.755953 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.003 seconds
[0m23:24:35.757731 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:24:35.757972 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.765524 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m23:24:35.766653 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m23:24:35.766884 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.767531 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:24:35.767821 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:24:35.768059 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careteams__dbt_tmp232435690731" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" ("id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource")
    (
        select "id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource"
        from "stg_careteams__dbt_tmp232435690731"
    )
  
[0m23:24:35.768325 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_locations__dbt_tmp232435692393" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" ("id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference")
    (
        select "id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference"
        from "stg_locations__dbt_tmp232435692393"
    )
  
[0m23:24:35.769042 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.002 seconds
[0m23:24:35.769274 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.002 seconds
[0m23:24:35.770391 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m23:24:35.770615 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:24:35.770786 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:24:35.771823 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m23:24:35.778549 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m23:24:35.779330 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m23:24:35.779783 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:24:35.779953 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:24:35.780195 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:24:35.780382 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:24:35.780589 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_encounter__dbt_tmp232435656325" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" ("id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at"
        from "stg_encounter__dbt_tmp232435656325"
    )
  
[0m23:24:35.780800 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m23:24:35.780970 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m23:24:35.781151 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careplans__dbt_tmp232435643251" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" ("id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at"
        from "stg_careplans__dbt_tmp232435643251"
    )
  
[0m23:24:35.782369 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:35.782648 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:35.782838 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:35.783649 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m23:24:35.783876 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:35.784674 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m23:24:35.785646 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m23:24:35.785871 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:24:35.786197 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m23:24:35.786366 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:24:35.786544 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m23:24:35.787421 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m23:24:35.787871 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108843ad0>]}
[0m23:24:35.788107 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822cfe0>]}
[0m23:24:35.788739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:35.788929 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:35.788515 [info ] [Thread-4 (]: 4 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mINSERT 0 0[0m in 0.17s]
[0m23:24:35.789827 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m23:24:35.789399 [info ] [Thread-2 (]: 2 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mINSERT 0 0[0m in 0.18s]
[0m23:24:35.790269 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m23:24:35.790566 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m23:24:35.790846 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m23:24:35.791091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dfcb0>]}
[0m23:24:35.791364 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m23:24:35.791728 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108303170>]}
[0m23:24:35.791995 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_organizations
[0m23:24:35.792391 [info ] [Thread-1 (]: 1 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mINSERT 0 0[0m in 0.18s]
[0m23:24:35.792821 [info ] [Thread-4 (]: 5 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m23:24:35.793165 [info ] [Thread-3 (]: 3 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mINSERT 0 0[0m in 0.18s]
[0m23:24:35.793375 [info ] [Thread-2 (]: 6 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m23:24:35.793689 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m23:24:35.793902 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_organization_affiliations)
[0m23:24:35.794135 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m23:24:35.794295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_organizations)
[0m23:24:35.794480 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_patient
[0m23:24:35.794692 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m23:24:35.794874 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_practitioner
[0m23:24:35.795031 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_organizations
[0m23:24:35.795315 [info ] [Thread-1 (]: 7 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m23:24:35.797779 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.801029 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m23:24:35.798047 [info ] [Thread-3 (]: 8 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m23:24:35.801415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_patient)
[0m23:24:35.801735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_practitioner)
[0m23:24:35.801931 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_patient
[0m23:24:35.802158 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m23:24:35.804371 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m23:24:35.804624 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_organizations
[0m23:24:35.804794 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m23:24:35.806956 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m23:24:35.808857 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:24:35.810471 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.810783 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

    
  
    

  create temporary table "stg_organizations__dbt_tmp232435808124"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  -- this filter will only be applied on an incremental run
   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations")

  );
  
  
[0m23:24:35.810990 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_patient
[0m23:24:35.811202 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

    
  
    

  create temporary table "stg_organization_affiliations__dbt_tmp232435809884"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations")

  );
  
  
[0m23:24:35.811455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:35.813382 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:24:35.813658 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_practitioner
[0m23:24:35.813883 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:35.814191 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

    
  
    

  create temporary table "stg_patient__dbt_tmp232435812756"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient")

  );
  
  
[0m23:24:35.816204 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:24:35.816518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:35.816740 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

    
  
    

  create temporary table "stg_practitioner__dbt_tmp232435815440"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner")

  );
  
  
[0m23:24:35.817092 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:35.823481 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.012 seconds
[0m23:24:35.825197 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:24:35.825400 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m23:24:35.826045 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:35.826355 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:24:35.826541 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations__dbt_tmp232435808124'
        
      order by ordinal_position

  
[0m23:24:35.829222 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.015 seconds
[0m23:24:35.831443 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.831729 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.015 seconds
[0m23:24:35.832000 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m23:24:35.832213 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.015 seconds
[0m23:24:35.832421 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:24:35.834022 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:24:35.835787 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:24:35.836015 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:35.837702 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:24:35.837985 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: BEGIN
[0m23:24:35.838325 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m23:24:35.838541 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.838750 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.839053 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations__dbt_tmp232435809884'
        
      order by ordinal_position

  
[0m23:24:35.839710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:35.839910 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:24:35.840079 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient__dbt_tmp232435812756'
        
      order by ordinal_position

  
[0m23:24:35.840322 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:35.840570 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:24:35.840749 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner__dbt_tmp232435815440'
        
      order by ordinal_position

  
[0m23:24:35.841232 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:24:35.843133 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:24:35.843366 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.843667 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:24:35.845410 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.845737 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:24:35.845943 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.006 seconds
[0m23:24:35.846118 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.846279 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:24:35.847849 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:24:35.849286 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:24:35.850571 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m23:24:35.850907 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.851320 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.851762 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:24:35.853759 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.854166 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.002 seconds
[0m23:24:35.854411 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:24:35.854588 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.854784 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:24:35.857161 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:24:35.891415 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organizations__dbt_tmp232435808124" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" ("id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at")
    (
        select "id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at"
        from "stg_organizations__dbt_tmp232435808124"
    )
  
[0m23:24:35.891755 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.893170 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:24:35.893554 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.024 seconds
[0m23:24:35.894061 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.895246 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.895536 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:24:35.895800 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.002 seconds
[0m23:24:35.896665 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m23:24:35.898879 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:24:35.899083 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m23:24:35.897884 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m23:24:35.901605 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.902114 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:24:35.904220 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organization_affiliations__dbt_tmp232435809884" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" ("id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at"
        from "stg_organization_affiliations__dbt_tmp232435809884"
    )
  
[0m23:24:35.906810 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m23:24:35.908208 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m23:24:35.908535 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:24:35.909021 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: Close
[0m23:24:35.909319 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_patient__dbt_tmp232435812756" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" ("id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at")
    (
        select "id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at"
        from "stg_patient__dbt_tmp232435812756"
    )
  
[0m23:24:35.909667 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108974620>]}
[0m23:24:35.909931 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:35.910312 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:24:35.911386 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m23:24:35.911635 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:24:35.910708 [info ] [Thread-2 (]: 6 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mINSERT 0 0[0m in 0.12s]
[0m23:24:35.911973 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner__dbt_tmp232435815440" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" ("id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at"
        from "stg_practitioner__dbt_tmp232435815440"
    )
  
[0m23:24:35.912213 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:24:35.912857 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: COMMIT
[0m23:24:35.913131 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_organizations
[0m23:24:35.913379 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m23:24:35.913591 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:24:35.913833 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m23:24:35.914152 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: COMMIT
[0m23:24:35.914498 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:35.914940 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:35.914777 [info ] [Thread-2 (]: 9 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m23:24:35.915729 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m23:24:35.915970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:35.916453 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m23:24:35.916685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_practitioner_roles)
[0m23:24:35.916928 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:24:35.917380 [debug] [Thread-1 (]: On model.engage_analytics.stg_patient: Close
[0m23:24:35.917617 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m23:24:35.917930 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108941790>]}
[0m23:24:35.918130 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m23:24:35.920738 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.921096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898fb00>]}
[0m23:24:35.921538 [info ] [Thread-4 (]: 5 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mINSERT 0 0[0m in 0.12s]
[0m23:24:35.922036 [info ] [Thread-1 (]: 7 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mINSERT 0 0[0m in 0.12s]
[0m23:24:35.922499 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m23:24:35.922824 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m23:24:35.923061 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:35.923309 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_patient
[0m23:24:35.923541 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m23:24:35.925668 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.926265 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: Close
[0m23:24:35.926525 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_task
[0m23:24:35.927123 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

    
  
    

  create temporary table "stg_practitioner_roles__dbt_tmp232435924844"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles")

  );
  
  
[0m23:24:35.926846 [info ] [Thread-4 (]: 10 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m23:24:35.927773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898fe30>]}
[0m23:24:35.927464 [info ] [Thread-1 (]: 11 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m23:24:35.928051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:35.928299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_questionnaire_response)
[0m23:24:35.928905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.stg_task)
[0m23:24:35.928680 [info ] [Thread-3 (]: 8 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mINSERT 0 0[0m in 0.13s]
[0m23:24:35.929292 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m23:24:35.929478 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_task
[0m23:24:35.929806 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_practitioner
[0m23:24:35.932211 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.934766 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m23:24:35.935051 [debug] [Thread-3 (]: Began running node model.engage_analytics.unnested_careteams
[0m23:24:35.935456 [info ] [Thread-3 (]: 12 of 84 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m23:24:35.935735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.unnested_careteams)
[0m23:24:35.935954 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m23:24:35.936249 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m23:24:35.938185 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.938435 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.010 seconds
[0m23:24:35.938626 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_task
[0m23:24:35.940195 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m23:24:35.940487 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

    
  
    

  create temporary table "stg_questionnaire_response__dbt_tmp232435937460"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response")

  );
  
  
[0m23:24:35.941958 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.944810 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:24:35.945142 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:35.945346 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m23:24:35.945603 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

    
  
    

  create temporary table "stg_task__dbt_tmp232435944137"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task")

  );
  
  
[0m23:24:35.945913 [debug] [Thread-3 (]: Began executing node model.engage_analytics.unnested_careteams
[0m23:24:35.946108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:35.951490 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m23:24:35.955430 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m23:24:35.955797 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.956058 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles__dbt_tmp232435924844'
        
      order by ordinal_position

  
[0m23:24:35.956469 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:35.956666 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m23:24:35.956828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:35.959522 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.014 seconds
[0m23:24:35.961216 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.961415 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m23:24:35.961644 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:24:35.963482 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.963707 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.963943 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:35.964262 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.964506 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response__dbt_tmp232435937460'
        
      order by ordinal_position

  
[0m23:24:35.965052 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:24:35.965485 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:35.965703 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m23:24:35.965993 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:24:35.968102 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.968619 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:35.968867 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.972407 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:35.972729 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.008 seconds
[0m23:24:35.973034 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams" rename to "unnested_careteams__dbt_backup"
[0m23:24:35.974790 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.975094 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:24:35.975337 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.976476 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.976771 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:35.978422 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:35.978732 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.002 seconds
[0m23:24:35.978991 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m23:24:35.981387 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.981689 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:35.981908 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.982125 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner_roles__dbt_tmp232435924844" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" ("id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at"
        from "stg_practitioner_roles__dbt_tmp232435924844"
    )
  
[0m23:24:35.982372 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:35.984109 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m23:24:35.984501 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:35.984780 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:24:35.984995 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m23:24:35.985187 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.003 seconds
[0m23:24:35.986012 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m23:24:35.987195 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.987452 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:35.987678 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:24:35.991116 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m23:24:35.991394 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m23:24:35.994074 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:24:35.994400 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m23:24:35.994695 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.994920 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_questionnaire_response__dbt_tmp232435937460" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" ("id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at")
    (
        select "id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at"
        from "stg_questionnaire_response__dbt_tmp232435937460"
    )
  
[0m23:24:35.995222 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:35.995616 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m23:24:35.995953 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c51f0>]}
[0m23:24:35.996205 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:35.996480 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:35.996771 [info ] [Thread-2 (]: 9 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mINSERT 0 0[0m in 0.08s]
[0m23:24:35.997547 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: Close
[0m23:24:35.998201 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m23:24:35.998521 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m23:24:35.998834 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:24:35.999122 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a1dc0>]}
[0m23:24:35.999360 [debug] [Thread-2 (]: Began running node model.engage_analytics.encounters
[0m23:24:35.999607 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m23:24:35.999993 [info ] [Thread-2 (]: 13 of 84 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m23:24:36.000279 [info ] [Thread-3 (]: 12 of 84 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.06s]
[0m23:24:36.000675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.encounters)
[0m23:24:36.000997 [debug] [Thread-3 (]: Finished running node model.engage_analytics.unnested_careteams
[0m23:24:36.001208 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:36.001397 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.encounters
[0m23:24:36.001605 [debug] [Thread-3 (]: Began running node model.engage_analytics.organizations
[0m23:24:36.002012 [debug] [Thread-4 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m23:24:36.008556 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.062 seconds
[0m23:24:36.012242 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.012586 [info ] [Thread-3 (]: 14 of 84 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m23:24:36.014407 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:24:36.014779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089206e0>]}
[0m23:24:36.015013 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m23:24:36.015238 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.organizations)
[0m23:24:36.015415 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: BEGIN
[0m23:24:36.015643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:36.015908 [info ] [Thread-4 (]: 10 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mINSERT 0 0[0m in 0.09s]
[0m23:24:36.016134 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.organizations
[0m23:24:36.016497 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m23:24:36.018541 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:24:36.018811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:36.019065 [debug] [Thread-4 (]: Began running node model.engage_analytics.organization_affiliations
[0m23:24:36.019308 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m23:24:36.019551 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:24:36.019833 [info ] [Thread-4 (]: 15 of 84 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m23:24:36.020094 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:36.020316 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_task__dbt_tmp232435944137'
        
      order by ordinal_position

  
[0m23:24:36.020552 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.organization_affiliations)
[0m23:24:36.020849 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m23:24:36.023020 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m23:24:36.023541 [debug] [Thread-4 (]: Began executing node model.engage_analytics.organization_affiliations
[0m23:24:36.025912 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:24:36.026143 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

    
  
    

  create temporary table "organization_affiliations__dbt_tmp232436024869"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

where s._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
)

  );
  
  
[0m23:24:36.026361 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.011 seconds
[0m23:24:36.026560 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:36.026759 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.006 seconds
[0m23:24:36.027676 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.027950 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:24:36.029858 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:24:36.030114 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m23:24:36.031970 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m23:24:36.032191 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:36.032666 [debug] [Thread-3 (]: Began executing node model.engage_analytics.organizations
[0m23:24:36.034835 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:24:36.035063 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    
  
    

  create temporary table "organizations__dbt_tmp232436033937"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

where o._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
)

  );
  
  
[0m23:24:36.035330 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.003 seconds
[0m23:24:36.035569 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m23:24:36.037393 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:24:36.037669 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:24:36.038619 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.038821 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.012 seconds
[0m23:24:36.039041 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:24:36.040508 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:24:36.040714 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m23:24:36.042040 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:24:36.042256 [debug] [Thread-3 (]: On model.engage_analytics.organizations: BEGIN
[0m23:24:36.042497 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m23:24:36.043107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:36.043364 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:36.043598 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:24:36.043813 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:24:36.044167 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations__dbt_tmp232436024869'
        
      order by ordinal_position

  
[0m23:24:36.044499 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organizations__dbt_tmp232436033937'
        
      order by ordinal_position

  
[0m23:24:36.044682 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.002 seconds
[0m23:24:36.044825 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:24:36.046026 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m23:24:36.046711 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.047043 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m23:24:36.047486 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:24:36.047722 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_task__dbt_tmp232435944137" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" ("id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at")
    (
        select "id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at"
        from "stg_task__dbt_tmp232435944137"
    )
  
[0m23:24:36.048659 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:36.048884 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.004 seconds
[0m23:24:36.049765 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: COMMIT
[0m23:24:36.050018 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:24:36.051699 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:24:36.051923 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:24:36.052185 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:24:36.067058 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: COMMIT
[0m23:24:36.053743 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:24:36.068043 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m23:24:36.053968 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.071882 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.074564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:24:36.076508 [debug] [Thread-2 (]: Began executing node model.engage_analytics.encounters
[0m23:24:36.086800 [debug] [Thread-1 (]: On model.engage_analytics.stg_task: Close
[0m23:24:36.090785 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.091026 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.014 seconds
[0m23:24:36.091284 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.014 seconds
[0m23:24:36.091749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a64da0>]}
[0m23:24:36.092082 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    
  
    

  create temporary table "encounters__dbt_tmp232436089731"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."encounters")

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

where e._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
)

  );
  
  
[0m23:24:36.099218 [info ] [Thread-1 (]: 11 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mINSERT 0 0[0m in 0.16s]
[0m23:24:36.099640 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_task
[0m23:24:36.099844 [debug] [Thread-1 (]: Began running node model.engage_analytics.patient
[0m23:24:36.100054 [info ] [Thread-1 (]: 16 of 84 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m23:24:36.100275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.patient)
[0m23:24:36.100438 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.patient
[0m23:24:36.095220 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:24:36.103602 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m23:24:36.098731 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:24:36.103968 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.104307 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.104750 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.005 seconds
[0m23:24:36.104982 [debug] [Thread-1 (]: Began executing node model.engage_analytics.patient
[0m23:24:36.106516 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.106736 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:24:36.106910 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:24:36.109098 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:24:36.109336 [debug] [Thread-2 (]: On model.engage_analytics.encounters: BEGIN
[0m23:24:36.110231 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m23:24:36.111078 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m23:24:36.111375 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp232436108090"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m23:24:36.111875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:36.112233 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:36.112493 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.112707 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'encounters__dbt_tmp232436089731'
        
      order by ordinal_position

  
[0m23:24:36.112930 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:24:36.113200 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:24:36.113382 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organizations__dbt_tmp232436033937" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organizations" ("id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at")
    (
        select "id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at"
        from "organizations__dbt_tmp232436033937"
    )
  
[0m23:24:36.113635 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organization_affiliations__dbt_tmp232436024869" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" ("id", "organization_id", "location_id", "_airbyte_emitted_at")
    (
        select "id", "organization_id", "location_id", "_airbyte_emitted_at"
        from "organization_affiliations__dbt_tmp232436024869"
    )
  
[0m23:24:36.114489 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:36.115334 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m23:24:36.115532 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:24:36.115720 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:24:36.116333 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m23:24:36.116515 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m23:24:36.116683 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:24:36.116894 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.004 seconds
[0m23:24:36.117145 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m23:24:36.119036 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.119273 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:36.119562 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.120032 [debug] [Thread-3 (]: On model.engage_analytics.organizations: Close
[0m23:24:36.120271 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:36.120699 [debug] [Thread-4 (]: On model.engage_analytics.organization_affiliations: Close
[0m23:24:36.121004 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a79ca0>]}
[0m23:24:36.121341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab36e0>]}
[0m23:24:36.122309 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m23:24:36.121760 [info ] [Thread-3 (]: 14 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mINSERT 0 0[0m in 0.11s]
[0m23:24:36.122616 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.002 seconds
[0m23:24:36.124089 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:24:36.124445 [debug] [Thread-3 (]: Finished running node model.engage_analytics.organizations
[0m23:24:36.122111 [info ] [Thread-4 (]: 15 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mINSERT 0 0[0m in 0.10s]
[0m23:24:36.126387 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.126633 [debug] [Thread-1 (]: On model.engage_analytics.patient: BEGIN
[0m23:24:36.126878 [debug] [Thread-3 (]: Began running node model.engage_analytics.practitioner_role
[0m23:24:36.127188 [debug] [Thread-4 (]: Finished running node model.engage_analytics.organization_affiliations
[0m23:24:36.127397 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.127679 [info ] [Thread-3 (]: 17 of 84 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m23:24:36.127956 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m23:24:36.128189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:36.128467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.practitioner_role)
[0m23:24:36.128714 [info ] [Thread-4 (]: 18 of 84 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m23:24:36.128915 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:24:36.129082 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.practitioner_role
[0m23:24:36.129281 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.int_qr_answers_long)
[0m23:24:36.129458 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp232436108090'
        
      order by ordinal_position

  
[0m23:24:36.131660 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m23:24:36.131879 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.004 seconds
[0m23:24:36.132059 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m23:24:36.133342 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m23:24:36.135988 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m23:24:36.136354 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.004 seconds
[0m23:24:36.138191 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:24:36.138506 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.138763 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.139036 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m23:24:36.139259 [debug] [Thread-3 (]: Began executing node model.engage_analytics.practitioner_role
[0m23:24:36.139467 [debug] [Thread-2 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."encounters" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "encounters__dbt_tmp232436089731" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."encounters" ("id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at")
    (
        select "id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at"
        from "encounters__dbt_tmp232436089731"
    )
  
[0m23:24:36.141033 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m23:24:36.141243 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.002 seconds
[0m23:24:36.143340 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:24:36.145075 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:24:36.145314 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:24:36.145567 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

    
  
    

  create temporary table "practitioner_role__dbt_tmp232436142388"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

where spr._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01')
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
)

  );
  
  
[0m23:24:36.145834 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.146652 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m23:24:36.146891 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:24:36.147068 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:36.147287 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:24:36.147462 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m23:24:36.147703 [debug] [Thread-2 (]: On model.engage_analytics.encounters: COMMIT
[0m23:24:36.147873 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:36.148751 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:36.149136 [debug] [Thread-2 (]: On model.engage_analytics.encounters: Close
[0m23:24:36.149339 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.002 seconds
[0m23:24:36.149653 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089408c0>]}
[0m23:24:36.150810 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m23:24:36.151336 [info ] [Thread-2 (]: 13 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mINSERT 0 0[0m in 0.15s]
[0m23:24:36.151848 [debug] [Thread-2 (]: Finished running node model.engage_analytics.encounters
[0m23:24:36.152119 [debug] [Thread-2 (]: Began running node model.engage_analytics.int_qr_header
[0m23:24:36.152606 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:24:36.152379 [info ] [Thread-2 (]: 19 of 84 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m23:24:36.152912 [debug] [Thread-1 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp232436108090" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp232436108090"
    )
  
[0m23:24:36.153147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.int_qr_header)
[0m23:24:36.153371 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.int_qr_header
[0m23:24:36.154927 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m23:24:36.155142 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:24:36.155890 [debug] [Thread-1 (]: On model.engage_analytics.patient: COMMIT
[0m23:24:36.156075 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:24:36.156230 [debug] [Thread-1 (]: On model.engage_analytics.patient: COMMIT
[0m23:24:36.156516 [debug] [Thread-2 (]: Began executing node model.engage_analytics.int_qr_header
[0m23:24:36.158296 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m23:24:36.158597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:36.159143 [debug] [Thread-1 (]: On model.engage_analytics.patient: Close
[0m23:24:36.159421 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:24:36.159724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aca660>]}
[0m23:24:36.159944 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:24:36.160203 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:24:36.160838 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m23:24:36.161100 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.014 seconds
[0m23:24:36.160568 [info ] [Thread-1 (]: 16 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.06s]
[0m23:24:36.161332 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m23:24:36.162891 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:24:36.163190 [debug] [Thread-1 (]: Finished running node model.engage_analytics.patient
[0m23:24:36.163419 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:36.163629 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:36.163845 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m23:24:36.164098 [debug] [Thread-1 (]: Began running node model.engage_analytics.int_qr_tags
[0m23:24:36.165905 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:24:36.166222 [info ] [Thread-1 (]: 20 of 84 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m23:24:36.166465 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:36.166697 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" rename to "int_qr_answers_long__dbt_backup"
[0m23:24:36.166929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.int_qr_tags)
[0m23:24:36.167106 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:24:36.167288 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m23:24:36.167466 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role__dbt_tmp232436142388'
        
      order by ordinal_position

  
[0m23:24:36.170196 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m23:24:36.170520 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:24:36.172122 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:24:36.172314 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m23:24:36.172507 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:24:36.172755 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:24:36.172939 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m23:24:36.173142 [debug] [Thread-1 (]: Began executing node model.engage_analytics.int_qr_tags
[0m23:24:36.173351 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:36.175164 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:24:36.175475 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:36.175688 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.005 seconds
[0m23:24:36.176436 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m23:24:36.176739 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

    
  
    

  create temporary table "int_qr_tags__dbt_tmp232436174560"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags")

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m23:24:36.178463 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:24:36.179926 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:24:36.180163 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:24:36.180380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:36.180574 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" rename to "int_qr_header__dbt_backup"
[0m23:24:36.180764 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.180940 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m23:24:36.181993 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:36.183551 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:24:36.183818 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.002 seconds
[0m23:24:36.184058 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:36.184302 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m23:24:36.185874 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:24:36.187364 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m23:24:36.187670 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:36.188023 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:24:36.188262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:36.188514 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m23:24:36.189170 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m23:24:36.189447 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:24:36.189629 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m23:24:36.190039 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.002 seconds
[0m23:24:36.191074 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m23:24:36.191275 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m23:24:36.191472 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:36.192968 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:24:36.194836 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m23:24:36.231133 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.042 seconds
[0m23:24:36.195023 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m23:24:36.231676 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:24:36.232012 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:24:36.232777 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m23:24:36.233022 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioner_role__dbt_tmp232436142388" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" ("id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at")
    (
        select "id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at"
        from "practitioner_role__dbt_tmp232436142388"
    )
  
[0m23:24:36.233271 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m23:24:36.233579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:36.233949 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b99e50>]}
[0m23:24:36.234172 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:24:36.234579 [info ] [Thread-4 (]: 18 of 84 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.10s]
[0m23:24:36.234852 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:36.235051 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags__dbt_tmp232436174560'
        
      order by ordinal_position

  
[0m23:24:36.235256 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:36.235505 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m23:24:36.236165 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m23:24:36.236815 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_header: Close
[0m23:24:36.237107 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:24:36.237437 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_104394
[0m23:24:36.237698 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b1b500>]}
[0m23:24:36.237873 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m23:24:36.238112 [info ] [Thread-4 (]: 21 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104394  [RUN]
[0m23:24:36.238475 [info ] [Thread-2 (]: 19 of 84 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.08s]
[0m23:24:36.238815 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.qr_ipc_104394)
[0m23:24:36.239093 [debug] [Thread-2 (]: Finished running node model.engage_analytics.int_qr_header
[0m23:24:36.239333 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:36.239540 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_104394
[0m23:24:36.239767 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_104453
[0m23:24:36.240203 [debug] [Thread-3 (]: On model.engage_analytics.practitioner_role: Close
[0m23:24:36.240383 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m23:24:36.245675 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.245969 [info ] [Thread-2 (]: 22 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104453  [RUN]
[0m23:24:36.247648 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:24:36.247935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8c920>]}
[0m23:24:36.248121 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:36.248331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.qr_ipc_104453)
[0m23:24:36.248519 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m23:24:36.248975 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:36.248834 [info ] [Thread-3 (]: 17 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mINSERT 0 0[0m in 0.12s]
[0m23:24:36.249180 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_104453
[0m23:24:36.249508 [debug] [Thread-3 (]: Finished running node model.engage_analytics.practitioner_role
[0m23:24:36.251676 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.251970 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_104454
[0m23:24:36.252209 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m23:24:36.252532 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:36.252799 [info ] [Thread-3 (]: 23 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104454  [RUN]
[0m23:24:36.254457 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:24:36.254655 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:36.255248 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.qr_ipc_104454)
[0m23:24:36.255590 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m23:24:36.255901 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_104454
[0m23:24:36.258251 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.258581 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m23:24:36.258863 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:36.260724 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m23:24:36.261017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:36.261637 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:24:36.261857 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" as DBT_INTERNAL_DEST
        where (resource_id) in (
            select distinct resource_id
            from "int_qr_tags__dbt_tmp232436174560" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" ("resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version")
    (
        select "resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version"
        from "int_qr_tags__dbt_tmp232436174560"
    )
  
[0m23:24:36.263336 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:36.264139 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m23:24:36.264336 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:24:36.264492 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m23:24:36.265507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:36.266001 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_tags: Close
[0m23:24:36.266316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a17860>]}
[0m23:24:36.266648 [info ] [Thread-1 (]: 20 of 84 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mINSERT 0 0[0m in 0.10s]
[0m23:24:36.266915 [debug] [Thread-1 (]: Finished running node model.engage_analytics.int_qr_tags
[0m23:24:36.267137 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_104455
[0m23:24:36.267412 [info ] [Thread-1 (]: 24 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104455  [RUN]
[0m23:24:36.268318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.qr_ipc_104455)
[0m23:24:36.268869 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_104455
[0m23:24:36.271126 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.271355 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:36.271613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:36.814270 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.559 seconds
[0m23:24:36.816676 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.817051 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.568 seconds
[0m23:24:36.818034 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.818371 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.557 seconds
[0m23:24:36.819008 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.819436 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_104453
[0m23:24:36.821604 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.821891 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_104454
[0m23:24:36.824994 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.825568 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_104394
[0m23:24:36.827618 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.828271 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.828490 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: BEGIN
[0m23:24:36.828732 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.828969 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.829171 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: BEGIN
[0m23:24:36.829430 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:36.829598 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: BEGIN
[0m23:24:36.829803 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.830057 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_tmp"
    
    
  as (
    
-- SPI Subform 2 (id: ipc-104453, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:36.830291 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:36.830456 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:36.830617 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.830839 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.831106 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_tmp"
    
    
  as (
    
-- SPI Subform 4 (id: ipc-104394, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:36.831317 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:36.831516 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_tmp"
    
    
  as (
    
-- SPI Subform 3 (id: ipc-104454, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:36.833275 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.833500 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.562 seconds
[0m23:24:36.833688 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:36.833863 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453" rename to "qr_ipc_104453__dbt_backup"
[0m23:24:36.834505 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.836020 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.836206 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:36.836474 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394" rename to "qr_ipc_104394__dbt_backup"
[0m23:24:36.838210 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.838499 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:36.838718 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454" rename to "qr_ipc_104454__dbt_backup"
[0m23:24:36.840242 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.840424 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:36.840682 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_104455
[0m23:24:36.840914 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_tmp" rename to "qr_ipc_104453"
[0m23:24:36.842410 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.842620 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:36.844343 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.844621 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_tmp" rename to "qr_ipc_104394"
[0m23:24:36.846161 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.846364 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:36.846621 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_tmp" rename to "qr_ipc_104454"
[0m23:24:36.847315 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: COMMIT
[0m23:24:36.847675 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:36.847905 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.848106 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.848764 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: COMMIT
[0m23:24:36.848935 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:36.849117 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: COMMIT
[0m23:24:36.849299 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: BEGIN
[0m23:24:36.849464 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.850059 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: COMMIT
[0m23:24:36.850283 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: COMMIT
[0m23:24:36.850520 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.850796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:36.851050 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: COMMIT
[0m23:24:36.851275 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.851518 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_tmp"
    
    
  as (
    
-- SPI Subform 1 (id: ipc-104455, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:36.852831 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:36.855099 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_backup"
[0m23:24:36.855354 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m23:24:36.855566 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:36.855903 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:24:36.856096 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m23:24:36.857389 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_backup"
[0m23:24:36.859022 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.859227 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_backup" cascade
[0m23:24:36.860550 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_backup"
[0m23:24:36.861015 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:24:36.861262 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455" rename to "qr_ipc_104455__dbt_backup"
[0m23:24:36.861729 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:24:36.861949 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_backup" cascade
[0m23:24:36.862209 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_backup" cascade
[0m23:24:36.862730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:36.864378 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.864585 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:36.864764 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:24:36.864919 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:36.865144 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_tmp" rename to "qr_ipc_104455"
[0m23:24:36.865834 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104454: Close
[0m23:24:36.866543 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104453: Close
[0m23:24:36.867138 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104394: Close
[0m23:24:36.867508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898e810>]}
[0m23:24:36.867776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885faa0>]}
[0m23:24:36.868007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:36.868487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a893d0>]}
[0m23:24:36.868902 [info ] [Thread-3 (]: 23 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104454  [[32mCREATE VIEW[0m in 0.61s]
[0m23:24:36.869342 [info ] [Thread-2 (]: 22 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104453  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:36.870069 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: COMMIT
[0m23:24:36.870719 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_104454
[0m23:24:36.870961 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_104453
[0m23:24:36.871163 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.871523 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_202
[0m23:24:36.871835 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_203
[0m23:24:36.872071 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: COMMIT
[0m23:24:36.872725 [info ] [Thread-3 (]: 25 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_202  [RUN]
[0m23:24:36.873073 [info ] [Thread-2 (]: 26 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_203  [RUN]
[0m23:24:36.873381 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104454, now model.engage_analytics.qr_ipc_202)
[0m23:24:36.873713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104453, now model.engage_analytics.qr_ipc_203)
[0m23:24:36.873908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:36.874077 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_202
[0m23:24:36.874638 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_203
[0m23:24:36.876032 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_backup"
[0m23:24:36.878257 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:24:36.880098 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:24:36.880392 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:24:36.880608 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:36.880824 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:36.881011 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_backup" cascade
[0m23:24:36.881181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:36.881332 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:36.882935 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:36.883693 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104455: Close
[0m23:24:36.884070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894f290>]}
[0m23:24:36.946932 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m23:24:36.947345 [info ] [Thread-1 (]: 24 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104455  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:36.947843 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_104455
[0m23:24:36.948061 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_204
[0m23:24:36.948289 [info ] [Thread-1 (]: 27 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_204  [RUN]
[0m23:24:36.948565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104455, now model.engage_analytics.qr_ipc_204)
[0m23:24:36.948766 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_204
[0m23:24:36.951109 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:24:36.951369 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:36.951539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:36.951912 [info ] [Thread-4 (]: 21 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104394  [[32mCREATE VIEW[0m in 0.63s]
[0m23:24:36.952229 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_104394
[0m23:24:36.952430 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_205
[0m23:24:36.952657 [info ] [Thread-4 (]: 28 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_205  [RUN]
[0m23:24:36.952981 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104394, now model.engage_analytics.qr_ipc_205)
[0m23:24:36.953279 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_205
[0m23:24:36.956610 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:24:36.956862 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:36.957025 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:37.429859 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.549 seconds
[0m23:24:37.430803 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_202"
[0m23:24:37.431295 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_202
[0m23:24:37.433147 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_202"
[0m23:24:37.433449 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.552 seconds
[0m23:24:37.434231 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_203"
[0m23:24:37.434839 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:24:37.435204 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: BEGIN
[0m23:24:37.435501 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_203
[0m23:24:37.437352 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_203"
[0m23:24:37.437567 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:37.437804 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:24:37.438035 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 1) (id: ipc-202, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:37.438293 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:24:37.438467 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: BEGIN
[0m23:24:37.439095 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:37.439356 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:37.439563 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:24:37.441218 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:24:37.441521 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 1) (id: ipc-203, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:37.441805 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202" rename to "qr_ipc_202__dbt_backup"
[0m23:24:37.442631 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:37.444120 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:24:37.444325 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_tmp" rename to "qr_ipc_202"
[0m23:24:37.444529 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:37.446327 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:24:37.446572 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:37.446803 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203" rename to "qr_ipc_203__dbt_backup"
[0m23:24:37.447515 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: COMMIT
[0m23:24:37.447846 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:24:37.448051 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: COMMIT
[0m23:24:37.448344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:37.449997 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:24:37.450201 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:37.450384 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_tmp" rename to "qr_ipc_203"
[0m23:24:37.451650 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_backup"
[0m23:24:37.452099 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:24:37.452292 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_backup" cascade
[0m23:24:37.452469 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:37.453135 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: COMMIT
[0m23:24:37.453317 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:24:37.453529 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:37.453703 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: COMMIT
[0m23:24:37.454319 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_202: Close
[0m23:24:37.454632 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8d610>]}
[0m23:24:37.455131 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:37.454969 [info ] [Thread-3 (]: 25 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_202  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:37.456394 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_backup"
[0m23:24:37.456665 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_202
[0m23:24:37.457031 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:24:37.457293 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_206
[0m23:24:37.457542 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_backup" cascade
[0m23:24:37.457818 [info ] [Thread-3 (]: 29 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_206  [RUN]
[0m23:24:37.458189 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_202, now model.engage_analytics.qr_ipc_206)
[0m23:24:37.458401 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_206
[0m23:24:37.461728 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:24:37.462027 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:24:37.462242 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:37.462966 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: Close
[0m23:24:37.463179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:37.463533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108452570>]}
[0m23:24:37.463869 [info ] [Thread-2 (]: 26 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_203  [[32mCREATE VIEW[0m in 0.59s]
[0m23:24:37.464298 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_203
[0m23:24:37.464554 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_207
[0m23:24:37.464843 [info ] [Thread-2 (]: 30 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_207  [RUN]
[0m23:24:37.465065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_203, now model.engage_analytics.qr_ipc_207)
[0m23:24:37.465236 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_207
[0m23:24:37.467362 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:24:37.467609 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:37.467778 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:37.497362 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.546 seconds
[0m23:24:37.498216 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_204"
[0m23:24:37.498731 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_204
[0m23:24:37.500516 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_204"
[0m23:24:37.500745 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.544 seconds
[0m23:24:37.501701 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_205"
[0m23:24:37.502243 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_205
[0m23:24:37.502498 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:24:37.504199 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_205"
[0m23:24:37.504417 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: BEGIN
[0m23:24:37.504893 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:24:37.505120 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: BEGIN
[0m23:24:37.505326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:37.505559 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:24:37.505745 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 1) (id: ipc-204, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:37.505947 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:37.506163 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:24:37.506341 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 2) (id: ipc-205, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:37.507170 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:37.508826 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:24:37.509017 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204" rename to "qr_ipc_204__dbt_backup"
[0m23:24:37.509193 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:37.510849 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:24:37.511127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:37.511324 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205" rename to "qr_ipc_205__dbt_backup"
[0m23:24:37.512689 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:24:37.512912 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_tmp" rename to "qr_ipc_204"
[0m23:24:37.513616 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:37.513872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:37.515462 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:24:37.516124 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: COMMIT
[0m23:24:37.516317 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_tmp" rename to "qr_ipc_205"
[0m23:24:37.516501 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:24:37.516687 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: COMMIT
[0m23:24:37.517233 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:37.517812 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: COMMIT
[0m23:24:37.518011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:37.518246 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:24:37.519418 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_backup"
[0m23:24:37.519604 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: COMMIT
[0m23:24:37.519896 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:24:37.520086 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_backup" cascade
[0m23:24:37.520544 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m23:24:37.522552 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_backup"
[0m23:24:37.522760 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:24:37.523017 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:24:37.523657 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_204: Close
[0m23:24:37.523848 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_backup" cascade
[0m23:24:37.524144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a7b60>]}
[0m23:24:37.524453 [info ] [Thread-1 (]: 27 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_204  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:37.524733 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_204
[0m23:24:37.525016 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_208
[0m23:24:37.525231 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:37.525481 [info ] [Thread-1 (]: 31 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_208  [RUN]
[0m23:24:37.526425 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_205: Close
[0m23:24:37.526709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_204, now model.engage_analytics.qr_ipc_208)
[0m23:24:37.526934 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_208
[0m23:24:37.527181 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c4ec0>]}
[0m23:24:37.529323 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:24:37.529604 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:37.530068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:37.529857 [info ] [Thread-4 (]: 28 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_205  [[32mCREATE VIEW[0m in 0.57s]
[0m23:24:37.530581 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_205
[0m23:24:37.530800 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_209
[0m23:24:37.531477 [info ] [Thread-4 (]: 32 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_209  [RUN]
[0m23:24:37.531769 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_205, now model.engage_analytics.qr_ipc_209)
[0m23:24:37.531952 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_209
[0m23:24:37.534115 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:24:37.534346 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:37.534518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:38.045665 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.582 seconds
[0m23:24:38.046544 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_206"
[0m23:24:38.046838 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.579 seconds
[0m23:24:38.047382 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_207"
[0m23:24:38.047950 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_206
[0m23:24:38.050087 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_206"
[0m23:24:38.050354 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_207
[0m23:24:38.052094 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_207"
[0m23:24:38.052609 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:24:38.052857 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: BEGIN
[0m23:24:38.053106 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:24:38.053327 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: BEGIN
[0m23:24:38.054070 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:38.054278 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:24:38.054870 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 2) (id: ipc-206, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:38.055461 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:38.055809 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:24:38.056096 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 3) (id: ipc-207, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:38.057137 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:38.057406 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:38.059144 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:24:38.060950 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:24:38.061161 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206" rename to "qr_ipc_206__dbt_backup"
[0m23:24:38.061347 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207" rename to "qr_ipc_207__dbt_backup"
[0m23:24:38.062248 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.062499 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.063903 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:24:38.065259 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:24:38.065453 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_tmp" rename to "qr_ipc_207"
[0m23:24:38.065635 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_tmp" rename to "qr_ipc_206"
[0m23:24:38.066447 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.066674 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.067404 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: COMMIT
[0m23:24:38.068194 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: COMMIT
[0m23:24:38.068441 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:24:38.068608 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:24:38.068760 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: COMMIT
[0m23:24:38.068997 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: COMMIT
[0m23:24:38.070406 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:38.070596 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:38.072736 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_backup"
[0m23:24:38.073880 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_backup"
[0m23:24:38.074162 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:24:38.074401 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:24:38.074589 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_backup" cascade
[0m23:24:38.074780 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_backup" cascade
[0m23:24:38.076020 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:38.076214 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:38.076870 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_206: Close
[0m23:24:38.077665 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_207: Close
[0m23:24:38.078009 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897ae70>]}
[0m23:24:38.078618 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750af00>]}
[0m23:24:38.078394 [info ] [Thread-3 (]: 29 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_206  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:38.079194 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_206
[0m23:24:38.078976 [info ] [Thread-2 (]: 30 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_207  [[32mCREATE VIEW[0m in 0.61s]
[0m23:24:38.079453 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_210
[0m23:24:38.079784 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_207
[0m23:24:38.080054 [info ] [Thread-3 (]: 33 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_210  [RUN]
[0m23:24:38.080532 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_211
[0m23:24:38.080855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_206, now model.engage_analytics.qr_ipc_210)
[0m23:24:38.081115 [info ] [Thread-2 (]: 34 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_211  [RUN]
[0m23:24:38.081318 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_210
[0m23:24:38.081498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_207, now model.engage_analytics.qr_ipc_211)
[0m23:24:38.083701 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:24:38.083977 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_211
[0m23:24:38.084227 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:38.086271 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:24:38.086517 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:38.086763 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:38.087047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:38.093246 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.563 seconds
[0m23:24:38.094080 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_208"
[0m23:24:38.094503 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_208
[0m23:24:38.096376 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_208"
[0m23:24:38.096968 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:24:38.097214 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: BEGIN
[0m23:24:38.097673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:38.097883 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:24:38.098099 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_tmp"
    
    
  as (
    
-- IPC Session 3 (id: ipc-208, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:38.099254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:38.101240 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:24:38.101502 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208" rename to "qr_ipc_208__dbt_backup"
[0m23:24:38.102167 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.568 seconds
[0m23:24:38.102425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.103148 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_209"
[0m23:24:38.104640 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:24:38.105027 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_tmp" rename to "qr_ipc_208"
[0m23:24:38.105395 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_209
[0m23:24:38.107202 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_209"
[0m23:24:38.107477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:38.108226 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: COMMIT
[0m23:24:38.108430 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:24:38.108622 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: COMMIT
[0m23:24:38.108858 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:24:38.109054 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: BEGIN
[0m23:24:38.109638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:38.109870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:38.110090 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:24:38.111315 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_backup"
[0m23:24:38.111532 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 4) (id: ipc-209, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:38.111881 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:24:38.112105 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_backup" cascade
[0m23:24:38.113013 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:38.115203 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:24:38.115391 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209" rename to "qr_ipc_209__dbt_backup"
[0m23:24:38.115560 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:24:38.116201 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_208: Close
[0m23:24:38.116372 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.117849 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:24:38.118133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c72f0>]}
[0m23:24:38.118310 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_tmp" rename to "qr_ipc_209"
[0m23:24:38.118634 [info ] [Thread-1 (]: 31 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_208  [[32mCREATE VIEW[0m in 0.59s]
[0m23:24:38.118937 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_208
[0m23:24:38.119124 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_212
[0m23:24:38.119492 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.119346 [info ] [Thread-1 (]: 35 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_212  [RUN]
[0m23:24:38.120310 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: COMMIT
[0m23:24:38.120539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_208, now model.engage_analytics.qr_ipc_212)
[0m23:24:38.120783 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:24:38.121015 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_212
[0m23:24:38.121220 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: COMMIT
[0m23:24:38.123410 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:24:38.123681 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:38.123912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:38.124383 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:38.125670 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_backup"
[0m23:24:38.126098 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:24:38.126365 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_backup" cascade
[0m23:24:38.127379 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:38.128097 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: Close
[0m23:24:38.128370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2c440>]}
[0m23:24:38.128742 [info ] [Thread-4 (]: 32 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_209  [[32mCREATE VIEW[0m in 0.60s]
[0m23:24:38.129002 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_209
[0m23:24:38.129185 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_221
[0m23:24:38.129525 [info ] [Thread-4 (]: 36 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_221  [RUN]
[0m23:24:38.129832 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_209, now model.engage_analytics.qr_ipc_221)
[0m23:24:38.130020 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_221
[0m23:24:38.132193 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:24:38.132504 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:38.132733 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:38.628197 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.542 seconds
[0m23:24:38.629061 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_210"
[0m23:24:38.629547 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.542 seconds
[0m23:24:38.630308 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_211"
[0m23:24:38.630606 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_210
[0m23:24:38.632461 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_210"
[0m23:24:38.632752 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_211
[0m23:24:38.634791 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_211"
[0m23:24:38.635236 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:24:38.635480 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: BEGIN
[0m23:24:38.635688 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:24:38.635915 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: BEGIN
[0m23:24:38.636476 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:38.636710 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:38.636900 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:24:38.637082 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:24:38.637270 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 4) (id: ipc-210, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:38.637475 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 4) (id: ipc-211, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:38.638669 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:38.638845 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:38.640564 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:24:38.642254 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:24:38.642518 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211" rename to "qr_ipc_211__dbt_backup"
[0m23:24:38.642779 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210" rename to "qr_ipc_210__dbt_backup"
[0m23:24:38.643524 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.643795 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.645920 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:24:38.647248 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:24:38.647436 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_tmp" rename to "qr_ipc_211"
[0m23:24:38.647620 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_tmp" rename to "qr_ipc_210"
[0m23:24:38.648311 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:24:38.648968 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: COMMIT
[0m23:24:38.649150 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:24:38.649300 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: COMMIT
[0m23:24:38.649479 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:38.650139 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: COMMIT
[0m23:24:38.650508 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:24:38.650731 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: COMMIT
[0m23:24:38.651880 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:38.652108 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:38.653378 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_backup"
[0m23:24:38.654496 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_backup"
[0m23:24:38.654794 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:24:38.655064 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:24:38.655241 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_backup" cascade
[0m23:24:38.655419 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_backup" cascade
[0m23:24:38.656624 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:38.657340 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_210: Close
[0m23:24:38.657538 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:38.657883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c62d0>]}
[0m23:24:38.658516 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_211: Close
[0m23:24:38.658950 [info ] [Thread-3 (]: 33 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_210  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:38.659344 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a317f0>]}
[0m23:24:38.659646 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_210
[0m23:24:38.660256 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_23451
[0m23:24:38.660020 [info ] [Thread-2 (]: 34 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_211  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:38.660613 [info ] [Thread-3 (]: 37 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_23451  [RUN]
[0m23:24:38.660875 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.537 seconds
[0m23:24:38.661141 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_211
[0m23:24:38.661366 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_210, now model.engage_analytics.qr_ipc_23451)
[0m23:24:38.662030 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_212"
[0m23:24:38.662251 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_54
[0m23:24:38.662447 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_23451
[0m23:24:38.662757 [info ] [Thread-2 (]: 38 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_54 . [RUN]
[0m23:24:38.665056 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:24:38.665298 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.533 seconds
[0m23:24:38.665510 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_211, now model.engage_analytics.qr_ipc_54)
[0m23:24:38.665689 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_212
[0m23:24:38.665852 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:38.666438 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_221"
[0m23:24:38.666604 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_54
[0m23:24:38.668279 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_212"
[0m23:24:38.668467 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:38.670614 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:24:38.671034 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_221
[0m23:24:38.671253 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:38.673068 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_221"
[0m23:24:38.673354 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:24:38.673584 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:38.673874 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: BEGIN
[0m23:24:38.674251 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:24:38.674433 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: BEGIN
[0m23:24:38.674616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:38.674794 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:24:38.674974 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_tmp"
    
    
  as (
    
-- SBIRT (id: ipc-212, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:38.675227 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:38.675483 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:24:38.675705 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_tmp"
    
    
  as (
    
-- Add Family Member Registration (id: ipc-221, url: n/a, version: 0.0.3)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:38.676119 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:38.677851 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:24:38.678039 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212" rename to "qr_ipc_212__dbt_backup"
[0m23:24:38.678216 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:38.680507 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:24:38.680719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:38.680877 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221" rename to "qr_ipc_221__dbt_backup"
[0m23:24:38.682479 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:24:38.682741 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_tmp" rename to "qr_ipc_212"
[0m23:24:38.683295 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.683524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.685031 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:24:38.685658 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: COMMIT
[0m23:24:38.685852 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_tmp" rename to "qr_ipc_221"
[0m23:24:38.686072 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:24:38.686309 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: COMMIT
[0m23:24:38.686808 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:38.687450 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: COMMIT
[0m23:24:38.687629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:38.687791 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:24:38.689297 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_backup"
[0m23:24:38.689573 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: COMMIT
[0m23:24:38.689915 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:24:38.690350 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_backup" cascade
[0m23:24:38.690801 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:38.691940 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_backup"
[0m23:24:38.692139 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:38.692426 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:24:38.693176 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_212: Close
[0m23:24:38.693370 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_backup" cascade
[0m23:24:38.693710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b84890>]}
[0m23:24:38.694160 [info ] [Thread-1 (]: 35 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_212  [[32mCREATE VIEW[0m in 0.57s]
[0m23:24:38.694474 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_212
[0m23:24:38.694714 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_55
[0m23:24:38.694905 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:38.695127 [info ] [Thread-1 (]: 39 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_55 . [RUN]
[0m23:24:38.695874 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: Close
[0m23:24:38.696082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_212, now model.engage_analytics.qr_ipc_55)
[0m23:24:38.696277 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_55
[0m23:24:38.696502 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c5250>]}
[0m23:24:38.698580 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:24:38.699094 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:38.698927 [info ] [Thread-4 (]: 36 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_221  [[32mCREATE VIEW[0m in 0.57s]
[0m23:24:38.699315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:38.699551 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_221
[0m23:24:38.699960 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_56
[0m23:24:38.700309 [info ] [Thread-4 (]: 40 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_56 . [RUN]
[0m23:24:38.700552 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_221, now model.engage_analytics.qr_ipc_56)
[0m23:24:38.700726 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_56
[0m23:24:38.702798 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:24:38.703329 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:38.703556 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:39.249288 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.576 seconds
[0m23:24:39.250143 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_54"
[0m23:24:39.250653 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_54
[0m23:24:39.252897 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_54"
[0m23:24:39.253155 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.585 seconds
[0m23:24:39.253844 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_23451"
[0m23:24:39.254288 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_23451
[0m23:24:39.256037 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_23451"
[0m23:24:39.256308 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:24:39.256532 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: BEGIN
[0m23:24:39.256817 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:24:39.256988 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: BEGIN
[0m23:24:39.257360 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:39.257636 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:24:39.257889 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 1) (id: ipc-54, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:39.258110 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:39.258318 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:24:39.258505 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_tmp"
    
    
  as (
    
-- Discuss Confidentiality (id: ipc-23451, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:39.259377 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:39.259604 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:39.262019 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:24:39.263444 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:24:39.263679 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54" rename to "qr_ipc_54__dbt_backup"
[0m23:24:39.263870 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451" rename to "qr_ipc_23451__dbt_backup"
[0m23:24:39.264559 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:24:39.264729 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.266094 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:24:39.267487 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:24:39.267696 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_tmp" rename to "qr_ipc_23451"
[0m23:24:39.267961 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_tmp" rename to "qr_ipc_54"
[0m23:24:39.268865 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.269065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.269753 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: COMMIT
[0m23:24:39.270502 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: COMMIT
[0m23:24:39.270718 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:24:39.270878 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:24:39.271053 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: COMMIT
[0m23:24:39.271198 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: COMMIT
[0m23:24:39.273041 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:39.274301 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_backup"
[0m23:24:39.274562 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:24:39.274731 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:39.274900 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_backup" cascade
[0m23:24:39.275158 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.572 seconds
[0m23:24:39.276436 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_backup"
[0m23:24:39.276697 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.577 seconds
[0m23:24:39.277472 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_56"
[0m23:24:39.277800 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:24:39.278014 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:39.278617 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_55"
[0m23:24:39.278869 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_backup" cascade
[0m23:24:39.279502 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_23451: Close
[0m23:24:39.279836 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_56
[0m23:24:39.281713 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_56"
[0m23:24:39.282051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c6930>]}
[0m23:24:39.282306 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_55
[0m23:24:39.282569 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:24:39.282895 [info ] [Thread-3 (]: 37 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_23451  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:39.284642 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_55"
[0m23:24:39.285310 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_54: Close
[0m23:24:39.285561 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_23451
[0m23:24:39.285798 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:24:39.286219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c01ee0>]}
[0m23:24:39.286444 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_57
[0m23:24:39.286720 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: BEGIN
[0m23:24:39.286993 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:24:39.287315 [info ] [Thread-2 (]: 38 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_54  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:39.287546 [info ] [Thread-3 (]: 41 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_57 . [RUN]
[0m23:24:39.288094 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: BEGIN
[0m23:24:39.288393 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_54
[0m23:24:39.288632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_23451, now model.engage_analytics.qr_ipc_57)
[0m23:24:39.288858 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:39.289197 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_58
[0m23:24:39.289409 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_57
[0m23:24:39.289629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:39.289830 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:24:39.290134 [info ] [Thread-2 (]: 42 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_58 . [RUN]
[0m23:24:39.292673 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:24:39.293007 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:24:39.293290 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_tmp"
    
    
  as (
    

-- Short-Form PCL-5-8 (IPC Session 2) (id: ipc-56, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:39.293563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_54, now model.engage_analytics.qr_ipc_58)
[0m23:24:39.293784 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:39.294048 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_tmp"
    
    
  as (
    
-- IPC Session 1 (id: ipc-55, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:39.294339 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_58
[0m23:24:39.294519 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:39.297506 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:24:39.297778 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:39.298030 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:39.298235 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:39.337191 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:24:39.338948 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:24:39.339195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:39.339374 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55" rename to "qr_ipc_55__dbt_backup"
[0m23:24:39.339552 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56" rename to "qr_ipc_56__dbt_backup"
[0m23:24:39.340570 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.340864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.342444 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:24:39.344292 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:24:39.344530 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_tmp" rename to "qr_ipc_56"
[0m23:24:39.345653 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_tmp" rename to "qr_ipc_55"
[0m23:24:39.346483 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.347200 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: COMMIT
[0m23:24:39.347468 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:24:39.347692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:39.347958 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: COMMIT
[0m23:24:39.348712 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: COMMIT
[0m23:24:39.348953 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:24:39.349126 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: COMMIT
[0m23:24:39.349690 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:39.350925 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_backup"
[0m23:24:39.351279 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:24:39.351448 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_backup" cascade
[0m23:24:39.351628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:39.352706 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_backup"
[0m23:24:39.352907 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:39.353181 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:24:39.353895 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_56: Close
[0m23:24:39.354078 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_backup" cascade
[0m23:24:39.354385 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c37560>]}
[0m23:24:39.354728 [info ] [Thread-4 (]: 40 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_56  [[32mCREATE VIEW[0m in 0.65s]
[0m23:24:39.355020 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_56
[0m23:24:39.355226 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_59
[0m23:24:39.355398 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:39.355629 [info ] [Thread-4 (]: 43 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_59 . [RUN]
[0m23:24:39.356380 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_55: Close
[0m23:24:39.356569 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_56, now model.engage_analytics.qr_ipc_59)
[0m23:24:39.356761 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_59
[0m23:24:39.356988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c95100>]}
[0m23:24:39.359168 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:24:39.359884 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:39.359666 [info ] [Thread-1 (]: 39 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_55  [[32mCREATE VIEW[0m in 0.66s]
[0m23:24:39.360184 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:39.360475 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_55
[0m23:24:39.360762 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_60
[0m23:24:39.361111 [info ] [Thread-1 (]: 44 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_60 . [RUN]
[0m23:24:39.361350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_55, now model.engage_analytics.qr_ipc_60)
[0m23:24:39.361527 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_60
[0m23:24:39.363589 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:24:39.363830 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:39.363999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:39.904851 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.610 seconds
[0m23:24:39.905724 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_57"
[0m23:24:39.909387 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_57
[0m23:24:39.912254 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_57"
[0m23:24:39.912729 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:24:39.912904 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: BEGIN
[0m23:24:39.913790 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:39.914038 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:24:39.914233 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 2) (id: ipc-57, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:39.915467 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:39.917292 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:24:39.917546 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.578 seconds
[0m23:24:39.917793 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57" rename to "qr_ipc_57__dbt_backup"
[0m23:24:39.918479 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_58"
[0m23:24:39.918930 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_58
[0m23:24:39.920724 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_58"
[0m23:24:39.920986 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:39.922681 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:24:39.922921 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_tmp" rename to "qr_ipc_57"
[0m23:24:39.923184 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:24:39.923369 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: BEGIN
[0m23:24:39.923869 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.924117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:39.924817 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: COMMIT
[0m23:24:39.925057 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:24:39.925283 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:24:39.925599 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_tmp"
    
    
  as (
    
-- IPC Session 2 (id: ipc-58, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:39.925795 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: COMMIT
[0m23:24:39.926732 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.563 seconds
[0m23:24:39.926997 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:39.927681 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_60"
[0m23:24:39.927899 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:39.928105 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.568 seconds
[0m23:24:39.929427 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_backup"
[0m23:24:39.931156 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:24:39.931905 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_59"
[0m23:24:39.932291 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:24:39.932569 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_60
[0m23:24:39.932809 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58" rename to "qr_ipc_58__dbt_backup"
[0m23:24:39.933088 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_backup" cascade
[0m23:24:39.934959 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_60"
[0m23:24:39.935260 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_59
[0m23:24:39.937348 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_59"
[0m23:24:39.937602 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:39.937879 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:39.939429 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:24:39.940124 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_57: Close
[0m23:24:39.940396 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_tmp" rename to "qr_ipc_58"
[0m23:24:39.940644 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:24:39.941013 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa2000>]}
[0m23:24:39.941247 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:24:39.941480 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: BEGIN
[0m23:24:39.942082 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: BEGIN
[0m23:24:39.942291 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.941873 [info ] [Thread-3 (]: 41 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_57  [[32mCREATE VIEW[0m in 0.65s]
[0m23:24:39.943194 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: COMMIT
[0m23:24:39.943422 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:39.943828 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_57
[0m23:24:39.943997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:39.944184 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:24:39.944372 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:24:39.944590 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_61
[0m23:24:39.944785 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:24:39.944951 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: COMMIT
[0m23:24:39.945138 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 3) (id: ipc-59, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:39.945402 [info ] [Thread-3 (]: 45 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_61 . [RUN]
[0m23:24:39.945620 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 3) (id: ipc-60, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:39.945994 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_57, now model.engage_analytics.qr_ipc_61)
[0m23:24:39.946253 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_61
[0m23:24:39.946442 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:39.949595 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:24:39.949861 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:39.950078 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:39.951233 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_backup"
[0m23:24:39.951450 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:39.952987 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:24:39.954551 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:24:39.954879 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:24:39.955069 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:39.955259 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60" rename to "qr_ipc_60__dbt_backup"
[0m23:24:39.955446 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59" rename to "qr_ipc_59__dbt_backup"
[0m23:24:39.955625 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_backup" cascade
[0m23:24:39.956580 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.956903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.958794 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:24:39.959046 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:24:39.960569 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:24:39.960842 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_tmp" rename to "qr_ipc_59"
[0m23:24:39.961641 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_58: Close
[0m23:24:39.961881 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_tmp" rename to "qr_ipc_60"
[0m23:24:39.962368 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c22c00>]}
[0m23:24:39.962867 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.963320 [info ] [Thread-2 (]: 42 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_58  [[32mCREATE VIEW[0m in 0.67s]
[0m23:24:39.963551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:39.964279 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: COMMIT
[0m23:24:39.964797 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_58
[0m23:24:39.965591 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: COMMIT
[0m23:24:39.965844 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:24:39.966143 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_62
[0m23:24:39.966405 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:24:39.966753 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: COMMIT
[0m23:24:39.967292 [info ] [Thread-2 (]: 46 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_62 . [RUN]
[0m23:24:39.967668 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: COMMIT
[0m23:24:39.967983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_58, now model.engage_analytics.qr_ipc_62)
[0m23:24:39.968208 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_62
[0m23:24:39.970683 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:24:39.970930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:39.971162 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:39.971405 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:39.972774 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_backup"
[0m23:24:39.973845 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_backup"
[0m23:24:39.974094 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:39.974458 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:24:39.974772 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:24:39.975031 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_backup" cascade
[0m23:24:39.975214 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_backup" cascade
[0m23:24:39.976596 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:39.977346 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_60: Close
[0m23:24:39.977544 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:39.978258 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: Close
[0m23:24:39.978547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f5940>]}
[0m23:24:39.978930 [info ] [Thread-1 (]: 44 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_60  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:39.979239 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac8260>]}
[0m23:24:39.979585 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_60
[0m23:24:39.979922 [info ] [Thread-4 (]: 43 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_59  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:39.980177 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_63
[0m23:24:39.980443 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_59
[0m23:24:39.980678 [info ] [Thread-1 (]: 47 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_63 . [RUN]
[0m23:24:39.980906 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_69
[0m23:24:39.981110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_60, now model.engage_analytics.qr_ipc_63)
[0m23:24:39.981389 [info ] [Thread-4 (]: 48 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_69 . [RUN]
[0m23:24:39.981599 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_63
[0m23:24:39.981887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_59, now model.engage_analytics.qr_ipc_69)
[0m23:24:39.984070 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:39.984391 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_69
[0m23:24:39.984646 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:39.987887 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:39.988133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:39.988322 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:39.988563 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:40.541323 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.586 seconds
[0m23:24:40.542265 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_61"
[0m23:24:40.543697 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_61
[0m23:24:40.545524 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_61"
[0m23:24:40.545933 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:24:40.546104 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: BEGIN
[0m23:24:40.546361 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.572 seconds
[0m23:24:40.547151 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_62"
[0m23:24:40.547420 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:40.547606 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:24:40.547797 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 3) (id: ipc-61, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:40.548107 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_62
[0m23:24:40.549932 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_62"
[0m23:24:40.550180 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:40.551742 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:24:40.551944 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61" rename to "qr_ipc_61__dbt_backup"
[0m23:24:40.552246 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:24:40.552454 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: BEGIN
[0m23:24:40.552713 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:40.552986 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:40.554405 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:24:40.554613 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:24:40.554799 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_tmp" rename to "qr_ipc_61"
[0m23:24:40.555053 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 4) (id: ipc-62, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:40.555931 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:40.556656 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: COMMIT
[0m23:24:40.556856 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:40.557045 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:24:40.558666 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:24:40.558864 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: COMMIT
[0m23:24:40.559047 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62" rename to "qr_ipc_62__dbt_backup"
[0m23:24:40.559759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:24:40.561158 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:24:40.561325 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_tmp" rename to "qr_ipc_62"
[0m23:24:40.561493 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.573 seconds
[0m23:24:40.561643 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:40.562234 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_69"
[0m23:24:40.563448 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_backup"
[0m23:24:40.563639 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:40.563801 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.576 seconds
[0m23:24:40.564223 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:24:40.564868 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: COMMIT
[0m23:24:40.565432 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_63"
[0m23:24:40.565616 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_backup" cascade
[0m23:24:40.565816 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:24:40.566138 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: COMMIT
[0m23:24:40.566387 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_69
[0m23:24:40.568199 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_69"
[0m23:24:40.568444 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:40.569072 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_61: Close
[0m23:24:40.569349 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899eae0>]}
[0m23:24:40.569574 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:40.569957 [info ] [Thread-3 (]: 45 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_61  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:40.572369 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_backup"
[0m23:24:40.572620 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_63
[0m23:24:40.572918 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_61
[0m23:24:40.573151 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:40.573543 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:24:40.575296 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_63"
[0m23:24:40.575530 [debug] [Thread-3 (]: Began running node model.engage_analytics.current_practitioner_role
[0m23:24:40.575749 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: BEGIN
[0m23:24:40.575949 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_backup" cascade
[0m23:24:40.576222 [info ] [Thread-3 (]: 49 of 84 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m23:24:40.576552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_61, now model.engage_analytics.current_practitioner_role)
[0m23:24:40.576754 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m23:24:40.576929 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:40.578317 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m23:24:40.578553 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:40.578741 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:40.578900 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:40.579576 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_62: Close
[0m23:24:40.579756 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: BEGIN
[0m23:24:40.579969 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_tmp"
    
    
  as (
    
-- eCBIS Remove Family Form (id: ipc-69, url: n/a, version: 0.0.2)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:40.580188 [debug] [Thread-3 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m23:24:40.580456 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a53a10>]}
[0m23:24:40.580723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:40.582538 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m23:24:40.582749 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:40.583186 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:40.583038 [info ] [Thread-2 (]: 46 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_62  [[32mCREATE VIEW[0m in 0.61s]
[0m23:24:40.584920 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:40.585164 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_tmp"
    
    
  as (
    
-- IPC Session 4 (id: ipc-63, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:24:40.585453 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_62
[0m23:24:40.585673 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69" rename to "qr_ipc_69__dbt_backup"
[0m23:24:40.585955 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:40.586137 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_104394
[0m23:24:40.586351 [debug] [Thread-3 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m23:24:40.586790 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:40.587028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:40.586573 [info ] [Thread-2 (]: 50 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_104394 . [RUN]
[0m23:24:40.587232 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:24:40.588830 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:40.589075 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_62, now model.engage_analytics.qr_104394)
[0m23:24:40.590620 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:40.590831 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_tmp" rename to "qr_ipc_69"
[0m23:24:40.591016 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_104394
[0m23:24:40.591187 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63" rename to "qr_ipc_63__dbt_backup"
[0m23:24:40.593557 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:24:40.593838 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:40.594117 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:40.594837 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: COMMIT
[0m23:24:40.595074 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:24:40.595253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:40.595420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:40.595616 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:40.595780 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:40.597224 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:40.597458 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: COMMIT
[0m23:24:40.597696 [debug] [Thread-3 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m23:24:40.597878 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_tmp" rename to "qr_ipc_63"
[0m23:24:40.598626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:40.598792 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:40.599404 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: COMMIT
[0m23:24:40.599578 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:40.601678 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_backup"
[0m23:24:40.601917 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:40.603589 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:40.603901 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:24:40.604089 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: COMMIT
[0m23:24:40.604378 [debug] [Thread-3 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" rename to "current_practitioner_role__dbt_backup"
[0m23:24:40.604576 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_backup" cascade
[0m23:24:40.605217 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:24:40.605399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:40.606885 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:40.607077 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:40.608192 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_backup"
[0m23:24:40.608389 [debug] [Thread-3 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m23:24:40.609041 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_69: Close
[0m23:24:40.609307 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:24:40.609547 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_backup" cascade
[0m23:24:40.609983 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dee70>]}
[0m23:24:40.610257 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:40.610654 [info ] [Thread-4 (]: 48 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_69  [[32mCREATE VIEW[0m in 0.63s]
[0m23:24:40.611494 [debug] [Thread-3 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m23:24:40.611794 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:40.612108 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_69
[0m23:24:40.612367 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:40.613075 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_63: Close
[0m23:24:40.613307 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_104453
[0m23:24:40.613516 [debug] [Thread-3 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m23:24:40.613794 [info ] [Thread-4 (]: 51 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_104453 . [RUN]
[0m23:24:40.614110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c7bf0>]}
[0m23:24:40.614340 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_69, now model.engage_analytics.qr_104453)
[0m23:24:40.614732 [info ] [Thread-1 (]: 47 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_63  [[32mCREATE VIEW[0m in 0.63s]
[0m23:24:40.614988 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_104453
[0m23:24:40.615219 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:40.615558 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_63
[0m23:24:40.617979 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:24:40.619238 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m23:24:40.619528 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_104454
[0m23:24:40.619781 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:40.620114 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:24:40.620509 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:40.620356 [info ] [Thread-1 (]: 52 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_104454 . [RUN]
[0m23:24:40.620729 [debug] [Thread-3 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m23:24:40.620991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_63, now model.engage_analytics.qr_104454)
[0m23:24:40.621178 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_104454
[0m23:24:40.623513 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:24:40.623770 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:24:40.623954 [debug] [Thread-1 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:40.624676 [debug] [Thread-3 (]: On model.engage_analytics.current_practitioner_role: Close
[0m23:24:40.624882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:40.625299 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108844b90>]}
[0m23:24:40.625723 [info ] [Thread-3 (]: 49 of 84 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.05s]
[0m23:24:40.626030 [debug] [Thread-3 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m23:24:40.626248 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_104455
[0m23:24:40.626691 [info ] [Thread-3 (]: 53 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_104455 . [RUN]
[0m23:24:40.627025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.qr_104455)
[0m23:24:40.627296 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_104455
[0m23:24:40.629631 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:24:40.629862 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:40.630029 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:41.152011 [debug] [Thread-2 (]: SQL status: SELECT 231 in 0.556 seconds
[0m23:24:41.162506 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.542 seconds
[0m23:24:41.162800 [debug] [Thread-3 (]: SQL status: SELECT 24 in 0.533 seconds
[0m23:24:41.163203 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_104394"
[0m23:24:41.163409 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.539 seconds
[0m23:24:41.164684 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_104453"
[0m23:24:41.166073 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_104455"
[0m23:24:41.166886 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_104454"
[0m23:24:41.167568 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_104454
[0m23:24:41.169523 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_104454"
[0m23:24:41.169898 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_104453
[0m23:24:41.171954 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_104453"
[0m23:24:41.172324 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_104455
[0m23:24:41.174093 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_104455"
[0m23:24:41.174434 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:24:41.174647 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_104394
[0m23:24:41.174834 [debug] [Thread-1 (]: On model.engage_analytics.qr_104454: BEGIN
[0m23:24:41.175109 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:24:41.176950 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_104394"
[0m23:24:41.177197 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:24:41.177395 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: BEGIN
[0m23:24:41.177664 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: BEGIN
[0m23:24:41.178063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:41.178520 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:24:41.178762 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:41.178969 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:41.179229 [debug] [Thread-1 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 3 (id: ipc-104454, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:41.179523 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:24:41.179739 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:24:41.180121 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 1 (id: ipc-104455, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda'
        then answer_value_text
      else null
      end
    )
    
      
            as "7fc39fba-84db-490d-af4e-8f772d91ffda"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423'
        then answer_value_text
      else null
      end
    )
    
      
            as "c7d21a57-0fc6-4e3a-b411-beceb1fb2423"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837'
        then answer_value_text
      else null
      end
    )
    
      
            as "644c00f2-8b07-4911-92d0-f05f5e5cc837"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03'
        then answer_value_text
      else null
      end
    )
    
      
            as "43898926-e9d5-400e-a095-62a8c7f8dd03"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6601f97-0a34-49d0-b181-611d6705ca42"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e9233a-9ab1-410a-b5e3-b30867355cea"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019'
        then answer_value_text
      else null
      end
    )
    
      
            as "ecabd308-c45a-41f7-8754-b1f63a101019"
      
    
    ,
  
    max(
      
      case
      when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "2897fef9-abcf-4bb3-b33f-2accae4c06c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f85f2ef-d781-4001-8df5-99a9ac5a656b"
      
    
    ,
  
    max(
      
      case
      when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511'
        then answer_value_text
      else null
      end
    )
    
      
            as "7cc2e8a9-197a-42ea-9431-ba01eefc6511"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2a74544-b333-4767-b3e3-7772413419ce"
      
    
    ,
  
    max(
      
      case
      when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb'
        then answer_value_text
      else null
      end
    )
    
      
            as "41aee132-ab8e-4d64-a322-eed88f900edb"
      
    
    ,
  
    max(
      
      case
      when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d'
        then answer_value_text
      else null
      end
    )
    
      
            as "06e33f1f-7202-4d5e-94d1-efbeabaa3e7d"
      
    
    ,
  
    max(
      
      case
      when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9'
        then answer_value_text
      else null
      end
    )
    
      
            as "71dbaac9-867f-4d7f-b6d7-e1f59402bbf9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '35062b98-748b-441c-ad74-185823e1bb52'
        then answer_value_text
      else null
      end
    )
    
      
            as "35062b98-748b-441c-ad74-185823e1bb52"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "d60ed1ee-79c9-444f-aff7-d346974426ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23'
        then answer_value_text
      else null
      end
    )
    
      
            as "567e992d-fb9e-4608-9be1-9277beae3c23"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:41.180676 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 2 (id: ipc-104453, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896'
        then answer_value_text
      else null
      end
    )
    
      
            as "27b1e829-9ad9-41c2-8cb5-01ce1f469896"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c804862-f4b9-49df-aae4-c7802e723c76"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b'
        then answer_value_text
      else null
      end
    )
    
      
            as "2dd6c90f-ea68-45ba-9d30-58e02ab0812b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253'
        then answer_value_text
      else null
      end
    )
    
      
            as "f4b782e5-18e1-4edf-a3ff-409feb207253"
      
    
    ,
  
    max(
      
      case
      when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f'
        then answer_value_text
      else null
      end
    )
    
      
            as "53b30f12-74eb-474c-941c-5f0e81b7eb9f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '783e2646-c8ea-466d-bba8-85c891a14435'
        then answer_value_text
      else null
      end
    )
    
      
            as "783e2646-c8ea-466d-bba8-85c891a14435"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "ed537539-d317-43fc-a4b3-38de5e15ea4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36'
        then answer_value_text
      else null
      end
    )
    
      
            as "18c6510f-b294-4741-ae43-9cbbc4ba7e36"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50'
        then answer_value_text
      else null
      end
    )
    
      
            as "d02eb882-411e-4bc0-af9d-08a77fcc3f50"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:41.181119 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:24:41.181448 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: BEGIN
[0m23:24:41.182006 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:41.182238 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:41.182438 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:24:41.184118 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:24:41.184348 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:41.184564 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:41.186192 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 4 (id: ipc-104394, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1d9c871-c1f8-41cc-8c54-edd4e5b162fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa'
        then answer_value_text
      else null
      end
    )
    
      
            as "f952feaf-7abc-4f6f-a3bc-d10a43ea62fa"
      
    
    ,
  
    max(
      
      case
      when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "3785a264-8bd5-44ab-bf08-8aa33735c0eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0'
        then answer_value_text
      else null
      end
    )
    
      
            as "e510a8cf-0bc7-4577-b9ee-ca758d431aa0"
      
    
    ,
  
    max(
      
      case
      when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9d203bac-75fd-4f31-bed6-073502a977f3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd7644ee-28f1-4f43-a654-17fd5034d1f6"
      
    
    ,
  
    max(
      
      case
      when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "14ec8995-eee9-416f-83ad-9f44631ac9b0"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ca03155-c9ec-45e1-8cd0-5b86fa444ad0"
      
    
    ,
  
    max(
      
      case
      when linkid = '54b75d55-1c43-4552-acbf-d9754831add8'
        then answer_value_text
      else null
      end
    )
    
      
            as "54b75d55-1c43-4552-acbf-d9754831add8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46'
        then answer_value_text
      else null
      end
    )
    
      
            as "c396a3af-6f0d-4a8e-a42b-4f47bbce5f46"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e388595-a32f-4623-8c9f-3c67bad04070"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "cf896559-dff5-4704-94a0-6a6aedee53c5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7496859-63bb-4b2f-8f75-96e44e893bf7"
      
    
    ,
  
    max(
      
      case
      when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05'
        then answer_value_text
      else null
      end
    )
    
      
            as "65252389-fa9e-4ef4-93ca-e952c77c4c05"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf"
      
    
    ,
  
    max(
      
      case
      when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "3314932c-64e4-4192-b583-eb31e87da1d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99'
        then answer_value_text
      else null
      end
    )
    
      
            as "e7ba8485-5154-41b8-ac18-35410a83cd99"
      
    
    ,
  
    max(
      
      case
      when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564'
        then answer_value_text
      else null
      end
    )
    
      
            as "18d8ee56-ffd8-4711-9074-126ef2cdc564"
      
    
    ,
  
    max(
      
      case
      when linkid = '74d0f0df-e726-4c40-84ce-efece882818b'
        then answer_value_text
      else null
      end
    )
    
      
            as "74d0f0df-e726-4c40-84ce-efece882818b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131'
        then answer_value_text
      else null
      end
    )
    
      
            as "9e11ce97-90e8-42f2-ba18-8c4f0720c131"
      
    
    ,
  
    max(
      
      case
      when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2'
        then answer_value_text
      else null
      end
    )
    
      
            as "40d6a87f-9498-4cfd-b233-4610e6de08c2"
      
    
    ,
  
    max(
      
      case
      when linkid = '57e87170-761c-4b57-a09c-d50cab02860c'
        then answer_value_text
      else null
      end
    )
    
      
            as "57e87170-761c-4b57-a09c-d50cab02860c"
      
    
    ,
  
    max(
      
      case
      when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264'
        then answer_value_text
      else null
      end
    )
    
      
            as "5056d0ba-67ac-4eab-b05d-d42941f7b264"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b2e05e9-0c11-490c-bbff-278ba90d7b4e"
      
    
    ,
  
    max(
      
      case
      when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3'
        then answer_value_text
      else null
      end
    )
    
      
            as "249f5ce8-ecc0-4e43-9675-6b01ca1502a3"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f46e0ff-0532-4105-be36-0cfa9d0770f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49'
        then answer_value_text
      else null
      end
    )
    
      
            as "0397084a-cd51-4b3a-809d-970a2406ea49"
      
    
    ,
  
    max(
      
      case
      when linkid = '808ba31c-cd29-4743-8801-dfce357d5956'
        then answer_value_text
      else null
      end
    )
    
      
            as "808ba31c-cd29-4743-8801-dfce357d5956"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d82c6ae9-0516-4513-91fa-664686779d6a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc981d8a-7f22-450b-abab-3acca810ccad"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba'
        then answer_value_text
      else null
      end
    )
    
      
            as "d0aa3679-e465-4225-85d6-5822efb10eba"
      
    
    ,
  
    max(
      
      case
      when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "86da79f0-44cb-417d-ab20-c7ecc6f8f7c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36'
        then answer_value_text
      else null
      end
    )
    
      
            as "24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36"
      
    
    ,
  
    max(
      
      case
      when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149'
        then answer_value_text
      else null
      end
    )
    
      
            as "46c2861b-70a9-4fdf-94ea-e1a01cae3149"
      
    
    ,
  
    max(
      
      case
      when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed'
        then answer_value_text
      else null
      end
    )
    
      
            as "41cce38a-ca5c-4e24-904a-25b1027336ed"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2572206-b47c-4d1e-85cb-812d13a60a85"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd62b649-7209-4d32-9bbb-dc2b2823aadb"
      
    
    ,
  
    max(
      
      case
      when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47'
        then answer_value_text
      else null
      end
    )
    
      
            as "53def3a1-a7e5-4326-95f2-2561c26ecb47"
      
    
    ,
  
    max(
      
      case
      when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6'
        then answer_value_text
      else null
      end
    )
    
      
            as "33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496'
        then answer_value_text
      else null
      end
    )
    
      
            as "b6f126dd-eac5-42e4-8896-e7400b0c0496"
      
    
    ,
  
    max(
      
      case
      when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd'
        then answer_value_text
      else null
      end
    )
    
      
            as "509b140e-b195-4696-bc5f-f2fc2d2f77dd"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae4fa455-f173-435a-bb1b-4df1d1316bd9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6262800-1e24-4348-9bf2-9bb070d2f20a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae949697-92ae-476a-96cc-f8b0adc4221f"
      
    
    ,
  
    max(
      
      case
      when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031'
        then answer_value_text
      else null
      end
    )
    
      
            as "92ab6e65-f9bd-4718-8af6-f731425d3031"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec54e447-c981-4dd2-aaa4-659f8e494248"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a1c4c0d-158f-494c-a33f-1f7f8e41f21f"
      
    
    ,
  
    max(
      
      case
      when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596'
        then answer_value_text
      else null
      end
    )
    
      
            as "656a57f8-f6f0-4fc5-b347-71dd8d38f596"
      
    
    ,
  
    max(
      
      case
      when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "245e5273-e28b-41d2-a152-1f70d85576c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41'
        then answer_value_text
      else null
      end
    )
    
      
            as "2728e75c-a0e9-4cd9-8d35-962e4f71bf41"
      
    
    ,
  
    max(
      
      case
      when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99'
        then answer_value_text
      else null
      end
    )
    
      
            as "22c11dbc-73e0-4470-9ef6-d9bd01f48c99"
      
    
    ,
  
    max(
      
      case
      when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17'
        then answer_value_text
      else null
      end
    )
    
      
            as "84018cd8-9134-429c-8dfe-fd6a16e4bd17"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21'
        then answer_value_text
      else null
      end
    )
    
      
            as "f895ed4f-5004-4da4-9d59-c21293674b21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c5720a67-803f-4917-8261-3738de838418'
        then answer_value_text
      else null
      end
    )
    
      
            as "c5720a67-803f-4917-8261-3738de838418"
      
    
    ,
  
    max(
      
      case
      when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db'
        then answer_value_text
      else null
      end
    )
    
      
            as "7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db"
      
    
    ,
  
    max(
      
      case
      when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12'
        then answer_value_text
      else null
      end
    )
    
      
            as "be88b027-64b6-4c3c-bf59-36a94dc79b12"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "a0017b28-0aa9-4926-a7be-813f0a5e6bd0"
      
    
    ,
  
    max(
      
      case
      when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12'
        then answer_value_text
      else null
      end
    )
    
      
            as "01353b1d-f816-41c1-b330-910e9a76ed12"
      
    
    ,
  
    max(
      
      case
      when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13'
        then answer_value_text
      else null
      end
    )
    
      
            as "658e8c22-d6ba-480a-81e0-dc4b6164de13"
      
    
    ,
  
    max(
      
      case
      when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240'
        then answer_value_text
      else null
      end
    )
    
      
            as "796f5440-54f8-4d69-b961-a5b7e6a63240"
      
    
    ,
  
    max(
      
      case
      when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206'
        then answer_value_text
      else null
      end
    )
    
      
            as "5e2ab0f5-f5d9-4502-befe-aba770f0e206"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-4-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-4-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966'
        then answer_value_text
      else null
      end
    )
    
      
            as "c802f463-c8f5-4056-bc45-8ab8d64a1966"
      
    
    ,
  
    max(
      
      case
      when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "706fc36f-efef-4bf9-827e-7dc100cc92bc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c631e361-027c-4e4d-b894-48785a3e6dd0"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ac23c5d-0035-4895-85f2-33c2fbba8f3f"
      
    
    ,
  
    max(
      
      case
      when linkid = '45772f3f-c610-408b-942b-359769945cf4'
        then answer_value_text
      else null
      end
    )
    
      
            as "45772f3f-c610-408b-942b-359769945cf4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "dae7f411-758d-4800-9842-fc0038a6b4a4"
      
    
    ,
  
    max(
      
      case
      when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807'
        then answer_value_text
      else null
      end
    )
    
      
            as "fc5c673b-41d4-4352-86bb-043c73ed9807"
      
    
    ,
  
    max(
      
      case
      when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "229e58ac-a18a-48dd-be10-f8b024a74eb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8726638-cfdb-40ae-b72c-f1d594f64de5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b'
        then answer_value_text
      else null
      end
    )
    
      
            as "b676a0c2-cda0-4762-be79-2a94205ee68b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe2f0911-8ddc-412b-a3e6-f216620d147e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5ab53d4-824c-460f-8939-b86ff3cd97a3"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b51625b-73b9-472d-9c71-299beb26694f'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b51625b-73b9-472d-9c71-299beb26694f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec2a78e1-e70b-4f66-86b1-561cffaf9ffd"
      
    
    ,
  
    max(
      
      case
      when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a'
        then answer_value_text
      else null
      end
    )
    
      
            as "44f02467-8ee0-49f0-8da7-5e7ed827125a"
      
    
    ,
  
    max(
      
      case
      when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73'
        then answer_value_text
      else null
      end
    )
    
      
            as "88e9b865-b81a-494b-aef2-39e803b94e73"
      
    
    ,
  
    max(
      
      case
      when linkid = '7845c436-4904-41fa-9553-2c401935623b'
        then answer_value_text
      else null
      end
    )
    
      
            as "7845c436-4904-41fa-9553-2c401935623b"
      
    
    ,
  
    max(
      
      case
      when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c'
        then answer_value_text
      else null
      end
    )
    
      
            as "892337bd-d7fd-46a7-bf72-08e87c9f412c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03'
        then answer_value_text
      else null
      end
    )
    
      
            as "d5194db0-0546-4bd1-96d8-d56457930c03"
      
    
    ,
  
    max(
      
      case
      when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa'
        then answer_value_text
      else null
      end
    )
    
      
            as "40d8ef64-02f0-42ae-9478-77651bd26dfa"
      
    
    ,
  
    max(
      
      case
      when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c'
        then answer_value_text
      else null
      end
    )
    
      
            as "9faa2b78-1842-4326-bf7f-9975bf04dc2c"
      
    
    ,
  
    max(
      
      case
      when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a'
        then answer_value_text
      else null
      end
    )
    
      
            as "370c849b-0e00-42ac-be9d-3b4c719ac31a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-spi"
      
    
    ,
  
    max(
      
      case
      when linkid = 'df53c378-27fe-483d-a630-f7b171f72980'
        then answer_value_text
      else null
      end
    )
    
      
            as "df53c378-27fe-483d-a630-f7b171f72980"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95'
        then answer_value_text
      else null
      end
    )
    
      
            as "d1c2fae1-f0f5-4333-97f6-2220d2ff3d95"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac3206dd-b60b-4cb1-a559-3a770a685668"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491'
        then answer_value_text
      else null
      end
    )
    
      
            as "f39df336-a0b8-4d0b-9bd2-6c4284985491"
      
    
    ,
  
    max(
      
      case
      when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8'
        then answer_value_text
      else null
      end
    )
    
      
            as "faefef23-d2e6-4777-b628-8f83921e8fd8"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c308fef-8ce5-4217-a8d4-8e6ff00c8e14"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a57b5b34-12e5-4ec8-8215-7f316267323a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0'
        then answer_value_text
      else null
      end
    )
    
      
            as "cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0"
      
    
    ,
  
    max(
      
      case
      when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6'
        then answer_value_text
      else null
      end
    )
    
      
            as "2e03fdf1-5274-494d-88e9-dd4b41ec90e6"
      
    
    ,
  
    max(
      
      case
      when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123'
        then answer_value_text
      else null
      end
    )
    
      
            as "62b0eb17-46e5-4c50-a133-087cc190a123"
      
    
    ,
  
    max(
      
      case
      when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d'
        then answer_value_text
      else null
      end
    )
    
      
            as "991ba845-38e5-4622-8528-dfeefbf20d3d"
      
    
    ,
  
    max(
      
      case
      when linkid = '83dfd82f-0277-459d-abe3-e8795750f288'
        then answer_value_text
      else null
      end
    )
    
      
            as "83dfd82f-0277-459d-abe3-e8795750f288"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d'
        then answer_value_text
      else null
      end
    )
    
      
            as "b36fdd5f-ccac-457c-a8ea-f9497204ef1d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7513e58-a495-49d7-a549-ba4d84fb5003"
      
    
    ,
  
    max(
      
      case
      when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888'
        then answer_value_text
      else null
      end
    )
    
      
            as "101d2b7f-2b68-407d-aa49-30cb4dadc888"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af'
        then answer_value_text
      else null
      end
    )
    
      
            as "a5d96f90-cd91-4a5b-8862-c4e3f88694af"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ea8d78b-3288-4ec8-8288-459c03df64f0"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b96f1d9-3450-423d-a277-060fcfdadc6b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369'
        then answer_value_text
      else null
      end
    )
    
      
            as "9aeae470-6ea4-4e7f-9644-ed0375fb6369"
      
    
    ,
  
    max(
      
      case
      when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98'
        then answer_value_text
      else null
      end
    )
    
      
            as "176aeeb0-e173-482a-b3eb-60f59bc04f98"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-6a-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-6a-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-1-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-1-review"
      
    
    ,
  
    max(
      
      case
      when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7'
        then answer_value_text
      else null
      end
    )
    
      
            as "53072f88-a81c-4f18-a49f-f85f64fb5be7"
      
    
    ,
  
    max(
      
      case
      when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021'
        then answer_value_text
      else null
      end
    )
    
      
            as "4d334b16-ea16-4299-94ed-32e84ef97021"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "cf16ca6e-8b1b-467d-b807-fc5d50339f71"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f531e61-26cf-4223-8653-39c24d6dd478"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c'
        then answer_value_text
      else null
      end
    )
    
      
            as "f311f3ca-5537-4134-8828-5e537bb26a9c"
      
    
    ,
  
    max(
      
      case
      when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27'
        then answer_value_text
      else null
      end
    )
    
      
            as "9b1b11e8-608f-4ea9-911b-88aae467ac27"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a25cb682-be35-4909-965e-01b8c2d036a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9'
        then answer_value_text
      else null
      end
    )
    
      
            as "e45b778d-ee8c-4ee9-81f4-8927006160f9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048'
        then answer_value_text
      else null
      end
    )
    
      
            as "cce2de12-cf62-44ff-84e8-9eb4d864d048"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc"
      
    
    ,
  
    max(
      
      case
      when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52'
        then answer_value_text
      else null
      end
    )
    
      
            as "5151ea93-a0f2-478d-adb6-f31374107b52"
      
    
    ,
  
    max(
      
      case
      when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090'
        then answer_value_text
      else null
      end
    )
    
      
            as "72e5c1b7-7ce9-49bd-834b-d98b73ba7090"
      
    
    ,
  
    max(
      
      case
      when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233'
        then answer_value_text
      else null
      end
    )
    
      
            as "5846d53f-171d-47c4-89ad-4016c3be8233"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660'
        then answer_value_text
      else null
      end
    )
    
      
            as "e552afd3-2816-446e-9ff5-e898bc813660"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db'
        then answer_value_text
      else null
      end
    )
    
      
            as "c6c266cc-1c85-41c0-97ce-9ab491be45db"
      
    
    ,
  
    max(
      
      case
      when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331'
        then answer_value_text
      else null
      end
    )
    
      
            as "3ab931b8-6bfd-4e5f-b86b-3c7377907331"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897'
        then answer_value_text
      else null
      end
    )
    
      
            as "fefdc90f-fe1d-4bfb-af93-94df8c482897"
      
    
    ,
  
    max(
      
      case
      when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164'
        then answer_value_text
      else null
      end
    )
    
      
            as "83661ebe-71cf-4eab-88e3-bfecbfe35164"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449'
        then answer_value_text
      else null
      end
    )
    
      
            as "fd1498e5-abf7-4ebe-9252-97994d6b9449"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-6a'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-6a"
      
    
    ,
  
    max(
      
      case
      when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "92da95cc-50dd-4bf0-acca-4465c07d44cc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111'
        then answer_value_text
      else null
      end
    )
    
      
            as "cebffdf4-8fd1-4829-884c-41cc42bc0111"
      
    
    ,
  
    max(
      
      case
      when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5'
        then answer_value_text
      else null
      end
    )
    
      
            as "52ef2ff5-ced6-418a-b9e7-f2ef47123df5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9c42647-eefb-42bd-9080-f83630729606'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9c42647-eefb-42bd-9080-f83630729606"
      
    
    ,
  
    max(
      
      case
      when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a'
        then answer_value_text
      else null
      end
    )
    
      
            as "13e2f934-82ed-4b23-af6e-95523dc3746a"
      
    
    ,
  
    max(
      
      case
      when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8891cd7b-ad1c-4030-afe4-6752cd273cf4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "cece37bc-897b-4b48-a9c9-59ecc9f997f7"
      
    
    ,
  
    max(
      
      case
      when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d'
        then answer_value_text
      else null
      end
    )
    
      
            as "58721b3d-88ae-4888-b5ec-ef7dfe30fb3d"
      
    
    ,
  
    max(
      
      case
      when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "895fad45-c3b5-47c5-9edf-5f9b9e793fbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a33cdecd-b7e6-45d8-94b6-52fa80c64a6d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39'
        then answer_value_text
      else null
      end
    )
    
      
            as "f14c3c34-f80a-4481-9d9c-9b05267d4c39"
      
    
    ,
  
    max(
      
      case
      when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9'
        then answer_value_text
      else null
      end
    )
    
      
            as "82d6b50b-0bb2-40f6-94b1-7a4c58df43f9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268'
        then answer_value_text
      else null
      end
    )
    
      
            as "1a00c7b7-e80d-4e90-8ed4-efd8f6d96268"
      
    
    ,
  
    max(
      
      case
      when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709'
        then answer_value_text
      else null
      end
    )
    
      
            as "07c2e8dc-b48b-4bc7-b21b-c196cce32709"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf'
        then answer_value_text
      else null
      end
    )
    
      
            as "dfa1f239-2a4c-40bd-ab15-561f6d87febf"
      
    
    ,
  
    max(
      
      case
      when linkid = '53932020-eed8-46f4-8236-d548a6335a59'
        then answer_value_text
      else null
      end
    )
    
      
            as "53932020-eed8-46f4-8236-d548a6335a59"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a1155e2-6c49-4f82-a9fc-2807ee298410"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce18eee3-aa64-4423-8db1-50fe7f00850d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b'
        then answer_value_text
      else null
      end
    )
    
      
            as "c37407c5-003a-4b7c-b6a3-e10ef146a47b"
      
    
    ,
  
    max(
      
      case
      when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3'
        then answer_value_text
      else null
      end
    )
    
      
            as "39de8b74-5cbc-4225-b27b-c97e72f08af3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f'
        then answer_value_text
      else null
      end
    )
    
      
            as "bfe595d6-325f-492a-b3b6-cc5541e18c3f"
      
    
    ,
  
    max(
      
      case
      when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc'
        then answer_value_text
      else null
      end
    )
    
      
            as "2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a320b787-4cba-457f-9c60-67ff76c7020f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9e056c2-0469-4523-a28f-1000fed1a4f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e'
        then answer_value_text
      else null
      end
    )
    
      
            as "527c0166-cc35-4cc3-a9d9-7eeb0a54635e"
      
    
    ,
  
    max(
      
      case
      when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7"
      
    
    ,
  
    max(
      
      case
      when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124'
        then answer_value_text
      else null
      end
    )
    
      
            as "5324bdce-baaa-45bf-935a-eb2f65bd7124"
      
    
    ,
  
    max(
      
      case
      when linkid = '544a444d-b101-4d56-9351-00bca8ec749e'
        then answer_value_text
      else null
      end
    )
    
      
            as "544a444d-b101-4d56-9351-00bca8ec749e"
      
    
    ,
  
    max(
      
      case
      when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86'
        then answer_value_text
      else null
      end
    )
    
      
            as "13321778-b5d4-4b01-8eda-610cf0007c86"
      
    
    ,
  
    max(
      
      case
      when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc'
        then answer_value_text
      else null
      end
    )
    
      
            as "90cedcbf-bf11-4dc3-9733-42e6900a09fc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200'
        then answer_value_text
      else null
      end
    )
    
      
            as "c0655b11-8f21-47ed-8ede-95498c2e8200"
      
    
    ,
  
    max(
      
      case
      when linkid = '15e5007d-028f-4644-8fb6-0346730c3101'
        then answer_value_text
      else null
      end
    )
    
      
            as "15e5007d-028f-4644-8fb6-0346730c3101"
      
    
    ,
  
    max(
      
      case
      when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c'
        then answer_value_text
      else null
      end
    )
    
      
            as "8c1ac4fe-1d76-4436-8f34-d315c6c17b9c"
      
    
    ,
  
    max(
      
      case
      when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "87dab385-fe6b-44ce-b6b2-5771c41d82c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "40fbe8d0-4380-4efc-bb04-26fc7d3714eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3b4cf6e-385d-40b7-9380-4de2f81463de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185'
        then answer_value_text
      else null
      end
    )
    
      
            as "a842d271-cd48-47c7-963e-dcd0376ef185"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f3a622a-d39b-49b0-84e7-0bcf4f832a4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "69d5aec4-65d3-44b1-99ba-badd201769c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75'
        then answer_value_text
      else null
      end
    )
    
      
            as "6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0'
        then answer_value_text
      else null
      end
    )
    
      
            as "f8861b1c-781f-4f12-b4c8-f8110f0c2cc0"
      
    
    ,
  
    max(
      
      case
      when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7'
        then answer_value_text
      else null
      end
    )
    
      
            as "53a575e3-aa59-408d-a0dd-8df237b68bf7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531'
        then answer_value_text
      else null
      end
    )
    
      
            as "a3670632-ce8f-468a-b2f3-6934245d3531"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a9424b0-c893-4371-b5c9-bc0008be14b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54'
        then answer_value_text
      else null
      end
    )
    
      
            as "fba783e8-91d0-4a49-ba80-c55fa9e41a54"
      
    
    ,
  
    max(
      
      case
      when linkid = '437d9ea2-adb5-471a-828b-a0285a282217'
        then answer_value_text
      else null
      end
    )
    
      
            as "437d9ea2-adb5-471a-828b-a0285a282217"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14'
        then answer_value_text
      else null
      end
    )
    
      
            as "cecb89ae-abce-411c-b4ce-f84ebf59ca14"
      
    
    ,
  
    max(
      
      case
      when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea95a315-f903-4351-87ed-c1e7e7b74198"
      
    
    ,
  
    max(
      
      case
      when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd'
        then answer_value_text
      else null
      end
    )
    
      
            as "98407058-4855-44cc-ac45-6e0d0c072fdd"
      
    
    ,
  
    max(
      
      case
      when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609'
        then answer_value_text
      else null
      end
    )
    
      
            as "705df2d9-af92-4f4f-b513-17e01d07b609"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7'
        then answer_value_text
      else null
      end
    )
    
      
            as "ff115c26-95b9-4e0d-87ed-80817d438fc7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604'
        then answer_value_text
      else null
      end
    )
    
      
            as "fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604"
      
    
    ,
  
    max(
      
      case
      when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "28b2e31a-ee4d-4e99-8974-b616145311eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4a1be29-fe8b-4423-91bc-6b4f5d730e6b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-2-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-2-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e'
        then answer_value_text
      else null
      end
    )
    
      
            as "d617b1e1-ea22-4863-a878-627f6b81963e"
      
    
    ,
  
    max(
      
      case
      when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5a79866d-f1fb-4bd8-b4c4-f18c982bef3c"
      
    
    ,
  
    max(
      
      case
      when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63'
        then answer_value_text
      else null
      end
    )
    
      
            as "2a6c5feb-8034-418b-8644-142a5e31df63"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "d3340d7e-9b84-4559-8a11-bed5a662a6f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb'
        then answer_value_text
      else null
      end
    )
    
      
            as "08b5e17c-5e14-4b19-ac93-9e479cd2a2bb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d'
        then answer_value_text
      else null
      end
    )
    
      
            as "ee5d4acf-ecf0-4e62-8924-cff17a33679d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4ebe784-07d0-4312-8a46-634c0e338a54"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444'
        then answer_value_text
      else null
      end
    )
    
      
            as "d8615ac7-96b2-46a2-b3a5-b5b83945b444"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "db779cb5-5335-4eb6-8ccc-47ec94c626c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea'
        then answer_value_text
      else null
      end
    )
    
      
            as "603d1492-316f-497f-967b-5c4b1ab983ea"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a273a98-82ca-4d36-ade0-ce98f7899972"
      
    
    ,
  
    max(
      
      case
      when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81'
        then answer_value_text
      else null
      end
    )
    
      
            as "06f9231a-999b-4459-8260-6fbbcdfc5d81"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-signs-step-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-signs-step-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7e42cdb-a42b-4d22-b7a6-204de5305351"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-3-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-3-review"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b247120-23cf-45fc-9e4d-d959f0dda79f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77'
        then answer_value_text
      else null
      end
    )
    
      
            as "d1efad02-3686-4ce3-a96d-68d8c638ff77"
      
    
    ,
  
    max(
      
      case
      when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942'
        then answer_value_text
      else null
      end
    )
    
      
            as "20cae99e-ab90-4d75-92a2-c0af5dd60942"
      
    
    ,
  
    max(
      
      case
      when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969'
        then answer_value_text
      else null
      end
    )
    
      
            as "12d89dfd-5e43-4f00-8446-b3af23323969"
      
    
    ,
  
    max(
      
      case
      when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c'
        then answer_value_text
      else null
      end
    )
    
      
            as "62a04638-8928-4aab-b490-1a33739b7a5c"
      
    
    ,
  
    max(
      
      case
      when linkid = '965b7874-dd24-4215-acd4-8d241a262638'
        then answer_value_text
      else null
      end
    )
    
      
            as "965b7874-dd24-4215-acd4-8d241a262638"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6d066a2-0286-49b0-b688-34696e7fb256"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f44652f-df2d-476e-933d-75b6ed55f5f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68'
        then answer_value_text
      else null
      end
    )
    
      
            as "6f68c416-a5de-4f68-8ad0-33c6e85a9a68"
      
    
    ,
  
    max(
      
      case
      when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225'
        then answer_value_text
      else null
      end
    )
    
      
            as "1895c0a7-b090-4f49-9b0c-08dca9a7b225"
      
    
    ,
  
    max(
      
      case
      when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2'
        then answer_value_text
      else null
      end
    )
    
      
            as "2c7b6bd7-36f6-495b-9f41-eb492c07c7b2"
      
    
    ,
  
    max(
      
      case
      when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904'
        then answer_value_text
      else null
      end
    )
    
      
            as "36dd1467-a7a1-428c-bdca-17d352a79904"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce0fdd41-6b09-4104-9998-a04c5dd9a5b7"
      
    
    ,
  
    max(
      
      case
      when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de'
        then answer_value_text
      else null
      end
    )
    
      
            as "68608473-77e6-4341-9f1b-d4d18b17d3de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871'
        then answer_value_text
      else null
      end
    )
    
      
            as "a1c56f60-b823-4c15-b99d-a315d2ca1871"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9'
        then answer_value_text
      else null
      end
    )
    
      
            as "dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33'
        then answer_value_text
      else null
      end
    )
    
      
            as "a20b29af-3317-415e-9c6e-d9f3bbc4df33"
      
    
    ,
  
    max(
      
      case
      when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f'
        then answer_value_text
      else null
      end
    )
    
      
            as "11aadd88-0cf9-48b2-939d-2b3e28191c5f"
      
    
    ,
  
    max(
      
      case
      when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488'
        then answer_value_text
      else null
      end
    )
    
      
            as "68fa6f2e-84ec-4dbc-900e-10ede297c488"
      
    
    ,
  
    max(
      
      case
      when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d'
        then answer_value_text
      else null
      end
    )
    
      
            as "1d0ad825-09de-4018-a680-cd0e6bf0983d"
      
    
    ,
  
    max(
      
      case
      when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344'
        then answer_value_text
      else null
      end
    )
    
      
            as "1fc8f8e7-2022-48d2-b41d-4e8ad22af344"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:41.187874 [debug] [Thread-1 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_tmp" rename to "qr_104454"
[0m23:24:41.189524 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:24:41.190925 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:24:41.192479 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_tmp" rename to "qr_104455"
[0m23:24:41.192776 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_tmp" rename to "qr_104453"
[0m23:24:41.193660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:41.193895 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:41.194618 [debug] [Thread-1 (]: On model.engage_analytics.qr_104454: COMMIT
[0m23:24:41.194813 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:41.195405 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: COMMIT
[0m23:24:41.195600 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:24:41.196204 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: COMMIT
[0m23:24:41.196391 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:24:41.196560 [debug] [Thread-1 (]: On model.engage_analytics.qr_104454: COMMIT
[0m23:24:41.196728 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:24:41.196881 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: COMMIT
[0m23:24:41.197097 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: COMMIT
[0m23:24:41.197909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:41.199179 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_backup"
[0m23:24:41.199406 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:41.199768 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:24:41.199991 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:41.201224 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_backup"
[0m23:24:41.201489 [debug] [Thread-1 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_backup" cascade
[0m23:24:41.203563 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_backup"
[0m23:24:41.203880 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:24:41.204178 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:24:41.204361 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_backup" cascade
[0m23:24:41.204548 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_backup" cascade
[0m23:24:41.204763 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:41.204930 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m23:24:41.205752 [debug] [Thread-1 (]: On model.engage_analytics.qr_104454: Close
[0m23:24:41.205987 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:41.206179 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:41.207698 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:24:41.208430 [debug] [Thread-4 (]: On model.engage_analytics.qr_104453: Close
[0m23:24:41.208706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b531d0>]}
[0m23:24:41.209368 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: Close
[0m23:24:41.209578 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_tmp" rename to "qr_104394"
[0m23:24:41.209862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088472c0>]}
[0m23:24:41.210238 [info ] [Thread-1 (]: 52 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_104454  [[32mCREATE VIEW[0m in 0.59s]
[0m23:24:41.210481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108841b20>]}
[0m23:24:41.210920 [info ] [Thread-4 (]: 51 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_104453  [[32mCREATE VIEW[0m in 0.60s]
[0m23:24:41.211271 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_104454
[0m23:24:41.211683 [info ] [Thread-3 (]: 53 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_104455  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:41.212017 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_104453
[0m23:24:41.212227 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_1613531
[0m23:24:41.212561 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_104455
[0m23:24:41.212796 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_1613532
[0m23:24:41.213087 [info ] [Thread-1 (]: 54 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_1613531  [RUN]
[0m23:24:41.213320 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:24:41.213549 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m23:24:41.213795 [info ] [Thread-4 (]: 55 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_1613532  [RUN]
[0m23:24:41.214084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104454, now model.engage_analytics.qr_1613531)
[0m23:24:41.214765 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: COMMIT
[0m23:24:41.215002 [info ] [Thread-3 (]: 56 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m23:24:41.215197 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104453, now model.engage_analytics.qr_1613532)
[0m23:24:41.215362 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_1613531
[0m23:24:41.215536 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:24:41.215695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104455, now model.engage_analytics.qr_1_month_follow_up)
[0m23:24:41.215851 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_1613532
[0m23:24:41.218365 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:24:41.218639 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: COMMIT
[0m23:24:41.218829 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m23:24:41.221034 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:24:41.221245 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:41.223748 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:24:41.223983 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:41.224168 [debug] [Thread-4 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:41.224377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:41.224548 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:41.225604 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_backup"
[0m23:24:41.225782 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:41.226078 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:41.226329 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:24:41.226611 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_backup" cascade
[0m23:24:41.227525 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:41.228312 [debug] [Thread-2 (]: On model.engage_analytics.qr_104394: Close
[0m23:24:41.228611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ade2a0>]}
[0m23:24:41.317540 [debug] [Thread-2 (]: An error was encountered while trying to send an event
[0m23:24:41.318268 [info ] [Thread-2 (]: 50 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_104394  [[32mCREATE VIEW[0m in 0.64s]
[0m23:24:41.318794 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_104394
[0m23:24:41.319026 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_202
[0m23:24:41.319272 [info ] [Thread-2 (]: 57 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_202 .... [RUN]
[0m23:24:41.319985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104394, now model.engage_analytics.qr_202)
[0m23:24:41.320221 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_202
[0m23:24:41.322694 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:24:41.322932 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:41.323098 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:41.798338 [debug] [Thread-1 (]: SQL status: SELECT 25 in 0.574 seconds
[0m23:24:41.800227 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_1613531"
[0m23:24:41.801641 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_1613531
[0m23:24:41.803401 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_1613531"
[0m23:24:41.804677 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:24:41.804900 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: BEGIN
[0m23:24:41.805130 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.579 seconds
[0m23:24:41.806135 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m23:24:41.806369 [debug] [Thread-4 (]: SQL status: SELECT 37 in 0.581 seconds
[0m23:24:41.806548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:41.809637 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_1613532"
[0m23:24:41.810005 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:24:41.810273 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m23:24:41.810614 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Sociodemographic Survey (id: 1613531, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cce9788-d7e7-4456-d455-5bd8dc3d2f2a"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b68e9a3-703a-4b57-876e-8dd400826db9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4afce83-4279-4d19-8a8b-1e0b7e1ba73c"
      
    
    ,
  
    max(
      
      case
      when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4'
        then answer_value_text
      else null
      end
    )
    
      
            as "6e621fcc-a25c-4070-8fda-894bb9df68e4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f'
        then answer_value_text
      else null
      end
    )
    
      
            as "f11fe547-9be9-4693-8a85-f252e4a6262f"
      
    
    ,
  
    max(
      
      case
      when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173'
        then answer_value_text
      else null
      end
    )
    
      
            as "5b133a13-0303-4d2f-8884-ffa931d2c173"
      
    
    ,
  
    max(
      
      case
      when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7'
        then answer_value_text
      else null
      end
    )
    
      
            as "05990b62-11a8-4ab7-8988-1d2a17edcff7"
      
    
    ,
  
    max(
      
      case
      when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5'
        then answer_value_text
      else null
      end
    )
    
      
            as "0e027468-c1e9-4977-f5f5-1cfa00ab8af5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "8f600ee9-8d17-43df-ed68-c9a7de2da7d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-socio-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-socio-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba'
        then answer_value_text
      else null
      end
    )
    
      
            as "d7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f8a7973-d9bb-493b-aa68-fb01e0f1aefe"
      
    
    ,
  
    max(
      
      case
      when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde'
        then answer_value_text
      else null
      end
    )
    
      
            as "1fdf1a17-7af6-413f-81e9-cf6823fe7fde"
      
    
    ,
  
    max(
      
      case
      when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af'
        then answer_value_text
      else null
      end
    )
    
      
            as "3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af"
      
    
    ,
  
    max(
      
      case
      when linkid = '92fed595-49f2-4fab-81ff-885941f31e07'
        then answer_value_text
      else null
      end
    )
    
      
            as "92fed595-49f2-4fab-81ff-885941f31e07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130'
        then answer_value_text
      else null
      end
    )
    
      
            as "66d30814-73ea-4fa4-edf8-d0d79378b130"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-biological-sex'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-biological-sex"
      
    
    ,
  
    max(
      
      case
      when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739'
        then answer_value_text
      else null
      end
    )
    
      
            as "3960c72d-b6e7-418e-86e9-f8348a49e739"
      
    
    ,
  
    max(
      
      case
      when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d'
        then answer_value_text
      else null
      end
    )
    
      
            as "4baa9e68-fe7a-489a-8b03-cc045b53d93d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:41.812511 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m23:24:41.813076 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:24:41.813305 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m23:24:41.813599 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_1613532
[0m23:24:41.815386 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_1613532"
[0m23:24:41.815687 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:41.815955 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:41.816148 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:24:41.817673 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:24:41.817931 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- 1 month follow up (id: 1-month-follow-up, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'completed-all-recommended-interventions'
        then answer_value_text
      else null
      end
    )
    
      
            as "completed-all-recommended-interventions"
      
    
    ,
  
    max(
      
      case
      when linkid = 'schedule-this-meeting'
        then answer_value_text
      else null
      end
    )
    
      
            as "schedule-this-meeting"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:41.818175 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:24:41.818338 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_tmp" rename to "qr_1613531"
[0m23:24:41.818540 [debug] [Thread-4 (]: On model.engage_analytics.qr_1613532: BEGIN
[0m23:24:41.819177 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:41.819407 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:24:41.819606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:41.820042 [debug] [Thread-4 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mental Wellness Tool (id: 1613532, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'q1-to-q3-negative'
        then answer_value_text
      else null
      end
    )
    
      
            as "q1-to-q3-negative"
      
    
    ,
  
    max(
      
      case
      when linkid = 'suicide-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "suicide-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'severe-mental-health'
        then answer_value_text
      else null
      end
    )
    
      
            as "severe-mental-health"
      
    
    ,
  
    max(
      
      case
      when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63'
        then answer_value_text
      else null
      end
    )
    
      
            as "59ae2c65-3a25-4acb-9db5-7aa035c54a63"
      
    
    ,
  
    max(
      
      case
      when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc'
        then answer_value_text
      else null
      end
    )
    
      
            as "2c50fee4-7a5d-4d62-80aa-73329934d7dc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-mental-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-mental-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = 'alcohol-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "alcohol-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642'
        then answer_value_text
      else null
      end
    )
    
      
            as "156fce37-203f-4760-a9f9-1b8ab0ae0642"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-socio-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-socio-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a051272-efb0-4f1f-acc7-f5038989207f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588'
        then answer_value_text
      else null
      end
    )
    
      
            as "4602f806-3bf4-4f16-bee1-c2e690dca588"
      
    
    ,
  
    max(
      
      case
      when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab'
        then answer_value_text
      else null
      end
    )
    
      
            as "364e4271-e89d-4206-85a1-45ad595e4cab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f'
        then answer_value_text
      else null
      end
    )
    
      
            as "97f2ed48-11d2-4417-a4b2-57a333c5157f"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e7579d-ac74-4d72-955b-1a3675a2e656"
      
    
    ,
  
    max(
      
      case
      when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29'
        then answer_value_text
      else null
      end
    )
    
      
            as "80499f94-3f2a-4f0f-9a21-7fa252b33e29"
      
    
    ,
  
    max(
      
      case
      when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20'
        then answer_value_text
      else null
      end
    )
    
      
            as "69a559db-c97b-4bcb-aae4-81465fdd1d20"
      
    
    ,
  
    max(
      
      case
      when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "99f0d10e-9522-457f-8432-fd489c53acb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b9ecb840-8515-4091-8cef-863ed297012e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'common-mental-health'
        then answer_value_text
      else null
      end
    )
    
      
            as "common-mental-health"
      
    
    ,
  
    max(
      
      case
      when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73'
        then answer_value_text
      else null
      end
    )
    
      
            as "94f913ce-e837-48b3-906d-a0613ac72b73"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77'
        then answer_value_text
      else null
      end
    )
    
      
            as "a669eaea-2f12-49ff-ac91-d54009d6ab77"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d'
        then answer_value_text
      else null
      end
    )
    
      
            as "f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20'
        then answer_value_text
      else null
      end
    )
    
      
            as "11e90302-2ae0-4e7d-be11-754b2a91ab20"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-biological-sex'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-biological-sex"
      
    
    ,
  
    max(
      
      case
      when linkid = 'how-many-drinks'
        then answer_value_text
      else null
      end
    )
    
      
            as "how-many-drinks"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-common-mental-health-form'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-common-mental-health-form"
      
    
    ,
  
    max(
      
      case
      when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6'
        then answer_value_text
      else null
      end
    )
    
      
            as "0ee3228d-28b6-4c88-8119-808fc121aaa6"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e9014d1-e07c-492e-897a-3bf7e8f6f018"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-mwtool-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-mwtool-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:41.820473 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:41.821139 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: COMMIT
[0m23:24:41.823217 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:24:41.823440 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:24:41.823664 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m23:24:41.823895 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: COMMIT
[0m23:24:41.824863 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:41.825654 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m23:24:41.825897 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:41.826107 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:24:41.826379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:41.827963 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:24:41.828164 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m23:24:41.829281 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_backup"
[0m23:24:41.829482 [debug] [Thread-4 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_tmp" rename to "qr_1613532"
[0m23:24:41.829789 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:24:41.830043 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_backup" cascade
[0m23:24:41.830396 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:41.830706 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:41.830919 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:41.832124 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m23:24:41.832841 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: Close
[0m23:24:41.833418 [debug] [Thread-4 (]: On model.engage_analytics.qr_1613532: COMMIT
[0m23:24:41.833682 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:24:41.833882 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:24:41.834161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108938320>]}
[0m23:24:41.834356 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m23:24:41.834548 [debug] [Thread-4 (]: On model.engage_analytics.qr_1613532: COMMIT
[0m23:24:41.834863 [info ] [Thread-1 (]: 54 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_1613531  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:41.835303 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_1613531
[0m23:24:41.835599 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:41.835836 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_203
[0m23:24:41.836075 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:41.837041 [debug] [Thread-3 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m23:24:41.837361 [info ] [Thread-1 (]: 58 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_203 .... [RUN]
[0m23:24:41.838713 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_backup"
[0m23:24:41.839055 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a29b80>]}
[0m23:24:41.839373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613531, now model.engage_analytics.qr_203)
[0m23:24:41.839684 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:24:41.840142 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_203
[0m23:24:41.839996 [info ] [Thread-3 (]: 56 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:41.840363 [debug] [Thread-4 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_backup" cascade
[0m23:24:41.843853 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:24:41.844250 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m23:24:41.844504 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:41.844750 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_204
[0m23:24:41.844970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:41.845145 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:41.845376 [info ] [Thread-3 (]: 59 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_204 .... [RUN]
[0m23:24:41.846163 [debug] [Thread-4 (]: On model.engage_analytics.qr_1613532: Close
[0m23:24:41.846438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_204)
[0m23:24:41.846816 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fc470>]}
[0m23:24:41.847030 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_204
[0m23:24:41.847400 [info ] [Thread-4 (]: 55 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_1613532  [[32mCREATE VIEW[0m in 0.63s]
[0m23:24:41.850005 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:24:41.850676 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_1613532
[0m23:24:41.850964 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:41.851217 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_205
[0m23:24:41.851424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:41.851680 [info ] [Thread-4 (]: 60 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_205 .... [RUN]
[0m23:24:41.851998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613532, now model.engage_analytics.qr_205)
[0m23:24:41.852168 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_205
[0m23:24:41.854803 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:24:41.855103 [debug] [Thread-2 (]: SQL status: SELECT 18 in 0.532 seconds
[0m23:24:41.855347 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:41.856774 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_202"
[0m23:24:41.856986 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:41.857710 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_202
[0m23:24:41.859760 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_202"
[0m23:24:41.860263 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:24:41.860443 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: BEGIN
[0m23:24:41.860900 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:41.861062 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:24:41.861344 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 1) (id: ipc-202, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-gad-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-gad-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9'
        then answer_value_text
      else null
      end
    )
    
      
            as "69f16284-b8a8-4a24-ab79-03bde5bcfbe9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603'
        then answer_value_text
      else null
      end
    )
    
      
            as "829e6d32-3fa7-4d16-909b-b198aea54603"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "583c5b02-b26c-4821-8da8-7ed9066d9d5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:41.864390 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:41.866123 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:24:41.866401 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_tmp" rename to "qr_202"
[0m23:24:41.867587 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:41.868341 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: COMMIT
[0m23:24:41.868535 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:24:41.868700 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: COMMIT
[0m23:24:41.869640 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:41.870920 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_backup"
[0m23:24:41.871202 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:24:41.871374 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_backup" cascade
[0m23:24:41.871978 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:41.872807 [debug] [Thread-2 (]: On model.engage_analytics.qr_202: Close
[0m23:24:41.873102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089415e0>]}
[0m23:24:41.873418 [info ] [Thread-2 (]: 57 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_202  [[32mCREATE VIEW[0m in 0.55s]
[0m23:24:41.873675 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_202
[0m23:24:41.873855 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_206
[0m23:24:41.874078 [info ] [Thread-2 (]: 61 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_206 .... [RUN]
[0m23:24:41.874265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_202, now model.engage_analytics.qr_206)
[0m23:24:41.874421 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_206
[0m23:24:41.876720 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:24:41.876955 [debug] [Thread-2 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:41.877126 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:42.383269 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.538 seconds
[0m23:24:42.384763 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_203"
[0m23:24:42.385304 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_203
[0m23:24:42.387291 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_203"
[0m23:24:42.387607 [debug] [Thread-3 (]: SQL status: SELECT 28 in 0.536 seconds
[0m23:24:42.390267 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_204"
[0m23:24:42.390672 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:24:42.390858 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: BEGIN
[0m23:24:42.391033 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_204
[0m23:24:42.393529 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_204"
[0m23:24:42.393861 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.537 seconds
[0m23:24:42.394092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m23:24:42.395306 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_205"
[0m23:24:42.395510 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:24:42.395907 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 1) (id: ipc-203, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727'
        then answer_value_text
      else null
      end
    )
    
      
            as "8085cded-8e0f-497f-9e3d-5fab3981d727"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "d58c8907-06c6-4071-aa6c-b2b95d2169c7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:42.396331 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:24:42.396540 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: BEGIN
[0m23:24:42.396771 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_205
[0m23:24:42.398774 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_205"
[0m23:24:42.398995 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:42.399208 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:42.400609 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:24:42.400790 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:24:42.401033 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_tmp" rename to "qr_203"
[0m23:24:42.401498 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 1) (id: ipc-204, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '16d05294-fee9-4d42-8447-0d578a5de192'
        then answer_value_text
      else null
      end
    )
    
      
            as "16d05294-fee9-4d42-8447-0d578a5de192"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f'
        then answer_value_text
      else null
      end
    )
    
      
            as "790391ba-cf9f-4ef6-be11-b5a7b468819f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7934aa5-17f0-4320-8f65-e7a7f72c5161"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d74aecd2-f0c4-4207-b396-b2c6d780be4a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505'
        then answer_value_text
      else null
      end
    )
    
      
            as "2171a88a-4e4d-44c4-b6b3-389723e9b505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-ptsd-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-ptsd-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:42.401938 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:24:42.402232 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: BEGIN
[0m23:24:42.402577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:42.402822 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:42.403641 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: COMMIT
[0m23:24:42.403930 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:24:42.404174 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:24:42.404486 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 2) (id: ipc-205, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-gad-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-gad-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110'
        then answer_value_text
      else null
      end
    )
    
      
            as "510776d6-8b4e-446b-abe7-80aee8ecb110"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23'
        then answer_value_text
      else null
      end
    )
    
      
            as "37e0bcfd-f6d1-4b35-9556-4d458a717a23"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:42.404805 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: COMMIT
[0m23:24:42.405562 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:42.407220 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:24:42.407468 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:42.407671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:24:42.407861 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_tmp" rename to "qr_204"
[0m23:24:42.409458 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:24:42.410524 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_backup"
[0m23:24:42.410732 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_tmp" rename to "qr_205"
[0m23:24:42.411005 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:24:42.411218 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_backup" cascade
[0m23:24:42.411596 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:42.412191 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: COMMIT
[0m23:24:42.412353 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:24:42.412510 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:42.412665 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: COMMIT
[0m23:24:42.412809 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:42.412965 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.536 seconds
[0m23:24:42.413573 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: COMMIT
[0m23:24:42.414266 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: Close
[0m23:24:42.414440 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:42.415327 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_206"
[0m23:24:42.415515 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:24:42.416655 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_backup"
[0m23:24:42.416922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108846270>]}
[0m23:24:42.417176 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: COMMIT
[0m23:24:42.417440 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:24:42.417908 [info ] [Thread-1 (]: 58 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_203  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:42.418212 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_backup" cascade
[0m23:24:42.418448 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:42.418727 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_203
[0m23:24:42.418903 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_206
[0m23:24:42.421032 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_backup"
[0m23:24:42.421264 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:42.421484 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_207
[0m23:24:42.423251 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_206"
[0m23:24:42.423588 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:24:42.424362 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: Close
[0m23:24:42.424627 [info ] [Thread-1 (]: 62 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_207 .... [RUN]
[0m23:24:42.424876 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_backup" cascade
[0m23:24:42.425223 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108957c20>]}
[0m23:24:42.425456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_203, now model.engage_analytics.qr_207)
[0m23:24:42.426076 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:24:42.425887 [info ] [Thread-3 (]: 59 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_204  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:42.426354 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:42.426648 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_207
[0m23:24:42.426859 [debug] [Thread-2 (]: On model.engage_analytics.qr_206: BEGIN
[0m23:24:42.427247 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_204
[0m23:24:42.427980 [debug] [Thread-4 (]: On model.engage_analytics.qr_205: Close
[0m23:24:42.430361 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:24:42.430675 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_208
[0m23:24:42.431009 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:42.431318 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ff8c0>]}
[0m23:24:42.431519 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:42.431762 [info ] [Thread-3 (]: 63 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_208 .... [RUN]
[0m23:24:42.432007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:42.432336 [info ] [Thread-4 (]: 60 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_205  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:42.432621 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:24:42.432871 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_204, now model.engage_analytics.qr_208)
[0m23:24:42.433220 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_205
[0m23:24:42.433482 [debug] [Thread-2 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 2) (id: ipc-206, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07'
        then answer_value_text
      else null
      end
    )
    
      
            as "85a3f14c-e4d8-4c45-9088-967ec4ea0d07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:42.433735 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_208
[0m23:24:42.433936 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_209
[0m23:24:42.436434 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:24:42.436725 [info ] [Thread-4 (]: 64 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_209 .... [RUN]
[0m23:24:42.436983 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:42.437189 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:42.437477 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_205, now model.engage_analytics.qr_209)
[0m23:24:42.439036 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:24:42.439313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:42.439536 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_209
[0m23:24:42.439788 [debug] [Thread-2 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_tmp" rename to "qr_206"
[0m23:24:42.442147 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:24:42.442419 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:42.442598 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:42.443129 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:42.443862 [debug] [Thread-2 (]: On model.engage_analytics.qr_206: COMMIT
[0m23:24:42.444062 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:24:42.444312 [debug] [Thread-2 (]: On model.engage_analytics.qr_206: COMMIT
[0m23:24:42.445348 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:42.446842 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_backup"
[0m23:24:42.447205 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:24:42.447549 [debug] [Thread-2 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_backup" cascade
[0m23:24:42.448335 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:42.449074 [debug] [Thread-2 (]: On model.engage_analytics.qr_206: Close
[0m23:24:42.449466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b37620>]}
[0m23:24:42.449894 [info ] [Thread-2 (]: 61 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_206  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:42.450245 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_206
[0m23:24:42.450500 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_210
[0m23:24:42.450780 [info ] [Thread-2 (]: 65 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_210 .... [RUN]
[0m23:24:42.451024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_206, now model.engage_analytics.qr_210)
[0m23:24:42.451193 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_210
[0m23:24:42.453743 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:24:42.454002 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:42.454238 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:43.006755 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.575 seconds
[0m23:24:43.007894 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_207"
[0m23:24:43.008494 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_207
[0m23:24:43.010745 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_207"
[0m23:24:43.011224 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.569 seconds
[0m23:24:43.012106 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_209"
[0m23:24:43.012385 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:24:43.012572 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: BEGIN
[0m23:24:43.012773 [debug] [Thread-3 (]: SQL status: SELECT 97 in 0.573 seconds
[0m23:24:43.053637 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_208"
[0m23:24:43.053989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:24:43.054205 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.600 seconds
[0m23:24:43.054522 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:24:43.056117 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_210"
[0m23:24:43.056417 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 3) (id: ipc-207, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "2fb4f2f4-23b5-4f36-b444-683563ea4fb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:43.056788 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_208
[0m23:24:43.056991 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_209
[0m23:24:43.058992 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_208"
[0m23:24:43.060805 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_209"
[0m23:24:43.061040 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:43.061220 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_210
[0m23:24:43.062782 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:24:43.064533 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_210"
[0m23:24:43.064738 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_tmp" rename to "qr_207"
[0m23:24:43.064953 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:24:43.065147 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:24:43.065453 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: BEGIN
[0m23:24:43.065744 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: BEGIN
[0m23:24:43.066126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:43.066790 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: COMMIT
[0m23:24:43.066992 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:43.067190 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:24:43.067413 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:24:43.067665 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:43.067869 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:24:43.068059 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: BEGIN
[0m23:24:43.068221 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: COMMIT
[0m23:24:43.068383 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:24:43.069116 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 3 (id: ipc-208, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '6930d457-7bec-4983-832b-3220b163f505'
        then answer_value_text
      else null
      end
    )
    
      
            as "6930d457-7bec-4983-832b-3220b163f505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243'
        then answer_value_text
      else null
      end
    )
    
      
            as "57a5ca78-4761-466a-bba4-c0c84eab5243"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9543e3c-cbff-4d2a-b3df-bf96e509d9ca"
      
    
    ,
  
    max(
      
      case
      when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a'
        then answer_value_text
      else null
      end
    )
    
      
            as "1b59ddeb-483d-4b1b-af53-f3942204589a"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ed77f2a-0d5a-434d-b153-d8deadfbc3f8"
      
    
    ,
  
    max(
      
      case
      when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "0a15f38b-027a-42ff-b1e8-ca5e2b313f71"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19'
        then answer_value_text
      else null
      end
    )
    
      
            as "70e4d965-a614-4dc5-b2fa-4035f0444b19"
      
    
    ,
  
    max(
      
      case
      when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553'
        then answer_value_text
      else null
      end
    )
    
      
            as "601055c1-efe3-47d4-9510-1ed0cc565553"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ad7384f-a332-4e41-9318-0d3f9e540ee7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1755ad4-b33a-44a3-b562-4206a582c28a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "2fb4f2f4-23b5-4f36-b444-683563ea4fb3"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f1e5102-4441-49d8-9fbc-4ea6df196b43"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a126244-6ec2-4c81-a6d4-409dff788019"
      
    
    ,
  
    max(
      
      case
      when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473'
        then answer_value_text
      else null
      end
    )
    
      
            as "68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e17756cd-4861-4dde-859c-f90241977246'
        then answer_value_text
      else null
      end
    )
    
      
            as "e17756cd-4861-4dde-859c-f90241977246"
      
    
    ,
  
    max(
      
      case
      when linkid = '95121ef1-bfe5-40ce-841c-524334644148'
        then answer_value_text
      else null
      end
    )
    
      
            as "95121ef1-bfe5-40ce-841c-524334644148"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb78f289-5f7d-4c89-9ddf-6b393a268462"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f926bba-38b5-4b20-8852-5b9e317bb010"
      
    
    ,
  
    max(
      
      case
      when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263'
        then answer_value_text
      else null
      end
    )
    
      
            as "86bdafab-bb90-429e-8bc5-a90dc46e7263"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-2"
      
    
    ,
  
    max(
      
      case
      when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73'
        then answer_value_text
      else null
      end
    )
    
      
            as "747188c8-4fc0-43ea-92b4-9baa32567f73"
      
    
    ,
  
    max(
      
      case
      when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b'
        then answer_value_text
      else null
      end
    )
    
      
            as "55092b78-a252-44ed-9dcb-2fc78570dc8b"
      
    
    ,
  
    max(
      
      case
      when linkid = '547a07c2-f94c-4956-997f-0439626d0251'
        then answer_value_text
      else null
      end
    )
    
      
            as "547a07c2-f94c-4956-997f-0439626d0251"
      
    
    ,
  
    max(
      
      case
      when linkid = '920de190-557a-4233-91a3-4bf293f18214'
        then answer_value_text
      else null
      end
    )
    
      
            as "920de190-557a-4233-91a3-4bf293f18214"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ff4b5cb-2c44-434b-90e9-85c61a858097"
      
    
    ,
  
    max(
      
      case
      when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414'
        then answer_value_text
      else null
      end
    )
    
      
            as "83176bb3-c0cb-445a-a91b-6711635b1414"
      
    
    ,
  
    max(
      
      case
      when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90'
        then answer_value_text
      else null
      end
    )
    
      
            as "10cd5560-6c41-41a6-94c5-af74ce96dc90"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-021'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-021"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9'
        then answer_value_text
      else null
      end
    )
    
      
            as "a24c89ff-1e14-403c-8dfa-26fc6c1103d9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb8828db-1674-47e7-ba9a-e3c161160b65"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f63637c-1de2-4851-a088-c3b08152447e'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f63637c-1de2-4851-a088-c3b08152447e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44'
        then answer_value_text
      else null
      end
    )
    
      
            as "eea0b1ca-5582-4b45-b5cf-36bc0665ba44"
      
    
    ,
  
    max(
      
      case
      when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975'
        then answer_value_text
      else null
      end
    )
    
      
            as "5db949bd-4ebf-4d52-b850-8e951455e975"
      
    
    ,
  
    max(
      
      case
      when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "8c82f757-3f40-4b09-bdf4-78ee376f75a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c'
        then answer_value_text
      else null
      end
    )
    
      
            as "1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e0b76f9-0902-43ba-b858-0b1505e9d168"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359'
        then answer_value_text
      else null
      end
    )
    
      
            as "e245b7d9-955a-4c4b-a107-e2bf5d6d2359"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a77f07b3-7913-4708-a354-14e503a948f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd'
        then answer_value_text
      else null
      end
    )
    
      
            as "8ac792f5-3f3c-49d3-a800-63c662bf00cd"
      
    
    ,
  
    max(
      
      case
      when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3'
        then answer_value_text
      else null
      end
    )
    
      
            as "50cf6a9c-a837-4531-a13a-47381657c2b3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "c91209cc-1b2c-43f0-83f0-4704418ae2d5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc8f199a-59f0-4184-864d-b1c0befd26df"
      
    
    ,
  
    max(
      
      case
      when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593'
        then answer_value_text
      else null
      end
    )
    
      
            as "43801cc4-c61f-4ee0-82ad-cf6f1f799593"
      
    
    ,
  
    max(
      
      case
      when linkid = '4442589a-51b2-48c3-8297-b805e525642c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4442589a-51b2-48c3-8297-b805e525642c"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c95559d-86ff-4b87-a271-e52388072a53'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c95559d-86ff-4b87-a271-e52388072a53"
      
    
    ,
  
    max(
      
      case
      when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "451acc1a-26f4-4374-96da-09bfb47365a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cc2834b-0d28-43d0-8811-509995cfcdb8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299'
        then answer_value_text
      else null
      end
    )
    
      
            as "b24118e2-31c5-4e23-af3a-1722af72c299"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-1"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f7b6563-47b1-4ad4-abc3-cffdae40a57a"
      
    
    ,
  
    max(
      
      case
      when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-019'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-019"
      
    
    ,
  
    max(
      
      case
      when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5'
        then answer_value_text
      else null
      end
    )
    
      
            as "9e995f48-b092-49b2-a9e4-c7e754e446e5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9a9f492-8eb8-4c71-8ec6-f80ab596430b"
      
    
    ,
  
    max(
      
      case
      when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc'
        then answer_value_text
      else null
      end
    )
    
      
            as "1b3394a9-eaff-4871-9537-0d29f5712adc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc'
        then answer_value_text
      else null
      end
    )
    
      
            as "4554f4b2-d15e-47e7-a10d-d77939dd3afc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7f10195-b859-4670-abbc-a2498c4fe45f"
      
    
    ,
  
    max(
      
      case
      when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a'
        then answer_value_text
      else null
      end
    )
    
      
            as "232484cf-1aee-4bfa-a66e-61494587a16a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac6eb49b-3d37-4bac-8d27-1e1ad01018ce"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8b8e550-4d65-42be-acb9-2f4ac17c7f49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bed17079-d1e5-4bbe-af07-3d7b6a86243e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '665e1595-f169-4815-9d24-dac265f1809b'
        then answer_value_text
      else null
      end
    )
    
      
            as "665e1595-f169-4815-9d24-dac265f1809b"
      
    
    ,
  
    max(
      
      case
      when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21'
        then answer_value_text
      else null
      end
    )
    
      
            as "99079ebd-1665-4503-bb37-8de493dd4a21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-022'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-022"
      
    
    ,
  
    max(
      
      case
      when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef'
        then answer_value_text
      else null
      end
    )
    
      
            as "058278e4-33d6-4c0f-8127-ccf923bcc7ef"
      
    
    ,
  
    max(
      
      case
      when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd'
        then answer_value_text
      else null
      end
    )
    
      
            as "59744d45-0100-4d62-b105-5cbecd973ffd"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ecf12a4-a246-4b79-b281-65b3676ca3a4"
      
    
    ,
  
    max(
      
      case
      when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5'
        then answer_value_text
      else null
      end
    )
    
      
            as "77fc70ba-6cac-494c-b27a-77ebce2289e5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb0c7a5-a211-43ec-af7b-5f1079399133"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-024'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-024"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9'
        then answer_value_text
      else null
      end
    )
    
      
            as "969c0120-0b86-40e5-8881-6a145fe90aa9"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c9f8c1d-5827-4d21-bd33-3240fade93ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "6b5fa434-2fc3-4e4b-ad11-89f6260a81f2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6befba3-6d25-47ae-9cac-409dfae832a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92'
        then answer_value_text
      else null
      end
    )
    
      
            as "b31c0187-3e54-4fcf-9763-8b3f3850be92"
      
    
    ,
  
    max(
      
      case
      when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53'
        then answer_value_text
      else null
      end
    )
    
      
            as "9082f0ba-b8e5-495a-a2a4-b30918e19d53"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60'
        then answer_value_text
      else null
      end
    )
    
      
            as "b95949ec-f2ee-4d04-9e52-fb61dac18e60"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-020'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-020"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-023'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-023"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1a13d53-b867-440f-8622-bccebf54f176"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:43.069964 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 4) (id: ipc-209, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990'
        then answer_value_text
      else null
      end
    )
    
      
            as "c04706e8-4a1e-4e6a-ac6e-be9dd8274990"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:43.070317 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:43.070730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:43.071394 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:24:43.072652 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_backup"
[0m23:24:43.073051 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 4) (id: ipc-210, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11'
        then answer_value_text
      else null
      end
    )
    
      
            as "62b55d32-de8e-4abd-8489-4e3aa9270e11"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e'
        then answer_value_text
      else null
      end
    )
    
      
            as "d590116a-ec42-46e3-8ab6-6259307af17e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8'
        then answer_value_text
      else null
      end
    )
    
      
            as "a4b58f6e-3046-4a11-9e9e-e6b1547594e8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef'
        then answer_value_text
      else null
      end
    )
    
      
            as "d5a448fb-4db7-45e8-858b-f2d2e7cb0eef"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:43.073405 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:43.073723 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:24:43.075859 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:24:43.076135 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_backup" cascade
[0m23:24:43.076394 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_tmp" rename to "qr_209"
[0m23:24:43.076698 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:43.078290 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:24:43.078495 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_tmp" rename to "qr_210"
[0m23:24:43.078695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:43.078899 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:24:43.079132 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:43.080009 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: Close
[0m23:24:43.080200 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:43.081559 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:24:43.082140 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: COMMIT
[0m23:24:43.082457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8ac00>]}
[0m23:24:43.083059 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: COMMIT
[0m23:24:43.083268 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_tmp" rename to "qr_208"
[0m23:24:43.083466 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:24:43.083949 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:24:43.083804 [info ] [Thread-1 (]: 62 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_207  [[32mCREATE VIEW[0m in 0.66s]
[0m23:24:43.084188 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: COMMIT
[0m23:24:43.084458 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: COMMIT
[0m23:24:43.084771 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_207
[0m23:24:43.085054 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_211
[0m23:24:43.085309 [info ] [Thread-1 (]: 66 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_211 .... [RUN]
[0m23:24:43.085548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_207, now model.engage_analytics.qr_211)
[0m23:24:43.085792 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_211
[0m23:24:43.088207 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:24:43.088458 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:24:43.088685 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:43.088853 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m23:24:43.089038 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m23:24:43.089730 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: COMMIT
[0m23:24:43.089920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:43.091138 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_backup"
[0m23:24:43.092169 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_backup"
[0m23:24:43.092352 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:24:43.092704 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:24:43.092970 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:24:43.093147 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: COMMIT
[0m23:24:43.093319 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_backup" cascade
[0m23:24:43.093555 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_backup" cascade
[0m23:24:43.094248 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:43.094475 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:43.095215 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: Close
[0m23:24:43.095404 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:43.096078 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: Close
[0m23:24:43.097246 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_backup"
[0m23:24:43.097518 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a74bf0>]}
[0m23:24:43.097840 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:24:43.098132 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8baa0>]}
[0m23:24:43.098746 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_backup" cascade
[0m23:24:43.098537 [info ] [Thread-4 (]: 64 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_209  [[32mCREATE VIEW[0m in 0.66s]
[0m23:24:43.099107 [info ] [Thread-2 (]: 65 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_210  [[32mCREATE VIEW[0m in 0.65s]
[0m23:24:43.099449 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_209
[0m23:24:43.099764 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_210
[0m23:24:43.099967 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:43.100176 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_212
[0m23:24:43.100405 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_221
[0m23:24:43.101218 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: Close
[0m23:24:43.101533 [info ] [Thread-4 (]: 67 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_212 .... [RUN]
[0m23:24:43.101805 [info ] [Thread-2 (]: 68 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_221 .... [RUN]
[0m23:24:43.102093 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_209, now model.engage_analytics.qr_212)
[0m23:24:43.102343 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891bdd0>]}
[0m23:24:43.102529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_210, now model.engage_analytics.qr_221)
[0m23:24:43.102696 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_212
[0m23:24:43.103117 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_221
[0m23:24:43.102979 [info ] [Thread-3 (]: 63 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_208  [[32mCREATE VIEW[0m in 0.67s]
[0m23:24:43.105457 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:24:43.107719 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:24:43.108022 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_208
[0m23:24:43.108225 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:43.108415 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:43.108606 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_23451
[0m23:24:43.108850 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:43.109003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:43.109220 [info ] [Thread-3 (]: 69 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_23451 .. [RUN]
[0m23:24:43.109613 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_208, now model.engage_analytics.qr_23451)
[0m23:24:43.109773 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_23451
[0m23:24:43.113163 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:24:43.113407 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:43.113677 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:43.623934 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.534 seconds
[0m23:24:43.626548 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_211"
[0m23:24:43.627108 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_211
[0m23:24:43.628960 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_211"
[0m23:24:43.629425 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:24:43.629648 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: BEGIN
[0m23:24:43.630488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:43.630675 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:24:43.630943 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 4) (id: ipc-211, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2'
        then answer_value_text
      else null
      end
    )
    
      
            as "01a4984f-7b50-47bb-9ae1-1b81ee4d6df2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b'
        then answer_value_text
      else null
      end
    )
    
      
            as "11d368a4-7f34-46d5-a8d0-6deed381945b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792'
        then answer_value_text
      else null
      end
    )
    
      
            as "4b86c897-4d68-405b-aa08-760ed6ff6792"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:43.634201 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:43.636260 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:24:43.636488 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_tmp" rename to "qr_211"
[0m23:24:43.637563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:43.638443 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: COMMIT
[0m23:24:43.638654 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:24:43.638818 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: COMMIT
[0m23:24:43.639776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:43.640971 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_backup"
[0m23:24:43.641276 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:24:43.641450 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_backup" cascade
[0m23:24:43.642090 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.528 seconds
[0m23:24:43.643092 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_23451"
[0m23:24:43.643345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:24:43.644164 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: Close
[0m23:24:43.644467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e73b0>]}
[0m23:24:43.644813 [info ] [Thread-1 (]: 66 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_211  [[32mCREATE VIEW[0m in 0.56s]
[0m23:24:43.645105 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_23451
[0m23:24:43.645368 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_211
[0m23:24:43.647393 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_23451"
[0m23:24:43.647707 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_54
[0m23:24:43.647919 [debug] [Thread-4 (]: SQL status: SELECT 159 in 0.539 seconds
[0m23:24:43.654286 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_212"
[0m23:24:43.654592 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.546 seconds
[0m23:24:43.656475 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_221"
[0m23:24:43.648313 [info ] [Thread-1 (]: 70 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_54 ..... [RUN]
[0m23:24:43.656864 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:24:43.657095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_211, now model.engage_analytics.qr_54)
[0m23:24:43.657291 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: BEGIN
[0m23:24:43.657503 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_54
[0m23:24:43.660003 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:24:43.660269 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m23:24:43.660499 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:43.660718 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_212
[0m23:24:43.660898 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_221
[0m23:24:43.661077 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:24:43.661257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:43.663247 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_212"
[0m23:24:43.664981 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_221"
[0m23:24:43.665261 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Discuss Confidentiality (id: ipc-23451, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:43.666194 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:24:43.666535 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: BEGIN
[0m23:24:43.666934 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:24:43.667139 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: BEGIN
[0m23:24:43.667751 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:43.667973 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:24:43.668193 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:43.668601 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Add Family Member Registration (id: ipc-221, url: n/a, version: 0.0.3)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9aa068d-8d94-4b3d-b9da-ce05a59cecdd"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6306275-b989-4375-8527-3a56092081b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6306275-b989-4375-8527-3a56092081b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-best-represents-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-best-represents-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = 'do-you-have-medicaid'
        then answer_value_text
      else null
      end
    )
    
      
            as "do-you-have-medicaid"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d'
        then answer_value_text
      else null
      end
    )
    
      
            as "8fb87910-d900-4eea-dbba-dcf76ee6806d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'choice-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "choice-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'medicaid-number'
        then answer_value_text
      else null
      end
    )
    
      
            as "medicaid-number"
      
    
    ,
  
    max(
      
      case
      when linkid = 'physical-address'
        then answer_value_text
      else null
      end
    )
    
      
            as "physical-address"
      
    
    ,
  
    max(
      
      case
      when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271'
        then answer_value_text
      else null
      end
    )
    
      
            as "77e32953-0679-48b5-f004-1ab4a4ac0271"
      
    
    ,
  
    max(
      
      case
      when linkid = 'choice-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "choice-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'zip-code'
        then answer_value_text
      else null
      end
    )
    
      
            as "zip-code"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'phone-number'
        then answer_value_text
      else null
      end
    )
    
      
            as "phone-number"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-biological-sex-at-birth'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-biological-sex-at-birth"
      
    
    ,
  
    max(
      
      case
      when linkid = 'where-did-you-first-learn-about-engage'
        then answer_value_text
      else null
      end
    )
    
      
            as "where-did-you-first-learn-about-engage"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-where-did-you-first-learn-about-engage'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-where-did-you-first-learn-about-engage"
      
    
    ,
  
    max(
      
      case
      when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff'
        then answer_value_text
      else null
      end
    )
    
      
            as "36d39dbe-00e2-4e29-f079-3ec8f0119aff"
      
    
    ,
  
    max(
      
      case
      when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd'
        then answer_value_text
      else null
      end
    )
    
      
            as "597f4425-72b3-4bc4-8f38-b742aa3e99cd"
      
    
    ,
  
    max(
      
      case
      when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7'
        then answer_value_text
      else null
      end
    )
    
      
            as "8460d986-ef71-4997-80ee-7887d8c345e7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c31ef6d1-336b-4260-9881-67ba7b477ae0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'email-address'
        then answer_value_text
      else null
      end
    )
    
      
            as "email-address"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f'
        then answer_value_text
      else null
      end
    )
    
      
            as "c02a80e7-ebf0-48b5-9752-28a48dba487f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'age'
        then answer_value_text
      else null
      end
    )
    
      
            as "age"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:43.668985 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:24:43.670701 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:24:43.671224 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:24:43.671448 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_tmp" rename to "qr_23451"
[0m23:24:43.672660 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SBIRT (id: ipc-212, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'is-drug-dependence'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-drug-dependence"
      
    
    ,
  
    max(
      
      case
      when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812'
        then answer_value_text
      else null
      end
    )
    
      
            as "287b1b6c-fe58-4245-90dc-87d72d296812"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ad609c63-366e-476a-b131-610ceed211da'
        then answer_value_text
      else null
      end
    )
    
      
            as "ad609c63-366e-476a-b131-610ceed211da"
      
    
    ,
  
    max(
      
      case
      when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3'
        then answer_value_text
      else null
      end
    )
    
      
            as "38eb7cfd-8f4a-4743-b856-c8ddd529dac3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19'
        then answer_value_text
      else null
      end
    )
    
      
            as "ff55dd63-f51c-420b-97a0-f957d31d6b19"
      
    
    ,
  
    max(
      
      case
      when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2'
        then answer_value_text
      else null
      end
    )
    
      
            as "958d0ff5-edd9-4d25-9f4d-4ff29289bbe2"
      
    
    ,
  
    max(
      
      case
      when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4'
        then answer_value_text
      else null
      end
    )
    
      
            as "86daa888-2174-4fdc-9200-cbfdbe430ab4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-is-medium-high-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-is-medium-high-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae15db19-8d0c-465a-a925-3e0503f0a25b"
      
    
    ,
  
    max(
      
      case
      when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116'
        then answer_value_text
      else null
      end
    )
    
      
            as "73b23b0b-ff20-4eb9-aebb-a34432897116"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "b11bfd65-1f8d-4dee-8a9e-b2044382c0d5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2c84a83-1568-4593-9ea4-4f6c3978edd6"
      
    
    ,
  
    max(
      
      case
      when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515'
        then answer_value_text
      else null
      end
    )
    
      
            as "28edfdea-ec6f-4d33-80e2-6d7323b3b515"
      
    
    ,
  
    max(
      
      case
      when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78'
        then answer_value_text
      else null
      end
    )
    
      
            as "19d44e35-f7b5-43e3-be3b-fdb820503f78"
      
    
    ,
  
    max(
      
      case
      when linkid = '39843731-a8e7-4822-bad7-55489947ebeb'
        then answer_value_text
      else null
      end
    )
    
      
            as "39843731-a8e7-4822-bad7-55489947ebeb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491'
        then answer_value_text
      else null
      end
    )
    
      
            as "db7cc8b8-b558-41c8-9849-a80252710491"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    ,
  
    max(
      
      case
      when linkid = 'should-discuss-health-goals'
        then answer_value_text
      else null
      end
    )
    
      
            as "should-discuss-health-goals"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f1fb719-c235-4826-a53e-24502bc620cc"
      
    
    ,
  
    max(
      
      case
      when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3'
        then answer_value_text
      else null
      end
    )
    
      
            as "7f8ade46-1d91-40a0-b67e-015a5a6aadc3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb'
        then answer_value_text
      else null
      end
    )
    
      
            as "2336b352-cd6b-4044-8879-a5425c4ae5cb"
      
    
    ,
  
    max(
      
      case
      when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3'
        then answer_value_text
      else null
      end
    )
    
      
            as "48d61a4b-d87d-4661-96dd-42766dbe8cc3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4317308-24ec-4ce6-8659-54d4f1aa7e96"
      
    
    ,
  
    max(
      
      case
      when linkid = '0466b304-2876-409b-ade2-d1c675614854'
        then answer_value_text
      else null
      end
    )
    
      
            as "0466b304-2876-409b-ade2-d1c675614854"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-medium-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-medium-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f'
        then answer_value_text
      else null
      end
    )
    
      
            as "687cad76-ce92-4dca-b94f-58070b33da6f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'using-opioids-and-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "using-opioids-and-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474'
        then answer_value_text
      else null
      end
    )
    
      
            as "88accd91-b2ff-4bba-a5b1-58eaef458474"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "d169ab54-4544-4d1a-8687-6abc289982a4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41'
        then answer_value_text
      else null
      end
    )
    
      
            as "daf9b1ff-06c5-45a7-a3d1-26977a2e2b41"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7'
        then answer_value_text
      else null
      end
    )
    
      
            as "b87d6054-9f94-456f-b7f6-67c73be8acc7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa901327-bb55-4e04-a72b-5bcc7eb22404"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-discuss-next-steps'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-discuss-next-steps"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990'
        then answer_value_text
      else null
      end
    )
    
      
            as "c0911201-29b6-4cff-8cf8-fca31dc2b990"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d'
        then answer_value_text
      else null
      end
    )
    
      
            as "d11e0ac3-5faf-4986-a633-22efa8c74c4d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7444114-6b17-4300-80a1-a6376fd135d4"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c5e1af3-63d6-4283-9ea3-ef2b49314b1a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671'
        then answer_value_text
      else null
      end
    )
    
      
            as "092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197'
        then answer_value_text
      else null
      end
    )
    
      
            as "dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ab8f95f3-3ca8-439f-afc2-c95a0853f9f4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40'
        then answer_value_text
      else null
      end
    )
    
      
            as "da17f7fc-0919-44cb-a41c-fa8480bd3c40"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49'
        then answer_value_text
      else null
      end
    )
    
      
            as "db4b99b9-2cae-4833-bb08-fe7e94156b49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "ba444442-73b2-44be-b55e-c8f9fba8f7a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '1600f791-fd2c-44d8-8384-37973785741b'
        then answer_value_text
      else null
      end
    )
    
      
            as "1600f791-fd2c-44d8-8384-37973785741b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "eaa83f10-5cad-4c71-96b9-528e45af44fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-drug-list'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-drug-list"
      
    
    ,
  
    max(
      
      case
      when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848'
        then answer_value_text
      else null
      end
    )
    
      
            as "abb64c97-d3a9-45a2-bec2-11f6c4dc8848"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a36058d0-3ac9-4cf6-aabb-6b4859dc985d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267'
        then answer_value_text
      else null
      end
    )
    
      
            as "b81b6e43-3b57-489e-8ea9-f35d82f9f267"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-opioid-dependence'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-opioid-dependence"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-low-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-low-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = 'score-audit'
        then answer_value_text
      else null
      end
    )
    
      
            as "score-audit"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-high-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-high-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11'
        then answer_value_text
      else null
      end
    )
    
      
            as "a713e390-f199-4ed4-9a27-b9938fbf8b11"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec346c72-9835-4b5a-8088-1797a200f995"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-medium-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-medium-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e'
        then answer_value_text
      else null
      end
    )
    
      
            as "232a2454-1d23-4ec9-b4ee-65e3a48afb3e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1d97a4-bb16-4c46-bcee-5593f472b53b"
      
    
    ,
  
    max(
      
      case
      when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "272246d4-b9c5-4a8b-a349-12f75cf888d0"
      
    
    ,
  
    max(
      
      case
      when linkid = '36af2335-ac86-4864-8a3d-619451160cc5'
        then answer_value_text
      else null
      end
    )
    
      
            as "36af2335-ac86-4864-8a3d-619451160cc5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ad8b269-9415-4551-8d00-9be8812bde01"
      
    
    ,
  
    max(
      
      case
      when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41'
        then answer_value_text
      else null
      end
    )
    
      
            as "49ee0853-7d07-40af-a139-7cacc302ee41"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c08dae42-df65-4dba-98c6-47f9e5dafcb0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c'
        then answer_value_text
      else null
      end
    )
    
      
            as "c6c7bd0c-812d-4931-b94c-929aa04dc45c"
      
    
    ,
  
    max(
      
      case
      when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e'
        then answer_value_text
      else null
      end
    )
    
      
            as "705b4c26-4479-4d6a-adbe-b8ebdbad302e"
      
    
    ,
  
    max(
      
      case
      when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b'
        then answer_value_text
      else null
      end
    )
    
      
            as "9dfe8a90-6551-4ae4-bcfb-c839e429a87b"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ee9b164-9830-4f7a-8317-28e0cfc1852c"
      
    
    ,
  
    max(
      
      case
      when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "1bc8823a-bbb1-444a-ad1b-dc09f57038ce"
      
    
    ,
  
    max(
      
      case
      when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5'
        then answer_value_text
      else null
      end
    )
    
      
            as "724d0558-550c-4edc-a1d6-3bd1285bc8a5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a"
      
    
    ,
  
    max(
      
      case
      when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e'
        then answer_value_text
      else null
      end
    )
    
      
            as "54f4cac5-ac52-4caa-a6b9-f8b4a412d92e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef06e3fc-45f0-40a3-aca9-43293339689b"
      
    
    ,
  
    max(
      
      case
      when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d'
        then answer_value_text
      else null
      end
    )
    
      
            as "859d58d6-ee56-4ede-9773-0b7650d7c66d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-things-to-do'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-things-to-do"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-goals'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-goals"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844'
        then answer_value_text
      else null
      end
    )
    
      
            as "da46a37c-1678-4f34-80b5-f69589bc8844"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88'
        then answer_value_text
      else null
      end
    )
    
      
            as "f53db683-31e1-4d83-82c4-7e3a02f9ee88"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-sbirt-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-sbirt-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7443184-d141-4bce-93fc-c393132c73b1"
      
    
    ,
  
    max(
      
      case
      when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a'
        then answer_value_text
      else null
      end
    )
    
      
            as "21a9c779-27be-4c08-b9ab-b0d84964145a"
      
    
    ,
  
    max(
      
      case
      when linkid = '654d5688-f42a-469b-8494-81115b760e29'
        then answer_value_text
      else null
      end
    )
    
      
            as "654d5688-f42a-469b-8494-81115b760e29"
      
    
    ,
  
    max(
      
      case
      when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "1eb189a2-2ae1-4a27-b4cf-9161447ff8b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6d0780b-f202-416d-8d9b-c418a4bdb5d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e'
        then answer_value_text
      else null
      end
    )
    
      
            as "c93222e9-84f3-44a3-a87d-d92dafdc558e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4bd2450-08cb-410f-8f81-743d84749347"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-intervention-when-medium-high-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-intervention-when-medium-high-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04'
        then answer_value_text
      else null
      end
    )
    
      
            as "893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb3e9da-948e-4d05-8cad-58d293f557f6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e06c266d-8bd5-4232-85dc-f61a9d33aff2"
      
    
    ,
  
    max(
      
      case
      when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef'
        then answer_value_text
      else null
      end
    )
    
      
            as "9724b66b-2162-4984-b352-0bc27bcfdfef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1'
        then answer_value_text
      else null
      end
    )
    
      
            as "fae920b4-84d9-4576-9fac-51cba163ffd1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9fc5555-b1e6-4251-8047-13162c0b0cca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5787dda-4b43-4ae0-8cea-3062732f5a9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509'
        then answer_value_text
      else null
      end
    )
    
      
            as "ebf2e364-e7d7-44ec-a463-757c8e24d509"
      
    
    ,
  
    max(
      
      case
      when linkid = 'health-goals-do-not-want-to-change'
        then answer_value_text
      else null
      end
    )
    
      
            as "health-goals-do-not-want-to-change"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-low-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-low-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e1d29fe-7774-4731-bf50-ce5faaf0a528"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9a44d1a-ecf7-43af-835c-f4b5f73828d3"
      
    
    ,
  
    max(
      
      case
      when linkid = '582271e0-892e-4795-ac55-0b73baf828ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "582271e0-892e-4795-ac55-0b73baf828ca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db'
        then answer_value_text
      else null
      end
    )
    
      
            as "da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db"
      
    
    ,
  
    max(
      
      case
      when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f'
        then answer_value_text
      else null
      end
    )
    
      
            as "380d715b-abd0-4808-9ec4-0a1aabf9a33f"
      
    
    ,
  
    max(
      
      case
      when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5'
        then answer_value_text
      else null
      end
    )
    
      
            as "386eb911-a4c5-4207-9dab-8d5973069ac5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-to-use-marijuana-or-other'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-to-use-marijuana-or-other"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-to-use-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-to-use-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '6281fa0d-ef3f-4013-bd31-062371828010'
        then answer_value_text
      else null
      end
    )
    
      
            as "6281fa0d-ef3f-4013-bd31-062371828010"
      
    
    ,
  
    max(
      
      case
      when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "0eb07ad0-c8fa-49b6-9c27-064d844b6c4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5fa54c70-1483-4dfa-92fc-22ec4d90593c"
      
    
    ,
  
    max(
      
      case
      when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb'
        then answer_value_text
      else null
      end
    )
    
      
            as "5de2f3d9-de95-4871-919e-a00bb4f346bb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa01eb31-553b-415c-bb90-1ec8d07e979e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b8c1391-ba62-4800-ab3d-287fd7a9a3a5"
      
    
    ,
  
    max(
      
      case
      when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1'
        then answer_value_text
      else null
      end
    )
    
      
            as "94dc51b7-59e3-4276-9afe-9b18cb7a08e1"
      
    
    ,
  
    max(
      
      case
      when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3'
        then answer_value_text
      else null
      end
    )
    
      
            as "7baaf5ce-f19b-4a40-980e-cfe53efac3f3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1d9ecfa-c456-4109-8807-b8e26ffb69aa"
      
    
    ,
  
    max(
      
      case
      when linkid = 'edced328-6f82-458a-bce4-35987bff19fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "edced328-6f82-458a-bce4-35987bff19fb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8'
        then answer_value_text
      else null
      end
    )
    
      
            as "a44b78b7-d5ab-49a8-958d-5545072692d8"
      
    
    ,
  
    max(
      
      case
      when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e'
        then answer_value_text
      else null
      end
    )
    
      
            as "642b120d-78f5-4ec6-9cbf-d3b9e336083e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041'
        then answer_value_text
      else null
      end
    )
    
      
            as "af4330a4-7bc7-48db-bce8-364b0ff4b041"
      
    
    ,
  
    max(
      
      case
      when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa'
        then answer_value_text
      else null
      end
    )
    
      
            as "2badbdc1-2d13-4368-b803-c2eb7a2647aa"
      
    
    ,
  
    max(
      
      case
      when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045'
        then answer_value_text
      else null
      end
    )
    
      
            as "590f26f6-d5e5-4b56-b3a8-415e038dc045"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "ba10b935-7861-4ce4-a2c6-88bdd97709fb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084'
        then answer_value_text
      else null
      end
    )
    
      
            as "fac09a6e-c280-426d-94a1-0aa707e35084"
      
    
    ,
  
    max(
      
      case
      when linkid = 'score-dast'
        then answer_value_text
      else null
      end
    )
    
      
            as "score-dast"
      
    
    ,
  
    max(
      
      case
      when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368'
        then answer_value_text
      else null
      end
    )
    
      
            as "9d8d7688-d1ed-4851-a6ea-59bc296f5368"
      
    
    ,
  
    max(
      
      case
      when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985'
        then answer_value_text
      else null
      end
    )
    
      
            as "818b51b8-c7b3-4d64-8142-1c0798662985"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3e99643-32dc-4e2e-983c-e694159623e3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'should-converse-about-substance-use'
        then answer_value_text
      else null
      end
    )
    
      
            as "should-converse-about-substance-use"
      
    
    ,
  
    max(
      
      case
      when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3'
        then answer_value_text
      else null
      end
    )
    
      
            as "43dead8d-380d-4214-80f1-a1961b916bd3"
      
    
    ,
  
    max(
      
      case
      when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96'
        then answer_value_text
      else null
      end
    )
    
      
            as "8bcb58a6-5720-4746-b0d0-22d6b6ec7c96"
      
    
    ,
  
    max(
      
      case
      when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848'
        then answer_value_text
      else null
      end
    )
    
      
            as "71679b91-ee7b-4eda-9f9d-cf85645ee848"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-intervention-when-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-intervention-when-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427"
      
    
    ,
  
    max(
      
      case
      when linkid = '8427af19-3bad-4713-bad9-b179437fef96'
        then answer_value_text
      else null
      end
    )
    
      
            as "8427af19-3bad-4713-bad9-b179437fef96"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8e7d8b0-88e2-4bae-8990-c3ae94165ef9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba'
        then answer_value_text
      else null
      end
    )
    
      
            as "fd89df57-4b13-432f-a5b9-d54918f8d4ba"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-high-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-high-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9'
        then answer_value_text
      else null
      end
    )
    
      
            as "15799969-7565-4c3e-b488-d6a65d66c6c9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4"
      
    
    ,
  
    max(
      
      case
      when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd'
        then answer_value_text
      else null
      end
    )
    
      
            as "9346e7e0-e74b-452a-addc-e6ad13d016dd"
      
    
    ,
  
    max(
      
      case
      when linkid = '90876967-c973-4bee-9217-8c7482cb12a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "90876967-c973-4bee-9217-8c7482cb12a2"
      
    
    ,
  
    max(
      
      case
      when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e2b0891-5355-4ffd-8a18-66193a0dbfbe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-summary-for-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-summary-for-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299'
        then answer_value_text
      else null
      end
    )
    
      
            as "c5437ab8-5d0c-4157-b06a-b5ec491dc299"
      
    
    ,
  
    max(
      
      case
      when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621'
        then answer_value_text
      else null
      end
    )
    
      
            as "67c70e9e-2e10-4d4a-b354-95621a05c621"
      
    
    ,
  
    max(
      
      case
      when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f'
        then answer_value_text
      else null
      end
    )
    
      
            as "49bafbbf-8110-46a0-83f4-802cb1b6fd0f"
      
    
    ,
  
    max(
      
      case
      when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069'
        then answer_value_text
      else null
      end
    )
    
      
            as "6f1dfe02-2dbb-4371-ab06-a8c915495069"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-client-use-with-other-drugs'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-client-use-with-other-drugs"
      
    
    ,
  
    max(
      
      case
      when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730'
        then answer_value_text
      else null
      end
    )
    
      
            as "445adcc0-9c5f-4647-b339-fcb5835f1730"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:43.673983 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:43.674501 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:43.676137 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:24:43.676858 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: COMMIT
[0m23:24:43.677076 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_tmp" rename to "qr_221"
[0m23:24:43.677273 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:24:43.677471 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: COMMIT
[0m23:24:43.678386 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:43.678679 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:43.679307 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: COMMIT
[0m23:24:43.680579 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_backup"
[0m23:24:43.680809 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:24:43.681070 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:24:43.681241 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: COMMIT
[0m23:24:43.681408 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_backup" cascade
[0m23:24:43.682169 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:43.682394 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:43.683139 [debug] [Thread-3 (]: On model.engage_analytics.qr_23451: Close
[0m23:24:43.683335 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:24:43.685303 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_backup"
[0m23:24:43.687046 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:24:43.687333 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba6d20>]}
[0m23:24:43.687654 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:24:43.687851 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_tmp" rename to "qr_212"
[0m23:24:43.688329 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_backup" cascade
[0m23:24:43.688181 [info ] [Thread-3 (]: 69 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_23451  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:43.688674 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_23451
[0m23:24:43.688866 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_55
[0m23:24:43.689287 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:43.689137 [info ] [Thread-3 (]: 71 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_55 ..... [RUN]
[0m23:24:43.690007 [debug] [Thread-2 (]: On model.engage_analytics.qr_221: Close
[0m23:24:43.690201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_23451, now model.engage_analytics.qr_55)
[0m23:24:43.690372 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:43.690552 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_55
[0m23:24:43.690836 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108928a40>]}
[0m23:24:43.691438 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: COMMIT
[0m23:24:43.693736 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:24:43.694238 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:24:43.694086 [info ] [Thread-2 (]: 68 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_221  [[32mCREATE VIEW[0m in 0.59s]
[0m23:24:43.694466 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:43.694643 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: COMMIT
[0m23:24:43.694878 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_221
[0m23:24:43.695039 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:43.695241 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_56
[0m23:24:43.695649 [info ] [Thread-2 (]: 72 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_56 ..... [RUN]
[0m23:24:43.695961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_221, now model.engage_analytics.qr_56)
[0m23:24:43.696245 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:43.696423 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_56
[0m23:24:43.697605 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_backup"
[0m23:24:43.699864 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:24:43.700169 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:24:43.700352 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:43.700531 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_backup" cascade
[0m23:24:43.700708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:43.701303 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:43.702134 [debug] [Thread-4 (]: On model.engage_analytics.qr_212: Close
[0m23:24:43.702504 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a15ca0>]}
[0m23:24:43.702868 [info ] [Thread-4 (]: 67 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_212  [[32mCREATE VIEW[0m in 0.60s]
[0m23:24:43.703143 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_212
[0m23:24:43.703336 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_57
[0m23:24:43.703654 [info ] [Thread-4 (]: 73 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_57 ..... [RUN]
[0m23:24:43.703964 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_212, now model.engage_analytics.qr_57)
[0m23:24:43.704145 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_57
[0m23:24:43.706664 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:24:43.706953 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:43.707216 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:44.207660 [debug] [Thread-1 (]: SQL status: SELECT 21 in 0.546 seconds
[0m23:24:44.212828 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_54"
[0m23:24:44.213454 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_54
[0m23:24:44.215398 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_54"
[0m23:24:44.216118 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:24:44.216326 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: BEGIN
[0m23:24:44.217179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:44.217394 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:24:44.217707 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 1) (id: ipc-54, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0'
        then answer_value_text
      else null
      end
    )
    
      
            as "0cfe26b9-8cd8-4d03-938f-991ebab4b3c0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5675128-0cd4-423f-840c-8dcff1e2a429"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a05b4fe-b514-4751-91be-adb1b278430c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-phq-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-phq-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:44.220551 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:44.222393 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:24:44.222660 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_tmp" rename to "qr_54"
[0m23:24:44.223561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:44.224257 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: COMMIT
[0m23:24:44.224447 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:24:44.224605 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: COMMIT
[0m23:24:44.225589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:44.227767 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_backup"
[0m23:24:44.228139 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:24:44.228322 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_backup" cascade
[0m23:24:44.229018 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:44.229734 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: Close
[0m23:24:44.230040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a50b90>]}
[0m23:24:44.230362 [info ] [Thread-1 (]: 70 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_54  [[32mCREATE VIEW[0m in 0.57s]
[0m23:24:44.230634 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_54
[0m23:24:44.230837 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_58
[0m23:24:44.231095 [info ] [Thread-1 (]: 74 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_58 ..... [RUN]
[0m23:24:44.231340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_54, now model.engage_analytics.qr_58)
[0m23:24:44.231513 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_58
[0m23:24:44.234016 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:24:44.234375 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.527 seconds
[0m23:24:44.234662 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:44.234886 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.534 seconds
[0m23:24:44.236823 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_57"
[0m23:24:44.237109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:44.238512 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_56"
[0m23:24:44.239066 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_57
[0m23:24:44.241233 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_57"
[0m23:24:44.241520 [debug] [Thread-3 (]: SQL status: SELECT 111 in 0.546 seconds
[0m23:24:44.245935 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_55"
[0m23:24:44.246392 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_56
[0m23:24:44.248580 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_56"
[0m23:24:44.248959 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:24:44.249170 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: BEGIN
[0m23:24:44.249413 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_55
[0m23:24:44.251736 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_55"
[0m23:24:44.252025 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m23:24:44.252297 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:24:44.252599 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:24:44.252808 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: BEGIN
[0m23:24:44.253114 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 2) (id: ipc-57, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "7239b680-ef7a-4f9f-87ff-a77bf21d96d4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172'
        then answer_value_text
      else null
      end
    )
    
      
            as "7afb89dc-d53b-4dc3-a185-43dbb4854172"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a07491bd-039d-417b-9caf-0af536316594'
        then answer_value_text
      else null
      end
    )
    
      
            as "a07491bd-039d-417b-9caf-0af536316594"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-phq-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-phq-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:44.253923 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:44.254132 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:24:44.254303 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:24:44.254473 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: BEGIN
[0m23:24:44.254797 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 2) (id: ipc-56, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4'
        then answer_value_text
      else null
      end
    )
    
      
            as "c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d'
        then answer_value_text
      else null
      end
    )
    
      
            as "dd349377-e542-4b4f-8fba-795f91431f7d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-ptsd-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-ptsd-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb'
        then answer_value_text
      else null
      end
    )
    
      
            as "9de6571c-3f74-4694-a567-ac5c897f96cb"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "931dc4ee-b677-4812-9372-3fea7012e9bc"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:44.255472 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:44.255633 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:24:44.256419 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 1 (id: ipc-55, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.73.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.73.2"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b0a751e-936e-40e8-9076-c7fe1e818c1f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.43.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.43.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '69125945-bec7-4810-985a-8c1052e8d039'
        then answer_value_text
      else null
      end
    )
    
      
            as "69125945-bec7-4810-985a-8c1052e8d039"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.88.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.88.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-012'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-012"
      
    
    ,
  
    max(
      
      case
      when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67'
        then answer_value_text
      else null
      end
    )
    
      
            as "47eaf38f-c74e-484a-af95-b0002074bf67"
      
    
    ,
  
    max(
      
      case
      when linkid = '16333904-aad5-4166-9593-b7286c7b20b2'
        then answer_value_text
      else null
      end
    )
    
      
            as "16333904-aad5-4166-9593-b7286c7b20b2"
      
    
    ,
  
    max(
      
      case
      when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727'
        then answer_value_text
      else null
      end
    )
    
      
            as "8085cded-8e0f-497f-9e3d-5fab3981d727"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.82.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.82.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204'
        then answer_value_text
      else null
      end
    )
    
      
            as "d126d866-b8c4-4288-84ff-49a40f20e204"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.87.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.87.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a88cb2bf-e23b-423b-9a22-ab94678ccc3a"
      
    
    ,
  
    max(
      
      case
      when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89'
        then answer_value_text
      else null
      end
    )
    
      
            as "31a9e716-52ce-4651-bb17-26f442e2ab89"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c'
        then answer_value_text
      else null
      end
    )
    
      
            as "1ae11d83-35d4-41c0-a804-5ddf6b1c388c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-008'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-008"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd69a7a1-ec17-4f43-8597-26c59732261b"
      
    
    ,
  
    max(
      
      case
      when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a'
        then answer_value_text
      else null
      end
    )
    
      
            as "13d72f63-dd18-41f9-bf46-44981f2f804a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.68.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.68.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.78.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.78.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.92.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.92.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-1"
      
    
    ,
  
    max(
      
      case
      when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "82cdd7f0-f3d1-4eba-a31e-c6ad367742f4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.2"
      
    
    ,
  
    max(
      
      case
      when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b'
        then answer_value_text
      else null
      end
    )
    
      
            as "0de42ce5-6d9f-40ec-b67b-3d3b975d363b"
      
    
    ,
  
    max(
      
      case
      when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "78bc8272-eba1-48a8-a2f4-0e47304887b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.81.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.81.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892'
        then answer_value_text
      else null
      end
    )
    
      
            as "b1b6bebb-0cb7-4029-b320-01d3270ee892"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '07b722c9-210e-491a-8933-2e9aab3474af'
        then answer_value_text
      else null
      end
    )
    
      
            as "07b722c9-210e-491a-8933-2e9aab3474af"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '1809cb03-235d-4855-b201-7b296b160e37'
        then answer_value_text
      else null
      end
    )
    
      
            as "1809cb03-235d-4855-b201-7b296b160e37"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-009'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-009"
      
    
    ,
  
    max(
      
      case
      when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "24f9ed3b-3706-43fb-9779-07a9c2077e9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523'
        then answer_value_text
      else null
      end
    )
    
      
            as "69ed5884-0814-4ae0-a7f1-ecf730710523"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123'
        then answer_value_text
      else null
      end
    )
    
      
            as "347d89f5-1bad-4ba5-8f45-e63972b02123"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d'
        then answer_value_text
      else null
      end
    )
    
      
            as "c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.11'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.11"
      
    
    ,
  
    max(
      
      case
      when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73'
        then answer_value_text
      else null
      end
    )
    
      
            as "798d2c43-5b9f-436f-9fa2-f360cbeeea73"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7b59772-0272-41f6-ba66-16b09a832fc1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.79.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.79.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.12'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.12"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037'
        then answer_value_text
      else null
      end
    )
    
      
            as "f11ace93-5d84-4cc5-8598-58f9c5623037"
      
    
    ,
  
    max(
      
      case
      when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690'
        then answer_value_text
      else null
      end
    )
    
      
            as "54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408'
        then answer_value_text
      else null
      end
    )
    
      
            as "19416221-7c67-44d7-9b9b-b88364ea7408"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf'
        then answer_value_text
      else null
      end
    )
    
      
            as "80344998-41e2-4669-a77e-1fdaebe88bcf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.89.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.89.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.38.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.38.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2629251-1266-4760-a539-f0e680df651b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2629251-1266-4760-a539-f0e680df651b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-010'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-010"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.72.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.72.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b'
        then answer_value_text
      else null
      end
    )
    
      
            as "b322e52d-99f3-48e0-bda0-09d95228ae7b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8bfb690-b135-4b0f-9291-f6247611ce52"
      
    
    ,
  
    max(
      
      case
      when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5e65c0dc-5524-4f3d-8404-a7427a34e61c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "d58c8907-06c6-4071-aa6c-b2b95d2169c7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685'
        then answer_value_text
      else null
      end
    )
    
      
            as "0627ed93-c89d-48ae-bde2-bd013dc58685"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.38.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.38.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655'
        then answer_value_text
      else null
      end
    )
    
      
            as "d6c7419a-9082-4579-8678-44e866ab3655"
      
    
    ,
  
    max(
      
      case
      when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface'
        then answer_value_text
      else null
      end
    )
    
      
            as "528fa2c7-7a88-4d4e-b2ba-38c1384aface"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.9'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.74.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.74.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe689023-f019-483b-ba7c-8ff0e16129d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '042e5415-93de-419d-9bac-632596939280'
        then answer_value_text
      else null
      end
    )
    
      
            as "042e5415-93de-419d-9bac-632596939280"
      
    
    ,
  
    max(
      
      case
      when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b'
        then answer_value_text
      else null
      end
    )
    
      
            as "37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.42.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.42.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd785881-7e04-4093-b191-d845edea4c9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.46.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.46.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd'
        then answer_value_text
      else null
      end
    )
    
      
            as "5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd"
      
    
    ,
  
    max(
      
      case
      when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801'
        then answer_value_text
      else null
      end
    )
    
      
            as "10151d1b-3cd2-4f10-b1e5-d6b20112d801"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a8b5e1e-fa6b-472b-ade7-ee8f5286a759"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a2ac26a-8d30-4c28-be11-f684f415f661"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.70.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.70.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.5'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.81.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.81.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d'
        then answer_value_text
      else null
      end
    )
    
      
            as "6409c231-50c1-45fc-808e-f0bd015db97d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.69.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.69.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.8'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.8"
      
    
    ,
  
    max(
      
      case
      when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92'
        then answer_value_text
      else null
      end
    )
    
      
            as "6099951a-c965-40f9-ad61-66e7a39a6b92"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.76.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.76.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.69.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.69.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45'
        then answer_value_text
      else null
      end
    )
    
      
            as "acd9d89b-0d67-415e-a3a4-b132ab304c45"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.79.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.79.2"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:44.257290 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:44.259010 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:24:44.259216 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_tmp" rename to "qr_57"
[0m23:24:44.259485 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:44.261142 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:24:44.261328 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_tmp" rename to "qr_56"
[0m23:24:44.261499 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:44.262126 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: COMMIT
[0m23:24:44.262326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:44.262513 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:24:44.263068 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: COMMIT
[0m23:24:44.263248 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:24:44.263402 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: COMMIT
[0m23:24:44.263564 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:24:44.264906 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:24:44.265145 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: COMMIT
[0m23:24:44.265392 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_tmp" rename to "qr_55"
[0m23:24:44.266018 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:44.267120 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_backup"
[0m23:24:44.267303 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:44.267469 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:24:44.267774 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:24:44.268459 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: COMMIT
[0m23:24:44.269497 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_backup"
[0m23:24:44.269682 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_backup" cascade
[0m23:24:44.269857 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:24:44.270093 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:24:44.270276 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: COMMIT
[0m23:24:44.270451 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_backup" cascade
[0m23:24:44.270635 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:44.271301 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: Close
[0m23:24:44.271510 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:44.271723 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:44.272332 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: Close
[0m23:24:44.273407 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_backup"
[0m23:24:44.273658 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103efb0b0>]}
[0m23:24:44.273949 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:24:44.274158 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108740d40>]}
[0m23:24:44.274631 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_backup" cascade
[0m23:24:44.274479 [info ] [Thread-4 (]: 73 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_57  [[32mCREATE VIEW[0m in 0.57s]
[0m23:24:44.274938 [info ] [Thread-2 (]: 72 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_56  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:44.275386 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_57
[0m23:24:44.275649 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:44.275894 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_56
[0m23:24:44.276144 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_59
[0m23:24:44.276912 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: Close
[0m23:24:44.277160 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_60
[0m23:24:44.277448 [info ] [Thread-4 (]: 75 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_59 ..... [RUN]
[0m23:24:44.277802 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104031550>]}
[0m23:24:44.278286 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_57, now model.engage_analytics.qr_59)
[0m23:24:44.278067 [info ] [Thread-2 (]: 76 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_60 ..... [RUN]
[0m23:24:44.278673 [info ] [Thread-3 (]: 71 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_55  [[32mCREATE VIEW[0m in 0.59s]
[0m23:24:44.278876 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_59
[0m23:24:44.279058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_56, now model.engage_analytics.qr_60)
[0m23:24:44.279348 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_55
[0m23:24:44.281629 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:24:44.281841 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_60
[0m23:24:44.282100 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_61
[0m23:24:44.282349 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:44.284803 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:24:44.285159 [info ] [Thread-3 (]: 77 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_61 ..... [RUN]
[0m23:24:44.285389 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:44.285624 [debug] [Thread-2 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:44.285859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_55, now model.engage_analytics.qr_61)
[0m23:24:44.286164 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:44.286380 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_61
[0m23:24:44.290007 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:24:44.290263 [debug] [Thread-3 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:44.290432 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:44.824097 [debug] [Thread-1 (]: SQL status: SELECT 91 in 0.587 seconds
[0m23:24:44.829670 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_58"
[0m23:24:44.831520 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_58
[0m23:24:44.833586 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_58"
[0m23:24:44.834432 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:24:44.834680 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: BEGIN
[0m23:24:44.835741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:44.835980 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:24:44.836723 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 2 (id: ipc-58, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '6930d457-7bec-4983-832b-3220b163f505'
        then answer_value_text
      else null
      end
    )
    
      
            as "6930d457-7bec-4983-832b-3220b163f505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9543e3c-cbff-4d2a-b3df-bf96e509d9ca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-015'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-015"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ed77f2a-0d5a-434d-b153-d8deadfbc3f8"
      
    
    ,
  
    max(
      
      case
      when linkid = '62cd085f-52d4-44de-881c-93058f201559'
        then answer_value_text
      else null
      end
    )
    
      
            as "62cd085f-52d4-44de-881c-93058f201559"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840'
        then answer_value_text
      else null
      end
    )
    
      
            as "a4a9cad5-04db-44e5-9a9d-0f1bf40ca840"
      
    
    ,
  
    max(
      
      case
      when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "0a15f38b-027a-42ff-b1e8-ca5e2b313f71"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1755ad4-b33a-44a3-b562-4206a582c28a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51'
        then answer_value_text
      else null
      end
    )
    
      
            as "301ae5ab-7dac-4414-a80a-f8784ba6bf51"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10'
        then answer_value_text
      else null
      end
    )
    
      
            as "d8eb3c09-b97d-4d55-9590-e6ce932a7a10"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "a9314459-f6d9-4ebb-84e7-f1a1968cfd7c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e17756cd-4861-4dde-859c-f90241977246'
        then answer_value_text
      else null
      end
    )
    
      
            as "e17756cd-4861-4dde-859c-f90241977246"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083'
        then answer_value_text
      else null
      end
    )
    
      
            as "f39b0b39-2058-4c29-a183-aac5dc70e083"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-016'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-016"
      
    
    ,
  
    max(
      
      case
      when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875'
        then answer_value_text
      else null
      end
    )
    
      
            as "9eac8fed-4265-447f-bbde-0986c34f3875"
      
    
    ,
  
    max(
      
      case
      when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263'
        then answer_value_text
      else null
      end
    )
    
      
            as "86bdafab-bb90-429e-8bc5-a90dc46e7263"
      
    
    ,
  
    max(
      
      case
      when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73'
        then answer_value_text
      else null
      end
    )
    
      
            as "747188c8-4fc0-43ea-92b4-9baa32567f73"
      
    
    ,
  
    max(
      
      case
      when linkid = '547a07c2-f94c-4956-997f-0439626d0251'
        then answer_value_text
      else null
      end
    )
    
      
            as "547a07c2-f94c-4956-997f-0439626d0251"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c"
      
    
    ,
  
    max(
      
      case
      when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740'
        then answer_value_text
      else null
      end
    )
    
      
            as "2a5d7010-a84b-414c-adcb-ad0f49a95740"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-013'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-013"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ff4b5cb-2c44-434b-90e9-85c61a858097"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef"
      
    
    ,
  
    max(
      
      case
      when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414'
        then answer_value_text
      else null
      end
    )
    
      
            as "83176bb3-c0cb-445a-a91b-6711635b1414"
      
    
    ,
  
    max(
      
      case
      when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90'
        then answer_value_text
      else null
      end
    )
    
      
            as "10cd5560-6c41-41a6-94c5-af74ce96dc90"
      
    
    ,
  
    max(
      
      case
      when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07'
        then answer_value_text
      else null
      end
    )
    
      
            as "85a3f14c-e4d8-4c45-9088-967ec4ea0d07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb8828db-1674-47e7-ba9a-e3c161160b65"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f63637c-1de2-4851-a088-c3b08152447e'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f63637c-1de2-4851-a088-c3b08152447e"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b80fd6e-3e52-4d1f-aa19-bbfdd912d724"
      
    
    ,
  
    max(
      
      case
      when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3'
        then answer_value_text
      else null
      end
    )
    
      
            as "0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44'
        then answer_value_text
      else null
      end
    )
    
      
            as "eea0b1ca-5582-4b45-b5cf-36bc0665ba44"
      
    
    ,
  
    max(
      
      case
      when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3'
        then answer_value_text
      else null
      end
    )
    
      
            as "94e90f68-ea59-4837-b0ad-452f5f0336c3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac0ade27-9e9a-42a9-8ec6-4e7e79830299"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e0b76f9-0902-43ba-b858-0b1505e9d168"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359'
        then answer_value_text
      else null
      end
    )
    
      
            as "e245b7d9-955a-4c4b-a107-e2bf5d6d2359"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a77f07b3-7913-4708-a354-14e503a948f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "5817d327-373e-4fc0-9bac-b64e408b0e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260'
        then answer_value_text
      else null
      end
    )
    
      
            as "52f7924d-1c66-4049-8611-26d4e7bcb260"
      
    
    ,
  
    max(
      
      case
      when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3'
        then answer_value_text
      else null
      end
    )
    
      
            as "50cf6a9c-a837-4531-a13a-47381657c2b3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "c91209cc-1b2c-43f0-83f0-4704418ae2d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '044d9000-1935-4b35-9947-d668de09f10b'
        then answer_value_text
      else null
      end
    )
    
      
            as "044d9000-1935-4b35-9947-d668de09f10b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc8f199a-59f0-4184-864d-b1c0befd26df"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c95559d-86ff-4b87-a271-e52388072a53'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c95559d-86ff-4b87-a271-e52388072a53"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444'
        then answer_value_text
      else null
      end
    )
    
      
            as "e73f462c-e543-4a3d-849d-dbedcb831444"
      
    
    ,
  
    max(
      
      case
      when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a'
        then answer_value_text
      else null
      end
    )
    
      
            as "63ac8d07-518c-4791-849a-a9e2c282ce9a"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cc2834b-0d28-43d0-8811-509995cfcdb8"
      
    
    ,
  
    max(
      
      case
      when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c'
        then answer_value_text
      else null
      end
    )
    
      
            as "2efaba4d-f5af-45f3-9340-1ba9b3fffc1c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-018'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-018"
      
    
    ,
  
    max(
      
      case
      when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f"
      
    
    ,
  
    max(
      
      case
      when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8'
        then answer_value_text
      else null
      end
    )
    
      
            as "126c7309-8143-4c33-857f-41cc6bed09d8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-014'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-014"
      
    
    ,
  
    max(
      
      case
      when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03'
        then answer_value_text
      else null
      end
    )
    
      
            as "5d0b76c5-a416-45a4-a8fc-9889ea840a03"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7f10195-b859-4670-abbc-a2498c4fe45f"
      
    
    ,
  
    max(
      
      case
      when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a'
        then answer_value_text
      else null
      end
    )
    
      
            as "232484cf-1aee-4bfa-a66e-61494587a16a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "96171fdd-a424-4c09-91e8-31986ac315f7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bed17079-d1e5-4bbe-af07-3d7b6a86243e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '665e1595-f169-4815-9d24-dac265f1809b'
        then answer_value_text
      else null
      end
    )
    
      
            as "665e1595-f169-4815-9d24-dac265f1809b"
      
    
    ,
  
    max(
      
      case
      when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21'
        then answer_value_text
      else null
      end
    )
    
      
            as "99079ebd-1665-4503-bb37-8de493dd4a21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ecd82c04-48de-48ec-8efe-24cbe04cbe4b"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ff6f541-cb58-48d3-b7eb-24ab667f0a94"
      
    
    ,
  
    max(
      
      case
      when linkid = '287593c3-4174-45af-a998-71d249230943'
        then answer_value_text
      else null
      end
    )
    
      
            as "287593c3-4174-45af-a998-71d249230943"
      
    
    ,
  
    max(
      
      case
      when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc'
        then answer_value_text
      else null
      end
    )
    
      
            as "62c9e3f2-30aa-46b0-9190-aa36a1804fdc"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f9608db-8796-4f45-89b7-741585b8a362'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f9608db-8796-4f45-89b7-741585b8a362"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f82f76f4-648a-453a-916d-28795448a758'
        then answer_value_text
      else null
      end
    )
    
      
            as "f82f76f4-648a-453a-916d-28795448a758"
      
    
    ,
  
    max(
      
      case
      when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a'
        then answer_value_text
      else null
      end
    )
    
      
            as "2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb0c7a5-a211-43ec-af7b-5f1079399133"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c0d6638-9b65-4016-b3f0-4008f8e462c2"
      
    
    ,
  
    max(
      
      case
      when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92'
        then answer_value_text
      else null
      end
    )
    
      
            as "6099951a-c965-40f9-ad61-66e7a39a6b92"
      
    
    ,
  
    max(
      
      case
      when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00'
        then answer_value_text
      else null
      end
    )
    
      
            as "0984569b-3fd6-4c4e-a391-e68e73b46f00"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c9f8c1d-5827-4d21-bd33-3240fade93ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6befba3-6d25-47ae-9cac-409dfae832a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93'
        then answer_value_text
      else null
      end
    )
    
      
            as "b93eafea-8b01-4b21-994b-c45113622a93"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92'
        then answer_value_text
      else null
      end
    )
    
      
            as "b31c0187-3e54-4fcf-9763-8b3f3850be92"
      
    
    ,
  
    max(
      
      case
      when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54'
        then answer_value_text
      else null
      end
    )
    
      
            as "3abecf2a-c87b-4fad-96eb-e9abc37e9c54"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:44.848524 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:24:44.850301 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:24:44.850494 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_tmp" rename to "qr_58"
[0m23:24:44.852785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:44.853659 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: COMMIT
[0m23:24:44.853864 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:24:44.854027 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: COMMIT
[0m23:24:44.855455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:44.856658 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_backup"
[0m23:24:44.856931 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:24:44.857102 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_backup" cascade
[0m23:24:44.857831 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:44.858643 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: Close
[0m23:24:44.858993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a616d0>]}
[0m23:24:44.859399 [info ] [Thread-1 (]: 74 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_58  [[32mCREATE VIEW[0m in 0.63s]
[0m23:24:44.859676 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_58
[0m23:24:44.859868 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_62
[0m23:24:44.860397 [info ] [Thread-1 (]: 78 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_62 ..... [RUN]
[0m23:24:44.860780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_58, now model.engage_analytics.qr_62)
[0m23:24:44.860965 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_62
[0m23:24:44.863325 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:24:44.863620 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.578 seconds
[0m23:24:44.863876 [debug] [Thread-2 (]: SQL status: SELECT 21 in 0.578 seconds
[0m23:24:44.864104 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:44.864269 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.574 seconds
[0m23:24:44.865488 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_59"
[0m23:24:44.866862 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_60"
[0m23:24:44.867163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:44.868405 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_61"
[0m23:24:44.869065 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_59
[0m23:24:44.871925 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_59"
[0m23:24:44.872305 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_61
[0m23:24:44.872495 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_60
[0m23:24:44.874224 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_61"
[0m23:24:44.874454 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:24:44.876251 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_60"
[0m23:24:44.876512 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: BEGIN
[0m23:24:44.876889 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:24:44.877143 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:44.877370 [debug] [Thread-3 (]: On model.engage_analytics.qr_61: BEGIN
[0m23:24:44.877606 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:24:44.877785 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:24:44.878018 [debug] [Thread-2 (]: On model.engage_analytics.qr_60: BEGIN
[0m23:24:44.878350 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 3) (id: ipc-59, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402'
        then answer_value_text
      else null
      end
    )
    
      
            as "d34c5839-fad9-4824-b2dc-9e0161647402"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = '534c4998-b964-4101-b919-ff3c26af9714'
        then answer_value_text
      else null
      end
    )
    
      
            as "534c4998-b964-4101-b919-ff3c26af9714"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:44.878704 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:44.878978 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:24:44.879262 [debug] [Thread-3 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 3) (id: ipc-61, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1'
        then answer_value_text
      else null
      end
    )
    
      
            as "45f52042-6802-4d9c-9f86-6578923d0fd1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9'
        then answer_value_text
      else null
      end
    )
    
      
            as "4650a511-2184-4b0b-9e43-54f45f4340a9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e'
        then answer_value_text
      else null
      end
    )
    
      
            as "55d78cf4-0963-4c44-af44-6004a8abbb3e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:44.879537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:44.879729 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:24:44.880052 [debug] [Thread-2 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 3) (id: ipc-60, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d'
        then answer_value_text
      else null
      end
    )
    
      
            as "cbad1c80-ab95-4720-ba6a-0eadd718905d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4c58005-803f-4bc3-adaa-1f84c5824b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49'
        then answer_value_text
      else null
      end
    )
    
      
            as "a51fba17-fccd-4b65-ada3-5c50a75e5d49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5002611-caf9-4792-8d10-e7870459ea17"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:44.881264 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:44.882976 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:24:44.883215 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:44.883435 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_tmp" rename to "qr_59"
[0m23:24:44.883616 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:44.885230 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:24:44.886703 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:24:44.886889 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:44.887053 [debug] [Thread-3 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_tmp" rename to "qr_61"
[0m23:24:44.887238 [debug] [Thread-2 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_tmp" rename to "qr_60"
[0m23:24:44.887869 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: COMMIT
[0m23:24:44.888092 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:24:44.888249 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: COMMIT
[0m23:24:44.888636 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:44.888812 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:44.889365 [debug] [Thread-3 (]: On model.engage_analytics.qr_61: COMMIT
[0m23:24:44.889540 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:44.890076 [debug] [Thread-2 (]: On model.engage_analytics.qr_60: COMMIT
[0m23:24:44.890257 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:24:44.891317 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_backup"
[0m23:24:44.891503 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:24:44.891672 [debug] [Thread-3 (]: On model.engage_analytics.qr_61: COMMIT
[0m23:24:44.891919 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:24:44.892074 [debug] [Thread-2 (]: On model.engage_analytics.qr_60: COMMIT
[0m23:24:44.892245 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_backup" cascade
[0m23:24:44.892830 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:44.893094 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:44.893269 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:44.894268 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_backup"
[0m23:24:44.896024 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_backup"
[0m23:24:44.896820 [debug] [Thread-4 (]: On model.engage_analytics.qr_59: Close
[0m23:24:44.897188 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:24:44.897502 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:24:44.897762 [debug] [Thread-3 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_backup" cascade
[0m23:24:44.898122 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b36810>]}
[0m23:24:44.898325 [debug] [Thread-2 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_backup" cascade
[0m23:24:44.898802 [info ] [Thread-4 (]: 75 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_59  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:44.899093 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:44.899370 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_59
[0m23:24:44.899569 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:44.900337 [debug] [Thread-3 (]: On model.engage_analytics.qr_61: Close
[0m23:24:44.900574 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_63
[0m23:24:44.901309 [debug] [Thread-2 (]: On model.engage_analytics.qr_60: Close
[0m23:24:44.901607 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c35400>]}
[0m23:24:44.901877 [info ] [Thread-4 (]: 79 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_63 ..... [RUN]
[0m23:24:44.902230 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5d1c0>]}
[0m23:24:44.902588 [info ] [Thread-3 (]: 77 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_61  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:44.902884 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_59, now model.engage_analytics.qr_63)
[0m23:24:44.903197 [info ] [Thread-2 (]: 76 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_60  [[32mCREATE VIEW[0m in 0.62s]
[0m23:24:44.903485 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_61
[0m23:24:44.903731 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_63
[0m23:24:44.904056 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_60
[0m23:24:44.904472 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_69
[0m23:24:44.907015 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:24:44.907290 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:24:44.907506 [info ] [Thread-3 (]: 80 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_69 ..... [RUN]
[0m23:24:44.907746 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:44.907982 [info ] [Thread-2 (]: 81 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_q_common_mental_health_symptoms  [RUN]
[0m23:24:44.908192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_61, now model.engage_analytics.qr_69)
[0m23:24:44.908356 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:44.908524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_60, now model.engage_analytics.qr_q_common_mental_health_symptoms)
[0m23:24:44.908684 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_69
[0m23:24:44.909089 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:24:44.911425 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:24:44.913513 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:44.913773 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:44.914000 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:44.914170 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:44.914323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:24:45.434046 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.567 seconds
[0m23:24:45.435389 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_62"
[0m23:24:45.435893 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_62
[0m23:24:45.437772 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_62"
[0m23:24:45.438095 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:24:45.438254 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: BEGIN
[0m23:24:45.439031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:45.439308 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:24:45.439567 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 4) (id: ipc-62, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e626219-c0e4-465e-92e6-9e976c52614c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4155e07-1d18-448f-8111-182bf4149672'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4155e07-1d18-448f-8111-182bf4149672"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:45.442163 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:24:45.443827 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:24:45.444035 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_tmp" rename to "qr_62"
[0m23:24:45.445257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:45.446002 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: COMMIT
[0m23:24:45.446210 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:24:45.446379 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: COMMIT
[0m23:24:45.447670 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:45.448940 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_backup"
[0m23:24:45.449241 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:24:45.449413 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_backup" cascade
[0m23:24:45.450275 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:45.451107 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: Close
[0m23:24:45.451449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2ffb0>]}
[0m23:24:45.451783 [info ] [Thread-1 (]: 78 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_62  [[32mCREATE VIEW[0m in 0.59s]
[0m23:24:45.452047 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_62
[0m23:24:45.452287 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.538 seconds
[0m23:24:45.452564 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:24:45.453843 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_69"
[0m23:24:45.454120 [info ] [Thread-1 (]: 82 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_q_financial_wellness_tool  [RUN]
[0m23:24:45.454449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_62, now model.engage_analytics.qr_q_financial_wellness_tool)
[0m23:24:45.454663 [debug] [Thread-2 (]: SQL status: SELECT 36 in 0.540 seconds
[0m23:24:45.454862 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.546 seconds
[0m23:24:45.455074 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:24:45.456964 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:45.459812 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_63"
[0m23:24:45.462072 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:45.462302 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_69
[0m23:24:45.462656 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:45.464863 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_69"
[0m23:24:45.465159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:45.465402 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_63
[0m23:24:45.465615 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:24:45.467815 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_63"
[0m23:24:45.469997 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:45.470291 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:24:45.470618 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: BEGIN
[0m23:24:45.471449 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:45.471699 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:24:45.471963 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:24:45.472228 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:45.472538 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- eCBIS Remove Family Form (id: ipc-69, url: n/a, version: 0.0.2)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f'
        then answer_value_text
      else null
      end
    )
    
      
            as "17b7fda5-514c-4408-88e7-52313ab0ef2f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-birthdate'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-birthdate"
      
    
    ,
  
    max(
      
      case
      when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "98ac4694-590e-4cc2-83f3-cc6455e688c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a'
        then answer_value_text
      else null
      end
    )
    
      
            as "8489d249-1ef3-4edb-aa99-b5713fd2cb0a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd73cfdf-6d70-4b42-8887-21e27db0b9ec"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff'
        then answer_value_text
      else null
      end
    )
    
      
            as "f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1'
        then answer_value_text
      else null
      end
    )
    
      
            as "b6c21488-87b8-4213-8cd0-d482367669c1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:45.472902 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: BEGIN
[0m23:24:45.473089 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: BEGIN
[0m23:24:45.473774 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:45.474015 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:45.474217 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:45.474419 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:24:45.474857 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Common Mental Health Symptoms (id: q-common-mental-health-symptoms, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879"
      
    
    ,
  
    max(
      
      case
      when linkid = '16d05294-fee9-4d42-8447-0d578a5de192'
        then answer_value_text
      else null
      end
    )
    
      
            as "16d05294-fee9-4d42-8447-0d578a5de192"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603'
        then answer_value_text
      else null
      end
    )
    
      
            as "829e6d32-3fa7-4d16-909b-b198aea54603"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-common-mental-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-common-mental-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "583c5b02-b26c-4821-8da8-7ed9066d9d5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a05b4fe-b514-4751-91be-adb1b278430c"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-pcl-5-to-8-questions'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-pcl-5-to-8-questions"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:45.475597 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 4 (id: ipc-63, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-connected-to-clinical-care-details'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-connected-to-clinical-care-details"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-connected-to-clinical-care-question'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-connected-to-clinical-care-question"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de'
        then answer_value_text
      else null
      end
    )
    
      
            as "b46d08e9-6af9-47be-a09a-afd0cfdf41de"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b12311e-d9a3-40b4-bb18-5cc6135a3850"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa8d0648-9550-489a-9543-4f00d43ba1fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490'
        then answer_value_text
      else null
      end
    )
    
      
            as "e67ca22d-e803-4790-bbce-126f2c863490"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "cb8337b0-c822-4374-895b-ee875da4d7f6"
      
    
    ,
  
    max(
      
      case
      when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "978ba6cf-b149-49e2-89c3-89a0e18461bc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588'
        then answer_value_text
      else null
      end
    )
    
      
            as "4602f806-3bf4-4f16-bee1-c2e690dca588"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b'
        then answer_value_text
      else null
      end
    )
    
      
            as "a3831bfc-0175-4e5a-8d8d-7313c7f2b69b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6'
        then answer_value_text
      else null
      end
    )
    
      
            as "a8c2cacf-7ee5-4076-af42-19d0eba0e6d6"
      
    
    ,
  
    max(
      
      case
      when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef'
        then answer_value_text
      else null
      end
    )
    
      
            as "3ce3bf84-176e-40bc-8075-1517a03c6bef"
      
    
    ,
  
    max(
      
      case
      when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "39dfd1f4-01db-4057-9734-4f2fbd83b8fe"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e7579d-ac74-4d72-955b-1a3675a2e656"
      
    
    ,
  
    max(
      
      case
      when linkid = '749d2a97-4195-4516-8079-60638a4d9e82'
        then answer_value_text
      else null
      end
    )
    
      
            as "749d2a97-4195-4516-8079-60638a4d9e82"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc'
        then answer_value_text
      else null
      end
    )
    
      
            as "ca41ccab-5f0b-4538-b394-ad342a0b5bdc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c457ea8-c60d-49f7-b166-ebabf737ab22"
      
    
    ,
  
    max(
      
      case
      when linkid = '7db481df-19e5-400c-a206-4811b39485d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "7db481df-19e5-400c-a206-4811b39485d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99'
        then answer_value_text
      else null
      end
    )
    
      
            as "936d5c53-d176-4c63-9a3a-e9e7f9db3f99"
      
    
    ,
  
    max(
      
      case
      when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f'
        then answer_value_text
      else null
      end
    )
    
      
            as "19dd65c2-8709-4745-81f2-4d4843c4307f"
      
    
    ,
  
    max(
      
      case
      when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318'
        then answer_value_text
      else null
      end
    )
    
      
            as "7fef53bc-56db-47ce-8cba-8efd4bcbc318"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a302513b-141a-4316-9546-d013212a361e'
        then answer_value_text
      else null
      end
    )
    
      
            as "a302513b-141a-4316-9546-d013212a361e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "6d9345d7-61a0-425b-8496-8b08d68175d0"
      
    
    ,
  
    max(
      
      case
      when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74'
        then answer_value_text
      else null
      end
    )
    
      
            as "49a270cd-b72b-42a6-92e3-c139f7a85d74"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036'
        then answer_value_text
      else null
      end
    )
    
      
            as "dd000285-7c36-44b4-82e6-4e8826665036"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b65857a-5c04-4414-833d-10602f04d299'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b65857a-5c04-4414-833d-10602f04d299"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec39511c-de47-469d-ac44-973e3fc08532"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa30ce6c-4153-46d8-a4af-83012eafa23d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19'
        then answer_value_text
      else null
      end
    )
    
      
            as "9b602b02-e5f9-4795-9fb9-fc7ae4353a19"
      
    
    ,
  
    max(
      
      case
      when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7'
        then answer_value_text
      else null
      end
    )
    
      
            as "83a63af9-6f49-4fad-bca9-80776fc97be7"
      
    
    ,
  
    max(
      
      case
      when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de'
        then answer_value_text
      else null
      end
    )
    
      
            as "9a02423f-9848-4254-b427-3dfa8819d0de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824'
        then answer_value_text
      else null
      end
    )
    
      
            as "05617430-b835-4ebd-8d6a-ff58ef6d2824"
      
    
    ,
  
    max(
      
      case
      when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "9848888d-1ec0-4d43-b53f-7613ba5144fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e9014d1-e07c-492e-897a-3bf7e8f6f018"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:45.476188 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:45.478089 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:24:45.478301 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_tmp" rename to "qr_69"
[0m23:24:45.479256 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:45.480050 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: COMMIT
[0m23:24:45.480261 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:45.480464 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:45.480675 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:24:45.482267 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:24:45.483694 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:45.483950 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: COMMIT
[0m23:24:45.484136 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_tmp" rename to "qr_63"
[0m23:24:45.484338 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_tmp" rename to "qr_q_common_mental_health_symptoms"
[0m23:24:45.485408 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:45.485613 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:45.486844 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_backup"
[0m23:24:45.487051 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:24:45.487695 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: COMMIT
[0m23:24:45.487958 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:24:45.488542 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: COMMIT
[0m23:24:45.488717 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:24:45.488890 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_backup" cascade
[0m23:24:45.489063 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:45.489213 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: COMMIT
[0m23:24:45.489387 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: COMMIT
[0m23:24:45.489730 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:45.490499 [debug] [Thread-3 (]: On model.engage_analytics.qr_69: Close
[0m23:24:45.490705 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:45.490898 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:45.491173 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892e660>]}
[0m23:24:45.493365 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_backup"
[0m23:24:45.494577 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_backup"
[0m23:24:45.495276 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:24:45.494975 [info ] [Thread-3 (]: 80 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_69  [[32mCREATE VIEW[0m in 0.58s]
[0m23:24:45.495614 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:24:45.495805 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_backup" cascade
[0m23:24:45.496061 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_69
[0m23:24:45.496240 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_backup" cascade
[0m23:24:45.496463 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_q_planning_next_steps
[0m23:24:45.496919 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:24:45.497091 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:45.497797 [debug] [Thread-4 (]: On model.engage_analytics.qr_63: Close
[0m23:24:45.496767 [info ] [Thread-3 (]: 83 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_q_planning_next_steps  [RUN]
[0m23:24:45.498536 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: Close
[0m23:24:45.498860 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c42f0>]}
[0m23:24:45.499121 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_69, now model.engage_analytics.qr_q_planning_next_steps)
[0m23:24:45.499479 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e7140>]}
[0m23:24:45.499763 [info ] [Thread-4 (]: 79 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_63  [[32mCREATE VIEW[0m in 0.60s]
[0m23:24:45.499961 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_q_planning_next_steps
[0m23:24:45.500238 [info ] [Thread-2 (]: 81 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 0.59s]
[0m23:24:45.500495 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_63
[0m23:24:45.502778 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:45.503086 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:24:45.503277 [debug] [Thread-4 (]: Began running node model.engage_analytics.practitioners
[0m23:24:45.503451 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:24:45.503891 [info ] [Thread-4 (]: 84 of 84 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m23:24:45.504279 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:24:45.504518 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_63, now model.engage_analytics.practitioners)
[0m23:24:45.504855 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.practitioners
[0m23:24:45.507252 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.507550 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m23:24:45.507734 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:24:45.516791 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.009 seconds
[0m23:24:45.517817 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.518023 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m23:24:45.518568 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.000 seconds
[0m23:24:45.519500 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m23:24:45.519916 [debug] [Thread-4 (]: Began executing node model.engage_analytics.practitioners
[0m23:24:45.522374 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.522660 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    
  
    

  create temporary table "practitioners__dbt_tmp232445521217"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

where p._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
)

  );
  
  
[0m23:24:45.524991 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:24:45.526705 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.526949 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: BEGIN
[0m23:24:45.527561 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:45.527822 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.528002 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioners__dbt_tmp232445521217'
        
      order by ordinal_position

  
[0m23:24:45.531617 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.003 seconds
[0m23:24:45.533323 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.533546 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:45.535494 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:24:45.537103 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.537309 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:24:45.539246 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:24:45.540249 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m23:24:45.540711 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.540889 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioners__dbt_tmp232445521217" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" ("id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role")
    (
        select "id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role"
        from "practitioners__dbt_tmp232445521217"
    )
  
[0m23:24:45.541578 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:24:45.542128 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: COMMIT
[0m23:24:45.542286 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:24:45.542422 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: COMMIT
[0m23:24:45.543250 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:45.543733 [debug] [Thread-4 (]: On model.engage_analytics.practitioners: Close
[0m23:24:45.544033 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa8830>]}
[0m23:24:45.544344 [info ] [Thread-4 (]: 84 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mINSERT 0 0[0m in 0.04s]
[0m23:24:45.544692 [debug] [Thread-4 (]: Finished running node model.engage_analytics.practitioners
[0m23:24:45.999114 [debug] [Thread-1 (]: SQL status: SELECT 23 in 0.534 seconds
[0m23:24:46.003833 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:46.004478 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:24:46.007647 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:46.008303 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:46.008602 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: BEGIN
[0m23:24:46.009444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:24:46.009681 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:46.010030 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Financial Wellness Tool (id: q-financial-wellness-tool, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'moderate-housing-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-housing-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'overall-financial-hardship'
        then answer_value_text
      else null
      end
    )
    
      
            as "overall-financial-hardship"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-medical-hardships'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-medical-hardships"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "cdef0123-4567-89ab-cdef-0123456789ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '51234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "51234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '31234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "31234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '91234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "91234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-housing-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-housing-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-food-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-food-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-debt'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-debt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c1234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-paying-bills'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-paying-bills"
      
    
    ,
  
    max(
      
      case
      when linkid = '3456789a-bcde-f012-3456-789abcdef012'
        then answer_value_text
      else null
      end
    )
    
      
            as "3456789a-bcde-f012-3456-789abcdef012"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-debt'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-debt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-food-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-food-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = '61234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "61234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '6789abcd-ef01-2345-6789-abcdef012345'
        then answer_value_text
      else null
      end
    )
    
      
            as "6789abcd-ef01-2345-6789-abcdef012345"
      
    
    ,
  
    max(
      
      case
      when linkid = '21234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "21234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-financial-hardship'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-financial-hardship"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-paying-bills'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-paying-bills"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f0123456-789a-bcde-f012-3456789abcde'
        then answer_value_text
      else null
      end
    )
    
      
            as "f0123456-789a-bcde-f012-3456789abcde"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:46.013154 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:24:46.014685 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:46.014872 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_tmp" rename to "qr_q_financial_wellness_tool"
[0m23:24:46.015847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:46.016438 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: COMMIT
[0m23:24:46.016600 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:46.016794 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: COMMIT
[0m23:24:46.017478 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:46.018812 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_backup"
[0m23:24:46.019178 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:24:46.019357 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_backup" cascade
[0m23:24:46.020003 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:46.020755 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: Close
[0m23:24:46.021037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae8470>]}
[0m23:24:46.032333 [debug] [Thread-3 (]: SQL status: SELECT 66 in 0.528 seconds
[0m23:24:46.035557 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:46.036833 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_q_planning_next_steps
[0m23:24:46.038953 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:46.039709 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:46.039897 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: BEGIN
[0m23:24:46.040540 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:24:46.040729 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:46.041304 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Planning Next Steps (id: q-planning-next-steps, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d'
        then answer_value_text
      else null
      end
    )
    
      
            as "2cb66889-3c74-40ff-be3d-183fdb17ce2d"
      
    
    ,
  
    max(
      
      case
      when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd34f5b1-8dff-4fd1-b1a0-a1356789abcd"
      
    
    ,
  
    max(
      
      case
      when linkid = '69712544-6237-4962-a455-ee6e9ee80000'
        then answer_value_text
      else null
      end
    )
    
      
            as "69712544-6237-4962-a455-ee6e9ee80000"
      
    
    ,
  
    max(
      
      case
      when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7'
        then answer_value_text
      else null
      end
    )
    
      
            as "12894a06-d244-4426-06f5-f2a3b4c5d6e7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt-optional'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt-optional"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-other-services-outside-agency'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-other-services-outside-agency"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt-main'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt-main"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc23e4a0-7cee-4ec0-a09f-902456789abc"
      
    
    ,
  
    max(
      
      case
      when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "1d2fdd10-a4d1-43e0-8042-8772146e63f7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a'
        then answer_value_text
      else null
      end
    )
    
      
            as "de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-002'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-002"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i'
        then answer_value_text
      else null
      end
    )
    
      
            as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7"
      
    
    ,
  
    max(
      
      case
      when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "45b67d39-0577-4759-3928-52c3d4e5f6a7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-000'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-000"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-003'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-003"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100'
        then answer_value_text
      else null
      end
    )
    
      
            as "f4e3d2c1-b0a9-4988-7766-554433221100"
      
    
    ,
  
    max(
      
      case
      when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01'
        then answer_value_text
      else null
      end
    )
    
      
            as "34ab6c28-f466-4648-2817-1eacbdcedf01"
      
    
    ,
  
    max(
      
      case
      when linkid = 'scheduled-ipc-session-1-with-current-time'
        then answer_value_text
      else null
      end
    )
    
      
            as "scheduled-ipc-session-1-with-current-time"
      
    
    ,
  
    max(
      
      case
      when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123'
        then answer_value_text
      else null
      end
    )
    
      
            as "45bc7d39-0577-4759-3928-2fbdcedf0123"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc-main'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc-main"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc"
      
    
    ,
  
    max(
      
      case
      when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4"
      
    
    ,
  
    max(
      
      case
      when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e'
        then answer_value_text
      else null
      end
    )
    
      
            as "76ba8dbe-5456-4de4-bdde-4b8059ecfa0e"
      
    
    ,
  
    max(
      
      case
      when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106'
        then answer_value_text
      else null
      end
    )
    
      
            as "950d904a-da1a-4ccd-988d-ea6b463ee106"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-004'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-004"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-spi'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-spi"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-planning-next-steps-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-planning-next-steps-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "ab12d39f-6bdd-4dbf-9f8e-8f13456789ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90'
        then answer_value_text
      else null
      end
    )
    
      
            as "de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90"
      
    
    ,
  
    max(
      
      case
      when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "34a56c28-f466-4648-2817-41b2c3d4e5f6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-006'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-006"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-fws'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-fws"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f"
      
    
    ,
  
    max(
      
      case
      when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574'
        then answer_value_text
      else null
      end
    )
    
      
            as "9311146c-720d-47f6-b902-aeecaf3c0574"
      
    
    ,
  
    max(
      
      case
      when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f'
        then answer_value_text
      else null
      end
    )
    
      
            as "256b56d8-c4c2-4313-9e2d-6720941be85f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g"
      
    
    ,
  
    max(
      
      case
      when linkid = 'financial-hardships-list'
        then answer_value_text
      else null
      end
    )
    
      
            as "financial-hardships-list"
      
    
    ,
  
    max(
      
      case
      when linkid = 'scheduled-ipc-session-1-with-current-time-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "scheduled-ipc-session-1-with-current-time-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-001'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-001"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-mhs'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-mhs"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-other-agency-services'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-other-agency-services"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d373ba7-14fa-43bb-bd27-52fad3d2783f"
      
    
    ,
  
    max(
      
      case
      when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345'
        then answer_value_text
      else null
      end
    )
    
      
            as "56cd8e4a-1688-486a-4a39-3acedf012345"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "f06728e4-b022-4204-e4d3-d0e1f2a3b4c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9'
        then answer_value_text
      else null
      end
    )
    
      
            as "34ab6c28-f466-4648-2817-14c5d6e7f8a9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc-optional'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc-optional"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:24:46.046213 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:24:46.047761 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:46.047953 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_tmp" rename to "qr_q_planning_next_steps"
[0m23:24:46.049111 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:24:46.049722 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: COMMIT
[0m23:24:46.049906 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:46.050065 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: COMMIT
[0m23:24:46.050820 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:24:46.051903 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_backup"
[0m23:24:46.052153 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:24:46.052321 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_backup" cascade
[0m23:24:46.052806 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:24:46.053420 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: Close
[0m23:24:46.053696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b662e7-633f-40a1-85ba-b7737743df1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108805a30>]}
[0m23:24:46.101472 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m23:24:46.102447 [info ] [Thread-3 (]: 83 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_planning_next_steps  [[32mCREATE VIEW[0m in 0.55s]
[0m23:24:46.103486 [info ] [Thread-1 (]: 82 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_financial_wellness_tool  [[32mCREATE VIEW[0m in 0.57s]
[0m23:24:46.104206 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_q_planning_next_steps
[0m23:24:46.104792 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:24:46.106467 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:46.106798 [debug] [MainThread]: On master: BEGIN
[0m23:24:46.107070 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:24:46.115153 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:24:46.115470 [debug] [MainThread]: On master: COMMIT
[0m23:24:46.115659 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:46.115832 [debug] [MainThread]: On master: COMMIT
[0m23:24:46.116306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:24:46.116486 [debug] [MainThread]: On master: Close
[0m23:24:46.116731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:46.116897 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_financial_wellness_tool' was properly closed.
[0m23:24:46.117049 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_common_mental_health_symptoms' was properly closed.
[0m23:24:46.117196 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_planning_next_steps' was properly closed.
[0m23:24:46.117336 [debug] [MainThread]: Connection 'model.engage_analytics.practitioners' was properly closed.
[0m23:24:46.117688 [info ] [MainThread]: 
[0m23:24:46.117995 [info ] [MainThread]: Finished running 18 incremental models, 66 view models in 0 hours 0 minutes and 10.64 seconds (10.64s).
[0m23:24:46.123490 [debug] [MainThread]: Command end result
[0m23:24:46.199491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:24:46.200699 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:24:46.211849 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m23:24:46.212161 [info ] [MainThread]: 
[0m23:24:46.212398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:24:46.212565 [info ] [MainThread]: 
[0m23:24:46.212721 [info ] [MainThread]: Done. PASS=84 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=84
[0m23:24:46.213113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.170084, "process_in_blocks": "0", "process_kernel_time": 0.346027, "process_mem_max_rss": "139673600", "process_out_blocks": "0", "process_user_time": 3.139992}
[0m23:24:46.213318 [debug] [MainThread]: Command `dbt run` succeeded at 23:24:46.213281 after 11.17 seconds
[0m23:24:46.213492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108804c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108807aa0>]}
[0m23:24:46.213655 [debug] [MainThread]: Flushing usage events
[0m23:24:46.268032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:47.623591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119219ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c121160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c120ec0>]}


============================== 23:26:47.627190 | 6d8a2f54-757b-4c19-a0ca-4ae013a3237b ==============================
[0m23:26:47.627190 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:26:47.627514 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m23:26:47.723603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e0b770>]}
[0m23:26:47.752696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0dc950>]}
[0m23:26:47.753476 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:26:47.808176 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:26:47.894904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:26:47.895150 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:26:47.912651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c790e30>]}
[0m23:26:47.970366 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:26:47.971848 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:26:47.985043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfaa030>]}
[0m23:26:47.985307 [info ] [MainThread]: Found 84 models, 12 sources, 557 macros
[0m23:26:47.985484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d002b70>]}
[0m23:26:47.987588 [info ] [MainThread]: 
[0m23:26:47.987793 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:26:47.987994 [info ] [MainThread]: 
[0m23:26:47.988258 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:47.991929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:26:47.992225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:26:47.993524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:26:48.020982 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:26:48.021223 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:26:48.021396 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:26:48.021545 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:26:48.021694 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:26:48.021890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:48.022079 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:26:48.022217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:48.023183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:48.059864 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.037 seconds
[0m23:26:48.060129 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.038 seconds
[0m23:26:48.060301 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.038 seconds
[0m23:26:48.061144 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:26:48.061779 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:26:48.062361 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:26:48.065772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m23:26:48.066098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m23:26:48.068984 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:26:48.069195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m23:26:48.070100 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:26:48.070258 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m23:26:48.071054 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:26:48.071880 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m23:26:48.072066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:48.072211 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m23:26:48.072331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:48.072546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:48.084865 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m23:26:48.085173 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m23:26:48.085420 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:26:48.085609 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m23:26:48.085770 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:26:48.085927 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m23:26:48.086079 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:26:48.086222 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m23:26:48.086473 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m23:26:48.088131 [debug] [ThreadPool]: SQL status: SELECT 70 in 0.002 seconds
[0m23:26:48.089233 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m23:26:48.089461 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m23:26:48.089679 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m23:26:48.090264 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m23:26:48.090393 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m23:26:48.091021 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m23:26:48.094809 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m23:26:48.095000 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m23:26:48.100365 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:48.100563 [debug] [MainThread]: On master: BEGIN
[0m23:26:48.100697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:48.107984 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:26:48.108188 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:48.108367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:26:48.111090 [debug] [MainThread]: SQL status: SELECT 106 in 0.002 seconds
[0m23:26:48.118242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1fcc50>]}
[0m23:26:48.118463 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:48.119454 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:48.119701 [debug] [MainThread]: On master: BEGIN
[0m23:26:48.120796 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.120934 [debug] [MainThread]: On master: COMMIT
[0m23:26:48.121062 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:48.121174 [debug] [MainThread]: On master: COMMIT
[0m23:26:48.121704 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:48.121844 [debug] [MainThread]: On master: Close
[0m23:26:48.123652 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m23:26:48.123891 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m23:26:48.124312 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m23:26:48.124162 [info ] [Thread-1 (]: 1 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m23:26:48.124558 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m23:26:48.124769 [info ] [Thread-2 (]: 2 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m23:26:48.125031 [info ] [Thread-3 (]: 3 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m23:26:48.125290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_careplans)
[0m23:26:48.125533 [info ] [Thread-4 (]: 4 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m23:26:48.125753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_careteams)
[0m23:26:48.125935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_encounter)
[0m23:26:48.126117 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m23:26:48.126333 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m23:26:48.126495 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m23:26:48.126658 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m23:26:48.135698 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m23:26:48.135947 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m23:26:48.138068 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m23:26:48.140459 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m23:26:48.143344 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m23:26:48.143987 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m23:26:48.144206 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m23:26:48.150766 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m23:26:48.151019 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m23:26:48.206026 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:26:48.207216 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:26:48.209054 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:26:48.210589 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:26:48.210803 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

    
  
    

  create temporary table "stg_careteams__dbt_tmp232648161723"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams")

  );
  
  
[0m23:26:48.211055 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

    
  
    

  create temporary table "stg_encounter__dbt_tmp232648165420"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter")

  );
  
  
[0m23:26:48.211267 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

    
  
    

  create temporary table "stg_careplans__dbt_tmp232648208373"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans")

  );
  
  
[0m23:26:48.211465 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

    
  
    

  create temporary table "stg_locations__dbt_tmp232648210039"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations")

  );
  
  
[0m23:26:48.211647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:48.211789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:48.211962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:48.212097 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:26:48.235384 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.024 seconds
[0m23:26:48.235673 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.024 seconds
[0m23:26:48.242336 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:26:48.242606 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m23:26:48.242823 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.031 seconds
[0m23:26:48.244302 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:26:48.244507 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m23:26:48.245846 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:26:48.247185 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:26:48.247368 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m23:26:48.247568 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m23:26:48.247721 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m23:26:48.248642 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.248884 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.249080 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.249289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.249479 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:26:48.249647 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:26:48.249855 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:26:48.250011 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:26:48.250169 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams__dbt_tmp232648161723'
        
      order by ordinal_position

  
[0m23:26:48.250346 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations__dbt_tmp232648210039'
        
      order by ordinal_position

  
[0m23:26:48.250514 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter__dbt_tmp232648165420'
        
      order by ordinal_position

  
[0m23:26:48.250671 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans__dbt_tmp232648208373'
        
      order by ordinal_position

  
[0m23:26:48.256616 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.006 seconds
[0m23:26:48.259454 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:26:48.259692 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.009 seconds
[0m23:26:48.259874 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.009 seconds
[0m23:26:48.260029 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.009 seconds
[0m23:26:48.260186 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.262461 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:26:48.264003 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:26:48.266003 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:26:48.266456 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.266706 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.266914 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.269392 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.003 seconds
[0m23:26:48.273308 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:26:48.273526 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.273776 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.006 seconds
[0m23:26:48.275544 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:26:48.275795 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.009 seconds
[0m23:26:48.275987 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.009 seconds
[0m23:26:48.276129 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m23:26:48.276280 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.277861 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:26:48.279470 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:26:48.291750 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m23:26:48.296217 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.297523 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.005 seconds
[0m23:26:48.299124 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.300747 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m23:26:48.301277 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:26:48.301501 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_locations__dbt_tmp232648210039" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" ("id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference")
    (
        select "id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference"
        from "stg_locations__dbt_tmp232648210039"
    )
  
[0m23:26:48.301734 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:26:48.301928 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careplans__dbt_tmp232648208373" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" ("id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at"
        from "stg_careplans__dbt_tmp232648208373"
    )
  
[0m23:26:48.302894 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:48.309434 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m23:26:48.309685 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.009 seconds
[0m23:26:48.311653 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m23:26:48.312540 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m23:26:48.312702 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.013 seconds
[0m23:26:48.313676 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m23:26:48.313959 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:26:48.314133 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:26:48.315535 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m23:26:48.316086 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m23:26:48.316290 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m23:26:48.316642 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:26:48.317004 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_encounter__dbt_tmp232648165420" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" ("id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at"
        from "stg_encounter__dbt_tmp232648165420"
    )
  
[0m23:26:48.317248 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:26:48.317427 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careteams__dbt_tmp232648161723" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" ("id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource")
    (
        select "id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource"
        from "stg_careteams__dbt_tmp232648161723"
    )
  
[0m23:26:48.319509 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:26:48.320186 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m23:26:48.320374 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m23:26:48.320530 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m23:26:48.320694 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:26:48.321435 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m23:26:48.322614 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m23:26:48.322815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:26:48.323931 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m23:26:48.327347 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:26:48.357743 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e0a990>]}
[0m23:26:48.358657 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m23:26:48.359593 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m23:26:48.360503 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:48.360272 [info ] [Thread-4 (]: 4 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mINSERT 0 0[0m in 0.20s]
[0m23:26:48.361101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d826780>]}
[0m23:26:48.361884 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m23:26:48.362260 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m23:26:48.362941 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:48.363566 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8255b0>]}
[0m23:26:48.364119 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m23:26:48.362642 [info ] [Thread-1 (]: 1 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mINSERT 0 0[0m in 0.24s]
[0m23:26:48.368643 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m23:26:48.369865 [info ] [Thread-3 (]: 3 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mINSERT 0 0[0m in 0.24s]
[0m23:26:48.371712 [info ] [Thread-4 (]: 5 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m23:26:48.372447 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m23:26:48.372848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d89f830>]}
[0m23:26:48.373405 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m23:26:48.375978 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_patient
[0m23:26:48.373634 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_organization_affiliations)
[0m23:26:48.375449 [info ] [Thread-2 (]: 2 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mINSERT 0 0[0m in 0.25s]
[0m23:26:48.376805 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m23:26:48.376389 [info ] [Thread-3 (]: 7 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m23:26:48.374070 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_organizations
[0m23:26:48.377277 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m23:26:48.380944 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.381523 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_patient)
[0m23:26:48.381872 [info ] [Thread-1 (]: 6 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m23:26:48.382148 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_practitioner
[0m23:26:48.382561 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_patient
[0m23:26:48.382951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_organizations)
[0m23:26:48.385890 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m23:26:48.383401 [info ] [Thread-2 (]: 8 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m23:26:48.386174 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m23:26:48.386338 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_organizations
[0m23:26:48.386618 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_practitioner)
[0m23:26:48.388658 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.389516 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_patient
[0m23:26:48.392036 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m23:26:48.392535 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m23:26:48.392857 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

    
  
    

  create temporary table "stg_organization_affiliations__dbt_tmp232648387900"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations")

  );
  
  
[0m23:26:48.394887 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:26:48.397471 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m23:26:48.397819 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:48.398211 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

    
  
    

  create temporary table "stg_patient__dbt_tmp232648394108"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient")

  );
  
  
[0m23:26:48.398570 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_organizations
[0m23:26:48.398897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:48.401109 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:26:48.402055 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

    
  
    

  create temporary table "stg_organizations__dbt_tmp232648400369"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  -- this filter will only be applied on an incremental run
   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations")

  );
  
  
[0m23:26:48.401721 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_practitioner
[0m23:26:48.402335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:48.404704 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:26:48.405186 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

    
  
    

  create temporary table "stg_practitioner__dbt_tmp232648403999"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner")

  );
  
  
[0m23:26:48.405764 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:48.409844 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.012 seconds
[0m23:26:48.412313 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.412516 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m23:26:48.413293 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.413638 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.413976 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations__dbt_tmp232648387900'
        
      order by ordinal_position

  
[0m23:26:48.415307 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.016 seconds
[0m23:26:48.417143 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:26:48.417393 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: BEGIN
[0m23:26:48.417694 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.012 seconds
[0m23:26:48.419181 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:26:48.419457 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:26:48.419684 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m23:26:48.419884 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m23:26:48.420129 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m23:26:48.421964 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.422226 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:26:48.423809 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:26:48.424126 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.424322 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient__dbt_tmp232648394108'
        
      order by ordinal_position

  
[0m23:26:48.424566 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m23:26:48.424795 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.425159 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:26:48.425377 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner__dbt_tmp232648403999'
        
      order by ordinal_position

  
[0m23:26:48.425569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:48.425724 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:26:48.425884 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations__dbt_tmp232648400369'
        
      order by ordinal_position

  
[0m23:26:48.426961 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:48.428670 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.428885 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.004 seconds
[0m23:26:48.429082 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.429251 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:26:48.431187 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:26:48.431454 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:26:48.433195 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:26:48.433427 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:48.433614 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.435295 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:26:48.435567 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.436645 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.436943 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.437510 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.437741 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organization_affiliations__dbt_tmp232648387900" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" ("id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at"
        from "stg_organization_affiliations__dbt_tmp232648387900"
    )
  
[0m23:26:48.438548 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:48.439233 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m23:26:48.439470 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:48.439685 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:48.439864 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:26:48.440021 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.003 seconds
[0m23:26:48.441617 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:26:48.444282 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:26:48.444533 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m23:26:48.446102 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:26:48.446357 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.446607 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.446856 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.447522 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.447906 [debug] [Thread-4 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m23:26:48.448185 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d81ed50>]}
[0m23:26:48.448500 [info ] [Thread-4 (]: 5 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mINSERT 0 0[0m in 0.07s]
[0m23:26:48.448782 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m23:26:48.448968 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.002 seconds
[0m23:26:48.449208 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:48.449477 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m23:26:48.449734 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:26:48.450975 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m23:26:48.451805 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m23:26:48.452060 [info ] [Thread-4 (]: 9 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m23:26:48.452999 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m23:26:48.453345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_practitioner_roles)
[0m23:26:48.453665 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m23:26:48.456244 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.456536 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:26:48.456795 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:26:48.457021 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:26:48.457234 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_patient__dbt_tmp232648394108" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" ("id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at")
    (
        select "id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at"
        from "stg_patient__dbt_tmp232648394108"
    )
  
[0m23:26:48.457478 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner__dbt_tmp232648403999" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" ("id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at"
        from "stg_practitioner__dbt_tmp232648403999"
    )
  
[0m23:26:48.457698 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organizations__dbt_tmp232648400369" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" ("id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at")
    (
        select "id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at"
        from "stg_organizations__dbt_tmp232648400369"
    )
  
[0m23:26:48.457920 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m23:26:48.459925 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.460165 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:26:48.460356 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:26:48.460503 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:26:48.460679 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

    
  
    

  create temporary table "stg_practitioner_roles__dbt_tmp232648459233"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles")

  );
  
  
[0m23:26:48.461396 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m23:26:48.462009 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: COMMIT
[0m23:26:48.462557 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m23:26:48.462782 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:48.462963 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:26:48.463133 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:26:48.463401 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:26:48.463671 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m23:26:48.463884 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: COMMIT
[0m23:26:48.464064 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m23:26:48.465086 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.465494 [debug] [Thread-1 (]: On model.engage_analytics.stg_organizations: Close
[0m23:26:48.465701 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.465930 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.466257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d91d700>]}
[0m23:26:48.466656 [debug] [Thread-3 (]: On model.engage_analytics.stg_patient: Close
[0m23:26:48.467113 [debug] [Thread-2 (]: On model.engage_analytics.stg_practitioner: Close
[0m23:26:48.467467 [info ] [Thread-1 (]: 6 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mINSERT 0 0[0m in 0.08s]
[0m23:26:48.467874 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1fcc50>]}
[0m23:26:48.468117 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d71e690>]}
[0m23:26:48.468421 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_organizations
[0m23:26:48.468727 [info ] [Thread-2 (]: 8 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mINSERT 0 0[0m in 0.08s]
[0m23:26:48.469237 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m23:26:48.468971 [info ] [Thread-3 (]: 7 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mINSERT 0 0[0m in 0.09s]
[0m23:26:48.469637 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_practitioner
[0m23:26:48.470242 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_patient
[0m23:26:48.469987 [info ] [Thread-1 (]: 10 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m23:26:48.470514 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_task
[0m23:26:48.470756 [debug] [Thread-3 (]: Began running node model.engage_analytics.encounters
[0m23:26:48.471040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_questionnaire_response)
[0m23:26:48.471290 [info ] [Thread-2 (]: 11 of 84 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m23:26:48.471672 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m23:26:48.471483 [info ] [Thread-3 (]: 12 of 84 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m23:26:48.471908 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.009 seconds
[0m23:26:48.472074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.stg_task)
[0m23:26:48.474181 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.474479 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.encounters)
[0m23:26:48.475972 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.476204 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_task
[0m23:26:48.476451 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.encounters
[0m23:26:48.476655 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m23:26:48.479132 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m23:26:48.489493 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.489821 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m23:26:48.490178 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m23:26:48.490364 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m23:26:48.490571 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.490775 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:48.490950 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_task
[0m23:26:48.493602 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.493804 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles__dbt_tmp232648459233'
        
      order by ordinal_position

  
[0m23:26:48.495631 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:26:48.495877 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

    
  
    

  create temporary table "stg_questionnaire_response__dbt_tmp232648492915"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response")

  );
  
  
[0m23:26:48.496145 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

    
  
    

  create temporary table "stg_task__dbt_tmp232648494914"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task")

  );
  
  
[0m23:26:48.496623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:48.496792 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:48.499710 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:26:48.501503 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.501771 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.503292 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.012 seconds
[0m23:26:48.504117 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.504309 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m23:26:48.504504 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:48.506288 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.506610 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.507090 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.003 seconds
[0m23:26:48.507887 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.508082 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m23:26:48.508353 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:48.509336 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.509776 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.509966 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner_roles__dbt_tmp232648459233" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" ("id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at"
        from "stg_practitioner_roles__dbt_tmp232648459233"
    )
  
[0m23:26:48.510211 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.014 seconds
[0m23:26:48.510523 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.002 seconds
[0m23:26:48.512044 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.512724 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.512885 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:26:48.513059 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m23:26:48.513236 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m23:26:48.513882 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m23:26:48.514119 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:26:48.514267 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m23:26:48.514499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:48.514645 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.514794 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response__dbt_tmp232648492915'
        
      order by ordinal_position

  
[0m23:26:48.515014 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.515378 [debug] [Thread-4 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m23:26:48.515656 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8a3e30>]}
[0m23:26:48.515938 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:26:48.517853 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m23:26:48.516284 [info ] [Thread-4 (]: 9 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mINSERT 0 0[0m in 0.06s]
[0m23:26:48.518363 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m23:26:48.518571 [debug] [Thread-4 (]: Began running node model.engage_analytics.unnested_careteams
[0m23:26:48.519056 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m23:26:48.518855 [info ] [Thread-4 (]: 13 of 84 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m23:26:48.520755 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.520971 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.unnested_careteams)
[0m23:26:48.521149 [debug] [Thread-3 (]: Began executing node model.engage_analytics.encounters
[0m23:26:48.521351 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.521530 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m23:26:48.524052 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.525711 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m23:26:48.526071 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    
  
    

  create temporary table "encounters__dbt_tmp232648523080"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."encounters")

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

where e._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
)

  );
  
  
[0m23:26:48.526386 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.002 seconds
[0m23:26:48.528946 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.529218 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.529570 [debug] [Thread-4 (]: Began executing node model.engage_analytics.unnested_careteams
[0m23:26:48.535517 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m23:26:48.535759 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.009 seconds
[0m23:26:48.535946 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.039 seconds
[0m23:26:48.536936 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.540503 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m23:26:48.541985 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.543298 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:26:48.543665 [debug] [Thread-3 (]: On model.engage_analytics.encounters: BEGIN
[0m23:26:48.543863 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: BEGIN
[0m23:26:48.544127 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.544318 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_questionnaire_response__dbt_tmp232648492915" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" ("id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at")
    (
        select "id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at"
        from "stg_questionnaire_response__dbt_tmp232648492915"
    )
  
[0m23:26:48.544558 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:48.544747 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:26:48.544917 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_task__dbt_tmp232648494914'
        
      order by ordinal_position

  
[0m23:26:48.545167 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:26:48.545411 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.545585 [debug] [Thread-4 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m23:26:48.545733 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:48.545891 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.546040 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:48.546655 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m23:26:48.546831 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'encounters__dbt_tmp232648523080'
        
      order by ordinal_position

  
[0m23:26:48.547236 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:26:48.547451 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m23:26:48.548353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.548772 [debug] [Thread-1 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m23:26:48.549056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d914500>]}
[0m23:26:48.549284 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.004 seconds
[0m23:26:48.549659 [info ] [Thread-1 (]: 10 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mINSERT 0 0[0m in 0.08s]
[0m23:26:48.551472 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:26:48.551732 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.004 seconds
[0m23:26:48.551998 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m23:26:48.552197 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.554025 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.554284 [debug] [Thread-1 (]: Began running node model.engage_analytics.organization_affiliations
[0m23:26:48.554671 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.554884 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:26:48.555100 [info ] [Thread-1 (]: 14 of 84 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m23:26:48.555368 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:26:48.555669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.organization_affiliations)
[0m23:26:48.555902 [debug] [Thread-4 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m23:26:48.556106 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m23:26:48.556398 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.002 seconds
[0m23:26:48.558702 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m23:26:48.558971 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:48.559179 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.004 seconds
[0m23:26:48.560942 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:26:48.565547 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:26:48.567344 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.567612 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:26:48.567873 [debug] [Thread-4 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams" rename to "unnested_careteams__dbt_backup"
[0m23:26:48.568070 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.568300 [debug] [Thread-1 (]: Began executing node model.engage_analytics.organization_affiliations
[0m23:26:48.570578 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:26:48.570835 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:48.571029 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

    
  
    

  create temporary table "organization_affiliations__dbt_tmp232648569586"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

where s._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
)

  );
  
  
[0m23:26:48.571206 [debug] [Thread-2 (]: SQL status: SELECT 19 in 0.003 seconds
[0m23:26:48.571360 [debug] [Thread-3 (]: SQL status: SELECT 19 in 0.003 seconds
[0m23:26:48.572785 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:26:48.572964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:48.574184 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m23:26:48.575177 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m23:26:48.575352 [debug] [Thread-4 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m23:26:48.575847 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:26:48.576028 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.576227 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_task__dbt_tmp232648494914" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" ("id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at")
    (
        select "id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at"
        from "stg_task__dbt_tmp232648494914"
    )
  
[0m23:26:48.576428 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:48.576610 [debug] [Thread-3 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."encounters" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "encounters__dbt_tmp232648523080" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."encounters" ("id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at")
    (
        select "id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at"
        from "encounters__dbt_tmp232648523080"
    )
  
[0m23:26:48.578377 [debug] [Thread-4 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m23:26:48.578591 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:26:48.578783 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:26:48.579652 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: COMMIT
[0m23:26:48.579876 [debug] [Thread-4 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m23:26:48.580056 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:48.580294 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:26:48.581029 [debug] [Thread-3 (]: On model.engage_analytics.encounters: COMMIT
[0m23:26:48.581207 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.581393 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: COMMIT
[0m23:26:48.581619 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:26:48.584735 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m23:26:48.585084 [debug] [Thread-3 (]: On model.engage_analytics.encounters: COMMIT
[0m23:26:48.587778 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:26:48.588030 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.015 seconds
[0m23:26:48.588250 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:26:48.588481 [debug] [Thread-4 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m23:26:48.590014 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:26:48.590385 [debug] [Thread-2 (]: On model.engage_analytics.stg_task: Close
[0m23:26:48.590546 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:48.590737 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m23:26:48.591059 [debug] [Thread-3 (]: On model.engage_analytics.encounters: Close
[0m23:26:48.591336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9ed9d0>]}
[0m23:26:48.591697 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9db9e0>]}
[0m23:26:48.591979 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:48.592474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.592285 [info ] [Thread-2 (]: 11 of 84 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mINSERT 0 0[0m in 0.12s]
[0m23:26:48.593475 [debug] [Thread-4 (]: On model.engage_analytics.unnested_careteams: Close
[0m23:26:48.592825 [info ] [Thread-3 (]: 12 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mINSERT 0 0[0m in 0.12s]
[0m23:26:48.593708 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:26:48.594026 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_task
[0m23:26:48.594344 [debug] [Thread-3 (]: Finished running node model.engage_analytics.encounters
[0m23:26:48.594582 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d977560>]}
[0m23:26:48.594769 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations__dbt_tmp232648569586'
        
      order by ordinal_position

  
[0m23:26:48.594962 [debug] [Thread-2 (]: Began running node model.engage_analytics.organizations
[0m23:26:48.595154 [debug] [Thread-3 (]: Began running node model.engage_analytics.patient
[0m23:26:48.595454 [info ] [Thread-4 (]: 13 of 84 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.07s]
[0m23:26:48.595723 [info ] [Thread-2 (]: 15 of 84 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m23:26:48.596189 [debug] [Thread-4 (]: Finished running node model.engage_analytics.unnested_careteams
[0m23:26:48.595933 [info ] [Thread-3 (]: 16 of 84 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m23:26:48.596427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.organizations)
[0m23:26:48.596616 [debug] [Thread-4 (]: Began running node model.engage_analytics.practitioner_role
[0m23:26:48.596795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.patient)
[0m23:26:48.596961 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.organizations
[0m23:26:48.597301 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.patient
[0m23:26:48.597164 [info ] [Thread-4 (]: 17 of 84 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m23:26:48.599608 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:26:48.599881 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:26:48.602492 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m23:26:48.602817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.practitioner_role)
[0m23:26:48.603020 [debug] [Thread-2 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m23:26:48.605316 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:26:48.605579 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.practitioner_role
[0m23:26:48.605808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:48.606097 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.608224 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m23:26:48.608463 [debug] [Thread-3 (]: Began executing node model.engage_analytics.patient
[0m23:26:48.610626 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:26:48.610978 [debug] [Thread-3 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp232648609743"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m23:26:48.611377 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:26:48.611599 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:48.611800 [debug] [Thread-4 (]: Began executing node model.engage_analytics.practitioner_role
[0m23:26:48.613372 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:26:48.615469 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:26:48.615729 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.616041 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

    
  
    

  create temporary table "practitioner_role__dbt_tmp232648614624"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

where spr._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01')
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
)

  );
  
  
[0m23:26:48.616340 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:48.616719 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:26:48.617834 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m23:26:48.618084 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m23:26:48.619125 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m23:26:48.619503 [debug] [Thread-2 (]: Began executing node model.engage_analytics.organizations
[0m23:26:48.621740 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:26:48.621994 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:26:48.622204 [debug] [Thread-2 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    
  
    

  create temporary table "organizations__dbt_tmp232648620818"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

where o._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
)

  );
  
  
[0m23:26:48.622470 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m23:26:48.622689 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organization_affiliations__dbt_tmp232648569586" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" ("id", "organization_id", "location_id", "_airbyte_emitted_at")
    (
        select "id", "organization_id", "location_id", "_airbyte_emitted_at"
        from "organization_affiliations__dbt_tmp232648569586"
    )
  
[0m23:26:48.624298 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:26:48.624548 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.008 seconds
[0m23:26:48.624742 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:26:48.624954 [debug] [Thread-3 (]: On model.engage_analytics.patient: BEGIN
[0m23:26:48.626471 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:26:48.627776 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:26:48.627941 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m23:26:48.628124 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m23:26:48.628281 [debug] [Thread-2 (]: On model.engage_analytics.organizations: BEGIN
[0m23:26:48.628939 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m23:26:48.629160 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.629414 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:26:48.629629 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:48.629792 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:26:48.629971 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:48.630152 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m23:26:48.630311 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:26:48.630475 [debug] [Thread-3 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp232648609743'
        
      order by ordinal_position

  
[0m23:26:48.630638 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:26:48.630820 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role__dbt_tmp232648614624'
        
      order by ordinal_position

  
[0m23:26:48.631018 [debug] [Thread-2 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organizations__dbt_tmp232648620818'
        
      order by ordinal_position

  
[0m23:26:48.631475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.631832 [debug] [Thread-1 (]: On model.engage_analytics.organization_affiliations: Close
[0m23:26:48.632097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da52c60>]}
[0m23:26:48.632394 [info ] [Thread-1 (]: 14 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mINSERT 0 0[0m in 0.08s]
[0m23:26:48.632650 [debug] [Thread-1 (]: Finished running node model.engage_analytics.organization_affiliations
[0m23:26:48.632829 [debug] [Thread-1 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m23:26:48.633028 [info ] [Thread-1 (]: 18 of 84 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m23:26:48.633330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.int_qr_answers_long)
[0m23:26:48.633565 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m23:26:48.636028 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m23:26:48.636295 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.005 seconds
[0m23:26:48.636507 [debug] [Thread-4 (]: SQL status: SELECT 9 in 0.005 seconds
[0m23:26:48.636675 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.005 seconds
[0m23:26:48.638570 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:26:48.640225 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:26:48.642072 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:26:48.642328 [debug] [Thread-3 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.642514 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.642683 [debug] [Thread-1 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m23:26:48.642856 [debug] [Thread-2 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.644480 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m23:26:48.644944 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:26:48.645110 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m23:26:48.645252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:48.645522 [debug] [Thread-4 (]: SQL status: SELECT 9 in 0.002 seconds
[0m23:26:48.647392 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:26:48.647670 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:26:48.647904 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.005 seconds
[0m23:26:48.648092 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.649813 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:26:48.651349 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:26:48.651640 [debug] [Thread-2 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.651857 [debug] [Thread-3 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:48.652445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:26:48.652620 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:26:48.652837 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m23:26:48.653433 [debug] [Thread-4 (]: SQL status: SELECT 9 in 0.002 seconds
[0m23:26:48.653676 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:26:48.654777 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m23:26:48.654942 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.003 seconds
[0m23:26:48.655155 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:48.656160 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m23:26:48.657234 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m23:26:48.658859 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:26:48.659220 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:26:48.659549 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" rename to "int_qr_answers_long__dbt_backup"
[0m23:26:48.659812 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioner_role__dbt_tmp232648614624" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" ("id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at")
    (
        select "id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at"
        from "practitioner_role__dbt_tmp232648614624"
    )
  
[0m23:26:48.660113 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:26:48.660318 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:26:48.660529 [debug] [Thread-2 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organizations__dbt_tmp232648620818" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organizations" ("id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at")
    (
        select "id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at"
        from "organizations__dbt_tmp232648620818"
    )
  
[0m23:26:48.660725 [debug] [Thread-3 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp232648609743" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp232648609743"
    )
  
[0m23:26:48.660974 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:48.661204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:48.662722 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m23:26:48.664178 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:26:48.664358 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m23:26:48.664531 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m23:26:48.664717 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:26:48.664902 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m23:26:48.665473 [debug] [Thread-2 (]: On model.engage_analytics.organizations: COMMIT
[0m23:26:48.666013 [debug] [Thread-3 (]: On model.engage_analytics.patient: COMMIT
[0m23:26:48.666220 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m23:26:48.666457 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:26:48.666659 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:26:48.666857 [debug] [Thread-2 (]: On model.engage_analytics.organizations: COMMIT
[0m23:26:48.667031 [debug] [Thread-3 (]: On model.engage_analytics.patient: COMMIT
[0m23:26:48.667203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:48.667385 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.668030 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m23:26:48.668211 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.668363 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.668711 [debug] [Thread-4 (]: On model.engage_analytics.practitioner_role: Close
[0m23:26:48.668880 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:26:48.669205 [debug] [Thread-3 (]: On model.engage_analytics.patient: Close
[0m23:26:48.669528 [debug] [Thread-2 (]: On model.engage_analytics.organizations: Close
[0m23:26:48.669710 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m23:26:48.669950 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da38320>]}
[0m23:26:48.670180 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dae9eb0>]}
[0m23:26:48.670451 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11daea900>]}
[0m23:26:48.670879 [info ] [Thread-4 (]: 17 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mINSERT 0 0[0m in 0.07s]
[0m23:26:48.671619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.672285 [debug] [Thread-4 (]: Finished running node model.engage_analytics.practitioner_role
[0m23:26:48.671327 [info ] [Thread-3 (]: 16 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.07s]
[0m23:26:48.674034 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m23:26:48.671968 [info ] [Thread-2 (]: 15 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mINSERT 0 0[0m in 0.07s]
[0m23:26:48.674298 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_header
[0m23:26:48.674578 [debug] [Thread-3 (]: Finished running node model.engage_analytics.patient
[0m23:26:48.674879 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:26:48.675112 [debug] [Thread-2 (]: Finished running node model.engage_analytics.organizations
[0m23:26:48.675328 [info ] [Thread-4 (]: 19 of 84 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m23:26:48.675521 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_tags
[0m23:26:48.675699 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m23:26:48.675885 [debug] [Thread-2 (]: Began running node model.engage_analytics.current_practitioner_role
[0m23:26:48.676073 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.int_qr_header)
[0m23:26:48.676275 [info ] [Thread-3 (]: 20 of 84 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m23:26:48.676583 [info ] [Thread-2 (]: 21 of 84 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m23:26:48.676856 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_header
[0m23:26:48.677082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.int_qr_tags)
[0m23:26:48.677283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.current_practitioner_role)
[0m23:26:48.678914 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m23:26:48.679158 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m23:26:48.679374 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m23:26:48.681246 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m23:26:48.682670 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m23:26:48.683170 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_tags
[0m23:26:48.683377 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_header
[0m23:26:48.685129 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:26:48.685350 [debug] [Thread-2 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m23:26:48.687020 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m23:26:48.687323 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

    
  
    

  create temporary table "int_qr_tags__dbt_tmp232648684551"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags")

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m23:26:48.689017 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m23:26:48.689293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:48.689876 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:26:48.690110 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:26:48.690350 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m23:26:48.690596 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m23:26:48.690809 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:48.691024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:48.694953 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m23:26:48.695765 [debug] [Thread-1 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m23:26:48.696247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d460fb0>]}
[0m23:26:48.696659 [info ] [Thread-1 (]: 18 of 84 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.06s]
[0m23:26:48.696932 [debug] [Thread-1 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m23:26:48.697760 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_104394
[0m23:26:48.698043 [info ] [Thread-1 (]: 22 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104394  [RUN]
[0m23:26:48.698374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.qr_ipc_104394)
[0m23:26:48.698631 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_104394
[0m23:26:48.704711 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:26:48.705046 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.016 seconds
[0m23:26:48.705329 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:48.707127 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:26:48.707428 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m23:26:48.707633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:48.707892 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m23:26:48.708065 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m23:26:48.708211 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:26:48.708470 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:26:48.708706 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m23:26:48.708891 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m23:26:48.709107 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:48.709433 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:26:48.709621 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags__dbt_tmp232648684551'
        
      order by ordinal_position

  
[0m23:26:48.710401 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:48.712155 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:26:48.712377 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:48.712564 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" rename to "int_qr_header__dbt_backup"
[0m23:26:48.714174 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:26:48.714435 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.005 seconds
[0m23:26:48.714785 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" rename to "current_practitioner_role__dbt_backup"
[0m23:26:48.716462 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:26:48.716672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:48.716864 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m23:26:48.718173 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:26:48.718342 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:48.718537 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m23:26:48.719953 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:26:48.720201 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m23:26:48.720393 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.002 seconds
[0m23:26:48.722244 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:26:48.722478 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:48.722655 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m23:26:48.722799 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:48.723404 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m23:26:48.724042 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m23:26:48.724237 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:26:48.724407 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:26:48.724602 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m23:26:48.724754 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m23:26:48.725095 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.002 seconds
[0m23:26:48.725997 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m23:26:48.726202 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.727299 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m23:26:48.727611 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:26:48.727774 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m23:26:48.727958 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:26:48.729949 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m23:26:48.730207 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:26:48.730390 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:48.730642 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m23:26:48.731324 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_header: Close
[0m23:26:48.731495 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:26:48.731719 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" as DBT_INTERNAL_DEST
        where (resource_id) in (
            select distinct resource_id
            from "int_qr_tags__dbt_tmp232648684551" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" ("resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version")
    (
        select "resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version"
        from "int_qr_tags__dbt_tmp232648684551"
    )
  
[0m23:26:48.732054 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db85580>]}
[0m23:26:48.732684 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:48.733438 [debug] [Thread-2 (]: On model.engage_analytics.current_practitioner_role: Close
[0m23:26:48.733646 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:48.732493 [info ] [Thread-4 (]: 19 of 84 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.06s]
[0m23:26:48.734365 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m23:26:48.734602 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db84380>]}
[0m23:26:48.734893 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_header
[0m23:26:48.735088 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:26:48.735605 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_104453
[0m23:26:48.735440 [info ] [Thread-2 (]: 21 of 84 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.06s]
[0m23:26:48.735850 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m23:26:48.736263 [debug] [Thread-2 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m23:26:48.736050 [info ] [Thread-4 (]: 23 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104453  [RUN]
[0m23:26:48.736503 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_104454
[0m23:26:48.736754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.qr_ipc_104453)
[0m23:26:48.737008 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:48.737375 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_104453
[0m23:26:48.737226 [info ] [Thread-2 (]: 24 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104454  [RUN]
[0m23:26:48.737746 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_tags: Close
[0m23:26:48.774563 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:26:48.774824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.qr_ipc_104454)
[0m23:26:48.775126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db974d0>]}
[0m23:26:48.775310 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:48.775487 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_104454
[0m23:26:48.775782 [info ] [Thread-3 (]: 20 of 84 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mINSERT 0 0[0m in 0.10s]
[0m23:26:48.776071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:48.778297 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:26:48.778617 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_tags
[0m23:26:48.778909 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:48.779142 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_104455
[0m23:26:48.779394 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:48.779864 [info ] [Thread-3 (]: 25 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_104455  [RUN]
[0m23:26:48.780242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.qr_ipc_104455)
[0m23:26:48.780513 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_104455
[0m23:26:48.782595 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:26:48.783103 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:48.783407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:49.246757 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.539 seconds
[0m23:26:49.249175 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104394"
[0m23:26:49.250426 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_104394
[0m23:26:49.252671 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104394"
[0m23:26:49.253569 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:26:49.253822 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: BEGIN
[0m23:26:49.254652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:49.254875 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:26:49.255060 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_tmp"
    
    
  as (
    
-- SPI Subform 4 (id: ipc-104394, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:49.256257 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:49.258041 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:26:49.258237 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394" rename to "qr_ipc_104394__dbt_backup"
[0m23:26:49.258940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:49.260332 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:26:49.260510 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_tmp" rename to "qr_ipc_104394"
[0m23:26:49.261226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:49.261998 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: COMMIT
[0m23:26:49.262191 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:26:49.262348 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: COMMIT
[0m23:26:49.263154 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:49.264356 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_backup"
[0m23:26:49.264668 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_104394"
[0m23:26:49.264880 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104394"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104394__dbt_backup" cascade
[0m23:26:49.266167 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:49.266887 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_104394: Close
[0m23:26:49.267172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9b1d30>]}
[0m23:26:49.267489 [info ] [Thread-1 (]: 22 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104394  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:49.267871 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_104394
[0m23:26:49.268087 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_202
[0m23:26:49.268351 [info ] [Thread-1 (]: 26 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_202  [RUN]
[0m23:26:49.268576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104394, now model.engage_analytics.qr_ipc_202)
[0m23:26:49.268736 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_202
[0m23:26:49.270872 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:26:49.271094 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:49.271258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:49.305727 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.530 seconds
[0m23:26:49.306024 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.527 seconds
[0m23:26:49.306754 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104453"
[0m23:26:49.307327 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104454"
[0m23:26:49.307688 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.524 seconds
[0m23:26:49.308265 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_104455"
[0m23:26:49.308676 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_104453
[0m23:26:49.308961 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_104454
[0m23:26:49.311745 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104453"
[0m23:26:49.313748 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104454"
[0m23:26:49.314009 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_104455
[0m23:26:49.315841 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_104455"
[0m23:26:49.316263 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:26:49.316517 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: BEGIN
[0m23:26:49.316797 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:26:49.317022 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:26:49.317207 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: BEGIN
[0m23:26:49.317466 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:49.317670 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: BEGIN
[0m23:26:49.318123 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:26:49.318454 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_tmp"
    
    
  as (
    
-- SPI Subform 2 (id: ipc-104453, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:49.318743 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:49.318931 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:49.319131 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:26:49.319377 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:26:49.319642 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_tmp"
    
    
  as (
    
-- SPI Subform 3 (id: ipc-104454, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:49.319893 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_tmp"
    
    
  as (
    
-- SPI Subform 1 (id: ipc-104455, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:49.320141 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:49.321903 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:26:49.322154 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:49.322394 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453" rename to "qr_ipc_104453__dbt_backup"
[0m23:26:49.322578 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:49.324373 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:26:49.326090 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:26:49.326310 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:49.326506 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455" rename to "qr_ipc_104455__dbt_backup"
[0m23:26:49.326704 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454" rename to "qr_ipc_104454__dbt_backup"
[0m23:26:49.328101 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:26:49.328356 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_tmp" rename to "qr_ipc_104453"
[0m23:26:49.328720 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:49.328974 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:49.330582 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:26:49.330791 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:49.332293 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:26:49.332495 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_tmp" rename to "qr_ipc_104454"
[0m23:26:49.333144 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: COMMIT
[0m23:26:49.333378 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_tmp" rename to "qr_ipc_104455"
[0m23:26:49.333623 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:26:49.333860 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: COMMIT
[0m23:26:49.334137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:49.335085 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: COMMIT
[0m23:26:49.335321 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:49.335516 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:49.335697 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:26:49.337702 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_backup"
[0m23:26:49.338392 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: COMMIT
[0m23:26:49.338595 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: COMMIT
[0m23:26:49.338954 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_104453"
[0m23:26:49.339198 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:26:49.339510 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104453"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104453__dbt_backup" cascade
[0m23:26:49.339739 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: COMMIT
[0m23:26:49.340109 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:49.341367 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_backup"
[0m23:26:49.341577 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:49.341879 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_104454"
[0m23:26:49.342087 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:49.342824 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_104453: Close
[0m23:26:49.343031 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104454"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104454__dbt_backup" cascade
[0m23:26:49.344232 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_backup"
[0m23:26:49.344608 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9b6e10>]}
[0m23:26:49.344960 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_104455"
[0m23:26:49.345269 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_104455"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_104455__dbt_backup" cascade
[0m23:26:49.345830 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:49.346576 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_104454: Close
[0m23:26:49.346785 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:49.347115 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db973e0>]}
[0m23:26:49.347969 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_104455: Close
[0m23:26:49.348552 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db97500>]}
[0m23:26:49.436816 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m23:26:49.437490 [info ] [Thread-2 (]: 24 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104454  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:49.437863 [info ] [Thread-4 (]: 23 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104453  [[32mCREATE VIEW[0m in 0.61s]
[0m23:26:49.438515 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_104454
[0m23:26:49.438137 [info ] [Thread-3 (]: 25 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_104455  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:49.438919 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_104453
[0m23:26:49.439178 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_203
[0m23:26:49.439474 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_104455
[0m23:26:49.439685 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_204
[0m23:26:49.439929 [info ] [Thread-2 (]: 27 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_203  [RUN]
[0m23:26:49.440160 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_205
[0m23:26:49.440399 [info ] [Thread-4 (]: 28 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_204  [RUN]
[0m23:26:49.440666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104454, now model.engage_analytics.qr_ipc_203)
[0m23:26:49.440949 [info ] [Thread-3 (]: 29 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_205  [RUN]
[0m23:26:49.441170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104453, now model.engage_analytics.qr_ipc_204)
[0m23:26:49.441344 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_203
[0m23:26:49.441519 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_104455, now model.engage_analytics.qr_ipc_205)
[0m23:26:49.441678 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_204
[0m23:26:49.443932 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:26:49.444225 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_205
[0m23:26:49.446487 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:26:49.446741 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:49.448665 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:26:49.448883 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:49.449062 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:49.449226 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:49.449383 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:49.449716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:49.805077 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.534 seconds
[0m23:26:49.807111 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_202"
[0m23:26:49.809663 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_202
[0m23:26:49.812070 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_202"
[0m23:26:49.812682 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:26:49.812872 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: BEGIN
[0m23:26:49.813624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:49.813793 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:26:49.813963 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 1) (id: ipc-202, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:49.815291 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:49.816912 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:26:49.817102 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202" rename to "qr_ipc_202__dbt_backup"
[0m23:26:49.817817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:49.819535 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:26:49.819750 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_tmp" rename to "qr_ipc_202"
[0m23:26:49.820479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:49.821115 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: COMMIT
[0m23:26:49.821285 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:26:49.821430 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: COMMIT
[0m23:26:49.822429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:49.824640 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_backup"
[0m23:26:49.824945 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_202"
[0m23:26:49.825123 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_202"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_202__dbt_backup" cascade
[0m23:26:49.826290 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:49.826970 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_202: Close
[0m23:26:49.827260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9f9220>]}
[0m23:26:49.827565 [info ] [Thread-1 (]: 26 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_202  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:49.827829 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_202
[0m23:26:49.828006 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_206
[0m23:26:49.828225 [info ] [Thread-1 (]: 30 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_206  [RUN]
[0m23:26:49.828412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_202, now model.engage_analytics.qr_ipc_206)
[0m23:26:49.828567 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_206
[0m23:26:49.830544 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:26:49.830749 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:49.830960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:49.972038 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.522 seconds
[0m23:26:49.974284 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_205"
[0m23:26:49.975265 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.526 seconds
[0m23:26:49.975818 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.526 seconds
[0m23:26:49.976602 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_203"
[0m23:26:49.977247 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_204"
[0m23:26:49.977672 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_205
[0m23:26:49.979560 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_205"
[0m23:26:49.979969 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:26:49.980140 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: BEGIN
[0m23:26:49.980412 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_203
[0m23:26:49.982119 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_203"
[0m23:26:49.982389 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_204
[0m23:26:49.982657 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m23:26:49.984593 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_204"
[0m23:26:49.984837 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:26:49.985133 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 2) (id: ipc-205, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:49.985381 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:26:49.985703 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: BEGIN
[0m23:26:49.986039 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:26:49.986276 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: BEGIN
[0m23:26:49.986620 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:49.986823 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:49.987002 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:49.987186 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:26:49.988858 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:26:49.989052 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:26:49.989241 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 1) (id: ipc-203, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:49.989452 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205" rename to "qr_ipc_205__dbt_backup"
[0m23:26:49.989660 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 1) (id: ipc-204, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:49.990394 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:49.991972 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:26:49.992185 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_tmp" rename to "qr_ipc_205"
[0m23:26:49.992392 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:49.992594 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:49.994234 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:26:49.994435 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:49.995795 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:26:49.995964 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204" rename to "qr_ipc_204__dbt_backup"
[0m23:26:49.996596 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: COMMIT
[0m23:26:49.996781 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203" rename to "qr_ipc_203__dbt_backup"
[0m23:26:49.996982 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:26:49.997162 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: COMMIT
[0m23:26:49.997427 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:49.997670 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:49.999979 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:26:50.001234 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:26:50.001394 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:26:50.001657 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_tmp" rename to "qr_ipc_204"
[0m23:26:50.001878 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_tmp" rename to "qr_ipc_203"
[0m23:26:50.003174 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_backup"
[0m23:26:50.003526 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_205"
[0m23:26:50.003701 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_205"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_205__dbt_backup" cascade
[0m23:26:50.003890 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:50.004070 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:50.004701 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: COMMIT
[0m23:26:50.005325 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: COMMIT
[0m23:26:50.005494 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:50.005672 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:26:50.005834 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:26:50.006391 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_205: Close
[0m23:26:50.006544 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: COMMIT
[0m23:26:50.006700 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: COMMIT
[0m23:26:50.007010 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7f9280>]}
[0m23:26:50.007535 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:50.007765 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:50.007344 [info ] [Thread-3 (]: 29 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_205  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:50.008931 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_backup"
[0m23:26:50.009906 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_backup"
[0m23:26:50.010176 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_205
[0m23:26:50.010577 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_204"
[0m23:26:50.010969 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_203"
[0m23:26:50.011174 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_207
[0m23:26:50.011363 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_204"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_204__dbt_backup" cascade
[0m23:26:50.011520 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_203"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_203__dbt_backup" cascade
[0m23:26:50.011732 [info ] [Thread-3 (]: 31 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_207  [RUN]
[0m23:26:50.012028 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_205, now model.engage_analytics.qr_ipc_207)
[0m23:26:50.012211 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_207
[0m23:26:50.014354 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:26:50.014635 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:26:50.014843 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:26:50.015024 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:50.015725 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_203: Close
[0m23:26:50.016344 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_204: Close
[0m23:26:50.016513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:50.016789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d46be60>]}
[0m23:26:50.017074 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6beb70>]}
[0m23:26:50.017430 [info ] [Thread-2 (]: 27 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_203  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:50.017762 [info ] [Thread-4 (]: 28 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_204  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:50.018037 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_203
[0m23:26:50.018371 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_204
[0m23:26:50.018609 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_208
[0m23:26:50.018860 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_209
[0m23:26:50.019136 [info ] [Thread-2 (]: 32 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_208  [RUN]
[0m23:26:50.019449 [info ] [Thread-4 (]: 33 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_209  [RUN]
[0m23:26:50.019748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_203, now model.engage_analytics.qr_ipc_208)
[0m23:26:50.020008 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_204, now model.engage_analytics.qr_ipc_209)
[0m23:26:50.020218 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_208
[0m23:26:50.020400 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_209
[0m23:26:50.022709 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:26:50.024821 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:26:50.025130 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:50.025435 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:50.025725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:50.025928 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:50.370156 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.539 seconds
[0m23:26:50.373222 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_206"
[0m23:26:50.375349 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_206
[0m23:26:50.377332 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_206"
[0m23:26:50.378249 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:26:50.378514 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: BEGIN
[0m23:26:50.379385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:50.379613 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:26:50.379813 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 2) (id: ipc-206, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:50.381118 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:50.383844 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:26:50.384086 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206" rename to "qr_ipc_206__dbt_backup"
[0m23:26:50.384913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:50.386568 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:26:50.386773 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_tmp" rename to "qr_ipc_206"
[0m23:26:50.387462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:50.388160 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: COMMIT
[0m23:26:50.388329 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:26:50.388477 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: COMMIT
[0m23:26:50.389364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:50.390666 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_backup"
[0m23:26:50.390947 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_206"
[0m23:26:50.391153 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_206"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_206__dbt_backup" cascade
[0m23:26:50.392263 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:50.393016 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_206: Close
[0m23:26:50.393314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6beb70>]}
[0m23:26:50.393630 [info ] [Thread-1 (]: 30 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_206  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:50.393901 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_206
[0m23:26:50.394088 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_210
[0m23:26:50.394346 [info ] [Thread-1 (]: 34 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_210  [RUN]
[0m23:26:50.394544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_206, now model.engage_analytics.qr_ipc_210)
[0m23:26:50.394703 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_210
[0m23:26:50.396847 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:26:50.397079 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:50.397240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:50.551047 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.534 seconds
[0m23:26:50.551822 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_207"
[0m23:26:50.552275 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_207
[0m23:26:50.554110 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_207"
[0m23:26:50.554485 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:26:50.554648 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: BEGIN
[0m23:26:50.555631 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:50.555915 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:26:50.556101 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 3) (id: ipc-207, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:50.556318 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.531 seconds
[0m23:26:50.556949 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_208"
[0m23:26:50.557260 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:50.558928 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:26:50.559117 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207" rename to "qr_ipc_207__dbt_backup"
[0m23:26:50.559423 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_208
[0m23:26:50.561170 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_208"
[0m23:26:50.561453 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:50.563042 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:26:50.563241 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.537 seconds
[0m23:26:50.563410 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_tmp" rename to "qr_ipc_207"
[0m23:26:50.564012 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_209"
[0m23:26:50.564335 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:26:50.564507 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: BEGIN
[0m23:26:50.564713 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:50.565347 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: COMMIT
[0m23:26:50.565524 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:50.565686 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:26:50.565844 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_209
[0m23:26:50.566002 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:26:50.566161 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: COMMIT
[0m23:26:50.568624 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_209"
[0m23:26:50.568828 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_tmp"
    
    
  as (
    
-- IPC Session 3 (id: ipc-208, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:50.569309 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:26:50.569472 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: BEGIN
[0m23:26:50.569653 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:50.570773 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_backup"
[0m23:26:50.571013 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_207"
[0m23:26:50.571174 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:50.571326 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:26:50.571474 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_207"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_207__dbt_backup" cascade
[0m23:26:50.572895 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:26:50.573082 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:26:50.573310 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208" rename to "qr_ipc_208__dbt_backup"
[0m23:26:50.573608 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_tmp"
    
    
  as (
    
-- Mood Rating (IPC Session 4) (id: ipc-209, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:50.574326 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:50.574610 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:50.575272 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_207: Close
[0m23:26:50.575435 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:50.576775 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:26:50.578186 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:26:50.578369 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_tmp" rename to "qr_ipc_208"
[0m23:26:50.578612 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4455e0>]}
[0m23:26:50.578782 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209" rename to "qr_ipc_209__dbt_backup"
[0m23:26:50.579095 [info ] [Thread-3 (]: 31 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_207  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:50.579545 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_207
[0m23:26:50.579834 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:50.580043 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_211
[0m23:26:50.580220 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:50.580884 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: COMMIT
[0m23:26:50.581102 [info ] [Thread-3 (]: 35 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_211  [RUN]
[0m23:26:50.582476 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:26:50.582660 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:26:50.582838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_207, now model.engage_analytics.qr_ipc_211)
[0m23:26:50.583009 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_tmp" rename to "qr_ipc_209"
[0m23:26:50.583166 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: COMMIT
[0m23:26:50.583353 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_211
[0m23:26:50.585401 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:26:50.585649 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:50.585881 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:50.586072 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:50.587371 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_backup"
[0m23:26:50.587607 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:50.588293 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: COMMIT
[0m23:26:50.588632 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_208"
[0m23:26:50.588887 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:26:50.589133 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_208"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_208__dbt_backup" cascade
[0m23:26:50.589355 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: COMMIT
[0m23:26:50.590415 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:50.591637 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_backup"
[0m23:26:50.591872 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:50.592204 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_209"
[0m23:26:50.592902 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_208: Close
[0m23:26:50.593075 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_209"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_209__dbt_backup" cascade
[0m23:26:50.593359 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d46be60>]}
[0m23:26:50.593669 [info ] [Thread-2 (]: 32 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_208  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:50.593993 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_208
[0m23:26:50.594168 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:50.594367 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_212
[0m23:26:50.594959 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_209: Close
[0m23:26:50.595209 [info ] [Thread-2 (]: 36 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_212  [RUN]
[0m23:26:50.595505 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d445310>]}
[0m23:26:50.595684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_208, now model.engage_analytics.qr_ipc_212)
[0m23:26:50.596122 [info ] [Thread-4 (]: 33 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_209  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:50.596430 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_212
[0m23:26:50.596679 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_209
[0m23:26:50.599058 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:26:50.599340 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_221
[0m23:26:50.599541 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:50.599970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:50.599793 [info ] [Thread-4 (]: 37 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_221  [RUN]
[0m23:26:50.600385 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_209, now model.engage_analytics.qr_ipc_221)
[0m23:26:50.600552 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_221
[0m23:26:50.604461 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:26:50.604723 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:50.604888 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:50.977616 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.580 seconds
[0m23:26:50.979828 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_210"
[0m23:26:50.980968 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_210
[0m23:26:50.984114 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_210"
[0m23:26:50.984625 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:26:50.984797 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: BEGIN
[0m23:26:50.985626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:50.985837 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:26:50.986023 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 4) (id: ipc-210, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:50.987346 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:50.989077 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:26:50.989291 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210" rename to "qr_ipc_210__dbt_backup"
[0m23:26:50.990051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:50.991664 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:26:50.991861 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_tmp" rename to "qr_ipc_210"
[0m23:26:50.992515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:50.993124 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: COMMIT
[0m23:26:50.993289 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:26:50.993431 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: COMMIT
[0m23:26:50.994407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:50.995603 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_backup"
[0m23:26:50.995906 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_210"
[0m23:26:50.996060 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_210"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_210__dbt_backup" cascade
[0m23:26:50.997146 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:50.997947 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_210: Close
[0m23:26:50.998242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d46a900>]}
[0m23:26:50.998557 [info ] [Thread-1 (]: 34 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_210  [[32mCREATE VIEW[0m in 0.60s]
[0m23:26:50.998824 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_210
[0m23:26:50.999014 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_23451
[0m23:26:50.999262 [info ] [Thread-1 (]: 38 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_23451  [RUN]
[0m23:26:50.999465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_210, now model.engage_analytics.qr_ipc_23451)
[0m23:26:50.999624 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_23451
[0m23:26:51.001684 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.001892 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:51.002051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:51.152471 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.565 seconds
[0m23:26:51.154641 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_211"
[0m23:26:51.155673 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_211
[0m23:26:51.159080 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_211"
[0m23:26:51.159605 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:26:51.159784 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: BEGIN
[0m23:26:51.160626 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:51.160885 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:26:51.161066 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 4) (id: ipc-211, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:51.162231 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:51.163958 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:26:51.164156 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211" rename to "qr_ipc_211__dbt_backup"
[0m23:26:51.164875 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.166253 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:26:51.166428 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_tmp" rename to "qr_ipc_211"
[0m23:26:51.166680 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.562 seconds
[0m23:26:51.167434 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_221"
[0m23:26:51.167705 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.168382 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: COMMIT
[0m23:26:51.168570 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:26:51.168723 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: COMMIT
[0m23:26:51.169199 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_221
[0m23:26:51.172176 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_221"
[0m23:26:51.172455 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:26:51.173759 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_backup"
[0m23:26:51.174050 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_211"
[0m23:26:51.174266 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_211"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_211__dbt_backup" cascade
[0m23:26:51.174523 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:26:51.174767 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.575 seconds
[0m23:26:51.174975 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: BEGIN
[0m23:26:51.175606 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_212"
[0m23:26:51.175803 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:51.176485 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_211: Close
[0m23:26:51.176653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:51.176930 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d445250>]}
[0m23:26:51.177097 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:26:51.177437 [info ] [Thread-3 (]: 35 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_211  [[32mCREATE VIEW[0m in 0.59s]
[0m23:26:51.177726 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_212
[0m23:26:51.177915 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_tmp"
    
    
  as (
    
-- Add Family Member Registration (id: ipc-221, url: n/a, version: 0.0.3)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:51.178177 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_211
[0m23:26:51.179890 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_212"
[0m23:26:51.180224 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_54
[0m23:26:51.180605 [info ] [Thread-3 (]: 39 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_54 . [RUN]
[0m23:26:51.180867 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_211, now model.engage_analytics.qr_ipc_54)
[0m23:26:51.181119 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_54
[0m23:26:51.181315 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:51.181525 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:26:51.183556 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:26:51.185449 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:26:51.185712 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: BEGIN
[0m23:26:51.185964 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:51.186250 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221" rename to "qr_ipc_221__dbt_backup"
[0m23:26:51.186489 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:51.186998 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:51.187166 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:26:51.187335 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_tmp"
    
    
  as (
    
-- SBIRT (id: ipc-212, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:51.187515 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.189107 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:26:51.189337 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:51.189549 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_tmp" rename to "qr_ipc_221"
[0m23:26:51.191044 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:26:51.191312 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212" rename to "qr_ipc_212__dbt_backup"
[0m23:26:51.191714 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:51.192437 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: COMMIT
[0m23:26:51.192656 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.192843 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:26:51.194351 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:26:51.194553 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: COMMIT
[0m23:26:51.194779 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_tmp" rename to "qr_ipc_212"
[0m23:26:51.195551 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:51.195756 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:51.196499 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: COMMIT
[0m23:26:51.197812 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_backup"
[0m23:26:51.198106 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:26:51.198438 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_221"
[0m23:26:51.198639 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: COMMIT
[0m23:26:51.198823 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_221"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_221__dbt_backup" cascade
[0m23:26:51.199771 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:51.199942 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:51.201880 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_backup"
[0m23:26:51.202555 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_221: Close
[0m23:26:51.202806 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_212"
[0m23:26:51.202996 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_212"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_212__dbt_backup" cascade
[0m23:26:51.203249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d445520>]}
[0m23:26:51.203591 [info ] [Thread-4 (]: 37 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_221  [[32mCREATE VIEW[0m in 0.60s]
[0m23:26:51.203870 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_221
[0m23:26:51.204144 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_55
[0m23:26:51.204425 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:51.204773 [info ] [Thread-4 (]: 40 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_55 . [RUN]
[0m23:26:51.205639 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_212: Close
[0m23:26:51.205886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_221, now model.engage_analytics.qr_ipc_55)
[0m23:26:51.206092 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_55
[0m23:26:51.206355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7fb2c0>]}
[0m23:26:51.208515 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:26:51.208942 [info ] [Thread-2 (]: 36 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_212  [[32mCREATE VIEW[0m in 0.61s]
[0m23:26:51.209209 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:51.209517 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_212
[0m23:26:51.209725 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:51.209981 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_56
[0m23:26:51.210343 [info ] [Thread-2 (]: 41 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_56 . [RUN]
[0m23:26:51.210805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_212, now model.engage_analytics.qr_ipc_56)
[0m23:26:51.211007 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_56
[0m23:26:51.213130 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:26:51.213346 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:51.213539 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:51.543861 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.540 seconds
[0m23:26:51.546440 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.548502 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_23451
[0m23:26:51.550614 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.551365 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.551594 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: BEGIN
[0m23:26:51.552426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:51.552621 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.552803 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_tmp"
    
    
  as (
    
-- Discuss Confidentiality (id: ipc-23451, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:51.554050 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:51.555719 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.555921 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451" rename to "qr_ipc_23451__dbt_backup"
[0m23:26:51.556627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.558232 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.558418 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_tmp" rename to "qr_ipc_23451"
[0m23:26:51.558986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:51.559649 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: COMMIT
[0m23:26:51.559815 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.559958 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: COMMIT
[0m23:26:51.560708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:51.561930 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_backup"
[0m23:26:51.562184 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_23451"
[0m23:26:51.562340 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_23451"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_23451__dbt_backup" cascade
[0m23:26:51.563328 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:51.564071 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_23451: Close
[0m23:26:51.564363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4451f0>]}
[0m23:26:51.564664 [info ] [Thread-1 (]: 38 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_23451  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:51.564920 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_23451
[0m23:26:51.565095 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_57
[0m23:26:51.565334 [info ] [Thread-1 (]: 42 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_57 . [RUN]
[0m23:26:51.565524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_23451, now model.engage_analytics.qr_ipc_57)
[0m23:26:51.565682 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_57
[0m23:26:51.567708 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:26:51.567916 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:51.568076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:51.717424 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.531 seconds
[0m23:26:51.719483 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_54"
[0m23:26:51.720698 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_54
[0m23:26:51.724026 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_54"
[0m23:26:51.724565 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:26:51.724737 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: BEGIN
[0m23:26:51.725556 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:51.725830 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:26:51.726012 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 1) (id: ipc-54, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:51.727269 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:51.729980 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:26:51.730231 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54" rename to "qr_ipc_54__dbt_backup"
[0m23:26:51.730987 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.732418 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:26:51.732639 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_tmp" rename to "qr_ipc_54"
[0m23:26:51.733244 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:51.734036 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: COMMIT
[0m23:26:51.734232 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:26:51.734388 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: COMMIT
[0m23:26:51.735146 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:51.736292 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_backup"
[0m23:26:51.736520 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_54"
[0m23:26:51.736666 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_54"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_54__dbt_backup" cascade
[0m23:26:51.737824 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:51.738598 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_54: Close
[0m23:26:51.738902 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4450d0>]}
[0m23:26:51.739210 [info ] [Thread-3 (]: 39 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_54  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:51.739615 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_54
[0m23:26:51.739852 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_58
[0m23:26:51.740130 [info ] [Thread-3 (]: 43 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_58 . [RUN]
[0m23:26:51.740350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_54, now model.engage_analytics.qr_ipc_58)
[0m23:26:51.740515 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_58
[0m23:26:51.742542 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:26:51.742750 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.533 seconds
[0m23:26:51.742918 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:51.743545 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_55"
[0m23:26:51.743722 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.530 seconds
[0m23:26:51.743871 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:51.744495 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_56"
[0m23:26:51.744999 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_55
[0m23:26:51.746896 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_55"
[0m23:26:51.747208 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_56
[0m23:26:51.749133 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_56"
[0m23:26:51.749744 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:26:51.749980 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:26:51.750140 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: BEGIN
[0m23:26:51.750318 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: BEGIN
[0m23:26:51.750852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:51.751024 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:51.751201 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:26:51.751391 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:26:51.751697 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_tmp"
    
    
  as (
    

-- Short-Form PCL-5-8 (IPC Session 2) (id: ipc-56, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:51.751995 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_tmp"
    
    
  as (
    
-- IPC Session 1 (id: ipc-55, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:51.753225 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:51.753462 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:51.755336 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:26:51.757013 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:26:51.757224 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56" rename to "qr_ipc_56__dbt_backup"
[0m23:26:51.757530 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55" rename to "qr_ipc_55__dbt_backup"
[0m23:26:51.758439 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.758635 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.760164 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:26:51.762260 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:26:51.762540 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_tmp" rename to "qr_ipc_55"
[0m23:26:51.762776 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_tmp" rename to "qr_ipc_56"
[0m23:26:51.763670 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:51.764365 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: COMMIT
[0m23:26:51.764554 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:26:51.764705 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: COMMIT
[0m23:26:51.764902 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:51.765656 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: COMMIT
[0m23:26:51.765864 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:26:51.766024 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: COMMIT
[0m23:26:51.766196 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:51.803500 [debug] [Thread-4 (]: SQL status: COMMIT in 0.037 seconds
[0m23:26:51.804461 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_backup"
[0m23:26:51.805588 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_backup"
[0m23:26:51.805873 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_56"
[0m23:26:51.806095 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_55"
[0m23:26:51.806252 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_56"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_56__dbt_backup" cascade
[0m23:26:51.806408 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_55"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_55__dbt_backup" cascade
[0m23:26:51.807739 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:51.808399 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_55: Close
[0m23:26:51.808587 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:51.808947 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dada180>]}
[0m23:26:51.809491 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_56: Close
[0m23:26:51.809780 [info ] [Thread-4 (]: 40 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_55  [[32mCREATE VIEW[0m in 0.60s]
[0m23:26:51.810104 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da6f590>]}
[0m23:26:51.810386 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_55
[0m23:26:51.810696 [info ] [Thread-2 (]: 41 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_56  [[32mCREATE VIEW[0m in 0.60s]
[0m23:26:51.810938 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_59
[0m23:26:51.811227 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_56
[0m23:26:51.811463 [info ] [Thread-4 (]: 44 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_59 . [RUN]
[0m23:26:51.811675 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_60
[0m23:26:51.811870 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_55, now model.engage_analytics.qr_ipc_59)
[0m23:26:51.812138 [info ] [Thread-2 (]: 45 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_60 . [RUN]
[0m23:26:51.812366 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_59
[0m23:26:51.812539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_56, now model.engage_analytics.qr_ipc_60)
[0m23:26:51.814752 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:26:51.815034 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_60
[0m23:26:51.815263 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:51.817428 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:26:51.817924 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:51.818206 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:51.818519 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:52.111702 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.543 seconds
[0m23:26:52.114439 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_57"
[0m23:26:52.115517 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_57
[0m23:26:52.117662 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_57"
[0m23:26:52.118140 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:26:52.118315 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: BEGIN
[0m23:26:52.119109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:52.119377 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:26:52.119564 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 2) (id: ipc-57, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:52.120676 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:52.122499 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:26:52.122730 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57" rename to "qr_ipc_57__dbt_backup"
[0m23:26:52.123559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:52.125087 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:26:52.125273 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_tmp" rename to "qr_ipc_57"
[0m23:26:52.125872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.126507 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: COMMIT
[0m23:26:52.126686 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:26:52.126834 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: COMMIT
[0m23:26:52.127907 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.129167 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_backup"
[0m23:26:52.129445 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_57"
[0m23:26:52.129604 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_57"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_57__dbt_backup" cascade
[0m23:26:52.130905 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:52.131621 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_57: Close
[0m23:26:52.131905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d38c500>]}
[0m23:26:52.132217 [info ] [Thread-1 (]: 42 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_57  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:52.132533 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_57
[0m23:26:52.132777 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_ipc_61
[0m23:26:52.133041 [info ] [Thread-1 (]: 46 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_61 . [RUN]
[0m23:26:52.133262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_57, now model.engage_analytics.qr_ipc_61)
[0m23:26:52.133423 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_ipc_61
[0m23:26:52.135457 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:26:52.135666 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:52.135821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.281168 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.537 seconds
[0m23:26:52.285815 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_58"
[0m23:26:52.286984 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_58
[0m23:26:52.288877 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_58"
[0m23:26:52.289279 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:26:52.289446 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: BEGIN
[0m23:26:52.290293 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:52.290559 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:26:52.290779 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_tmp"
    
    
  as (
    
-- IPC Session 2 (id: ipc-58, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:52.291988 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:52.293512 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:26:52.293680 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58" rename to "qr_ipc_58__dbt_backup"
[0m23:26:52.294174 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.295434 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:26:52.295584 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_tmp" rename to "qr_ipc_58"
[0m23:26:52.296015 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.296629 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: COMMIT
[0m23:26:52.296773 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:26:52.296903 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: COMMIT
[0m23:26:52.297884 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.299142 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_backup"
[0m23:26:52.299416 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_58"
[0m23:26:52.299581 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_58"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_58__dbt_backup" cascade
[0m23:26:52.300720 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:52.301468 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_58: Close
[0m23:26:52.301780 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d870b30>]}
[0m23:26:52.302096 [info ] [Thread-3 (]: 43 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_58  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:52.302413 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_58
[0m23:26:52.302601 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_ipc_62
[0m23:26:52.302840 [info ] [Thread-3 (]: 47 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_62 . [RUN]
[0m23:26:52.303069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_58, now model.engage_analytics.qr_ipc_62)
[0m23:26:52.303302 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_ipc_62
[0m23:26:52.305493 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:26:52.305731 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:52.305897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:52.354599 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.536 seconds
[0m23:26:52.355237 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.537 seconds
[0m23:26:52.357764 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_60"
[0m23:26:52.359859 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_59"
[0m23:26:52.360695 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_60
[0m23:26:52.362707 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_60"
[0m23:26:52.363020 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_59
[0m23:26:52.364944 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_59"
[0m23:26:52.365398 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:26:52.365614 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:26:52.365778 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: BEGIN
[0m23:26:52.365951 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: BEGIN
[0m23:26:52.366644 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:52.366808 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:52.366958 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:26:52.367111 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:26:52.367281 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_tmp"
    
    
  as (
    
-- Short-Form PCL-5-8 (IPC Session 3) (id: ipc-60, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:52.367471 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 3) (id: ipc-59, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:52.368681 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:52.368941 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:52.370640 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:26:52.373168 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:26:52.373413 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59" rename to "qr_ipc_59__dbt_backup"
[0m23:26:52.373667 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60" rename to "qr_ipc_60__dbt_backup"
[0m23:26:52.374434 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:52.374660 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:52.376180 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:26:52.377772 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:26:52.378013 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_tmp" rename to "qr_ipc_59"
[0m23:26:52.378255 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_tmp" rename to "qr_ipc_60"
[0m23:26:52.378988 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.379675 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: COMMIT
[0m23:26:52.379862 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:26:52.380015 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: COMMIT
[0m23:26:52.380193 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:52.380797 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: COMMIT
[0m23:26:52.380964 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:26:52.381104 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: COMMIT
[0m23:26:52.381261 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.382389 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_backup"
[0m23:26:52.382694 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_59"
[0m23:26:52.382846 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_59"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_59__dbt_backup" cascade
[0m23:26:52.383018 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:52.384073 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_backup"
[0m23:26:52.384316 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_60"
[0m23:26:52.384479 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:52.384632 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_60"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_60__dbt_backup" cascade
[0m23:26:52.385230 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_59: Close
[0m23:26:52.385557 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d445070>]}
[0m23:26:52.385873 [info ] [Thread-4 (]: 44 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_59  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:52.386177 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_59
[0m23:26:52.386477 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:52.386700 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_ipc_63
[0m23:26:52.387396 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_60: Close
[0m23:26:52.387616 [info ] [Thread-4 (]: 48 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_63 . [RUN]
[0m23:26:52.388045 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_59, now model.engage_analytics.qr_ipc_63)
[0m23:26:52.388292 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_ipc_63
[0m23:26:52.388553 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d444fb0>]}
[0m23:26:52.390652 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:26:52.391014 [info ] [Thread-2 (]: 45 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_60  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:52.391341 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:52.391734 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_60
[0m23:26:52.391935 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:52.392139 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_ipc_69
[0m23:26:52.392711 [info ] [Thread-2 (]: 49 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_ipc_69 . [RUN]
[0m23:26:52.392987 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_60, now model.engage_analytics.qr_ipc_69)
[0m23:26:52.393164 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_ipc_69
[0m23:26:52.395254 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:26:52.395468 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */

    
    with ids(ident) as ( values('Questionnaire/ipc-69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:52.395629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:52.680016 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.544 seconds
[0m23:26:52.682101 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_61"
[0m23:26:52.683566 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_ipc_61
[0m23:26:52.686373 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_61"
[0m23:26:52.686873 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:26:52.687277 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: BEGIN
[0m23:26:52.688096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:52.688263 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:26:52.688425 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_tmp"
    
    
  as (
    
-- PHQ-9 (IPC Session 3) (id: ipc-61, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:52.689601 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:52.691203 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:26:52.691388 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61" rename to "qr_ipc_61__dbt_backup"
[0m23:26:52.692090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.693689 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:26:52.693950 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_tmp" rename to "qr_ipc_61"
[0m23:26:52.694618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.696504 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: COMMIT
[0m23:26:52.696707 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:26:52.696854 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: COMMIT
[0m23:26:52.697621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.698805 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_backup"
[0m23:26:52.699068 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_ipc_61"
[0m23:26:52.699236 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_61"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_61__dbt_backup" cascade
[0m23:26:52.700364 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:52.701036 [debug] [Thread-1 (]: On model.engage_analytics.qr_ipc_61: Close
[0m23:26:52.701316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7b90a0>]}
[0m23:26:52.701615 [info ] [Thread-1 (]: 46 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_61  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:52.701868 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_ipc_61
[0m23:26:52.702050 [debug] [Thread-1 (]: Began running node model.engage_analytics.practitioners
[0m23:26:52.702268 [info ] [Thread-1 (]: 50 of 84 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m23:26:52.702546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_61, now model.engage_analytics.practitioners)
[0m23:26:52.702758 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.practitioners
[0m23:26:52.704896 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.705118 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m23:26:52.705292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.746150 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.041 seconds
[0m23:26:52.747154 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.747361 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m23:26:52.748154 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:26:52.749252 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m23:26:52.750668 [debug] [Thread-1 (]: Began executing node model.engage_analytics.practitioners
[0m23:26:52.756001 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.756338 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    
  
    

  create temporary table "practitioners__dbt_tmp232652754960"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

where p._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
)

  );
  
  
[0m23:26:52.759505 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:26:52.761055 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.761239 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: BEGIN
[0m23:26:52.762045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:52.762278 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.762447 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioners__dbt_tmp232652754960'
        
      order by ordinal_position

  
[0m23:26:52.766158 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m23:26:52.767750 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.767939 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:52.769880 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:26:52.771316 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.771506 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:26:52.773429 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:26:52.774526 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m23:26:52.775015 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.775203 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioners__dbt_tmp232652754960" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" ("id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role")
    (
        select "id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role"
        from "practitioners__dbt_tmp232652754960"
    )
  
[0m23:26:52.776109 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:26:52.776904 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m23:26:52.777107 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:26:52.777266 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: COMMIT
[0m23:26:52.778185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.778600 [debug] [Thread-1 (]: On model.engage_analytics.practitioners: Close
[0m23:26:52.778922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9ba0f0>]}
[0m23:26:52.779239 [info ] [Thread-1 (]: 50 of 84 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mINSERT 0 0[0m in 0.08s]
[0m23:26:52.779561 [debug] [Thread-1 (]: Finished running node model.engage_analytics.practitioners
[0m23:26:52.779748 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_104394
[0m23:26:52.779938 [info ] [Thread-1 (]: 51 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_104394 . [RUN]
[0m23:26:52.780136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioners, now model.engage_analytics.qr_104394)
[0m23:26:52.780303 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_104394
[0m23:26:52.782581 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:26:52.782805 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:52.782973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:52.884395 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.578 seconds
[0m23:26:52.885287 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_62"
[0m23:26:52.885910 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_ipc_62
[0m23:26:52.887824 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_62"
[0m23:26:52.888250 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:26:52.888416 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: BEGIN
[0m23:26:52.889184 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:52.889445 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:26:52.889623 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_tmp"
    
    
  as (
    
-- GAD-7 (IPC Session 4) (id: ipc-62, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:52.890713 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:52.893446 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:26:52.893686 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62" rename to "qr_ipc_62__dbt_backup"
[0m23:26:52.894427 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:52.895771 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:26:52.895946 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_tmp" rename to "qr_ipc_62"
[0m23:26:52.896621 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.897333 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: COMMIT
[0m23:26:52.897526 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:26:52.897682 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: COMMIT
[0m23:26:52.898403 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.899559 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_backup"
[0m23:26:52.899864 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_ipc_62"
[0m23:26:52.900025 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_62"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_62__dbt_backup" cascade
[0m23:26:52.901083 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:52.901894 [debug] [Thread-3 (]: On model.engage_analytics.qr_ipc_62: Close
[0m23:26:52.902193 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da02420>]}
[0m23:26:52.902509 [info ] [Thread-3 (]: 47 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_62  [[32mCREATE VIEW[0m in 0.60s]
[0m23:26:52.902783 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_ipc_62
[0m23:26:52.903093 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_104453
[0m23:26:52.903389 [info ] [Thread-3 (]: 52 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_104453 . [RUN]
[0m23:26:52.903672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_62, now model.engage_analytics.qr_104453)
[0m23:26:52.903846 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_104453
[0m23:26:52.906171 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:26:52.906381 [debug] [Thread-3 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:52.906542 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:52.959826 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.568 seconds
[0m23:26:52.960668 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_63"
[0m23:26:52.961168 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_ipc_63
[0m23:26:52.963265 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_63"
[0m23:26:52.963834 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:26:52.964062 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.568 seconds
[0m23:26:52.964273 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: BEGIN
[0m23:26:52.964905 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_ipc_69"
[0m23:26:52.965331 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_ipc_69
[0m23:26:52.967086 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_ipc_69"
[0m23:26:52.967304 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:26:52.967495 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:26:52.967677 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_tmp"
    
    
  as (
    
-- IPC Session 4 (id: ipc-63, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:52.967892 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:26:52.968060 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: BEGIN
[0m23:26:52.968556 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:52.968719 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:26:52.968932 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_tmp"
    
    
  as (
    
-- eCBIS Remove Family Form (id: ipc-69, url: n/a, version: 0.0.2)




  
  

  
  

  
  

  
  
    
  

  
  
    select
      null::text as qr_id,
      null::text as questionnaire_id,
      null::text as subject_patient_id,
      null::text as encounter_id,
      null::text as author_practitioner_id,
      null::text as practitioner_location_id,
      null::text as practitioner_organization_id,
      null::text as practitioner_id,
      null::text as practitioner_careteam_id,
      null::text as application_version
    where false

  
  


  );
[0m23:26:52.969127 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:26:52.970701 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:26:52.970895 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63" rename to "qr_ipc_63__dbt_backup"
[0m23:26:52.971068 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:52.972536 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:26:52.972769 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:52.972993 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69" rename to "qr_ipc_69__dbt_backup"
[0m23:26:52.974436 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:26:52.974731 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_tmp" rename to "qr_ipc_63"
[0m23:26:52.975238 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:52.975425 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:52.977584 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:26:52.978175 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: COMMIT
[0m23:26:52.978379 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_tmp" rename to "qr_ipc_69"
[0m23:26:52.978547 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:26:52.978718 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: COMMIT
[0m23:26:52.979144 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:52.979726 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: COMMIT
[0m23:26:52.979889 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:26:52.980040 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.980191 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: COMMIT
[0m23:26:52.981540 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_backup"
[0m23:26:52.981947 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_ipc_63"
[0m23:26:52.982136 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_63"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_63__dbt_backup" cascade
[0m23:26:52.982467 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:52.983680 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_backup"
[0m23:26:52.983935 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_ipc_69"
[0m23:26:52.984095 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:52.984247 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_ipc_69"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_ipc_69__dbt_backup" cascade
[0m23:26:52.984869 [debug] [Thread-4 (]: On model.engage_analytics.qr_ipc_63: Close
[0m23:26:52.985165 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d807830>]}
[0m23:26:52.985472 [info ] [Thread-4 (]: 48 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_63  [[32mCREATE VIEW[0m in 0.60s]
[0m23:26:52.985830 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_ipc_63
[0m23:26:52.986023 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_104454
[0m23:26:52.986187 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:52.987222 [debug] [Thread-2 (]: On model.engage_analytics.qr_ipc_69: Close
[0m23:26:52.986511 [info ] [Thread-4 (]: 53 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_104454 . [RUN]
[0m23:26:52.987598 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c09b2f0>]}
[0m23:26:52.987887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_63, now model.engage_analytics.qr_104454)
[0m23:26:52.988302 [info ] [Thread-2 (]: 49 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_ipc_69  [[32mCREATE VIEW[0m in 0.59s]
[0m23:26:52.988545 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_104454
[0m23:26:52.988812 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_ipc_69
[0m23:26:52.991341 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:26:52.991708 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_104455
[0m23:26:52.991955 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:52.992256 [info ] [Thread-2 (]: 54 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_104455 . [RUN]
[0m23:26:52.992557 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:52.992934 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_ipc_69, now model.engage_analytics.qr_104455)
[0m23:26:52.993252 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_104455
[0m23:26:52.995573 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:26:52.995789 [debug] [Thread-2 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:52.995947 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:53.335067 [debug] [Thread-1 (]: SQL status: SELECT 231 in 0.552 seconds
[0m23:26:53.346661 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_104394"
[0m23:26:53.351014 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_104394
[0m23:26:53.353164 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_104394"
[0m23:26:53.354563 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:26:53.354789 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: BEGIN
[0m23:26:53.355606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:53.355772 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:26:53.357331 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 4 (id: ipc-104394, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1d9c871-c1f8-41cc-8c54-edd4e5b162fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa'
        then answer_value_text
      else null
      end
    )
    
      
            as "f952feaf-7abc-4f6f-a3bc-d10a43ea62fa"
      
    
    ,
  
    max(
      
      case
      when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "3785a264-8bd5-44ab-bf08-8aa33735c0eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0'
        then answer_value_text
      else null
      end
    )
    
      
            as "e510a8cf-0bc7-4577-b9ee-ca758d431aa0"
      
    
    ,
  
    max(
      
      case
      when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9d203bac-75fd-4f31-bed6-073502a977f3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd7644ee-28f1-4f43-a654-17fd5034d1f6"
      
    
    ,
  
    max(
      
      case
      when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "14ec8995-eee9-416f-83ad-9f44631ac9b0"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ca03155-c9ec-45e1-8cd0-5b86fa444ad0"
      
    
    ,
  
    max(
      
      case
      when linkid = '54b75d55-1c43-4552-acbf-d9754831add8'
        then answer_value_text
      else null
      end
    )
    
      
            as "54b75d55-1c43-4552-acbf-d9754831add8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46'
        then answer_value_text
      else null
      end
    )
    
      
            as "c396a3af-6f0d-4a8e-a42b-4f47bbce5f46"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e388595-a32f-4623-8c9f-3c67bad04070"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "cf896559-dff5-4704-94a0-6a6aedee53c5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7496859-63bb-4b2f-8f75-96e44e893bf7"
      
    
    ,
  
    max(
      
      case
      when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05'
        then answer_value_text
      else null
      end
    )
    
      
            as "65252389-fa9e-4ef4-93ca-e952c77c4c05"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf"
      
    
    ,
  
    max(
      
      case
      when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "3314932c-64e4-4192-b583-eb31e87da1d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99'
        then answer_value_text
      else null
      end
    )
    
      
            as "e7ba8485-5154-41b8-ac18-35410a83cd99"
      
    
    ,
  
    max(
      
      case
      when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564'
        then answer_value_text
      else null
      end
    )
    
      
            as "18d8ee56-ffd8-4711-9074-126ef2cdc564"
      
    
    ,
  
    max(
      
      case
      when linkid = '74d0f0df-e726-4c40-84ce-efece882818b'
        then answer_value_text
      else null
      end
    )
    
      
            as "74d0f0df-e726-4c40-84ce-efece882818b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131'
        then answer_value_text
      else null
      end
    )
    
      
            as "9e11ce97-90e8-42f2-ba18-8c4f0720c131"
      
    
    ,
  
    max(
      
      case
      when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2'
        then answer_value_text
      else null
      end
    )
    
      
            as "40d6a87f-9498-4cfd-b233-4610e6de08c2"
      
    
    ,
  
    max(
      
      case
      when linkid = '57e87170-761c-4b57-a09c-d50cab02860c'
        then answer_value_text
      else null
      end
    )
    
      
            as "57e87170-761c-4b57-a09c-d50cab02860c"
      
    
    ,
  
    max(
      
      case
      when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264'
        then answer_value_text
      else null
      end
    )
    
      
            as "5056d0ba-67ac-4eab-b05d-d42941f7b264"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b2e05e9-0c11-490c-bbff-278ba90d7b4e"
      
    
    ,
  
    max(
      
      case
      when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3'
        then answer_value_text
      else null
      end
    )
    
      
            as "249f5ce8-ecc0-4e43-9675-6b01ca1502a3"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f46e0ff-0532-4105-be36-0cfa9d0770f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49'
        then answer_value_text
      else null
      end
    )
    
      
            as "0397084a-cd51-4b3a-809d-970a2406ea49"
      
    
    ,
  
    max(
      
      case
      when linkid = '808ba31c-cd29-4743-8801-dfce357d5956'
        then answer_value_text
      else null
      end
    )
    
      
            as "808ba31c-cd29-4743-8801-dfce357d5956"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d82c6ae9-0516-4513-91fa-664686779d6a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc981d8a-7f22-450b-abab-3acca810ccad"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba'
        then answer_value_text
      else null
      end
    )
    
      
            as "d0aa3679-e465-4225-85d6-5822efb10eba"
      
    
    ,
  
    max(
      
      case
      when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "86da79f0-44cb-417d-ab20-c7ecc6f8f7c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36'
        then answer_value_text
      else null
      end
    )
    
      
            as "24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36"
      
    
    ,
  
    max(
      
      case
      when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149'
        then answer_value_text
      else null
      end
    )
    
      
            as "46c2861b-70a9-4fdf-94ea-e1a01cae3149"
      
    
    ,
  
    max(
      
      case
      when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed'
        then answer_value_text
      else null
      end
    )
    
      
            as "41cce38a-ca5c-4e24-904a-25b1027336ed"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2572206-b47c-4d1e-85cb-812d13a60a85"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd62b649-7209-4d32-9bbb-dc2b2823aadb"
      
    
    ,
  
    max(
      
      case
      when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47'
        then answer_value_text
      else null
      end
    )
    
      
            as "53def3a1-a7e5-4326-95f2-2561c26ecb47"
      
    
    ,
  
    max(
      
      case
      when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6'
        then answer_value_text
      else null
      end
    )
    
      
            as "33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496'
        then answer_value_text
      else null
      end
    )
    
      
            as "b6f126dd-eac5-42e4-8896-e7400b0c0496"
      
    
    ,
  
    max(
      
      case
      when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd'
        then answer_value_text
      else null
      end
    )
    
      
            as "509b140e-b195-4696-bc5f-f2fc2d2f77dd"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae4fa455-f173-435a-bb1b-4df1d1316bd9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6262800-1e24-4348-9bf2-9bb070d2f20a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae949697-92ae-476a-96cc-f8b0adc4221f"
      
    
    ,
  
    max(
      
      case
      when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031'
        then answer_value_text
      else null
      end
    )
    
      
            as "92ab6e65-f9bd-4718-8af6-f731425d3031"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec54e447-c981-4dd2-aaa4-659f8e494248"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a1c4c0d-158f-494c-a33f-1f7f8e41f21f"
      
    
    ,
  
    max(
      
      case
      when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596'
        then answer_value_text
      else null
      end
    )
    
      
            as "656a57f8-f6f0-4fc5-b347-71dd8d38f596"
      
    
    ,
  
    max(
      
      case
      when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "245e5273-e28b-41d2-a152-1f70d85576c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41'
        then answer_value_text
      else null
      end
    )
    
      
            as "2728e75c-a0e9-4cd9-8d35-962e4f71bf41"
      
    
    ,
  
    max(
      
      case
      when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99'
        then answer_value_text
      else null
      end
    )
    
      
            as "22c11dbc-73e0-4470-9ef6-d9bd01f48c99"
      
    
    ,
  
    max(
      
      case
      when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17'
        then answer_value_text
      else null
      end
    )
    
      
            as "84018cd8-9134-429c-8dfe-fd6a16e4bd17"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21'
        then answer_value_text
      else null
      end
    )
    
      
            as "f895ed4f-5004-4da4-9d59-c21293674b21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c5720a67-803f-4917-8261-3738de838418'
        then answer_value_text
      else null
      end
    )
    
      
            as "c5720a67-803f-4917-8261-3738de838418"
      
    
    ,
  
    max(
      
      case
      when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db'
        then answer_value_text
      else null
      end
    )
    
      
            as "7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db"
      
    
    ,
  
    max(
      
      case
      when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12'
        then answer_value_text
      else null
      end
    )
    
      
            as "be88b027-64b6-4c3c-bf59-36a94dc79b12"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "a0017b28-0aa9-4926-a7be-813f0a5e6bd0"
      
    
    ,
  
    max(
      
      case
      when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12'
        then answer_value_text
      else null
      end
    )
    
      
            as "01353b1d-f816-41c1-b330-910e9a76ed12"
      
    
    ,
  
    max(
      
      case
      when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13'
        then answer_value_text
      else null
      end
    )
    
      
            as "658e8c22-d6ba-480a-81e0-dc4b6164de13"
      
    
    ,
  
    max(
      
      case
      when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240'
        then answer_value_text
      else null
      end
    )
    
      
            as "796f5440-54f8-4d69-b961-a5b7e6a63240"
      
    
    ,
  
    max(
      
      case
      when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206'
        then answer_value_text
      else null
      end
    )
    
      
            as "5e2ab0f5-f5d9-4502-befe-aba770f0e206"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-4-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-4-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966'
        then answer_value_text
      else null
      end
    )
    
      
            as "c802f463-c8f5-4056-bc45-8ab8d64a1966"
      
    
    ,
  
    max(
      
      case
      when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "706fc36f-efef-4bf9-827e-7dc100cc92bc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c631e361-027c-4e4d-b894-48785a3e6dd0"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ac23c5d-0035-4895-85f2-33c2fbba8f3f"
      
    
    ,
  
    max(
      
      case
      when linkid = '45772f3f-c610-408b-942b-359769945cf4'
        then answer_value_text
      else null
      end
    )
    
      
            as "45772f3f-c610-408b-942b-359769945cf4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "dae7f411-758d-4800-9842-fc0038a6b4a4"
      
    
    ,
  
    max(
      
      case
      when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807'
        then answer_value_text
      else null
      end
    )
    
      
            as "fc5c673b-41d4-4352-86bb-043c73ed9807"
      
    
    ,
  
    max(
      
      case
      when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "229e58ac-a18a-48dd-be10-f8b024a74eb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8726638-cfdb-40ae-b72c-f1d594f64de5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b'
        then answer_value_text
      else null
      end
    )
    
      
            as "b676a0c2-cda0-4762-be79-2a94205ee68b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe2f0911-8ddc-412b-a3e6-f216620d147e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5ab53d4-824c-460f-8939-b86ff3cd97a3"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b51625b-73b9-472d-9c71-299beb26694f'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b51625b-73b9-472d-9c71-299beb26694f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec2a78e1-e70b-4f66-86b1-561cffaf9ffd"
      
    
    ,
  
    max(
      
      case
      when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a'
        then answer_value_text
      else null
      end
    )
    
      
            as "44f02467-8ee0-49f0-8da7-5e7ed827125a"
      
    
    ,
  
    max(
      
      case
      when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73'
        then answer_value_text
      else null
      end
    )
    
      
            as "88e9b865-b81a-494b-aef2-39e803b94e73"
      
    
    ,
  
    max(
      
      case
      when linkid = '7845c436-4904-41fa-9553-2c401935623b'
        then answer_value_text
      else null
      end
    )
    
      
            as "7845c436-4904-41fa-9553-2c401935623b"
      
    
    ,
  
    max(
      
      case
      when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c'
        then answer_value_text
      else null
      end
    )
    
      
            as "892337bd-d7fd-46a7-bf72-08e87c9f412c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03'
        then answer_value_text
      else null
      end
    )
    
      
            as "d5194db0-0546-4bd1-96d8-d56457930c03"
      
    
    ,
  
    max(
      
      case
      when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa'
        then answer_value_text
      else null
      end
    )
    
      
            as "40d8ef64-02f0-42ae-9478-77651bd26dfa"
      
    
    ,
  
    max(
      
      case
      when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c'
        then answer_value_text
      else null
      end
    )
    
      
            as "9faa2b78-1842-4326-bf7f-9975bf04dc2c"
      
    
    ,
  
    max(
      
      case
      when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a'
        then answer_value_text
      else null
      end
    )
    
      
            as "370c849b-0e00-42ac-be9d-3b4c719ac31a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-spi"
      
    
    ,
  
    max(
      
      case
      when linkid = 'df53c378-27fe-483d-a630-f7b171f72980'
        then answer_value_text
      else null
      end
    )
    
      
            as "df53c378-27fe-483d-a630-f7b171f72980"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95'
        then answer_value_text
      else null
      end
    )
    
      
            as "d1c2fae1-f0f5-4333-97f6-2220d2ff3d95"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac3206dd-b60b-4cb1-a559-3a770a685668"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491'
        then answer_value_text
      else null
      end
    )
    
      
            as "f39df336-a0b8-4d0b-9bd2-6c4284985491"
      
    
    ,
  
    max(
      
      case
      when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8'
        then answer_value_text
      else null
      end
    )
    
      
            as "faefef23-d2e6-4777-b628-8f83921e8fd8"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c308fef-8ce5-4217-a8d4-8e6ff00c8e14"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a57b5b34-12e5-4ec8-8215-7f316267323a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0'
        then answer_value_text
      else null
      end
    )
    
      
            as "cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0"
      
    
    ,
  
    max(
      
      case
      when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6'
        then answer_value_text
      else null
      end
    )
    
      
            as "2e03fdf1-5274-494d-88e9-dd4b41ec90e6"
      
    
    ,
  
    max(
      
      case
      when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123'
        then answer_value_text
      else null
      end
    )
    
      
            as "62b0eb17-46e5-4c50-a133-087cc190a123"
      
    
    ,
  
    max(
      
      case
      when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d'
        then answer_value_text
      else null
      end
    )
    
      
            as "991ba845-38e5-4622-8528-dfeefbf20d3d"
      
    
    ,
  
    max(
      
      case
      when linkid = '83dfd82f-0277-459d-abe3-e8795750f288'
        then answer_value_text
      else null
      end
    )
    
      
            as "83dfd82f-0277-459d-abe3-e8795750f288"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d'
        then answer_value_text
      else null
      end
    )
    
      
            as "b36fdd5f-ccac-457c-a8ea-f9497204ef1d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7513e58-a495-49d7-a549-ba4d84fb5003"
      
    
    ,
  
    max(
      
      case
      when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888'
        then answer_value_text
      else null
      end
    )
    
      
            as "101d2b7f-2b68-407d-aa49-30cb4dadc888"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af'
        then answer_value_text
      else null
      end
    )
    
      
            as "a5d96f90-cd91-4a5b-8862-c4e3f88694af"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ea8d78b-3288-4ec8-8288-459c03df64f0"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b96f1d9-3450-423d-a277-060fcfdadc6b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369'
        then answer_value_text
      else null
      end
    )
    
      
            as "9aeae470-6ea4-4e7f-9644-ed0375fb6369"
      
    
    ,
  
    max(
      
      case
      when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98'
        then answer_value_text
      else null
      end
    )
    
      
            as "176aeeb0-e173-482a-b3eb-60f59bc04f98"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-6a-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-6a-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-1-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-1-review"
      
    
    ,
  
    max(
      
      case
      when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7'
        then answer_value_text
      else null
      end
    )
    
      
            as "53072f88-a81c-4f18-a49f-f85f64fb5be7"
      
    
    ,
  
    max(
      
      case
      when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021'
        then answer_value_text
      else null
      end
    )
    
      
            as "4d334b16-ea16-4299-94ed-32e84ef97021"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "cf16ca6e-8b1b-467d-b807-fc5d50339f71"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f531e61-26cf-4223-8653-39c24d6dd478"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c'
        then answer_value_text
      else null
      end
    )
    
      
            as "f311f3ca-5537-4134-8828-5e537bb26a9c"
      
    
    ,
  
    max(
      
      case
      when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27'
        then answer_value_text
      else null
      end
    )
    
      
            as "9b1b11e8-608f-4ea9-911b-88aae467ac27"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a25cb682-be35-4909-965e-01b8c2d036a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9'
        then answer_value_text
      else null
      end
    )
    
      
            as "e45b778d-ee8c-4ee9-81f4-8927006160f9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048'
        then answer_value_text
      else null
      end
    )
    
      
            as "cce2de12-cf62-44ff-84e8-9eb4d864d048"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc"
      
    
    ,
  
    max(
      
      case
      when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52'
        then answer_value_text
      else null
      end
    )
    
      
            as "5151ea93-a0f2-478d-adb6-f31374107b52"
      
    
    ,
  
    max(
      
      case
      when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090'
        then answer_value_text
      else null
      end
    )
    
      
            as "72e5c1b7-7ce9-49bd-834b-d98b73ba7090"
      
    
    ,
  
    max(
      
      case
      when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233'
        then answer_value_text
      else null
      end
    )
    
      
            as "5846d53f-171d-47c4-89ad-4016c3be8233"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660'
        then answer_value_text
      else null
      end
    )
    
      
            as "e552afd3-2816-446e-9ff5-e898bc813660"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db'
        then answer_value_text
      else null
      end
    )
    
      
            as "c6c266cc-1c85-41c0-97ce-9ab491be45db"
      
    
    ,
  
    max(
      
      case
      when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331'
        then answer_value_text
      else null
      end
    )
    
      
            as "3ab931b8-6bfd-4e5f-b86b-3c7377907331"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897'
        then answer_value_text
      else null
      end
    )
    
      
            as "fefdc90f-fe1d-4bfb-af93-94df8c482897"
      
    
    ,
  
    max(
      
      case
      when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164'
        then answer_value_text
      else null
      end
    )
    
      
            as "83661ebe-71cf-4eab-88e3-bfecbfe35164"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449'
        then answer_value_text
      else null
      end
    )
    
      
            as "fd1498e5-abf7-4ebe-9252-97994d6b9449"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-6a'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-6a"
      
    
    ,
  
    max(
      
      case
      when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "92da95cc-50dd-4bf0-acca-4465c07d44cc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111'
        then answer_value_text
      else null
      end
    )
    
      
            as "cebffdf4-8fd1-4829-884c-41cc42bc0111"
      
    
    ,
  
    max(
      
      case
      when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5'
        then answer_value_text
      else null
      end
    )
    
      
            as "52ef2ff5-ced6-418a-b9e7-f2ef47123df5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9c42647-eefb-42bd-9080-f83630729606'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9c42647-eefb-42bd-9080-f83630729606"
      
    
    ,
  
    max(
      
      case
      when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a'
        then answer_value_text
      else null
      end
    )
    
      
            as "13e2f934-82ed-4b23-af6e-95523dc3746a"
      
    
    ,
  
    max(
      
      case
      when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8891cd7b-ad1c-4030-afe4-6752cd273cf4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "cece37bc-897b-4b48-a9c9-59ecc9f997f7"
      
    
    ,
  
    max(
      
      case
      when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d'
        then answer_value_text
      else null
      end
    )
    
      
            as "58721b3d-88ae-4888-b5ec-ef7dfe30fb3d"
      
    
    ,
  
    max(
      
      case
      when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "895fad45-c3b5-47c5-9edf-5f9b9e793fbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a33cdecd-b7e6-45d8-94b6-52fa80c64a6d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39'
        then answer_value_text
      else null
      end
    )
    
      
            as "f14c3c34-f80a-4481-9d9c-9b05267d4c39"
      
    
    ,
  
    max(
      
      case
      when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9'
        then answer_value_text
      else null
      end
    )
    
      
            as "82d6b50b-0bb2-40f6-94b1-7a4c58df43f9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268'
        then answer_value_text
      else null
      end
    )
    
      
            as "1a00c7b7-e80d-4e90-8ed4-efd8f6d96268"
      
    
    ,
  
    max(
      
      case
      when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709'
        then answer_value_text
      else null
      end
    )
    
      
            as "07c2e8dc-b48b-4bc7-b21b-c196cce32709"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf'
        then answer_value_text
      else null
      end
    )
    
      
            as "dfa1f239-2a4c-40bd-ab15-561f6d87febf"
      
    
    ,
  
    max(
      
      case
      when linkid = '53932020-eed8-46f4-8236-d548a6335a59'
        then answer_value_text
      else null
      end
    )
    
      
            as "53932020-eed8-46f4-8236-d548a6335a59"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a1155e2-6c49-4f82-a9fc-2807ee298410"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce18eee3-aa64-4423-8db1-50fe7f00850d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b'
        then answer_value_text
      else null
      end
    )
    
      
            as "c37407c5-003a-4b7c-b6a3-e10ef146a47b"
      
    
    ,
  
    max(
      
      case
      when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3'
        then answer_value_text
      else null
      end
    )
    
      
            as "39de8b74-5cbc-4225-b27b-c97e72f08af3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f'
        then answer_value_text
      else null
      end
    )
    
      
            as "bfe595d6-325f-492a-b3b6-cc5541e18c3f"
      
    
    ,
  
    max(
      
      case
      when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc'
        then answer_value_text
      else null
      end
    )
    
      
            as "2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a320b787-4cba-457f-9c60-67ff76c7020f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9e056c2-0469-4523-a28f-1000fed1a4f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e'
        then answer_value_text
      else null
      end
    )
    
      
            as "527c0166-cc35-4cc3-a9d9-7eeb0a54635e"
      
    
    ,
  
    max(
      
      case
      when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7"
      
    
    ,
  
    max(
      
      case
      when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124'
        then answer_value_text
      else null
      end
    )
    
      
            as "5324bdce-baaa-45bf-935a-eb2f65bd7124"
      
    
    ,
  
    max(
      
      case
      when linkid = '544a444d-b101-4d56-9351-00bca8ec749e'
        then answer_value_text
      else null
      end
    )
    
      
            as "544a444d-b101-4d56-9351-00bca8ec749e"
      
    
    ,
  
    max(
      
      case
      when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86'
        then answer_value_text
      else null
      end
    )
    
      
            as "13321778-b5d4-4b01-8eda-610cf0007c86"
      
    
    ,
  
    max(
      
      case
      when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc'
        then answer_value_text
      else null
      end
    )
    
      
            as "90cedcbf-bf11-4dc3-9733-42e6900a09fc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200'
        then answer_value_text
      else null
      end
    )
    
      
            as "c0655b11-8f21-47ed-8ede-95498c2e8200"
      
    
    ,
  
    max(
      
      case
      when linkid = '15e5007d-028f-4644-8fb6-0346730c3101'
        then answer_value_text
      else null
      end
    )
    
      
            as "15e5007d-028f-4644-8fb6-0346730c3101"
      
    
    ,
  
    max(
      
      case
      when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c'
        then answer_value_text
      else null
      end
    )
    
      
            as "8c1ac4fe-1d76-4436-8f34-d315c6c17b9c"
      
    
    ,
  
    max(
      
      case
      when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "87dab385-fe6b-44ce-b6b2-5771c41d82c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "40fbe8d0-4380-4efc-bb04-26fc7d3714eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3b4cf6e-385d-40b7-9380-4de2f81463de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185'
        then answer_value_text
      else null
      end
    )
    
      
            as "a842d271-cd48-47c7-963e-dcd0376ef185"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f3a622a-d39b-49b0-84e7-0bcf4f832a4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "69d5aec4-65d3-44b1-99ba-badd201769c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75'
        then answer_value_text
      else null
      end
    )
    
      
            as "6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0'
        then answer_value_text
      else null
      end
    )
    
      
            as "f8861b1c-781f-4f12-b4c8-f8110f0c2cc0"
      
    
    ,
  
    max(
      
      case
      when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7'
        then answer_value_text
      else null
      end
    )
    
      
            as "53a575e3-aa59-408d-a0dd-8df237b68bf7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531'
        then answer_value_text
      else null
      end
    )
    
      
            as "a3670632-ce8f-468a-b2f3-6934245d3531"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a9424b0-c893-4371-b5c9-bc0008be14b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54'
        then answer_value_text
      else null
      end
    )
    
      
            as "fba783e8-91d0-4a49-ba80-c55fa9e41a54"
      
    
    ,
  
    max(
      
      case
      when linkid = '437d9ea2-adb5-471a-828b-a0285a282217'
        then answer_value_text
      else null
      end
    )
    
      
            as "437d9ea2-adb5-471a-828b-a0285a282217"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14'
        then answer_value_text
      else null
      end
    )
    
      
            as "cecb89ae-abce-411c-b4ce-f84ebf59ca14"
      
    
    ,
  
    max(
      
      case
      when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea95a315-f903-4351-87ed-c1e7e7b74198"
      
    
    ,
  
    max(
      
      case
      when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd'
        then answer_value_text
      else null
      end
    )
    
      
            as "98407058-4855-44cc-ac45-6e0d0c072fdd"
      
    
    ,
  
    max(
      
      case
      when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609'
        then answer_value_text
      else null
      end
    )
    
      
            as "705df2d9-af92-4f4f-b513-17e01d07b609"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7'
        then answer_value_text
      else null
      end
    )
    
      
            as "ff115c26-95b9-4e0d-87ed-80817d438fc7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604'
        then answer_value_text
      else null
      end
    )
    
      
            as "fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604"
      
    
    ,
  
    max(
      
      case
      when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "28b2e31a-ee4d-4e99-8974-b616145311eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4a1be29-fe8b-4423-91bc-6b4f5d730e6b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-2-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-2-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e'
        then answer_value_text
      else null
      end
    )
    
      
            as "d617b1e1-ea22-4863-a878-627f6b81963e"
      
    
    ,
  
    max(
      
      case
      when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5a79866d-f1fb-4bd8-b4c4-f18c982bef3c"
      
    
    ,
  
    max(
      
      case
      when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63'
        then answer_value_text
      else null
      end
    )
    
      
            as "2a6c5feb-8034-418b-8644-142a5e31df63"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "d3340d7e-9b84-4559-8a11-bed5a662a6f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb'
        then answer_value_text
      else null
      end
    )
    
      
            as "08b5e17c-5e14-4b19-ac93-9e479cd2a2bb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d'
        then answer_value_text
      else null
      end
    )
    
      
            as "ee5d4acf-ecf0-4e62-8924-cff17a33679d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4ebe784-07d0-4312-8a46-634c0e338a54"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444'
        then answer_value_text
      else null
      end
    )
    
      
            as "d8615ac7-96b2-46a2-b3a5-b5b83945b444"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "db779cb5-5335-4eb6-8ccc-47ec94c626c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea'
        then answer_value_text
      else null
      end
    )
    
      
            as "603d1492-316f-497f-967b-5c4b1ab983ea"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a273a98-82ca-4d36-ade0-ce98f7899972"
      
    
    ,
  
    max(
      
      case
      when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81'
        then answer_value_text
      else null
      end
    )
    
      
            as "06f9231a-999b-4459-8260-6fbbcdfc5d81"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-signs-step-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-signs-step-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7e42cdb-a42b-4d22-b7a6-204de5305351"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-3-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-3-review"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b247120-23cf-45fc-9e4d-d959f0dda79f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77'
        then answer_value_text
      else null
      end
    )
    
      
            as "d1efad02-3686-4ce3-a96d-68d8c638ff77"
      
    
    ,
  
    max(
      
      case
      when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942'
        then answer_value_text
      else null
      end
    )
    
      
            as "20cae99e-ab90-4d75-92a2-c0af5dd60942"
      
    
    ,
  
    max(
      
      case
      when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969'
        then answer_value_text
      else null
      end
    )
    
      
            as "12d89dfd-5e43-4f00-8446-b3af23323969"
      
    
    ,
  
    max(
      
      case
      when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c'
        then answer_value_text
      else null
      end
    )
    
      
            as "62a04638-8928-4aab-b490-1a33739b7a5c"
      
    
    ,
  
    max(
      
      case
      when linkid = '965b7874-dd24-4215-acd4-8d241a262638'
        then answer_value_text
      else null
      end
    )
    
      
            as "965b7874-dd24-4215-acd4-8d241a262638"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6d066a2-0286-49b0-b688-34696e7fb256"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f44652f-df2d-476e-933d-75b6ed55f5f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68'
        then answer_value_text
      else null
      end
    )
    
      
            as "6f68c416-a5de-4f68-8ad0-33c6e85a9a68"
      
    
    ,
  
    max(
      
      case
      when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225'
        then answer_value_text
      else null
      end
    )
    
      
            as "1895c0a7-b090-4f49-9b0c-08dca9a7b225"
      
    
    ,
  
    max(
      
      case
      when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2'
        then answer_value_text
      else null
      end
    )
    
      
            as "2c7b6bd7-36f6-495b-9f41-eb492c07c7b2"
      
    
    ,
  
    max(
      
      case
      when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904'
        then answer_value_text
      else null
      end
    )
    
      
            as "36dd1467-a7a1-428c-bdca-17d352a79904"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce0fdd41-6b09-4104-9998-a04c5dd9a5b7"
      
    
    ,
  
    max(
      
      case
      when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de'
        then answer_value_text
      else null
      end
    )
    
      
            as "68608473-77e6-4341-9f1b-d4d18b17d3de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871'
        then answer_value_text
      else null
      end
    )
    
      
            as "a1c56f60-b823-4c15-b99d-a315d2ca1871"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9'
        then answer_value_text
      else null
      end
    )
    
      
            as "dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33'
        then answer_value_text
      else null
      end
    )
    
      
            as "a20b29af-3317-415e-9c6e-d9f3bbc4df33"
      
    
    ,
  
    max(
      
      case
      when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f'
        then answer_value_text
      else null
      end
    )
    
      
            as "11aadd88-0cf9-48b2-939d-2b3e28191c5f"
      
    
    ,
  
    max(
      
      case
      when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488'
        then answer_value_text
      else null
      end
    )
    
      
            as "68fa6f2e-84ec-4dbc-900e-10ede297c488"
      
    
    ,
  
    max(
      
      case
      when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d'
        then answer_value_text
      else null
      end
    )
    
      
            as "1d0ad825-09de-4018-a680-cd0e6bf0983d"
      
    
    ,
  
    max(
      
      case
      when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344'
        then answer_value_text
      else null
      end
    )
    
      
            as "1fc8f8e7-2022-48d2-b41d-4e8ad22af344"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:53.370740 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m23:26:53.372490 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:26:53.372691 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_tmp" rename to "qr_104394"
[0m23:26:53.375335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:53.376129 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: COMMIT
[0m23:26:53.376321 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:26:53.376470 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: COMMIT
[0m23:26:53.377780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:53.379091 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_backup"
[0m23:26:53.379372 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:26:53.379546 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_backup" cascade
[0m23:26:53.380238 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:53.380987 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: Close
[0m23:26:53.381295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8f0470>]}
[0m23:26:53.381680 [info ] [Thread-1 (]: 51 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_104394  [[32mCREATE VIEW[0m in 0.60s]
[0m23:26:53.382035 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_104394
[0m23:26:53.382237 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_1613531
[0m23:26:53.382506 [info ] [Thread-1 (]: 55 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_1613531  [RUN]
[0m23:26:53.382723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104394, now model.engage_analytics.qr_1613531)
[0m23:26:53.382884 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_1613531
[0m23:26:53.385149 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:26:53.385363 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:53.385567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:53.442028 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.535 seconds
[0m23:26:53.443642 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_104453"
[0m23:26:53.444200 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_104453
[0m23:26:53.446483 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_104453"
[0m23:26:53.446917 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:26:53.447084 [debug] [Thread-3 (]: On model.engage_analytics.qr_104453: BEGIN
[0m23:26:53.447728 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:53.447884 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:26:53.448149 [debug] [Thread-3 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 2 (id: ipc-104453, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896'
        then answer_value_text
      else null
      end
    )
    
      
            as "27b1e829-9ad9-41c2-8cb5-01ce1f469896"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c804862-f4b9-49df-aae4-c7802e723c76"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b'
        then answer_value_text
      else null
      end
    )
    
      
            as "2dd6c90f-ea68-45ba-9d30-58e02ab0812b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253'
        then answer_value_text
      else null
      end
    )
    
      
            as "f4b782e5-18e1-4edf-a3ff-409feb207253"
      
    
    ,
  
    max(
      
      case
      when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f'
        then answer_value_text
      else null
      end
    )
    
      
            as "53b30f12-74eb-474c-941c-5f0e81b7eb9f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '783e2646-c8ea-466d-bba8-85c891a14435'
        then answer_value_text
      else null
      end
    )
    
      
            as "783e2646-c8ea-466d-bba8-85c891a14435"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "ed537539-d317-43fc-a4b3-38de5e15ea4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36'
        then answer_value_text
      else null
      end
    )
    
      
            as "18c6510f-b294-4741-ae43-9cbbc4ba7e36"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50'
        then answer_value_text
      else null
      end
    )
    
      
            as "d02eb882-411e-4bc0-af9d-08a77fcc3f50"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:53.450967 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:53.452515 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:26:53.452698 [debug] [Thread-3 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_tmp" rename to "qr_104453"
[0m23:26:53.453749 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:53.454319 [debug] [Thread-3 (]: On model.engage_analytics.qr_104453: COMMIT
[0m23:26:53.454489 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:26:53.454630 [debug] [Thread-3 (]: On model.engage_analytics.qr_104453: COMMIT
[0m23:26:53.455599 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:53.456818 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_backup"
[0m23:26:53.457077 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:26:53.457234 [debug] [Thread-3 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_backup" cascade
[0m23:26:53.457812 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:53.458506 [debug] [Thread-3 (]: On model.engage_analytics.qr_104453: Close
[0m23:26:53.458795 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9742c0>]}
[0m23:26:53.459109 [info ] [Thread-3 (]: 52 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_104453  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:53.459383 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_104453
[0m23:26:53.459566 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_1613532
[0m23:26:53.459849 [info ] [Thread-3 (]: 56 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_1613532  [RUN]
[0m23:26:53.460056 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104453, now model.engage_analytics.qr_1613532)
[0m23:26:53.460305 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_1613532
[0m23:26:53.462655 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:26:53.462892 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:53.463062 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:53.527635 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.535 seconds
[0m23:26:53.528730 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_104454"
[0m23:26:53.529165 [debug] [Thread-2 (]: SQL status: SELECT 24 in 0.533 seconds
[0m23:26:53.531184 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_104455"
[0m23:26:53.531513 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_104454
[0m23:26:53.533258 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_104454"
[0m23:26:53.533667 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:26:53.533847 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: BEGIN
[0m23:26:53.534049 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_104455
[0m23:26:53.535783 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_104455"
[0m23:26:53.535983 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:26:53.536189 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:26:53.536420 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 3 (id: ipc-104454, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:53.536740 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:26:53.536895 [debug] [Thread-2 (]: On model.engage_analytics.qr_104455: BEGIN
[0m23:26:53.537318 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:53.537481 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:26:53.537814 [debug] [Thread-2 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 1 (id: ipc-104455, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda'
        then answer_value_text
      else null
      end
    )
    
      
            as "7fc39fba-84db-490d-af4e-8f772d91ffda"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423'
        then answer_value_text
      else null
      end
    )
    
      
            as "c7d21a57-0fc6-4e3a-b411-beceb1fb2423"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837'
        then answer_value_text
      else null
      end
    )
    
      
            as "644c00f2-8b07-4911-92d0-f05f5e5cc837"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03'
        then answer_value_text
      else null
      end
    )
    
      
            as "43898926-e9d5-400e-a095-62a8c7f8dd03"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6601f97-0a34-49d0-b181-611d6705ca42"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e9233a-9ab1-410a-b5e3-b30867355cea"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019'
        then answer_value_text
      else null
      end
    )
    
      
            as "ecabd308-c45a-41f7-8754-b1f63a101019"
      
    
    ,
  
    max(
      
      case
      when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "2897fef9-abcf-4bb3-b33f-2accae4c06c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f85f2ef-d781-4001-8df5-99a9ac5a656b"
      
    
    ,
  
    max(
      
      case
      when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511'
        then answer_value_text
      else null
      end
    )
    
      
            as "7cc2e8a9-197a-42ea-9431-ba01eefc6511"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2a74544-b333-4767-b3e3-7772413419ce"
      
    
    ,
  
    max(
      
      case
      when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb'
        then answer_value_text
      else null
      end
    )
    
      
            as "41aee132-ab8e-4d64-a322-eed88f900edb"
      
    
    ,
  
    max(
      
      case
      when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d'
        then answer_value_text
      else null
      end
    )
    
      
            as "06e33f1f-7202-4d5e-94d1-efbeabaa3e7d"
      
    
    ,
  
    max(
      
      case
      when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9'
        then answer_value_text
      else null
      end
    )
    
      
            as "71dbaac9-867f-4d7f-b6d7-e1f59402bbf9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '35062b98-748b-441c-ad74-185823e1bb52'
        then answer_value_text
      else null
      end
    )
    
      
            as "35062b98-748b-441c-ad74-185823e1bb52"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "d60ed1ee-79c9-444f-aff7-d346974426ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23'
        then answer_value_text
      else null
      end
    )
    
      
            as "567e992d-fb9e-4608-9be1-9277beae3c23"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:53.538465 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:53.540134 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:26:53.540354 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_tmp" rename to "qr_104454"
[0m23:26:53.540922 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:53.541195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:53.542803 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:26:53.543496 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: COMMIT
[0m23:26:53.543711 [debug] [Thread-2 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_tmp" rename to "qr_104455"
[0m23:26:53.543927 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:26:53.544163 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: COMMIT
[0m23:26:53.544994 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:53.545223 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:53.547255 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_backup"
[0m23:26:53.547936 [debug] [Thread-2 (]: On model.engage_analytics.qr_104455: COMMIT
[0m23:26:53.548207 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:26:53.548388 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:26:53.548559 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_backup" cascade
[0m23:26:53.548717 [debug] [Thread-2 (]: On model.engage_analytics.qr_104455: COMMIT
[0m23:26:53.549557 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:53.549824 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:53.554681 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: Close
[0m23:26:53.555939 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_backup"
[0m23:26:53.556309 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:26:53.556655 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11daeea80>]}
[0m23:26:53.556927 [debug] [Thread-2 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_backup" cascade
[0m23:26:53.558377 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:53.559202 [debug] [Thread-2 (]: On model.engage_analytics.qr_104455: Close
[0m23:26:53.559507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d904950>]}
[0m23:26:53.647854 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m23:26:53.648271 [info ] [Thread-2 (]: 54 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_104455  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:53.648795 [info ] [Thread-4 (]: 53 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_104454  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:53.649100 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_104455
[0m23:26:53.649339 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_104454
[0m23:26:53.649539 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m23:26:53.649712 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_202
[0m23:26:53.649950 [info ] [Thread-2 (]: 57 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m23:26:53.650171 [info ] [Thread-4 (]: 58 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_202 .... [RUN]
[0m23:26:53.650452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104455, now model.engage_analytics.qr_1_month_follow_up)
[0m23:26:53.650619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104454, now model.engage_analytics.qr_202)
[0m23:26:53.650775 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m23:26:53.650920 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_202
[0m23:26:53.653347 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:26:53.655893 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:26:53.656193 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:53.656386 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:53.656579 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:53.656746 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:53.933872 [debug] [Thread-1 (]: SQL status: SELECT 25 in 0.548 seconds
[0m23:26:53.938539 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_1613531"
[0m23:26:53.940554 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_1613531
[0m23:26:53.942549 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_1613531"
[0m23:26:53.943036 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:26:53.943208 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: BEGIN
[0m23:26:53.944063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:53.944286 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:26:53.944639 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Sociodemographic Survey (id: 1613531, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cce9788-d7e7-4456-d455-5bd8dc3d2f2a"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b68e9a3-703a-4b57-876e-8dd400826db9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4afce83-4279-4d19-8a8b-1e0b7e1ba73c"
      
    
    ,
  
    max(
      
      case
      when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4'
        then answer_value_text
      else null
      end
    )
    
      
            as "6e621fcc-a25c-4070-8fda-894bb9df68e4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f'
        then answer_value_text
      else null
      end
    )
    
      
            as "f11fe547-9be9-4693-8a85-f252e4a6262f"
      
    
    ,
  
    max(
      
      case
      when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173'
        then answer_value_text
      else null
      end
    )
    
      
            as "5b133a13-0303-4d2f-8884-ffa931d2c173"
      
    
    ,
  
    max(
      
      case
      when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7'
        then answer_value_text
      else null
      end
    )
    
      
            as "05990b62-11a8-4ab7-8988-1d2a17edcff7"
      
    
    ,
  
    max(
      
      case
      when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5'
        then answer_value_text
      else null
      end
    )
    
      
            as "0e027468-c1e9-4977-f5f5-1cfa00ab8af5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "8f600ee9-8d17-43df-ed68-c9a7de2da7d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-socio-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-socio-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba'
        then answer_value_text
      else null
      end
    )
    
      
            as "d7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f8a7973-d9bb-493b-aa68-fb01e0f1aefe"
      
    
    ,
  
    max(
      
      case
      when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde'
        then answer_value_text
      else null
      end
    )
    
      
            as "1fdf1a17-7af6-413f-81e9-cf6823fe7fde"
      
    
    ,
  
    max(
      
      case
      when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af'
        then answer_value_text
      else null
      end
    )
    
      
            as "3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af"
      
    
    ,
  
    max(
      
      case
      when linkid = '92fed595-49f2-4fab-81ff-885941f31e07'
        then answer_value_text
      else null
      end
    )
    
      
            as "92fed595-49f2-4fab-81ff-885941f31e07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130'
        then answer_value_text
      else null
      end
    )
    
      
            as "66d30814-73ea-4fa4-edf8-d0d79378b130"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-biological-sex'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-biological-sex"
      
    
    ,
  
    max(
      
      case
      when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739'
        then answer_value_text
      else null
      end
    )
    
      
            as "3960c72d-b6e7-418e-86e9-f8348a49e739"
      
    
    ,
  
    max(
      
      case
      when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d'
        then answer_value_text
      else null
      end
    )
    
      
            as "4baa9e68-fe7a-489a-8b03-cc045b53d93d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:53.948079 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:53.949674 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:26:53.949928 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_tmp" rename to "qr_1613531"
[0m23:26:53.950992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:53.951723 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: COMMIT
[0m23:26:53.951907 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:26:53.952060 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: COMMIT
[0m23:26:53.952971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:53.954210 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_backup"
[0m23:26:53.954486 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:26:53.954649 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_backup" cascade
[0m23:26:53.955210 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:53.955890 [debug] [Thread-1 (]: On model.engage_analytics.qr_1613531: Close
[0m23:26:53.956167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d71dfa0>]}
[0m23:26:53.956472 [info ] [Thread-1 (]: 55 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_1613531  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:53.957171 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_1613531
[0m23:26:53.957430 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_203
[0m23:26:53.957709 [info ] [Thread-1 (]: 59 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_203 .... [RUN]
[0m23:26:53.957937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613531, now model.engage_analytics.qr_203)
[0m23:26:53.958102 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_203
[0m23:26:53.960317 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:26:53.960551 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:53.960733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:54.000112 [debug] [Thread-3 (]: SQL status: SELECT 37 in 0.537 seconds
[0m23:26:54.003197 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_1613532"
[0m23:26:54.004001 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_1613532
[0m23:26:54.006064 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_1613532"
[0m23:26:54.006654 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:26:54.006833 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: BEGIN
[0m23:26:54.007612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:54.007778 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:26:54.008169 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mental Wellness Tool (id: 1613532, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'q1-to-q3-negative'
        then answer_value_text
      else null
      end
    )
    
      
            as "q1-to-q3-negative"
      
    
    ,
  
    max(
      
      case
      when linkid = 'suicide-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "suicide-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'severe-mental-health'
        then answer_value_text
      else null
      end
    )
    
      
            as "severe-mental-health"
      
    
    ,
  
    max(
      
      case
      when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63'
        then answer_value_text
      else null
      end
    )
    
      
            as "59ae2c65-3a25-4acb-9db5-7aa035c54a63"
      
    
    ,
  
    max(
      
      case
      when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc'
        then answer_value_text
      else null
      end
    )
    
      
            as "2c50fee4-7a5d-4d62-80aa-73329934d7dc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-mental-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-mental-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = 'alcohol-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "alcohol-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642'
        then answer_value_text
      else null
      end
    )
    
      
            as "156fce37-203f-4760-a9f9-1b8ab0ae0642"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-socio-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-socio-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a051272-efb0-4f1f-acc7-f5038989207f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588'
        then answer_value_text
      else null
      end
    )
    
      
            as "4602f806-3bf4-4f16-bee1-c2e690dca588"
      
    
    ,
  
    max(
      
      case
      when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab'
        then answer_value_text
      else null
      end
    )
    
      
            as "364e4271-e89d-4206-85a1-45ad595e4cab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f'
        then answer_value_text
      else null
      end
    )
    
      
            as "97f2ed48-11d2-4417-a4b2-57a333c5157f"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e7579d-ac74-4d72-955b-1a3675a2e656"
      
    
    ,
  
    max(
      
      case
      when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29'
        then answer_value_text
      else null
      end
    )
    
      
            as "80499f94-3f2a-4f0f-9a21-7fa252b33e29"
      
    
    ,
  
    max(
      
      case
      when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20'
        then answer_value_text
      else null
      end
    )
    
      
            as "69a559db-c97b-4bcb-aae4-81465fdd1d20"
      
    
    ,
  
    max(
      
      case
      when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "99f0d10e-9522-457f-8432-fd489c53acb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b9ecb840-8515-4091-8cef-863ed297012e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'common-mental-health'
        then answer_value_text
      else null
      end
    )
    
      
            as "common-mental-health"
      
    
    ,
  
    max(
      
      case
      when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73'
        then answer_value_text
      else null
      end
    )
    
      
            as "94f913ce-e837-48b3-906d-a0613ac72b73"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77'
        then answer_value_text
      else null
      end
    )
    
      
            as "a669eaea-2f12-49ff-ac91-d54009d6ab77"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d'
        then answer_value_text
      else null
      end
    )
    
      
            as "f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20'
        then answer_value_text
      else null
      end
    )
    
      
            as "11e90302-2ae0-4e7d-be11-754b2a91ab20"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-biological-sex'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-biological-sex"
      
    
    ,
  
    max(
      
      case
      when linkid = 'how-many-drinks'
        then answer_value_text
      else null
      end
    )
    
      
            as "how-many-drinks"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-common-mental-health-form'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-common-mental-health-form"
      
    
    ,
  
    max(
      
      case
      when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6'
        then answer_value_text
      else null
      end
    )
    
      
            as "0ee3228d-28b6-4c88-8119-808fc121aaa6"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e9014d1-e07c-492e-897a-3bf7e8f6f018"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-mwtool-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-mwtool-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:54.011927 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:54.013507 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:26:54.013729 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_tmp" rename to "qr_1613532"
[0m23:26:54.014786 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:54.015424 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: COMMIT
[0m23:26:54.015603 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:26:54.015753 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: COMMIT
[0m23:26:54.016600 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:54.017743 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_backup"
[0m23:26:54.017983 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:26:54.018131 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_backup" cascade
[0m23:26:54.018693 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:54.019323 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: Close
[0m23:26:54.019601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9367b0>]}
[0m23:26:54.019902 [info ] [Thread-3 (]: 56 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_1613532  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:54.020159 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_1613532
[0m23:26:54.020339 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_204
[0m23:26:54.020555 [info ] [Thread-3 (]: 60 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_204 .... [RUN]
[0m23:26:54.020798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613532, now model.engage_analytics.qr_204)
[0m23:26:54.021002 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_204
[0m23:26:54.023654 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:26:54.023928 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:54.024102 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:54.197275 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.540 seconds
[0m23:26:54.200203 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m23:26:54.200569 [debug] [Thread-4 (]: SQL status: SELECT 18 in 0.544 seconds
[0m23:26:54.202357 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_202"
[0m23:26:54.202936 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m23:26:54.204776 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m23:26:54.205089 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_202
[0m23:26:54.206980 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_202"
[0m23:26:54.207401 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:26:54.207594 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m23:26:54.207813 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:26:54.207983 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: BEGIN
[0m23:26:54.208300 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:54.208653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:54.208832 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:26:54.209013 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:26:54.209223 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- 1 month follow up (id: 1-month-follow-up, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'completed-all-recommended-interventions'
        then answer_value_text
      else null
      end
    )
    
      
            as "completed-all-recommended-interventions"
      
    
    ,
  
    max(
      
      case
      when linkid = 'schedule-this-meeting'
        then answer_value_text
      else null
      end
    )
    
      
            as "schedule-this-meeting"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:54.209563 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 1) (id: ipc-202, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-gad-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-gad-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9'
        then answer_value_text
      else null
      end
    )
    
      
            as "69f16284-b8a8-4a24-ab79-03bde5bcfbe9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603'
        then answer_value_text
      else null
      end
    )
    
      
            as "829e6d32-3fa7-4d16-909b-b198aea54603"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "583c5b02-b26c-4821-8da8-7ed9066d9d5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:54.211763 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:54.213300 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:26:54.213523 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:54.213689 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m23:26:54.215206 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:26:54.215496 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_tmp" rename to "qr_202"
[0m23:26:54.216056 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:54.217580 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m23:26:54.217785 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:26:54.217956 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:54.218126 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m23:26:54.218710 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: COMMIT
[0m23:26:54.218916 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:26:54.219066 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: COMMIT
[0m23:26:54.219583 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:54.220807 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m23:26:54.221093 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:26:54.221275 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:54.221471 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m23:26:54.222576 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_backup"
[0m23:26:54.222949 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:26:54.223138 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_backup" cascade
[0m23:26:54.223310 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:54.224004 [debug] [Thread-2 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m23:26:54.224192 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:54.224477 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db17d10>]}
[0m23:26:54.225183 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: Close
[0m23:26:54.225531 [info ] [Thread-2 (]: 57 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:54.225893 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m23:26:54.226203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da963f0>]}
[0m23:26:54.226546 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_205
[0m23:26:54.226947 [info ] [Thread-4 (]: 58 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_202  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:54.227518 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_202
[0m23:26:54.227717 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_206
[0m23:26:54.227205 [info ] [Thread-2 (]: 61 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_205 .... [RUN]
[0m23:26:54.227928 [info ] [Thread-4 (]: 62 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_206 .... [RUN]
[0m23:26:54.228315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_205)
[0m23:26:54.228499 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_202, now model.engage_analytics.qr_206)
[0m23:26:54.228660 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_205
[0m23:26:54.228810 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_206
[0m23:26:54.231076 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:26:54.233571 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:26:54.233849 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:54.234035 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:54.234197 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:54.234342 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:54.498390 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.537 seconds
[0m23:26:54.502902 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_203"
[0m23:26:54.503949 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_203
[0m23:26:54.506069 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_203"
[0m23:26:54.506464 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:26:54.506645 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: BEGIN
[0m23:26:54.507410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:54.507578 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:26:54.507811 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 1) (id: ipc-203, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727'
        then answer_value_text
      else null
      end
    )
    
      
            as "8085cded-8e0f-497f-9e3d-5fab3981d727"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "d58c8907-06c6-4071-aa6c-b2b95d2169c7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:54.510512 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:54.512035 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:26:54.512213 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_tmp" rename to "qr_203"
[0m23:26:54.513107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:54.513658 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: COMMIT
[0m23:26:54.513813 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:26:54.513946 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: COMMIT
[0m23:26:54.515013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:54.516338 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_backup"
[0m23:26:54.516651 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:26:54.516819 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_backup" cascade
[0m23:26:54.517345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:54.518033 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: Close
[0m23:26:54.518305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8335c0>]}
[0m23:26:54.518613 [info ] [Thread-1 (]: 59 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_203  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:54.518881 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_203
[0m23:26:54.519062 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_207
[0m23:26:54.519290 [info ] [Thread-1 (]: 63 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_207 .... [RUN]
[0m23:26:54.519486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_203, now model.engage_analytics.qr_207)
[0m23:26:54.519639 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_207
[0m23:26:54.522192 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:26:54.522437 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:54.522602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:54.563752 [debug] [Thread-3 (]: SQL status: SELECT 28 in 0.539 seconds
[0m23:26:54.568740 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_204"
[0m23:26:54.570302 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_204
[0m23:26:54.572344 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_204"
[0m23:26:54.572824 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:26:54.572993 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: BEGIN
[0m23:26:54.573700 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:54.573903 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:26:54.574253 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 1) (id: ipc-204, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '16d05294-fee9-4d42-8447-0d578a5de192'
        then answer_value_text
      else null
      end
    )
    
      
            as "16d05294-fee9-4d42-8447-0d578a5de192"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f'
        then answer_value_text
      else null
      end
    )
    
      
            as "790391ba-cf9f-4ef6-be11-b5a7b468819f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7934aa5-17f0-4320-8f65-e7a7f72c5161"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d74aecd2-f0c4-4207-b396-b2c6d780be4a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505'
        then answer_value_text
      else null
      end
    )
    
      
            as "2171a88a-4e4d-44c4-b6b3-389723e9b505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-ptsd-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-ptsd-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:54.577650 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:54.579327 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:26:54.579574 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_tmp" rename to "qr_204"
[0m23:26:54.580653 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:54.581426 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: COMMIT
[0m23:26:54.581631 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:26:54.581789 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: COMMIT
[0m23:26:54.582739 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:54.583956 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_backup"
[0m23:26:54.584255 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:26:54.584432 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_backup" cascade
[0m23:26:54.585046 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:54.585689 [debug] [Thread-3 (]: On model.engage_analytics.qr_204: Close
[0m23:26:54.585971 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db13f50>]}
[0m23:26:54.586282 [info ] [Thread-3 (]: 60 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_204  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:54.586579 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_204
[0m23:26:54.586759 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_208
[0m23:26:54.586978 [info ] [Thread-3 (]: 64 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_208 .... [RUN]
[0m23:26:54.587174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_204, now model.engage_analytics.qr_208)
[0m23:26:54.587328 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_208
[0m23:26:54.589937 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:26:54.590198 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:54.590365 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:54.812920 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.579 seconds
[0m23:26:54.814399 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_205"
[0m23:26:54.814683 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.580 seconds
[0m23:26:54.815640 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_206"
[0m23:26:54.816126 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_206
[0m23:26:54.818001 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_206"
[0m23:26:54.818285 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_205
[0m23:26:54.820113 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_205"
[0m23:26:54.820515 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:26:54.820694 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: BEGIN
[0m23:26:54.820974 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:26:54.821178 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: BEGIN
[0m23:26:54.821405 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:54.821634 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:26:54.821819 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:54.822060 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 2) (id: ipc-206, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07'
        then answer_value_text
      else null
      end
    )
    
      
            as "85a3f14c-e4d8-4c45-9088-967ec4ea0d07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:54.822292 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:26:54.822603 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 2) (id: ipc-205, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-gad-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-gad-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110'
        then answer_value_text
      else null
      end
    )
    
      
            as "510776d6-8b4e-446b-abe7-80aee8ecb110"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23'
        then answer_value_text
      else null
      end
    )
    
      
            as "37e0bcfd-f6d1-4b35-9556-4d458a717a23"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:54.824538 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:54.826081 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:26:54.826262 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_tmp" rename to "qr_206"
[0m23:26:54.826476 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:26:54.828682 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:26:54.828914 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:54.829135 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_tmp" rename to "qr_205"
[0m23:26:54.829881 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: COMMIT
[0m23:26:54.830161 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:26:54.830332 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: COMMIT
[0m23:26:54.830829 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:54.831498 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: COMMIT
[0m23:26:54.831677 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:26:54.831866 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:54.832074 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: COMMIT
[0m23:26:54.869062 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_backup"
[0m23:26:54.869418 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:26:54.869592 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_backup" cascade
[0m23:26:54.869786 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:54.870914 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_backup"
[0m23:26:54.871112 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:54.871351 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:26:54.872012 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: Close
[0m23:26:54.872180 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_backup" cascade
[0m23:26:54.872558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da362d0>]}
[0m23:26:54.872941 [info ] [Thread-4 (]: 62 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_206  [[32mCREATE VIEW[0m in 0.64s]
[0m23:26:54.873172 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:54.873409 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_206
[0m23:26:54.874057 [debug] [Thread-2 (]: On model.engage_analytics.qr_205: Close
[0m23:26:54.874249 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_209
[0m23:26:54.874500 [info ] [Thread-4 (]: 65 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_209 .... [RUN]
[0m23:26:54.874883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbaa7e0>]}
[0m23:26:54.875124 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_206, now model.engage_analytics.qr_209)
[0m23:26:54.875504 [info ] [Thread-2 (]: 61 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_205  [[32mCREATE VIEW[0m in 0.65s]
[0m23:26:54.875793 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_209
[0m23:26:54.876070 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_205
[0m23:26:54.878563 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:26:54.878833 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_210
[0m23:26:54.879026 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:54.879276 [info ] [Thread-2 (]: 66 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_210 .... [RUN]
[0m23:26:54.879467 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:54.879728 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_205, now model.engage_analytics.qr_210)
[0m23:26:54.880246 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_210
[0m23:26:54.882596 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:26:54.882830 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:54.882997 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:55.107360 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.584 seconds
[0m23:26:55.111804 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_207"
[0m23:26:55.112331 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_207
[0m23:26:55.114157 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_207"
[0m23:26:55.114535 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:26:55.114699 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: BEGIN
[0m23:26:55.115488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:55.115761 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:26:55.115979 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 3) (id: ipc-207, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "2fb4f2f4-23b5-4f36-b444-683563ea4fb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:55.118436 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:55.120016 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:26:55.120199 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_tmp" rename to "qr_207"
[0m23:26:55.121010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:55.121627 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: COMMIT
[0m23:26:55.121795 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:26:55.121935 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: COMMIT
[0m23:26:55.122886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:55.124161 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_backup"
[0m23:26:55.124501 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:26:55.124673 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_backup" cascade
[0m23:26:55.125308 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:55.125960 [debug] [Thread-1 (]: On model.engage_analytics.qr_207: Close
[0m23:26:55.126233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8b21b0>]}
[0m23:26:55.126534 [info ] [Thread-1 (]: 63 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_207  [[32mCREATE VIEW[0m in 0.61s]
[0m23:26:55.126855 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_207
[0m23:26:55.127126 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_211
[0m23:26:55.127354 [info ] [Thread-1 (]: 67 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_211 .... [RUN]
[0m23:26:55.127572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_207, now model.engage_analytics.qr_211)
[0m23:26:55.127737 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_211
[0m23:26:55.129995 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:26:55.130218 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:55.130382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:55.171332 [debug] [Thread-3 (]: SQL status: SELECT 97 in 0.581 seconds
[0m23:26:55.180439 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_208"
[0m23:26:55.182389 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_208
[0m23:26:55.184389 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_208"
[0m23:26:55.185974 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:26:55.186214 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: BEGIN
[0m23:26:55.187634 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:55.188113 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:26:55.188911 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 3 (id: ipc-208, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '6930d457-7bec-4983-832b-3220b163f505'
        then answer_value_text
      else null
      end
    )
    
      
            as "6930d457-7bec-4983-832b-3220b163f505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243'
        then answer_value_text
      else null
      end
    )
    
      
            as "57a5ca78-4761-466a-bba4-c0c84eab5243"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9543e3c-cbff-4d2a-b3df-bf96e509d9ca"
      
    
    ,
  
    max(
      
      case
      when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a'
        then answer_value_text
      else null
      end
    )
    
      
            as "1b59ddeb-483d-4b1b-af53-f3942204589a"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ed77f2a-0d5a-434d-b153-d8deadfbc3f8"
      
    
    ,
  
    max(
      
      case
      when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "0a15f38b-027a-42ff-b1e8-ca5e2b313f71"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19'
        then answer_value_text
      else null
      end
    )
    
      
            as "70e4d965-a614-4dc5-b2fa-4035f0444b19"
      
    
    ,
  
    max(
      
      case
      when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553'
        then answer_value_text
      else null
      end
    )
    
      
            as "601055c1-efe3-47d4-9510-1ed0cc565553"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ad7384f-a332-4e41-9318-0d3f9e540ee7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1755ad4-b33a-44a3-b562-4206a582c28a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "2fb4f2f4-23b5-4f36-b444-683563ea4fb3"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f1e5102-4441-49d8-9fbc-4ea6df196b43"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a126244-6ec2-4c81-a6d4-409dff788019"
      
    
    ,
  
    max(
      
      case
      when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473'
        then answer_value_text
      else null
      end
    )
    
      
            as "68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e17756cd-4861-4dde-859c-f90241977246'
        then answer_value_text
      else null
      end
    )
    
      
            as "e17756cd-4861-4dde-859c-f90241977246"
      
    
    ,
  
    max(
      
      case
      when linkid = '95121ef1-bfe5-40ce-841c-524334644148'
        then answer_value_text
      else null
      end
    )
    
      
            as "95121ef1-bfe5-40ce-841c-524334644148"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb78f289-5f7d-4c89-9ddf-6b393a268462"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f926bba-38b5-4b20-8852-5b9e317bb010"
      
    
    ,
  
    max(
      
      case
      when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263'
        then answer_value_text
      else null
      end
    )
    
      
            as "86bdafab-bb90-429e-8bc5-a90dc46e7263"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-2"
      
    
    ,
  
    max(
      
      case
      when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73'
        then answer_value_text
      else null
      end
    )
    
      
            as "747188c8-4fc0-43ea-92b4-9baa32567f73"
      
    
    ,
  
    max(
      
      case
      when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b'
        then answer_value_text
      else null
      end
    )
    
      
            as "55092b78-a252-44ed-9dcb-2fc78570dc8b"
      
    
    ,
  
    max(
      
      case
      when linkid = '547a07c2-f94c-4956-997f-0439626d0251'
        then answer_value_text
      else null
      end
    )
    
      
            as "547a07c2-f94c-4956-997f-0439626d0251"
      
    
    ,
  
    max(
      
      case
      when linkid = '920de190-557a-4233-91a3-4bf293f18214'
        then answer_value_text
      else null
      end
    )
    
      
            as "920de190-557a-4233-91a3-4bf293f18214"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ff4b5cb-2c44-434b-90e9-85c61a858097"
      
    
    ,
  
    max(
      
      case
      when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414'
        then answer_value_text
      else null
      end
    )
    
      
            as "83176bb3-c0cb-445a-a91b-6711635b1414"
      
    
    ,
  
    max(
      
      case
      when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90'
        then answer_value_text
      else null
      end
    )
    
      
            as "10cd5560-6c41-41a6-94c5-af74ce96dc90"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-021'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-021"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9'
        then answer_value_text
      else null
      end
    )
    
      
            as "a24c89ff-1e14-403c-8dfa-26fc6c1103d9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb8828db-1674-47e7-ba9a-e3c161160b65"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f63637c-1de2-4851-a088-c3b08152447e'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f63637c-1de2-4851-a088-c3b08152447e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44'
        then answer_value_text
      else null
      end
    )
    
      
            as "eea0b1ca-5582-4b45-b5cf-36bc0665ba44"
      
    
    ,
  
    max(
      
      case
      when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975'
        then answer_value_text
      else null
      end
    )
    
      
            as "5db949bd-4ebf-4d52-b850-8e951455e975"
      
    
    ,
  
    max(
      
      case
      when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "8c82f757-3f40-4b09-bdf4-78ee376f75a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c'
        then answer_value_text
      else null
      end
    )
    
      
            as "1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e0b76f9-0902-43ba-b858-0b1505e9d168"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359'
        then answer_value_text
      else null
      end
    )
    
      
            as "e245b7d9-955a-4c4b-a107-e2bf5d6d2359"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a77f07b3-7913-4708-a354-14e503a948f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd'
        then answer_value_text
      else null
      end
    )
    
      
            as "8ac792f5-3f3c-49d3-a800-63c662bf00cd"
      
    
    ,
  
    max(
      
      case
      when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3'
        then answer_value_text
      else null
      end
    )
    
      
            as "50cf6a9c-a837-4531-a13a-47381657c2b3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "c91209cc-1b2c-43f0-83f0-4704418ae2d5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc8f199a-59f0-4184-864d-b1c0befd26df"
      
    
    ,
  
    max(
      
      case
      when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593'
        then answer_value_text
      else null
      end
    )
    
      
            as "43801cc4-c61f-4ee0-82ad-cf6f1f799593"
      
    
    ,
  
    max(
      
      case
      when linkid = '4442589a-51b2-48c3-8297-b805e525642c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4442589a-51b2-48c3-8297-b805e525642c"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c95559d-86ff-4b87-a271-e52388072a53'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c95559d-86ff-4b87-a271-e52388072a53"
      
    
    ,
  
    max(
      
      case
      when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "451acc1a-26f4-4374-96da-09bfb47365a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cc2834b-0d28-43d0-8811-509995cfcdb8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299'
        then answer_value_text
      else null
      end
    )
    
      
            as "b24118e2-31c5-4e23-af3a-1722af72c299"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-1"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f7b6563-47b1-4ad4-abc3-cffdae40a57a"
      
    
    ,
  
    max(
      
      case
      when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-019'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-019"
      
    
    ,
  
    max(
      
      case
      when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5'
        then answer_value_text
      else null
      end
    )
    
      
            as "9e995f48-b092-49b2-a9e4-c7e754e446e5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9a9f492-8eb8-4c71-8ec6-f80ab596430b"
      
    
    ,
  
    max(
      
      case
      when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc'
        then answer_value_text
      else null
      end
    )
    
      
            as "1b3394a9-eaff-4871-9537-0d29f5712adc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc'
        then answer_value_text
      else null
      end
    )
    
      
            as "4554f4b2-d15e-47e7-a10d-d77939dd3afc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7f10195-b859-4670-abbc-a2498c4fe45f"
      
    
    ,
  
    max(
      
      case
      when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a'
        then answer_value_text
      else null
      end
    )
    
      
            as "232484cf-1aee-4bfa-a66e-61494587a16a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac6eb49b-3d37-4bac-8d27-1e1ad01018ce"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8b8e550-4d65-42be-acb9-2f4ac17c7f49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bed17079-d1e5-4bbe-af07-3d7b6a86243e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '665e1595-f169-4815-9d24-dac265f1809b'
        then answer_value_text
      else null
      end
    )
    
      
            as "665e1595-f169-4815-9d24-dac265f1809b"
      
    
    ,
  
    max(
      
      case
      when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21'
        then answer_value_text
      else null
      end
    )
    
      
            as "99079ebd-1665-4503-bb37-8de493dd4a21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-022'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-022"
      
    
    ,
  
    max(
      
      case
      when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef'
        then answer_value_text
      else null
      end
    )
    
      
            as "058278e4-33d6-4c0f-8127-ccf923bcc7ef"
      
    
    ,
  
    max(
      
      case
      when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd'
        then answer_value_text
      else null
      end
    )
    
      
            as "59744d45-0100-4d62-b105-5cbecd973ffd"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ecf12a4-a246-4b79-b281-65b3676ca3a4"
      
    
    ,
  
    max(
      
      case
      when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5'
        then answer_value_text
      else null
      end
    )
    
      
            as "77fc70ba-6cac-494c-b27a-77ebce2289e5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb0c7a5-a211-43ec-af7b-5f1079399133"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-024'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-024"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9'
        then answer_value_text
      else null
      end
    )
    
      
            as "969c0120-0b86-40e5-8881-6a145fe90aa9"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c9f8c1d-5827-4d21-bd33-3240fade93ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "6b5fa434-2fc3-4e4b-ad11-89f6260a81f2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6befba3-6d25-47ae-9cac-409dfae832a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92'
        then answer_value_text
      else null
      end
    )
    
      
            as "b31c0187-3e54-4fcf-9763-8b3f3850be92"
      
    
    ,
  
    max(
      
      case
      when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53'
        then answer_value_text
      else null
      end
    )
    
      
            as "9082f0ba-b8e5-495a-a2a4-b30918e19d53"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60'
        then answer_value_text
      else null
      end
    )
    
      
            as "b95949ec-f2ee-4d04-9e52-fb61dac18e60"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-020'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-020"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-023'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-023"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1a13d53-b867-440f-8622-bccebf54f176"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:55.196098 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:26:55.198087 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:26:55.198314 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_tmp" rename to "qr_208"
[0m23:26:55.200003 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:55.200715 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: COMMIT
[0m23:26:55.200906 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:26:55.201065 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: COMMIT
[0m23:26:55.202100 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:55.203598 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_backup"
[0m23:26:55.203907 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:26:55.204070 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_backup" cascade
[0m23:26:55.204914 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:55.205694 [debug] [Thread-3 (]: On model.engage_analytics.qr_208: Close
[0m23:26:55.206002 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d941790>]}
[0m23:26:55.206358 [info ] [Thread-3 (]: 64 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_208  [[32mCREATE VIEW[0m in 0.62s]
[0m23:26:55.206625 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_208
[0m23:26:55.206848 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_212
[0m23:26:55.207050 [info ] [Thread-3 (]: 68 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_212 .... [RUN]
[0m23:26:55.207337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_208, now model.engage_analytics.qr_212)
[0m23:26:55.207501 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_212
[0m23:26:55.210173 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:26:55.210416 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:55.210581 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:55.426987 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.544 seconds
[0m23:26:55.431784 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_210"
[0m23:26:55.432104 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.553 seconds
[0m23:26:55.433177 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_209"
[0m23:26:55.433623 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_210
[0m23:26:55.435617 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_210"
[0m23:26:55.435970 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_209
[0m23:26:55.438768 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_209"
[0m23:26:55.439144 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:26:55.439358 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: BEGIN
[0m23:26:55.439653 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:26:55.439857 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: BEGIN
[0m23:26:55.440104 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:55.440288 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:26:55.440542 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:55.440857 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 4) (id: ipc-210, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11'
        then answer_value_text
      else null
      end
    )
    
      
            as "62b55d32-de8e-4abd-8489-4e3aa9270e11"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e'
        then answer_value_text
      else null
      end
    )
    
      
            as "d590116a-ec42-46e3-8ab6-6259307af17e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8'
        then answer_value_text
      else null
      end
    )
    
      
            as "a4b58f6e-3046-4a11-9e9e-e6b1547594e8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef'
        then answer_value_text
      else null
      end
    )
    
      
            as "d5a448fb-4db7-45e8-858b-f2d2e7cb0eef"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:55.441173 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:26:55.441466 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 4) (id: ipc-209, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990'
        then answer_value_text
      else null
      end
    )
    
      
            as "c04706e8-4a1e-4e6a-ac6e-be9dd8274990"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:55.443563 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:55.445178 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:26:55.445415 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:26:55.445628 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_tmp" rename to "qr_209"
[0m23:26:55.447129 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:26:55.447404 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_tmp" rename to "qr_210"
[0m23:26:55.447976 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:55.448643 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: COMMIT
[0m23:26:55.448836 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:55.449016 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:26:55.449574 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: COMMIT
[0m23:26:55.449729 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: COMMIT
[0m23:26:55.449873 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:26:55.450210 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: COMMIT
[0m23:26:55.450852 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:55.451879 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_backup"
[0m23:26:55.452115 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:26:55.452266 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_backup" cascade
[0m23:26:55.452481 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:55.453747 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_backup"
[0m23:26:55.453952 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:26:55.454238 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:26:55.454942 [debug] [Thread-4 (]: On model.engage_analytics.qr_209: Close
[0m23:26:55.455132 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_backup" cascade
[0m23:26:55.455422 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db4b020>]}
[0m23:26:55.455922 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:55.455732 [info ] [Thread-4 (]: 65 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_209  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:55.456741 [debug] [Thread-2 (]: On model.engage_analytics.qr_210: Close
[0m23:26:55.457004 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_209
[0m23:26:55.457239 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_221
[0m23:26:55.457495 [info ] [Thread-4 (]: 69 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_221 .... [RUN]
[0m23:26:55.457917 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db2c320>]}
[0m23:26:55.458153 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_209, now model.engage_analytics.qr_221)
[0m23:26:55.458490 [info ] [Thread-2 (]: 66 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_210  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:55.458705 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_221
[0m23:26:55.458935 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_210
[0m23:26:55.461331 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:26:55.461603 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_23451
[0m23:26:55.461930 [debug] [Thread-4 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:55.462255 [info ] [Thread-2 (]: 70 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_23451 .. [RUN]
[0m23:26:55.462509 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:55.462842 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_210, now model.engage_analytics.qr_23451)
[0m23:26:55.463142 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_23451
[0m23:26:55.465819 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:26:55.466079 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:55.466254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:55.678227 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.548 seconds
[0m23:26:55.682499 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_211"
[0m23:26:55.683553 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_211
[0m23:26:55.685630 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_211"
[0m23:26:55.686031 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:26:55.686196 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: BEGIN
[0m23:26:55.686897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:55.687048 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:26:55.687286 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 4) (id: ipc-211, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2'
        then answer_value_text
      else null
      end
    )
    
      
            as "01a4984f-7b50-47bb-9ae1-1b81ee4d6df2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b'
        then answer_value_text
      else null
      end
    )
    
      
            as "11d368a4-7f34-46d5-a8d0-6deed381945b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792'
        then answer_value_text
      else null
      end
    )
    
      
            as "4b86c897-4d68-405b-aa08-760ed6ff6792"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:55.690494 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:55.692103 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:26:55.692293 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_tmp" rename to "qr_211"
[0m23:26:55.693142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:55.693725 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: COMMIT
[0m23:26:55.693886 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:26:55.694028 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: COMMIT
[0m23:26:55.694817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:55.696867 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_backup"
[0m23:26:55.697305 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:26:55.697514 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_backup" cascade
[0m23:26:55.698117 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:55.698760 [debug] [Thread-1 (]: On model.engage_analytics.qr_211: Close
[0m23:26:55.699035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d861130>]}
[0m23:26:55.699340 [info ] [Thread-1 (]: 67 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_211  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:55.699641 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_211
[0m23:26:55.699823 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_54
[0m23:26:55.700045 [info ] [Thread-1 (]: 71 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_54 ..... [RUN]
[0m23:26:55.700235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_211, now model.engage_analytics.qr_54)
[0m23:26:55.700389 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_54
[0m23:26:55.702859 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:26:55.703120 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:55.703285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:55.765380 [debug] [Thread-3 (]: SQL status: SELECT 159 in 0.555 seconds
[0m23:26:55.773902 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_212"
[0m23:26:55.775682 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_212
[0m23:26:55.777727 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_212"
[0m23:26:55.779094 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:26:55.779351 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: BEGIN
[0m23:26:55.780179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:55.780418 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:26:55.781565 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SBIRT (id: ipc-212, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'is-drug-dependence'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-drug-dependence"
      
    
    ,
  
    max(
      
      case
      when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812'
        then answer_value_text
      else null
      end
    )
    
      
            as "287b1b6c-fe58-4245-90dc-87d72d296812"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ad609c63-366e-476a-b131-610ceed211da'
        then answer_value_text
      else null
      end
    )
    
      
            as "ad609c63-366e-476a-b131-610ceed211da"
      
    
    ,
  
    max(
      
      case
      when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3'
        then answer_value_text
      else null
      end
    )
    
      
            as "38eb7cfd-8f4a-4743-b856-c8ddd529dac3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19'
        then answer_value_text
      else null
      end
    )
    
      
            as "ff55dd63-f51c-420b-97a0-f957d31d6b19"
      
    
    ,
  
    max(
      
      case
      when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2'
        then answer_value_text
      else null
      end
    )
    
      
            as "958d0ff5-edd9-4d25-9f4d-4ff29289bbe2"
      
    
    ,
  
    max(
      
      case
      when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4'
        then answer_value_text
      else null
      end
    )
    
      
            as "86daa888-2174-4fdc-9200-cbfdbe430ab4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-is-medium-high-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-is-medium-high-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae15db19-8d0c-465a-a925-3e0503f0a25b"
      
    
    ,
  
    max(
      
      case
      when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116'
        then answer_value_text
      else null
      end
    )
    
      
            as "73b23b0b-ff20-4eb9-aebb-a34432897116"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "b11bfd65-1f8d-4dee-8a9e-b2044382c0d5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2c84a83-1568-4593-9ea4-4f6c3978edd6"
      
    
    ,
  
    max(
      
      case
      when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515'
        then answer_value_text
      else null
      end
    )
    
      
            as "28edfdea-ec6f-4d33-80e2-6d7323b3b515"
      
    
    ,
  
    max(
      
      case
      when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78'
        then answer_value_text
      else null
      end
    )
    
      
            as "19d44e35-f7b5-43e3-be3b-fdb820503f78"
      
    
    ,
  
    max(
      
      case
      when linkid = '39843731-a8e7-4822-bad7-55489947ebeb'
        then answer_value_text
      else null
      end
    )
    
      
            as "39843731-a8e7-4822-bad7-55489947ebeb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491'
        then answer_value_text
      else null
      end
    )
    
      
            as "db7cc8b8-b558-41c8-9849-a80252710491"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    ,
  
    max(
      
      case
      when linkid = 'should-discuss-health-goals'
        then answer_value_text
      else null
      end
    )
    
      
            as "should-discuss-health-goals"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f1fb719-c235-4826-a53e-24502bc620cc"
      
    
    ,
  
    max(
      
      case
      when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3'
        then answer_value_text
      else null
      end
    )
    
      
            as "7f8ade46-1d91-40a0-b67e-015a5a6aadc3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb'
        then answer_value_text
      else null
      end
    )
    
      
            as "2336b352-cd6b-4044-8879-a5425c4ae5cb"
      
    
    ,
  
    max(
      
      case
      when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3'
        then answer_value_text
      else null
      end
    )
    
      
            as "48d61a4b-d87d-4661-96dd-42766dbe8cc3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4317308-24ec-4ce6-8659-54d4f1aa7e96"
      
    
    ,
  
    max(
      
      case
      when linkid = '0466b304-2876-409b-ade2-d1c675614854'
        then answer_value_text
      else null
      end
    )
    
      
            as "0466b304-2876-409b-ade2-d1c675614854"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-medium-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-medium-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f'
        then answer_value_text
      else null
      end
    )
    
      
            as "687cad76-ce92-4dca-b94f-58070b33da6f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'using-opioids-and-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "using-opioids-and-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474'
        then answer_value_text
      else null
      end
    )
    
      
            as "88accd91-b2ff-4bba-a5b1-58eaef458474"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "d169ab54-4544-4d1a-8687-6abc289982a4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41'
        then answer_value_text
      else null
      end
    )
    
      
            as "daf9b1ff-06c5-45a7-a3d1-26977a2e2b41"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7'
        then answer_value_text
      else null
      end
    )
    
      
            as "b87d6054-9f94-456f-b7f6-67c73be8acc7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa901327-bb55-4e04-a72b-5bcc7eb22404"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-discuss-next-steps'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-discuss-next-steps"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990'
        then answer_value_text
      else null
      end
    )
    
      
            as "c0911201-29b6-4cff-8cf8-fca31dc2b990"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d'
        then answer_value_text
      else null
      end
    )
    
      
            as "d11e0ac3-5faf-4986-a633-22efa8c74c4d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7444114-6b17-4300-80a1-a6376fd135d4"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c5e1af3-63d6-4283-9ea3-ef2b49314b1a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671'
        then answer_value_text
      else null
      end
    )
    
      
            as "092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197'
        then answer_value_text
      else null
      end
    )
    
      
            as "dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ab8f95f3-3ca8-439f-afc2-c95a0853f9f4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40'
        then answer_value_text
      else null
      end
    )
    
      
            as "da17f7fc-0919-44cb-a41c-fa8480bd3c40"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49'
        then answer_value_text
      else null
      end
    )
    
      
            as "db4b99b9-2cae-4833-bb08-fe7e94156b49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "ba444442-73b2-44be-b55e-c8f9fba8f7a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '1600f791-fd2c-44d8-8384-37973785741b'
        then answer_value_text
      else null
      end
    )
    
      
            as "1600f791-fd2c-44d8-8384-37973785741b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "eaa83f10-5cad-4c71-96b9-528e45af44fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-drug-list'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-drug-list"
      
    
    ,
  
    max(
      
      case
      when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848'
        then answer_value_text
      else null
      end
    )
    
      
            as "abb64c97-d3a9-45a2-bec2-11f6c4dc8848"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a36058d0-3ac9-4cf6-aabb-6b4859dc985d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267'
        then answer_value_text
      else null
      end
    )
    
      
            as "b81b6e43-3b57-489e-8ea9-f35d82f9f267"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-opioid-dependence'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-opioid-dependence"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-low-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-low-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = 'score-audit'
        then answer_value_text
      else null
      end
    )
    
      
            as "score-audit"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-high-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-high-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11'
        then answer_value_text
      else null
      end
    )
    
      
            as "a713e390-f199-4ed4-9a27-b9938fbf8b11"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec346c72-9835-4b5a-8088-1797a200f995"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-medium-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-medium-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e'
        then answer_value_text
      else null
      end
    )
    
      
            as "232a2454-1d23-4ec9-b4ee-65e3a48afb3e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1d97a4-bb16-4c46-bcee-5593f472b53b"
      
    
    ,
  
    max(
      
      case
      when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "272246d4-b9c5-4a8b-a349-12f75cf888d0"
      
    
    ,
  
    max(
      
      case
      when linkid = '36af2335-ac86-4864-8a3d-619451160cc5'
        then answer_value_text
      else null
      end
    )
    
      
            as "36af2335-ac86-4864-8a3d-619451160cc5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ad8b269-9415-4551-8d00-9be8812bde01"
      
    
    ,
  
    max(
      
      case
      when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41'
        then answer_value_text
      else null
      end
    )
    
      
            as "49ee0853-7d07-40af-a139-7cacc302ee41"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c08dae42-df65-4dba-98c6-47f9e5dafcb0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c'
        then answer_value_text
      else null
      end
    )
    
      
            as "c6c7bd0c-812d-4931-b94c-929aa04dc45c"
      
    
    ,
  
    max(
      
      case
      when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e'
        then answer_value_text
      else null
      end
    )
    
      
            as "705b4c26-4479-4d6a-adbe-b8ebdbad302e"
      
    
    ,
  
    max(
      
      case
      when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b'
        then answer_value_text
      else null
      end
    )
    
      
            as "9dfe8a90-6551-4ae4-bcfb-c839e429a87b"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ee9b164-9830-4f7a-8317-28e0cfc1852c"
      
    
    ,
  
    max(
      
      case
      when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "1bc8823a-bbb1-444a-ad1b-dc09f57038ce"
      
    
    ,
  
    max(
      
      case
      when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5'
        then answer_value_text
      else null
      end
    )
    
      
            as "724d0558-550c-4edc-a1d6-3bd1285bc8a5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a"
      
    
    ,
  
    max(
      
      case
      when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e'
        then answer_value_text
      else null
      end
    )
    
      
            as "54f4cac5-ac52-4caa-a6b9-f8b4a412d92e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef06e3fc-45f0-40a3-aca9-43293339689b"
      
    
    ,
  
    max(
      
      case
      when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d'
        then answer_value_text
      else null
      end
    )
    
      
            as "859d58d6-ee56-4ede-9773-0b7650d7c66d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-things-to-do'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-things-to-do"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-goals'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-goals"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844'
        then answer_value_text
      else null
      end
    )
    
      
            as "da46a37c-1678-4f34-80b5-f69589bc8844"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88'
        then answer_value_text
      else null
      end
    )
    
      
            as "f53db683-31e1-4d83-82c4-7e3a02f9ee88"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-sbirt-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-sbirt-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7443184-d141-4bce-93fc-c393132c73b1"
      
    
    ,
  
    max(
      
      case
      when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a'
        then answer_value_text
      else null
      end
    )
    
      
            as "21a9c779-27be-4c08-b9ab-b0d84964145a"
      
    
    ,
  
    max(
      
      case
      when linkid = '654d5688-f42a-469b-8494-81115b760e29'
        then answer_value_text
      else null
      end
    )
    
      
            as "654d5688-f42a-469b-8494-81115b760e29"
      
    
    ,
  
    max(
      
      case
      when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "1eb189a2-2ae1-4a27-b4cf-9161447ff8b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6d0780b-f202-416d-8d9b-c418a4bdb5d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e'
        then answer_value_text
      else null
      end
    )
    
      
            as "c93222e9-84f3-44a3-a87d-d92dafdc558e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4bd2450-08cb-410f-8f81-743d84749347"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-intervention-when-medium-high-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-intervention-when-medium-high-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04'
        then answer_value_text
      else null
      end
    )
    
      
            as "893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb3e9da-948e-4d05-8cad-58d293f557f6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e06c266d-8bd5-4232-85dc-f61a9d33aff2"
      
    
    ,
  
    max(
      
      case
      when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef'
        then answer_value_text
      else null
      end
    )
    
      
            as "9724b66b-2162-4984-b352-0bc27bcfdfef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1'
        then answer_value_text
      else null
      end
    )
    
      
            as "fae920b4-84d9-4576-9fac-51cba163ffd1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9fc5555-b1e6-4251-8047-13162c0b0cca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5787dda-4b43-4ae0-8cea-3062732f5a9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509'
        then answer_value_text
      else null
      end
    )
    
      
            as "ebf2e364-e7d7-44ec-a463-757c8e24d509"
      
    
    ,
  
    max(
      
      case
      when linkid = 'health-goals-do-not-want-to-change'
        then answer_value_text
      else null
      end
    )
    
      
            as "health-goals-do-not-want-to-change"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-low-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-low-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e1d29fe-7774-4731-bf50-ce5faaf0a528"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9a44d1a-ecf7-43af-835c-f4b5f73828d3"
      
    
    ,
  
    max(
      
      case
      when linkid = '582271e0-892e-4795-ac55-0b73baf828ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "582271e0-892e-4795-ac55-0b73baf828ca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db'
        then answer_value_text
      else null
      end
    )
    
      
            as "da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db"
      
    
    ,
  
    max(
      
      case
      when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f'
        then answer_value_text
      else null
      end
    )
    
      
            as "380d715b-abd0-4808-9ec4-0a1aabf9a33f"
      
    
    ,
  
    max(
      
      case
      when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5'
        then answer_value_text
      else null
      end
    )
    
      
            as "386eb911-a4c5-4207-9dab-8d5973069ac5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-to-use-marijuana-or-other'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-to-use-marijuana-or-other"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-to-use-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-to-use-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '6281fa0d-ef3f-4013-bd31-062371828010'
        then answer_value_text
      else null
      end
    )
    
      
            as "6281fa0d-ef3f-4013-bd31-062371828010"
      
    
    ,
  
    max(
      
      case
      when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "0eb07ad0-c8fa-49b6-9c27-064d844b6c4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5fa54c70-1483-4dfa-92fc-22ec4d90593c"
      
    
    ,
  
    max(
      
      case
      when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb'
        then answer_value_text
      else null
      end
    )
    
      
            as "5de2f3d9-de95-4871-919e-a00bb4f346bb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa01eb31-553b-415c-bb90-1ec8d07e979e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b8c1391-ba62-4800-ab3d-287fd7a9a3a5"
      
    
    ,
  
    max(
      
      case
      when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1'
        then answer_value_text
      else null
      end
    )
    
      
            as "94dc51b7-59e3-4276-9afe-9b18cb7a08e1"
      
    
    ,
  
    max(
      
      case
      when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3'
        then answer_value_text
      else null
      end
    )
    
      
            as "7baaf5ce-f19b-4a40-980e-cfe53efac3f3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1d9ecfa-c456-4109-8807-b8e26ffb69aa"
      
    
    ,
  
    max(
      
      case
      when linkid = 'edced328-6f82-458a-bce4-35987bff19fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "edced328-6f82-458a-bce4-35987bff19fb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8'
        then answer_value_text
      else null
      end
    )
    
      
            as "a44b78b7-d5ab-49a8-958d-5545072692d8"
      
    
    ,
  
    max(
      
      case
      when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e'
        then answer_value_text
      else null
      end
    )
    
      
            as "642b120d-78f5-4ec6-9cbf-d3b9e336083e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041'
        then answer_value_text
      else null
      end
    )
    
      
            as "af4330a4-7bc7-48db-bce8-364b0ff4b041"
      
    
    ,
  
    max(
      
      case
      when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa'
        then answer_value_text
      else null
      end
    )
    
      
            as "2badbdc1-2d13-4368-b803-c2eb7a2647aa"
      
    
    ,
  
    max(
      
      case
      when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045'
        then answer_value_text
      else null
      end
    )
    
      
            as "590f26f6-d5e5-4b56-b3a8-415e038dc045"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "ba10b935-7861-4ce4-a2c6-88bdd97709fb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084'
        then answer_value_text
      else null
      end
    )
    
      
            as "fac09a6e-c280-426d-94a1-0aa707e35084"
      
    
    ,
  
    max(
      
      case
      when linkid = 'score-dast'
        then answer_value_text
      else null
      end
    )
    
      
            as "score-dast"
      
    
    ,
  
    max(
      
      case
      when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368'
        then answer_value_text
      else null
      end
    )
    
      
            as "9d8d7688-d1ed-4851-a6ea-59bc296f5368"
      
    
    ,
  
    max(
      
      case
      when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985'
        then answer_value_text
      else null
      end
    )
    
      
            as "818b51b8-c7b3-4d64-8142-1c0798662985"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3e99643-32dc-4e2e-983c-e694159623e3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'should-converse-about-substance-use'
        then answer_value_text
      else null
      end
    )
    
      
            as "should-converse-about-substance-use"
      
    
    ,
  
    max(
      
      case
      when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3'
        then answer_value_text
      else null
      end
    )
    
      
            as "43dead8d-380d-4214-80f1-a1961b916bd3"
      
    
    ,
  
    max(
      
      case
      when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96'
        then answer_value_text
      else null
      end
    )
    
      
            as "8bcb58a6-5720-4746-b0d0-22d6b6ec7c96"
      
    
    ,
  
    max(
      
      case
      when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848'
        then answer_value_text
      else null
      end
    )
    
      
            as "71679b91-ee7b-4eda-9f9d-cf85645ee848"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-intervention-when-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-intervention-when-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427"
      
    
    ,
  
    max(
      
      case
      when linkid = '8427af19-3bad-4713-bad9-b179437fef96'
        then answer_value_text
      else null
      end
    )
    
      
            as "8427af19-3bad-4713-bad9-b179437fef96"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8e7d8b0-88e2-4bae-8990-c3ae94165ef9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba'
        then answer_value_text
      else null
      end
    )
    
      
            as "fd89df57-4b13-432f-a5b9-d54918f8d4ba"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-high-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-high-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9'
        then answer_value_text
      else null
      end
    )
    
      
            as "15799969-7565-4c3e-b488-d6a65d66c6c9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4"
      
    
    ,
  
    max(
      
      case
      when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd'
        then answer_value_text
      else null
      end
    )
    
      
            as "9346e7e0-e74b-452a-addc-e6ad13d016dd"
      
    
    ,
  
    max(
      
      case
      when linkid = '90876967-c973-4bee-9217-8c7482cb12a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "90876967-c973-4bee-9217-8c7482cb12a2"
      
    
    ,
  
    max(
      
      case
      when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e2b0891-5355-4ffd-8a18-66193a0dbfbe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-summary-for-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-summary-for-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299'
        then answer_value_text
      else null
      end
    )
    
      
            as "c5437ab8-5d0c-4157-b06a-b5ec491dc299"
      
    
    ,
  
    max(
      
      case
      when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621'
        then answer_value_text
      else null
      end
    )
    
      
            as "67c70e9e-2e10-4d4a-b354-95621a05c621"
      
    
    ,
  
    max(
      
      case
      when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f'
        then answer_value_text
      else null
      end
    )
    
      
            as "49bafbbf-8110-46a0-83f4-802cb1b6fd0f"
      
    
    ,
  
    max(
      
      case
      when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069'
        then answer_value_text
      else null
      end
    )
    
      
            as "6f1dfe02-2dbb-4371-ab06-a8c915495069"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-client-use-with-other-drugs'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-client-use-with-other-drugs"
      
    
    ,
  
    max(
      
      case
      when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730'
        then answer_value_text
      else null
      end
    )
    
      
            as "445adcc0-9c5f-4647-b339-fcb5835f1730"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:55.791592 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:26:55.793682 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:26:55.793888 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_tmp" rename to "qr_212"
[0m23:26:55.795902 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:55.796622 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: COMMIT
[0m23:26:55.796803 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:26:55.796985 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: COMMIT
[0m23:26:55.798037 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:55.799153 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_backup"
[0m23:26:55.799411 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:26:55.799570 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_backup" cascade
[0m23:26:55.800177 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:55.800930 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: Close
[0m23:26:55.801221 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d941f40>]}
[0m23:26:55.801535 [info ] [Thread-3 (]: 68 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_212  [[32mCREATE VIEW[0m in 0.59s]
[0m23:26:55.801876 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_212
[0m23:26:55.802068 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_55
[0m23:26:55.802325 [info ] [Thread-3 (]: 72 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_55 ..... [RUN]
[0m23:26:55.802533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_212, now model.engage_analytics.qr_55)
[0m23:26:55.802695 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_55
[0m23:26:55.804894 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:26:55.805113 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:55.805277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:55.999349 [debug] [Thread-4 (]: SQL status: SELECT 28 in 0.537 seconds
[0m23:26:56.007517 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_221"
[0m23:26:56.007851 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.542 seconds
[0m23:26:56.009119 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_23451"
[0m23:26:56.009544 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_23451
[0m23:26:56.011386 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_23451"
[0m23:26:56.011718 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_221
[0m23:26:56.013663 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_221"
[0m23:26:56.014007 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:26:56.014216 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: BEGIN
[0m23:26:56.014569 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:26:56.014825 [debug] [Thread-4 (]: On model.engage_analytics.qr_221: BEGIN
[0m23:26:56.015121 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:56.015276 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:26:56.015465 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:56.015734 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Discuss Confidentiality (id: ipc-23451, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:56.015996 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:26:56.016393 [debug] [Thread-4 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Add Family Member Registration (id: ipc-221, url: n/a, version: 0.0.3)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9aa068d-8d94-4b3d-b9da-ce05a59cecdd"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6306275-b989-4375-8527-3a56092081b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6306275-b989-4375-8527-3a56092081b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-best-represents-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-best-represents-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = 'do-you-have-medicaid'
        then answer_value_text
      else null
      end
    )
    
      
            as "do-you-have-medicaid"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d'
        then answer_value_text
      else null
      end
    )
    
      
            as "8fb87910-d900-4eea-dbba-dcf76ee6806d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'choice-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "choice-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'medicaid-number'
        then answer_value_text
      else null
      end
    )
    
      
            as "medicaid-number"
      
    
    ,
  
    max(
      
      case
      when linkid = 'physical-address'
        then answer_value_text
      else null
      end
    )
    
      
            as "physical-address"
      
    
    ,
  
    max(
      
      case
      when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271'
        then answer_value_text
      else null
      end
    )
    
      
            as "77e32953-0679-48b5-f004-1ab4a4ac0271"
      
    
    ,
  
    max(
      
      case
      when linkid = 'choice-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "choice-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'zip-code'
        then answer_value_text
      else null
      end
    )
    
      
            as "zip-code"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'phone-number'
        then answer_value_text
      else null
      end
    )
    
      
            as "phone-number"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-biological-sex-at-birth'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-biological-sex-at-birth"
      
    
    ,
  
    max(
      
      case
      when linkid = 'where-did-you-first-learn-about-engage'
        then answer_value_text
      else null
      end
    )
    
      
            as "where-did-you-first-learn-about-engage"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-where-did-you-first-learn-about-engage'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-where-did-you-first-learn-about-engage"
      
    
    ,
  
    max(
      
      case
      when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff'
        then answer_value_text
      else null
      end
    )
    
      
            as "36d39dbe-00e2-4e29-f079-3ec8f0119aff"
      
    
    ,
  
    max(
      
      case
      when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd'
        then answer_value_text
      else null
      end
    )
    
      
            as "597f4425-72b3-4bc4-8f38-b742aa3e99cd"
      
    
    ,
  
    max(
      
      case
      when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7'
        then answer_value_text
      else null
      end
    )
    
      
            as "8460d986-ef71-4997-80ee-7887d8c345e7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c31ef6d1-336b-4260-9881-67ba7b477ae0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'email-address'
        then answer_value_text
      else null
      end
    )
    
      
            as "email-address"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f'
        then answer_value_text
      else null
      end
    )
    
      
            as "c02a80e7-ebf0-48b5-9752-28a48dba487f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'age'
        then answer_value_text
      else null
      end
    )
    
      
            as "age"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:56.018237 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:56.019771 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:26:56.019966 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_tmp" rename to "qr_23451"
[0m23:26:56.020174 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:56.021707 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:26:56.021897 [debug] [Thread-4 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_tmp" rename to "qr_221"
[0m23:26:56.022085 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:56.022818 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: COMMIT
[0m23:26:56.023133 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:56.023344 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:26:56.023968 [debug] [Thread-4 (]: On model.engage_analytics.qr_221: COMMIT
[0m23:26:56.024139 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: COMMIT
[0m23:26:56.024289 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:26:56.024493 [debug] [Thread-4 (]: On model.engage_analytics.qr_221: COMMIT
[0m23:26:56.025246 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:56.026413 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_backup"
[0m23:26:56.026678 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:26:56.026887 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:26:56.027121 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_backup" cascade
[0m23:26:56.028993 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_backup"
[0m23:26:56.029320 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:26:56.029490 [debug] [Thread-4 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_backup" cascade
[0m23:26:56.029666 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:56.030453 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: Close
[0m23:26:56.030642 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:56.030948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9dbc50>]}
[0m23:26:56.031617 [debug] [Thread-4 (]: On model.engage_analytics.qr_221: Close
[0m23:26:56.031952 [info ] [Thread-2 (]: 70 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_23451  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:56.032237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d83bd70>]}
[0m23:26:56.032529 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_23451
[0m23:26:56.032882 [info ] [Thread-4 (]: 69 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_221  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:56.033206 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_56
[0m23:26:56.033476 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_221
[0m23:26:56.033696 [info ] [Thread-2 (]: 73 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_56 ..... [RUN]
[0m23:26:56.033906 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_57
[0m23:26:56.034176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_23451, now model.engage_analytics.qr_56)
[0m23:26:56.034449 [info ] [Thread-4 (]: 74 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_57 ..... [RUN]
[0m23:26:56.034701 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_56
[0m23:26:56.034904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_221, now model.engage_analytics.qr_57)
[0m23:26:56.037340 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:26:56.037581 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_57
[0m23:26:56.037760 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:56.040568 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:26:56.040820 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:56.041569 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:56.041924 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:56.248272 [debug] [Thread-1 (]: SQL status: SELECT 21 in 0.545 seconds
[0m23:26:56.253570 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_54"
[0m23:26:56.254604 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_54
[0m23:26:56.256909 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_54"
[0m23:26:56.257444 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:26:56.257620 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: BEGIN
[0m23:26:56.258467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:56.258707 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:26:56.259022 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 1) (id: ipc-54, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0'
        then answer_value_text
      else null
      end
    )
    
      
            as "0cfe26b9-8cd8-4d03-938f-991ebab4b3c0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5675128-0cd4-423f-840c-8dcff1e2a429"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a05b4fe-b514-4751-91be-adb1b278430c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-phq-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-phq-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:56.261927 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:56.263448 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:26:56.263635 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_tmp" rename to "qr_54"
[0m23:26:56.264493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:56.265109 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: COMMIT
[0m23:26:56.265260 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:26:56.265396 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: COMMIT
[0m23:26:56.266244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:56.267400 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_backup"
[0m23:26:56.267673 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:26:56.267841 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_backup" cascade
[0m23:26:56.268468 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:56.269310 [debug] [Thread-1 (]: On model.engage_analytics.qr_54: Close
[0m23:26:56.269628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8b0da0>]}
[0m23:26:56.269950 [info ] [Thread-1 (]: 71 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_54  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:56.270278 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_54
[0m23:26:56.270487 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_58
[0m23:26:56.270731 [info ] [Thread-1 (]: 75 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_58 ..... [RUN]
[0m23:26:56.270941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_54, now model.engage_analytics.qr_58)
[0m23:26:56.271110 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_58
[0m23:26:56.273325 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:26:56.273532 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:56.273691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:56.362729 [debug] [Thread-3 (]: SQL status: SELECT 111 in 0.557 seconds
[0m23:26:56.370426 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_55"
[0m23:26:56.372122 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_55
[0m23:26:56.374178 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_55"
[0m23:26:56.375170 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:26:56.375434 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: BEGIN
[0m23:26:56.376218 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:56.376421 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:26:56.377266 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 1 (id: ipc-55, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.73.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.73.2"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b0a751e-936e-40e8-9076-c7fe1e818c1f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.43.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.43.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '69125945-bec7-4810-985a-8c1052e8d039'
        then answer_value_text
      else null
      end
    )
    
      
            as "69125945-bec7-4810-985a-8c1052e8d039"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.88.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.88.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-012'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-012"
      
    
    ,
  
    max(
      
      case
      when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67'
        then answer_value_text
      else null
      end
    )
    
      
            as "47eaf38f-c74e-484a-af95-b0002074bf67"
      
    
    ,
  
    max(
      
      case
      when linkid = '16333904-aad5-4166-9593-b7286c7b20b2'
        then answer_value_text
      else null
      end
    )
    
      
            as "16333904-aad5-4166-9593-b7286c7b20b2"
      
    
    ,
  
    max(
      
      case
      when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727'
        then answer_value_text
      else null
      end
    )
    
      
            as "8085cded-8e0f-497f-9e3d-5fab3981d727"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.82.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.82.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204'
        then answer_value_text
      else null
      end
    )
    
      
            as "d126d866-b8c4-4288-84ff-49a40f20e204"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.87.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.87.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a88cb2bf-e23b-423b-9a22-ab94678ccc3a"
      
    
    ,
  
    max(
      
      case
      when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89'
        then answer_value_text
      else null
      end
    )
    
      
            as "31a9e716-52ce-4651-bb17-26f442e2ab89"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c'
        then answer_value_text
      else null
      end
    )
    
      
            as "1ae11d83-35d4-41c0-a804-5ddf6b1c388c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-008'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-008"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd69a7a1-ec17-4f43-8597-26c59732261b"
      
    
    ,
  
    max(
      
      case
      when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a'
        then answer_value_text
      else null
      end
    )
    
      
            as "13d72f63-dd18-41f9-bf46-44981f2f804a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.68.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.68.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.78.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.78.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.92.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.92.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-1"
      
    
    ,
  
    max(
      
      case
      when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "82cdd7f0-f3d1-4eba-a31e-c6ad367742f4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.2"
      
    
    ,
  
    max(
      
      case
      when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b'
        then answer_value_text
      else null
      end
    )
    
      
            as "0de42ce5-6d9f-40ec-b67b-3d3b975d363b"
      
    
    ,
  
    max(
      
      case
      when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "78bc8272-eba1-48a8-a2f4-0e47304887b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.81.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.81.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892'
        then answer_value_text
      else null
      end
    )
    
      
            as "b1b6bebb-0cb7-4029-b320-01d3270ee892"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '07b722c9-210e-491a-8933-2e9aab3474af'
        then answer_value_text
      else null
      end
    )
    
      
            as "07b722c9-210e-491a-8933-2e9aab3474af"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '1809cb03-235d-4855-b201-7b296b160e37'
        then answer_value_text
      else null
      end
    )
    
      
            as "1809cb03-235d-4855-b201-7b296b160e37"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-009'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-009"
      
    
    ,
  
    max(
      
      case
      when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "24f9ed3b-3706-43fb-9779-07a9c2077e9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523'
        then answer_value_text
      else null
      end
    )
    
      
            as "69ed5884-0814-4ae0-a7f1-ecf730710523"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123'
        then answer_value_text
      else null
      end
    )
    
      
            as "347d89f5-1bad-4ba5-8f45-e63972b02123"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d'
        then answer_value_text
      else null
      end
    )
    
      
            as "c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.11'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.11"
      
    
    ,
  
    max(
      
      case
      when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73'
        then answer_value_text
      else null
      end
    )
    
      
            as "798d2c43-5b9f-436f-9fa2-f360cbeeea73"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7b59772-0272-41f6-ba66-16b09a832fc1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.79.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.79.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.12'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.12"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037'
        then answer_value_text
      else null
      end
    )
    
      
            as "f11ace93-5d84-4cc5-8598-58f9c5623037"
      
    
    ,
  
    max(
      
      case
      when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690'
        then answer_value_text
      else null
      end
    )
    
      
            as "54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408'
        then answer_value_text
      else null
      end
    )
    
      
            as "19416221-7c67-44d7-9b9b-b88364ea7408"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf'
        then answer_value_text
      else null
      end
    )
    
      
            as "80344998-41e2-4669-a77e-1fdaebe88bcf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.89.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.89.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.38.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.38.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2629251-1266-4760-a539-f0e680df651b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2629251-1266-4760-a539-f0e680df651b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-010'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-010"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.72.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.72.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b'
        then answer_value_text
      else null
      end
    )
    
      
            as "b322e52d-99f3-48e0-bda0-09d95228ae7b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8bfb690-b135-4b0f-9291-f6247611ce52"
      
    
    ,
  
    max(
      
      case
      when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5e65c0dc-5524-4f3d-8404-a7427a34e61c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "d58c8907-06c6-4071-aa6c-b2b95d2169c7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685'
        then answer_value_text
      else null
      end
    )
    
      
            as "0627ed93-c89d-48ae-bde2-bd013dc58685"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.38.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.38.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655'
        then answer_value_text
      else null
      end
    )
    
      
            as "d6c7419a-9082-4579-8678-44e866ab3655"
      
    
    ,
  
    max(
      
      case
      when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface'
        then answer_value_text
      else null
      end
    )
    
      
            as "528fa2c7-7a88-4d4e-b2ba-38c1384aface"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.9'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.74.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.74.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe689023-f019-483b-ba7c-8ff0e16129d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '042e5415-93de-419d-9bac-632596939280'
        then answer_value_text
      else null
      end
    )
    
      
            as "042e5415-93de-419d-9bac-632596939280"
      
    
    ,
  
    max(
      
      case
      when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b'
        then answer_value_text
      else null
      end
    )
    
      
            as "37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.42.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.42.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd785881-7e04-4093-b191-d845edea4c9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.46.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.46.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd'
        then answer_value_text
      else null
      end
    )
    
      
            as "5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd"
      
    
    ,
  
    max(
      
      case
      when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801'
        then answer_value_text
      else null
      end
    )
    
      
            as "10151d1b-3cd2-4f10-b1e5-d6b20112d801"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a8b5e1e-fa6b-472b-ade7-ee8f5286a759"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a2ac26a-8d30-4c28-be11-f684f415f661"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.70.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.70.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.5'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.81.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.81.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d'
        then answer_value_text
      else null
      end
    )
    
      
            as "6409c231-50c1-45fc-808e-f0bd015db97d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.69.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.69.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.8'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.8"
      
    
    ,
  
    max(
      
      case
      when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92'
        then answer_value_text
      else null
      end
    )
    
      
            as "6099951a-c965-40f9-ad61-66e7a39a6b92"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.76.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.76.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.69.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.69.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45'
        then answer_value_text
      else null
      end
    )
    
      
            as "acd9d89b-0d67-415e-a3a4-b132ab304c45"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.79.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.79.2"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:56.384254 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:26:56.385914 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:26:56.386126 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_tmp" rename to "qr_55"
[0m23:26:56.387825 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:56.388474 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: COMMIT
[0m23:26:56.389049 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:26:56.389256 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: COMMIT
[0m23:26:56.390287 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:56.391455 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_backup"
[0m23:26:56.391712 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:26:56.391872 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_backup" cascade
[0m23:26:56.392361 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:56.392968 [debug] [Thread-3 (]: On model.engage_analytics.qr_55: Close
[0m23:26:56.393228 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db877d0>]}
[0m23:26:56.393529 [info ] [Thread-3 (]: 72 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_55  [[32mCREATE VIEW[0m in 0.59s]
[0m23:26:56.393785 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_55
[0m23:26:56.393965 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_59
[0m23:26:56.394212 [info ] [Thread-3 (]: 76 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_59 ..... [RUN]
[0m23:26:56.394409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_55, now model.engage_analytics.qr_59)
[0m23:26:56.394566 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_59
[0m23:26:56.412478 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:26:56.414003 [debug] [Thread-3 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:56.422067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:56.618937 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.577 seconds
[0m23:26:56.620414 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_57"
[0m23:26:56.620889 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_57
[0m23:26:56.622743 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_57"
[0m23:26:56.623398 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:26:56.623656 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: BEGIN
[0m23:26:56.624547 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:56.624767 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:26:56.625034 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 2) (id: ipc-57, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "7239b680-ef7a-4f9f-87ff-a77bf21d96d4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172'
        then answer_value_text
      else null
      end
    )
    
      
            as "7afb89dc-d53b-4dc3-a185-43dbb4854172"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a07491bd-039d-417b-9caf-0af536316594'
        then answer_value_text
      else null
      end
    )
    
      
            as "a07491bd-039d-417b-9caf-0af536316594"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-phq-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-phq-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:56.626244 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.585 seconds
[0m23:26:56.627914 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_56"
[0m23:26:56.628190 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:56.630377 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:26:56.630593 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_tmp" rename to "qr_57"
[0m23:26:56.630837 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_56
[0m23:26:56.632655 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_56"
[0m23:26:56.632900 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:56.633684 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: COMMIT
[0m23:26:56.633894 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:26:56.634100 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: COMMIT
[0m23:26:56.634364 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:26:56.634596 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: BEGIN
[0m23:26:56.635023 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:56.635212 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:56.636363 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_backup"
[0m23:26:56.636557 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:26:56.636815 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:26:56.637140 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 2) (id: ipc-56, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4'
        then answer_value_text
      else null
      end
    )
    
      
            as "c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d'
        then answer_value_text
      else null
      end
    )
    
      
            as "dd349377-e542-4b4f-8fba-795f91431f7d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-ptsd-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-ptsd-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb'
        then answer_value_text
      else null
      end
    )
    
      
            as "9de6571c-3f74-4694-a567-ac5c897f96cb"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "931dc4ee-b677-4812-9372-3fea7012e9bc"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:56.637452 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_backup" cascade
[0m23:26:56.638047 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:56.638742 [debug] [Thread-4 (]: On model.engage_analytics.qr_57: Close
[0m23:26:56.639025 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da9a900>]}
[0m23:26:56.639328 [info ] [Thread-4 (]: 74 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_57  [[32mCREATE VIEW[0m in 0.60s]
[0m23:26:56.639585 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_57
[0m23:26:56.639770 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_60
[0m23:26:56.639965 [info ] [Thread-4 (]: 77 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_60 ..... [RUN]
[0m23:26:56.640276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_57, now model.engage_analytics.qr_60)
[0m23:26:56.640519 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:56.640784 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_60
[0m23:26:56.642331 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:26:56.644561 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:26:56.644786 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_tmp" rename to "qr_56"
[0m23:26:56.645028 [debug] [Thread-4 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:56.645310 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:56.646188 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:56.647058 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: COMMIT
[0m23:26:56.647263 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:26:56.647417 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: COMMIT
[0m23:26:56.648582 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:56.649928 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_backup"
[0m23:26:56.650262 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:26:56.650423 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_backup" cascade
[0m23:26:56.650924 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:56.651561 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: Close
[0m23:26:56.651844 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9a6510>]}
[0m23:26:56.652141 [info ] [Thread-2 (]: 73 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_56  [[32mCREATE VIEW[0m in 0.62s]
[0m23:26:56.652545 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_56
[0m23:26:56.652838 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_61
[0m23:26:56.653157 [info ] [Thread-2 (]: 78 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_61 ..... [RUN]
[0m23:26:56.653438 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_56, now model.engage_analytics.qr_61)
[0m23:26:56.653606 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_61
[0m23:26:56.656009 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:26:56.656260 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:56.656433 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:56.863360 [debug] [Thread-1 (]: SQL status: SELECT 91 in 0.590 seconds
[0m23:26:56.868207 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_58"
[0m23:26:56.868920 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_58
[0m23:26:56.870921 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_58"
[0m23:26:56.871570 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:26:56.871837 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: BEGIN
[0m23:26:56.872748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:56.872985 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:26:56.873774 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 2 (id: ipc-58, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '6930d457-7bec-4983-832b-3220b163f505'
        then answer_value_text
      else null
      end
    )
    
      
            as "6930d457-7bec-4983-832b-3220b163f505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9543e3c-cbff-4d2a-b3df-bf96e509d9ca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-015'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-015"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ed77f2a-0d5a-434d-b153-d8deadfbc3f8"
      
    
    ,
  
    max(
      
      case
      when linkid = '62cd085f-52d4-44de-881c-93058f201559'
        then answer_value_text
      else null
      end
    )
    
      
            as "62cd085f-52d4-44de-881c-93058f201559"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840'
        then answer_value_text
      else null
      end
    )
    
      
            as "a4a9cad5-04db-44e5-9a9d-0f1bf40ca840"
      
    
    ,
  
    max(
      
      case
      when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "0a15f38b-027a-42ff-b1e8-ca5e2b313f71"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1755ad4-b33a-44a3-b562-4206a582c28a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51'
        then answer_value_text
      else null
      end
    )
    
      
            as "301ae5ab-7dac-4414-a80a-f8784ba6bf51"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10'
        then answer_value_text
      else null
      end
    )
    
      
            as "d8eb3c09-b97d-4d55-9590-e6ce932a7a10"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "a9314459-f6d9-4ebb-84e7-f1a1968cfd7c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e17756cd-4861-4dde-859c-f90241977246'
        then answer_value_text
      else null
      end
    )
    
      
            as "e17756cd-4861-4dde-859c-f90241977246"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083'
        then answer_value_text
      else null
      end
    )
    
      
            as "f39b0b39-2058-4c29-a183-aac5dc70e083"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-016'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-016"
      
    
    ,
  
    max(
      
      case
      when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875'
        then answer_value_text
      else null
      end
    )
    
      
            as "9eac8fed-4265-447f-bbde-0986c34f3875"
      
    
    ,
  
    max(
      
      case
      when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263'
        then answer_value_text
      else null
      end
    )
    
      
            as "86bdafab-bb90-429e-8bc5-a90dc46e7263"
      
    
    ,
  
    max(
      
      case
      when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73'
        then answer_value_text
      else null
      end
    )
    
      
            as "747188c8-4fc0-43ea-92b4-9baa32567f73"
      
    
    ,
  
    max(
      
      case
      when linkid = '547a07c2-f94c-4956-997f-0439626d0251'
        then answer_value_text
      else null
      end
    )
    
      
            as "547a07c2-f94c-4956-997f-0439626d0251"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c"
      
    
    ,
  
    max(
      
      case
      when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740'
        then answer_value_text
      else null
      end
    )
    
      
            as "2a5d7010-a84b-414c-adcb-ad0f49a95740"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-013'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-013"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ff4b5cb-2c44-434b-90e9-85c61a858097"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef"
      
    
    ,
  
    max(
      
      case
      when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414'
        then answer_value_text
      else null
      end
    )
    
      
            as "83176bb3-c0cb-445a-a91b-6711635b1414"
      
    
    ,
  
    max(
      
      case
      when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90'
        then answer_value_text
      else null
      end
    )
    
      
            as "10cd5560-6c41-41a6-94c5-af74ce96dc90"
      
    
    ,
  
    max(
      
      case
      when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07'
        then answer_value_text
      else null
      end
    )
    
      
            as "85a3f14c-e4d8-4c45-9088-967ec4ea0d07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb8828db-1674-47e7-ba9a-e3c161160b65"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f63637c-1de2-4851-a088-c3b08152447e'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f63637c-1de2-4851-a088-c3b08152447e"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b80fd6e-3e52-4d1f-aa19-bbfdd912d724"
      
    
    ,
  
    max(
      
      case
      when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3'
        then answer_value_text
      else null
      end
    )
    
      
            as "0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44'
        then answer_value_text
      else null
      end
    )
    
      
            as "eea0b1ca-5582-4b45-b5cf-36bc0665ba44"
      
    
    ,
  
    max(
      
      case
      when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3'
        then answer_value_text
      else null
      end
    )
    
      
            as "94e90f68-ea59-4837-b0ad-452f5f0336c3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac0ade27-9e9a-42a9-8ec6-4e7e79830299"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e0b76f9-0902-43ba-b858-0b1505e9d168"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359'
        then answer_value_text
      else null
      end
    )
    
      
            as "e245b7d9-955a-4c4b-a107-e2bf5d6d2359"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a77f07b3-7913-4708-a354-14e503a948f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "5817d327-373e-4fc0-9bac-b64e408b0e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260'
        then answer_value_text
      else null
      end
    )
    
      
            as "52f7924d-1c66-4049-8611-26d4e7bcb260"
      
    
    ,
  
    max(
      
      case
      when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3'
        then answer_value_text
      else null
      end
    )
    
      
            as "50cf6a9c-a837-4531-a13a-47381657c2b3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "c91209cc-1b2c-43f0-83f0-4704418ae2d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '044d9000-1935-4b35-9947-d668de09f10b'
        then answer_value_text
      else null
      end
    )
    
      
            as "044d9000-1935-4b35-9947-d668de09f10b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc8f199a-59f0-4184-864d-b1c0befd26df"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c95559d-86ff-4b87-a271-e52388072a53'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c95559d-86ff-4b87-a271-e52388072a53"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444'
        then answer_value_text
      else null
      end
    )
    
      
            as "e73f462c-e543-4a3d-849d-dbedcb831444"
      
    
    ,
  
    max(
      
      case
      when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a'
        then answer_value_text
      else null
      end
    )
    
      
            as "63ac8d07-518c-4791-849a-a9e2c282ce9a"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cc2834b-0d28-43d0-8811-509995cfcdb8"
      
    
    ,
  
    max(
      
      case
      when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c'
        then answer_value_text
      else null
      end
    )
    
      
            as "2efaba4d-f5af-45f3-9340-1ba9b3fffc1c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-018'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-018"
      
    
    ,
  
    max(
      
      case
      when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f"
      
    
    ,
  
    max(
      
      case
      when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8'
        then answer_value_text
      else null
      end
    )
    
      
            as "126c7309-8143-4c33-857f-41cc6bed09d8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-014'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-014"
      
    
    ,
  
    max(
      
      case
      when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03'
        then answer_value_text
      else null
      end
    )
    
      
            as "5d0b76c5-a416-45a4-a8fc-9889ea840a03"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7f10195-b859-4670-abbc-a2498c4fe45f"
      
    
    ,
  
    max(
      
      case
      when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a'
        then answer_value_text
      else null
      end
    )
    
      
            as "232484cf-1aee-4bfa-a66e-61494587a16a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "96171fdd-a424-4c09-91e8-31986ac315f7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bed17079-d1e5-4bbe-af07-3d7b6a86243e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '665e1595-f169-4815-9d24-dac265f1809b'
        then answer_value_text
      else null
      end
    )
    
      
            as "665e1595-f169-4815-9d24-dac265f1809b"
      
    
    ,
  
    max(
      
      case
      when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21'
        then answer_value_text
      else null
      end
    )
    
      
            as "99079ebd-1665-4503-bb37-8de493dd4a21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ecd82c04-48de-48ec-8efe-24cbe04cbe4b"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ff6f541-cb58-48d3-b7eb-24ab667f0a94"
      
    
    ,
  
    max(
      
      case
      when linkid = '287593c3-4174-45af-a998-71d249230943'
        then answer_value_text
      else null
      end
    )
    
      
            as "287593c3-4174-45af-a998-71d249230943"
      
    
    ,
  
    max(
      
      case
      when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc'
        then answer_value_text
      else null
      end
    )
    
      
            as "62c9e3f2-30aa-46b0-9190-aa36a1804fdc"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f9608db-8796-4f45-89b7-741585b8a362'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f9608db-8796-4f45-89b7-741585b8a362"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f82f76f4-648a-453a-916d-28795448a758'
        then answer_value_text
      else null
      end
    )
    
      
            as "f82f76f4-648a-453a-916d-28795448a758"
      
    
    ,
  
    max(
      
      case
      when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a'
        then answer_value_text
      else null
      end
    )
    
      
            as "2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb0c7a5-a211-43ec-af7b-5f1079399133"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c0d6638-9b65-4016-b3f0-4008f8e462c2"
      
    
    ,
  
    max(
      
      case
      when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92'
        then answer_value_text
      else null
      end
    )
    
      
            as "6099951a-c965-40f9-ad61-66e7a39a6b92"
      
    
    ,
  
    max(
      
      case
      when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00'
        then answer_value_text
      else null
      end
    )
    
      
            as "0984569b-3fd6-4c4e-a391-e68e73b46f00"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c9f8c1d-5827-4d21-bd33-3240fade93ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6befba3-6d25-47ae-9cac-409dfae832a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93'
        then answer_value_text
      else null
      end
    )
    
      
            as "b93eafea-8b01-4b21-994b-c45113622a93"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92'
        then answer_value_text
      else null
      end
    )
    
      
            as "b31c0187-3e54-4fcf-9763-8b3f3850be92"
      
    
    ,
  
    max(
      
      case
      when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54'
        then answer_value_text
      else null
      end
    )
    
      
            as "3abecf2a-c87b-4fad-96eb-e9abc37e9c54"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:56.880575 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:26:56.882292 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:26:56.882575 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_tmp" rename to "qr_58"
[0m23:26:56.884153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:56.884881 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: COMMIT
[0m23:26:56.885074 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:26:56.885226 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: COMMIT
[0m23:26:56.886254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:56.887492 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_backup"
[0m23:26:56.887783 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:26:56.887981 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_backup" cascade
[0m23:26:56.888581 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:56.889238 [debug] [Thread-1 (]: On model.engage_analytics.qr_58: Close
[0m23:26:56.889514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da6cc20>]}
[0m23:26:56.889821 [info ] [Thread-1 (]: 75 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_58  [[32mCREATE VIEW[0m in 0.62s]
[0m23:26:56.890102 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_58
[0m23:26:56.890294 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_62
[0m23:26:56.890527 [info ] [Thread-1 (]: 79 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_62 ..... [RUN]
[0m23:26:56.890733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_58, now model.engage_analytics.qr_62)
[0m23:26:56.890892 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_62
[0m23:26:56.893273 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:26:56.893499 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:56.893658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:56.985415 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.564 seconds
[0m23:26:56.991677 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_59"
[0m23:26:56.993731 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_59
[0m23:26:56.995997 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_59"
[0m23:26:56.996734 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:26:56.997006 [debug] [Thread-3 (]: On model.engage_analytics.qr_59: BEGIN
[0m23:26:56.997773 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:56.997968 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:26:56.998210 [debug] [Thread-3 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 3) (id: ipc-59, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402'
        then answer_value_text
      else null
      end
    )
    
      
            as "d34c5839-fad9-4824-b2dc-9e0161647402"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = '534c4998-b964-4101-b919-ff3c26af9714'
        then answer_value_text
      else null
      end
    )
    
      
            as "534c4998-b964-4101-b919-ff3c26af9714"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:57.000665 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:57.002273 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:26:57.002463 [debug] [Thread-3 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_tmp" rename to "qr_59"
[0m23:26:57.003370 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:57.004200 [debug] [Thread-3 (]: On model.engage_analytics.qr_59: COMMIT
[0m23:26:57.004398 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:26:57.004590 [debug] [Thread-3 (]: On model.engage_analytics.qr_59: COMMIT
[0m23:26:57.005552 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:57.006721 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_backup"
[0m23:26:57.006976 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:26:57.007133 [debug] [Thread-3 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_backup" cascade
[0m23:26:57.007805 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:57.008547 [debug] [Thread-3 (]: On model.engage_analytics.qr_59: Close
[0m23:26:57.008849 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dba3740>]}
[0m23:26:57.009161 [info ] [Thread-3 (]: 76 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_59  [[32mCREATE VIEW[0m in 0.61s]
[0m23:26:57.009425 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_59
[0m23:26:57.009609 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_63
[0m23:26:57.009854 [info ] [Thread-3 (]: 80 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_63 ..... [RUN]
[0m23:26:57.010046 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_59, now model.engage_analytics.qr_63)
[0m23:26:57.010203 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_63
[0m23:26:57.012464 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:26:57.012682 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:57.012843 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:57.200694 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.555 seconds
[0m23:26:57.206790 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_60"
[0m23:26:57.208265 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_60
[0m23:26:57.210381 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_60"
[0m23:26:57.210662 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.554 seconds
[0m23:26:57.211892 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_61"
[0m23:26:57.212300 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:26:57.212567 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_61
[0m23:26:57.212835 [debug] [Thread-4 (]: On model.engage_analytics.qr_60: BEGIN
[0m23:26:57.214833 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_61"
[0m23:26:57.215379 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:26:57.215598 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: BEGIN
[0m23:26:57.215784 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:57.215991 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:26:57.216311 [debug] [Thread-4 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 3) (id: ipc-60, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d'
        then answer_value_text
      else null
      end
    )
    
      
            as "cbad1c80-ab95-4720-ba6a-0eadd718905d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4c58005-803f-4bc3-adaa-1f84c5824b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49'
        then answer_value_text
      else null
      end
    )
    
      
            as "a51fba17-fccd-4b65-ada3-5c50a75e5d49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5002611-caf9-4792-8d10-e7870459ea17"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:57.216635 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:57.216811 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:26:57.217166 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 3) (id: ipc-61, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1'
        then answer_value_text
      else null
      end
    )
    
      
            as "45f52042-6802-4d9c-9f86-6578923d0fd1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9'
        then answer_value_text
      else null
      end
    )
    
      
            as "4650a511-2184-4b0b-9e43-54f45f4340a9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e'
        then answer_value_text
      else null
      end
    )
    
      
            as "55d78cf4-0963-4c44-af44-6004a8abbb3e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:57.219515 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:57.219730 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:57.221371 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:26:57.222895 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:26:57.223086 [debug] [Thread-4 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_tmp" rename to "qr_60"
[0m23:26:57.223307 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_tmp" rename to "qr_61"
[0m23:26:57.224332 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:57.224537 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:57.225191 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: COMMIT
[0m23:26:57.225782 [debug] [Thread-4 (]: On model.engage_analytics.qr_60: COMMIT
[0m23:26:57.225983 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:26:57.226213 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:26:57.226448 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: COMMIT
[0m23:26:57.226633 [debug] [Thread-4 (]: On model.engage_analytics.qr_60: COMMIT
[0m23:26:57.227890 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:57.228077 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:57.229221 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_backup"
[0m23:26:57.230259 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_backup"
[0m23:26:57.230514 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:26:57.230736 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:26:57.230937 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_backup" cascade
[0m23:26:57.231106 [debug] [Thread-4 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_backup" cascade
[0m23:26:57.231711 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:57.231870 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:57.232485 [debug] [Thread-4 (]: On model.engage_analytics.qr_60: Close
[0m23:26:57.233033 [debug] [Thread-2 (]: On model.engage_analytics.qr_61: Close
[0m23:26:57.233317 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8e6120>]}
[0m23:26:57.234038 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6f2e10>]}
[0m23:26:57.233719 [info ] [Thread-4 (]: 77 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_60  [[32mCREATE VIEW[0m in 0.59s]
[0m23:26:57.234440 [info ] [Thread-2 (]: 78 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_61  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:57.234770 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_60
[0m23:26:57.235080 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_61
[0m23:26:57.235313 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_69
[0m23:26:57.235578 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:26:57.235876 [info ] [Thread-4 (]: 81 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_69 ..... [RUN]
[0m23:26:57.236174 [info ] [Thread-2 (]: 82 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_q_common_mental_health_symptoms  [RUN]
[0m23:26:57.236419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_60, now model.engage_analytics.qr_69)
[0m23:26:57.236598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_61, now model.engage_analytics.qr_q_common_mental_health_symptoms)
[0m23:26:57.236764 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_69
[0m23:26:57.236918 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:26:57.239301 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:26:57.241402 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:26:57.241630 [debug] [Thread-4 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:57.241821 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:57.241983 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:26:57.242214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:26:57.432749 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.539 seconds
[0m23:26:57.438114 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_62"
[0m23:26:57.438794 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_62
[0m23:26:57.440754 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_62"
[0m23:26:57.441157 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:26:57.441323 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: BEGIN
[0m23:26:57.442065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:57.442225 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:26:57.442454 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 4) (id: ipc-62, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e626219-c0e4-465e-92e6-9e976c52614c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4155e07-1d18-448f-8111-182bf4149672'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4155e07-1d18-448f-8111-182bf4149672"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:57.444890 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:57.446487 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:26:57.446679 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_tmp" rename to "qr_62"
[0m23:26:57.447605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:57.448449 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: COMMIT
[0m23:26:57.448654 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:26:57.448811 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: COMMIT
[0m23:26:57.449764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:57.451016 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_backup"
[0m23:26:57.451301 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:26:57.451465 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_backup" cascade
[0m23:26:57.452035 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:57.452674 [debug] [Thread-1 (]: On model.engage_analytics.qr_62: Close
[0m23:26:57.452947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9e7560>]}
[0m23:26:57.453251 [info ] [Thread-1 (]: 79 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_62  [[32mCREATE VIEW[0m in 0.56s]
[0m23:26:57.453513 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_62
[0m23:26:57.453692 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:26:57.453916 [info ] [Thread-1 (]: 83 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_q_financial_wellness_tool  [RUN]
[0m23:26:57.454103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_62, now model.engage_analytics.qr_q_financial_wellness_tool)
[0m23:26:57.454261 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:26:57.456452 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:26:57.456673 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:57.457175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:57.560756 [debug] [Thread-3 (]: SQL status: SELECT 42 in 0.548 seconds
[0m23:26:57.564668 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_63"
[0m23:26:57.565311 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_63
[0m23:26:57.567297 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_63"
[0m23:26:57.567788 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:26:57.567956 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: BEGIN
[0m23:26:57.568716 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:57.568881 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:26:57.569317 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 4 (id: ipc-63, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-connected-to-clinical-care-details'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-connected-to-clinical-care-details"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-connected-to-clinical-care-question'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-connected-to-clinical-care-question"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de'
        then answer_value_text
      else null
      end
    )
    
      
            as "b46d08e9-6af9-47be-a09a-afd0cfdf41de"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b12311e-d9a3-40b4-bb18-5cc6135a3850"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa8d0648-9550-489a-9543-4f00d43ba1fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490'
        then answer_value_text
      else null
      end
    )
    
      
            as "e67ca22d-e803-4790-bbce-126f2c863490"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "cb8337b0-c822-4374-895b-ee875da4d7f6"
      
    
    ,
  
    max(
      
      case
      when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "978ba6cf-b149-49e2-89c3-89a0e18461bc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588'
        then answer_value_text
      else null
      end
    )
    
      
            as "4602f806-3bf4-4f16-bee1-c2e690dca588"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b'
        then answer_value_text
      else null
      end
    )
    
      
            as "a3831bfc-0175-4e5a-8d8d-7313c7f2b69b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6'
        then answer_value_text
      else null
      end
    )
    
      
            as "a8c2cacf-7ee5-4076-af42-19d0eba0e6d6"
      
    
    ,
  
    max(
      
      case
      when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef'
        then answer_value_text
      else null
      end
    )
    
      
            as "3ce3bf84-176e-40bc-8075-1517a03c6bef"
      
    
    ,
  
    max(
      
      case
      when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "39dfd1f4-01db-4057-9734-4f2fbd83b8fe"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e7579d-ac74-4d72-955b-1a3675a2e656"
      
    
    ,
  
    max(
      
      case
      when linkid = '749d2a97-4195-4516-8079-60638a4d9e82'
        then answer_value_text
      else null
      end
    )
    
      
            as "749d2a97-4195-4516-8079-60638a4d9e82"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc'
        then answer_value_text
      else null
      end
    )
    
      
            as "ca41ccab-5f0b-4538-b394-ad342a0b5bdc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c457ea8-c60d-49f7-b166-ebabf737ab22"
      
    
    ,
  
    max(
      
      case
      when linkid = '7db481df-19e5-400c-a206-4811b39485d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "7db481df-19e5-400c-a206-4811b39485d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99'
        then answer_value_text
      else null
      end
    )
    
      
            as "936d5c53-d176-4c63-9a3a-e9e7f9db3f99"
      
    
    ,
  
    max(
      
      case
      when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f'
        then answer_value_text
      else null
      end
    )
    
      
            as "19dd65c2-8709-4745-81f2-4d4843c4307f"
      
    
    ,
  
    max(
      
      case
      when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318'
        then answer_value_text
      else null
      end
    )
    
      
            as "7fef53bc-56db-47ce-8cba-8efd4bcbc318"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a302513b-141a-4316-9546-d013212a361e'
        then answer_value_text
      else null
      end
    )
    
      
            as "a302513b-141a-4316-9546-d013212a361e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "6d9345d7-61a0-425b-8496-8b08d68175d0"
      
    
    ,
  
    max(
      
      case
      when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74'
        then answer_value_text
      else null
      end
    )
    
      
            as "49a270cd-b72b-42a6-92e3-c139f7a85d74"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036'
        then answer_value_text
      else null
      end
    )
    
      
            as "dd000285-7c36-44b4-82e6-4e8826665036"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b65857a-5c04-4414-833d-10602f04d299'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b65857a-5c04-4414-833d-10602f04d299"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec39511c-de47-469d-ac44-973e3fc08532"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa30ce6c-4153-46d8-a4af-83012eafa23d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19'
        then answer_value_text
      else null
      end
    )
    
      
            as "9b602b02-e5f9-4795-9fb9-fc7ae4353a19"
      
    
    ,
  
    max(
      
      case
      when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7'
        then answer_value_text
      else null
      end
    )
    
      
            as "83a63af9-6f49-4fad-bca9-80776fc97be7"
      
    
    ,
  
    max(
      
      case
      when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de'
        then answer_value_text
      else null
      end
    )
    
      
            as "9a02423f-9848-4254-b427-3dfa8819d0de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824'
        then answer_value_text
      else null
      end
    )
    
      
            as "05617430-b835-4ebd-8d6a-ff58ef6d2824"
      
    
    ,
  
    max(
      
      case
      when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "9848888d-1ec0-4d43-b53f-7613ba5144fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e9014d1-e07c-492e-897a-3bf7e8f6f018"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:57.573567 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:26:57.575191 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:26:57.575370 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_tmp" rename to "qr_63"
[0m23:26:57.576387 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:57.576972 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: COMMIT
[0m23:26:57.577133 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:26:57.577276 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: COMMIT
[0m23:26:57.578309 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:57.579543 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_backup"
[0m23:26:57.579818 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:26:57.579988 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_backup" cascade
[0m23:26:57.580592 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:57.581300 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: Close
[0m23:26:57.581682 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7272c0>]}
[0m23:26:57.582132 [info ] [Thread-3 (]: 80 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_63  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:57.582420 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_63
[0m23:26:57.582613 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_q_planning_next_steps
[0m23:26:57.582816 [info ] [Thread-3 (]: 84 of 84 START sql view model engage_analytics_engage_analytics_mart.qr_q_planning_next_steps  [RUN]
[0m23:26:57.583032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_63, now model.engage_analytics.qr_q_planning_next_steps)
[0m23:26:57.583197 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_q_planning_next_steps
[0m23:26:57.586730 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:26:57.587018 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:26:57.587199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:26:57.792490 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.550 seconds
[0m23:26:57.799630 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_69"
[0m23:26:57.800056 [debug] [Thread-2 (]: SQL status: SELECT 36 in 0.558 seconds
[0m23:26:57.801869 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:26:57.802388 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_69
[0m23:26:57.804516 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_69"
[0m23:26:57.804849 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:26:57.805155 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:26:57.806922 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:26:57.807146 [debug] [Thread-4 (]: On model.engage_analytics.qr_69: BEGIN
[0m23:26:57.808085 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:57.808318 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:26:57.808608 [debug] [Thread-4 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- eCBIS Remove Family Form (id: ipc-69, url: n/a, version: 0.0.2)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f'
        then answer_value_text
      else null
      end
    )
    
      
            as "17b7fda5-514c-4408-88e7-52313ab0ef2f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-birthdate'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-birthdate"
      
    
    ,
  
    max(
      
      case
      when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "98ac4694-590e-4cc2-83f3-cc6455e688c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a'
        then answer_value_text
      else null
      end
    )
    
      
            as "8489d249-1ef3-4edb-aa99-b5713fd2cb0a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd73cfdf-6d70-4b42-8887-21e27db0b9ec"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff'
        then answer_value_text
      else null
      end
    )
    
      
            as "f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1'
        then answer_value_text
      else null
      end
    )
    
      
            as "b6c21488-87b8-4213-8cd0-d482367669c1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:57.808963 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:26:57.809130 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: BEGIN
[0m23:26:57.809677 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:57.809840 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:26:57.810210 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Common Mental Health Symptoms (id: q-common-mental-health-symptoms, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879"
      
    
    ,
  
    max(
      
      case
      when linkid = '16d05294-fee9-4d42-8447-0d578a5de192'
        then answer_value_text
      else null
      end
    )
    
      
            as "16d05294-fee9-4d42-8447-0d578a5de192"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603'
        then answer_value_text
      else null
      end
    )
    
      
            as "829e6d32-3fa7-4d16-909b-b198aea54603"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-common-mental-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-common-mental-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "583c5b02-b26c-4821-8da8-7ed9066d9d5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a05b4fe-b514-4751-91be-adb1b278430c"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-pcl-5-to-8-questions'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-pcl-5-to-8-questions"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:57.811197 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:26:57.812873 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:26:57.813118 [debug] [Thread-4 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_tmp" rename to "qr_69"
[0m23:26:57.813482 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:57.814898 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:26:57.815081 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_tmp" rename to "qr_q_common_mental_health_symptoms"
[0m23:26:57.815301 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:57.815964 [debug] [Thread-4 (]: On model.engage_analytics.qr_69: COMMIT
[0m23:26:57.816142 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:26:57.816286 [debug] [Thread-4 (]: On model.engage_analytics.qr_69: COMMIT
[0m23:26:57.816460 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:57.817241 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: COMMIT
[0m23:26:57.817443 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:57.817630 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:26:57.818906 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_backup"
[0m23:26:57.819141 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: COMMIT
[0m23:26:57.819434 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:26:57.819699 [debug] [Thread-4 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_backup" cascade
[0m23:26:57.820426 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:57.820670 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:57.821914 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_backup"
[0m23:26:57.822744 [debug] [Thread-4 (]: On model.engage_analytics.qr_69: Close
[0m23:26:57.823030 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:26:57.823403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d444cb0>]}
[0m23:26:57.823648 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_backup" cascade
[0m23:26:57.824093 [info ] [Thread-4 (]: 81 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_69  [[32mCREATE VIEW[0m in 0.59s]
[0m23:26:57.824522 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_69
[0m23:26:57.825084 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:57.825865 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: Close
[0m23:26:57.826161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d444c50>]}
[0m23:26:57.826467 [info ] [Thread-2 (]: 82 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 0.59s]
[0m23:26:57.826729 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:26:58.004476 [debug] [Thread-1 (]: SQL status: SELECT 23 in 0.547 seconds
[0m23:26:58.007047 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:26:58.007579 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:26:58.009379 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:26:58.010560 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:26:58.010801 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: BEGIN
[0m23:26:58.011503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:26:58.011673 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:26:58.011994 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Financial Wellness Tool (id: q-financial-wellness-tool, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'moderate-housing-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-housing-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'overall-financial-hardship'
        then answer_value_text
      else null
      end
    )
    
      
            as "overall-financial-hardship"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-medical-hardships'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-medical-hardships"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "cdef0123-4567-89ab-cdef-0123456789ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '51234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "51234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '31234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "31234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '91234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "91234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-housing-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-housing-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-food-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-food-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-debt'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-debt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c1234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-paying-bills'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-paying-bills"
      
    
    ,
  
    max(
      
      case
      when linkid = '3456789a-bcde-f012-3456-789abcdef012'
        then answer_value_text
      else null
      end
    )
    
      
            as "3456789a-bcde-f012-3456-789abcdef012"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-debt'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-debt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-food-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-food-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = '61234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "61234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '6789abcd-ef01-2345-6789-abcdef012345'
        then answer_value_text
      else null
      end
    )
    
      
            as "6789abcd-ef01-2345-6789-abcdef012345"
      
    
    ,
  
    max(
      
      case
      when linkid = '21234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "21234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-financial-hardship'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-financial-hardship"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-paying-bills'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-paying-bills"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f0123456-789a-bcde-f012-3456789abcde'
        then answer_value_text
      else null
      end
    )
    
      
            as "f0123456-789a-bcde-f012-3456789abcde"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:58.015273 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:26:58.016871 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:26:58.017062 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_tmp" rename to "qr_q_financial_wellness_tool"
[0m23:26:58.017940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:58.018516 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: COMMIT
[0m23:26:58.018689 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:26:58.018841 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: COMMIT
[0m23:26:58.019563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:58.020717 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_backup"
[0m23:26:58.020958 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:26:58.021117 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_backup" cascade
[0m23:26:58.021638 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:58.022423 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_financial_wellness_tool: Close
[0m23:26:58.022724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d837b90>]}
[0m23:26:58.110404 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m23:26:58.112011 [info ] [Thread-1 (]: 83 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_financial_wellness_tool  [[32mCREATE VIEW[0m in 0.57s]
[0m23:26:58.113703 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:26:58.139537 [debug] [Thread-3 (]: SQL status: SELECT 66 in 0.552 seconds
[0m23:26:58.146564 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_q_planning_next_steps"
[0m23:26:58.148243 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_q_planning_next_steps
[0m23:26:58.150262 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_q_planning_next_steps"
[0m23:26:58.150672 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:26:58.150845 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: BEGIN
[0m23:26:58.151446 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:58.151642 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:26:58.152217 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Planning Next Steps (id: q-planning-next-steps, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d'
        then answer_value_text
      else null
      end
    )
    
      
            as "2cb66889-3c74-40ff-be3d-183fdb17ce2d"
      
    
    ,
  
    max(
      
      case
      when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd34f5b1-8dff-4fd1-b1a0-a1356789abcd"
      
    
    ,
  
    max(
      
      case
      when linkid = '69712544-6237-4962-a455-ee6e9ee80000'
        then answer_value_text
      else null
      end
    )
    
      
            as "69712544-6237-4962-a455-ee6e9ee80000"
      
    
    ,
  
    max(
      
      case
      when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7'
        then answer_value_text
      else null
      end
    )
    
      
            as "12894a06-d244-4426-06f5-f2a3b4c5d6e7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt-optional'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt-optional"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-other-services-outside-agency'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-other-services-outside-agency"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt-main'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt-main"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc23e4a0-7cee-4ec0-a09f-902456789abc"
      
    
    ,
  
    max(
      
      case
      when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "1d2fdd10-a4d1-43e0-8042-8772146e63f7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a'
        then answer_value_text
      else null
      end
    )
    
      
            as "de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-002'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-002"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i'
        then answer_value_text
      else null
      end
    )
    
      
            as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7"
      
    
    ,
  
    max(
      
      case
      when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "45b67d39-0577-4759-3928-52c3d4e5f6a7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-000'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-000"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-003'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-003"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100'
        then answer_value_text
      else null
      end
    )
    
      
            as "f4e3d2c1-b0a9-4988-7766-554433221100"
      
    
    ,
  
    max(
      
      case
      when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01'
        then answer_value_text
      else null
      end
    )
    
      
            as "34ab6c28-f466-4648-2817-1eacbdcedf01"
      
    
    ,
  
    max(
      
      case
      when linkid = 'scheduled-ipc-session-1-with-current-time'
        then answer_value_text
      else null
      end
    )
    
      
            as "scheduled-ipc-session-1-with-current-time"
      
    
    ,
  
    max(
      
      case
      when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123'
        then answer_value_text
      else null
      end
    )
    
      
            as "45bc7d39-0577-4759-3928-2fbdcedf0123"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc-main'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc-main"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc"
      
    
    ,
  
    max(
      
      case
      when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4"
      
    
    ,
  
    max(
      
      case
      when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e'
        then answer_value_text
      else null
      end
    )
    
      
            as "76ba8dbe-5456-4de4-bdde-4b8059ecfa0e"
      
    
    ,
  
    max(
      
      case
      when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106'
        then answer_value_text
      else null
      end
    )
    
      
            as "950d904a-da1a-4ccd-988d-ea6b463ee106"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-004'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-004"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-spi'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-spi"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-planning-next-steps-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-planning-next-steps-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "ab12d39f-6bdd-4dbf-9f8e-8f13456789ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90'
        then answer_value_text
      else null
      end
    )
    
      
            as "de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90"
      
    
    ,
  
    max(
      
      case
      when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "34a56c28-f466-4648-2817-41b2c3d4e5f6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-006'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-006"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-fws'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-fws"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f"
      
    
    ,
  
    max(
      
      case
      when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574'
        then answer_value_text
      else null
      end
    )
    
      
            as "9311146c-720d-47f6-b902-aeecaf3c0574"
      
    
    ,
  
    max(
      
      case
      when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f'
        then answer_value_text
      else null
      end
    )
    
      
            as "256b56d8-c4c2-4313-9e2d-6720941be85f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g"
      
    
    ,
  
    max(
      
      case
      when linkid = 'financial-hardships-list'
        then answer_value_text
      else null
      end
    )
    
      
            as "financial-hardships-list"
      
    
    ,
  
    max(
      
      case
      when linkid = 'scheduled-ipc-session-1-with-current-time-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "scheduled-ipc-session-1-with-current-time-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-001'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-001"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-mhs'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-mhs"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-other-agency-services'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-other-agency-services"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d373ba7-14fa-43bb-bd27-52fad3d2783f"
      
    
    ,
  
    max(
      
      case
      when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345'
        then answer_value_text
      else null
      end
    )
    
      
            as "56cd8e4a-1688-486a-4a39-3acedf012345"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "f06728e4-b022-4204-e4d3-d0e1f2a3b4c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9'
        then answer_value_text
      else null
      end
    )
    
      
            as "34ab6c28-f466-4648-2817-14c5d6e7f8a9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc-optional'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc-optional"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:26:58.157585 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:26:58.159081 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:26:58.159264 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_tmp" rename to "qr_q_planning_next_steps"
[0m23:26:58.160405 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:58.160993 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: COMMIT
[0m23:26:58.161165 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:26:58.161316 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: COMMIT
[0m23:26:58.161989 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:26:58.163033 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_backup"
[0m23:26:58.163273 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:26:58.163433 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_backup" cascade
[0m23:26:58.163868 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:26:58.164549 [debug] [Thread-3 (]: On model.engage_analytics.qr_q_planning_next_steps: Close
[0m23:26:58.164843 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8a2f54-757b-4c19-a0ca-4ae013a3237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d47e4e0>]}
[0m23:26:58.165171 [info ] [Thread-3 (]: 84 of 84 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_planning_next_steps  [[32mCREATE VIEW[0m in 0.58s]
[0m23:26:58.165457 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_q_planning_next_steps
[0m23:26:58.166304 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:58.166470 [debug] [MainThread]: On master: BEGIN
[0m23:26:58.166600 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:58.173040 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:26:58.173269 [debug] [MainThread]: On master: COMMIT
[0m23:26:58.173413 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:58.173628 [debug] [MainThread]: On master: COMMIT
[0m23:26:58.174561 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:26:58.174771 [debug] [MainThread]: On master: Close
[0m23:26:58.176975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:58.179483 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_financial_wellness_tool' was properly closed.
[0m23:26:58.182426 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_common_mental_health_symptoms' was properly closed.
[0m23:26:58.185918 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_planning_next_steps' was properly closed.
[0m23:26:58.188292 [debug] [MainThread]: Connection 'model.engage_analytics.qr_69' was properly closed.
[0m23:26:58.190928 [info ] [MainThread]: 
[0m23:26:58.194968 [info ] [MainThread]: Finished running 18 incremental models, 66 view models in 0 hours 0 minutes and 10.20 seconds (10.20s).
[0m23:26:58.211876 [debug] [MainThread]: Command end result
[0m23:26:58.250119 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:26:58.251426 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:26:58.261424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m23:26:58.261609 [info ] [MainThread]: 
[0m23:26:58.261783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:58.261936 [info ] [MainThread]: 
[0m23:26:58.262087 [info ] [MainThread]: Done. PASS=84 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=84
[0m23:26:58.262463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.680923, "process_in_blocks": "0", "process_kernel_time": 0.376612, "process_mem_max_rss": "139034624", "process_out_blocks": "0", "process_user_time": 3.080743}
[0m23:26:58.262677 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:58.262641 after 10.68 seconds
[0m23:26:58.262857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7e5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c121250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d823770>]}
[0m23:26:58.263016 [debug] [MainThread]: Flushing usage events
[0m23:26:58.317924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:47.200890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10151f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e651c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e64e90>]}


============================== 23:49:47.205291 | 117b45e2-15ca-4f45-b021-bed3561bfbd1 ==============================
[0m23:49:47.205291 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:49:47.205732 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m23:49:47.306626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f4d40>]}
[0m23:49:47.334589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537d850>]}
[0m23:49:47.335426 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:49:47.387279 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:49:47.486532 [debug] [MainThread]: Partial parsing enabled: 28 files deleted, 0 files added, 0 files changed.
[0m23:49:47.486938 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_57.sql
[0m23:49:47.487083 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_208.sql
[0m23:49:47.487210 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_202.sql
[0m23:49:47.487325 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_104394.sql
[0m23:49:47.487438 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_58.sql
[0m23:49:47.487546 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_56.sql
[0m23:49:47.487651 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_203.sql
[0m23:49:47.487755 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_54.sql
[0m23:49:47.487861 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_104455.sql
[0m23:49:47.487962 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_210.sql
[0m23:49:47.488064 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_61.sql
[0m23:49:47.488207 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_206.sql
[0m23:49:47.488396 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_23451.sql
[0m23:49:47.488530 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_212.sql
[0m23:49:47.488647 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_69.sql
[0m23:49:47.488755 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_63.sql
[0m23:49:47.488857 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_221.sql
[0m23:49:47.488960 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_59.sql
[0m23:49:47.489064 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_209.sql
[0m23:49:47.489169 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_55.sql
[0m23:49:47.489272 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_204.sql
[0m23:49:47.489370 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_60.sql
[0m23:49:47.489469 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_104454.sql
[0m23:49:47.489565 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_207.sql
[0m23:49:47.489664 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_62.sql
[0m23:49:47.489760 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_205.sql
[0m23:49:47.489857 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_211.sql
[0m23:49:47.489951 [debug] [MainThread]: Partial parsing: deleted file: engage_analytics://models/marts/qr_wide/qr_ipc_104453.sql
[0m23:49:47.526382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bc0b0>]}
[0m23:49:47.574227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:49:47.575665 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:49:47.589715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af2a20>]}
[0m23:49:47.590008 [info ] [MainThread]: Found 56 models, 12 sources, 557 macros
[0m23:49:47.590183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4b3e0>]}
[0m23:49:47.591961 [info ] [MainThread]: 
[0m23:49:47.592152 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:49:47.592289 [info ] [MainThread]: 
[0m23:49:47.592530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:47.595487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:49:47.596646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:49:47.602996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m23:49:47.625801 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:49:47.626041 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:49:47.626217 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:49:47.626364 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m23:49:47.626510 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:49:47.626661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:47.626796 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m23:49:47.626928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:47.627831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:47.663497 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.037 seconds
[0m23:49:47.663755 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.036 seconds
[0m23:49:47.663944 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.037 seconds
[0m23:49:47.664646 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:49:47.665191 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:49:47.665708 [debug] [ThreadPool]: On list_airbyte: Close
[0m23:49:47.668014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m23:49:47.671071 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:49:47.671330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_stg)
[0m23:49:47.671476 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m23:49:47.671709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m23:49:47.673334 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:49:47.673523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:47.674420 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:49:47.674571 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m23:49:47.674797 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m23:49:47.674926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:47.675044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:47.691288 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m23:49:47.691524 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m23:49:47.691686 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m23:49:47.691868 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:49:47.691986 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m23:49:47.692140 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m23:49:47.692280 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m23:49:47.692422 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m23:49:47.692623 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m23:49:47.697562 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m23:49:47.697824 [debug] [ThreadPool]: SQL status: SELECT 70 in 0.005 seconds
[0m23:49:47.698664 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m23:49:47.698816 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m23:49:47.699784 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m23:49:47.700347 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m23:49:47.700501 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m23:49:47.701489 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m23:49:47.701651 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m23:49:47.708548 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:47.708740 [debug] [MainThread]: On master: BEGIN
[0m23:49:47.708866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:47.717735 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:49:47.717935 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:47.718115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:49:47.721332 [debug] [MainThread]: SQL status: SELECT 106 in 0.003 seconds
[0m23:49:47.728686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105402c60>]}
[0m23:49:47.728919 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:47.729923 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:47.730133 [debug] [MainThread]: On master: BEGIN
[0m23:49:47.731279 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:49:47.731462 [debug] [MainThread]: On master: COMMIT
[0m23:49:47.731586 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:47.731707 [debug] [MainThread]: On master: COMMIT
[0m23:49:47.732226 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:47.732383 [debug] [MainThread]: On master: Close
[0m23:49:47.734635 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_careplans
[0m23:49:47.734932 [info ] [Thread-1 (]: 1 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [RUN]
[0m23:49:47.735198 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_careteams
[0m23:49:47.735473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.stg_careplans)
[0m23:49:47.735664 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_encounter
[0m23:49:47.735901 [info ] [Thread-2 (]: 2 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [RUN]
[0m23:49:47.736087 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_careplans
[0m23:49:47.736229 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_locations
[0m23:49:47.736416 [info ] [Thread-3 (]: 3 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [RUN]
[0m23:49:47.736623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_stg, now model.engage_analytics.stg_careteams)
[0m23:49:47.745060 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_careplans"
[0m23:49:47.745405 [info ] [Thread-4 (]: 4 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [RUN]
[0m23:49:47.745786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.stg_encounter)
[0m23:49:47.746040 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_careteams
[0m23:49:47.746453 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.engage_analytics.stg_locations'
[0m23:49:47.746711 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_encounter
[0m23:49:47.749191 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_careteams"
[0m23:49:47.749419 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_locations
[0m23:49:47.751592 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_encounter"
[0m23:49:47.751794 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_careplans
[0m23:49:47.754635 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_locations"
[0m23:49:47.773933 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_careteams
[0m23:49:47.803143 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_encounter
[0m23:49:47.812232 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:49:47.814312 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:49:47.815980 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:49:47.816208 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_locations
[0m23:49:47.816430 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

    
  
    

  create temporary table "stg_careplans__dbt_tmp234947770517"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'title' as title,
    resource::jsonb ->> 'author' as author,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'created' as created,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'activity' as activity,
    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."care_plan"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans")

  );
  
  
[0m23:49:47.816700 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

    
  
    

  create temporary table "stg_careteams__dbt_tmp234947813587"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'participant' as participant,
_airbyte_extracted_at as _airbyte_emitted_at,
resource
from "airbyte"."airbyte"."care_team"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams")

  );
  
  
[0m23:49:47.816914 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

    
  
    

  create temporary table "stg_encounter__dbt_tmp234947815338"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'subject' as subject,
    resource::jsonb ->> 'serviceType' as serviceType,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'class' as class,
    resource::jsonb ->> 'serviceProvider' as serviceProvider,
    resource::jsonb ->> 'reasonCode' as reasonCode,
    resource::jsonb ->> 'participant' as participant,
    resource::jsonb ->> 'type' as type,
    resource::jsonb ->> 'period' as period,
    resource::jsonb ->> 'status' as status,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."encounter"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter")

  );
  
  
[0m23:49:47.818529 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:49:47.818733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:47.818891 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:47.819047 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:47.819229 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

    
  
    

  create temporary table "stg_locations__dbt_tmp234947817953"
  
  
    as
  
  (
    




with previous_extraction as (
  select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'partOf' as partOf,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'physicalType' as physicalType,
    resource::jsonb ->> 'name' as name,
    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,
    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,
  _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."location"
)
select
  *,
  partof::jsonb -> 'display'   as parent_name,
  
  split_part(partof::jsonb->>'reference', '/', 2)
 as parent_id,
  partof::jsonb -> 'reference' as parent_reference
from previous_extraction

where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations")

  );
  
  
[0m23:49:47.819626 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:49:47.848902 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.030 seconds
[0m23:49:47.849227 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.030 seconds
[0m23:49:47.856180 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:49:47.856427 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.038 seconds
[0m23:49:47.856654 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.038 seconds
[0m23:49:47.858277 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:49:47.858511 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: BEGIN
[0m23:49:47.859789 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:49:47.861058 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:49:47.861254 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: BEGIN
[0m23:49:47.861463 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: BEGIN
[0m23:49:47.861660 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: BEGIN
[0m23:49:47.861904 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:47.862194 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:47.862413 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:49:47.862674 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:49:47.862922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:47.863787 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:47.864003 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams__dbt_tmp234947813587'
        
      order by ordinal_position

  
[0m23:49:47.864193 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations__dbt_tmp234947817953'
        
      order by ordinal_position

  
[0m23:49:47.864380 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:49:47.864542 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:49:47.864766 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans__dbt_tmp234947770517'
        
      order by ordinal_position

  
[0m23:49:47.864953 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter__dbt_tmp234947815338'
        
      order by ordinal_position

  
[0m23:49:47.870238 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.005 seconds
[0m23:49:47.870492 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.006 seconds
[0m23:49:47.870678 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.005 seconds
[0m23:49:47.873463 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:49:47.873664 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.008 seconds
[0m23:49:47.875090 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:49:47.876477 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:49:47.876682 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.878222 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:49:47.878415 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.878600 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.878820 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.880704 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.002 seconds
[0m23:49:47.880973 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.002 seconds
[0m23:49:47.884535 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:49:47.884720 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.006 seconds
[0m23:49:47.884869 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.006 seconds
[0m23:49:47.886301 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:49:47.886499 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_encounter'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.887912 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:49:47.889483 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:49:47.889701 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careplans'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.889931 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_locations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.890137 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_careteams'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.892920 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.003 seconds
[0m23:49:47.898296 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.008 seconds
[0m23:49:47.898552 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.008 seconds
[0m23:49:47.898731 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.008 seconds
[0m23:49:47.901082 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_encounter"
[0m23:49:47.902045 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_careteams"
[0m23:49:47.902972 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_careplans"
[0m23:49:47.903824 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_locations"
[0m23:49:47.904474 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:49:47.904755 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:49:47.904993 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careteams"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careteams__dbt_tmp234947813587" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams" ("id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource")
    (
        select "id", "meta", "name", "status", "identifier", "resourcetype", "managingorganization", "participant", "_airbyte_emitted_at", "resource"
        from "stg_careteams__dbt_tmp234947813587"
    )
  
[0m23:49:47.905191 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:49:47.905375 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_careplans"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_careplans__dbt_tmp234947770517" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_careplans" ("id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "title", "author", "description", "resourcetype", "intent", "created", "period", "identifier", "status", "activity", "instantiatescanonical", "_airbyte_emitted_at"
        from "stg_careplans__dbt_tmp234947770517"
    )
  
[0m23:49:47.905586 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:49:47.905799 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_encounter"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_encounter__dbt_tmp234947815338" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" ("id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at")
    (
        select "id", "meta", "subject", "servicetype", "resourcetype", "priority", "class", "serviceprovider", "reasoncode", "participant", "type", "period", "status", "_airbyte_emitted_at"
        from "stg_encounter__dbt_tmp234947815338"
    )
  
[0m23:49:47.906038 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_locations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_locations__dbt_tmp234947817953" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_locations" ("id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference")
    (
        select "id", "meta", "description", "partof", "resourcetype", "status", "physicaltype", "name", "alias", "identifier", "_airbyte_emitted_at", "parent_name", "parent_id", "parent_reference"
        from "stg_locations__dbt_tmp234947817953"
    )
  
[0m23:49:47.907719 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:49:47.907877 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:49:47.913784 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.008 seconds
[0m23:49:47.914047 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.008 seconds
[0m23:49:47.919370 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m23:49:47.919665 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m23:49:47.920248 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m23:49:47.920845 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m23:49:47.921037 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_careteams"
[0m23:49:47.921189 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_careplans"
[0m23:49:47.921336 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_encounter"
[0m23:49:47.921476 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_locations"
[0m23:49:47.921676 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: COMMIT
[0m23:49:47.921820 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: COMMIT
[0m23:49:47.921962 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: COMMIT
[0m23:49:47.922095 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: COMMIT
[0m23:49:47.923867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:47.924757 [debug] [Thread-1 (]: On model.engage_analytics.stg_careplans: Close
[0m23:49:47.924948 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:49:47.925249 [debug] [Thread-4 (]: On model.engage_analytics.stg_locations: Close
[0m23:49:47.926020 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:49:47.926302 [debug] [Thread-3 (]: On model.engage_analytics.stg_encounter: Close
[0m23:49:47.926494 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m23:49:47.926911 [debug] [Thread-2 (]: On model.engage_analytics.stg_careteams: Close
[0m23:49:47.927355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061aee40>]}
[0m23:49:47.927697 [info ] [Thread-1 (]: 1 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careplans  [[32mINSERT 0 0[0m in 0.19s]
[0m23:49:47.927984 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_careplans
[0m23:49:47.928172 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_organization_affiliations
[0m23:49:47.928374 [info ] [Thread-1 (]: 5 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [RUN]
[0m23:49:47.928562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careplans, now model.engage_analytics.stg_organization_affiliations)
[0m23:49:47.928731 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_organization_affiliations
[0m23:49:47.928978 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537f8c0>]}
[0m23:49:47.929129 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db9af0>]}
[0m23:49:47.931420 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.931619 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a4b30>]}
[0m23:49:47.931981 [info ] [Thread-2 (]: 2 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_careteams  [[32mINSERT 0 0[0m in 0.19s]
[0m23:49:47.932311 [info ] [Thread-4 (]: 4 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_locations  [[32mINSERT 0 0[0m in 0.18s]
[0m23:49:47.932682 [info ] [Thread-3 (]: 3 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_encounter  [[32mINSERT 0 0[0m in 0.18s]
[0m23:49:47.933189 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_careteams
[0m23:49:47.933445 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_locations
[0m23:49:47.933667 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_organization_affiliations
[0m23:49:47.933889 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_encounter
[0m23:49:47.934087 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_organizations
[0m23:49:47.934315 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_patient
[0m23:49:47.936135 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.936356 [debug] [Thread-3 (]: Began running node model.engage_analytics.stg_practitioner
[0m23:49:47.936595 [info ] [Thread-2 (]: 6 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [RUN]
[0m23:49:47.936885 [info ] [Thread-4 (]: 7 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [RUN]
[0m23:49:47.937131 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

    
  
    

  create temporary table "stg_organization_affiliations__dbt_tmp234947935493"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'identifier' as identifier,
    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."organization_affiliation"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations")

  );
  
  
[0m23:49:47.937659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_careteams, now model.engage_analytics.stg_organizations)
[0m23:49:47.937405 [info ] [Thread-3 (]: 8 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [RUN]
[0m23:49:47.937961 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_locations, now model.engage_analytics.stg_patient)
[0m23:49:47.938167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:47.938396 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_organizations
[0m23:49:47.938642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_encounter, now model.engage_analytics.stg_practitioner)
[0m23:49:47.938850 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_patient
[0m23:49:47.941305 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_organizations"
[0m23:49:47.941560 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.stg_practitioner
[0m23:49:47.944127 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_patient"
[0m23:49:47.946338 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner"
[0m23:49:47.946935 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_organizations
[0m23:49:47.948840 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:49:47.949112 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_patient
[0m23:49:47.949441 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

    
  
    

  create temporary table "stg_organizations__dbt_tmp234947948148"
  
  
    as
  
  (
    



 
    
    select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'name' as name,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,
     _airbyte_extracted_at as _airbyte_emitted_at 

    from "airbyte"."airbyte"."organization"



  -- this filter will only be applied on an incremental run
   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations")

  );
  
  
[0m23:49:47.949627 [debug] [Thread-3 (]: Began executing node model.engage_analytics.stg_practitioner
[0m23:49:47.951365 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:49:47.951553 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:47.954134 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:49:47.954306 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.016 seconds
[0m23:49:47.954577 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

    
  
    

  create temporary table "stg_patient__dbt_tmp234947950722"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'gender' as gender,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'birthDate' as birthDate,
    resource::jsonb ->> 'managingOrganization' as managingOrganization,
    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'text' as text,
    resource::jsonb ->> 'identifier' as identifier,
((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,
((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,
((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,
((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."patient"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient")

  );
  
  
[0m23:49:47.955046 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

    
  
    

  create temporary table "stg_practitioner__dbt_tmp234947953550"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'identifier' as identifier,
    resource::jsonb ->> 'resourceType' as resourceType,
    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,
    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner")

  );
  
  
[0m23:49:47.956646 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.956900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:47.957177 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:47.957405 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: BEGIN
[0m23:49:47.958780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:47.958997 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.959190 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations__dbt_tmp234947935493'
        
      order by ordinal_position

  
[0m23:49:47.963877 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:49:47.965591 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.965807 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.967755 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:47.969419 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.969650 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.018 seconds
[0m23:49:47.969874 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.971480 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:49:47.971795 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: BEGIN
[0m23:49:47.972175 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.015 seconds
[0m23:49:47.972450 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:47.974088 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:49:47.974331 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.017 seconds
[0m23:49:47.974515 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:49:47.974665 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:49:47.974842 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: BEGIN
[0m23:49:47.976268 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:49:47.976475 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations__dbt_tmp234947948148'
        
      order by ordinal_position

  
[0m23:49:47.977425 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.977655 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: BEGIN
[0m23:49:47.978045 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:47.978414 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:49:47.978612 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner__dbt_tmp234947953550'
        
      order by ordinal_position

  
[0m23:49:47.978814 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:47.979011 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:49:47.979167 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient__dbt_tmp234947950722'
        
      order by ordinal_position

  
[0m23:49:47.979370 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.979548 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organization_affiliations__dbt_tmp234947935493" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" ("id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "identifier", "location", "_airbyte_emitted_at"
        from "stg_organization_affiliations__dbt_tmp234947935493"
    )
  
[0m23:49:47.980339 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:47.981062 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m23:49:47.981265 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_organization_affiliations"
[0m23:49:47.981425 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: COMMIT
[0m23:49:47.981817 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:49:47.983436 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:49:47.983674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:47.983892 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.984080 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:49:47.984243 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.005 seconds
[0m23:49:47.984603 [debug] [Thread-1 (]: On model.engage_analytics.stg_organization_affiliations: Close
[0m23:49:47.986364 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:49:47.986584 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:47.988108 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:49:47.988339 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.988643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e88f0>]}
[0m23:49:47.991287 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:49:47.991538 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.992082 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:47.991918 [info ] [Thread-1 (]: 5 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organization_affiliations  [[32mINSERT 0 0[0m in 0.06s]
[0m23:49:47.992431 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_organization_affiliations
[0m23:49:47.992626 [debug] [Thread-1 (]: Began running node model.engage_analytics.stg_practitioner_roles
[0m23:49:47.992878 [info ] [Thread-1 (]: 9 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [RUN]
[0m23:49:47.993174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organization_affiliations, now model.engage_analytics.stg_practitioner_roles)
[0m23:49:47.993361 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.stg_practitioner_roles
[0m23:49:47.993575 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:47.995964 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.stg_practitioner_roles"
[0m23:49:47.996196 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:49:47.996397 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.004 seconds
[0m23:49:47.998060 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:49:47.999166 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_organizations"
[0m23:49:48.001011 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:49:48.001299 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:48.001640 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patient'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:48.001988 [debug] [Thread-1 (]: Began executing node model.engage_analytics.stg_practitioner_roles
[0m23:49:48.003723 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:49:48.003972 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:48.004217 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

    
  
    

  create temporary table "stg_practitioner_roles__dbt_tmp234948003049"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'active' as active,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'organization' as organization,
    resource::jsonb ->> 'practitioner' as practitioner,
    resource::jsonb ->> 'code' as code,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."practitioner_role"


where _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles")

  );
  
  
[0m23:49:48.004457 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:49:48.004620 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.003 seconds
[0m23:49:48.005650 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner"
[0m23:49:48.005863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:48.006121 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_organizations__dbt_tmp234947948148" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" ("id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at")
    (
        select "id", "meta", "name", "active", "identifier", "resourcetype", "type", "_airbyte_emitted_at"
        from "stg_organizations__dbt_tmp234947948148"
    )
  
[0m23:49:48.007286 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_patient"
[0m23:49:48.007777 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:49:48.007963 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner__dbt_tmp234947953550" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" ("id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "identifier", "resourcetype", "name", "telecom", "_airbyte_emitted_at"
        from "stg_practitioner__dbt_tmp234947953550"
    )
  
[0m23:49:48.008176 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:49:48.008449 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_patient__dbt_tmp234947950722" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" ("id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at")
    (
        select "id", "meta", "gender", "resourcetype", "birthdate", "managingorganization", "deceasedboolean", "active", "text", "identifier", "telecom_value", "generalpractitioner_reference", "name_given", "name_family", "period_start", "_airbyte_emitted_at"
        from "stg_patient__dbt_tmp234947950722"
    )
  
[0m23:49:48.008686 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:48.009416 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m23:49:48.009643 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:48.009865 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_organizations"
[0m23:49:48.010037 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:49:48.010732 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: COMMIT
[0m23:49:48.010926 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: COMMIT
[0m23:49:48.011465 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m23:49:48.011636 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_patient"
[0m23:49:48.011821 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.stg_practitioner"
[0m23:49:48.011975 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: COMMIT
[0m23:49:48.012142 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: COMMIT
[0m23:49:48.012391 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.012786 [debug] [Thread-2 (]: On model.engage_analytics.stg_organizations: Close
[0m23:49:48.012974 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.013165 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.013447 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624f320>]}
[0m23:49:48.013809 [debug] [Thread-4 (]: On model.engage_analytics.stg_patient: Close
[0m23:49:48.014208 [debug] [Thread-3 (]: On model.engage_analytics.stg_practitioner: Close
[0m23:49:48.014537 [info ] [Thread-2 (]: 6 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_organizations  [[32mINSERT 0 0[0m in 0.08s]
[0m23:49:48.014870 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061be240>]}
[0m23:49:48.015117 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ee480>]}
[0m23:49:48.015378 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_organizations
[0m23:49:48.016199 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m23:49:48.016421 [debug] [Thread-2 (]: Began running node model.engage_analytics.stg_questionnaire_response
[0m23:49:48.015667 [info ] [Thread-4 (]: 7 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_patient  [[32mINSERT 0 0[0m in 0.08s]
[0m23:49:48.018079 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:49:48.015972 [info ] [Thread-3 (]: 8 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner  [[32mINSERT 0 0[0m in 0.08s]
[0m23:49:48.018436 [info ] [Thread-2 (]: 10 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [RUN]
[0m23:49:48.018749 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_patient
[0m23:49:48.018928 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: BEGIN
[0m23:49:48.019155 [debug] [Thread-3 (]: Finished running node model.engage_analytics.stg_practitioner
[0m23:49:48.019331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_organizations, now model.engage_analytics.stg_questionnaire_response)
[0m23:49:48.019509 [debug] [Thread-4 (]: Began running node model.engage_analytics.stg_task
[0m23:49:48.019742 [debug] [Thread-3 (]: Began running node model.engage_analytics.unnested_careteams
[0m23:49:48.019908 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.stg_questionnaire_response
[0m23:49:48.020068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:48.020254 [info ] [Thread-4 (]: 11 of 56 START sql incremental model engage_analytics_engage_analytics_stg.stg_task  [RUN]
[0m23:49:48.020556 [info ] [Thread-3 (]: 12 of 56 START sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [RUN]
[0m23:49:48.022737 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.023015 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:49:48.023298 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_patient, now model.engage_analytics.stg_task)
[0m23:49:48.023512 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner, now model.engage_analytics.unnested_careteams)
[0m23:49:48.023739 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles__dbt_tmp234948003049'
        
      order by ordinal_position

  
[0m23:49:48.023926 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.stg_task
[0m23:49:48.024106 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.unnested_careteams
[0m23:49:48.026701 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.stg_task"
[0m23:49:48.026943 [debug] [Thread-2 (]: Began executing node model.engage_analytics.stg_questionnaire_response
[0m23:49:48.029316 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.unnested_careteams"
[0m23:49:48.029549 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:49:48.031583 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.033522 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:49:48.033792 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

    
  
    

  create temporary table "stg_questionnaire_response__dbt_tmp234948030824"
  
  
    as
  
  (
    

with src as (
  select
    id,
    resource,
    lower(resource::jsonb ->> 'status') as status,
    resource::jsonb ->> 'questionnaire' as questionnaire_id,
    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,
    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,
    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,
    resource::jsonb -> 'item' as items,
    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,
    resource::jsonb -> 'meta' as meta,
    _airbyte_extracted_at as _airbyte_emitted_at
  from "airbyte"."airbyte"."questionnaire_response"
  where lower(resource::jsonb ->> 'status') = 'completed'
)
select * from src

  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response")

  );
  
  
[0m23:49:48.034050 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:48.034264 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:48.034439 [debug] [Thread-4 (]: Began executing node model.engage_analytics.stg_task
[0m23:49:48.034621 [debug] [Thread-3 (]: Began executing node model.engage_analytics.unnested_careteams
[0m23:49:48.036437 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:49:48.036669 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:48.045977 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.unnested_careteams"
[0m23:49:48.046278 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

    
  
    

  create temporary table "stg_task__dbt_tmp234948035772"
  
  
    as
  
  (
    




select
    resource::jsonb ->> 'id' as id,
    resource::jsonb ->> 'meta' as meta,
    resource::jsonb ->> 'authoredOn' as authoredOn,
    resource::jsonb ->> 'basedOn' as basedOn,
    resource::jsonb ->> 'statusReason' as statusReason,
    resource::jsonb ->> 'reasonReference' as reasonReference,
    resource::jsonb ->> 'executionPeriod' as executionPeriod,
    resource::jsonb ->> 'for' as for,
    resource::jsonb ->> 'code' as code,
    resource::jsonb ->> 'owner' as owner,
    resource::jsonb ->> 'description' as description,
    resource::jsonb ->> 'resourceType' as resourceType,
    resource::jsonb ->> 'intent' as intent,
    resource::jsonb ->> 'priority' as priority,
    resource::jsonb ->> 'lastModified' as lastModified,
    resource::jsonb ->> 'requester' as requester,
    resource::jsonb ->> 'status' as status,
    resource::jsonb ->> 'reasonCode' as reasonCode,
_airbyte_extracted_at as _airbyte_emitted_at
from "airbyte"."airbyte"."task"


  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task")

  );
  
  
[0m23:49:48.048033 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:49:48.048413 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:48.048710 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_practitioner_roles'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:48.049125 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:49:48.049298 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: BEGIN
[0m23:49:48.049444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:48.049673 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m23:49:48.051163 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.051430 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:49:48.051677 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: BEGIN
[0m23:49:48.052793 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.stg_practitioner_roles"
[0m23:49:48.053299 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:49:48.053503 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:48.053704 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_practitioner_roles"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_practitioner_roles__dbt_tmp234948003049" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" ("id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at")
    (
        select "id", "meta", "active", "resourcetype", "organization", "practitioner", "code", "_airbyte_emitted_at"
        from "stg_practitioner_roles__dbt_tmp234948003049"
    )
  
[0m23:49:48.053927 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.054115 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response__dbt_tmp234948030824'
        
      order by ordinal_position

  
[0m23:49:48.054740 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:48.055363 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m23:49:48.055539 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.stg_practitioner_roles"
[0m23:49:48.055684 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: COMMIT
[0m23:49:48.056407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.056772 [debug] [Thread-1 (]: On model.engage_analytics.stg_practitioner_roles: Close
[0m23:49:48.056948 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:49:48.057152 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:49:48.057424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d31a0>]}
[0m23:49:48.057609 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp"
    
    
  as (
    with unnested_careteams as (
  select
    id,
    status,
    jsonb_array_elements(participant::jsonb) as participant,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_careteams"
)
select
  id,
  status,
  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,
  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,
  _airbyte_emitted_at
from unnested_careteams
  );
[0m23:49:48.057924 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.004 seconds
[0m23:49:48.058281 [info ] [Thread-1 (]: 9 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_practitioner_roles  [[32mINSERT 0 0[0m in 0.06s]
[0m23:49:48.060177 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.060472 [debug] [Thread-1 (]: Finished running node model.engage_analytics.stg_practitioner_roles
[0m23:49:48.060692 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:48.060950 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:48.061196 [debug] [Thread-1 (]: Began running node model.engage_analytics.encounters
[0m23:49:48.065657 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:49:48.066024 [info ] [Thread-1 (]: 13 of 56 START sql incremental model engage_analytics_engage_analytics_mart.encounters  [RUN]
[0m23:49:48.066240 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams" rename to "unnested_careteams__dbt_backup"
[0m23:49:48.066453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_practitioner_roles, now model.engage_analytics.encounters)
[0m23:49:48.066709 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.encounters
[0m23:49:48.073745 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.008 seconds
[0m23:49:48.074004 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:49:48.075647 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.078951 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.080459 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:49:48.080801 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_questionnaire_response'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:48.081074 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(class::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(class::jsonb) = 'object'
  
[0m23:49:48.081273 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_tmp" rename to "unnested_careteams"
[0m23:49:48.081588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:48.082597 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:48.084540 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m23:49:48.084822 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.003 seconds
[0m23:49:48.085056 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:49:48.086112 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.086316 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: COMMIT
[0m23:49:48.086773 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.086964 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_questionnaire_response"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_questionnaire_response__dbt_tmp234948030824" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response" ("id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at")
    (
        select "id", "resource", "status", "questionnaire_id", "subject_patient_id", "encounter_id", "author_practitioner_id", "items", "meta_lastupdated", "meta", "_airbyte_emitted_at"
        from "stg_questionnaire_response__dbt_tmp234948030824"
    )
  
[0m23:49:48.087725 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.091344 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup"
[0m23:49:48.093593 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.unnested_careteams"
[0m23:49:48.093852 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m23:49:48.094101 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.unnested_careteams"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."unnested_careteams__dbt_backup" cascade
[0m23:49:48.094917 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m23:49:48.095192 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.stg_questionnaire_response"
[0m23:49:48.095359 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: COMMIT
[0m23:49:48.096184 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.096433 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.015 seconds
[0m23:49:48.096903 [debug] [Thread-2 (]: On model.engage_analytics.stg_questionnaire_response: Close
[0m23:49:48.097104 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:48.097918 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.098614 [debug] [Thread-3 (]: On model.engage_analytics.unnested_careteams: Close
[0m23:49:48.098899 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f66c0>]}
[0m23:49:48.099121 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(priority::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(priority::jsonb) = 'object'
  
[0m23:49:48.099439 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106290800>]}
[0m23:49:48.099823 [info ] [Thread-2 (]: 10 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_questionnaire_response  [[32mINSERT 0 0[0m in 0.08s]
[0m23:49:48.100195 [info ] [Thread-3 (]: 12 of 56 OK created sql view model engage_analytics_engage_analytics_mart.unnested_careteams  [[32mCREATE VIEW[0m in 0.08s]
[0m23:49:48.100493 [debug] [Thread-2 (]: Finished running node model.engage_analytics.stg_questionnaire_response
[0m23:49:48.100735 [debug] [Thread-3 (]: Finished running node model.engage_analytics.unnested_careteams
[0m23:49:48.100987 [debug] [Thread-2 (]: Began running node model.engage_analytics.organization_affiliations
[0m23:49:48.101266 [debug] [Thread-3 (]: Began running node model.engage_analytics.organizations
[0m23:49:48.101583 [info ] [Thread-2 (]: 14 of 56 START sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [RUN]
[0m23:49:48.101883 [info ] [Thread-3 (]: 15 of 56 START sql incremental model engage_analytics_engage_analytics_mart.organizations  [RUN]
[0m23:49:48.102126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_questionnaire_response, now model.engage_analytics.organization_affiliations)
[0m23:49:48.102329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.unnested_careteams, now model.engage_analytics.organizations)
[0m23:49:48.102514 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.organization_affiliations
[0m23:49:48.102727 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.organizations
[0m23:49:48.102933 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m23:49:48.105378 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.organization_affiliations"
[0m23:49:48.107419 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:49:48.108390 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.108669 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(type::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
        where jsonb_typeof(type::jsonb) = 'object'
  
[0m23:49:48.108873 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(period::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(period::jsonb) = 'object'
  
[0m23:49:48.109082 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:48.109510 [debug] [Thread-2 (]: Began executing node model.engage_analytics.organization_affiliations
[0m23:49:48.111659 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:49:48.112925 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m23:49:48.113203 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

    
  
    

  create temporary table "organization_affiliations__dbt_tmp234948110763"
  
  
    as
  
  (
    

select
  s.id,
  
  split_part(s.organization::jsonb->>'reference', '/', 2)
                 as organization_id,
  
  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)
       as location_id,   -- first array entry
  s._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organization_affiliations" s

where s._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations"
)

  );
  
  
[0m23:49:48.114137 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.114368 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:48.114642 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(serviceprovider::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
        where jsonb_typeof(serviceprovider::jsonb) = 'object'
  
[0m23:49:48.116905 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:49:48.118558 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.encounters"
[0m23:49:48.118770 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.070 seconds
[0m23:49:48.118954 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:49:48.120518 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:49:48.121531 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.organizations"
[0m23:49:48.121818 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: BEGIN
[0m23:49:48.122142 [debug] [Thread-1 (]: Began executing node model.engage_analytics.encounters
[0m23:49:48.124309 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.124521 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:49:48.124723 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.010 seconds
[0m23:49:48.125232 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

    
  
    

  create temporary table "encounters__dbt_tmp234948123454"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."encounters")

group by resource_id, _airbyte_emitted_at
),
codes as (
  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)
  select
    id::text as resource_id,
        class::jsonb ->> 'code' as class_code,
        class::jsonb ->> 'system' as class_system,
        priority::jsonb ->> 'coding' as priority_coding,
        priority::jsonb ->> 'text' as priority_text,
        period::jsonb ->> 'start' as period_start,
        period::jsonb ->> 'end' as period_end,
        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
)

select
  e.id,
  e.status,
  -- reasonCode is typically an array; grab the first element’s 'text' safely
  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,
  
  split_part(e.subject::jsonb->>'reference', '/', 1)
 as subject_type,
  
  split_part(e.subject::jsonb->>'reference', '/', 2)
   as subject_id,
  date_trunc('month', (c.period_start)::date) as month,
  -- serviceType coding (jsonb)
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,
  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,

  -- provider / class / priority decoded in 'codes' CTE
  c.serviceprovider_reference,
  c.class_code,
  c.priority_text,
  c.period_start,
  c.period_end,

  -- tags (meta->tag)
  t.practitioner_location_id as location_id,
  t.practitioner_organization_id,
  t.practitioner_careteam_id,
  t.practitioner_id,

  -- keep the raw participant json for downstream use (it’s an array)
  e.participant,
  e._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter" e
left join tags  t on t.resource_id = e.id
left join codes c on c.resource_id = e.id

where e._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."encounters"
)

  );
  
  
[0m23:49:48.125576 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:49:48.125763 [debug] [Thread-3 (]: Began executing node model.engage_analytics.organizations
[0m23:49:48.127273 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:49:48.127536 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_task__dbt_tmp234948035772'
        
      order by ordinal_position

  
[0m23:49:48.129605 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:49:48.129817 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: BEGIN
[0m23:49:48.130068 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

    
  
    

  create temporary table "organizations__dbt_tmp234948128733"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        type::jsonb ->> 'coding' as type_coding,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations"
)

select
  o.id,
  o.name,
  o.active,
  c.*
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_organizations" as o
left join codes c on c.resource_id = o.id 

where o._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."organizations"
)

  );
  
  
[0m23:49:48.130688 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:49:48.130928 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:48.132512 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.132726 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.002 seconds
[0m23:49:48.132905 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:49:48.133095 [debug] [Thread-1 (]: On model.engage_analytics.encounters: BEGIN
[0m23:49:48.134514 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:49:48.134729 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.005 seconds
[0m23:49:48.134928 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations__dbt_tmp234948110763'
        
      order by ordinal_position

  
[0m23:49:48.135169 [debug] [Thread-3 (]: On model.engage_analytics.organizations: BEGIN
[0m23:49:48.136681 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:49:48.136862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:49:48.137067 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:48.137306 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.137487 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:48.137722 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'encounters__dbt_tmp234948123454'
        
      order by ordinal_position

  
[0m23:49:48.137915 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:49:48.138104 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'organizations__dbt_tmp234948128733'
        
      order by ordinal_position

  
[0m23:49:48.139506 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.002 seconds
[0m23:49:48.141153 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:49:48.141358 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'stg_task'
        
        and table_schema = 'engage_analytics_engage_analytics_stg'
        
      order by ordinal_position

  
[0m23:49:48.141603 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:49:48.141830 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.004 seconds
[0m23:49:48.142043 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.004 seconds
[0m23:49:48.144399 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:49:48.145923 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.146100 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.004 seconds
[0m23:49:48.147390 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:49:48.147630 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.147867 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.148992 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.stg_task"
[0m23:49:48.149201 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.149946 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:49:48.150165 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.stg_task"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "stg_task__dbt_tmp234948035772" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_stg"."stg_task" ("id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at")
    (
        select "id", "meta", "authoredon", "basedon", "statusreason", "reasonreference", "executionperiod", "for", "code", "owner", "description", "resourcetype", "intent", "priority", "lastmodified", "requester", "status", "reasoncode", "_airbyte_emitted_at"
        from "stg_task__dbt_tmp234948035772"
    )
  
[0m23:49:48.150998 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:48.151652 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: COMMIT
[0m23:49:48.151846 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.stg_task"
[0m23:49:48.151988 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: COMMIT
[0m23:49:48.152171 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.003 seconds
[0m23:49:48.152362 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.003 seconds
[0m23:49:48.152523 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:49:48.154317 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.154527 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:48.156149 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:49:48.157601 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:49:48.157802 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'encounters'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.158222 [debug] [Thread-4 (]: On model.engage_analytics.stg_task: Close
[0m23:49:48.158428 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organization_affiliations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.158643 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'organizations'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.159002 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f4cb0>]}
[0m23:49:48.159390 [info ] [Thread-4 (]: 11 of 56 OK created sql incremental model engage_analytics_engage_analytics_stg.stg_task  [[32mINSERT 0 0[0m in 0.14s]
[0m23:49:48.159655 [debug] [Thread-4 (]: Finished running node model.engage_analytics.stg_task
[0m23:49:48.159834 [debug] [Thread-4 (]: Began running node model.engage_analytics.patient
[0m23:49:48.160057 [info ] [Thread-4 (]: 16 of 56 START sql incremental model engage_analytics_engage_analytics_mart.patient  [RUN]
[0m23:49:48.160278 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.stg_task, now model.engage_analytics.patient)
[0m23:49:48.160459 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.patient
[0m23:49:48.163052 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.patient"
[0m23:49:48.163314 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.004 seconds
[0m23:49:48.163482 [debug] [Thread-1 (]: SQL status: SELECT 19 in 0.005 seconds
[0m23:49:48.164319 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.organization_affiliations"
[0m23:49:48.164507 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.005 seconds
[0m23:49:48.165508 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.encounters"
[0m23:49:48.166454 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.organizations"
[0m23:49:48.166661 [debug] [Thread-4 (]: Began executing node model.engage_analytics.patient
[0m23:49:48.169031 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:49:48.169450 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

    
  
    

  create temporary table "patient__dbt_tmp234948168181"
  
  
    as
  
  (
    

with
tags as (
  with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_encounter"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

group by resource_id, _airbyte_emitted_at
)

select 
    stp.id,
    stp.gender,
    stp.birthDate::date as birth_date,
    stp.deceasedBoolean as deceased,
    stp.active,
    stp.period_start::date as registration_date,
    ut.practitioner_location_id as location_id,
    stp.name_family,
    TRIM(stp.name_given,'[""]') as name_given,
    stp.telecom_value as phone_number,
    ut.practitioner_id,
    ut.practitioner_organization_id,
    ut.practitioner_careteam_id,
    stp._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_patient" stp
left join tags ut on ut.resource_id=stp.id


    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_mart"."patient")

  );
  
  
[0m23:49:48.169805 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:49:48.170007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:48.170201 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.170368 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:49:48.170540 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organization_affiliations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organization_affiliations__dbt_tmp234948110763" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" ("id", "organization_id", "location_id", "_airbyte_emitted_at")
    (
        select "id", "organization_id", "location_id", "_airbyte_emitted_at"
        from "organization_affiliations__dbt_tmp234948110763"
    )
  
[0m23:49:48.170830 [debug] [Thread-1 (]: On model.engage_analytics.encounters: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.encounters"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."encounters" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "encounters__dbt_tmp234948123454" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."encounters" ("id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at")
    (
        select "id", "status", "reasoncode", "subject_type", "subject_id", "month", "service_coding", "service_display", "serviceprovider_reference", "class_code", "priority_text", "period_start", "period_end", "location_id", "practitioner_organization_id", "practitioner_careteam_id", "practitioner_id", "participant", "_airbyte_emitted_at"
        from "encounters__dbt_tmp234948123454"
    )
  
[0m23:49:48.171031 [debug] [Thread-3 (]: On model.engage_analytics.organizations: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.organizations"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."organizations" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "organizations__dbt_tmp234948128733" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."organizations" ("id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at")
    (
        select "id", "name", "active", "resource_id", "type_coding", "_airbyte_emitted_at"
        from "organizations__dbt_tmp234948128733"
    )
  
[0m23:49:48.172349 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:48.172605 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:48.172821 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:49:48.173520 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m23:49:48.174265 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m23:49:48.174811 [debug] [Thread-1 (]: On model.engage_analytics.encounters: COMMIT
[0m23:49:48.175045 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.organization_affiliations"
[0m23:49:48.175247 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.organizations"
[0m23:49:48.175441 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.encounters"
[0m23:49:48.175609 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: COMMIT
[0m23:49:48.175776 [debug] [Thread-3 (]: On model.engage_analytics.organizations: COMMIT
[0m23:49:48.175928 [debug] [Thread-1 (]: On model.engage_analytics.encounters: COMMIT
[0m23:49:48.176659 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.176887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.177066 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.177436 [debug] [Thread-2 (]: On model.engage_analytics.organization_affiliations: Close
[0m23:49:48.177796 [debug] [Thread-1 (]: On model.engage_analytics.encounters: Close
[0m23:49:48.178117 [debug] [Thread-3 (]: On model.engage_analytics.organizations: Close
[0m23:49:48.178420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062282c0>]}
[0m23:49:48.178641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630b680>]}
[0m23:49:48.178931 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cb6b0>]}
[0m23:49:48.179320 [info ] [Thread-1 (]: 13 of 56 OK created sql incremental model engage_analytics_engage_analytics_mart.encounters  [[32mINSERT 0 0[0m in 0.11s]
[0m23:49:48.179729 [info ] [Thread-2 (]: 14 of 56 OK created sql incremental model engage_analytics_engage_analytics_mart.organization_affiliations  [[32mINSERT 0 0[0m in 0.08s]
[0m23:49:48.180275 [debug] [Thread-1 (]: Finished running node model.engage_analytics.encounters
[0m23:49:48.180497 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.010 seconds
[0m23:49:48.180001 [info ] [Thread-3 (]: 15 of 56 OK created sql incremental model engage_analytics_engage_analytics_mart.organizations  [[32mINSERT 0 0[0m in 0.08s]
[0m23:49:48.180865 [debug] [Thread-2 (]: Finished running node model.engage_analytics.organization_affiliations
[0m23:49:48.181091 [debug] [Thread-1 (]: Began running node model.engage_analytics.practitioner_role
[0m23:49:48.183618 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:49:48.183910 [debug] [Thread-3 (]: Finished running node model.engage_analytics.organizations
[0m23:49:48.184113 [debug] [Thread-2 (]: Began running node model.engage_analytics.int_qr_answers_long
[0m23:49:48.184496 [debug] [Thread-4 (]: On model.engage_analytics.patient: BEGIN
[0m23:49:48.184353 [info ] [Thread-1 (]: 17 of 56 START sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [RUN]
[0m23:49:48.184770 [debug] [Thread-3 (]: Began running node model.engage_analytics.int_qr_header
[0m23:49:48.184995 [info ] [Thread-2 (]: 18 of 56 START sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [RUN]
[0m23:49:48.185290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.encounters, now model.engage_analytics.practitioner_role)
[0m23:49:48.185577 [info ] [Thread-3 (]: 19 of 56 START sql view model engage_analytics_engage_analytics_int.int_qr_header  [RUN]
[0m23:49:48.185802 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:48.186002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organization_affiliations, now model.engage_analytics.int_qr_answers_long)
[0m23:49:48.186205 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.practitioner_role
[0m23:49:48.186417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.organizations, now model.engage_analytics.int_qr_header)
[0m23:49:48.186644 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:49:48.186851 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.int_qr_answers_long
[0m23:49:48.189167 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.practitioner_role"
[0m23:49:48.189366 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.int_qr_header
[0m23:49:48.189535 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'patient__dbt_tmp234948168181'
        
      order by ordinal_position

  
[0m23:49:48.191230 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.int_qr_answers_long"
[0m23:49:48.192679 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.int_qr_header"
[0m23:49:48.193105 [debug] [Thread-1 (]: Began executing node model.engage_analytics.practitioner_role
[0m23:49:48.195272 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:49:48.195520 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

    
  
    

  create temporary table "practitioner_role__dbt_tmp234948194339"
  
  
    as
  
  (
    

select
  spr.id,
  spr.active,
  spr.resourceType as resourcetype,
  -- first coding entry
  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,
  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,
  
  split_part(spr.organization::jsonb->>'reference', '/', 2)
  as organization_id,
  
  split_part(spr.practitioner::jsonb->>'reference', '/', 2)
  as practitioner_id,
  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,
  -- include the next line only if you actually want this column:
  -- (spr.meta::jsonb ->> 'source')       as meta_source,
  spr._airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner_roles" spr

where spr._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at), '1900-01-01')
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role"
)

  );
  
  
[0m23:49:48.195764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:48.196082 [debug] [Thread-2 (]: Began executing node model.engage_analytics.int_qr_answers_long
[0m23:49:48.197718 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.int_qr_answers_long"
[0m23:49:48.197953 [debug] [Thread-3 (]: Began executing node model.engage_analytics.int_qr_header
[0m23:49:48.198214 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.005 seconds
[0m23:49:48.199905 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.int_qr_header"
[0m23:49:48.201544 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:49:48.201870 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.202192 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:49:48.202426 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: BEGIN
[0m23:49:48.202670 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:49:48.202862 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:48.203029 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: BEGIN
[0m23:49:48.203343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:48.204042 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m23:49:48.206162 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:49:48.206422 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m23:49:48.206689 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'patient'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.208927 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:49:48.209368 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: BEGIN
[0m23:49:48.209855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:48.210099 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:49:48.210313 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:49:48.210495 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:49:48.210683 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:49:48.210847 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:49:48.211046 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role__dbt_tmp234948194339'
        
      order by ordinal_position

  
[0m23:49:48.211248 [debug] [Thread-4 (]: SQL status: SELECT 14 in 0.002 seconds
[0m23:49:48.211477 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp"
    
    
  as (
    

with recursive base as (
  select
    id as qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    items,
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),

recursive_items as (
  select
    b.qr_id,
    b.questionnaire_id,
    b.subject_patient_id,
    b.encounter_id,
    b.author_practitioner_id,
    (i.value)::jsonb as item_json,
    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,
    b._airbyte_emitted_at
  from base b
  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)
  union all
  select
    r.qr_id,
    r.questionnaire_id,
    r.subject_patient_id,
    r.encounter_id,
    r.author_practitioner_id,
    child.value::jsonb as item_json,
    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,
    r._airbyte_emitted_at
  from recursive_items r
  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true
),

answers as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    (linkid_path[array_length(linkid_path,1)]) as linkid,
    a.value::jsonb as ans,
    _airbyte_emitted_at
  from recursive_items
  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)
),

normalized as (
  select
    qr_id,
    questionnaire_id,
    subject_patient_id,
    encounter_id,
    author_practitioner_id,
    linkid,
    ans ->> 'valueString'                         as value_string,
    (ans ->> 'valueInteger')::int                 as value_integer,
    (ans ->> 'valueDecimal')::numeric             as value_decimal,
    ans ->> 'valueDate'                           as value_date,
    ans -> 'valueCoding' ->> 'code'               as value_coding_code,
    ans -> 'valueCoding' ->> 'display'            as value_coding_display,
    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,
    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,
    coalesce(
      ans -> 'valueCoding' ->> 'display',
      ans ->> 'valueString',
      ans ->> 'valueDate',
      ans ->> 'valueInteger',
      ans ->> 'valueDecimal',
      ans -> 'valueQuantity' ->> 'value'
    ) as answer_value_text,
    _airbyte_emitted_at
  from answers
)

select * from normalized
  );
[0m23:49:48.211713 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */

  create view "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp"
    
    
  as (
    

select
  id as qr_id,
  questionnaire_id,
  subject_patient_id,
  encounter_id,
  author_practitioner_id,
  _airbyte_emitted_at
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
  );
[0m23:49:48.212787 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.patient"
[0m23:49:48.213472 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:49:48.213673 [debug] [Thread-4 (]: On model.engage_analytics.patient: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.patient"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."patient" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "patient__dbt_tmp234948168181" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."patient" ("id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at")
    (
        select "id", "gender", "birth_date", "deceased", "active", "registration_date", "location_id", "name_family", "name_given", "phone_number", "practitioner_id", "practitioner_organization_id", "practitioner_careteam_id", "_airbyte_emitted_at"
        from "patient__dbt_tmp234948168181"
    )
  
[0m23:49:48.214011 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:49:48.215618 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:49:48.215820 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:48.215991 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:49:48.216146 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" rename to "int_qr_header__dbt_backup"
[0m23:49:48.216300 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m23:49:48.217800 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:49:48.218395 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m23:49:48.219850 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:49:48.220049 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" rename to "int_qr_answers_long__dbt_backup"
[0m23:49:48.220223 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:48.220387 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.patient"
[0m23:49:48.220550 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.221934 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:49:48.222158 [debug] [Thread-4 (]: On model.engage_analytics.patient: COMMIT
[0m23:49:48.222380 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:48.222608 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_tmp" rename to "int_qr_header"
[0m23:49:48.224169 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:49:48.224403 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m23:49:48.224592 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:48.224814 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
alter table "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_tmp" rename to "int_qr_answers_long"
[0m23:49:48.226484 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:49:48.226873 [debug] [Thread-4 (]: On model.engage_analytics.patient: Close
[0m23:49:48.227039 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:48.227245 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioner_role'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.227940 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m23:49:48.228144 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:48.228396 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b77d0>]}
[0m23:49:48.228604 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:49:48.229248 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m23:49:48.229614 [info ] [Thread-4 (]: 16 of 56 OK created sql incremental model engage_analytics_engage_analytics_mart.patient  [[32mINSERT 0 0[0m in 0.07s]
[0m23:49:48.229876 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: COMMIT
[0m23:49:48.230080 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:49:48.230313 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m23:49:48.230591 [debug] [Thread-4 (]: Finished running node model.engage_analytics.patient
[0m23:49:48.230817 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: COMMIT
[0m23:49:48.231826 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.practitioner_role"
[0m23:49:48.232073 [debug] [Thread-4 (]: Began running node model.engage_analytics.int_qr_tags
[0m23:49:48.232253 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.234228 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup"
[0m23:49:48.234511 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.int_qr_header"
[0m23:49:48.232623 [info ] [Thread-4 (]: 20 of 56 START sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [RUN]
[0m23:49:48.234730 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:48.234889 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_header"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header__dbt_backup" cascade
[0m23:49:48.235085 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.patient, now model.engage_analytics.int_qr_tags)
[0m23:49:48.236249 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup"
[0m23:49:48.236476 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:49:48.236693 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.int_qr_tags
[0m23:49:48.236949 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.int_qr_answers_long"
[0m23:49:48.237141 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioner_role"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioner_role__dbt_tmp234948194339" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" ("id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at")
    (
        select "id", "active", "resourcetype", "coding_code", "coding_display", "organization_id", "practitioner_id", "meta_lastupdated", "_airbyte_emitted_at"
        from "practitioner_role__dbt_tmp234948194339"
    )
  
[0m23:49:48.240066 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.int_qr_tags"
[0m23:49:48.240361 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_answers_long"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long__dbt_backup" cascade
[0m23:49:48.240871 [debug] [Thread-4 (]: Began executing node model.engage_analytics.int_qr_tags
[0m23:49:48.242559 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:49:48.242802 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

    
  
    

  create temporary table "int_qr_tags__dbt_tmp234948241987"
  
  
    as
  
  (
    
with unnested_tags AS (
    select
        id,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,
        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,
        _airbyte_emitted_at
    from "airbyte"."engage_analytics_engage_analytics_stg"."stg_questionnaire_response"
),
tags_renamed as (
    select
      id as resource_id,
      _airbyte_emitted_at,
      meta_tag_code,
      case
        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'
        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'
        when meta_tag_display = 'Practitioner'              then 'practitioner_id'
        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'
        when meta_tag_display = 'Application Version'       then 'application_version'
        else null
      end as display_name
    from unnested_tags
)
select
  resource_id,
  _airbyte_emitted_at,
  
  
    max(
      
      case
      when display_name = 'practitioner_location_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_location_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_organization_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_organization_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'practitioner_careteam_id'
        then meta_tag_code
      else null
      end
    )
    
      
            as "practitioner_careteam_id"
      
    
    ,
  
    max(
      
      case
      when display_name = 'application_version'
        then meta_tag_code
      else null
      end
    )
    
      
            as "application_version"
      
    
    
  

from tags_renamed

  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags")

group by resource_id, _airbyte_emitted_at
  );
  
  
[0m23:49:48.243038 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:49:48.243195 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:48.243795 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m23:49:48.244036 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.practitioner_role"
[0m23:49:48.244189 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: COMMIT
[0m23:49:48.245567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.245974 [debug] [Thread-1 (]: On model.engage_analytics.practitioner_role: Close
[0m23:49:48.246255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106251ee0>]}
[0m23:49:48.246552 [info ] [Thread-1 (]: 17 of 56 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioner_role  [[32mINSERT 0 0[0m in 0.06s]
[0m23:49:48.246927 [debug] [Thread-1 (]: Finished running node model.engage_analytics.practitioner_role
[0m23:49:48.247360 [debug] [Thread-1 (]: Began running node model.engage_analytics.current_practitioner_role
[0m23:49:48.247690 [info ] [Thread-1 (]: 21 of 56 START sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [RUN]
[0m23:49:48.247933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioner_role, now model.engage_analytics.current_practitioner_role)
[0m23:49:48.248109 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.current_practitioner_role
[0m23:49:48.249542 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.current_practitioner_role"
[0m23:49:48.249947 [debug] [Thread-1 (]: Began executing node model.engage_analytics.current_practitioner_role
[0m23:49:48.251591 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.current_practitioner_role"
[0m23:49:48.251990 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:49:48.252152 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: BEGIN
[0m23:49:48.252316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:48.255877 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.013 seconds
[0m23:49:48.257684 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:49:48.257967 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m23:49:48.258224 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: BEGIN
[0m23:49:48.259020 [debug] [Thread-3 (]: On model.engage_analytics.int_qr_header: Close
[0m23:49:48.259229 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.019 seconds
[0m23:49:48.259605 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbd130>]}
[0m23:49:48.260337 [debug] [Thread-2 (]: On model.engage_analytics.int_qr_answers_long: Close
[0m23:49:48.260530 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:48.260698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:49:48.261016 [info ] [Thread-3 (]: 19 of 56 OK created sql view model engage_analytics_engage_analytics_int.int_qr_header  [[32mCREATE VIEW[0m in 0.07s]
[0m23:49:48.261312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab3530>]}
[0m23:49:48.261485 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:49:48.261667 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:49:48.261911 [debug] [Thread-3 (]: Finished running node model.engage_analytics.int_qr_header
[0m23:49:48.262344 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags__dbt_tmp234948241987'
        
      order by ordinal_position

  
[0m23:49:48.262189 [info ] [Thread-2 (]: 18 of 56 OK created sql view model engage_analytics_engage_analytics_int.int_qr_answers_long  [[32mCREATE VIEW[0m in 0.08s]
[0m23:49:48.262731 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp"
    
    
  as (
    with ranked as (
  select
    pr.*,
    row_number() over (
      partition by practitioner_id
      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc
    ) as rn
  from "airbyte"."engage_analytics_engage_analytics_mart"."practitioner_role" pr
  where coalesce(pr.active::text,'true') ilike 'true'
)
select * from ranked where rn = 1
  );
[0m23:49:48.263256 [debug] [Thread-2 (]: Finished running node model.engage_analytics.int_qr_answers_long
[0m23:49:48.265050 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:48.266828 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:49:48.267006 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" rename to "current_practitioner_role__dbt_backup"
[0m23:49:48.267192 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.004 seconds
[0m23:49:48.268857 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:49:48.269104 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m23:49:48.269288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:48.270651 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:49:48.270836 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_tmp" rename to "current_practitioner_role"
[0m23:49:48.271354 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.002 seconds
[0m23:49:48.271598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:48.273411 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:49:48.274158 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m23:49:48.274368 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'int_qr_tags'
        
        and table_schema = 'engage_analytics_engage_analytics_int'
        
      order by ordinal_position

  
[0m23:49:48.274550 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:49:48.274786 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: COMMIT
[0m23:49:48.275752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.276809 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup"
[0m23:49:48.277050 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.current_practitioner_role"
[0m23:49:48.277209 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.current_practitioner_role"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role__dbt_backup" cascade
[0m23:49:48.277423 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.003 seconds
[0m23:49:48.279595 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.int_qr_tags"
[0m23:49:48.279818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:48.280701 [debug] [Thread-1 (]: On model.engage_analytics.current_practitioner_role: Close
[0m23:49:48.281038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da4470>]}
[0m23:49:48.281379 [info ] [Thread-1 (]: 21 of 56 OK created sql view model engage_analytics_engage_analytics_mart.current_practitioner_role  [[32mCREATE VIEW[0m in 0.03s]
[0m23:49:48.281690 [debug] [Thread-1 (]: Finished running node model.engage_analytics.current_practitioner_role
[0m23:49:48.281890 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:49:48.282199 [debug] [Thread-3 (]: Began running node model.engage_analytics.practitioners
[0m23:49:48.282388 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.int_qr_tags"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" as DBT_INTERNAL_DEST
        where (resource_id) in (
            select distinct resource_id
            from "int_qr_tags__dbt_tmp234948241987" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags" ("resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version")
    (
        select "resource_id", "_airbyte_emitted_at", "practitioner_location_id", "practitioner_organization_id", "practitioner_id", "practitioner_careteam_id", "application_version"
        from "int_qr_tags__dbt_tmp234948241987"
    )
  
[0m23:49:48.282648 [info ] [Thread-3 (]: 22 of 56 START sql incremental model engage_analytics_engage_analytics_mart.practitioners  [RUN]
[0m23:49:48.282882 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_header, now model.engage_analytics.practitioners)
[0m23:49:48.283043 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.practitioners
[0m23:49:48.317887 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.035 seconds
[0m23:49:48.319792 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.320533 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m23:49:48.320758 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(name::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(name::jsonb) = 'object'
  
[0m23:49:48.320928 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.int_qr_tags"
[0m23:49:48.321088 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:48.321288 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: COMMIT
[0m23:49:48.322455 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.322837 [debug] [Thread-4 (]: On model.engage_analytics.int_qr_tags: Close
[0m23:49:48.323117 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e1220>]}
[0m23:49:48.323401 [info ] [Thread-4 (]: 20 of 56 OK created sql incremental model engage_analytics_engage_analytics_int.int_qr_tags  [[32mINSERT 0 0[0m in 0.09s]
[0m23:49:48.323663 [debug] [Thread-4 (]: Finished running node model.engage_analytics.int_qr_tags
[0m23:49:48.324166 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_104394
[0m23:49:48.324361 [info ] [Thread-1 (]: 23 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_104394 . [RUN]
[0m23:49:48.324551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.current_practitioner_role, now model.engage_analytics.qr_104394)
[0m23:49:48.324703 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_104394
[0m23:49:48.324920 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_104453
[0m23:49:48.330408 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:49:48.330645 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_104454
[0m23:49:48.330942 [info ] [Thread-2 (]: 24 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_104453 . [RUN]
[0m23:49:48.331279 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

    
    with ids(ident) as ( values('Questionnaire/104394') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:48.331621 [info ] [Thread-4 (]: 25 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_104454 . [RUN]
[0m23:49:48.331917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_answers_long, now model.engage_analytics.qr_104453)
[0m23:49:48.332130 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.011 seconds
[0m23:49:48.332305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:48.332495 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.int_qr_tags, now model.engage_analytics.qr_104454)
[0m23:49:48.332696 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_104453
[0m23:49:48.333462 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.333727 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_104454
[0m23:49:48.335960 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:49:48.336315 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    /* only inspect rows where the column is a JSON OBJECT */
        select distinct jsonb_object_keys(telecom::jsonb)
        from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
        where jsonb_typeof(telecom::jsonb) = 'object'
  
[0m23:49:48.338632 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:49:48.338847 [debug] [Thread-2 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

    
    with ids(ident) as ( values('Questionnaire/104453') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:48.339183 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

    
    with ids(ident) as ( values('Questionnaire/104454') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:48.339574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:48.339873 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.001 seconds
[0m23:49:48.340076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:48.341273 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.practitioners"
[0m23:49:48.342175 [debug] [Thread-3 (]: Began executing node model.engage_analytics.practitioners
[0m23:49:48.344172 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.344488 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

    
  
    

  create temporary table "practitioners__dbt_tmp234948343434"
  
  
    as
  
  (
    

with
codes as (
  select
    id::text as resource_id,
        name::jsonb ->> 'family' as name_family,
        name::jsonb ->> 'use' as name_use,
        name::jsonb ->> 'given' as name_given,
        telecom::jsonb ->> 'value' as telecom_value,
        telecom::jsonb ->> 'system' as telecom_system,
    /* use the column your staging models actually expose */
    _airbyte_emitted_at
  from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner"
)

select
  p.id,
  p.active,
  oa.organization_id,
  oa.location_id,
  pc.name_family,
  trim(pc.name_given, '[""]') as name_given,
  pc.telecom_value as phone_number,
  greatest(
    p._airbyte_emitted_at,
    coalesce(oa._airbyte_emitted_at, '1900-01-01'),
    coalesce(pr._airbyte_emitted_at, '1900-01-01')
  ) as _airbyte_emitted_at,
  pr.coding_code    as role_id,
  pr.coding_display as role
from "airbyte"."engage_analytics_engage_analytics_stg"."stg_practitioner" p
left join "airbyte"."engage_analytics_engage_analytics_mart"."current_practitioner_role" pr
  on pr.practitioner_id = p.id
left join "airbyte"."engage_analytics_engage_analytics_mart"."organization_affiliations" oa
  on pr.organization_id = oa.organization_id
left join codes as pc
  on pc.resource_id = p.id

where p._airbyte_emitted_at > (
  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners"
)

  );
  
  
[0m23:49:48.347296 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.003 seconds
[0m23:49:48.349075 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.349411 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: BEGIN
[0m23:49:48.350176 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:48.350444 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.350636 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'practitioners__dbt_tmp234948343434'
        
      order by ordinal_position

  
[0m23:49:48.355896 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.005 seconds
[0m23:49:48.357706 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.357906 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.361369 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.003 seconds
[0m23:49:48.363242 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.363450 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbyte".INFORMATION_SCHEMA.columns
      where table_name = 'practitioners'
        
        and table_schema = 'engage_analytics_engage_analytics_mart'
        
      order by ordinal_position

  
[0m23:49:48.365413 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.002 seconds
[0m23:49:48.366457 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.practitioners"
[0m23:49:48.366922 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.367117 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.practitioners"} */

      
        
        
        delete from "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "practitioners__dbt_tmp234948343434" as DBT_INTERNAL_SOURCE
        );

    

    insert into "airbyte"."engage_analytics_engage_analytics_mart"."practitioners" ("id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role")
    (
        select "id", "active", "organization_id", "location_id", "name_family", "name_given", "phone_number", "_airbyte_emitted_at", "role_id", "role"
        from "practitioners__dbt_tmp234948343434"
    )
  
[0m23:49:48.368038 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:49:48.369570 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: COMMIT
[0m23:49:48.369769 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.practitioners"
[0m23:49:48.369927 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: COMMIT
[0m23:49:48.370913 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:48.371383 [debug] [Thread-3 (]: On model.engage_analytics.practitioners: Close
[0m23:49:48.371808 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c5d30>]}
[0m23:49:48.372188 [info ] [Thread-3 (]: 22 of 56 OK created sql incremental model engage_analytics_engage_analytics_mart.practitioners  [[32mINSERT 0 0[0m in 0.09s]
[0m23:49:48.372480 [debug] [Thread-3 (]: Finished running node model.engage_analytics.practitioners
[0m23:49:48.372680 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_104455
[0m23:49:48.372990 [info ] [Thread-3 (]: 26 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_104455 . [RUN]
[0m23:49:48.373298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.practitioners, now model.engage_analytics.qr_104455)
[0m23:49:48.373489 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_104455
[0m23:49:48.375878 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:49:48.376105 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

    
    with ids(ident) as ( values('Questionnaire/104455') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:48.376279 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:48.992763 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.652 seconds
[0m23:49:48.995608 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_104454"
[0m23:49:48.996564 [debug] [Thread-1 (]: SQL status: SELECT 231 in 0.664 seconds
[0m23:49:49.004051 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.664 seconds
[0m23:49:49.005494 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_104394"
[0m23:49:49.006854 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_104453"
[0m23:49:49.007129 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_104454
[0m23:49:49.010878 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_104454"
[0m23:49:49.011307 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_104453
[0m23:49:49.013246 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_104453"
[0m23:49:49.013596 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:49:49.013798 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_104394
[0m23:49:49.013973 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: BEGIN
[0m23:49:49.015704 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_104394"
[0m23:49:49.015965 [debug] [Thread-3 (]: SQL status: SELECT 24 in 0.640 seconds
[0m23:49:49.016237 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:49:49.017873 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_104455"
[0m23:49:49.018120 [debug] [Thread-2 (]: On model.engage_analytics.qr_104453: BEGIN
[0m23:49:49.018351 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m23:49:49.018631 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:49:49.018850 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:49:49.019052 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: BEGIN
[0m23:49:49.019288 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:49.019549 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 3 (id: ipc-104454, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104454') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:49.019828 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_104455
[0m23:49:49.020004 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:49:49.020176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:49.021925 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_104455"
[0m23:49:49.022268 [debug] [Thread-2 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 2 (id: ipc-104453, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104453') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896'
        then answer_value_text
      else null
      end
    )
    
      
            as "27b1e829-9ad9-41c2-8cb5-01ce1f469896"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c804862-f4b9-49df-aae4-c7802e723c76"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b'
        then answer_value_text
      else null
      end
    )
    
      
            as "2dd6c90f-ea68-45ba-9d30-58e02ab0812b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253'
        then answer_value_text
      else null
      end
    )
    
      
            as "f4b782e5-18e1-4edf-a3ff-409feb207253"
      
    
    ,
  
    max(
      
      case
      when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f'
        then answer_value_text
      else null
      end
    )
    
      
            as "53b30f12-74eb-474c-941c-5f0e81b7eb9f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '783e2646-c8ea-466d-bba8-85c891a14435'
        then answer_value_text
      else null
      end
    )
    
      
            as "783e2646-c8ea-466d-bba8-85c891a14435"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "ed537539-d317-43fc-a4b3-38de5e15ea4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36'
        then answer_value_text
      else null
      end
    )
    
      
            as "18c6510f-b294-4741-ae43-9cbbc4ba7e36"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50'
        then answer_value_text
      else null
      end
    )
    
      
            as "d02eb882-411e-4bc0-af9d-08a77fcc3f50"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:49.022586 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:49.022761 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:49:49.024413 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:49:49.025985 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 4 (id: ipc-104394, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104394') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1d9c871-c1f8-41cc-8c54-edd4e5b162fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa'
        then answer_value_text
      else null
      end
    )
    
      
            as "f952feaf-7abc-4f6f-a3bc-d10a43ea62fa"
      
    
    ,
  
    max(
      
      case
      when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "3785a264-8bd5-44ab-bf08-8aa33735c0eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0'
        then answer_value_text
      else null
      end
    )
    
      
            as "e510a8cf-0bc7-4577-b9ee-ca758d431aa0"
      
    
    ,
  
    max(
      
      case
      when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9d203bac-75fd-4f31-bed6-073502a977f3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd7644ee-28f1-4f43-a654-17fd5034d1f6"
      
    
    ,
  
    max(
      
      case
      when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "14ec8995-eee9-416f-83ad-9f44631ac9b0"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ca03155-c9ec-45e1-8cd0-5b86fa444ad0"
      
    
    ,
  
    max(
      
      case
      when linkid = '54b75d55-1c43-4552-acbf-d9754831add8'
        then answer_value_text
      else null
      end
    )
    
      
            as "54b75d55-1c43-4552-acbf-d9754831add8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46'
        then answer_value_text
      else null
      end
    )
    
      
            as "c396a3af-6f0d-4a8e-a42b-4f47bbce5f46"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e388595-a32f-4623-8c9f-3c67bad04070"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "cf896559-dff5-4704-94a0-6a6aedee53c5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7496859-63bb-4b2f-8f75-96e44e893bf7"
      
    
    ,
  
    max(
      
      case
      when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05'
        then answer_value_text
      else null
      end
    )
    
      
            as "65252389-fa9e-4ef4-93ca-e952c77c4c05"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf"
      
    
    ,
  
    max(
      
      case
      when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "3314932c-64e4-4192-b583-eb31e87da1d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99'
        then answer_value_text
      else null
      end
    )
    
      
            as "e7ba8485-5154-41b8-ac18-35410a83cd99"
      
    
    ,
  
    max(
      
      case
      when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564'
        then answer_value_text
      else null
      end
    )
    
      
            as "18d8ee56-ffd8-4711-9074-126ef2cdc564"
      
    
    ,
  
    max(
      
      case
      when linkid = '74d0f0df-e726-4c40-84ce-efece882818b'
        then answer_value_text
      else null
      end
    )
    
      
            as "74d0f0df-e726-4c40-84ce-efece882818b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131'
        then answer_value_text
      else null
      end
    )
    
      
            as "9e11ce97-90e8-42f2-ba18-8c4f0720c131"
      
    
    ,
  
    max(
      
      case
      when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2'
        then answer_value_text
      else null
      end
    )
    
      
            as "40d6a87f-9498-4cfd-b233-4610e6de08c2"
      
    
    ,
  
    max(
      
      case
      when linkid = '57e87170-761c-4b57-a09c-d50cab02860c'
        then answer_value_text
      else null
      end
    )
    
      
            as "57e87170-761c-4b57-a09c-d50cab02860c"
      
    
    ,
  
    max(
      
      case
      when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264'
        then answer_value_text
      else null
      end
    )
    
      
            as "5056d0ba-67ac-4eab-b05d-d42941f7b264"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b2e05e9-0c11-490c-bbff-278ba90d7b4e"
      
    
    ,
  
    max(
      
      case
      when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3'
        then answer_value_text
      else null
      end
    )
    
      
            as "249f5ce8-ecc0-4e43-9675-6b01ca1502a3"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f46e0ff-0532-4105-be36-0cfa9d0770f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49'
        then answer_value_text
      else null
      end
    )
    
      
            as "0397084a-cd51-4b3a-809d-970a2406ea49"
      
    
    ,
  
    max(
      
      case
      when linkid = '808ba31c-cd29-4743-8801-dfce357d5956'
        then answer_value_text
      else null
      end
    )
    
      
            as "808ba31c-cd29-4743-8801-dfce357d5956"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d82c6ae9-0516-4513-91fa-664686779d6a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc981d8a-7f22-450b-abab-3acca810ccad"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba'
        then answer_value_text
      else null
      end
    )
    
      
            as "d0aa3679-e465-4225-85d6-5822efb10eba"
      
    
    ,
  
    max(
      
      case
      when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "86da79f0-44cb-417d-ab20-c7ecc6f8f7c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36'
        then answer_value_text
      else null
      end
    )
    
      
            as "24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36"
      
    
    ,
  
    max(
      
      case
      when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149'
        then answer_value_text
      else null
      end
    )
    
      
            as "46c2861b-70a9-4fdf-94ea-e1a01cae3149"
      
    
    ,
  
    max(
      
      case
      when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed'
        then answer_value_text
      else null
      end
    )
    
      
            as "41cce38a-ca5c-4e24-904a-25b1027336ed"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2572206-b47c-4d1e-85cb-812d13a60a85"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd62b649-7209-4d32-9bbb-dc2b2823aadb"
      
    
    ,
  
    max(
      
      case
      when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47'
        then answer_value_text
      else null
      end
    )
    
      
            as "53def3a1-a7e5-4326-95f2-2561c26ecb47"
      
    
    ,
  
    max(
      
      case
      when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6'
        then answer_value_text
      else null
      end
    )
    
      
            as "33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496'
        then answer_value_text
      else null
      end
    )
    
      
            as "b6f126dd-eac5-42e4-8896-e7400b0c0496"
      
    
    ,
  
    max(
      
      case
      when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd'
        then answer_value_text
      else null
      end
    )
    
      
            as "509b140e-b195-4696-bc5f-f2fc2d2f77dd"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae4fa455-f173-435a-bb1b-4df1d1316bd9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6262800-1e24-4348-9bf2-9bb070d2f20a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae949697-92ae-476a-96cc-f8b0adc4221f"
      
    
    ,
  
    max(
      
      case
      when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031'
        then answer_value_text
      else null
      end
    )
    
      
            as "92ab6e65-f9bd-4718-8af6-f731425d3031"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec54e447-c981-4dd2-aaa4-659f8e494248"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a1c4c0d-158f-494c-a33f-1f7f8e41f21f"
      
    
    ,
  
    max(
      
      case
      when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596'
        then answer_value_text
      else null
      end
    )
    
      
            as "656a57f8-f6f0-4fc5-b347-71dd8d38f596"
      
    
    ,
  
    max(
      
      case
      when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "245e5273-e28b-41d2-a152-1f70d85576c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41'
        then answer_value_text
      else null
      end
    )
    
      
            as "2728e75c-a0e9-4cd9-8d35-962e4f71bf41"
      
    
    ,
  
    max(
      
      case
      when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99'
        then answer_value_text
      else null
      end
    )
    
      
            as "22c11dbc-73e0-4470-9ef6-d9bd01f48c99"
      
    
    ,
  
    max(
      
      case
      when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17'
        then answer_value_text
      else null
      end
    )
    
      
            as "84018cd8-9134-429c-8dfe-fd6a16e4bd17"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21'
        then answer_value_text
      else null
      end
    )
    
      
            as "f895ed4f-5004-4da4-9d59-c21293674b21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c5720a67-803f-4917-8261-3738de838418'
        then answer_value_text
      else null
      end
    )
    
      
            as "c5720a67-803f-4917-8261-3738de838418"
      
    
    ,
  
    max(
      
      case
      when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db'
        then answer_value_text
      else null
      end
    )
    
      
            as "7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db"
      
    
    ,
  
    max(
      
      case
      when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12'
        then answer_value_text
      else null
      end
    )
    
      
            as "be88b027-64b6-4c3c-bf59-36a94dc79b12"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "a0017b28-0aa9-4926-a7be-813f0a5e6bd0"
      
    
    ,
  
    max(
      
      case
      when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12'
        then answer_value_text
      else null
      end
    )
    
      
            as "01353b1d-f816-41c1-b330-910e9a76ed12"
      
    
    ,
  
    max(
      
      case
      when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13'
        then answer_value_text
      else null
      end
    )
    
      
            as "658e8c22-d6ba-480a-81e0-dc4b6164de13"
      
    
    ,
  
    max(
      
      case
      when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240'
        then answer_value_text
      else null
      end
    )
    
      
            as "796f5440-54f8-4d69-b961-a5b7e6a63240"
      
    
    ,
  
    max(
      
      case
      when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206'
        then answer_value_text
      else null
      end
    )
    
      
            as "5e2ab0f5-f5d9-4502-befe-aba770f0e206"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-4-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-4-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966'
        then answer_value_text
      else null
      end
    )
    
      
            as "c802f463-c8f5-4056-bc45-8ab8d64a1966"
      
    
    ,
  
    max(
      
      case
      when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "706fc36f-efef-4bf9-827e-7dc100cc92bc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c631e361-027c-4e4d-b894-48785a3e6dd0"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ac23c5d-0035-4895-85f2-33c2fbba8f3f"
      
    
    ,
  
    max(
      
      case
      when linkid = '45772f3f-c610-408b-942b-359769945cf4'
        then answer_value_text
      else null
      end
    )
    
      
            as "45772f3f-c610-408b-942b-359769945cf4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "dae7f411-758d-4800-9842-fc0038a6b4a4"
      
    
    ,
  
    max(
      
      case
      when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807'
        then answer_value_text
      else null
      end
    )
    
      
            as "fc5c673b-41d4-4352-86bb-043c73ed9807"
      
    
    ,
  
    max(
      
      case
      when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "229e58ac-a18a-48dd-be10-f8b024a74eb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8726638-cfdb-40ae-b72c-f1d594f64de5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b'
        then answer_value_text
      else null
      end
    )
    
      
            as "b676a0c2-cda0-4762-be79-2a94205ee68b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe2f0911-8ddc-412b-a3e6-f216620d147e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5ab53d4-824c-460f-8939-b86ff3cd97a3"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b51625b-73b9-472d-9c71-299beb26694f'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b51625b-73b9-472d-9c71-299beb26694f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec2a78e1-e70b-4f66-86b1-561cffaf9ffd"
      
    
    ,
  
    max(
      
      case
      when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a'
        then answer_value_text
      else null
      end
    )
    
      
            as "44f02467-8ee0-49f0-8da7-5e7ed827125a"
      
    
    ,
  
    max(
      
      case
      when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73'
        then answer_value_text
      else null
      end
    )
    
      
            as "88e9b865-b81a-494b-aef2-39e803b94e73"
      
    
    ,
  
    max(
      
      case
      when linkid = '7845c436-4904-41fa-9553-2c401935623b'
        then answer_value_text
      else null
      end
    )
    
      
            as "7845c436-4904-41fa-9553-2c401935623b"
      
    
    ,
  
    max(
      
      case
      when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c'
        then answer_value_text
      else null
      end
    )
    
      
            as "892337bd-d7fd-46a7-bf72-08e87c9f412c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03'
        then answer_value_text
      else null
      end
    )
    
      
            as "d5194db0-0546-4bd1-96d8-d56457930c03"
      
    
    ,
  
    max(
      
      case
      when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa'
        then answer_value_text
      else null
      end
    )
    
      
            as "40d8ef64-02f0-42ae-9478-77651bd26dfa"
      
    
    ,
  
    max(
      
      case
      when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c'
        then answer_value_text
      else null
      end
    )
    
      
            as "9faa2b78-1842-4326-bf7f-9975bf04dc2c"
      
    
    ,
  
    max(
      
      case
      when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a'
        then answer_value_text
      else null
      end
    )
    
      
            as "370c849b-0e00-42ac-be9d-3b4c719ac31a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-spi"
      
    
    ,
  
    max(
      
      case
      when linkid = 'df53c378-27fe-483d-a630-f7b171f72980'
        then answer_value_text
      else null
      end
    )
    
      
            as "df53c378-27fe-483d-a630-f7b171f72980"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95'
        then answer_value_text
      else null
      end
    )
    
      
            as "d1c2fae1-f0f5-4333-97f6-2220d2ff3d95"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac3206dd-b60b-4cb1-a559-3a770a685668"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491'
        then answer_value_text
      else null
      end
    )
    
      
            as "f39df336-a0b8-4d0b-9bd2-6c4284985491"
      
    
    ,
  
    max(
      
      case
      when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8'
        then answer_value_text
      else null
      end
    )
    
      
            as "faefef23-d2e6-4777-b628-8f83921e8fd8"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c308fef-8ce5-4217-a8d4-8e6ff00c8e14"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a57b5b34-12e5-4ec8-8215-7f316267323a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0'
        then answer_value_text
      else null
      end
    )
    
      
            as "cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0"
      
    
    ,
  
    max(
      
      case
      when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6'
        then answer_value_text
      else null
      end
    )
    
      
            as "2e03fdf1-5274-494d-88e9-dd4b41ec90e6"
      
    
    ,
  
    max(
      
      case
      when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123'
        then answer_value_text
      else null
      end
    )
    
      
            as "62b0eb17-46e5-4c50-a133-087cc190a123"
      
    
    ,
  
    max(
      
      case
      when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d'
        then answer_value_text
      else null
      end
    )
    
      
            as "991ba845-38e5-4622-8528-dfeefbf20d3d"
      
    
    ,
  
    max(
      
      case
      when linkid = '83dfd82f-0277-459d-abe3-e8795750f288'
        then answer_value_text
      else null
      end
    )
    
      
            as "83dfd82f-0277-459d-abe3-e8795750f288"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d'
        then answer_value_text
      else null
      end
    )
    
      
            as "b36fdd5f-ccac-457c-a8ea-f9497204ef1d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7513e58-a495-49d7-a549-ba4d84fb5003"
      
    
    ,
  
    max(
      
      case
      when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888'
        then answer_value_text
      else null
      end
    )
    
      
            as "101d2b7f-2b68-407d-aa49-30cb4dadc888"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af'
        then answer_value_text
      else null
      end
    )
    
      
            as "a5d96f90-cd91-4a5b-8862-c4e3f88694af"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ea8d78b-3288-4ec8-8288-459c03df64f0"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b96f1d9-3450-423d-a277-060fcfdadc6b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369'
        then answer_value_text
      else null
      end
    )
    
      
            as "9aeae470-6ea4-4e7f-9644-ed0375fb6369"
      
    
    ,
  
    max(
      
      case
      when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98'
        then answer_value_text
      else null
      end
    )
    
      
            as "176aeeb0-e173-482a-b3eb-60f59bc04f98"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-6a-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-6a-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-1-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-1-review"
      
    
    ,
  
    max(
      
      case
      when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7'
        then answer_value_text
      else null
      end
    )
    
      
            as "53072f88-a81c-4f18-a49f-f85f64fb5be7"
      
    
    ,
  
    max(
      
      case
      when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021'
        then answer_value_text
      else null
      end
    )
    
      
            as "4d334b16-ea16-4299-94ed-32e84ef97021"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "cf16ca6e-8b1b-467d-b807-fc5d50339f71"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f531e61-26cf-4223-8653-39c24d6dd478"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c'
        then answer_value_text
      else null
      end
    )
    
      
            as "f311f3ca-5537-4134-8828-5e537bb26a9c"
      
    
    ,
  
    max(
      
      case
      when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27'
        then answer_value_text
      else null
      end
    )
    
      
            as "9b1b11e8-608f-4ea9-911b-88aae467ac27"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a25cb682-be35-4909-965e-01b8c2d036a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9'
        then answer_value_text
      else null
      end
    )
    
      
            as "e45b778d-ee8c-4ee9-81f4-8927006160f9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048'
        then answer_value_text
      else null
      end
    )
    
      
            as "cce2de12-cf62-44ff-84e8-9eb4d864d048"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc"
      
    
    ,
  
    max(
      
      case
      when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52'
        then answer_value_text
      else null
      end
    )
    
      
            as "5151ea93-a0f2-478d-adb6-f31374107b52"
      
    
    ,
  
    max(
      
      case
      when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090'
        then answer_value_text
      else null
      end
    )
    
      
            as "72e5c1b7-7ce9-49bd-834b-d98b73ba7090"
      
    
    ,
  
    max(
      
      case
      when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233'
        then answer_value_text
      else null
      end
    )
    
      
            as "5846d53f-171d-47c4-89ad-4016c3be8233"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660'
        then answer_value_text
      else null
      end
    )
    
      
            as "e552afd3-2816-446e-9ff5-e898bc813660"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db'
        then answer_value_text
      else null
      end
    )
    
      
            as "c6c266cc-1c85-41c0-97ce-9ab491be45db"
      
    
    ,
  
    max(
      
      case
      when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331'
        then answer_value_text
      else null
      end
    )
    
      
            as "3ab931b8-6bfd-4e5f-b86b-3c7377907331"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897'
        then answer_value_text
      else null
      end
    )
    
      
            as "fefdc90f-fe1d-4bfb-af93-94df8c482897"
      
    
    ,
  
    max(
      
      case
      when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164'
        then answer_value_text
      else null
      end
    )
    
      
            as "83661ebe-71cf-4eab-88e3-bfecbfe35164"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449'
        then answer_value_text
      else null
      end
    )
    
      
            as "fd1498e5-abf7-4ebe-9252-97994d6b9449"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-6a'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-6a"
      
    
    ,
  
    max(
      
      case
      when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "92da95cc-50dd-4bf0-acca-4465c07d44cc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111'
        then answer_value_text
      else null
      end
    )
    
      
            as "cebffdf4-8fd1-4829-884c-41cc42bc0111"
      
    
    ,
  
    max(
      
      case
      when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5'
        then answer_value_text
      else null
      end
    )
    
      
            as "52ef2ff5-ced6-418a-b9e7-f2ef47123df5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9c42647-eefb-42bd-9080-f83630729606'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9c42647-eefb-42bd-9080-f83630729606"
      
    
    ,
  
    max(
      
      case
      when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a'
        then answer_value_text
      else null
      end
    )
    
      
            as "13e2f934-82ed-4b23-af6e-95523dc3746a"
      
    
    ,
  
    max(
      
      case
      when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8891cd7b-ad1c-4030-afe4-6752cd273cf4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "cece37bc-897b-4b48-a9c9-59ecc9f997f7"
      
    
    ,
  
    max(
      
      case
      when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d'
        then answer_value_text
      else null
      end
    )
    
      
            as "58721b3d-88ae-4888-b5ec-ef7dfe30fb3d"
      
    
    ,
  
    max(
      
      case
      when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "895fad45-c3b5-47c5-9edf-5f9b9e793fbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a33cdecd-b7e6-45d8-94b6-52fa80c64a6d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39'
        then answer_value_text
      else null
      end
    )
    
      
            as "f14c3c34-f80a-4481-9d9c-9b05267d4c39"
      
    
    ,
  
    max(
      
      case
      when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9'
        then answer_value_text
      else null
      end
    )
    
      
            as "82d6b50b-0bb2-40f6-94b1-7a4c58df43f9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268'
        then answer_value_text
      else null
      end
    )
    
      
            as "1a00c7b7-e80d-4e90-8ed4-efd8f6d96268"
      
    
    ,
  
    max(
      
      case
      when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709'
        then answer_value_text
      else null
      end
    )
    
      
            as "07c2e8dc-b48b-4bc7-b21b-c196cce32709"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf'
        then answer_value_text
      else null
      end
    )
    
      
            as "dfa1f239-2a4c-40bd-ab15-561f6d87febf"
      
    
    ,
  
    max(
      
      case
      when linkid = '53932020-eed8-46f4-8236-d548a6335a59'
        then answer_value_text
      else null
      end
    )
    
      
            as "53932020-eed8-46f4-8236-d548a6335a59"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a1155e2-6c49-4f82-a9fc-2807ee298410"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce18eee3-aa64-4423-8db1-50fe7f00850d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b'
        then answer_value_text
      else null
      end
    )
    
      
            as "c37407c5-003a-4b7c-b6a3-e10ef146a47b"
      
    
    ,
  
    max(
      
      case
      when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3'
        then answer_value_text
      else null
      end
    )
    
      
            as "39de8b74-5cbc-4225-b27b-c97e72f08af3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f'
        then answer_value_text
      else null
      end
    )
    
      
            as "bfe595d6-325f-492a-b3b6-cc5541e18c3f"
      
    
    ,
  
    max(
      
      case
      when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc'
        then answer_value_text
      else null
      end
    )
    
      
            as "2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a320b787-4cba-457f-9c60-67ff76c7020f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9e056c2-0469-4523-a28f-1000fed1a4f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e'
        then answer_value_text
      else null
      end
    )
    
      
            as "527c0166-cc35-4cc3-a9d9-7eeb0a54635e"
      
    
    ,
  
    max(
      
      case
      when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7"
      
    
    ,
  
    max(
      
      case
      when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124'
        then answer_value_text
      else null
      end
    )
    
      
            as "5324bdce-baaa-45bf-935a-eb2f65bd7124"
      
    
    ,
  
    max(
      
      case
      when linkid = '544a444d-b101-4d56-9351-00bca8ec749e'
        then answer_value_text
      else null
      end
    )
    
      
            as "544a444d-b101-4d56-9351-00bca8ec749e"
      
    
    ,
  
    max(
      
      case
      when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86'
        then answer_value_text
      else null
      end
    )
    
      
            as "13321778-b5d4-4b01-8eda-610cf0007c86"
      
    
    ,
  
    max(
      
      case
      when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc'
        then answer_value_text
      else null
      end
    )
    
      
            as "90cedcbf-bf11-4dc3-9733-42e6900a09fc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200'
        then answer_value_text
      else null
      end
    )
    
      
            as "c0655b11-8f21-47ed-8ede-95498c2e8200"
      
    
    ,
  
    max(
      
      case
      when linkid = '15e5007d-028f-4644-8fb6-0346730c3101'
        then answer_value_text
      else null
      end
    )
    
      
            as "15e5007d-028f-4644-8fb6-0346730c3101"
      
    
    ,
  
    max(
      
      case
      when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c'
        then answer_value_text
      else null
      end
    )
    
      
            as "8c1ac4fe-1d76-4436-8f34-d315c6c17b9c"
      
    
    ,
  
    max(
      
      case
      when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "87dab385-fe6b-44ce-b6b2-5771c41d82c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "40fbe8d0-4380-4efc-bb04-26fc7d3714eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3b4cf6e-385d-40b7-9380-4de2f81463de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185'
        then answer_value_text
      else null
      end
    )
    
      
            as "a842d271-cd48-47c7-963e-dcd0376ef185"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f3a622a-d39b-49b0-84e7-0bcf4f832a4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "69d5aec4-65d3-44b1-99ba-badd201769c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75'
        then answer_value_text
      else null
      end
    )
    
      
            as "6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0'
        then answer_value_text
      else null
      end
    )
    
      
            as "f8861b1c-781f-4f12-b4c8-f8110f0c2cc0"
      
    
    ,
  
    max(
      
      case
      when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7'
        then answer_value_text
      else null
      end
    )
    
      
            as "53a575e3-aa59-408d-a0dd-8df237b68bf7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531'
        then answer_value_text
      else null
      end
    )
    
      
            as "a3670632-ce8f-468a-b2f3-6934245d3531"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a9424b0-c893-4371-b5c9-bc0008be14b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54'
        then answer_value_text
      else null
      end
    )
    
      
            as "fba783e8-91d0-4a49-ba80-c55fa9e41a54"
      
    
    ,
  
    max(
      
      case
      when linkid = '437d9ea2-adb5-471a-828b-a0285a282217'
        then answer_value_text
      else null
      end
    )
    
      
            as "437d9ea2-adb5-471a-828b-a0285a282217"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14'
        then answer_value_text
      else null
      end
    )
    
      
            as "cecb89ae-abce-411c-b4ce-f84ebf59ca14"
      
    
    ,
  
    max(
      
      case
      when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0'
        then answer_value_text
      else null
      end
    )
    
      
            as "beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea95a315-f903-4351-87ed-c1e7e7b74198"
      
    
    ,
  
    max(
      
      case
      when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd'
        then answer_value_text
      else null
      end
    )
    
      
            as "98407058-4855-44cc-ac45-6e0d0c072fdd"
      
    
    ,
  
    max(
      
      case
      when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609'
        then answer_value_text
      else null
      end
    )
    
      
            as "705df2d9-af92-4f4f-b513-17e01d07b609"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7'
        then answer_value_text
      else null
      end
    )
    
      
            as "ff115c26-95b9-4e0d-87ed-80817d438fc7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604'
        then answer_value_text
      else null
      end
    )
    
      
            as "fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604"
      
    
    ,
  
    max(
      
      case
      when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb'
        then answer_value_text
      else null
      end
    )
    
      
            as "28b2e31a-ee4d-4e99-8974-b616145311eb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4a1be29-fe8b-4423-91bc-6b4f5d730e6b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-2-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-2-review"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e'
        then answer_value_text
      else null
      end
    )
    
      
            as "d617b1e1-ea22-4863-a878-627f6b81963e"
      
    
    ,
  
    max(
      
      case
      when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5a79866d-f1fb-4bd8-b4c4-f18c982bef3c"
      
    
    ,
  
    max(
      
      case
      when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63'
        then answer_value_text
      else null
      end
    )
    
      
            as "2a6c5feb-8034-418b-8644-142a5e31df63"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "d3340d7e-9b84-4559-8a11-bed5a662a6f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb'
        then answer_value_text
      else null
      end
    )
    
      
            as "08b5e17c-5e14-4b19-ac93-9e479cd2a2bb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d'
        then answer_value_text
      else null
      end
    )
    
      
            as "ee5d4acf-ecf0-4e62-8924-cff17a33679d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4ebe784-07d0-4312-8a46-634c0e338a54"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444'
        then answer_value_text
      else null
      end
    )
    
      
            as "d8615ac7-96b2-46a2-b3a5-b5b83945b444"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8'
        then answer_value_text
      else null
      end
    )
    
      
            as "db779cb5-5335-4eb6-8ccc-47ec94c626c8"
      
    
    ,
  
    max(
      
      case
      when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea'
        then answer_value_text
      else null
      end
    )
    
      
            as "603d1492-316f-497f-967b-5c4b1ab983ea"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a273a98-82ca-4d36-ade0-ce98f7899972"
      
    
    ,
  
    max(
      
      case
      when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81'
        then answer_value_text
      else null
      end
    )
    
      
            as "06f9231a-999b-4459-8260-6fbbcdfc5d81"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-signs-step-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-signs-step-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7e42cdb-a42b-4d22-b7a6-204de5305351"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-response-step-3-review'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-response-step-3-review"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b247120-23cf-45fc-9e4d-d959f0dda79f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77'
        then answer_value_text
      else null
      end
    )
    
      
            as "d1efad02-3686-4ce3-a96d-68d8c638ff77"
      
    
    ,
  
    max(
      
      case
      when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942'
        then answer_value_text
      else null
      end
    )
    
      
            as "20cae99e-ab90-4d75-92a2-c0af5dd60942"
      
    
    ,
  
    max(
      
      case
      when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969'
        then answer_value_text
      else null
      end
    )
    
      
            as "12d89dfd-5e43-4f00-8446-b3af23323969"
      
    
    ,
  
    max(
      
      case
      when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c'
        then answer_value_text
      else null
      end
    )
    
      
            as "62a04638-8928-4aab-b490-1a33739b7a5c"
      
    
    ,
  
    max(
      
      case
      when linkid = '965b7874-dd24-4215-acd4-8d241a262638'
        then answer_value_text
      else null
      end
    )
    
      
            as "965b7874-dd24-4215-acd4-8d241a262638"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6d066a2-0286-49b0-b688-34696e7fb256"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f44652f-df2d-476e-933d-75b6ed55f5f2"
      
    
    ,
  
    max(
      
      case
      when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68'
        then answer_value_text
      else null
      end
    )
    
      
            as "6f68c416-a5de-4f68-8ad0-33c6e85a9a68"
      
    
    ,
  
    max(
      
      case
      when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225'
        then answer_value_text
      else null
      end
    )
    
      
            as "1895c0a7-b090-4f49-9b0c-08dca9a7b225"
      
    
    ,
  
    max(
      
      case
      when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2'
        then answer_value_text
      else null
      end
    )
    
      
            as "2c7b6bd7-36f6-495b-9f41-eb492c07c7b2"
      
    
    ,
  
    max(
      
      case
      when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904'
        then answer_value_text
      else null
      end
    )
    
      
            as "36dd1467-a7a1-428c-bdca-17d352a79904"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce0fdd41-6b09-4104-9998-a04c5dd9a5b7"
      
    
    ,
  
    max(
      
      case
      when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de'
        then answer_value_text
      else null
      end
    )
    
      
            as "68608473-77e6-4341-9f1b-d4d18b17d3de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871'
        then answer_value_text
      else null
      end
    )
    
      
            as "a1c56f60-b823-4c15-b99d-a315d2ca1871"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9'
        then answer_value_text
      else null
      end
    )
    
      
            as "dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33'
        then answer_value_text
      else null
      end
    )
    
      
            as "a20b29af-3317-415e-9c6e-d9f3bbc4df33"
      
    
    ,
  
    max(
      
      case
      when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f'
        then answer_value_text
      else null
      end
    )
    
      
            as "11aadd88-0cf9-48b2-939d-2b3e28191c5f"
      
    
    ,
  
    max(
      
      case
      when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488'
        then answer_value_text
      else null
      end
    )
    
      
            as "68fa6f2e-84ec-4dbc-900e-10ede297c488"
      
    
    ,
  
    max(
      
      case
      when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d'
        then answer_value_text
      else null
      end
    )
    
      
            as "1d0ad825-09de-4018-a680-cd0e6bf0983d"
      
    
    ,
  
    max(
      
      case
      when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344'
        then answer_value_text
      else null
      end
    )
    
      
            as "1fc8f8e7-2022-48d2-b41d-4e8ad22af344"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:49.027557 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_tmp" rename to "qr_104454"
[0m23:49:49.027750 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:49.028011 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:49:49.029498 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:49:49.029693 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:49.029842 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: BEGIN
[0m23:49:49.030030 [debug] [Thread-2 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_tmp" rename to "qr_104453"
[0m23:49:49.030693 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: COMMIT
[0m23:49:49.031185 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:49:49.031384 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:49.031567 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: COMMIT
[0m23:49:49.031774 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:49:49.031944 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:49.032298 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SPI Subform 1 (id: ipc-104455, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/104455') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda'
        then answer_value_text
      else null
      end
    )
    
      
            as "7fc39fba-84db-490d-af4e-8f772d91ffda"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423'
        then answer_value_text
      else null
      end
    )
    
      
            as "c7d21a57-0fc6-4e3a-b411-beceb1fb2423"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837'
        then answer_value_text
      else null
      end
    )
    
      
            as "644c00f2-8b07-4911-92d0-f05f5e5cc837"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03'
        then answer_value_text
      else null
      end
    )
    
      
            as "43898926-e9d5-400e-a095-62a8c7f8dd03"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6601f97-0a34-49d0-b181-611d6705ca42"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e9233a-9ab1-410a-b5e3-b30867355cea"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019'
        then answer_value_text
      else null
      end
    )
    
      
            as "ecabd308-c45a-41f7-8754-b1f63a101019"
      
    
    ,
  
    max(
      
      case
      when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "2897fef9-abcf-4bb3-b33f-2accae4c06c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f85f2ef-d781-4001-8df5-99a9ac5a656b"
      
    
    ,
  
    max(
      
      case
      when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511'
        then answer_value_text
      else null
      end
    )
    
      
            as "7cc2e8a9-197a-42ea-9431-ba01eefc6511"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2a74544-b333-4767-b3e3-7772413419ce"
      
    
    ,
  
    max(
      
      case
      when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb'
        then answer_value_text
      else null
      end
    )
    
      
            as "41aee132-ab8e-4d64-a322-eed88f900edb"
      
    
    ,
  
    max(
      
      case
      when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d'
        then answer_value_text
      else null
      end
    )
    
      
            as "06e33f1f-7202-4d5e-94d1-efbeabaa3e7d"
      
    
    ,
  
    max(
      
      case
      when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9'
        then answer_value_text
      else null
      end
    )
    
      
            as "71dbaac9-867f-4d7f-b6d7-e1f59402bbf9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-status-spi-subform-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-status-spi-subform-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '35062b98-748b-441c-ad74-185823e1bb52'
        then answer_value_text
      else null
      end
    )
    
      
            as "35062b98-748b-441c-ad74-185823e1bb52"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "d60ed1ee-79c9-444f-aff7-d346974426ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23'
        then answer_value_text
      else null
      end
    )
    
      
            as "567e992d-fb9e-4608-9be1-9277beae3c23"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:49.033139 [debug] [Thread-2 (]: On model.engage_analytics.qr_104453: COMMIT
[0m23:49:49.033404 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:49.033657 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:49:49.034871 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_backup"
[0m23:49:49.035052 [debug] [Thread-2 (]: On model.engage_analytics.qr_104453: COMMIT
[0m23:49:49.035331 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_104454"
[0m23:49:49.035537 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104454"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104454__dbt_backup" cascade
[0m23:49:49.036062 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:49.036279 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:49.037575 [debug] [Thread-4 (]: On model.engage_analytics.qr_104454: Close
[0m23:49:49.037781 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:49:49.038896 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_backup"
[0m23:49:49.040321 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:49:49.040601 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063acf20>]}
[0m23:49:49.040803 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m23:49:49.041067 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_104453"
[0m23:49:49.041310 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_tmp" rename to "qr_104455"
[0m23:49:49.043271 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:49:49.043536 [debug] [Thread-2 (]: On model.engage_analytics.qr_104453: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104453"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104453__dbt_backup" cascade
[0m23:49:49.043836 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_tmp" rename to "qr_104394"
[0m23:49:49.044391 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:49.044599 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:49.045247 [debug] [Thread-2 (]: On model.engage_analytics.qr_104453: Close
[0m23:49:49.045959 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: COMMIT
[0m23:49:49.046365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:49.046647 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e08d10>]}
[0m23:49:49.046848 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:49:49.047632 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: COMMIT
[0m23:49:49.048045 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: COMMIT
[0m23:49:49.048670 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:49:49.048943 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: COMMIT
[0m23:49:49.049904 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:49.050137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:49.051364 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_backup"
[0m23:49:49.052426 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_backup"
[0m23:49:49.052738 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_104455"
[0m23:49:49.053008 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_104394"
[0m23:49:49.053183 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104455"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104455__dbt_backup" cascade
[0m23:49:49.053348 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_104394"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_104394__dbt_backup" cascade
[0m23:49:49.054020 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:49.054215 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:49.054890 [debug] [Thread-3 (]: On model.engage_analytics.qr_104455: Close
[0m23:49:49.055451 [debug] [Thread-1 (]: On model.engage_analytics.qr_104394: Close
[0m23:49:49.055708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b9f10>]}
[0m23:49:49.056051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d1190>]}
[0m23:49:49.139116 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m23:49:49.139660 [info ] [Thread-2 (]: 24 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_104453  [[32mCREATE VIEW[0m in 0.71s]
[0m23:49:49.140136 [info ] [Thread-3 (]: 26 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_104455  [[32mCREATE VIEW[0m in 0.68s]
[0m23:49:49.140535 [info ] [Thread-1 (]: 23 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_104394  [[32mCREATE VIEW[0m in 0.73s]
[0m23:49:49.141083 [info ] [Thread-4 (]: 25 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_104454  [[32mCREATE VIEW[0m in 0.71s]
[0m23:49:49.141531 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_104453
[0m23:49:49.141971 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_104455
[0m23:49:49.142332 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_104394
[0m23:49:49.142664 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_104454
[0m23:49:49.143012 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_1613531
[0m23:49:49.143402 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_1613532
[0m23:49:49.143752 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_1_month_follow_up
[0m23:49:49.144084 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_202
[0m23:49:49.144424 [info ] [Thread-2 (]: 27 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_1613531  [RUN]
[0m23:49:49.144809 [info ] [Thread-3 (]: 28 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_1613532  [RUN]
[0m23:49:49.145141 [info ] [Thread-1 (]: 29 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [RUN]
[0m23:49:49.145432 [info ] [Thread-4 (]: 30 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_202 .... [RUN]
[0m23:49:49.145778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104453, now model.engage_analytics.qr_1613531)
[0m23:49:49.146057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104455, now model.engage_analytics.qr_1613532)
[0m23:49:49.146325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104394, now model.engage_analytics.qr_1_month_follow_up)
[0m23:49:49.146551 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_104454, now model.engage_analytics.qr_202)
[0m23:49:49.146843 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_1613531
[0m23:49:49.147090 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_1613532
[0m23:49:49.147313 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_1_month_follow_up
[0m23:49:49.147554 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_202
[0m23:49:49.151223 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:49:49.154431 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:49:49.157202 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:49:49.160955 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:49:49.161320 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

    
    with ids(ident) as ( values('Questionnaire/1613531') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:49.161682 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

    
    with ids(ident) as ( values('Questionnaire/1613532') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:49.161996 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

    
    with ids(ident) as ( values('Questionnaire/1-month-follow-up') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:49.162247 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

    
    with ids(ident) as ( values('Questionnaire/202') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:49.162512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:49.162768 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:49.162985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:49.163170 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:49.689126 [debug] [Thread-3 (]: SQL status: SELECT 37 in 0.526 seconds
[0m23:49:49.694831 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_1613532"
[0m23:49:49.696312 [debug] [Thread-2 (]: SQL status: SELECT 25 in 0.534 seconds
[0m23:49:49.698056 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_1613531"
[0m23:49:49.698314 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.535 seconds
[0m23:49:49.699409 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_1_month_follow_up"
[0m23:49:49.699813 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_1613532
[0m23:49:49.701782 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_1613532"
[0m23:49:49.702078 [debug] [Thread-4 (]: SQL status: SELECT 18 in 0.539 seconds
[0m23:49:49.702307 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_1613531
[0m23:49:49.702521 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_1_month_follow_up
[0m23:49:49.704021 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_202"
[0m23:49:49.705737 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_1613531"
[0m23:49:49.707623 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_1_month_follow_up"
[0m23:49:49.707961 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:49:49.708257 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: BEGIN
[0m23:49:49.708611 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:49:49.708843 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: BEGIN
[0m23:49:49.709045 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:49:49.709245 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:49.709444 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_202
[0m23:49:49.709665 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: BEGIN
[0m23:49:49.709907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:49.710092 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:49:49.711862 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_202"
[0m23:49:49.712081 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:49:49.712501 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mental Wellness Tool (id: 1613532, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613532') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'q1-to-q3-negative'
        then answer_value_text
      else null
      end
    )
    
      
            as "q1-to-q3-negative"
      
    
    ,
  
    max(
      
      case
      when linkid = 'suicide-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "suicide-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'severe-mental-health'
        then answer_value_text
      else null
      end
    )
    
      
            as "severe-mental-health"
      
    
    ,
  
    max(
      
      case
      when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63'
        then answer_value_text
      else null
      end
    )
    
      
            as "59ae2c65-3a25-4acb-9db5-7aa035c54a63"
      
    
    ,
  
    max(
      
      case
      when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc'
        then answer_value_text
      else null
      end
    )
    
      
            as "2c50fee4-7a5d-4d62-80aa-73329934d7dc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-mental-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-mental-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = 'alcohol-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "alcohol-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642'
        then answer_value_text
      else null
      end
    )
    
      
            as "156fce37-203f-4760-a9f9-1b8ab0ae0642"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-socio-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-socio-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a051272-efb0-4f1f-acc7-f5038989207f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588'
        then answer_value_text
      else null
      end
    )
    
      
            as "4602f806-3bf4-4f16-bee1-c2e690dca588"
      
    
    ,
  
    max(
      
      case
      when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab'
        then answer_value_text
      else null
      end
    )
    
      
            as "364e4271-e89d-4206-85a1-45ad595e4cab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f'
        then answer_value_text
      else null
      end
    )
    
      
            as "97f2ed48-11d2-4417-a4b2-57a333c5157f"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e7579d-ac74-4d72-955b-1a3675a2e656"
      
    
    ,
  
    max(
      
      case
      when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29'
        then answer_value_text
      else null
      end
    )
    
      
            as "80499f94-3f2a-4f0f-9a21-7fa252b33e29"
      
    
    ,
  
    max(
      
      case
      when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20'
        then answer_value_text
      else null
      end
    )
    
      
            as "69a559db-c97b-4bcb-aae4-81465fdd1d20"
      
    
    ,
  
    max(
      
      case
      when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "99f0d10e-9522-457f-8432-fd489c53acb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b9ecb840-8515-4091-8cef-863ed297012e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'common-mental-health'
        then answer_value_text
      else null
      end
    )
    
      
            as "common-mental-health"
      
    
    ,
  
    max(
      
      case
      when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73'
        then answer_value_text
      else null
      end
    )
    
      
            as "94f913ce-e837-48b3-906d-a0613ac72b73"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77'
        then answer_value_text
      else null
      end
    )
    
      
            as "a669eaea-2f12-49ff-ac91-d54009d6ab77"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d'
        then answer_value_text
      else null
      end
    )
    
      
            as "f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-problem'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-problem"
      
    
    ,
  
    max(
      
      case
      when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20'
        then answer_value_text
      else null
      end
    )
    
      
            as "11e90302-2ae0-4e7d-be11-754b2a91ab20"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-biological-sex'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-biological-sex"
      
    
    ,
  
    max(
      
      case
      when linkid = 'how-many-drinks'
        then answer_value_text
      else null
      end
    )
    
      
            as "how-many-drinks"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-common-mental-health-form'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-common-mental-health-form"
      
    
    ,
  
    max(
      
      case
      when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6'
        then answer_value_text
      else null
      end
    )
    
      
            as "0ee3228d-28b6-4c88-8119-808fc121aaa6"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e9014d1-e07c-492e-897a-3bf7e8f6f018"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-mwtool-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-mwtool-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:49.712954 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:49.713189 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- 1 month follow up (id: 1-month-follow-up, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'completed-all-recommended-interventions'
        then answer_value_text
      else null
      end
    )
    
      
            as "completed-all-recommended-interventions"
      
    
    ,
  
    max(
      
      case
      when linkid = 'schedule-this-meeting'
        then answer_value_text
      else null
      end
    )
    
      
            as "schedule-this-meeting"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:49.713501 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:49:49.713733 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:49:49.714175 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Sociodemographic Survey (id: 1613531, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/1613531') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cce9788-d7e7-4456-d455-5bd8dc3d2f2a"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b68e9a3-703a-4b57-876e-8dd400826db9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4afce83-4279-4d19-8a8b-1e0b7e1ba73c"
      
    
    ,
  
    max(
      
      case
      when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4'
        then answer_value_text
      else null
      end
    )
    
      
            as "6e621fcc-a25c-4070-8fda-894bb9df68e4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f'
        then answer_value_text
      else null
      end
    )
    
      
            as "f11fe547-9be9-4693-8a85-f252e4a6262f"
      
    
    ,
  
    max(
      
      case
      when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173'
        then answer_value_text
      else null
      end
    )
    
      
            as "5b133a13-0303-4d2f-8884-ffa931d2c173"
      
    
    ,
  
    max(
      
      case
      when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7'
        then answer_value_text
      else null
      end
    )
    
      
            as "05990b62-11a8-4ab7-8988-1d2a17edcff7"
      
    
    ,
  
    max(
      
      case
      when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5'
        then answer_value_text
      else null
      end
    )
    
      
            as "0e027468-c1e9-4977-f5f5-1cfa00ab8af5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "8f600ee9-8d17-43df-ed68-c9a7de2da7d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-socio-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-socio-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba'
        then answer_value_text
      else null
      end
    )
    
      
            as "d7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f8a7973-d9bb-493b-aa68-fb01e0f1aefe"
      
    
    ,
  
    max(
      
      case
      when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde'
        then answer_value_text
      else null
      end
    )
    
      
            as "1fdf1a17-7af6-413f-81e9-cf6823fe7fde"
      
    
    ,
  
    max(
      
      case
      when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af'
        then answer_value_text
      else null
      end
    )
    
      
            as "3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af"
      
    
    ,
  
    max(
      
      case
      when linkid = '92fed595-49f2-4fab-81ff-885941f31e07'
        then answer_value_text
      else null
      end
    )
    
      
            as "92fed595-49f2-4fab-81ff-885941f31e07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130'
        then answer_value_text
      else null
      end
    )
    
      
            as "66d30814-73ea-4fa4-edf8-d0d79378b130"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-biological-sex'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-biological-sex"
      
    
    ,
  
    max(
      
      case
      when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739'
        then answer_value_text
      else null
      end
    )
    
      
            as "3960c72d-b6e7-418e-86e9-f8348a49e739"
      
    
    ,
  
    max(
      
      case
      when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d'
        then answer_value_text
      else null
      end
    )
    
      
            as "4baa9e68-fe7a-489a-8b03-cc045b53d93d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:49.714527 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: BEGIN
[0m23:49:49.715124 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:49.715316 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:49:49.715622 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 1) (id: ipc-202, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/202') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-gad-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-gad-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9'
        then answer_value_text
      else null
      end
    )
    
      
            as "69f16284-b8a8-4a24-ab79-03bde5bcfbe9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603'
        then answer_value_text
      else null
      end
    )
    
      
            as "829e6d32-3fa7-4d16-909b-b198aea54603"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "583c5b02-b26c-4821-8da8-7ed9066d9d5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:49.715962 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:49.717535 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:49:49.717720 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:49.717881 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_tmp" rename to "qr_1_month_follow_up"
[0m23:49:49.718029 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:49.720058 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:49:49.720272 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:49:49.721823 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:49:49.722020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:49.722173 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_tmp" rename to "qr_1613531"
[0m23:49:49.723563 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:49:49.723761 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_tmp" rename to "qr_1613532"
[0m23:49:49.724357 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m23:49:49.724591 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_tmp" rename to "qr_202"
[0m23:49:49.724798 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:49:49.724971 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: COMMIT
[0m23:49:49.725299 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:49.725889 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: COMMIT
[0m23:49:49.726071 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:49.726230 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:49:49.726421 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:49.726657 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:49.727234 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: COMMIT
[0m23:49:49.727417 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: COMMIT
[0m23:49:49.728104 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: COMMIT
[0m23:49:49.729289 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup"
[0m23:49:49.729487 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:49:49.729701 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:49:49.730001 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_1_month_follow_up"
[0m23:49:49.730183 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:49.730361 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: COMMIT
[0m23:49:49.730532 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: COMMIT
[0m23:49:49.730707 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1_month_follow_up"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1_month_follow_up__dbt_backup" cascade
[0m23:49:49.731873 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_backup"
[0m23:49:49.732286 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_1613531"
[0m23:49:49.732496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:49.732690 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613531"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613531__dbt_backup" cascade
[0m23:49:49.732882 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:49.733065 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:49.733731 [debug] [Thread-1 (]: On model.engage_analytics.qr_1_month_follow_up: Close
[0m23:49:49.734882 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_backup"
[0m23:49:49.735081 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:49.736197 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_backup"
[0m23:49:49.736520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101934c20>]}
[0m23:49:49.736783 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_1613532"
[0m23:49:49.737475 [debug] [Thread-2 (]: On model.engage_analytics.qr_1613531: Close
[0m23:49:49.737794 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_202"
[0m23:49:49.738341 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_1613532"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_1613532__dbt_backup" cascade
[0m23:49:49.738179 [info ] [Thread-1 (]: 29 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_1_month_follow_up  [[32mCREATE VIEW[0m in 0.59s]
[0m23:49:49.738633 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_202"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_202__dbt_backup" cascade
[0m23:49:49.738923 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d21e80>]}
[0m23:49:49.739272 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_1_month_follow_up
[0m23:49:49.739654 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_203
[0m23:49:49.739894 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:49.740163 [info ] [Thread-2 (]: 27 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_1613531  [[32mCREATE VIEW[0m in 0.59s]
[0m23:49:49.740390 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:49.740625 [info ] [Thread-1 (]: 31 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_203 .... [RUN]
[0m23:49:49.741423 [debug] [Thread-3 (]: On model.engage_analytics.qr_1613532: Close
[0m23:49:49.741710 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_1613531
[0m23:49:49.742346 [debug] [Thread-4 (]: On model.engage_analytics.qr_202: Close
[0m23:49:49.742557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1_month_follow_up, now model.engage_analytics.qr_203)
[0m23:49:49.742818 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ba000>]}
[0m23:49:49.743034 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_204
[0m23:49:49.743293 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_203
[0m23:49:49.743576 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b7c80>]}
[0m23:49:49.744027 [info ] [Thread-3 (]: 28 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_1613532  [[32mCREATE VIEW[0m in 0.60s]
[0m23:49:49.744343 [info ] [Thread-2 (]: 32 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_204 .... [RUN]
[0m23:49:49.746982 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:49:49.747358 [info ] [Thread-4 (]: 30 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_202  [[32mCREATE VIEW[0m in 0.60s]
[0m23:49:49.747745 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_1613532
[0m23:49:49.748010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613531, now model.engage_analytics.qr_204)
[0m23:49:49.748231 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

    
    with ids(ident) as ( values('Questionnaire/203') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:49.748528 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_202
[0m23:49:49.748721 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_205
[0m23:49:49.748926 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_204
[0m23:49:49.749105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:49.749268 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_206
[0m23:49:49.749472 [info ] [Thread-3 (]: 33 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_205 .... [RUN]
[0m23:49:49.751749 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:49:49.752414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_1613532, now model.engage_analytics.qr_205)
[0m23:49:49.752150 [info ] [Thread-4 (]: 34 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_206 .... [RUN]
[0m23:49:49.752719 [debug] [Thread-2 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

    
    with ids(ident) as ( values('Questionnaire/204') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:49.752969 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_205
[0m23:49:49.753192 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_202, now model.engage_analytics.qr_206)
[0m23:49:49.753386 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:49.756578 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:49:49.756825 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_206
[0m23:49:49.757166 [debug] [Thread-3 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

    
    with ids(ident) as ( values('Questionnaire/205') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:49.759249 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:49:49.759533 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:49.759843 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

    
    with ids(ident) as ( values('Questionnaire/206') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:49.760185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:50.269245 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.519 seconds
[0m23:49:50.273393 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_203"
[0m23:49:50.273757 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.520 seconds
[0m23:49:50.275750 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_204"
[0m23:49:50.276101 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.516 seconds
[0m23:49:50.277068 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_206"
[0m23:49:50.277308 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.518 seconds
[0m23:49:50.278449 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_205"
[0m23:49:50.278878 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_203
[0m23:49:50.280818 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_203"
[0m23:49:50.281130 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_204
[0m23:49:50.282714 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_204"
[0m23:49:50.282980 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_206
[0m23:49:50.283194 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_205
[0m23:49:50.285027 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_206"
[0m23:49:50.286683 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_205"
[0m23:49:50.286913 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:49:50.287107 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:49:50.287342 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: BEGIN
[0m23:49:50.287585 [debug] [Thread-2 (]: On model.engage_analytics.qr_204: BEGIN
[0m23:49:50.287793 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:49:50.288058 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:49:50.288251 [debug] [Thread-3 (]: On model.engage_analytics.qr_205: BEGIN
[0m23:49:50.288428 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: BEGIN
[0m23:49:50.288765 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:50.288992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:50.289231 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:50.289457 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:49:50.289628 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:50.289787 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:49:50.289947 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:49:50.290335 [debug] [Thread-2 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 1) (id: ipc-204, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/204') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '16d05294-fee9-4d42-8447-0d578a5de192'
        then answer_value_text
      else null
      end
    )
    
      
            as "16d05294-fee9-4d42-8447-0d578a5de192"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f'
        then answer_value_text
      else null
      end
    )
    
      
            as "790391ba-cf9f-4ef6-be11-b5a7b468819f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7934aa5-17f0-4320-8f65-e7a7f72c5161"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d74aecd2-f0c4-4207-b396-b2c6d780be4a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505'
        then answer_value_text
      else null
      end
    )
    
      
            as "2171a88a-4e4d-44c4-b6b3-389723e9b505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-ptsd-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-ptsd-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:50.290728 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:49:50.290993 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 1) (id: ipc-203, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/203') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727'
        then answer_value_text
      else null
      end
    )
    
      
            as "8085cded-8e0f-497f-9e3d-5fab3981d727"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "d58c8907-06c6-4071-aa6c-b2b95d2169c7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:50.291349 [debug] [Thread-3 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 2) (id: ipc-205, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/205') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-gad-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-gad-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110'
        then answer_value_text
      else null
      end
    )
    
      
            as "510776d6-8b4e-446b-abe7-80aee8ecb110"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23'
        then answer_value_text
      else null
      end
    )
    
      
            as "37e0bcfd-f6d1-4b35-9556-4d458a717a23"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:50.291748 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 2) (id: ipc-206, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/206') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07'
        then answer_value_text
      else null
      end
    )
    
      
            as "85a3f14c-e4d8-4c45-9088-967ec4ea0d07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:50.294076 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:50.294309 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:50.294518 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:50.296097 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:49:50.296290 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:50.298437 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:49:50.299870 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:49:50.300096 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_tmp" rename to "qr_206"
[0m23:49:50.302462 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:49:50.302800 [debug] [Thread-3 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_tmp" rename to "qr_205"
[0m23:49:50.303096 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_tmp" rename to "qr_203"
[0m23:49:50.303451 [debug] [Thread-2 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_tmp" rename to "qr_204"
[0m23:49:50.304105 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:50.304812 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: COMMIT
[0m23:49:50.305008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:50.305175 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:49:50.305330 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:50.305497 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:50.306091 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: COMMIT
[0m23:49:50.306288 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: COMMIT
[0m23:49:50.306831 [debug] [Thread-2 (]: On model.engage_analytics.qr_204: COMMIT
[0m23:49:50.307531 [debug] [Thread-3 (]: On model.engage_analytics.qr_205: COMMIT
[0m23:49:50.307749 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:49:50.307978 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:49:50.308220 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:49:50.308443 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: COMMIT
[0m23:49:50.308653 [debug] [Thread-2 (]: On model.engage_analytics.qr_204: COMMIT
[0m23:49:50.308863 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:50.309027 [debug] [Thread-3 (]: On model.engage_analytics.qr_205: COMMIT
[0m23:49:50.310305 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_backup"
[0m23:49:50.310512 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:50.310701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:50.311021 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_206"
[0m23:49:50.312234 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_backup"
[0m23:49:50.312427 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:50.313505 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_backup"
[0m23:49:50.313724 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_206"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_206__dbt_backup" cascade
[0m23:49:50.313996 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_204"
[0m23:49:50.315228 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_backup"
[0m23:49:50.315567 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_203"
[0m23:49:50.315801 [debug] [Thread-2 (]: On model.engage_analytics.qr_204: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_204"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_204__dbt_backup" cascade
[0m23:49:50.316097 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_205"
[0m23:49:50.316334 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:50.316545 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_203"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_203__dbt_backup" cascade
[0m23:49:50.316790 [debug] [Thread-3 (]: On model.engage_analytics.qr_205: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_205"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_205__dbt_backup" cascade
[0m23:49:50.317532 [debug] [Thread-4 (]: On model.engage_analytics.qr_206: Close
[0m23:49:50.317755 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:50.318171 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630cd70>]}
[0m23:49:50.318994 [debug] [Thread-2 (]: On model.engage_analytics.qr_204: Close
[0m23:49:50.319246 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:50.319533 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:50.319828 [info ] [Thread-4 (]: 34 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_206  [[32mCREATE VIEW[0m in 0.56s]
[0m23:49:50.320184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063708c0>]}
[0m23:49:50.320863 [debug] [Thread-3 (]: On model.engage_analytics.qr_205: Close
[0m23:49:50.321463 [debug] [Thread-1 (]: On model.engage_analytics.qr_203: Close
[0m23:49:50.321720 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_206
[0m23:49:50.322001 [info ] [Thread-2 (]: 32 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_204  [[32mCREATE VIEW[0m in 0.57s]
[0m23:49:50.322283 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106221c70>]}
[0m23:49:50.322498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106213d10>]}
[0m23:49:50.322790 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_207
[0m23:49:50.323127 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_204
[0m23:49:50.323518 [info ] [Thread-3 (]: 33 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_205  [[32mCREATE VIEW[0m in 0.57s]
[0m23:49:50.323875 [info ] [Thread-1 (]: 31 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_203  [[32mCREATE VIEW[0m in 0.58s]
[0m23:49:50.324130 [info ] [Thread-4 (]: 35 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_207 .... [RUN]
[0m23:49:50.324356 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_208
[0m23:49:50.324638 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_205
[0m23:49:50.324864 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_203
[0m23:49:50.325069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_206, now model.engage_analytics.qr_207)
[0m23:49:50.325283 [info ] [Thread-2 (]: 36 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_208 .... [RUN]
[0m23:49:50.325573 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_209
[0m23:49:50.325821 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_210
[0m23:49:50.326064 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_207
[0m23:49:50.326341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_204, now model.engage_analytics.qr_208)
[0m23:49:50.326658 [info ] [Thread-3 (]: 37 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_209 .... [RUN]
[0m23:49:50.326913 [info ] [Thread-1 (]: 38 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_210 .... [RUN]
[0m23:49:50.329505 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:49:50.329807 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_208
[0m23:49:50.330113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_205, now model.engage_analytics.qr_209)
[0m23:49:50.330427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_203, now model.engage_analytics.qr_210)
[0m23:49:50.330658 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

    
    with ids(ident) as ( values('Questionnaire/207') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:50.333190 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:49:50.333472 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_209
[0m23:49:50.333664 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_210
[0m23:49:50.333836 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:50.334017 [debug] [Thread-2 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

    
    with ids(ident) as ( values('Questionnaire/208') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:50.337418 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:49:50.339734 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:49:50.340123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:50.340372 [debug] [Thread-3 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

    
    with ids(ident) as ( values('Questionnaire/209') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:50.340549 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

    
    with ids(ident) as ( values('Questionnaire/210') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:50.340832 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:50.341013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:50.853125 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.519 seconds
[0m23:49:50.855990 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_207"
[0m23:49:50.857992 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_207
[0m23:49:50.860070 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_207"
[0m23:49:50.860848 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:49:50.861067 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: BEGIN
[0m23:49:50.861877 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:50.862051 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:49:50.862255 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 3) (id: ipc-207, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/207') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "2fb4f2f4-23b5-4f36-b444-683563ea4fb3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:50.864645 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:50.866569 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:49:50.866814 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.526 seconds
[0m23:49:50.867082 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.526 seconds
[0m23:49:50.867317 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_tmp" rename to "qr_207"
[0m23:49:50.867501 [debug] [Thread-2 (]: SQL status: SELECT 97 in 0.527 seconds
[0m23:49:50.868962 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_210"
[0m23:49:50.869906 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_209"
[0m23:49:50.873552 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_208"
[0m23:49:50.873778 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:49:50.874637 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: COMMIT
[0m23:49:50.874875 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:49:50.875038 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: COMMIT
[0m23:49:50.875273 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_209
[0m23:49:50.877057 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_209"
[0m23:49:50.877283 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:50.878885 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_backup"
[0m23:49:50.879074 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_208
[0m23:49:50.879378 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_207"
[0m23:49:50.879537 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_210
[0m23:49:50.881142 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_208"
[0m23:49:50.881353 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:49:50.881522 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_207"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_207__dbt_backup" cascade
[0m23:49:50.883176 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_210"
[0m23:49:50.883447 [debug] [Thread-3 (]: On model.engage_analytics.qr_209: BEGIN
[0m23:49:50.883829 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:49:50.884052 [debug] [Thread-2 (]: On model.engage_analytics.qr_208: BEGIN
[0m23:49:50.884258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:50.884469 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:50.884688 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:49:50.884859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:50.885042 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:49:50.885732 [debug] [Thread-4 (]: On model.engage_analytics.qr_207: Close
[0m23:49:50.885914 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: BEGIN
[0m23:49:50.886087 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:49:50.886329 [debug] [Thread-3 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Mood Rating (IPC Session 4) (id: ipc-209, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/209') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990'
        then answer_value_text
      else null
      end
    )
    
      
            as "c04706e8-4a1e-4e6a-ac6e-be9dd8274990"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:50.886703 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063adfa0>]}
[0m23:49:50.887571 [debug] [Thread-2 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 3 (id: ipc-208, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '6930d457-7bec-4983-832b-3220b163f505'
        then answer_value_text
      else null
      end
    )
    
      
            as "6930d457-7bec-4983-832b-3220b163f505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243'
        then answer_value_text
      else null
      end
    )
    
      
            as "57a5ca78-4761-466a-bba4-c0c84eab5243"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9543e3c-cbff-4d2a-b3df-bf96e509d9ca"
      
    
    ,
  
    max(
      
      case
      when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a'
        then answer_value_text
      else null
      end
    )
    
      
            as "1b59ddeb-483d-4b1b-af53-f3942204589a"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ed77f2a-0d5a-434d-b153-d8deadfbc3f8"
      
    
    ,
  
    max(
      
      case
      when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "0a15f38b-027a-42ff-b1e8-ca5e2b313f71"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-4"
      
    
    ,
  
    max(
      
      case
      when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19'
        then answer_value_text
      else null
      end
    )
    
      
            as "70e4d965-a614-4dc5-b2fa-4035f0444b19"
      
    
    ,
  
    max(
      
      case
      when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553'
        then answer_value_text
      else null
      end
    )
    
      
            as "601055c1-efe3-47d4-9510-1ed0cc565553"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ad7384f-a332-4e41-9318-0d3f9e540ee7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1755ad4-b33a-44a3-b562-4206a582c28a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3'
        then answer_value_text
      else null
      end
    )
    
      
            as "2fb4f2f4-23b5-4f36-b444-683563ea4fb3"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f1e5102-4441-49d8-9fbc-4ea6df196b43"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a126244-6ec2-4c81-a6d4-409dff788019"
      
    
    ,
  
    max(
      
      case
      when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473'
        then answer_value_text
      else null
      end
    )
    
      
            as "68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e17756cd-4861-4dde-859c-f90241977246'
        then answer_value_text
      else null
      end
    )
    
      
            as "e17756cd-4861-4dde-859c-f90241977246"
      
    
    ,
  
    max(
      
      case
      when linkid = '95121ef1-bfe5-40ce-841c-524334644148'
        then answer_value_text
      else null
      end
    )
    
      
            as "95121ef1-bfe5-40ce-841c-524334644148"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb78f289-5f7d-4c89-9ddf-6b393a268462"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f926bba-38b5-4b20-8852-5b9e317bb010"
      
    
    ,
  
    max(
      
      case
      when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263'
        then answer_value_text
      else null
      end
    )
    
      
            as "86bdafab-bb90-429e-8bc5-a90dc46e7263"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-2"
      
    
    ,
  
    max(
      
      case
      when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73'
        then answer_value_text
      else null
      end
    )
    
      
            as "747188c8-4fc0-43ea-92b4-9baa32567f73"
      
    
    ,
  
    max(
      
      case
      when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b'
        then answer_value_text
      else null
      end
    )
    
      
            as "55092b78-a252-44ed-9dcb-2fc78570dc8b"
      
    
    ,
  
    max(
      
      case
      when linkid = '547a07c2-f94c-4956-997f-0439626d0251'
        then answer_value_text
      else null
      end
    )
    
      
            as "547a07c2-f94c-4956-997f-0439626d0251"
      
    
    ,
  
    max(
      
      case
      when linkid = '920de190-557a-4233-91a3-4bf293f18214'
        then answer_value_text
      else null
      end
    )
    
      
            as "920de190-557a-4233-91a3-4bf293f18214"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ff4b5cb-2c44-434b-90e9-85c61a858097"
      
    
    ,
  
    max(
      
      case
      when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414'
        then answer_value_text
      else null
      end
    )
    
      
            as "83176bb3-c0cb-445a-a91b-6711635b1414"
      
    
    ,
  
    max(
      
      case
      when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90'
        then answer_value_text
      else null
      end
    )
    
      
            as "10cd5560-6c41-41a6-94c5-af74ce96dc90"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-021'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-021"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9'
        then answer_value_text
      else null
      end
    )
    
      
            as "a24c89ff-1e14-403c-8dfa-26fc6c1103d9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb8828db-1674-47e7-ba9a-e3c161160b65"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f63637c-1de2-4851-a088-c3b08152447e'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f63637c-1de2-4851-a088-c3b08152447e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44'
        then answer_value_text
      else null
      end
    )
    
      
            as "eea0b1ca-5582-4b45-b5cf-36bc0665ba44"
      
    
    ,
  
    max(
      
      case
      when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975'
        then answer_value_text
      else null
      end
    )
    
      
            as "5db949bd-4ebf-4d52-b850-8e951455e975"
      
    
    ,
  
    max(
      
      case
      when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "8c82f757-3f40-4b09-bdf4-78ee376f75a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c'
        then answer_value_text
      else null
      end
    )
    
      
            as "1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e0b76f9-0902-43ba-b858-0b1505e9d168"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359'
        then answer_value_text
      else null
      end
    )
    
      
            as "e245b7d9-955a-4c4b-a107-e2bf5d6d2359"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a77f07b3-7913-4708-a354-14e503a948f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd'
        then answer_value_text
      else null
      end
    )
    
      
            as "8ac792f5-3f3c-49d3-a800-63c662bf00cd"
      
    
    ,
  
    max(
      
      case
      when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3'
        then answer_value_text
      else null
      end
    )
    
      
            as "50cf6a9c-a837-4531-a13a-47381657c2b3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "c91209cc-1b2c-43f0-83f0-4704418ae2d5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc8f199a-59f0-4184-864d-b1c0befd26df"
      
    
    ,
  
    max(
      
      case
      when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593'
        then answer_value_text
      else null
      end
    )
    
      
            as "43801cc4-c61f-4ee0-82ad-cf6f1f799593"
      
    
    ,
  
    max(
      
      case
      when linkid = '4442589a-51b2-48c3-8297-b805e525642c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4442589a-51b2-48c3-8297-b805e525642c"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c95559d-86ff-4b87-a271-e52388072a53'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c95559d-86ff-4b87-a271-e52388072a53"
      
    
    ,
  
    max(
      
      case
      when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "451acc1a-26f4-4374-96da-09bfb47365a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cc2834b-0d28-43d0-8811-509995cfcdb8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299'
        then answer_value_text
      else null
      end
    )
    
      
            as "b24118e2-31c5-4e23-af3a-1722af72c299"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-1"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f7b6563-47b1-4ad4-abc3-cffdae40a57a"
      
    
    ,
  
    max(
      
      case
      when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-019'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-019"
      
    
    ,
  
    max(
      
      case
      when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5'
        then answer_value_text
      else null
      end
    )
    
      
            as "9e995f48-b092-49b2-a9e4-c7e754e446e5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9a9f492-8eb8-4c71-8ec6-f80ab596430b"
      
    
    ,
  
    max(
      
      case
      when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc'
        then answer_value_text
      else null
      end
    )
    
      
            as "1b3394a9-eaff-4871-9537-0d29f5712adc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc'
        then answer_value_text
      else null
      end
    )
    
      
            as "4554f4b2-d15e-47e7-a10d-d77939dd3afc"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7f10195-b859-4670-abbc-a2498c4fe45f"
      
    
    ,
  
    max(
      
      case
      when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a'
        then answer_value_text
      else null
      end
    )
    
      
            as "232484cf-1aee-4bfa-a66e-61494587a16a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac6eb49b-3d37-4bac-8d27-1e1ad01018ce"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "d2cdab75-7e7a-4d5a-add8-fa70bd027640-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8b8e550-4d65-42be-acb9-2f4ac17c7f49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bed17079-d1e5-4bbe-af07-3d7b6a86243e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '665e1595-f169-4815-9d24-dac265f1809b'
        then answer_value_text
      else null
      end
    )
    
      
            as "665e1595-f169-4815-9d24-dac265f1809b"
      
    
    ,
  
    max(
      
      case
      when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21'
        then answer_value_text
      else null
      end
    )
    
      
            as "99079ebd-1665-4503-bb37-8de493dd4a21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-022'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-022"
      
    
    ,
  
    max(
      
      case
      when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef'
        then answer_value_text
      else null
      end
    )
    
      
            as "058278e4-33d6-4c0f-8127-ccf923bcc7ef"
      
    
    ,
  
    max(
      
      case
      when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd'
        then answer_value_text
      else null
      end
    )
    
      
            as "59744d45-0100-4d62-b105-5cbecd973ffd"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ecf12a4-a246-4b79-b281-65b3676ca3a4"
      
    
    ,
  
    max(
      
      case
      when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5'
        then answer_value_text
      else null
      end
    )
    
      
            as "77fc70ba-6cac-494c-b27a-77ebce2289e5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb0c7a5-a211-43ec-af7b-5f1079399133"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-024'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-024"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9'
        then answer_value_text
      else null
      end
    )
    
      
            as "969c0120-0b86-40e5-8881-6a145fe90aa9"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c9f8c1d-5827-4d21-bd33-3240fade93ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2'
        then answer_value_text
      else null
      end
    )
    
      
            as "6b5fa434-2fc3-4e4b-ad11-89f6260a81f2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6befba3-6d25-47ae-9cac-409dfae832a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92'
        then answer_value_text
      else null
      end
    )
    
      
            as "b31c0187-3e54-4fcf-9763-8b3f3850be92"
      
    
    ,
  
    max(
      
      case
      when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53'
        then answer_value_text
      else null
      end
    )
    
      
            as "9082f0ba-b8e5-495a-a2a4-b30918e19d53"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60'
        then answer_value_text
      else null
      end
    )
    
      
            as "b95949ec-f2ee-4d04-9e52-fb61dac18e60"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-020'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-020"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-023'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-023"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1a13d53-b867-440f-8622-bccebf54f176"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:50.888454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:49:50.888844 [info ] [Thread-4 (]: 35 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_207  [[32mCREATE VIEW[0m in 0.56s]
[0m23:49:50.889094 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:49:50.889352 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_207
[0m23:49:50.889693 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 4) (id: ipc-210, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/210') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11'
        then answer_value_text
      else null
      end
    )
    
      
            as "62b55d32-de8e-4abd-8489-4e3aa9270e11"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e'
        then answer_value_text
      else null
      end
    )
    
      
            as "d590116a-ec42-46e3-8ab6-6259307af17e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8'
        then answer_value_text
      else null
      end
    )
    
      
            as "a4b58f6e-3046-4a11-9e9e-e6b1547594e8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef'
        then answer_value_text
      else null
      end
    )
    
      
            as "d5a448fb-4db7-45e8-858b-f2d2e7cb0eef"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:50.890079 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_211
[0m23:49:50.890368 [info ] [Thread-4 (]: 39 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_211 .... [RUN]
[0m23:49:50.890720 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_207, now model.engage_analytics.qr_211)
[0m23:49:50.890952 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:50.891130 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_211
[0m23:49:50.892638 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:49:50.895037 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:49:50.895261 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:50.895448 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:49:50.895692 [debug] [Thread-3 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_tmp" rename to "qr_209"
[0m23:49:50.895892 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

    
    with ids(ident) as ( values('Questionnaire/211') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:50.897477 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:49:50.899168 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:49:50.899485 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:50.899686 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_tmp" rename to "qr_210"
[0m23:49:50.899881 [debug] [Thread-2 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_tmp" rename to "qr_208"
[0m23:49:50.900175 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:50.900888 [debug] [Thread-3 (]: On model.engage_analytics.qr_209: COMMIT
[0m23:49:50.901087 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:49:50.901250 [debug] [Thread-3 (]: On model.engage_analytics.qr_209: COMMIT
[0m23:49:50.901419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:50.902106 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: COMMIT
[0m23:49:50.902347 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:50.902582 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:49:50.902761 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:50.903450 [debug] [Thread-2 (]: On model.engage_analytics.qr_208: COMMIT
[0m23:49:50.903657 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: COMMIT
[0m23:49:50.904842 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_backup"
[0m23:49:50.905072 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:49:50.905512 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_209"
[0m23:49:50.905733 [debug] [Thread-2 (]: On model.engage_analytics.qr_208: COMMIT
[0m23:49:50.905942 [debug] [Thread-3 (]: On model.engage_analytics.qr_209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_209"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_209__dbt_backup" cascade
[0m23:49:50.906152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:50.908128 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_backup"
[0m23:49:50.908429 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_210"
[0m23:49:50.908610 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:50.908772 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_210"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_210__dbt_backup" cascade
[0m23:49:50.908920 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:49:50.909609 [debug] [Thread-3 (]: On model.engage_analytics.qr_209: Close
[0m23:49:50.910829 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_backup"
[0m23:49:50.911092 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:50.911414 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106249e80>]}
[0m23:49:50.911731 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_208"
[0m23:49:50.912442 [debug] [Thread-1 (]: On model.engage_analytics.qr_210: Close
[0m23:49:50.913050 [debug] [Thread-2 (]: On model.engage_analytics.qr_208: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_208"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_208__dbt_backup" cascade
[0m23:49:50.912857 [info ] [Thread-3 (]: 37 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_209  [[32mCREATE VIEW[0m in 0.58s]
[0m23:49:50.913488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064251c0>]}
[0m23:49:50.914021 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_209
[0m23:49:50.914282 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:50.914607 [info ] [Thread-1 (]: 38 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_210  [[32mCREATE VIEW[0m in 0.58s]
[0m23:49:50.914843 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_212
[0m23:49:50.915595 [debug] [Thread-2 (]: On model.engage_analytics.qr_208: Close
[0m23:49:50.915901 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_210
[0m23:49:50.916168 [info ] [Thread-3 (]: 40 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_212 .... [RUN]
[0m23:49:50.916469 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_221
[0m23:49:50.916733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106498170>]}
[0m23:49:50.916965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_209, now model.engage_analytics.qr_212)
[0m23:49:50.917203 [info ] [Thread-1 (]: 41 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_221 .... [RUN]
[0m23:49:50.917509 [info ] [Thread-2 (]: 36 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_208  [[32mCREATE VIEW[0m in 0.59s]
[0m23:49:50.917747 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_212
[0m23:49:50.917978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_210, now model.engage_analytics.qr_221)
[0m23:49:50.918215 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_208
[0m23:49:50.920689 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:49:50.920986 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_221
[0m23:49:50.921229 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_23451
[0m23:49:50.921505 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

    
    with ids(ident) as ( values('Questionnaire/212') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:50.923948 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:49:50.924223 [info ] [Thread-2 (]: 42 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_23451 .. [RUN]
[0m23:49:50.924522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:50.924777 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

    
    with ids(ident) as ( values('Questionnaire/221') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:50.925034 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_208, now model.engage_analytics.qr_23451)
[0m23:49:50.925350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:50.925511 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_23451
[0m23:49:50.927920 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:49:50.928156 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

    
    with ids(ident) as ( values('Questionnaire/23451') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:50.928317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:51.419961 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.520 seconds
[0m23:49:51.424141 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_211"
[0m23:49:51.424811 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_211
[0m23:49:51.426747 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_211"
[0m23:49:51.427185 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:49:51.427355 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: BEGIN
[0m23:49:51.428115 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:51.428335 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:49:51.428610 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 4) (id: ipc-211, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/211') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2'
        then answer_value_text
      else null
      end
    )
    
      
            as "01a4984f-7b50-47bb-9ae1-1b81ee4d6df2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b'
        then answer_value_text
      else null
      end
    )
    
      
            as "11d368a4-7f34-46d5-a8d0-6deed381945b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792'
        then answer_value_text
      else null
      end
    )
    
      
            as "4b86c897-4d68-405b-aa08-760ed6ff6792"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:51.431349 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:51.432956 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:49:51.433150 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_tmp" rename to "qr_211"
[0m23:49:51.434135 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:51.434827 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: COMMIT
[0m23:49:51.435017 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:49:51.435172 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: COMMIT
[0m23:49:51.436206 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:51.437539 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_backup"
[0m23:49:51.437813 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_211"
[0m23:49:51.437977 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_211"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_211__dbt_backup" cascade
[0m23:49:51.438611 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:51.439299 [debug] [Thread-4 (]: On model.engage_analytics.qr_211: Close
[0m23:49:51.439504 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.511 seconds
[0m23:49:51.439795 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b2450>]}
[0m23:49:51.440728 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_23451"
[0m23:49:51.441195 [info ] [Thread-4 (]: 39 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_211  [[32mCREATE VIEW[0m in 0.55s]
[0m23:49:51.441736 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_211
[0m23:49:51.441935 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_54
[0m23:49:51.442143 [info ] [Thread-4 (]: 43 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_54 ..... [RUN]
[0m23:49:51.442362 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_211, now model.engage_analytics.qr_54)
[0m23:49:51.442526 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_54
[0m23:49:51.444774 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:49:51.445088 [debug] [Thread-4 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:51.445333 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:51.445793 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_23451
[0m23:49:51.486410 [debug] [Thread-3 (]: SQL status: SELECT 159 in 0.562 seconds
[0m23:49:51.486749 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.561 seconds
[0m23:49:51.487496 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_23451"
[0m23:49:51.493762 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_212"
[0m23:49:51.495640 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_221"
[0m23:49:51.496688 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:49:51.496941 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: BEGIN
[0m23:49:51.497165 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_221
[0m23:49:51.499190 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_221"
[0m23:49:51.499448 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m23:49:51.499684 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_212
[0m23:49:51.499939 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:49:51.502097 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_212"
[0m23:49:51.502430 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Discuss Confidentiality (id: ipc-23451, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/23451') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:51.502753 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:49:51.503036 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: BEGIN
[0m23:49:51.503474 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:49:51.503646 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: BEGIN
[0m23:49:51.503821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:51.504015 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:49:51.504448 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Add Family Member Registration (id: ipc-221, url: n/a, version: 0.0.3)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/221') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9aa068d-8d94-4b3d-b9da-ce05a59cecdd"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6306275-b989-4375-8527-3a56092081b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6306275-b989-4375-8527-3a56092081b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-best-represents-how-you-think-of-yourself'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-best-represents-how-you-think-of-yourself"
      
    
    ,
  
    max(
      
      case
      when linkid = 'do-you-have-medicaid'
        then answer_value_text
      else null
      end
    )
    
      
            as "do-you-have-medicaid"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d'
        then answer_value_text
      else null
      end
    )
    
      
            as "8fb87910-d900-4eea-dbba-dcf76ee6806d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'choice-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "choice-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'medicaid-number'
        then answer_value_text
      else null
      end
    )
    
      
            as "medicaid-number"
      
    
    ,
  
    max(
      
      case
      when linkid = 'physical-address'
        then answer_value_text
      else null
      end
    )
    
      
            as "physical-address"
      
    
    ,
  
    max(
      
      case
      when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271'
        then answer_value_text
      else null
      end
    )
    
      
            as "77e32953-0679-48b5-f004-1ab4a4ac0271"
      
    
    ,
  
    max(
      
      case
      when linkid = 'choice-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "choice-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'zip-code'
        then answer_value_text
      else null
      end
    )
    
      
            as "zip-code"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-gender-identity'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-gender-identity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'phone-number'
        then answer_value_text
      else null
      end
    )
    
      
            as "phone-number"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-biological-sex-at-birth'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-biological-sex-at-birth"
      
    
    ,
  
    max(
      
      case
      when linkid = 'where-did-you-first-learn-about-engage'
        then answer_value_text
      else null
      end
    )
    
      
            as "where-did-you-first-learn-about-engage"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-where-did-you-first-learn-about-engage'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-where-did-you-first-learn-about-engage"
      
    
    ,
  
    max(
      
      case
      when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff'
        then answer_value_text
      else null
      end
    )
    
      
            as "36d39dbe-00e2-4e29-f079-3ec8f0119aff"
      
    
    ,
  
    max(
      
      case
      when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd'
        then answer_value_text
      else null
      end
    )
    
      
            as "597f4425-72b3-4bc4-8f38-b742aa3e99cd"
      
    
    ,
  
    max(
      
      case
      when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7'
        then answer_value_text
      else null
      end
    )
    
      
            as "8460d986-ef71-4997-80ee-7887d8c345e7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c31ef6d1-336b-4260-9881-67ba7b477ae0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-pronouns'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-pronouns"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'email-address'
        then answer_value_text
      else null
      end
    )
    
      
            as "email-address"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f'
        then answer_value_text
      else null
      end
    )
    
      
            as "c02a80e7-ebf0-48b5-9752-28a48dba487f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'age'
        then answer_value_text
      else null
      end
    )
    
      
            as "age"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:51.504825 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:51.505031 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:49:51.505221 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:51.506371 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- SBIRT (id: ipc-212, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/212') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'is-drug-dependence'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-drug-dependence"
      
    
    ,
  
    max(
      
      case
      when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812'
        then answer_value_text
      else null
      end
    )
    
      
            as "287b1b6c-fe58-4245-90dc-87d72d296812"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ad609c63-366e-476a-b131-610ceed211da'
        then answer_value_text
      else null
      end
    )
    
      
            as "ad609c63-366e-476a-b131-610ceed211da"
      
    
    ,
  
    max(
      
      case
      when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3'
        then answer_value_text
      else null
      end
    )
    
      
            as "38eb7cfd-8f4a-4743-b856-c8ddd529dac3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19'
        then answer_value_text
      else null
      end
    )
    
      
            as "ff55dd63-f51c-420b-97a0-f957d31d6b19"
      
    
    ,
  
    max(
      
      case
      when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2'
        then answer_value_text
      else null
      end
    )
    
      
            as "958d0ff5-edd9-4d25-9f4d-4ff29289bbe2"
      
    
    ,
  
    max(
      
      case
      when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4'
        then answer_value_text
      else null
      end
    )
    
      
            as "86daa888-2174-4fdc-9200-cbfdbe430ab4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-is-medium-high-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-is-medium-high-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ae15db19-8d0c-465a-a925-3e0503f0a25b"
      
    
    ,
  
    max(
      
      case
      when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116'
        then answer_value_text
      else null
      end
    )
    
      
            as "73b23b0b-ff20-4eb9-aebb-a34432897116"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "b11bfd65-1f8d-4dee-8a9e-b2044382c0d5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2c84a83-1568-4593-9ea4-4f6c3978edd6"
      
    
    ,
  
    max(
      
      case
      when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515'
        then answer_value_text
      else null
      end
    )
    
      
            as "28edfdea-ec6f-4d33-80e2-6d7323b3b515"
      
    
    ,
  
    max(
      
      case
      when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78'
        then answer_value_text
      else null
      end
    )
    
      
            as "19d44e35-f7b5-43e3-be3b-fdb820503f78"
      
    
    ,
  
    max(
      
      case
      when linkid = '39843731-a8e7-4822-bad7-55489947ebeb'
        then answer_value_text
      else null
      end
    )
    
      
            as "39843731-a8e7-4822-bad7-55489947ebeb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491'
        then answer_value_text
      else null
      end
    )
    
      
            as "db7cc8b8-b558-41c8-9849-a80252710491"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    ,
  
    max(
      
      case
      when linkid = 'should-discuss-health-goals'
        then answer_value_text
      else null
      end
    )
    
      
            as "should-discuss-health-goals"
      
    
    ,
  
    max(
      
      case
      when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc'
        then answer_value_text
      else null
      end
    )
    
      
            as "9f1fb719-c235-4826-a53e-24502bc620cc"
      
    
    ,
  
    max(
      
      case
      when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3'
        then answer_value_text
      else null
      end
    )
    
      
            as "7f8ade46-1d91-40a0-b67e-015a5a6aadc3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb'
        then answer_value_text
      else null
      end
    )
    
      
            as "2336b352-cd6b-4044-8879-a5425c4ae5cb"
      
    
    ,
  
    max(
      
      case
      when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3'
        then answer_value_text
      else null
      end
    )
    
      
            as "48d61a4b-d87d-4661-96dd-42766dbe8cc3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4317308-24ec-4ce6-8659-54d4f1aa7e96"
      
    
    ,
  
    max(
      
      case
      when linkid = '0466b304-2876-409b-ade2-d1c675614854'
        then answer_value_text
      else null
      end
    )
    
      
            as "0466b304-2876-409b-ade2-d1c675614854"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-medium-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-medium-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f'
        then answer_value_text
      else null
      end
    )
    
      
            as "687cad76-ce92-4dca-b94f-58070b33da6f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'using-opioids-and-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "using-opioids-and-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474'
        then answer_value_text
      else null
      end
    )
    
      
            as "88accd91-b2ff-4bba-a5b1-58eaef458474"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4'
        then answer_value_text
      else null
      end
    )
    
      
            as "d169ab54-4544-4d1a-8687-6abc289982a4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41'
        then answer_value_text
      else null
      end
    )
    
      
            as "daf9b1ff-06c5-45a7-a3d1-26977a2e2b41"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7'
        then answer_value_text
      else null
      end
    )
    
      
            as "b87d6054-9f94-456f-b7f6-67c73be8acc7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa901327-bb55-4e04-a72b-5bcc7eb22404"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-discuss-next-steps'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-discuss-next-steps"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990'
        then answer_value_text
      else null
      end
    )
    
      
            as "c0911201-29b6-4cff-8cf8-fca31dc2b990"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d'
        then answer_value_text
      else null
      end
    )
    
      
            as "d11e0ac3-5faf-4986-a633-22efa8c74c4d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7444114-6b17-4300-80a1-a6376fd135d4"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c5e1af3-63d6-4283-9ea3-ef2b49314b1a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671'
        then answer_value_text
      else null
      end
    )
    
      
            as "092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197'
        then answer_value_text
      else null
      end
    )
    
      
            as "dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ab8f95f3-3ca8-439f-afc2-c95a0853f9f4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40'
        then answer_value_text
      else null
      end
    )
    
      
            as "da17f7fc-0919-44cb-a41c-fa8480bd3c40"
      
    
    ,
  
    max(
      
      case
      when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49'
        then answer_value_text
      else null
      end
    )
    
      
            as "db4b99b9-2cae-4833-bb08-fe7e94156b49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "ba444442-73b2-44be-b55e-c8f9fba8f7a8"
      
    
    ,
  
    max(
      
      case
      when linkid = '1600f791-fd2c-44d8-8384-37973785741b'
        then answer_value_text
      else null
      end
    )
    
      
            as "1600f791-fd2c-44d8-8384-37973785741b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "eaa83f10-5cad-4c71-96b9-528e45af44fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'other-drug-list'
        then answer_value_text
      else null
      end
    )
    
      
            as "other-drug-list"
      
    
    ,
  
    max(
      
      case
      when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848'
        then answer_value_text
      else null
      end
    )
    
      
            as "abb64c97-d3a9-45a2-bec2-11f6c4dc8848"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a36058d0-3ac9-4cf6-aabb-6b4859dc985d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267'
        then answer_value_text
      else null
      end
    )
    
      
            as "b81b6e43-3b57-489e-8ea9-f35d82f9f267"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-opioid-dependence'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-opioid-dependence"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-low-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-low-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = 'score-audit'
        then answer_value_text
      else null
      end
    )
    
      
            as "score-audit"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-high-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-high-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11'
        then answer_value_text
      else null
      end
    )
    
      
            as "a713e390-f199-4ed4-9a27-b9938fbf8b11"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec346c72-9835-4b5a-8088-1797a200f995"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-medium-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-medium-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e'
        then answer_value_text
      else null
      end
    )
    
      
            as "232a2454-1d23-4ec9-b4ee-65e3a48afb3e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1d97a4-bb16-4c46-bcee-5593f472b53b"
      
    
    ,
  
    max(
      
      case
      when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "272246d4-b9c5-4a8b-a349-12f75cf888d0"
      
    
    ,
  
    max(
      
      case
      when linkid = '36af2335-ac86-4864-8a3d-619451160cc5'
        then answer_value_text
      else null
      end
    )
    
      
            as "36af2335-ac86-4864-8a3d-619451160cc5"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ad8b269-9415-4551-8d00-9be8812bde01"
      
    
    ,
  
    max(
      
      case
      when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41'
        then answer_value_text
      else null
      end
    )
    
      
            as "49ee0853-7d07-40af-a139-7cacc302ee41"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0'
        then answer_value_text
      else null
      end
    )
    
      
            as "c08dae42-df65-4dba-98c6-47f9e5dafcb0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c'
        then answer_value_text
      else null
      end
    )
    
      
            as "c6c7bd0c-812d-4931-b94c-929aa04dc45c"
      
    
    ,
  
    max(
      
      case
      when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e'
        then answer_value_text
      else null
      end
    )
    
      
            as "705b4c26-4479-4d6a-adbe-b8ebdbad302e"
      
    
    ,
  
    max(
      
      case
      when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b'
        then answer_value_text
      else null
      end
    )
    
      
            as "9dfe8a90-6551-4ae4-bcfb-c839e429a87b"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ee9b164-9830-4f7a-8317-28e0cfc1852c"
      
    
    ,
  
    max(
      
      case
      when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce'
        then answer_value_text
      else null
      end
    )
    
      
            as "1bc8823a-bbb1-444a-ad1b-dc09f57038ce"
      
    
    ,
  
    max(
      
      case
      when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5'
        then answer_value_text
      else null
      end
    )
    
      
            as "724d0558-550c-4edc-a1d6-3bd1285bc8a5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a"
      
    
    ,
  
    max(
      
      case
      when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e'
        then answer_value_text
      else null
      end
    )
    
      
            as "54f4cac5-ac52-4caa-a6b9-f8b4a412d92e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef06e3fc-45f0-40a3-aca9-43293339689b"
      
    
    ,
  
    max(
      
      case
      when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d'
        then answer_value_text
      else null
      end
    )
    
      
            as "859d58d6-ee56-4ede-9773-0b7650d7c66d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-things-to-do'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-things-to-do"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-goals'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-goals"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844'
        then answer_value_text
      else null
      end
    )
    
      
            as "da46a37c-1678-4f34-80b5-f69589bc8844"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88'
        then answer_value_text
      else null
      end
    )
    
      
            as "f53db683-31e1-4d83-82c4-7e3a02f9ee88"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-sbirt-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-sbirt-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7443184-d141-4bce-93fc-c393132c73b1"
      
    
    ,
  
    max(
      
      case
      when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a'
        then answer_value_text
      else null
      end
    )
    
      
            as "21a9c779-27be-4c08-b9ab-b0d84964145a"
      
    
    ,
  
    max(
      
      case
      when linkid = '654d5688-f42a-469b-8494-81115b760e29'
        then answer_value_text
      else null
      end
    )
    
      
            as "654d5688-f42a-469b-8494-81115b760e29"
      
    
    ,
  
    max(
      
      case
      when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "1eb189a2-2ae1-4a27-b4cf-9161447ff8b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "a6d0780b-f202-416d-8d9b-c418a4bdb5d0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e'
        then answer_value_text
      else null
      end
    )
    
      
            as "c93222e9-84f3-44a3-a87d-d92dafdc558e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4bd2450-08cb-410f-8f81-743d84749347"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-intervention-when-medium-high-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-intervention-when-medium-high-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04'
        then answer_value_text
      else null
      end
    )
    
      
            as "893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb3e9da-948e-4d05-8cad-58d293f557f6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e06c266d-8bd5-4232-85dc-f61a9d33aff2"
      
    
    ,
  
    max(
      
      case
      when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef'
        then answer_value_text
      else null
      end
    )
    
      
            as "9724b66b-2162-4984-b352-0bc27bcfdfef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1'
        then answer_value_text
      else null
      end
    )
    
      
            as "fae920b4-84d9-4576-9fac-51cba163ffd1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9fc5555-b1e6-4251-8047-13162c0b0cca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5787dda-4b43-4ae0-8cea-3062732f5a9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509'
        then answer_value_text
      else null
      end
    )
    
      
            as "ebf2e364-e7d7-44ec-a463-757c8e24d509"
      
    
    ,
  
    max(
      
      case
      when linkid = 'health-goals-do-not-want-to-change'
        then answer_value_text
      else null
      end
    )
    
      
            as "health-goals-do-not-want-to-change"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-low-risk-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-low-risk-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e1d29fe-7774-4731-bf50-ce5faaf0a528"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3'
        then answer_value_text
      else null
      end
    )
    
      
            as "e9a44d1a-ecf7-43af-835c-f4b5f73828d3"
      
    
    ,
  
    max(
      
      case
      when linkid = '582271e0-892e-4795-ac55-0b73baf828ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "582271e0-892e-4795-ac55-0b73baf828ca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db'
        then answer_value_text
      else null
      end
    )
    
      
            as "da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db"
      
    
    ,
  
    max(
      
      case
      when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f'
        then answer_value_text
      else null
      end
    )
    
      
            as "380d715b-abd0-4808-9ec4-0a1aabf9a33f"
      
    
    ,
  
    max(
      
      case
      when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5'
        then answer_value_text
      else null
      end
    )
    
      
            as "386eb911-a4c5-4207-9dab-8d5973069ac5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-to-use-marijuana-or-other'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-to-use-marijuana-or-other"
      
    
    ,
  
    max(
      
      case
      when linkid = 'drug-to-use-alcohol'
        then answer_value_text
      else null
      end
    )
    
      
            as "drug-to-use-alcohol"
      
    
    ,
  
    max(
      
      case
      when linkid = '6281fa0d-ef3f-4013-bd31-062371828010'
        then answer_value_text
      else null
      end
    )
    
      
            as "6281fa0d-ef3f-4013-bd31-062371828010"
      
    
    ,
  
    max(
      
      case
      when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f'
        then answer_value_text
      else null
      end
    )
    
      
            as "0eb07ad0-c8fa-49b6-9c27-064d844b6c4f"
      
    
    ,
  
    max(
      
      case
      when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5fa54c70-1483-4dfa-92fc-22ec4d90593c"
      
    
    ,
  
    max(
      
      case
      when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb'
        then answer_value_text
      else null
      end
    )
    
      
            as "5de2f3d9-de95-4871-919e-a00bb4f346bb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa01eb31-553b-415c-bb90-1ec8d07e979e"
      
    
    ,
  
    max(
      
      case
      when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5'
        then answer_value_text
      else null
      end
    )
    
      
            as "2b8c1391-ba62-4800-ab3d-287fd7a9a3a5"
      
    
    ,
  
    max(
      
      case
      when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1'
        then answer_value_text
      else null
      end
    )
    
      
            as "94dc51b7-59e3-4276-9afe-9b18cb7a08e1"
      
    
    ,
  
    max(
      
      case
      when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3'
        then answer_value_text
      else null
      end
    )
    
      
            as "7baaf5ce-f19b-4a40-980e-cfe53efac3f3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1d9ecfa-c456-4109-8807-b8e26ffb69aa"
      
    
    ,
  
    max(
      
      case
      when linkid = 'edced328-6f82-458a-bce4-35987bff19fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "edced328-6f82-458a-bce4-35987bff19fb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-gender'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-gender"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8'
        then answer_value_text
      else null
      end
    )
    
      
            as "a44b78b7-d5ab-49a8-958d-5545072692d8"
      
    
    ,
  
    max(
      
      case
      when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e'
        then answer_value_text
      else null
      end
    )
    
      
            as "642b120d-78f5-4ec6-9cbf-d3b9e336083e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041'
        then answer_value_text
      else null
      end
    )
    
      
            as "af4330a4-7bc7-48db-bce8-364b0ff4b041"
      
    
    ,
  
    max(
      
      case
      when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa'
        then answer_value_text
      else null
      end
    )
    
      
            as "2badbdc1-2d13-4368-b803-c2eb7a2647aa"
      
    
    ,
  
    max(
      
      case
      when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045'
        then answer_value_text
      else null
      end
    )
    
      
            as "590f26f6-d5e5-4b56-b3a8-415e038dc045"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "ba10b935-7861-4ce4-a2c6-88bdd97709fb"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084'
        then answer_value_text
      else null
      end
    )
    
      
            as "fac09a6e-c280-426d-94a1-0aa707e35084"
      
    
    ,
  
    max(
      
      case
      when linkid = 'score-dast'
        then answer_value_text
      else null
      end
    )
    
      
            as "score-dast"
      
    
    ,
  
    max(
      
      case
      when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368'
        then answer_value_text
      else null
      end
    )
    
      
            as "9d8d7688-d1ed-4851-a6ea-59bc296f5368"
      
    
    ,
  
    max(
      
      case
      when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985'
        then answer_value_text
      else null
      end
    )
    
      
            as "818b51b8-c7b3-4d64-8142-1c0798662985"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3e99643-32dc-4e2e-983c-e694159623e3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'should-converse-about-substance-use'
        then answer_value_text
      else null
      end
    )
    
      
            as "should-converse-about-substance-use"
      
    
    ,
  
    max(
      
      case
      when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3'
        then answer_value_text
      else null
      end
    )
    
      
            as "43dead8d-380d-4214-80f1-a1961b916bd3"
      
    
    ,
  
    max(
      
      case
      when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96'
        then answer_value_text
      else null
      end
    )
    
      
            as "8bcb58a6-5720-4746-b0d0-22d6b6ec7c96"
      
    
    ,
  
    max(
      
      case
      when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848'
        then answer_value_text
      else null
      end
    )
    
      
            as "71679b91-ee7b-4eda-9f9d-cf85645ee848"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-intervention-when-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-intervention-when-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427"
      
    
    ,
  
    max(
      
      case
      when linkid = '8427af19-3bad-4713-bad9-b179437fef96'
        then answer_value_text
      else null
      end
    )
    
      
            as "8427af19-3bad-4713-bad9-b179437fef96"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8e7d8b0-88e2-4bae-8990-c3ae94165ef9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba'
        then answer_value_text
      else null
      end
    )
    
      
            as "fd89df57-4b13-432f-a5b9-d54918f8d4ba"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-high-risk-drug'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-high-risk-drug"
      
    
    ,
  
    max(
      
      case
      when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9'
        then answer_value_text
      else null
      end
    )
    
      
            as "15799969-7565-4c3e-b488-d6a65d66c6c9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4"
      
    
    ,
  
    max(
      
      case
      when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd'
        then answer_value_text
      else null
      end
    )
    
      
            as "9346e7e0-e74b-452a-addc-e6ad13d016dd"
      
    
    ,
  
    max(
      
      case
      when linkid = '90876967-c973-4bee-9217-8c7482cb12a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "90876967-c973-4bee-9217-8c7482cb12a2"
      
    
    ,
  
    max(
      
      case
      when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e2b0891-5355-4ffd-8a18-66193a0dbfbe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-summary-for-low-risk'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-summary-for-low-risk"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299'
        then answer_value_text
      else null
      end
    )
    
      
            as "c5437ab8-5d0c-4157-b06a-b5ec491dc299"
      
    
    ,
  
    max(
      
      case
      when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621'
        then answer_value_text
      else null
      end
    )
    
      
            as "67c70e9e-2e10-4d4a-b354-95621a05c621"
      
    
    ,
  
    max(
      
      case
      when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f'
        then answer_value_text
      else null
      end
    )
    
      
            as "49bafbbf-8110-46a0-83f4-802cb1b6fd0f"
      
    
    ,
  
    max(
      
      case
      when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069'
        then answer_value_text
      else null
      end
    )
    
      
            as "6f1dfe02-2dbb-4371-ab06-a8c915495069"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-client-use-with-other-drugs'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-client-use-with-other-drugs"
      
    
    ,
  
    max(
      
      case
      when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730'
        then answer_value_text
      else null
      end
    )
    
      
            as "445adcc0-9c5f-4647-b339-fcb5835f1730"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:51.508830 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:49:51.509027 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:49:51.509265 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_tmp" rename to "qr_23451"
[0m23:49:51.510656 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:49:51.510883 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_tmp" rename to "qr_221"
[0m23:49:51.511513 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:51.512208 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: COMMIT
[0m23:49:51.512400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:51.512590 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:49:51.513267 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: COMMIT
[0m23:49:51.513466 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: COMMIT
[0m23:49:51.513649 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:49:51.513837 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: COMMIT
[0m23:49:51.514552 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:51.514752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:51.515910 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_backup"
[0m23:49:51.517044 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_backup"
[0m23:49:51.517323 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_23451"
[0m23:49:51.517497 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:49:51.517730 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_221"
[0m23:49:51.517906 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_23451"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_23451__dbt_backup" cascade
[0m23:49:51.519437 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:49:51.519640 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_221"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_221__dbt_backup" cascade
[0m23:49:51.519862 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_tmp" rename to "qr_212"
[0m23:49:51.520252 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:51.520452 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:51.521181 [debug] [Thread-2 (]: On model.engage_analytics.qr_23451: Close
[0m23:49:51.521824 [debug] [Thread-1 (]: On model.engage_analytics.qr_221: Close
[0m23:49:51.522014 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:51.522339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633a270>]}
[0m23:49:51.522556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063033e0>]}
[0m23:49:51.523222 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: COMMIT
[0m23:49:51.523685 [info ] [Thread-1 (]: 41 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_221  [[32mCREATE VIEW[0m in 0.60s]
[0m23:49:51.523911 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:49:51.524222 [info ] [Thread-2 (]: 42 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_23451  [[32mCREATE VIEW[0m in 0.60s]
[0m23:49:51.524541 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_221
[0m23:49:51.524767 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: COMMIT
[0m23:49:51.525061 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_23451
[0m23:49:51.525268 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_55
[0m23:49:51.525628 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_56
[0m23:49:51.525876 [info ] [Thread-1 (]: 44 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_55 ..... [RUN]
[0m23:49:51.526372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_221, now model.engage_analytics.qr_55)
[0m23:49:51.526563 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_55
[0m23:49:51.528998 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:49:51.526140 [info ] [Thread-2 (]: 45 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_56 ..... [RUN]
[0m23:49:51.529302 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:49:51.529502 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

    
    with ids(ident) as ( values('Questionnaire/55') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:51.529717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_23451, now model.engage_analytics.qr_56)
[0m23:49:51.531055 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_backup"
[0m23:49:51.531257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:51.531444 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_56
[0m23:49:51.531773 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_212"
[0m23:49:51.534090 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:49:51.534387 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_212"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_212__dbt_backup" cascade
[0m23:49:51.534594 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

    
    with ids(ident) as ( values('Questionnaire/56') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:51.534869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:51.535273 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:51.535985 [debug] [Thread-3 (]: On model.engage_analytics.qr_212: Close
[0m23:49:51.536300 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106221c70>]}
[0m23:49:51.536609 [info ] [Thread-3 (]: 40 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_212  [[32mCREATE VIEW[0m in 0.62s]
[0m23:49:51.536879 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_212
[0m23:49:51.537063 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_57
[0m23:49:51.537395 [info ] [Thread-3 (]: 46 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_57 ..... [RUN]
[0m23:49:51.537782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_212, now model.engage_analytics.qr_57)
[0m23:49:51.537980 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_57
[0m23:49:51.540397 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:49:51.540683 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

    
    with ids(ident) as ( values('Questionnaire/57') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:51.540880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:52.008453 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.563 seconds
[0m23:49:52.014276 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_54"
[0m23:49:52.014938 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_54
[0m23:49:52.016971 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_54"
[0m23:49:52.017390 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:49:52.017565 [debug] [Thread-4 (]: On model.engage_analytics.qr_54: BEGIN
[0m23:49:52.018361 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:52.018585 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:49:52.018901 [debug] [Thread-4 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 1) (id: ipc-54, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0'
        then answer_value_text
      else null
      end
    )
    
      
            as "0cfe26b9-8cd8-4d03-938f-991ebab4b3c0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5675128-0cd4-423f-840c-8dcff1e2a429"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a05b4fe-b514-4751-91be-adb1b278430c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-phq-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-phq-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:52.021840 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:52.023464 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:49:52.023658 [debug] [Thread-4 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_tmp" rename to "qr_54"
[0m23:49:52.024486 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:52.025096 [debug] [Thread-4 (]: On model.engage_analytics.qr_54: COMMIT
[0m23:49:52.025267 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:49:52.025414 [debug] [Thread-4 (]: On model.engage_analytics.qr_54: COMMIT
[0m23:49:52.026070 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:52.027155 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_backup"
[0m23:49:52.027419 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_54"
[0m23:49:52.027586 [debug] [Thread-4 (]: On model.engage_analytics.qr_54: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_54__dbt_backup" cascade
[0m23:49:52.028248 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:52.029053 [debug] [Thread-4 (]: On model.engage_analytics.qr_54: Close
[0m23:49:52.029352 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643cda0>]}
[0m23:49:52.029665 [info ] [Thread-4 (]: 43 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_54  [[32mCREATE VIEW[0m in 0.59s]
[0m23:49:52.029937 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_54
[0m23:49:52.030128 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_58
[0m23:49:52.030372 [info ] [Thread-4 (]: 47 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_58 ..... [RUN]
[0m23:49:52.030566 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_54, now model.engage_analytics.qr_58)
[0m23:49:52.030727 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_58
[0m23:49:52.033073 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:49:52.033297 [debug] [Thread-4 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

    
    with ids(ident) as ( values('Questionnaire/58') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:52.033461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:52.049446 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.514 seconds
[0m23:49:52.051174 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_56"
[0m23:49:52.052387 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_56
[0m23:49:52.054383 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_56"
[0m23:49:52.054852 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.514 seconds
[0m23:49:52.056320 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_57"
[0m23:49:52.056640 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:49:52.056855 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: BEGIN
[0m23:49:52.057137 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_57
[0m23:49:52.058953 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_57"
[0m23:49:52.059209 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m23:49:52.059445 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:49:52.059779 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 2) (id: ipc-56, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/56') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4'
        then answer_value_text
      else null
      end
    )
    
      
            as "c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d'
        then answer_value_text
      else null
      end
    )
    
      
            as "dd349377-e542-4b4f-8fba-795f91431f7d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-ptsd-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-ptsd-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb'
        then answer_value_text
      else null
      end
    )
    
      
            as "9de6571c-3f74-4694-a567-ac5c897f96cb"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "931dc4ee-b677-4812-9372-3fea7012e9bc"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:52.060339 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:49:52.060567 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: BEGIN
[0m23:49:52.061107 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:52.061329 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:49:52.061611 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 2) (id: ipc-57, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/57') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4'
        then answer_value_text
      else null
      end
    )
    
      
            as "7239b680-ef7a-4f9f-87ff-a77bf21d96d4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172'
        then answer_value_text
      else null
      end
    )
    
      
            as "7afb89dc-d53b-4dc3-a185-43dbb4854172"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a07491bd-039d-417b-9caf-0af536316594'
        then answer_value_text
      else null
      end
    )
    
      
            as "a07491bd-039d-417b-9caf-0af536316594"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-phq-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-phq-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:52.063277 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:52.064917 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:49:52.065119 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_tmp" rename to "qr_56"
[0m23:49:52.065334 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:52.067708 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:49:52.067951 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:52.068168 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_tmp" rename to "qr_57"
[0m23:49:52.068861 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: COMMIT
[0m23:49:52.069150 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:49:52.069313 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: COMMIT
[0m23:49:52.069873 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:52.070482 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: COMMIT
[0m23:49:52.070664 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:49:52.070849 [debug] [Thread-1 (]: SQL status: SELECT 111 in 0.540 seconds
[0m23:49:52.071017 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: COMMIT
[0m23:49:52.071199 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:52.075257 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_55"
[0m23:49:52.076478 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_backup"
[0m23:49:52.076718 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:52.077092 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_56"
[0m23:49:52.078096 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_backup"
[0m23:49:52.078332 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_56"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_56__dbt_backup" cascade
[0m23:49:52.078623 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_57"
[0m23:49:52.078867 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_57"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_57__dbt_backup" cascade
[0m23:49:52.079101 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_55
[0m23:49:52.079286 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:52.081210 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_55"
[0m23:49:52.081390 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:52.082093 [debug] [Thread-2 (]: On model.engage_analytics.qr_56: Close
[0m23:49:52.082827 [debug] [Thread-3 (]: On model.engage_analytics.qr_57: Close
[0m23:49:52.083195 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060411f0>]}
[0m23:49:52.083551 [info ] [Thread-2 (]: 45 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_56  [[32mCREATE VIEW[0m in 0.55s]
[0m23:49:52.083829 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_56
[0m23:49:52.084112 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d2390>]}
[0m23:49:52.084377 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_59
[0m23:49:52.084668 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:49:52.085000 [info ] [Thread-3 (]: 46 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_57  [[32mCREATE VIEW[0m in 0.55s]
[0m23:49:52.085475 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: BEGIN
[0m23:49:52.085230 [info ] [Thread-2 (]: 48 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_59 ..... [RUN]
[0m23:49:52.085779 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_57
[0m23:49:52.086073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_56, now model.engage_analytics.qr_59)
[0m23:49:52.086359 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_60
[0m23:49:52.086724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:52.086928 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_59
[0m23:49:52.087177 [info ] [Thread-3 (]: 49 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_60 ..... [RUN]
[0m23:49:52.087400 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:49:52.089863 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:49:52.090145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_57, now model.engage_analytics.qr_60)
[0m23:49:52.091039 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 1 (id: ipc-55, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.73.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.73.2"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b0a751e-936e-40e8-9076-c7fe1e818c1f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.43.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.43.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '69125945-bec7-4810-985a-8c1052e8d039'
        then answer_value_text
      else null
      end
    )
    
      
            as "69125945-bec7-4810-985a-8c1052e8d039"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.88.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.88.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-012'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-012"
      
    
    ,
  
    max(
      
      case
      when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67'
        then answer_value_text
      else null
      end
    )
    
      
            as "47eaf38f-c74e-484a-af95-b0002074bf67"
      
    
    ,
  
    max(
      
      case
      when linkid = '16333904-aad5-4166-9593-b7286c7b20b2'
        then answer_value_text
      else null
      end
    )
    
      
            as "16333904-aad5-4166-9593-b7286c7b20b2"
      
    
    ,
  
    max(
      
      case
      when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727'
        then answer_value_text
      else null
      end
    )
    
      
            as "8085cded-8e0f-497f-9e3d-5fab3981d727"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.82.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.82.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204'
        then answer_value_text
      else null
      end
    )
    
      
            as "d126d866-b8c4-4288-84ff-49a40f20e204"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.87.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.87.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a'
        then answer_value_text
      else null
      end
    )
    
      
            as "a88cb2bf-e23b-423b-9a22-ab94678ccc3a"
      
    
    ,
  
    max(
      
      case
      when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89'
        then answer_value_text
      else null
      end
    )
    
      
            as "31a9e716-52ce-4651-bb17-26f442e2ab89"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c'
        then answer_value_text
      else null
      end
    )
    
      
            as "1ae11d83-35d4-41c0-a804-5ddf6b1c388c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-008'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-008"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd69a7a1-ec17-4f43-8597-26c59732261b"
      
    
    ,
  
    max(
      
      case
      when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a'
        then answer_value_text
      else null
      end
    )
    
      
            as "13d72f63-dd18-41f9-bf46-44981f2f804a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.68.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.68.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.78.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.78.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.92.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.92.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-1"
      
    
    ,
  
    max(
      
      case
      when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4'
        then answer_value_text
      else null
      end
    )
    
      
            as "82cdd7f0-f3d1-4eba-a31e-c6ad367742f4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.2"
      
    
    ,
  
    max(
      
      case
      when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b'
        then answer_value_text
      else null
      end
    )
    
      
            as "0de42ce5-6d9f-40ec-b67b-3d3b975d363b"
      
    
    ,
  
    max(
      
      case
      when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "78bc8272-eba1-48a8-a2f4-0e47304887b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.81.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.81.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892'
        then answer_value_text
      else null
      end
    )
    
      
            as "b1b6bebb-0cb7-4029-b320-01d3270ee892"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '07b722c9-210e-491a-8933-2e9aab3474af'
        then answer_value_text
      else null
      end
    )
    
      
            as "07b722c9-210e-491a-8933-2e9aab3474af"
      
    
    ,
  
    max(
      
      case
      when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER'
        then answer_value_text
      else null
      end
    )
    
      
            as "LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER"
      
    
    ,
  
    max(
      
      case
      when linkid = '1809cb03-235d-4855-b201-7b296b160e37'
        then answer_value_text
      else null
      end
    )
    
      
            as "1809cb03-235d-4855-b201-7b296b160e37"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-009'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-009"
      
    
    ,
  
    max(
      
      case
      when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "24f9ed3b-3706-43fb-9779-07a9c2077e9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523'
        then answer_value_text
      else null
      end
    )
    
      
            as "69ed5884-0814-4ae0-a7f1-ecf730710523"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123'
        then answer_value_text
      else null
      end
    )
    
      
            as "347d89f5-1bad-4ba5-8f45-e63972b02123"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d'
        then answer_value_text
      else null
      end
    )
    
      
            as "c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.11'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.11"
      
    
    ,
  
    max(
      
      case
      when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73'
        then answer_value_text
      else null
      end
    )
    
      
            as "798d2c43-5b9f-436f-9fa2-f360cbeeea73"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1'
        then answer_value_text
      else null
      end
    )
    
      
            as "b7b59772-0272-41f6-ba66-16b09a832fc1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.79.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.79.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.12'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.12"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037'
        then answer_value_text
      else null
      end
    )
    
      
            as "f11ace93-5d84-4cc5-8598-58f9c5623037"
      
    
    ,
  
    max(
      
      case
      when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690'
        then answer_value_text
      else null
      end
    )
    
      
            as "54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408'
        then answer_value_text
      else null
      end
    )
    
      
            as "19416221-7c67-44d7-9b9b-b88364ea7408"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.6.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.6.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf'
        then answer_value_text
      else null
      end
    )
    
      
            as "80344998-41e2-4669-a77e-1fdaebe88bcf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.89.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.89.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.38.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.38.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e2629251-1266-4760-a539-f0e680df651b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e2629251-1266-4760-a539-f0e680df651b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-010'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-010"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.72.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.72.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b'
        then answer_value_text
      else null
      end
    )
    
      
            as "b322e52d-99f3-48e0-bda0-09d95228ae7b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52'
        then answer_value_text
      else null
      end
    )
    
      
            as "e8bfb690-b135-4b0f-9291-f6247611ce52"
      
    
    ,
  
    max(
      
      case
      when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c'
        then answer_value_text
      else null
      end
    )
    
      
            as "5e65c0dc-5524-4f3d-8404-a7427a34e61c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7'
        then answer_value_text
      else null
      end
    )
    
      
            as "d58c8907-06c6-4071-aa6c-b2b95d2169c7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685'
        then answer_value_text
      else null
      end
    )
    
      
            as "0627ed93-c89d-48ae-bde2-bd013dc58685"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.38.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.38.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655'
        then answer_value_text
      else null
      end
    )
    
      
            as "d6c7419a-9082-4579-8678-44e866ab3655"
      
    
    ,
  
    max(
      
      case
      when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface'
        then answer_value_text
      else null
      end
    )
    
      
            as "528fa2c7-7a88-4d4e-b2ba-38c1384aface"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.9'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.74.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.74.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe689023-f019-483b-ba7c-8ff0e16129d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '042e5415-93de-419d-9bac-632596939280'
        then answer_value_text
      else null
      end
    )
    
      
            as "042e5415-93de-419d-9bac-632596939280"
      
    
    ,
  
    max(
      
      case
      when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b'
        then answer_value_text
      else null
      end
    )
    
      
            as "37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.42.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.42.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "bd785881-7e04-4093-b191-d845edea4c9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.46.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.46.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.4"
      
    
    ,
  
    max(
      
      case
      when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd'
        then answer_value_text
      else null
      end
    )
    
      
            as "5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd"
      
    
    ,
  
    max(
      
      case
      when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801'
        then answer_value_text
      else null
      end
    )
    
      
            as "10151d1b-3cd2-4f10-b1e5-d6b20112d801"
      
    
    ,
  
    max(
      
      case
      when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759'
        then answer_value_text
      else null
      end
    )
    
      
            as "8a8b5e1e-fa6b-472b-ade7-ee8f5286a759"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a2ac26a-8d30-4c28-be11-f684f415f661"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.70.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.70.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.5'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.5"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.81.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.81.3"
      
    
    ,
  
    max(
      
      case
      when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d'
        then answer_value_text
      else null
      end
    )
    
      
            as "6409c231-50c1-45fc-808e-f0bd015db97d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.4'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.69.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.69.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.40.8'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.40.8"
      
    
    ,
  
    max(
      
      case
      when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92'
        then answer_value_text
      else null
      end
    )
    
      
            as "6099951a-c965-40f9-ad61-66e7a39a6b92"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.76.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.76.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.69.3'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.69.3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.5.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.5.2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.39.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.39.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45'
        then answer_value_text
      else null
      end
    )
    
      
            as "acd9d89b-0d67-415e-a3a4-b132ab304c45"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.79.2'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.79.2"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:52.091859 [debug] [Thread-2 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

    
    with ids(ident) as ( values('Questionnaire/59') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:52.092190 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_60
[0m23:49:52.092545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:52.095331 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:49:52.095709 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

    
    with ids(ident) as ( values('Questionnaire/60') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:52.095869 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:52.098625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:49:52.100262 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:49:52.100449 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_tmp" rename to "qr_55"
[0m23:49:52.102001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:52.102651 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: COMMIT
[0m23:49:52.102843 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:49:52.103042 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: COMMIT
[0m23:49:52.104199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:52.105429 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_backup"
[0m23:49:52.105711 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_55"
[0m23:49:52.105886 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_55"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_55__dbt_backup" cascade
[0m23:49:52.106423 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:52.107133 [debug] [Thread-1 (]: On model.engage_analytics.qr_55: Close
[0m23:49:52.107427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643c710>]}
[0m23:49:52.107741 [info ] [Thread-1 (]: 44 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_55  [[32mCREATE VIEW[0m in 0.58s]
[0m23:49:52.108017 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_55
[0m23:49:52.108203 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_61
[0m23:49:52.108429 [info ] [Thread-1 (]: 50 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_61 ..... [RUN]
[0m23:49:52.108628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_55, now model.engage_analytics.qr_61)
[0m23:49:52.108794 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_61
[0m23:49:52.111194 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:49:52.111446 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

    
    with ids(ident) as ( values('Questionnaire/61') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:52.111610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:52.577050 [debug] [Thread-4 (]: SQL status: SELECT 91 in 0.543 seconds
[0m23:49:52.583471 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_58"
[0m23:49:52.584120 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_58
[0m23:49:52.586121 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_58"
[0m23:49:52.586862 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:49:52.587080 [debug] [Thread-4 (]: On model.engage_analytics.qr_58: BEGIN
[0m23:49:52.587903 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:52.588180 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:49:52.588907 [debug] [Thread-4 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 2 (id: ipc-58, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '6930d457-7bec-4983-832b-3220b163f505'
        then answer_value_text
      else null
      end
    )
    
      
            as "6930d457-7bec-4983-832b-3220b163f505"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd8e3d6d-e9ff-458d-d122-57070bebffaf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca'
        then answer_value_text
      else null
      end
    )
    
      
            as "f9543e3c-cbff-4d2a-b3df-bf96e509d9ca"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-015'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-015"
      
    
    ,
  
    max(
      
      case
      when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9ed77f2a-0d5a-434d-b153-d8deadfbc3f8"
      
    
    ,
  
    max(
      
      case
      when linkid = '62cd085f-52d4-44de-881c-93058f201559'
        then answer_value_text
      else null
      end
    )
    
      
            as "62cd085f-52d4-44de-881c-93058f201559"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840'
        then answer_value_text
      else null
      end
    )
    
      
            as "a4a9cad5-04db-44e5-9a9d-0f1bf40ca840"
      
    
    ,
  
    max(
      
      case
      when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71'
        then answer_value_text
      else null
      end
    )
    
      
            as "0a15f38b-027a-42ff-b1e8-ca5e2b313f71"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a'
        then answer_value_text
      else null
      end
    )
    
      
            as "e1755ad4-b33a-44a3-b562-4206a582c28a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-month'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-month"
      
    
    ,
  
    max(
      
      case
      when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51'
        then answer_value_text
      else null
      end
    )
    
      
            as "301ae5ab-7dac-4414-a80a-f8784ba6bf51"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10'
        then answer_value_text
      else null
      end
    )
    
      
            as "d8eb3c09-b97d-4d55-9590-e6ce932a7a10"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "a9314459-f6d9-4ebb-84e7-f1a1968cfd7c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'calculated-year'
        then answer_value_text
      else null
      end
    )
    
      
            as "calculated-year"
      
    
    ,
  
    max(
      
      case
      when linkid = 'observation-mood-score-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "observation-mood-score-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e17756cd-4861-4dde-859c-f90241977246'
        then answer_value_text
      else null
      end
    )
    
      
            as "e17756cd-4861-4dde-859c-f90241977246"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083'
        then answer_value_text
      else null
      end
    )
    
      
            as "f39b0b39-2058-4c29-a183-aac5dc70e083"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-016'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-016"
      
    
    ,
  
    max(
      
      case
      when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875'
        then answer_value_text
      else null
      end
    )
    
      
            as "9eac8fed-4265-447f-bbde-0986c34f3875"
      
    
    ,
  
    max(
      
      case
      when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263'
        then answer_value_text
      else null
      end
    )
    
      
            as "86bdafab-bb90-429e-8bc5-a90dc46e7263"
      
    
    ,
  
    max(
      
      case
      when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73'
        then answer_value_text
      else null
      end
    )
    
      
            as "747188c8-4fc0-43ea-92b4-9baa32567f73"
      
    
    ,
  
    max(
      
      case
      when linkid = '547a07c2-f94c-4956-997f-0439626d0251'
        then answer_value_text
      else null
      end
    )
    
      
            as "547a07c2-f94c-4956-997f-0439626d0251"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c'
        then answer_value_text
      else null
      end
    )
    
      
            as "bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c"
      
    
    ,
  
    max(
      
      case
      when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740'
        then answer_value_text
      else null
      end
    )
    
      
            as "2a5d7010-a84b-414c-adcb-ad0f49a95740"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-013'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-013"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097'
        then answer_value_text
      else null
      end
    )
    
      
            as "7ff4b5cb-2c44-434b-90e9-85c61a858097"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef"
      
    
    ,
  
    max(
      
      case
      when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414'
        then answer_value_text
      else null
      end
    )
    
      
            as "83176bb3-c0cb-445a-a91b-6711635b1414"
      
    
    ,
  
    max(
      
      case
      when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90'
        then answer_value_text
      else null
      end
    )
    
      
            as "10cd5560-6c41-41a6-94c5-af74ce96dc90"
      
    
    ,
  
    max(
      
      case
      when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07'
        then answer_value_text
      else null
      end
    )
    
      
            as "85a3f14c-e4d8-4c45-9088-967ec4ea0d07"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb8828db-1674-47e7-ba9a-e3c161160b65"
      
    
    ,
  
    max(
      
      case
      when linkid = '3f63637c-1de2-4851-a088-c3b08152447e'
        then answer_value_text
      else null
      end
    )
    
      
            as "3f63637c-1de2-4851-a088-c3b08152447e"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b80fd6e-3e52-4d1f-aa19-bbfdd912d724"
      
    
    ,
  
    max(
      
      case
      when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3'
        then answer_value_text
      else null
      end
    )
    
      
            as "0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44'
        then answer_value_text
      else null
      end
    )
    
      
            as "eea0b1ca-5582-4b45-b5cf-36bc0665ba44"
      
    
    ,
  
    max(
      
      case
      when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3'
        then answer_value_text
      else null
      end
    )
    
      
            as "94e90f68-ea59-4837-b0ad-452f5f0336c3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299'
        then answer_value_text
      else null
      end
    )
    
      
            as "ac0ade27-9e9a-42a9-8ec6-4e7e79830299"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e0b76f9-0902-43ba-b858-0b1505e9d168"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359'
        then answer_value_text
      else null
      end
    )
    
      
            as "e245b7d9-955a-4c4b-a107-e2bf5d6d2359"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1'
        then answer_value_text
      else null
      end
    )
    
      
            as "a77f07b3-7913-4708-a354-14e503a948f1"
      
    
    ,
  
    max(
      
      case
      when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "5817d327-373e-4fc0-9bac-b64e408b0e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260'
        then answer_value_text
      else null
      end
    )
    
      
            as "52f7924d-1c66-4049-8611-26d4e7bcb260"
      
    
    ,
  
    max(
      
      case
      when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3'
        then answer_value_text
      else null
      end
    )
    
      
            as "50cf6a9c-a837-4531-a13a-47381657c2b3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "c91209cc-1b2c-43f0-83f0-4704418ae2d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '044d9000-1935-4b35-9947-d668de09f10b'
        then answer_value_text
      else null
      end
    )
    
      
            as "044d9000-1935-4b35-9947-d668de09f10b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc8f199a-59f0-4184-864d-b1c0befd26df"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c95559d-86ff-4b87-a271-e52388072a53'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c95559d-86ff-4b87-a271-e52388072a53"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444'
        then answer_value_text
      else null
      end
    )
    
      
            as "e73f462c-e543-4a3d-849d-dbedcb831444"
      
    
    ,
  
    max(
      
      case
      when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a'
        then answer_value_text
      else null
      end
    )
    
      
            as "63ac8d07-518c-4791-849a-a9e2c282ce9a"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe"
      
    
    ,
  
    max(
      
      case
      when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8'
        then answer_value_text
      else null
      end
    )
    
      
            as "9cc2834b-0d28-43d0-8811-509995cfcdb8"
      
    
    ,
  
    max(
      
      case
      when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c'
        then answer_value_text
      else null
      end
    )
    
      
            as "2efaba4d-f5af-45f3-9340-1ba9b3fffc1c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-018'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-018"
      
    
    ,
  
    max(
      
      case
      when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f"
      
    
    ,
  
    max(
      
      case
      when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8'
        then answer_value_text
      else null
      end
    )
    
      
            as "126c7309-8143-4c33-857f-41cc6bed09d8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-014'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-014"
      
    
    ,
  
    max(
      
      case
      when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03'
        then answer_value_text
      else null
      end
    )
    
      
            as "5d0b76c5-a416-45a4-a8fc-9889ea840a03"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f'
        then answer_value_text
      else null
      end
    )
    
      
            as "a7f10195-b859-4670-abbc-a2498c4fe45f"
      
    
    ,
  
    max(
      
      case
      when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a'
        then answer_value_text
      else null
      end
    )
    
      
            as "232484cf-1aee-4bfa-a66e-61494587a16a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "96171fdd-a424-4c09-91e8-31986ac315f7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bed17079-d1e5-4bbe-af07-3d7b6a86243e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-3"
      
    
    ,
  
    max(
      
      case
      when linkid = '665e1595-f169-4815-9d24-dac265f1809b'
        then answer_value_text
      else null
      end
    )
    
      
            as "665e1595-f169-4815-9d24-dac265f1809b"
      
    
    ,
  
    max(
      
      case
      when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21'
        then answer_value_text
      else null
      end
    )
    
      
            as "99079ebd-1665-4503-bb37-8de493dd4a21"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ecd82c04-48de-48ec-8efe-24cbe04cbe4b"
      
    
    ,
  
    max(
      
      case
      when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94'
        then answer_value_text
      else null
      end
    )
    
      
            as "6ff6f541-cb58-48d3-b7eb-24ab667f0a94"
      
    
    ,
  
    max(
      
      case
      when linkid = '287593c3-4174-45af-a998-71d249230943'
        then answer_value_text
      else null
      end
    )
    
      
            as "287593c3-4174-45af-a998-71d249230943"
      
    
    ,
  
    max(
      
      case
      when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc'
        then answer_value_text
      else null
      end
    )
    
      
            as "62c9e3f2-30aa-46b0-9190-aa36a1804fdc"
      
    
    ,
  
    max(
      
      case
      when linkid = '2f9608db-8796-4f45-89b7-741585b8a362'
        then answer_value_text
      else null
      end
    )
    
      
            as "2f9608db-8796-4f45-89b7-741585b8a362"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f82f76f4-648a-453a-916d-28795448a758'
        then answer_value_text
      else null
      end
    )
    
      
            as "f82f76f4-648a-453a-916d-28795448a758"
      
    
    ,
  
    max(
      
      case
      when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a'
        then answer_value_text
      else null
      end
    )
    
      
            as "2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a"
      
    
    ,
  
    max(
      
      case
      when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133'
        then answer_value_text
      else null
      end
    )
    
      
            as "6fb0c7a5-a211-43ec-af7b-5f1079399133"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2'
        then answer_value_text
      else null
      end
    )
    
      
            as "6c0d6638-9b65-4016-b3f0-4008f8e462c2"
      
    
    ,
  
    max(
      
      case
      when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92'
        then answer_value_text
      else null
      end
    )
    
      
            as "6099951a-c965-40f9-ad61-66e7a39a6b92"
      
    
    ,
  
    max(
      
      case
      when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00'
        then answer_value_text
      else null
      end
    )
    
      
            as "0984569b-3fd6-4c4e-a391-e68e73b46f00"
      
    
    ,
  
    max(
      
      case
      when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac'
        then answer_value_text
      else null
      end
    )
    
      
            as "0c9f8c1d-5827-4d21-bd33-3240fade93ac"
      
    
    ,
  
    max(
      
      case
      when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "8feb859b-ec9b-40c9-b576-9519401808ef-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6befba3-6d25-47ae-9cac-409dfae832a2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94'
        then answer_value_text
      else null
      end
    )
    
      
            as "b5bc7f80-4a0c-486c-e5eb-32c750036f94"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93'
        then answer_value_text
      else null
      end
    )
    
      
            as "b93eafea-8b01-4b21-994b-c45113622a93"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92'
        then answer_value_text
      else null
      end
    )
    
      
            as "b31c0187-3e54-4fcf-9763-8b3f3850be92"
      
    
    ,
  
    max(
      
      case
      when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54'
        then answer_value_text
      else null
      end
    )
    
      
            as "3abecf2a-c87b-4fad-96eb-e9abc37e9c54"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:52.595832 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:49:52.597479 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:49:52.597671 [debug] [Thread-4 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_tmp" rename to "qr_58"
[0m23:49:52.599236 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:52.599835 [debug] [Thread-4 (]: On model.engage_analytics.qr_58: COMMIT
[0m23:49:52.600006 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:49:52.600152 [debug] [Thread-4 (]: On model.engage_analytics.qr_58: COMMIT
[0m23:49:52.601142 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:52.603027 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_backup"
[0m23:49:52.603304 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_58"
[0m23:49:52.603468 [debug] [Thread-4 (]: On model.engage_analytics.qr_58: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_58"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_58__dbt_backup" cascade
[0m23:49:52.604088 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:52.604773 [debug] [Thread-4 (]: On model.engage_analytics.qr_58: Close
[0m23:49:52.605057 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062364e0>]}
[0m23:49:52.605352 [info ] [Thread-4 (]: 47 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_58  [[32mCREATE VIEW[0m in 0.57s]
[0m23:49:52.605609 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_58
[0m23:49:52.605903 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_62
[0m23:49:52.606177 [info ] [Thread-4 (]: 51 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_62 ..... [RUN]
[0m23:49:52.606398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_58, now model.engage_analytics.qr_62)
[0m23:49:52.606558 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_62
[0m23:49:52.608852 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:49:52.609120 [debug] [Thread-4 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

    
    with ids(ident) as ( values('Questionnaire/62') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:52.609290 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:52.629988 [debug] [Thread-3 (]: SQL status: SELECT 21 in 0.534 seconds
[0m23:49:52.631885 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_60"
[0m23:49:52.632959 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_60
[0m23:49:52.634913 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_60"
[0m23:49:52.635309 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:49:52.635476 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: BEGIN
[0m23:49:52.636224 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:52.636387 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:49:52.636687 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Short-Form PCL-5-8 (IPC Session 3) (id: ipc-60, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/60') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.27.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.27.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d'
        then answer_value_text
      else null
      end
    )
    
      
            as "cbad1c80-ab95-4720-ba6a-0eadd718905d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4c58005-803f-4bc3-adaa-1f84c5824b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.30.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.30.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49'
        then answer_value_text
      else null
      end
    )
    
      
            as "a51fba17-fccd-4b65-ada3-5c50a75e5d49"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.29.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.29.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.28.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.28.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'encounter-id'
        then answer_value_text
      else null
      end
    )
    
      
            as "encounter-id"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.26.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.26.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ptsd'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ptsd"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17'
        then answer_value_text
      else null
      end
    )
    
      
            as "f5002611-caf9-4792-8d10-e7870459ea17"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e'
        then answer_value_text
      else null
      end
    )
    
      
            as "ea00e468-9c26-4a1c-a0af-1b72923b1e2e"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:52.639675 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:52.641292 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:49:52.641495 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_tmp" rename to "qr_60"
[0m23:49:52.642508 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:52.643140 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: COMMIT
[0m23:49:52.643354 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:49:52.643505 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: COMMIT
[0m23:49:52.644379 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:52.645612 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_backup"
[0m23:49:52.645897 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_60"
[0m23:49:52.646064 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_60"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_60__dbt_backup" cascade
[0m23:49:52.646806 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:52.647549 [debug] [Thread-3 (]: On model.engage_analytics.qr_60: Close
[0m23:49:52.647835 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.555 seconds
[0m23:49:52.648220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062898e0>]}
[0m23:49:52.649438 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_59"
[0m23:49:52.649887 [info ] [Thread-3 (]: 49 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_60  [[32mCREATE VIEW[0m in 0.56s]
[0m23:49:52.650385 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_60
[0m23:49:52.650598 [debug] [Thread-3 (]: Began running node model.engage_analytics.qr_63
[0m23:49:52.650798 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_59
[0m23:49:52.651103 [info ] [Thread-3 (]: 52 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_63 ..... [RUN]
[0m23:49:52.653263 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_59"
[0m23:49:52.653559 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_60, now model.engage_analytics.qr_63)
[0m23:49:52.653835 [debug] [Thread-3 (]: Began compiling node model.engage_analytics.qr_63
[0m23:49:52.656088 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:49:52.656284 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:52.656514 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:49:52.656861 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:49:52.657025 [debug] [Thread-2 (]: On model.engage_analytics.qr_59: BEGIN
[0m23:49:52.657741 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:52.657932 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:49:52.658190 [debug] [Thread-2 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 3) (id: ipc-59, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/59') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402'
        then answer_value_text
      else null
      end
    )
    
      
            as "d34c5839-fad9-4824-b2dc-9e0161647402"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = '534c4998-b964-4101-b919-ff3c26af9714'
        then answer_value_text
      else null
      end
    )
    
      
            as "534c4998-b964-4101-b919-ff3c26af9714"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:52.658921 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.547 seconds
[0m23:49:52.660388 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_61"
[0m23:49:52.660844 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_61
[0m23:49:52.663455 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_61"
[0m23:49:52.663853 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:52.665482 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:49:52.665683 [debug] [Thread-2 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_tmp" rename to "qr_59"
[0m23:49:52.665994 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:49:52.666172 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: BEGIN
[0m23:49:52.666561 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:52.666754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:52.667353 [debug] [Thread-2 (]: On model.engage_analytics.qr_59: COMMIT
[0m23:49:52.667560 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:49:52.667729 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:49:52.667988 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- PHQ-9 (IPC Session 3) (id: ipc-61, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/61') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1'
        then answer_value_text
      else null
      end
    )
    
      
            as "45f52042-6802-4d9c-9f86-6578923d0fd1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9'
        then answer_value_text
      else null
      end
    )
    
      
            as "4650a511-2184-4b0b-9e43-54f45f4340a9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e'
        then answer_value_text
      else null
      end
    )
    
      
            as "55d78cf4-0963-4c44-af44-6004a8abbb3e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:52.668238 [debug] [Thread-2 (]: On model.engage_analytics.qr_59: COMMIT
[0m23:49:52.669285 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:52.670420 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_backup"
[0m23:49:52.670777 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_59"
[0m23:49:52.670947 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:52.671121 [debug] [Thread-2 (]: On model.engage_analytics.qr_59: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_59"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_59__dbt_backup" cascade
[0m23:49:52.672546 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:49:52.672756 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_tmp" rename to "qr_61"
[0m23:49:52.673155 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:52.673796 [debug] [Thread-2 (]: On model.engage_analytics.qr_59: Close
[0m23:49:52.673971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:52.674581 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: COMMIT
[0m23:49:52.674769 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:49:52.674920 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: COMMIT
[0m23:49:52.675192 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062da9f0>]}
[0m23:49:52.675521 [info ] [Thread-2 (]: 48 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_59  [[32mCREATE VIEW[0m in 0.59s]
[0m23:49:52.675876 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_59
[0m23:49:52.676046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:52.676223 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_69
[0m23:49:52.677359 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_backup"
[0m23:49:52.677596 [info ] [Thread-2 (]: 53 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_69 ..... [RUN]
[0m23:49:52.677896 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_61"
[0m23:49:52.678079 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_59, now model.engage_analytics.qr_69)
[0m23:49:52.678248 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_61"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_61__dbt_backup" cascade
[0m23:49:52.678407 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_69
[0m23:49:52.680833 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:49:52.681070 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:52.681383 [debug] [Thread-2 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

    
    with ids(ident) as ( values('Questionnaire/69') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:52.682203 [debug] [Thread-1 (]: On model.engage_analytics.qr_61: Close
[0m23:49:52.682439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:52.682828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624bd70>]}
[0m23:49:52.683222 [info ] [Thread-1 (]: 50 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_61  [[32mCREATE VIEW[0m in 0.57s]
[0m23:49:52.683510 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_61
[0m23:49:52.683711 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:49:52.684124 [info ] [Thread-1 (]: 54 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_q_common_mental_health_symptoms  [RUN]
[0m23:49:52.684418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_61, now model.engage_analytics.qr_q_common_mental_health_symptoms)
[0m23:49:52.684601 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:49:52.686974 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:49:52.687187 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

    
    with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:52.687354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:53.153082 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.544 seconds
[0m23:49:53.157653 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_62"
[0m23:49:53.158621 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_62
[0m23:49:53.160814 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_62"
[0m23:49:53.161289 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:49:53.161468 [debug] [Thread-4 (]: On model.engage_analytics.qr_62: BEGIN
[0m23:49:53.162213 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:53.162374 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:49:53.162607 [debug] [Thread-4 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- GAD-7 (IPC Session 4) (id: ipc-62, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/62') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c'
        then answer_value_text
      else null
      end
    )
    
      
            as "3e626219-c0e4-465e-92e6-9e976c52614c"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9'
        then answer_value_text
      else null
      end
    )
    
      
            as "3212b2b2-f42f-46e9-b6bd-42fc29671da9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e4155e07-1d18-448f-8111-182bf4149672'
        then answer_value_text
      else null
      end
    )
    
      
            as "e4155e07-1d18-448f-8111-182bf4149672"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:53.165201 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:53.166847 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:49:53.167044 [debug] [Thread-4 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_tmp" rename to "qr_62"
[0m23:49:53.168042 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:53.168807 [debug] [Thread-4 (]: On model.engage_analytics.qr_62: COMMIT
[0m23:49:53.169013 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:49:53.169170 [debug] [Thread-4 (]: On model.engage_analytics.qr_62: COMMIT
[0m23:49:53.170074 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:53.172331 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_backup"
[0m23:49:53.172643 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_62"
[0m23:49:53.172814 [debug] [Thread-4 (]: On model.engage_analytics.qr_62: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_62"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_62__dbt_backup" cascade
[0m23:49:53.173502 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:53.174240 [debug] [Thread-4 (]: On model.engage_analytics.qr_62: Close
[0m23:49:53.174530 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106475a30>]}
[0m23:49:53.174887 [info ] [Thread-4 (]: 51 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_62  [[32mCREATE VIEW[0m in 0.57s]
[0m23:49:53.175155 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_62
[0m23:49:53.175344 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:49:53.175542 [info ] [Thread-4 (]: 55 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_q_financial_wellness_tool  [RUN]
[0m23:49:53.175809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_62, now model.engage_analytics.qr_q_financial_wellness_tool)
[0m23:49:53.175993 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:49:53.178368 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:49:53.178597 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

    
    with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:53.178768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:49:53.197656 [debug] [Thread-3 (]: SQL status: SELECT 42 in 0.541 seconds
[0m23:49:53.199963 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_63"
[0m23:49:53.200351 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.518 seconds
[0m23:49:53.201487 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_69"
[0m23:49:53.201838 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_63
[0m23:49:53.203857 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_63"
[0m23:49:53.204141 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_69
[0m23:49:53.206118 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_69"
[0m23:49:53.206466 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:49:53.206718 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: BEGIN
[0m23:49:53.206952 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:49:53.207144 [debug] [Thread-2 (]: On model.engage_analytics.qr_69: BEGIN
[0m23:49:53.207396 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:53.207637 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:49:53.207834 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:53.208312 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- IPC Session 4 (id: ipc-63, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b-4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-connected-to-clinical-care-details'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-connected-to-clinical-care-details"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-connected-to-clinical-care-question'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-connected-to-clinical-care-question"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de'
        then answer_value_text
      else null
      end
    )
    
      
            as "b46d08e9-6af9-47be-a09a-afd0cfdf41de"
      
    
    ,
  
    max(
      
      case
      when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850'
        then answer_value_text
      else null
      end
    )
    
      
            as "0b12311e-d9a3-40b4-bb18-5cc6135a3850"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa8d0648-9550-489a-9543-4f00d43ba1fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490'
        then answer_value_text
      else null
      end
    )
    
      
            as "e67ca22d-e803-4790-bbce-126f2c863490"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "cb8337b0-c822-4374-895b-ee875da4d7f6"
      
    
    ,
  
    max(
      
      case
      when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc'
        then answer_value_text
      else null
      end
    )
    
      
            as "978ba6cf-b149-49e2-89c3-89a0e18461bc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588'
        then answer_value_text
      else null
      end
    )
    
      
            as "4602f806-3bf4-4f16-bee1-c2e690dca588"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b'
        then answer_value_text
      else null
      end
    )
    
      
            as "a3831bfc-0175-4e5a-8d8d-7313c7f2b69b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6'
        then answer_value_text
      else null
      end
    )
    
      
            as "a8c2cacf-7ee5-4076-af42-19d0eba0e6d6"
      
    
    ,
  
    max(
      
      case
      when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef'
        then answer_value_text
      else null
      end
    )
    
      
            as "3ce3bf84-176e-40bc-8075-1517a03c6bef"
      
    
    ,
  
    max(
      
      case
      when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "39dfd1f4-01db-4057-9734-4f2fbd83b8fe"
      
    
    ,
  
    max(
      
      case
      when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656'
        then answer_value_text
      else null
      end
    )
    
      
            as "91e7579d-ac74-4d72-955b-1a3675a2e656"
      
    
    ,
  
    max(
      
      case
      when linkid = '749d2a97-4195-4516-8079-60638a4d9e82'
        then answer_value_text
      else null
      end
    )
    
      
            as "749d2a97-4195-4516-8079-60638a4d9e82"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc'
        then answer_value_text
      else null
      end
    )
    
      
            as "ca41ccab-5f0b-4538-b394-ad342a0b5bdc"
      
    
    ,
  
    max(
      
      case
      when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22'
        then answer_value_text
      else null
      end
    )
    
      
            as "4c457ea8-c60d-49f7-b166-ebabf737ab22"
      
    
    ,
  
    max(
      
      case
      when linkid = '7db481df-19e5-400c-a206-4811b39485d5'
        then answer_value_text
      else null
      end
    )
    
      
            as "7db481df-19e5-400c-a206-4811b39485d5"
      
    
    ,
  
    max(
      
      case
      when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99'
        then answer_value_text
      else null
      end
    )
    
      
            as "936d5c53-d176-4c63-9a3a-e9e7f9db3f99"
      
    
    ,
  
    max(
      
      case
      when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f'
        then answer_value_text
      else null
      end
    )
    
      
            as "19dd65c2-8709-4745-81f2-4d4843c4307f"
      
    
    ,
  
    max(
      
      case
      when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318'
        then answer_value_text
      else null
      end
    )
    
      
            as "7fef53bc-56db-47ce-8cba-8efd4bcbc318"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a302513b-141a-4316-9546-d013212a361e'
        then answer_value_text
      else null
      end
    )
    
      
            as "a302513b-141a-4316-9546-d013212a361e"
      
    
    ,
  
    max(
      
      case
      when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0'
        then answer_value_text
      else null
      end
    )
    
      
            as "6d9345d7-61a0-425b-8496-8b08d68175d0"
      
    
    ,
  
    max(
      
      case
      when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74'
        then answer_value_text
      else null
      end
    )
    
      
            as "49a270cd-b72b-42a6-92e3-c139f7a85d74"
      
    
    ,
  
    max(
      
      case
      when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036'
        then answer_value_text
      else null
      end
    )
    
      
            as "dd000285-7c36-44b4-82e6-4e8826665036"
      
    
    ,
  
    max(
      
      case
      when linkid = '7b65857a-5c04-4414-833d-10602f04d299'
        then answer_value_text
      else null
      end
    )
    
      
            as "7b65857a-5c04-4414-833d-10602f04d299"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.33.6'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.33.6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532'
        then answer_value_text
      else null
      end
    )
    
      
            as "ec39511c-de47-469d-ac44-973e3fc08532"
      
    
    ,
  
    max(
      
      case
      when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d'
        then answer_value_text
      else null
      end
    )
    
      
            as "aa30ce6c-4153-46d8-a4af-83012eafa23d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5899d3e-d8fc-4931-91c8-383f51474a5b"
      
    
    ,
  
    max(
      
      case
      when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19'
        then answer_value_text
      else null
      end
    )
    
      
            as "9b602b02-e5f9-4795-9fb9-fc7ae4353a19"
      
    
    ,
  
    max(
      
      case
      when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7'
        then answer_value_text
      else null
      end
    )
    
      
            as "83a63af9-6f49-4fad-bca9-80776fc97be7"
      
    
    ,
  
    max(
      
      case
      when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de'
        then answer_value_text
      else null
      end
    )
    
      
            as "9a02423f-9848-4254-b427-3dfa8819d0de"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3e46a84-9743-4506-9465-43fa16460e16"
      
    
    ,
  
    max(
      
      case
      when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824'
        then answer_value_text
      else null
      end
    )
    
      
            as "05617430-b835-4ebd-8d6a-ff58ef6d2824"
      
    
    ,
  
    max(
      
      case
      when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe'
        then answer_value_text
      else null
      end
    )
    
      
            as "9848888d-1ec0-4d43-b53f-7613ba5144fe"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2"
      
    
    ,
  
    max(
      
      case
      when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018'
        then answer_value_text
      else null
      end
    )
    
      
            as "4e9014d1-e07c-492e-897a-3bf7e8f6f018"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:53.208821 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:49:53.209195 [debug] [Thread-2 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- eCBIS Remove Family Form (id: ipc-69, url: n/a, version: 0.0.2)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/69') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f'
        then answer_value_text
      else null
      end
    )
    
      
            as "17b7fda5-514c-4408-88e7-52313ab0ef2f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-birthdate'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-birthdate"
      
    
    ,
  
    max(
      
      case
      when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "98ac4694-590e-4cc2-83f3-cc6455e688c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a'
        then answer_value_text
      else null
      end
    )
    
      
            as "8489d249-1ef3-4edb-aa99-b5713fd2cb0a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd73cfdf-6d70-4b42-8887-21e27db0b9ec"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b'
        then answer_value_text
      else null
      end
    )
    
      
            as "a11ebb0d-acb3-4038-956b-293a41acb85b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff'
        then answer_value_text
      else null
      end
    )
    
      
            as "f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1'
        then answer_value_text
      else null
      end
    )
    
      
            as "b6c21488-87b8-4213-8cd0-d482367669c1"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:53.212619 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:53.212879 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:49:53.214604 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:49:53.216317 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:49:53.216620 [debug] [Thread-2 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_tmp" rename to "qr_69"
[0m23:49:53.216863 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_tmp" rename to "qr_63"
[0m23:49:53.217696 [debug] [Thread-1 (]: SQL status: SELECT 36 in 0.530 seconds
[0m23:49:53.217896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:53.219844 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:49:53.220038 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:49:53.220726 [debug] [Thread-2 (]: On model.engage_analytics.qr_69: COMMIT
[0m23:49:53.221573 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: COMMIT
[0m23:49:53.221824 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:49:53.222059 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:49:53.222314 [debug] [Thread-2 (]: On model.engage_analytics.qr_69: COMMIT
[0m23:49:53.222519 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:49:53.222660 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: COMMIT
[0m23:49:53.225302 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:49:53.225556 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:49:53.226738 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_backup"
[0m23:49:53.226941 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:53.227211 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_69"
[0m23:49:53.228281 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_backup"
[0m23:49:53.228501 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:49:53.228661 [debug] [Thread-2 (]: On model.engage_analytics.qr_69: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_69"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_69__dbt_backup" cascade
[0m23:49:53.228994 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_63"
[0m23:49:53.229197 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: BEGIN
[0m23:49:53.229410 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_63"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_63__dbt_backup" cascade
[0m23:49:53.229851 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:53.230067 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:53.230813 [debug] [Thread-2 (]: On model.engage_analytics.qr_69: Close
[0m23:49:53.230995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:53.231559 [debug] [Thread-3 (]: On model.engage_analytics.qr_63: Close
[0m23:49:53.231910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623b5f0>]}
[0m23:49:53.232114 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:49:53.232492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c1c70>]}
[0m23:49:53.233168 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Common Mental Health Symptoms (id: q-common-mental-health-symptoms, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55'
        then answer_value_text
      else null
      end
    )
    
      
            as "68bec639-6c70-41e0-88f8-fef0ad941b55"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.19.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.19.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4b3bbcc-6d23-45e1-9755-1aa0bfc1b646"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879'
        then answer_value_text
      else null
      end
    )
    
      
            as "b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879"
      
    
    ,
  
    max(
      
      case
      when linkid = '16d05294-fee9-4d42-8447-0d578a5de192'
        then answer_value_text
      else null
      end
    )
    
      
            as "16d05294-fee9-4d42-8447-0d578a5de192"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.8.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.8.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.7.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.7.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.18.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.18.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8'
        then answer_value_text
      else null
      end
    )
    
      
            as "e13d2bb9-20a6-4605-a33f-5d9047f6b6a8"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.21.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.21.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603'
        then answer_value_text
      else null
      end
    )
    
      
            as "829e6d32-3fa7-4d16-909b-b198aea54603"
      
    
    ,
  
    max(
      
      case
      when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "eb42041c-cb74-4d5e-8a29-941776cc0b6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.10.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.10.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.20.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.20.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.3.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.3.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122'
        then answer_value_text
      else null
      end
    )
    
      
            as "6a52200c-3856-4fcc-afe4-b75921da0122"
      
    
    ,
  
    max(
      
      case
      when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3'
        then answer_value_text
      else null
      end
    )
    
      
            as "9c366bcc-38c8-449f-8823-8a1632f44da3"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-common-mental-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-common-mental-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.11.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.11.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.5.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.5.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10'
        then answer_value_text
      else null
      end
    )
    
      
            as "b4f73ad2-ed7a-4268-9057-a4a72b50dd10"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.17.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.17.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "5bc16477-41ff-485f-a73f-f0caa9c2c0ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.9.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.9.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.16.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.16.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.4.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.4.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "583c5b02-b26c-4821-8da8-7ed9066d9d5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.15.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.15.1"
      
    
    ,
  
    max(
      
      case
      when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c'
        then answer_value_text
      else null
      end
    )
    
      
            as "4a05b4fe-b514-4751-91be-adb1b278430c"
      
    
    ,
  
    max(
      
      case
      when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb'
        then answer_value_text
      else null
      end
    )
    
      
            as "532fcdbc-38b7-4a35-870c-1d5222e239fb"
      
    
    ,
  
    max(
      
      case
      when linkid = '347352fc-b189-444a-aa22-df4d9e779f67'
        then answer_value_text
      else null
      end
    )
    
      
            as "347352fc-b189-444a-aa22-df4d9e779f67"
      
    
    ,
  
    max(
      
      case
      when linkid = 'show-pcl-5-to-8-questions'
        then answer_value_text
      else null
      end
    )
    
      
            as "show-pcl-5-to-8-questions"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1.6.1'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1.6.1"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:53.232784 [info ] [Thread-2 (]: 53 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_69  [[32mCREATE VIEW[0m in 0.55s]
[0m23:49:53.234309 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_69
[0m23:49:53.234574 [debug] [Thread-2 (]: Began running node model.engage_analytics.qr_q_planning_next_steps
[0m23:49:53.234809 [info ] [Thread-2 (]: 56 of 56 START sql view model engage_analytics_engage_analytics_mart.qr_q_planning_next_steps  [RUN]
[0m23:49:53.235037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_69, now model.engage_analytics.qr_q_planning_next_steps)
[0m23:49:53.235570 [debug] [Thread-2 (]: Began compiling node model.engage_analytics.qr_q_planning_next_steps
[0m23:49:53.237901 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:49:53.238151 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

    
    with ids(ident) as ( values('Questionnaire/q-planning-next-steps') )
    select distinct a.linkid
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
  
  
[0m23:49:53.238338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:49:53.238542 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:53.240280 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:49:53.240517 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_tmp" rename to "qr_q_common_mental_health_symptoms"
[0m23:49:53.241737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:53.242442 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: COMMIT
[0m23:49:53.242623 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:49:53.242774 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: COMMIT
[0m23:49:53.243571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:53.244809 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_backup"
[0m23:49:53.245123 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_q_common_mental_health_symptoms"
[0m23:49:53.245300 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_common_mental_health_symptoms"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_common_mental_health_symptoms__dbt_backup" cascade
[0m23:49:53.245803 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:53.246550 [debug] [Thread-1 (]: On model.engage_analytics.qr_q_common_mental_health_symptoms: Close
[0m23:49:53.246866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1fd0>]}
[0m23:49:53.321903 [debug] [Thread-3 (]: An error was encountered while trying to send an event
[0m23:49:53.322325 [info ] [Thread-1 (]: 54 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_common_mental_health_symptoms  [[32mCREATE VIEW[0m in 0.56s]
[0m23:49:53.322761 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_q_common_mental_health_symptoms
[0m23:49:53.323097 [info ] [Thread-3 (]: 52 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_63  [[32mCREATE VIEW[0m in 0.58s]
[0m23:49:53.323393 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_63
[0m23:49:53.703305 [debug] [Thread-4 (]: SQL status: SELECT 23 in 0.524 seconds
[0m23:49:53.708065 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:49:53.708680 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:49:53.710654 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:49:53.711609 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:49:53.711793 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_financial_wellness_tool: BEGIN
[0m23:49:53.712556 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:49:53.712825 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:49:53.713154 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Financial Wellness Tool (id: q-financial-wellness-tool, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = 'moderate-housing-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-housing-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'overall-financial-hardship'
        then answer_value_text
      else null
      end
    )
    
      
            as "overall-financial-hardship"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-medical-hardships'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-medical-hardships"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "cdef0123-4567-89ab-cdef-0123456789ab"
      
    
    ,
  
    max(
      
      case
      when linkid = '51234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "51234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '31234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "31234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '91234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "91234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-housing-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-housing-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-food-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-food-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-debt'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-debt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f1234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "f1234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c1234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "c1234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'high-paying-bills'
        then answer_value_text
      else null
      end
    )
    
      
            as "high-paying-bills"
      
    
    ,
  
    max(
      
      case
      when linkid = '3456789a-bcde-f012-3456-789abcdef012'
        then answer_value_text
      else null
      end
    )
    
      
            as "3456789a-bcde-f012-3456-789abcdef012"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-debt'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-debt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-food-insecurity'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-food-insecurity"
      
    
    ,
  
    max(
      
      case
      when linkid = '61234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "61234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = '6789abcd-ef01-2345-6789-abcdef012345'
        then answer_value_text
      else null
      end
    )
    
      
            as "6789abcd-ef01-2345-6789-abcdef012345"
      
    
    ,
  
    max(
      
      case
      when linkid = '21234567-89ab-cdef-0123-456789abcdef'
        then answer_value_text
      else null
      end
    )
    
      
            as "21234567-89ab-cdef-0123-456789abcdef"
      
    
    ,
  
    max(
      
      case
      when linkid = 'no-financial-hardship'
        then answer_value_text
      else null
      end
    )
    
      
            as "no-financial-hardship"
      
    
    ,
  
    max(
      
      case
      when linkid = 'moderate-paying-bills'
        then answer_value_text
      else null
      end
    )
    
      
            as "moderate-paying-bills"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f0123456-789a-bcde-f012-3456789abcde'
        then answer_value_text
      else null
      end
    )
    
      
            as "f0123456-789a-bcde-f012-3456789abcde"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:53.716263 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:49:53.717940 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:49:53.718143 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_tmp" rename to "qr_q_financial_wellness_tool"
[0m23:49:53.719104 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:53.719792 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_financial_wellness_tool: COMMIT
[0m23:49:53.719985 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:49:53.720147 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_financial_wellness_tool: COMMIT
[0m23:49:53.721071 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:53.723102 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_backup"
[0m23:49:53.723372 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_q_financial_wellness_tool"
[0m23:49:53.723542 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_financial_wellness_tool: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_financial_wellness_tool"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_financial_wellness_tool__dbt_backup" cascade
[0m23:49:53.724120 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:53.724945 [debug] [Thread-4 (]: On model.engage_analytics.qr_q_financial_wellness_tool: Close
[0m23:49:53.725249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106475670>]}
[0m23:49:53.725570 [info ] [Thread-4 (]: 55 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_financial_wellness_tool  [[32mCREATE VIEW[0m in 0.55s]
[0m23:49:53.725842 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_q_financial_wellness_tool
[0m23:49:53.760345 [debug] [Thread-2 (]: SQL status: SELECT 66 in 0.522 seconds
[0m23:49:53.763265 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_q_planning_next_steps"
[0m23:49:53.764558 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_q_planning_next_steps
[0m23:49:53.766474 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_q_planning_next_steps"
[0m23:49:53.767201 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:49:53.767372 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_planning_next_steps: BEGIN
[0m23:49:53.767955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:53.768138 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:49:53.768703 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"

-- Planning Next Steps (id: q-planning-next-steps, url: n/a, version: 0.0.1)




  
  

  
  

  
  

  
  
    
  

  
  

  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,
      
  
    max(
      
      case
      when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d'
        then answer_value_text
      else null
      end
    )
    
      
            as "2cb66889-3c74-40ff-be3d-183fdb17ce2d"
      
    
    ,
  
    max(
      
      case
      when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d'
        then answer_value_text
      else null
      end
    )
    
      
            as "3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd34f5b1-8dff-4fd1-b1a0-a1356789abcd"
      
    
    ,
  
    max(
      
      case
      when linkid = '69712544-6237-4962-a455-ee6e9ee80000'
        then answer_value_text
      else null
      end
    )
    
      
            as "69712544-6237-4962-a455-ee6e9ee80000"
      
    
    ,
  
    max(
      
      case
      when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7'
        then answer_value_text
      else null
      end
    )
    
      
            as "12894a06-d244-4426-06f5-f2a3b4c5d6e7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-age'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-age"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae'
        then answer_value_text
      else null
      end
    )
    
      
            as "4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt-optional'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt-optional"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-other-services-outside-agency'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-other-services-outside-agency"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt-main'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt-main"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc23e4a0-7cee-4ec0-a09f-902456789abc"
      
    
    ,
  
    max(
      
      case
      when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7'
        then answer_value_text
      else null
      end
    )
    
      
            as "1d2fdd10-a4d1-43e0-8042-8772146e63f7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'fe874736-efd1-4fba-b517-5560489729b0'
        then answer_value_text
      else null
      end
    )
    
      
            as "fe874736-efd1-4fba-b517-5560489729b0"
      
    
    ,
  
    max(
      
      case
      when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a'
        then answer_value_text
      else null
      end
    )
    
      
            as "de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-002'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-002"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i'
        then answer_value_text
      else null
      end
    )
    
      
            as "f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7'
        then answer_value_text
      else null
      end
    )
    
      
            as "e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7"
      
    
    ,
  
    max(
      
      case
      when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7'
        then answer_value_text
      else null
      end
    )
    
      
            as "45b67d39-0577-4759-3928-52c3d4e5f6a7"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-000'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-000"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-003'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-003"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100'
        then answer_value_text
      else null
      end
    )
    
      
            as "f4e3d2c1-b0a9-4988-7766-554433221100"
      
    
    ,
  
    max(
      
      case
      when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01'
        then answer_value_text
      else null
      end
    )
    
      
            as "34ab6c28-f466-4648-2817-1eacbdcedf01"
      
    
    ,
  
    max(
      
      case
      when linkid = 'scheduled-ipc-session-1-with-current-time'
        then answer_value_text
      else null
      end
    )
    
      
            as "scheduled-ipc-session-1-with-current-time"
      
    
    ,
  
    max(
      
      case
      when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123'
        then answer_value_text
      else null
      end
    )
    
      
            as "45bc7d39-0577-4759-3928-2fbdcedf0123"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc-main'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc-main"
      
    
    ,
  
    max(
      
      case
      when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e'
        then answer_value_text
      else null
      end
    )
    
      
            as "bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc"
      
    
    ,
  
    max(
      
      case
      when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf'
        then answer_value_text
      else null
      end
    )
    
      
            as "5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f'
        then answer_value_text
      else null
      end
    )
    
      
            as "c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f"
      
    
    ,
  
    max(
      
      case
      when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d'
        then answer_value_text
      else null
      end
    )
    
      
            as "9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4"
      
    
    ,
  
    max(
      
      case
      when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e'
        then answer_value_text
      else null
      end
    )
    
      
            as "76ba8dbe-5456-4de4-bdde-4b8059ecfa0e"
      
    
    ,
  
    max(
      
      case
      when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106'
        then answer_value_text
      else null
      end
    )
    
      
            as "950d904a-da1a-4ccd-988d-ea6b463ee106"
      
    
    ,
  
    max(
      
      case
      when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h'
        then answer_value_text
      else null
      end
    )
    
      
            as "e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a'
        then answer_value_text
      else null
      end
    )
    
      
            as "d0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-004'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-004"
      
    
    ,
  
    max(
      
      case
      when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e'
        then answer_value_text
      else null
      end
    )
    
      
            as "b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-spi'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-spi"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-planning-next-steps-pdf'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-planning-next-steps-pdf"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab'
        then answer_value_text
      else null
      end
    )
    
      
            as "ab12d39f-6bdd-4dbf-9f8e-8f13456789ab"
      
    
    ,
  
    max(
      
      case
      when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90'
        then answer_value_text
      else null
      end
    )
    
      
            as "de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90"
      
    
    ,
  
    max(
      
      case
      when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6'
        then answer_value_text
      else null
      end
    )
    
      
            as "34a56c28-f466-4648-2817-41b2c3d4e5f6"
      
    
    ,
  
    max(
      
      case
      when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b'
        then answer_value_text
      else null
      end
    )
    
      
            as "ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-name'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-name"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-sbirt'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-sbirt"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-006'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-006"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-fws'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-fws"
      
    
    ,
  
    max(
      
      case
      when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f'
        then answer_value_text
      else null
      end
    )
    
      
            as "cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f"
      
    
    ,
  
    max(
      
      case
      when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574'
        then answer_value_text
      else null
      end
    )
    
      
            as "9311146c-720d-47f6-b902-aeecaf3c0574"
      
    
    ,
  
    max(
      
      case
      when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f'
        then answer_value_text
      else null
      end
    )
    
      
            as "256b56d8-c4c2-4313-9e2d-6720941be85f"
      
    
    ,
  
    max(
      
      case
      when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g'
        then answer_value_text
      else null
      end
    )
    
      
            as "d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g"
      
    
    ,
  
    max(
      
      case
      when linkid = 'financial-hardships-list'
        then answer_value_text
      else null
      end
    )
    
      
            as "financial-hardships-list"
      
    
    ,
  
    max(
      
      case
      when linkid = 'scheduled-ipc-session-1-with-current-time-2'
        then answer_value_text
      else null
      end
    )
    
      
            as "scheduled-ipc-session-1-with-current-time-2"
      
    
    ,
  
    max(
      
      case
      when linkid = 'task-id-001'
        then answer_value_text
      else null
      end
    )
    
      
            as "task-id-001"
      
    
    ,
  
    max(
      
      case
      when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4'
        then answer_value_text
      else null
      end
    )
    
      
            as "c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-mhs'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-mhs"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-other-agency-services'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-other-agency-services"
      
    
    ,
  
    max(
      
      case
      when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f'
        then answer_value_text
      else null
      end
    )
    
      
            as "3d373ba7-14fa-43bb-bd27-52fad3d2783f"
      
    
    ,
  
    max(
      
      case
      when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345'
        then answer_value_text
      else null
      end
    )
    
      
            as "56cd8e4a-1688-486a-4a39-3acedf012345"
      
    
    ,
  
    max(
      
      case
      when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5'
        then answer_value_text
      else null
      end
    )
    
      
            as "f06728e4-b022-4204-e4d3-d0e1f2a3b4c5"
      
    
    ,
  
    max(
      
      case
      when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9'
        then answer_value_text
      else null
      end
    )
    
      
            as "34ab6c28-f466-4648-2817-14c5d6e7f8a9"
      
    
    ,
  
    max(
      
      case
      when linkid = 'is-ipc-optional'
        then answer_value_text
      else null
      end
    )
    
      
            as "is-ipc-optional"
      
    
    ,
  
    max(
      
      case
      when linkid = 'patient-dob'
        then answer_value_text
      else null
      end
    )
    
      
            as "patient-dob"
      
    
    
  

    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m23:49:53.773731 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:49:53.775154 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:49:53.775335 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_tmp" rename to "qr_q_planning_next_steps"
[0m23:49:53.776500 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:53.777084 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_planning_next_steps: COMMIT
[0m23:49:53.777261 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:49:53.777414 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_planning_next_steps: COMMIT
[0m23:49:53.778390 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:53.779560 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_backup"
[0m23:49:53.779816 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_q_planning_next_steps"
[0m23:49:53.779991 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_planning_next_steps: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_q_planning_next_steps"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_q_planning_next_steps__dbt_backup" cascade
[0m23:49:53.780494 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:53.781081 [debug] [Thread-2 (]: On model.engage_analytics.qr_q_planning_next_steps: Close
[0m23:49:53.781348 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117b45e2-15ca-4f45-b021-bed3561bfbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a62a0>]}
[0m23:49:53.781724 [info ] [Thread-2 (]: 56 of 56 OK created sql view model engage_analytics_engage_analytics_mart.qr_q_planning_next_steps  [[32mCREATE VIEW[0m in 0.55s]
[0m23:49:53.782019 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_q_planning_next_steps
[0m23:49:53.782744 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:53.782891 [debug] [MainThread]: On master: BEGIN
[0m23:49:53.783040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:53.789957 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:49:53.790189 [debug] [MainThread]: On master: COMMIT
[0m23:49:53.790334 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:53.790463 [debug] [MainThread]: On master: COMMIT
[0m23:49:53.790921 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:53.791110 [debug] [MainThread]: On master: Close
[0m23:49:53.791340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:53.791483 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_common_mental_health_symptoms' was properly closed.
[0m23:49:53.791603 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_planning_next_steps' was properly closed.
[0m23:49:53.791717 [debug] [MainThread]: Connection 'model.engage_analytics.qr_63' was properly closed.
[0m23:49:53.791829 [debug] [MainThread]: Connection 'model.engage_analytics.qr_q_financial_wellness_tool' was properly closed.
[0m23:49:53.792080 [info ] [MainThread]: 
[0m23:49:53.792249 [info ] [MainThread]: Finished running 18 incremental models, 38 view models in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m23:49:53.795305 [debug] [MainThread]: Command end result
[0m23:49:53.821539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m23:49:53.822919 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m23:49:53.831241 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m23:49:53.831478 [info ] [MainThread]: 
[0m23:49:53.831698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:53.831887 [info ] [MainThread]: 
[0m23:49:53.832062 [info ] [MainThread]: Done. PASS=56 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=56
[0m23:49:53.832475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6760526, "process_in_blocks": "0", "process_kernel_time": 0.297206, "process_mem_max_rss": "139214848", "process_out_blocks": "0", "process_user_time": 2.445417}
[0m23:49:53.832733 [debug] [MainThread]: Command `dbt run` succeeded at 23:49:53.832686 after 6.68 seconds
[0m23:49:53.832946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e64fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e65010>]}
[0m23:49:53.833158 [debug] [MainThread]: Flushing usage events
[0m23:49:53.891425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:16.789478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083eeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109848fb0>]}


============================== 00:06:16.793803 | 3d257f6c-4a5c-409c-91bd-7315b20ac10b ==============================
[0m00:06:16.793803 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:06:16.794156 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt seed --profiles-dir .', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'profiles_dir': '.', 'cache_selected_only': 'False', 'empty': 'None', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m00:06:16.902048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d257f6c-4a5c-409c-91bd-7315b20ac10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddaea0>]}
[0m00:06:16.934798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d257f6c-4a5c-409c-91bd-7315b20ac10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10964b440>]}
[0m00:06:16.935661 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:06:16.993097 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:06:17.039909 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:06:17.040242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d257f6c-4a5c-409c-91bd-7315b20ac10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919b890>]}
[0m00:06:17.880269 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.engage_analytics
[0m00:06:17.885449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d257f6c-4a5c-409c-91bd-7315b20ac10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c73b0>]}
[0m00:06:17.930944 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:06:17.932514 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:06:17.949239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d257f6c-4a5c-409c-91bd-7315b20ac10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c4dd0>]}
[0m00:06:17.949613 [info ] [MainThread]: Found 56 models, 12 sources, 558 macros
[0m00:06:17.949809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d257f6c-4a5c-409c-91bd-7315b20ac10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a49c740>]}
[0m00:06:17.951131 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:06:17.951498 [debug] [MainThread]: Command end result
[0m00:06:18.010016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:06:18.011344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:06:18.013282 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m00:06:18.013454 [info ] [MainThread]: 
[0m00:06:18.013647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:06:18.013780 [info ] [MainThread]: 
[0m00:06:18.013917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m00:06:18.014199 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.2707369, "process_in_blocks": "0", "process_kernel_time": 0.202277, "process_mem_max_rss": "128401408", "process_out_blocks": "0", "process_user_time": 1.804601}
[0m00:06:18.014404 [debug] [MainThread]: Command `dbt seed` succeeded at 00:06:18.014368 after 1.27 seconds
[0m00:06:18.014580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a49e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a48ea50>]}
[0m00:06:18.014743 [debug] [MainThread]: Flushing usage events
[0m00:06:18.021927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:57.593748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106626c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064eeea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106824f80>]}


============================== 00:06:57.597715 | bc159973-1c81-4c59-ad49-369f0a433bc2 ==============================
[0m00:06:57.597715 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:06:57.598065 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt seed --profiles-dir . --show', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m00:06:57.697615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc159973-1c81-4c59-ad49-369f0a433bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fcbf0>]}
[0m00:06:57.726473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc159973-1c81-4c59-ad49-369f0a433bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627bb00>]}
[0m00:06:57.727368 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:06:57.777683 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:06:57.861498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:06:57.861765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:06:57.865522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.engage_analytics
[0m00:06:57.880442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc159973-1c81-4c59-ad49-369f0a433bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcc9e0>]}
[0m00:06:57.923617 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:06:57.925479 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:06:57.937851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc159973-1c81-4c59-ad49-369f0a433bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773daf0>]}
[0m00:06:57.938134 [info ] [MainThread]: Found 56 models, 12 sources, 558 macros
[0m00:06:57.938306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc159973-1c81-4c59-ad49-369f0a433bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068aaf30>]}
[0m00:06:57.939502 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:06:57.940547 [debug] [MainThread]: Command end result
[0m00:06:57.958958 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:06:57.960099 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:06:57.961769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m00:06:57.961980 [info ] [MainThread]: 
[0m00:06:57.962214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:06:57.962368 [info ] [MainThread]: 
[0m00:06:57.962526 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m00:06:57.962855 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.40658787, "process_in_blocks": "0", "process_kernel_time": 0.154279, "process_mem_max_rss": "122765312", "process_out_blocks": "0", "process_user_time": 0.946796}
[0m00:06:57.963084 [debug] [MainThread]: Command `dbt seed` succeeded at 00:06:57.963045 after 0.41 seconds
[0m00:06:57.963277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d478f0>]}
[0m00:06:57.963447 [debug] [MainThread]: Flushing usage events
[0m00:06:58.037904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:06.644125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e56ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120809460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208091c0>]}


============================== 00:07:06.647503 | 3fd297eb-d4c7-490c-af98-382f59b05535 ==============================
[0m00:07:06.647503 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:07:06.647843 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt seed --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m00:07:06.730529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fd297eb-d4c7-490c-af98-382f59b05535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c6ae70>]}
[0m00:07:06.761222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fd297eb-d4c7-490c-af98-382f59b05535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101929df0>]}
[0m00:07:06.761875 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:07:06.808196 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:07:06.892342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:07:06.892932 [debug] [MainThread]: Partial parsing: added file: engage_analytics://seeds/questionnaire_metadata.csv
[0m00:07:07.005017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fd297eb-d4c7-490c-af98-382f59b05535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218f29f0>]}
[0m00:07:07.050711 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:07:07.052147 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:07:07.066367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fd297eb-d4c7-490c-af98-382f59b05535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12149eab0>]}
[0m00:07:07.066736 [info ] [MainThread]: Found 56 models, 1 seed, 12 sources, 558 macros
[0m00:07:07.066918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd297eb-d4c7-490c-af98-382f59b05535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12080b650>]}
[0m00:07:07.068365 [info ] [MainThread]: 
[0m00:07:07.068545 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m00:07:07.068673 [info ] [MainThread]: 
[0m00:07:07.068922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:07:07.069358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m00:07:07.096223 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m00:07:07.096471 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m00:07:07.096613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:07.133858 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.037 seconds
[0m00:07:07.134715 [debug] [ThreadPool]: On list_airbyte: Close
[0m00:07:07.138498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m00:07:07.138994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m00:07:07.141985 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m00:07:07.142252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m00:07:07.143194 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m00:07:07.143355 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m00:07:07.144134 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m00:07:07.144283 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m00:07:07.144436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:07.144572 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m00:07:07.144700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:07.144975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:07.167184 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:07:07.167462 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m00:07:07.167629 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m00:07:07.167770 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m00:07:07.167921 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m00:07:07.168060 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m00:07:07.168206 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m00:07:07.168370 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m00:07:07.168535 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m00:07:07.173893 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.005 seconds
[0m00:07:07.174941 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m00:07:07.175129 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m00:07:07.175274 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m00:07:07.175879 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m00:07:07.176410 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m00:07:07.176548 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m00:07:07.180402 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m00:07:07.180635 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m00:07:07.216289 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:07.216537 [debug] [MainThread]: On master: BEGIN
[0m00:07:07.216676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:07.227308 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:07:07.227634 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:07.227888 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:07:07.233154 [debug] [MainThread]: SQL status: SELECT 106 in 0.005 seconds
[0m00:07:07.241149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd297eb-d4c7-490c-af98-382f59b05535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213ebbf0>]}
[0m00:07:07.241430 [debug] [MainThread]: On master: ROLLBACK
[0m00:07:07.242757 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:07.242985 [debug] [MainThread]: On master: BEGIN
[0m00:07:07.245519 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:07:07.245734 [debug] [MainThread]: On master: COMMIT
[0m00:07:07.245876 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:07.246003 [debug] [MainThread]: On master: COMMIT
[0m00:07:07.246452 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:07.246594 [debug] [MainThread]: On master: Close
[0m00:07:07.248517 [debug] [Thread-1 (]: Began running node seed.engage_analytics.questionnaire_metadata
[0m00:07:07.248913 [info ] [Thread-1 (]: 1 of 1 START seed file engage_analytics_engage_analytics_stg.questionnaire_metadata  [RUN]
[0m00:07:07.249188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now seed.engage_analytics.questionnaire_metadata)
[0m00:07:07.249367 [debug] [Thread-1 (]: Began compiling node seed.engage_analytics.questionnaire_metadata
[0m00:07:07.249532 [debug] [Thread-1 (]: Began executing node seed.engage_analytics.questionnaire_metadata
[0m00:07:07.263817 [debug] [Thread-1 (]: Using postgres connection "seed.engage_analytics.questionnaire_metadata"
[0m00:07:07.264164 [debug] [Thread-1 (]: On seed.engage_analytics.questionnaire_metadata: BEGIN
[0m00:07:07.264331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:07.278382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m00:07:07.278678 [debug] [Thread-1 (]: Using postgres connection "seed.engage_analytics.questionnaire_metadata"
[0m00:07:07.278858 [debug] [Thread-1 (]: On seed.engage_analytics.questionnaire_metadata: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "seed.engage_analytics.questionnaire_metadata"} */

    create table "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" ("questionnaire_id" text,"linkid" text,"question_text" text,"question_alias" text,"question_order" integer)
  
[0m00:07:07.283068 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m00:07:07.292943 [debug] [Thread-1 (]: Using postgres connection "seed.engage_analytics.questionnaire_metadata"
[0m00:07:07.293200 [debug] [Thread-1 (]: On seed.engage_analytics.questionnaire_metadata: 
          insert into "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" ("questionnaire_id", "linkid", "question_text", "question_alias", "question_order") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,...
[0m00:07:07.294151 [debug] [Thread-1 (]: SQL status: INSERT 0 21 in 0.001 seconds
[0m00:07:07.296875 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.engage_analytics.questionnaire_metadata"
[0m00:07:07.305322 [debug] [Thread-1 (]: On seed.engage_analytics.questionnaire_metadata: COMMIT
[0m00:07:07.305561 [debug] [Thread-1 (]: Using postgres connection "seed.engage_analytics.questionnaire_metadata"
[0m00:07:07.305720 [debug] [Thread-1 (]: On seed.engage_analytics.questionnaire_metadata: COMMIT
[0m00:07:07.308211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:07:07.309028 [debug] [Thread-1 (]: On seed.engage_analytics.questionnaire_metadata: Close
[0m00:07:07.310039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd297eb-d4c7-490c-af98-382f59b05535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1018466c0>]}
[0m00:07:07.310290 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file engage_analytics_engage_analytics_stg.questionnaire_metadata  [[32mINSERT 21[0m in 0.06s]
[0m00:07:07.310543 [debug] [Thread-1 (]: Finished running node seed.engage_analytics.questionnaire_metadata
[0m00:07:07.311403 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:07.311619 [debug] [MainThread]: On master: BEGIN
[0m00:07:07.311960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:07.319032 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m00:07:07.319246 [debug] [MainThread]: On master: COMMIT
[0m00:07:07.319388 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:07.319514 [debug] [MainThread]: On master: COMMIT
[0m00:07:07.319930 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:07.320173 [debug] [MainThread]: On master: Close
[0m00:07:07.320388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:07.320517 [debug] [MainThread]: Connection 'seed.engage_analytics.questionnaire_metadata' was properly closed.
[0m00:07:07.320633 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_stg' was properly closed.
[0m00:07:07.320744 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_mart' was properly closed.
[0m00:07:07.320879 [info ] [MainThread]: 
[0m00:07:07.321013 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:07:07.321311 [debug] [MainThread]: Command end result
[0m00:07:07.343600 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:07:07.344922 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:07:07.347839 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m00:07:07.348020 [info ] [MainThread]: 
[0m00:07:07.348208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:07.348344 [info ] [MainThread]: 
[0m00:07:07.348494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:07:07.348778 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.73951143, "process_in_blocks": "0", "process_kernel_time": 0.147802, "process_mem_max_rss": "136790016", "process_out_blocks": "0", "process_user_time": 1.187491}
[0m00:07:07.348980 [debug] [MainThread]: Command `dbt seed` succeeded at 00:07:07.348942 after 0.74 seconds
[0m00:07:07.349161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121561910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202774a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207e00b0>]}
[0m00:07:07.349325 [debug] [MainThread]: Flushing usage events
[0m00:07:07.407951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:34.166607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211babd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235093d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235090d0>]}


============================== 00:07:34.170319 | c84ff4fe-8574-4d2c-8104-d10ad36d3104 ==============================
[0m00:07:34.170319 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:07:34.170636 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select qr_54_readable', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m00:07:34.267015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c84ff4fe-8574-4d2c-8104-d10ad36d3104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620b860>]}
[0m00:07:34.298310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c84ff4fe-8574-4d2c-8104-d10ad36d3104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234e1fd0>]}
[0m00:07:34.300050 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:07:34.353271 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:07:34.444559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:07:34.445003 [debug] [MainThread]: Partial parsing: added file: engage_analytics://models/marts/qr_wide/qr_54_readable.sql
[0m00:07:34.584754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c84ff4fe-8574-4d2c-8104-d10ad36d3104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124eb5ac0>]}
[0m00:07:34.633830 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:07:34.635577 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:07:34.649200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c84ff4fe-8574-4d2c-8104-d10ad36d3104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249d9730>]}
[0m00:07:34.649587 [info ] [MainThread]: Found 57 models, 1 seed, 12 sources, 558 macros
[0m00:07:34.649833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c84ff4fe-8574-4d2c-8104-d10ad36d3104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124eab6b0>]}
[0m00:07:34.651022 [info ] [MainThread]: 
[0m00:07:34.651237 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m00:07:34.651376 [info ] [MainThread]: 
[0m00:07:34.651612 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:07:34.652015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m00:07:34.676975 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m00:07:34.677249 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m00:07:34.677414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:34.706166 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.029 seconds
[0m00:07:34.706992 [debug] [ThreadPool]: On list_airbyte: Close
[0m00:07:34.710349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_int)
[0m00:07:34.742621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m00:07:34.745481 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m00:07:34.745775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_mart'
[0m00:07:34.746657 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m00:07:34.746876 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m00:07:34.747735 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m00:07:34.747897 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m00:07:34.748029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:34.748153 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m00:07:34.748276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:34.748521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:34.764021 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m00:07:34.764368 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m00:07:34.764588 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m00:07:34.764739 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m00:07:34.764976 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m00:07:34.765177 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m00:07:34.765351 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m00:07:34.765537 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m00:07:34.765712 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m00:07:34.768052 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m00:07:34.768308 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.002 seconds
[0m00:07:34.769233 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m00:07:34.769390 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:07:34.770240 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m00:07:34.770861 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m00:07:34.771160 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m00:07:34.772200 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m00:07:34.772363 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m00:07:34.778849 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:34.779100 [debug] [MainThread]: On master: BEGIN
[0m00:07:34.779232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:34.787091 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m00:07:34.787302 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:34.787487 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:07:34.790322 [debug] [MainThread]: SQL status: SELECT 106 in 0.003 seconds
[0m00:07:34.798024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c84ff4fe-8574-4d2c-8104-d10ad36d3104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ea2a0>]}
[0m00:07:34.798309 [debug] [MainThread]: On master: ROLLBACK
[0m00:07:34.799274 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:34.799406 [debug] [MainThread]: On master: BEGIN
[0m00:07:34.800671 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:07:34.800937 [debug] [MainThread]: On master: COMMIT
[0m00:07:34.801093 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:34.801229 [debug] [MainThread]: On master: COMMIT
[0m00:07:34.801723 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:34.801865 [debug] [MainThread]: On master: Close
[0m00:07:34.804232 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_54_readable
[0m00:07:34.804538 [info ] [Thread-1 (]: 1 of 1 START sql view model engage_analytics_engage_analytics_mart.qr_54_readable  [RUN]
[0m00:07:34.804750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_int, now model.engage_analytics.qr_54_readable)
[0m00:07:34.804906 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_54_readable
[0m00:07:34.809458 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54_readable"
[0m00:07:34.809669 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54_readable"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m00:07:34.809844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:34.820552 [debug] [Thread-1 (]: Postgres adapter: Postgres error: for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 13:     order by m.question_order nulls last, a.linkid
                      ^

[0m00:07:34.822086 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: Close
[0m00:07:34.828909 [debug] [Thread-1 (]: Database Error in model qr_54_readable (models/marts/qr_wide/qr_54_readable.sql)
  for SELECT DISTINCT, ORDER BY expressions must appear in select list
  LINE 13:     order by m.question_order nulls last, a.linkid
                        ^
[0m00:07:34.830116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c84ff4fe-8574-4d2c-8104-d10ad36d3104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222bebd0>]}
[0m00:07:34.830476 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model engage_analytics_engage_analytics_mart.qr_54_readable  [[31mERROR[0m in 0.02s]
[0m00:07:34.830744 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_54_readable
[0m00:07:34.831000 [debug] [Thread-7 (]: Marking all children of 'model.engage_analytics.qr_54_readable' to be skipped because of status 'error'.  Reason: Database Error in model qr_54_readable (models/marts/qr_wide/qr_54_readable.sql)
  for SELECT DISTINCT, ORDER BY expressions must appear in select list
  LINE 13:     order by m.question_order nulls last, a.linkid
                        ^.
[0m00:07:34.832034 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:34.832219 [debug] [MainThread]: On master: BEGIN
[0m00:07:34.832340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:34.842962 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:07:34.843180 [debug] [MainThread]: On master: COMMIT
[0m00:07:34.843322 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:34.843444 [debug] [MainThread]: On master: COMMIT
[0m00:07:34.843879 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:34.844049 [debug] [MainThread]: On master: Close
[0m00:07:34.844261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:34.844391 [debug] [MainThread]: Connection 'model.engage_analytics.qr_54_readable' was properly closed.
[0m00:07:34.844509 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_stg' was properly closed.
[0m00:07:34.844618 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_mart' was properly closed.
[0m00:07:34.844760 [info ] [MainThread]: 
[0m00:07:34.844907 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m00:07:34.845179 [debug] [MainThread]: Command end result
[0m00:07:34.865708 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:07:34.866709 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:07:34.869276 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m00:07:34.869437 [info ] [MainThread]: 
[0m00:07:34.869613 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:07:34.869757 [info ] [MainThread]: 
[0m00:07:34.869923 [error] [MainThread]: [31mFailure in model qr_54_readable (models/marts/qr_wide/qr_54_readable.sql)[0m
[0m00:07:34.870083 [error] [MainThread]:   Database Error in model qr_54_readable (models/marts/qr_wide/qr_54_readable.sql)
  for SELECT DISTINCT, ORDER BY expressions must appear in select list
  LINE 13:     order by m.question_order nulls last, a.linkid
                        ^
[0m00:07:34.870209 [info ] [MainThread]: 
[0m00:07:34.870343 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:07:34.870621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7406606, "process_in_blocks": "0", "process_kernel_time": 0.190739, "process_mem_max_rss": "136003584", "process_out_blocks": "0", "process_user_time": 1.213239}
[0m00:07:34.870812 [debug] [MainThread]: Command `dbt run` failed at 00:07:34.870777 after 0.74 seconds
[0m00:07:34.870979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ea98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ea96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124249d00>]}
[0m00:07:34.871134 [debug] [MainThread]: Flushing usage events
[0m00:07:34.929155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:48.512774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076272f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107809370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107809070>]}


============================== 00:07:48.515836 | 4db2d5f2-d091-4786-8214-78a020f8f721 ==============================
[0m00:07:48.515836 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:07:48.516326 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select qr_54_readable', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mberg/github/engage-analytics/dbt/logs', 'warn_error': 'None', 'profiles_dir': '.', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m00:07:48.595671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4db2d5f2-d091-4786-8214-78a020f8f721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fd580>]}
[0m00:07:48.626680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4db2d5f2-d091-4786-8214-78a020f8f721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074eb140>]}
[0m00:07:48.627276 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:07:48.674396 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:07:48.736667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:48.737105 [debug] [MainThread]: Partial parsing: updated file: engage_analytics://macros/qr_wide_readable.sql
[0m00:07:48.871083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4db2d5f2-d091-4786-8214-78a020f8f721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbe030>]}
[0m00:07:48.917691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:07:48.919071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:07:48.927197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4db2d5f2-d091-4786-8214-78a020f8f721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ca0c0>]}
[0m00:07:48.927452 [info ] [MainThread]: Found 57 models, 1 seed, 12 sources, 558 macros
[0m00:07:48.927802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db2d5f2-d091-4786-8214-78a020f8f721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e79a60>]}
[0m00:07:48.929112 [info ] [MainThread]: 
[0m00:07:48.929344 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m00:07:48.929489 [info ] [MainThread]: 
[0m00:07:48.929738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:07:48.930208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte'
[0m00:07:48.982748 [debug] [ThreadPool]: Using postgres connection "list_airbyte"
[0m00:07:48.982992 [debug] [ThreadPool]: On list_airbyte: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte"} */

    select distinct nspname from pg_namespace
  
[0m00:07:48.983133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:49.001391 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.018 seconds
[0m00:07:49.002351 [debug] [ThreadPool]: On list_airbyte: Close
[0m00:07:49.006014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airbyte, now list_airbyte_engage_analytics_engage_analytics_mart)
[0m00:07:49.006416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_stg'
[0m00:07:49.009713 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m00:07:49.010246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airbyte_engage_analytics_engage_analytics_int'
[0m00:07:49.011386 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m00:07:49.011612 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: BEGIN
[0m00:07:49.012689 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m00:07:49.012899 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: BEGIN
[0m00:07:49.013048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:49.013176 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: BEGIN
[0m00:07:49.013296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:49.013626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:49.029670 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m00:07:49.029976 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m00:07:49.030191 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_mart"
[0m00:07:49.030340 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m00:07:49.030553 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_stg"
[0m00:07:49.030792 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_mart"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_mart'
  
[0m00:07:49.030977 [debug] [ThreadPool]: Using postgres connection "list_airbyte_engage_analytics_engage_analytics_int"
[0m00:07:49.031142 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_stg"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_stg'
  
[0m00:07:49.031419 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "list_airbyte_engage_analytics_engage_analytics_int"} */
select
      'airbyte' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'engage_analytics_engage_analytics_int'
    union all
    select
      'airbyte' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'engage_analytics_engage_analytics_int'
  
[0m00:07:49.033549 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.002 seconds
[0m00:07:49.034625 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: ROLLBACK
[0m00:07:49.034828 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m00:07:49.035527 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: ROLLBACK
[0m00:07:49.035722 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:07:49.036343 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: ROLLBACK
[0m00:07:49.036533 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_mart: Close
[0m00:07:49.036726 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_stg: Close
[0m00:07:49.039524 [debug] [ThreadPool]: On list_airbyte_engage_analytics_engage_analytics_int: Close
[0m00:07:49.043392 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:49.043611 [debug] [MainThread]: On master: BEGIN
[0m00:07:49.043736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:49.052868 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:07:49.053056 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:49.053237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:07:49.056826 [debug] [MainThread]: SQL status: SELECT 106 in 0.003 seconds
[0m00:07:49.064265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db2d5f2-d091-4786-8214-78a020f8f721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11198c110>]}
[0m00:07:49.064516 [debug] [MainThread]: On master: ROLLBACK
[0m00:07:49.065670 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:49.065928 [debug] [MainThread]: On master: BEGIN
[0m00:07:49.067522 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:07:49.067713 [debug] [MainThread]: On master: COMMIT
[0m00:07:49.067876 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:49.068004 [debug] [MainThread]: On master: COMMIT
[0m00:07:49.068617 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:49.068816 [debug] [MainThread]: On master: Close
[0m00:07:49.070199 [debug] [Thread-1 (]: Began running node model.engage_analytics.qr_54_readable
[0m00:07:49.070470 [info ] [Thread-1 (]: 1 of 1 START sql view model engage_analytics_engage_analytics_mart.qr_54_readable  [RUN]
[0m00:07:49.070693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airbyte_engage_analytics_engage_analytics_mart, now model.engage_analytics.qr_54_readable)
[0m00:07:49.070857 [debug] [Thread-1 (]: Began compiling node model.engage_analytics.qr_54_readable
[0m00:07:49.075377 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54_readable"
[0m00:07:49.075638 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54_readable"} */

    
    with ids(ident) as ( values('Questionnaire/54') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m00:07:49.075845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:49.783265 [debug] [Thread-1 (]: SQL status: SELECT 21 in 0.707 seconds
[0m00:07:49.784883 [debug] [Thread-1 (]: Writing injected SQL for node "model.engage_analytics.qr_54_readable"
[0m00:07:49.785375 [debug] [Thread-1 (]: Began executing node model.engage_analytics.qr_54_readable
[0m00:07:49.808037 [debug] [Thread-1 (]: Writing runtime sql for node "model.engage_analytics.qr_54_readable"
[0m00:07:49.808774 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54_readable"
[0m00:07:49.809017 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: BEGIN
[0m00:07:49.809864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m00:07:49.810104 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54_readable"
[0m00:07:49.810410 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54_readable"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_54_readable__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- PHQ-9 (IPC Session 1) with readable column names
-- Original id: ipc-54, url: n/a, version: 0.0.1




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/54') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'f1.3.1' then answer_value_text end) as "phq9_q1_interest",max(case when linkid = 'f1.4.1' then answer_value_text end) as "phq9_q2_depressed",max(case when linkid = 'f1.5.1' then answer_value_text end) as "phq9_q3_sleep",max(case when linkid = 'f1.6.1' then answer_value_text end) as "phq9_q4_tired",max(case when linkid = 'f1.7.1' then answer_value_text end) as "phq9_q5_appetite",max(case when linkid = 'f1.8.1' then answer_value_text end) as "phq9_q6_failure",max(case when linkid = 'f1.9.1' then answer_value_text end) as "phq9_q7_concentration",max(case when linkid = 'f1.10.1' then answer_value_text end) as "phq9_q8_movement",max(case when linkid = 'f1.11.1' then answer_value_text end) as "phq9_q9_suicide",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as "phq9_total_score",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as "phq9_score_meaning",max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as "phq9_score_meaning_code",max(case when linkid = 'encounter-id' then answer_value_text end) as "phq9_encounter_id",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as "phq9_observation_id",max(case when linkid = 'calculated-month' then answer_value_text end) as "phq9_calculated_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "phq9_calculated_year",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "phq9_field_cd8e3d6d",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as "phq9_task_id",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as "phq9_field_9c366bcc",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "phq9_field_b5bc7f80",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "phq9_link_encounter"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m00:07:49.814248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:07:49.818091 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54_readable"
[0m00:07:49.818405 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54_readable"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_54_readable__dbt_tmp" rename to "qr_54_readable"
[0m00:07:49.819514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:07:49.828043 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: COMMIT
[0m00:07:49.828361 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54_readable"
[0m00:07:49.828552 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: COMMIT
[0m00:07:49.830147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:07:49.833990 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_54_readable__dbt_backup"
[0m00:07:49.836452 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_54_readable"
[0m00:07:49.836702 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_54_readable"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_54_readable__dbt_backup" cascade
[0m00:07:49.837572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:07:49.839123 [debug] [Thread-1 (]: On model.engage_analytics.qr_54_readable: Close
[0m00:07:49.840372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4db2d5f2-d091-4786-8214-78a020f8f721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b7a840>]}
[0m00:07:49.840777 [info ] [Thread-1 (]: 1 of 1 OK created sql view model engage_analytics_engage_analytics_mart.qr_54_readable  [[32mCREATE VIEW[0m in 0.77s]
[0m00:07:49.841082 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_54_readable
[0m00:07:49.842011 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:49.842292 [debug] [MainThread]: On master: BEGIN
[0m00:07:49.842450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:49.850524 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m00:07:49.850839 [debug] [MainThread]: On master: COMMIT
[0m00:07:49.850997 [debug] [MainThread]: Using postgres connection "master"
[0m00:07:49.851151 [debug] [MainThread]: On master: COMMIT
[0m00:07:49.851716 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:07:49.851985 [debug] [MainThread]: On master: Close
[0m00:07:49.852294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:49.852505 [debug] [MainThread]: Connection 'model.engage_analytics.qr_54_readable' was properly closed.
[0m00:07:49.852636 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_stg' was properly closed.
[0m00:07:49.852951 [debug] [MainThread]: Connection 'list_airbyte_engage_analytics_engage_analytics_int' was properly closed.
[0m00:07:49.853141 [info ] [MainThread]: 
[0m00:07:49.853310 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m00:07:49.853642 [debug] [MainThread]: Command end result
[0m00:07:49.874246 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m00:07:49.875567 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m00:07:49.879036 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m00:07:49.879278 [info ] [MainThread]: 
[0m00:07:49.879483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:49.879620 [info ] [MainThread]: 
[0m00:07:49.879770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:07:49.880092 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4013551, "process_in_blocks": "0", "process_kernel_time": 0.141669, "process_mem_max_rss": "136593408", "process_out_blocks": "0", "process_user_time": 1.219686}
[0m00:07:49.880299 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:49.880264 after 1.40 seconds
[0m00:07:49.880486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d27e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107276b70>]}
[0m00:07:49.880662 [debug] [MainThread]: Flushing usage events
[0m00:07:49.958689 [debug] [MainThread]: An error was encountered while trying to flush usage events

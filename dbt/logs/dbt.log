[0m01:00:23.441524 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 1 with readable column names
-- Questionnaire ID: 55
-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/55') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as "ipc_s1_patient_age",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as "ipc_s1_patient_dob",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as "ipc_s1_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as "ipc_s1_in_the_past_6_months",max(case when linkid = 'f1.92.1' then answer_value_text end) as "ipc_s1_f1921",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as "ipc_s1_in_the_past_1_year",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as "ipc_s1_i_noticed_that_when_i_was_asking_about_important_p",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s1_did_you_complete_the_required_assessments_and_the_",max(case when linkid = 'f1.42.2' then answer_value_text end) as "ipc_s1_do_you_think_an_important_persons_death_is_connect",max(case when linkid = 'f1.68.2' then answer_value_text end) as "ipc_s1_are_you_and_someone_else_having_a_strong_disagreem",max(case when linkid = 'f1.69.2' then answer_value_text end) as "ipc_s1_briefly_tell_me_about_the_disagreement",max(case when linkid = 'f1.70.2' then answer_value_text end) as "ipc_s1_how_has_this_disagreement_been_affecting_you",max(case when linkid = 'f1.72.2' then answer_value_text end) as "ipc_s1_have_there_been_any_changes_in_your_life_that_are_",max(case when linkid = 'f1.73.2' then answer_value_text end) as "ipc_s1_what_was_the_change",max(case when linkid = 'f1.74.2' then answer_value_text end) as "ipc_s1_when_did_this_happen",max(case when linkid = 'f1.76.2' then answer_value_text end) as "ipc_s1_if_the_client_did_not_mention_any_close_relationsh",max(case when linkid = 'f1.78.2' then answer_value_text end) as "ipc_s1_would_you_say_you_have_close_relationships",max(case when linkid = 'f1.79.2' then answer_value_text end) as "ipc_s1_has_anything_changed_in_your_life_so_that_now_you_",max(case when linkid = 'f1.88.2' then answer_value_text end) as "ipc_s1_f1882",max(case when linkid = 'f1.89.2' then answer_value_text end) as "ipc_s1_select_the_possible_interpersonal_problem_areas_yo",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as "ipc_s1_your_most_distressing_current_symptoms_began",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as "ipc_s1_taskid_session_1_navigator",max(case when linkid = 'f1.40.2' then answer_value_text end) as "ipc_s1_f1402",max(case when linkid = 'f1.79.3' then answer_value_text end) as "ipc_s1_when_did_this_event_happen",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as "ipc_s1_is_there_anything_else_that_we_did_not_discuss_tha",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s1_taskid_session_2_navigator",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'f1.40.3' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or_",max(case when linkid = 'f1.43.2' then answer_value_text end) as "ipc_s1_tell_me_about_your_relationship_with_this_person_h",max(case when linkid = 'f1.69.3' then answer_value_text end) as "ipc_s1_when_did_this_disagreement_happen",max(case when linkid = 'f1.82.2' then answer_value_text end) as "ipc_s1_do_you_want_to_propose_an_interpersonal_formulatio",max(case when linkid = 'f1.87.2' then answer_value_text end) as "ipc_s1_do_you_agree_with_this",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as "ipc_s1_these_are_the_symptoms_you_said_you_are_currently_",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as "ipc_s1_taskid_mood_pdf",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as "ipc_s1_relationships_eg_talk_with_friends_or_vi",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as "ipc_s1_is_there_anything_that_could_get_in_the_way_of_you",max(case when linkid = 'f1.81.3' then answer_value_text end) as "ipc_s1_f1813",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_provider_pdf",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as "ipc_s1_work_on_my_relationship_with_my_parents_",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as "ipc_s1_f13931",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as "ipc_s1_taskid_ipc_session_1_client_pdf",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as "ipc_s1_of_these_symptoms_which_are_the_most_distressing",max(case when linkid = 'f1.81.4' then answer_value_text end) as "ipc_s1_f1814",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as "ipc_s1_earlier_than_that_you_noticed_symptoms",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as "ipc_s1_community_activities_eg_go_to_a_recreati",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as "ipc_s1_patient_name",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as "ipc_s1_f13932",max(case when linkid = 'f1.40.5' then answer_value_text end) as "ipc_s1_f1405",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as "ipc_s1_when_did_these_symptoms_begin",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as "ipc_s1_xxx",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as "ipc_s1_yesterday_",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as "ipc_s1_patient_gender",max(case when linkid = 'f1.40.6' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__54",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as "ipc_s1_phq9_total",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as "ipc_s1_possible_problem_areas",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as "ipc_s1_at_that_time_you_were_experiencing_57",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as "ipc_s1_gad7_total",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as "ipc_s1_hobbies_eg_listen_to_music_play_video_ga",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as "ipc_s1_what_was_going_on_in_your_life_when_you_started_to",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as "ipc_s1_total_score",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s1_ptsd_total",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as "ipc_s1_zfgh",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as "ipc_s1_do_you_agree_with_this_summary",max(case when linkid = 'f1.40.8' then answer_value_text end) as "ipc_s1_f1408",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s1_observation_id_of_mood_rating_session_1_score",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as "ipc_s1_what_about_before_that_was_there_a_time_before_in_",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as "ipc_s1_religionspirituality_eg_pray_or_go_to_se",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s1_mood_rating_total",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as "ipc_s1_person_1_is",max(case when linkid = 'f1.40.9' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__72",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as "ipc_s1_phq9_total_meaning",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as "ipc_s1_what_were_the_symptoms",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as "ipc_s1_with_my_pastor_",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as "ipc_s1_gad7_total_meaning",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as "ipc_s1_f13941",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as "ipc_s1_ptsd_total_meaning_toggle",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as "ipc_s1_when_did_you_notice_these_symptoms",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as "ipc_s1_other",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as "ipc_s1_mood_rating_comment",max(case when linkid = 'f1.38.4' then answer_value_text end) as "ipc_s1_f1384",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as "ipc_s1_f13942",max(case when linkid = 'f1.40.11' then answer_value_text end) as "ipc_s1_f14011",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as "ipc_s1_what_was_happening_then",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s1_encounter_id_of_ipc_session_1",max(case when linkid = 'f1.40.12' then answer_value_text end) as "ipc_s1_has_this_person_been_consistently_close_to_you_or__87",max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as "ipc_s1_ex",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_89",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as "ipc_s1_person_2_is",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as "ipc_s1_f13951",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as "ipc_s1_f13952",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as "ipc_s1_gud",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_94",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as "ipc_s1_person_3_is",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as "ipc_s1_f13961",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as "ipc_s1_f13962",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as "ipc_s1_how_has_this_relationship_changed_following_trauma_98",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as "ipc_s1_person_4_is",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as "encounter_reference",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as "seeing_someone_be_killed_or_seriously_injured",max(case when linkid = 'f1.38.3' then answer_value_text end) as "f1.38.3",max(case when linkid = 'f1.46.2' then answer_value_text end) as "f1.46.2",max(case when linkid = 'task-id-008' then answer_value_text end) as "task-id-008",max(case when linkid = 'task-id-009' then answer_value_text end) as "task-id-009",max(case when linkid = 'task-id-010' then answer_value_text end) as "task-id-010",max(case when linkid = 'task-id-012' then answer_value_text end) as "task-id-012"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m01:00:23.444640 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:23.446496 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m01:00:23.446763 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_tmp" rename to "qr_spi_subform_4"
[0m01:00:23.449066 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:00:23.451189 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m01:00:23.451414 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m01:00:23.451608 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1" rename to "qr_start_ipc_s1__dbt_backup"
[0m01:00:23.452265 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m01:00:23.452484 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m01:00:23.452766 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: COMMIT
[0m01:00:23.454278 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:23.454540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:23.455807 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup"
[0m01:00:23.457350 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m01:00:23.457650 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_spi_subform_4"
[0m01:00:23.457845 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_tmp" rename to "qr_start_ipc_s1"
[0m01:00:23.458025 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_spi_subform_4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_spi_subform_4__dbt_backup" cascade
[0m01:00:23.459864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:23.461652 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m01:00:23.461866 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m01:00:23.462074 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m01:00:23.462766 [debug] [Thread-4 (]: On model.engage_analytics.qr_spi_subform_4: Close
[0m01:00:23.462951 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: COMMIT
[0m01:00:23.463244 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220e1e20>]}
[0m01:00:23.463963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:23.463771 [info ] [Thread-4 (]: 31 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_spi_subform_4  [[32mCREATE VIEW[0m in 0.66s]
[0m01:00:23.465258 [debug] [Thread-1 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup"
[0m01:00:23.465535 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_spi_subform_4
[0m01:00:23.465809 [debug] [Thread-1 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s1"
[0m01:00:23.466009 [debug] [Thread-4 (]: Began running node model.engage_analytics.qr_start_ipc_s4
[0m01:00:23.466214 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s1"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s1__dbt_backup" cascade
[0m01:00:23.466444 [info ] [Thread-4 (]: 35 of 35 START sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [RUN]
[0m01:00:23.466741 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.engage_analytics.qr_spi_subform_4, now model.engage_analytics.qr_start_ipc_s4)
[0m01:00:23.466908 [debug] [Thread-4 (]: Began compiling node model.engage_analytics.qr_start_ipc_s4
[0m01:00:23.469519 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:23.469784 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:00:23.470045 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

    
    with ids(ident) as ( values('Questionnaire/63') )
    select distinct 
      a.linkid,
      coalesce(m.question_alias, a.linkid) as readable_name,
      m.question_order
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    left join "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata" m 
      on m.questionnaire_id = a.questionnaire_id
      and m.linkid = a.linkid
    order by m.question_order nulls last, a.linkid
  
  
[0m01:00:23.470797 [debug] [Thread-1 (]: On model.engage_analytics.qr_start_ipc_s1: Close
[0m01:00:23.470990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:00:23.471283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122497ef0>]}
[0m01:00:23.471797 [info ] [Thread-1 (]: 32 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s1  [[32mCREATE VIEW[0m in 0.66s]
[0m01:00:23.472092 [debug] [Thread-1 (]: Finished running node model.engage_analytics.qr_start_ipc_s1
[0m01:00:23.794777 [debug] [Thread-3 (]: SQL status: SELECT 91 in 0.612 seconds
[0m01:00:23.796377 [debug] [Thread-3 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.796895 [debug] [Thread-3 (]: Began executing node model.engage_analytics.qr_start_ipc_s2
[0m01:00:23.798832 [debug] [Thread-3 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.799203 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.799371 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: BEGIN
[0m01:00:23.800214 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m01:00:23.800495 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.801049 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 2 with readable column names
-- Questionnaire ID: 58
-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/58') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "ipc_s2_phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "ipc_s2_gad7_total_meaning",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as "ipc_s2_ptsd_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as "ipc_s2_phq9_total",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as "ipc_s2_summary_when_1",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as "ipc_s2_most_distressing_symptoms",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as "ipc_s2_selected_problem_area",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as "ipc_s2_ptsd_total_meaning_toggle",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as "ipc_s2_gad7_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as "ipc_s2_taskid_session_2_navigator",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as "ipc_s2_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s2_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s2_taskid_session_3_navigator",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as "ipc_s2_have_you_proposed_the_interpersonal_formulation_in",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_provider_pdf",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s2_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as "ipc_s2_a4a9cad504db44e59a9d0f1bf40ca840",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s2_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as "ipc_s2_taskid_ipc_session_2_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s2_747188c84fc043ea92b49baa32567f73",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as "ipc_s2_did_the_person_ever_hit_kick_push_or_slap_you",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as "ipc_s2_do_you_agree_with_this",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s2_encounter_id_of_ipc_session_2",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s2_3d2ccf9a0e7b48a0854044d43b6dacfe",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area_28",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s2_6fb0c7a5a21143ecaf7b5f1079399133",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s2_observation_id_of_mood_rating_session_1_score",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s2_did_you_ever_hit_kick_push_or_slap_the_person",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as "ipc_s2_do_you_still_think_that",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s2_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s2_232484cf1aee4bfaa66e61494587a16a",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s2_9ed77f2a0d5a434db153d8deadfbc3f8",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s2_3bfee97a6a0e4cd0bdb77ffa8d36191f",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as "ipc_s2_was_this_in_the_context_of_an_argument_or_disagree_37",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__39",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__40",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__41",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as "ipc_s2_287593c3417445afa99871d249230943",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s2_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s2_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s2_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s2_665e1595f16948159d24dac265f1809b",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s2_bc8f199a59f04184864db1c0befd26df",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s2_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s2_e17756cd48614dde859cf90241977246",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s2_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as "ipc_s2_is_any_of_the_2_question_above_is_true",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as "ipc_s2_total_score",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as "ipc_s2_2ef63cf4b37e4216a8e1db6d1b91cc2a",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s2_3e0b76f9090243bab8580b1505e9d168",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s2_9cc2834b0d2843d08811509995cfcdb8",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s2_a7f10195b8594670abbca2498c4fe45f",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__57",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s2_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s2_547a07c2f94c4956997f0439626d0251",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s2_6c1b2aa7f2444d5abfc6e0faef33bfe6",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s2_a77f07b379134708a35414e503a948f1",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s2_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s2_example_skills_63",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s2_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s2_eb8828db167447e7ba9ae3c161160b65",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s2_example_skills_66",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s2_4c95559d86ff4b87a271e52388072a53",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s2_bed17079d1e54bbeaf073d7b6a86243e",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__69",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__70",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__71",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s2_example_skills_72",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s2_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__77",max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__78",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__79",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as "ipc_s2_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = 'task-id-013' then answer_value_text end) as "task-id-013",max(case when linkid = 'task-id-014' then answer_value_text end) as "task-id-014",max(case when linkid = 'task-id-015' then answer_value_text end) as "task-id-015",max(case when linkid = 'task-id-016' then answer_value_text end) as "task-id-016",max(case when linkid = 'task-id-018' then answer_value_text end) as "task-id-018"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m01:00:23.807667 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:00:23.809941 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.810189 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2" rename to "qr_start_ipc_s2__dbt_backup"
[0m01:00:23.812151 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:00:23.813783 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.813988 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_tmp" rename to "qr_start_ipc_s2"
[0m01:00:23.815525 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:23.816265 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m01:00:23.816457 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.816610 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: COMMIT
[0m01:00:23.817484 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:23.818669 [debug] [Thread-3 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup"
[0m01:00:23.818916 [debug] [Thread-3 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s2"
[0m01:00:23.819076 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s2"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s2__dbt_backup" cascade
[0m01:00:23.821341 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:00:23.822106 [debug] [Thread-3 (]: On model.engage_analytics.qr_start_ipc_s2: Close
[0m01:00:23.822565 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12278e720>]}
[0m01:00:23.823085 [info ] [Thread-3 (]: 33 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s2  [[32mCREATE VIEW[0m in 0.64s]
[0m01:00:23.823432 [debug] [Thread-3 (]: Finished running node model.engage_analytics.qr_start_ipc_s2
[0m01:00:23.932953 [debug] [Thread-2 (]: SQL status: SELECT 97 in 0.608 seconds
[0m01:00:23.934724 [debug] [Thread-2 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.935330 [debug] [Thread-2 (]: Began executing node model.engage_analytics.qr_start_ipc_s3
[0m01:00:23.937288 [debug] [Thread-2 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.937766 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.937942 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: BEGIN
[0m01:00:23.938821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m01:00:23.939140 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.939759 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 3 with readable column names
-- Questionnaire ID: 208
-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/208') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as "ipc_s3_phq9_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as "ipc_s3_gad7_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as "ipc_s3_ptsd_total",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as "ipc_s3_ptsd_total_meaning",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as "ipc_s3_taskid_session_3_navigator",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as "ipc_s3_7ff4b5cb2c44434b90e985c61a858097",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s3_taskid_session_4_navigator",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as "ipc_s3_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as "ipc_s3_work_at_home_you_assigned_to_the_client_in_this_se",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_provider_pdf",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s3_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as "ipc_s3_taskid_ipc_session_3_client_pdf",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2",max(case when linkid = 'encounter-id' then answer_value_text end) as "ipc_s3_encounter_id_of_ipc_session_3",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_16",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as "ipc_s3_would_you_prefer_to_focus_on_this_new_problem_area",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_18",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as "ipc_s3_observation_id_of_mood_rating_session_3_score",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as "ipc_s3_1b59ddeb483d4b1baf53f3942204589a",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as "ipc_s3_did_you_ever_hit_kick_push_or_slap_the_personno",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s3_mood_rating_total",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_23",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as "ipc_s3_4554f4b2d15e47e7a10dd77939dd3afc",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_25",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as "ipc_s3_f9a9f4928eb84c718ec6f80ab596430b",max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to_",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__28",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__29",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__30",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as "ipc_s3_9cb58d5b0f2c48f095d2d861ab30c2a7",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as "ipc_s3_59744d4501004d62b1055cbecd973ffd",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as "ipc_s3_6b5fa4342fc34e4bad1189f6260a81f2",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as "ipc_s3_77fc70ba6cac494cb27a77ebce2289e5",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as "ipc_s3_3f63637c1de24851a088c3b08152447e",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as "ipc_s3_50cf6a9ca8374531a13a47381657c2b3",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as "ipc_s3_has_anything_changed_since_the_last_time_we_met",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as "ipc_s3_e6befba36d2547ae9cac409dfae832a2",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as "ipc_s3_total_score",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_40",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as "ipc_s3_4ad7384fa3324e4193180d3f9e540ee7",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as "ipc_s3_stage_identified_in_session_2",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_43",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_44",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_45",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as "ipc_s3_b24118e231c54e23af3a1722af72c299",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as "ipc_s3_68b3cbf5b9ef4da49ac1bcbc20f04473",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as "ipc_s3_9e995f48b09249b2a9e4c7e754e446e5",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__49",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as "ipc_s3_e1755ad4b33a44a3b5624206a582c28a",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as "ipc_s3_e8b8e5504d6542beacb92f4ac17c7f49",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as "ipc_s3_example_skills",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as "ipc_s3_example_skills_53",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as "ipc_s3_bcb8b5c0bcd84a078fe39d59916e8b7c",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as "ipc_s3_example_skills_55",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_56",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_57",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_58",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as "ipc_s3_f9543e3ccbff4d2ab3dfbf96e509d9ca",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_60",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as "ipc_s3_920de190557a423391a34bf293f18214",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as "ipc_s3_95121ef1bfe540ce841c524334644148",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as "ipc_s3_e1a13d53b867440f8622bccebf54f176",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as "ipc_s3_547a07c2f94c4956997f0439626d0251",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as "ipc_s3_8ac792f53f3c49d3a80063c662bf00cd",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__66",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__67",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__68",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as "ipc_s3_a77f07b379134708a35414e503a948f1",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as "ipc_s3_example_skills_70",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_71",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as "ipc_s3_4c95559d86ff4b87a271e52388072a53",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__73",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__74",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__75",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__76",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as "ipc_s3_questions_asked_in_session_2_77",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as "ipc_s3_8c82f7573f404b09bdf478ee376f75a8",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as "ipc_s3_c91209cc1b2c43f083f04704418ae2d5",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__80",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__81",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__82",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as "ipc_s3_example_guiding_prompts_not_all_questions_need_to__83",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as "date_of_birth",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as "age",max(case when linkid = 'calculated-month' then answer_value_text end) as "birth_month",max(case when linkid = 'calculated-year' then answer_value_text end) as "age_years",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as "phq9_total_meaning",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as "gad7_total_meaning",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as "did_you_ever_hit_kick_slap_or_push_the_person_91",max(case when linkid = 'task-id-019' then answer_value_text end) as "task-id-019",max(case when linkid = 'task-id-020' then answer_value_text end) as "task-id-020",max(case when linkid = 'task-id-021' then answer_value_text end) as "task-id-021",max(case when linkid = 'task-id-022' then answer_value_text end) as "task-id-022",max(case when linkid = 'task-id-023' then answer_value_text end) as "task-id-023",max(case when linkid = 'task-id-024' then answer_value_text end) as "task-id-024"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m01:00:23.945991 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:00:23.947967 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.948160 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3" rename to "qr_start_ipc_s3__dbt_backup"
[0m01:00:23.949533 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:23.950914 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.951088 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_tmp" rename to "qr_start_ipc_s3"
[0m01:00:23.952569 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:23.954384 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m01:00:23.954595 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.954757 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: COMMIT
[0m01:00:23.955787 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:23.957003 [debug] [Thread-2 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup"
[0m01:00:23.957259 [debug] [Thread-2 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s3"
[0m01:00:23.957422 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s3"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s3__dbt_backup" cascade
[0m01:00:23.959617 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:00:23.960322 [debug] [Thread-2 (]: On model.engage_analytics.qr_start_ipc_s3: Close
[0m01:00:23.960606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12253e030>]}
[0m01:00:23.960929 [info ] [Thread-2 (]: 34 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s3  [[32mCREATE VIEW[0m in 0.64s]
[0m01:00:23.961267 [debug] [Thread-2 (]: Finished running node model.engage_analytics.qr_start_ipc_s3
[0m01:00:24.067557 [debug] [Thread-4 (]: SQL status: SELECT 42 in 0.596 seconds
[0m01:00:24.068757 [debug] [Thread-4 (]: Writing injected SQL for node "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.069359 [debug] [Thread-4 (]: Began executing node model.engage_analytics.qr_start_ipc_s4
[0m01:00:24.071188 [debug] [Thread-4 (]: Writing runtime sql for node "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.071560 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.071733 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: BEGIN
[0m01:00:24.072348 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m01:00:24.072561 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.072967 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */

  create view "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp"
    
    
  as (
    -- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header"
-- depends_on: "airbyte"."engage_analytics_engage_analytics_stg"."questionnaire_metadata"

-- IPC Session 4 with readable column names
-- Questionnaire ID: 63
-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json




  
  

  
  

  
  

  
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  with ids(ident) as ( values('Questionnaire/63') ),
  base as (
    select
      a.qr_id,
      a.linkid,
      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_answers_long" a
    join ids on a.questionnaire_id = ids.ident
    group by 1,2
  ),
  header as (
    select h.*
    from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_header" h
    join ids on h.questionnaire_id = ids.ident
  ),
  tags as (
    select * from "airbyte"."engage_analytics_engage_analytics_int"."int_qr_tags"
  ),
  pivoted as (
    select
      b.qr_id,max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as "ipc_s4_phq9_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as "ipc_s4_gad7_total",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as "ipc_s4_ptsd_total",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as "ipc_s4_taskid_session_4_navigator",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_provider_pdf",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as "ipc_s4_in_what_format_did_you_deliver_this_session_with_t",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as "ipc_s4_taskid_ipc_session_4_client_pdf",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as "ipc_s4_what_we_know_is_that_symptoms_can_come_back_in_the",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as "ipc_s4_did_you_complete_the_required_assessments_and_the_",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as "ipc_s4_after_todays_session_i_can_refer_you_for_clinical_",max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as "ipc_s4_after_todays_session_i_will_be_referring_you_for_a",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as "ipc_s4_what_do_you_think_are_some_situations_that_may_tri_14",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as "ipc_s4_how_does_it_make_you_feel_to_know_that_today_is_ou",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as "ipc_s4_how_do_you_feel_about_today_being_our_last_session",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as "ipc_s4_how_would_you_know_if_your_symptoms_are_coming_bac",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that_",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as "ipc_s4_please_select_how_you_would_like_to_proceed_with_t",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as "ipc_s4_what_are_some_of_the_skills_you_learned_here_that__21",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as "ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s_22",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as "ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y_23",max(case when linkid = 'f1.33.6' then answer_value_text end) as "ipc_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as "ipc_s4_mood_rating_total",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as "ipc_s4_i_am_going_to_provide_you_with_our_agencys_contact",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as "ipc_s4_what_do_you_think_you_still_need_to_work_on_regard_28",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that_",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as "ipc_s4_lets_talk_about_what_skills_you_learned_here_that__30",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as "ipc_s4_7fef53bc56db47ce8cba8efd4bcbc318",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as "ipc_s4_total_score",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as "did_you_discuss_this_clients_severe_mental_health_screening",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as "what_is_the_recommended_plan_to_address_the_probable_severe",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as "feeling_changed",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as "referral_details_if_the_client_is_referred_out",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as "rerer",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as "20241031",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as "20250201",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as "supervisors_name",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as "is-connected-to-clinical-care-details",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as "is-connected-to-clinical-care-question"
    from base b
    group by b.qr_id
  )
  select
    h.questionnaire_id,
    h.subject_patient_id,
    h.encounter_id,
    h.author_practitioner_id,
    t.practitioner_location_id,
    t.practitioner_organization_id,
    t.practitioner_id,
    t.practitioner_careteam_id,
    t.application_version,
    p.*
  from pivoted p
  join header h using (qr_id)
  left join tags t on t.resource_id = h.qr_id

  
  


  );
[0m01:00:24.077020 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:00:24.079253 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.079473 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4" rename to "qr_start_ipc_s4__dbt_backup"
[0m01:00:24.080873 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:24.082293 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.082469 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
alter table "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_tmp" rename to "qr_start_ipc_s4"
[0m01:00:24.083605 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:00:24.084417 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m01:00:24.084624 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.084798 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: COMMIT
[0m01:00:24.086109 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m01:00:24.087221 [debug] [Thread-4 (]: Applying DROP to: "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup"
[0m01:00:24.087464 [debug] [Thread-4 (]: Using postgres connection "model.engage_analytics.qr_start_ipc_s4"
[0m01:00:24.087628 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "engage_analytics", "target_name": "prod", "node_id": "model.engage_analytics.qr_start_ipc_s4"} */
drop view if exists "airbyte"."engage_analytics_engage_analytics_mart"."qr_start_ipc_s4__dbt_backup" cascade
[0m01:00:24.089184 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:00:24.089908 [debug] [Thread-4 (]: On model.engage_analytics.qr_start_ipc_s4: Close
[0m01:00:24.090196 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe31c7fd-0c24-4245-94df-2d4079a20110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12254d1f0>]}
[0m01:00:24.090506 [info ] [Thread-4 (]: 35 of 35 OK created sql view model engage_analytics_engage_analytics_mart.qr_start_ipc_s4  [[32mCREATE VIEW[0m in 0.62s]
[0m01:00:24.090774 [debug] [Thread-4 (]: Finished running node model.engage_analytics.qr_start_ipc_s4
[0m01:00:24.091539 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:24.091721 [debug] [MainThread]: On master: BEGIN
[0m01:00:24.091870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:24.099959 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:00:24.100229 [debug] [MainThread]: On master: COMMIT
[0m01:00:24.100395 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:24.100538 [debug] [MainThread]: On master: COMMIT
[0m01:00:24.100883 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:00:24.101068 [debug] [MainThread]: On master: Close
[0m01:00:24.101300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:24.101441 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s1' was properly closed.
[0m01:00:24.101564 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s3' was properly closed.
[0m01:00:24.101679 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s2' was properly closed.
[0m01:00:24.101788 [debug] [MainThread]: Connection 'model.engage_analytics.qr_start_ipc_s4' was properly closed.
[0m01:00:24.102047 [info ] [MainThread]: 
[0m01:00:24.102204 [info ] [MainThread]: Finished running 35 view models in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m01:00:24.104323 [debug] [MainThread]: Command end result
[0m01:00:24.130341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mberg/github/engage-analytics/dbt/target/manifest.json
[0m01:00:24.131690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mberg/github/engage-analytics/dbt/target/semantic_manifest.json
[0m01:00:24.136980 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mberg/github/engage-analytics/dbt/target/run_results.json
[0m01:00:24.137227 [info ] [MainThread]: 
[0m01:00:24.137428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:24.137585 [info ] [MainThread]: 
[0m01:00:24.137752 [info ] [MainThread]: Done. PASS=35 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=35
[0m01:00:24.138105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8651004, "process_in_blocks": "0", "process_kernel_time": 0.23999, "process_mem_max_rss": "139935744", "process_out_blocks": "0", "process_user_time": 1.959722}
[0m01:00:24.138341 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:24.138297 after 6.87 seconds
[0m01:00:24.138540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106852090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227e5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106206690>]}
[0m01:00:24.138743 [debug] [MainThread]: Flushing usage events
[0m01:00:24.622006 [debug] [MainThread]: An error was encountered while trying to flush usage events

{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-30T20:11:18.016541Z", "invocation_id": "a614ad1f-4522-4bb3-9279-5f5a5de871da", "invocation_started_at": "2025-09-30T20:10:56.193331Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.076762Z", "completed_at": "2025-09-30T20:11:02.112905Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.113339Z", "completed_at": "2025-09-30T20:11:02.345404Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2857961654663086, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_locations", "compiled": true, "compiled_code": "\n\n\n\n\nwith previous_extraction as (\n  select\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'description' as description,\n    resource::jsonb ->> 'partOf' as partOf,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'status' as status,\n    resource::jsonb ->> 'physicalType' as physicalType,\n    resource::jsonb ->> 'name' as name,\n    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,\n    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,\n  _airbyte_extracted_at as _airbyte_emitted_at\n  from \"airbyte\".\"airbyte\".\"location\"\n)\nselect\n  *,\n  partof::jsonb -> 'display'   as parent_name,\n  \n  split_part(partof::jsonb->>'reference', '/', 2)\n as parent_id,\n  partof::jsonb -> 'reference' as parent_reference\nfrom previous_extraction\n\nwhere _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_locations\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_locations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.062051Z", "completed_at": "2025-09-30T20:11:02.081528Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.082432Z", "completed_at": "2025-09-30T20:11:02.347076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2885468006134033, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_careplans", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'subject' as subject,\n    resource::jsonb ->> 'title' as title,\n    resource::jsonb ->> 'author' as author,\n    resource::jsonb ->> 'description' as description,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'intent' as intent,\n    resource::jsonb ->> 'created' as created,\n    resource::jsonb ->> 'period' as period,\n    resource::jsonb ->> 'identifier' as identifier,\n    resource::jsonb ->> 'status' as status,\n    resource::jsonb ->> 'activity' as activity,\n    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"care_plan\"\n\n\nwhere _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careplans\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careplans\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.071575Z", "completed_at": "2025-09-30T20:11:02.081866Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.088539Z", "completed_at": "2025-09-30T20:11:02.348212Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.28812122344970703, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_careteams", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'name' as name,\n    resource::jsonb ->> 'status' as status,\n    resource::jsonb ->> 'identifier' as identifier,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'managingOrganization' as managingOrganization,\n    resource::jsonb ->> 'participant' as participant,\n_airbyte_extracted_at as _airbyte_emitted_at,\nresource\nfrom \"airbyte\".\"airbyte\".\"care_team\"\n\n\nwhere _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careteams\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careteams\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.074011Z", "completed_at": "2025-09-30T20:11:02.082151Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.094146Z", "completed_at": "2025-09-30T20:11:02.354318Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2942931652069092, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_encounter", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'subject' as subject,\n    resource::jsonb ->> 'serviceType' as serviceType,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'priority' as priority,\n    resource::jsonb ->> 'class' as class,\n    resource::jsonb ->> 'serviceProvider' as serviceProvider,\n    resource::jsonb ->> 'reasonCode' as reasonCode,\n    resource::jsonb ->> 'participant' as participant,\n    resource::jsonb ->> 'type' as type,\n    resource::jsonb ->> 'period' as period,\n    resource::jsonb ->> 'status' as status,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"encounter\"\n\n\n  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.356105Z", "completed_at": "2025-09-30T20:11:02.367013Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.367753Z", "completed_at": "2025-09-30T20:11:02.492689Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13844609260559082, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_organization_affiliations", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'organization' as organization,\n    resource::jsonb ->> 'identifier' as identifier,\n    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"organization_affiliation\"\n\n\nwhere _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organization_affiliations\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organization_affiliations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.363041Z", "completed_at": "2025-09-30T20:11:02.372623Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.373622Z", "completed_at": "2025-09-30T20:11:02.494809Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14153599739074707, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_patient", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'gender' as gender,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'birthDate' as birthDate,\n    resource::jsonb ->> 'managingOrganization' as managingOrganization,\n    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'text' as text,\n    resource::jsonb ->> 'identifier' as identifier,\n((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,\n((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,\n((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,\n((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,\n((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"patient\"\n\n\n  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_patient\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_patient\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.377710Z", "completed_at": "2025-09-30T20:11:02.381242Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.381462Z", "completed_at": "2025-09-30T20:11:02.495380Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1237030029296875, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_practitioner", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'identifier' as identifier,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,\n    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"practitioner\"\n\n\n  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.359589Z", "completed_at": "2025-09-30T20:11:02.367207Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.369901Z", "completed_at": "2025-09-30T20:11:02.495809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1426692008972168, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_organizations", "compiled": true, "compiled_code": "\n\n\n\n \n    \n    select\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'name' as name,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'identifier' as identifier,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,\n     _airbyte_extracted_at as _airbyte_emitted_at \n\n    from \"airbyte\".\"airbyte\".\"organization\"\n\n\n\n  -- this filter will only be applied on an incremental run\n   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organizations\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organizations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.503698Z", "completed_at": "2025-09-30T20:11:02.508786Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.518311Z", "completed_at": "2025-09-30T20:11:02.608615Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11559796333312988, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_practitioner_roles", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'organization' as organization,\n    resource::jsonb ->> 'practitioner' as practitioner,\n    resource::jsonb ->> 'code' as code,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"practitioner_role\"\n\n\nwhere _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner_roles\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner_roles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.520275Z", "completed_at": "2025-09-30T20:11:02.528495Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.532112Z", "completed_at": "2025-09-30T20:11:02.633894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1275801658630371, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.unnested_careteams", "compiled": true, "compiled_code": "with unnested_careteams as (\n  select\n    id,\n    status,\n    jsonb_array_elements(participant::jsonb) as participant,\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careteams\"\n)\nselect\n  id,\n  status,\n  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,\n  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,\n  _airbyte_emitted_at\nfrom unnested_careteams", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"unnested_careteams\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.509387Z", "completed_at": "2025-09-30T20:11:02.528166Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.529585Z", "completed_at": "2025-09-30T20:11:02.651267Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14426398277282715, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_questionnaire_response", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    id,\n    resource,\n    lower(resource::jsonb ->> 'status') as status,\n    resource::jsonb ->> 'questionnaire' as questionnaire_id,\n    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,\n    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,\n    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,\n    resource::jsonb -> 'item' as items,\n    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,\n    resource::jsonb -> 'meta' as meta,\n    _airbyte_extracted_at as _airbyte_emitted_at\n  from \"airbyte\".\"airbyte\".\"questionnaire_response\"\n  where lower(resource::jsonb ->> 'status') = 'completed'\n)\nselect * from src\n\n  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.653711Z", "completed_at": "2025-09-30T20:11:02.656887Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.657085Z", "completed_at": "2025-09-30T20:11:02.744635Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09163689613342285, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.patient", "compiled": true, "compiled_code": "\n\nwith\ntags as (\n  with unnested_tags AS (\n    select\n        id,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,\n        _airbyte_emitted_at\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\"\n),\ntags_renamed as (\n    select\n      id as resource_id,\n      _airbyte_emitted_at,\n      meta_tag_code,\n      case\n        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'\n        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'\n        when meta_tag_display = 'Practitioner'              then 'practitioner_id'\n        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'\n        when meta_tag_display = 'Application Version'       then 'application_version'\n        else null\n      end as display_name\n    from unnested_tags\n)\nselect\n  resource_id,\n  _airbyte_emitted_at,\n  \n  \n    max(\n      \n      case\n      when display_name = 'practitioner_location_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_location_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_organization_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_organization_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_careteam_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_careteam_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'application_version'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"application_version\"\n      \n    \n    \n  \n\nfrom tags_renamed\n\n  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\")\n\ngroup by resource_id, _airbyte_emitted_at\n)\n\nselect \n    stp.id,\n    stp.gender,\n    stp.birthDate::date as birth_date,\n    DATE_PART('year', AGE(stp.birthDate::date))::integer as age_years,\n    stp.deceasedBoolean as deceased,\n    stp.active,\n    stp.period_start::date as registration_date,\n    ut.practitioner_location_id as location_id,\n    stp.name_family,\n    TRIM(stp.name_given,'[\"\"]') as name_given,\n    stp.telecom_value as phone_number,\n    ut.practitioner_id,\n    ut.practitioner_organization_id,\n    ut.practitioner_careteam_id,\n    stp._airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_patient\" stp\nleft join tags ut on ut.resource_id=stp.id\n\n\n    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.639745Z", "completed_at": "2025-09-30T20:11:02.647053Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.647337Z", "completed_at": "2025-09-30T20:11:02.744043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10668206214904785, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.organization_affiliations", "compiled": true, "compiled_code": "\n\nselect\n  s.id,\n  \n  split_part(s.organization::jsonb->>'reference', '/', 2)\n                 as organization_id,\n  \n  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)\n       as location_id,   -- first array entry\n  s._airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organization_affiliations\" s\n\nwhere s._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organization_affiliations\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organization_affiliations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.621269Z", "completed_at": "2025-09-30T20:11:02.726930Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.727192Z", "completed_at": "2025-09-30T20:11:02.775092Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1559460163116455, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.encounters", "compiled": true, "compiled_code": "\n\nwith\ntags as (\n  with unnested_tags AS (\n    select\n        id,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,\n        _airbyte_emitted_at\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\"\n),\ntags_renamed as (\n    select\n      id as resource_id,\n      _airbyte_emitted_at,\n      meta_tag_code,\n      case\n        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'\n        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'\n        when meta_tag_display = 'Practitioner'              then 'practitioner_id'\n        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'\n        when meta_tag_display = 'Application Version'       then 'application_version'\n        else null\n      end as display_name\n    from unnested_tags\n)\nselect\n  resource_id,\n  _airbyte_emitted_at,\n  \n  \n    max(\n      \n      case\n      when display_name = 'practitioner_location_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_location_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_organization_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_organization_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_careteam_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_careteam_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'application_version'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"application_version\"\n      \n    \n    \n  \n\nfrom tags_renamed\n\n  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"encounters\")\n\ngroup by resource_id, _airbyte_emitted_at\n),\ncodes as (\n  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)\n  select\n    id::text as resource_id,\n        class::jsonb ->> 'code' as class_code,\n        class::jsonb ->> 'system' as class_system,\n        priority::jsonb ->> 'coding' as priority_coding,\n        priority::jsonb ->> 'text' as priority_text,\n        period::jsonb ->> 'start' as period_start,\n        period::jsonb ->> 'end' as period_end,\n        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,\n    /* use the column your staging models actually expose */\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\"\n)\n\nselect\n  e.id,\n  e.status,\n  -- reasonCode is typically an array; grab the first element\u2019s 'text' safely\n  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,\n  \n  split_part(e.subject::jsonb->>'reference', '/', 1)\n as subject_type,\n  \n  split_part(e.subject::jsonb->>'reference', '/', 2)\n   as subject_id,\n  date_trunc('month', (c.period_start)::date) as month,\n  -- serviceType coding (jsonb)\n  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,\n  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,\n\n  -- provider / class / priority decoded in 'codes' CTE\n  c.serviceprovider_reference,\n  c.class_code,\n  c.priority_text,\n  c.period_start,\n  c.period_end,\n\n  -- tags (meta->tag)\n  t.practitioner_location_id as location_id,\n  t.practitioner_organization_id,\n  t.practitioner_careteam_id,\n  t.practitioner_id,\n\n  -- keep the raw participant json for downstream use (it\u2019s an array)\n  e.participant,\n  e._airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\" e\nleft join tags  t on t.resource_id = e.id\nleft join codes c on c.resource_id = e.id\n\nwhere e._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"encounters\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"encounters\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.752721Z", "completed_at": "2025-09-30T20:11:02.758557Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.758837Z", "completed_at": "2025-09-30T20:11:02.870754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12186121940612793, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.practitioner_role", "compiled": true, "compiled_code": "\n\nselect\n  spr.id,\n  spr.active,\n  spr.resourceType as resourcetype,\n  -- first coding entry\n  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,\n  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,\n  \n  split_part(spr.organization::jsonb->>'reference', '/', 2)\n  as organization_id,\n  \n  split_part(spr.practitioner::jsonb->>'reference', '/', 2)\n  as practitioner_id,\n  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,\n  -- include the next line only if you actually want this column:\n  -- (spr.meta::jsonb ->> 'source')       as meta_source,\n  spr._airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner_roles\" spr\n\nwhere spr._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at), '1900-01-01')\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioner_role\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioner_role\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.750145Z", "completed_at": "2025-09-30T20:11:02.792325Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.792634Z", "completed_at": "2025-09-30T20:11:02.879736Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13351702690124512, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.organizations", "compiled": true, "compiled_code": "\n\nwith\ncodes as (\n  select\n    id::text as resource_id,\n        type::jsonb ->> 'coding' as type_coding,\n    /* use the column your staging models actually expose */\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organizations\"\n)\n\nselect\n  o.id,\n  o.name,\n  o.active,\n  c.*\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organizations\" as o\nleft join codes c on c.resource_id = o.id \n\nwhere o._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organizations\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organizations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.511828Z", "completed_at": "2025-09-30T20:11:02.523450Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.523755Z", "completed_at": "2025-09-30T20:11:02.925119Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.41791605949401855, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_task", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'authoredOn' as authoredOn,\n    resource::jsonb ->> 'basedOn' as basedOn,\n    resource::jsonb ->> 'statusReason' as statusReason,\n    resource::jsonb ->> 'reasonReference' as reasonReference,\n    resource::jsonb ->> 'executionPeriod' as executionPeriod,\n    resource::jsonb ->> 'for' as for,\n    resource::jsonb ->> 'code' as code,\n    resource::jsonb ->> 'owner' as owner,\n    resource::jsonb ->> 'description' as description,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'intent' as intent,\n    resource::jsonb ->> 'priority' as priority,\n    resource::jsonb ->> 'lastModified' as lastModified,\n    resource::jsonb ->> 'requester' as requester,\n    resource::jsonb ->> 'status' as status,\n    resource::jsonb ->> 'reasonCode' as reasonCode,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"task\"\n\n\n  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_task\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_task\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.901473Z", "completed_at": "2025-09-30T20:11:02.910049Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.910667Z", "completed_at": "2025-09-30T20:11:03.293729Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3947272300720215, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.int_qr_tags", "compiled": true, "compiled_code": "\nwith unnested_tags AS (\n    select\n        id,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,\n        _airbyte_emitted_at\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"\n),\ntags_renamed as (\n    select\n      id as resource_id,\n      _airbyte_emitted_at,\n      meta_tag_code,\n      case\n        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'\n        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'\n        when meta_tag_display = 'Practitioner'              then 'practitioner_id'\n        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'\n        when meta_tag_display = 'Application Version'       then 'application_version'\n        else null\n      end as display_name\n    from unnested_tags\n)\nselect\n  resource_id,\n  _airbyte_emitted_at,\n  \n  \n    max(\n      \n      case\n      when display_name = 'practitioner_location_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_location_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_organization_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_organization_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_careteam_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_careteam_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'application_version'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"application_version\"\n      \n    \n    \n  \n\nfrom tags_renamed\n\n  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\")\n\ngroup by resource_id, _airbyte_emitted_at", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.927665Z", "completed_at": "2025-09-30T20:11:03.100414Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.100946Z", "completed_at": "2025-09-30T20:11:03.315268Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.38828110694885254, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.clients_eligible_for_ipc", "compiled": true, "compiled_code": "-- models/metrics/clients_eligible_for_ipc.sql\n\n\n-- View to identify clients eligible for IPC (Integrated Primary Care)\n-- Based on Mental Wellness Tool (questionnaire 1613532) responses\n-- When \"no-mental-problem\" is false, it indicates eligibility for IPC\n-- Tracks cumulative patients eligible for IPC as of each date\n\nwith mw_tool_responses as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as assessment_date,\n    -- Extract the no-mental-problem boolean value from JSON\n    -- When this is false, the patient has probable mental health issues\n    (jsonb_path_query_first(\n      qr.items::jsonb, \n      '$.**.item[*] ? (@.linkId == \"no-mental-problem\").answer[0].valueBoolean'\n    ))::boolean as no_mental_problem\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  where qr.questionnaire_id = 'Questionnaire/1613532'\n    and qr.subject_patient_id is not null\n),\n\npatients_eligible_for_ipc as (\n  select\n    mw.subject_patient_id,\n    mw.author_practitioner_id,\n    mw.assessment_date,\n    mw.no_mental_problem,\n    p.practitioner_organization_id as organization_id\n  from mw_tool_responses mw\n  left join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\" p \n    on p.id = mw.subject_patient_id\n  -- Select patients where no_mental_problem is false (they are eligible for IPC)\n  where mw.no_mental_problem = false\n),\n\n-- Generate a date spine from the earliest assessment to today\ndate_spine as (\n  select generate_series(\n    (select min(assessment_date) from patients_eligible_for_ipc),\n    current_date,\n    '1 day'::interval\n  )::date as period_date\n),\n\n-- For each date, count cumulative patients assessed as eligible for IPC up to that date\ndaily_counts as (\n  select\n    d.period_date,\n    p.organization_id,\n    p.subject_patient_id,\n    p.assessment_date,\n    p.no_mental_problem\n  from date_spine d\n  cross join patients_eligible_for_ipc p\n  where p.assessment_date <= d.period_date\n)\n\nselect\n  period_date,\n  organization_id,\n  subject_patient_id,\n  assessment_date,\n  no_mental_problem,\n  true as is_eligible_for_ipc\nfrom daily_counts", "relation_name": "\"airbyte\".\"engage_analytics\".\"clients_eligible_for_ipc\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:03.299174Z", "completed_at": "2025-09-30T20:11:03.303055Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.303552Z", "completed_at": "2025-09-30T20:11:03.375037Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07668900489807129, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.clients_eligible_fws", "compiled": true, "compiled_code": "-- models/metrics/clients_eligible_fws.sql\n\n\n-- View to identify clients eligible for FWS (Financial Wellness Services)\n-- Based on Financial Wellness Tool (questionnaire q-financial-wellness-tool) responses\n-- When \"no-financial-hardship\" is false, it indicates eligibility for FWS\n-- Tracks cumulative patients eligible for FWS as of each date\n\nwith fw_tool_responses as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as assessment_date,\n    -- Extract the no-financial-hardship boolean value from JSON\n    (jsonb_path_query_first(\n      qr.items::jsonb, \n      '$.**.item[*] ? (@.linkId == \"no-financial-hardship\").answer[0].valueBoolean'\n    ))::boolean as no_financial_hardship,\n    p.practitioner_organization_id as organization_id\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  left join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\" p \n    on p.id = qr.subject_patient_id\n  where qr.questionnaire_id = 'Questionnaire/q-financial-wellness-tool'\n    and qr.subject_patient_id is not null\n),\n\npatients_eligible_for_fws as (\n  select\n    subject_patient_id,\n    author_practitioner_id,\n    assessment_date,\n    no_financial_hardship,\n    organization_id\n  from fw_tool_responses\n  -- Select patients where no_financial_hardship is false (they have financial hardship and are eligible for FWS)\n  where no_financial_hardship = false\n),\n\n-- Generate a date spine from the earliest assessment to today\ndate_spine as (\n  select generate_series(\n    (select min(assessment_date) from patients_eligible_for_fws),\n    current_date,\n    '1 day'::interval\n  )::date as period_date\n),\n\n-- For each date, count cumulative patients assessed as eligible for FWS up to that date\ndaily_counts as (\n  select\n    d.period_date,\n    p.organization_id,\n    p.subject_patient_id,\n    p.assessment_date,\n    p.no_financial_hardship\n  from date_spine d\n  cross join patients_eligible_for_fws p\n  where p.assessment_date <= d.period_date\n)\n\nselect\n  period_date,\n  organization_id,\n  subject_patient_id,\n  assessment_date,\n  no_financial_hardship,\n  true as is_eligible_for_fws\nfrom daily_counts", "relation_name": "\"airbyte\".\"engage_analytics\".\"clients_eligible_fws\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:03.317576Z", "completed_at": "2025-09-30T20:11:03.319681Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.319865Z", "completed_at": "2025-09-30T20:11:03.431807Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11502218246459961, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.clients_eligible_referral", "compiled": true, "compiled_code": "-- models/metrics/clients_eligible_referral.sql\n\n\n-- View to identify clients eligible for referral\n-- Based on Mental Wellness Tool (questionnaire 1613532) responses\n-- When \"severe-mental-health\" is true, it indicates eligibility for referral\n-- Tracks cumulative patients eligible for referral as of each date\n\nwith mw_tool_responses as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as assessment_date,\n    -- Extract the severe-mental-health boolean value from JSON\n    (jsonb_path_query_first(\n      qr.items::jsonb, \n      '$.**.item[*] ? (@.linkId == \"severe-mental-health\").answer[0].valueBoolean'\n    ))::boolean as severe_mental_health\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  where qr.questionnaire_id = 'Questionnaire/1613532'\n    and qr.subject_patient_id is not null\n),\n\npatients_eligible_for_referral as (\n  select\n    mw.subject_patient_id,\n    mw.author_practitioner_id,\n    mw.assessment_date,\n    mw.severe_mental_health,\n    p.practitioner_organization_id as organization_id\n  from mw_tool_responses mw\n  left join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\" p \n    on p.id = mw.subject_patient_id\n  -- Select patients where severe_mental_health is true (they are eligible for referral)\n  where mw.severe_mental_health = true\n),\n\n-- Generate a date spine from the earliest assessment to today\ndate_spine as (\n  select generate_series(\n    (select min(assessment_date) from patients_eligible_for_referral),\n    current_date,\n    '1 day'::interval\n  )::date as period_date\n),\n\n-- For each date, count cumulative patients assessed as eligible for referral up to that date\ndaily_counts as (\n  select\n    d.period_date,\n    p.organization_id,\n    p.subject_patient_id,\n    p.assessment_date,\n    p.severe_mental_health\n  from date_spine d\n  cross join patients_eligible_for_referral p\n  where p.assessment_date <= d.period_date\n)\n\nselect\n  period_date,\n  organization_id,\n  subject_patient_id,\n  assessment_date,\n  severe_mental_health,\n  true as is_eligible_for_referral\nfrom daily_counts", "relation_name": "\"airbyte\".\"engage_analytics\".\"clients_eligible_referral\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:03.389854Z", "completed_at": "2025-09-30T20:11:03.411336Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.412246Z", "completed_at": "2025-09-30T20:11:03.479113Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09875893592834473, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.clients_eligible_spi", "compiled": true, "compiled_code": "-- models/metrics/clients_eligible_spi.sql\n\n\n-- View to identify clients eligible for SPI (Suicide Prevention Intervention)\n-- Based on Mental Wellness Tool (questionnaire 1613532) responses\n-- When \"suicide-risk\" is true, it indicates eligibility for SPI\n-- Tracks cumulative patients eligible for SPI as of each date\n\nwith mw_tool_responses as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as assessment_date,\n    -- Extract the suicide-risk boolean value from JSON\n    (jsonb_path_query_first(\n      qr.items::jsonb, \n      '$.**.item[*] ? (@.linkId == \"suicide-risk\").answer[0].valueBoolean'\n    ))::boolean as suicide_risk\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  where qr.questionnaire_id = 'Questionnaire/1613532'\n    and qr.subject_patient_id is not null\n),\n\npatients_eligible_for_spi as (\n  select\n    mw.subject_patient_id,\n    mw.author_practitioner_id,\n    mw.assessment_date,\n    mw.suicide_risk,\n    p.practitioner_organization_id as organization_id\n  from mw_tool_responses mw\n  left join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\" p \n    on p.id = mw.subject_patient_id\n  -- Select patients where suicide_risk is true (they are eligible for SPI)\n  where mw.suicide_risk = true\n),\n\n-- Generate a date spine from the earliest assessment to today\ndate_spine as (\n  select generate_series(\n    (select min(assessment_date) from patients_eligible_for_spi),\n    current_date,\n    '1 day'::interval\n  )::date as period_date\n),\n\n-- For each date, count cumulative patients assessed as eligible for SPI up to that date\ndaily_counts as (\n  select\n    d.period_date,\n    p.organization_id,\n    p.subject_patient_id,\n    p.assessment_date,\n    p.suicide_risk\n  from date_spine d\n  cross join patients_eligible_for_spi p\n  where p.assessment_date <= d.period_date\n)\n\nselect\n  period_date,\n  organization_id,\n  subject_patient_id,\n  assessment_date,\n  suicide_risk,\n  true as is_eligible_for_spi\nfrom daily_counts", "relation_name": "\"airbyte\".\"engage_analytics\".\"clients_eligible_spi\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:03.482855Z", "completed_at": "2025-09-30T20:11:03.491228Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.491514Z", "completed_at": "2025-09-30T20:11:03.549569Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06743884086608887, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.patient_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized patient view with masked PII fields for data sharing\n-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number\n\nselect\n    -- Use hashed ID for referential integrity while maintaining privacy\n    MD5(id::text) as patient_id_hash,\n\n    -- Demographic information (non-PII)\n    gender,\n    age_years,  -- Age instead of birth_date for privacy\n    deceased,\n    active,\n    registration_date,\n\n    -- Masked name fields\n    'REDACTED' as name_family_masked,\n    'REDACTED' as name_given_masked,\n\n    -- Masked contact information\n    CASE\n        WHEN phone_number IS NOT NULL AND LENGTH(phone_number) >= 4\n        THEN 'XXX-XXX-' || RIGHT(phone_number, 4)\n        ELSE 'NO PHONE'\n    END as phone_number_masked,\n\n    -- Location and organization (reference IDs only, no PII)\n    location_id,\n    practitioner_id,\n    practitioner_organization_id,\n    practitioner_careteam_id,\n\n    -- Metadata\n    _airbyte_emitted_at,\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\"", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:03.434177Z", "completed_at": "2025-09-30T20:11:03.436766Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.437126Z", "completed_at": "2025-09-30T20:11:03.513905Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08044195175170898, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.clients_sbirt_mi_eligible", "compiled": true, "compiled_code": "-- models/metrics/clients_sbirt_mi_eligible.sql\n\n\n-- View to identify clients eligible for SBIRT/MI (Screening, Brief Intervention, Referral to Treatment / Motivational Interviewing)\n-- Based on Mental Wellness Tool (questionnaire 1613532) responses\n-- When \"alcohol-problem\" or \"drug-problem\" is true, it indicates eligibility for SBIRT/MI\n-- Tracks cumulative patients eligible for SBIRT/MI as of each date\n\nwith mw_tool_responses as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as assessment_date,\n    -- Extract the alcohol-problem boolean value from JSON\n    (jsonb_path_query_first(\n      qr.items::jsonb, \n      '$.**.item[*] ? (@.linkId == \"alcohol-problem\").answer[0].valueBoolean'\n    ))::boolean as alcohol_problem,\n    -- Extract the drug-problem boolean value from JSON\n    (jsonb_path_query_first(\n      qr.items::jsonb, \n      '$.**.item[*] ? (@.linkId == \"drug-problem\").answer[0].valueBoolean'\n    ))::boolean as drug_problem\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  where qr.questionnaire_id = 'Questionnaire/1613532'\n    and qr.subject_patient_id is not null\n),\n\npatients_eligible_for_sbirt_mi as (\n  select\n    mw.subject_patient_id,\n    mw.author_practitioner_id,\n    mw.assessment_date,\n    mw.alcohol_problem,\n    mw.drug_problem,\n    p.practitioner_organization_id as organization_id\n  from mw_tool_responses mw\n  left join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\" p \n    on p.id = mw.subject_patient_id\n  -- Select patients where alcohol_problem or drug_problem is true (they are eligible for SBIRT/MI)\n  where mw.alcohol_problem = true or mw.drug_problem = true\n),\n\n-- Generate a date spine from the earliest assessment to today\ndate_spine as (\n  select generate_series(\n    (select min(assessment_date) from patients_eligible_for_sbirt_mi),\n    current_date,\n    '1 day'::interval\n  )::date as period_date\n),\n\n-- For each date, count cumulative patients assessed as eligible for SBIRT/MI up to that date\ndaily_counts as (\n  select\n    d.period_date,\n    p.organization_id,\n    p.subject_patient_id,\n    p.assessment_date,\n    p.alcohol_problem,\n    p.drug_problem\n  from date_spine d\n  cross join patients_eligible_for_sbirt_mi p\n  where p.assessment_date <= d.period_date\n)\n\nselect\n  period_date,\n  organization_id,\n  subject_patient_id,\n  assessment_date,\n  alcohol_problem,\n  drug_problem,\n  true as is_eligible_for_sbirt_mi\nfrom daily_counts", "relation_name": "\"airbyte\".\"engage_analytics\".\"clients_sbirt_mi_eligible\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:03.708871Z", "completed_at": "2025-09-30T20:11:03.710791Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.710986Z", "completed_at": "2025-09-30T20:11:03.752870Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04477429389953613, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.current_practitioner_role", "compiled": true, "compiled_code": "with ranked as (\n  select\n    pr.*,\n    row_number() over (\n      partition by practitioner_id\n      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc\n    ) as rn\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioner_role\" pr\n  where coalesce(pr.active::text,'true') ilike 'true'\n)\nselect * from ranked where rn = 1", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"current_practitioner_role\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:03.755138Z", "completed_at": "2025-09-30T20:11:03.793867Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.794121Z", "completed_at": "2025-09-30T20:11:03.833078Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07870674133300781, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.practitioners", "compiled": true, "compiled_code": "\n\nwith\ncodes as (\n  select\n    id::text as resource_id,\n        name::jsonb ->> 'family' as name_family,\n        name::jsonb ->> 'use' as name_use,\n        name::jsonb ->> 'given' as name_given,\n        telecom::jsonb ->> 'value' as telecom_value,\n        telecom::jsonb ->> 'system' as telecom_system,\n    /* use the column your staging models actually expose */\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner\"\n)\n\nselect\n  p.id,\n  p.active,\n  oa.organization_id,\n  oa.location_id,\n  pc.name_family,\n  trim(pc.name_given, '[\"\"]') as name_given,\n  pc.telecom_value as phone_number,\n  greatest(\n    p._airbyte_emitted_at,\n    coalesce(oa._airbyte_emitted_at, '1900-01-01'),\n    coalesce(pr._airbyte_emitted_at, '1900-01-01')\n  ) as _airbyte_emitted_at,\n  pr.coding_code    as role_id,\n  pr.coding_display as role\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner\" p\nleft join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"current_practitioner_role\" pr\n  on pr.practitioner_id = p.id\nleft join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organization_affiliations\" oa\n  on pr.organization_id = oa.organization_id\nleft join codes as pc\n  on pc.resource_id = p.id\n\nwhere p._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioners\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioners\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:03.836550Z", "completed_at": "2025-09-30T20:11:03.838883Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:03.839118Z", "completed_at": "2025-09-30T20:11:03.917369Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08189082145690918, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.active_providers", "compiled": true, "compiled_code": "-- models/metrics/active_providers.sql\n\n\n-- View to identify providers who have submitted QRs in the past 30 days\n-- This calculates a rolling 30-day window from current_date\nwith qr_activity as (\n  select\n    author_practitioner_id as practitioner_id,\n    max(meta_lastupdated::date) as last_activity_date,\n    count(*) as qr_count_30d\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"\n  where meta_lastupdated::date >= current_date - interval '30 days'\n    and author_practitioner_id is not null\n  group by 1\n)\n\nselect\n  current_date as period_date,  -- Add period_date for daily tracking\n  p.id as practitioner_id,\n  p.organization_id,\n  p.active,\n  qa.last_activity_date,\n  qa.qr_count_30d,\n  case \n    when qa.practitioner_id is not null then true\n    else false\n  end as is_active_30d\nfrom \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioners\" p\nleft join qr_activity qa on qa.practitioner_id = p.id\nwhere p.active = 'true'", "relation_name": "\"airbyte\".\"engage_analytics\".\"active_providers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.872545Z", "completed_at": "2025-09-30T20:11:02.874483Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.874678Z", "completed_at": "2025-09-30T20:11:05.664751Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.7950127124786377, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.int_qr_header", "compiled": true, "compiled_code": "\n\nselect\n  id as qr_id,\n  questionnaire_id,\n  subject_patient_id,\n  encounter_id,\n  author_practitioner_id,\n  _airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:02.777318Z", "completed_at": "2025-09-30T20:11:02.779479Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:02.779668Z", "completed_at": "2025-09-30T20:11:05.666598Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.8911659717559814, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.int_qr_answers_long", "compiled": true, "compiled_code": "\n\nwith recursive base as (\n  select\n    id as qr_id,\n    questionnaire_id,\n    subject_patient_id,\n    encounter_id,\n    author_practitioner_id,\n    items,\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"\n),\n\nrecursive_items as (\n  select\n    b.qr_id,\n    b.questionnaire_id,\n    b.subject_patient_id,\n    b.encounter_id,\n    b.author_practitioner_id,\n    (i.value)::jsonb as item_json,\n    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,\n    b._airbyte_emitted_at\n  from base b\n  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)\n  union all\n  select\n    r.qr_id,\n    r.questionnaire_id,\n    r.subject_patient_id,\n    r.encounter_id,\n    r.author_practitioner_id,\n    child.value::jsonb as item_json,\n    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,\n    r._airbyte_emitted_at\n  from recursive_items r\n  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true\n),\n\nanswers as (\n  select\n    qr_id,\n    questionnaire_id,\n    subject_patient_id,\n    encounter_id,\n    author_practitioner_id,\n    (linkid_path[array_length(linkid_path,1)]) as linkid,\n    a.value::jsonb as ans,\n    _airbyte_emitted_at\n  from recursive_items\n  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)\n),\n\nnormalized as (\n  select\n    qr_id,\n    questionnaire_id,\n    subject_patient_id,\n    encounter_id,\n    author_practitioner_id,\n    linkid,\n    ans ->> 'valueString'                         as value_string,\n    (ans ->> 'valueInteger')::int                 as value_integer,\n    (ans ->> 'valueDecimal')::numeric             as value_decimal,\n    ans ->> 'valueDate'                           as value_date,\n    ans -> 'valueCoding' ->> 'code'               as value_coding_code,\n    ans -> 'valueCoding' ->> 'display'            as value_coding_display,\n    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,\n    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,\n    coalesce(\n      ans -> 'valueCoding' ->> 'display',\n      ans ->> 'valueString',\n      ans ->> 'valueDate',\n      ans ->> 'valueInteger',\n      ans ->> 'valueDecimal',\n      ans -> 'valueQuantity' ->> 'value'\n    ) as answer_value_text,\n    _airbyte_emitted_at\n  from answers\n)\n\nselect * from normalized", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:05.716713Z", "completed_at": "2025-09-30T20:11:07.304208Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:07.304529Z", "completed_at": "2025-09-30T20:11:07.354603Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6480729579925537, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_confidential_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Discuss Confidentiality with readable column names\n-- Questionnaire ID: 23451\n-- Source file: questionnaire/ipc-session-1/confidential-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/23451') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_confidential_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:05.720168Z", "completed_at": "2025-09-30T20:11:07.309455Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:07.311521Z", "completed_at": "2025-09-30T20:11:07.356080Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6499090194702148, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_financial_wellness_tool", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Financial Wellness Tool with readable column names\n-- Questionnaire ID: q-financial-wellness-tool\n-- Source file: questionnaire/assessments/financial-wellness-tool.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '21234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_wellness_tool_in_the_past_12_months_was_there_a_time_\",max(case when linkid = '31234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_wellness_tool_in_the_past_12_months_did_you_not_pay_t\",max(case when linkid = '3456789a-bcde-f012-3456-789abcdef012' then answer_value_text end) as \"financial_wellness_tool_how_hard_is_it_for_you_to_pay_for_the_v\",max(case when linkid = '51234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_wellness_tool_how_strongly_do_you_agree_or_disagree_w\",max(case when linkid = '61234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_wellness_tool_in_the_past_12_months_did_you_move_in_w\",max(case when linkid = '6789abcd-ef01-2345-6789-abcdef012345' then answer_value_text end) as \"financial_wellness_tool_in_the_past_12_months_how_often_did_you\",max(case when linkid = '91234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_wellness_tool_in_the_past_12_months_did_you_stay_at_a\",max(case when linkid = 'c1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_wellness_tool_in_the_past_12_months_did_you_not_pay_2\",max(case when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab' then answer_value_text end) as \"financial_wellness_tool_i_worried_whether_my_food_would_run_out\",max(case when linkid = 'f0123456-789a-bcde-f012-3456789abcde' then answer_value_text end) as \"financial_wellness_tool_the_food_that_i_bought_just_didn_t_last\",max(case when linkid = 'f1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_wellness_tool_in_the_past_12_months_was_your_phone_ga\",max(case when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d' then answer_value_text end) as \"financial_wellness_tool_when_you_think_about_your_financial_sit\",max(case when linkid = 'high-debt' then answer_value_text end) as \"financial_wellness_tool\",max(case when linkid = 'high-food-insecurity' then answer_value_text end) as \"financial_wellness_tool_2\",max(case when linkid = 'high-housing-insecurity' then answer_value_text end) as \"financial_wellness_tool_3\",max(case when linkid = 'high-paying-bills' then answer_value_text end) as \"financial_wellness_tool_4\",max(case when linkid = 'moderate-debt' then answer_value_text end) as \"financial_wellness_tool_5\",max(case when linkid = 'moderate-food-insecurity' then answer_value_text end) as \"financial_wellness_tool_6\",max(case when linkid = 'moderate-housing-insecurity' then answer_value_text end) as \"financial_wellness_tool_7\",max(case when linkid = 'moderate-medical-hardships' then answer_value_text end) as \"financial_wellness_tool_8\",max(case when linkid = 'moderate-paying-bills' then answer_value_text end) as \"financial_wellness_tool_9\",max(case when linkid = 'no-financial-hardship' then answer_value_text end) as \"financial_wellness_tool_10\",max(case when linkid = 'overall-financial-hardship' then answer_value_text end) as \"financial_wellness_tool_11\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_financial_wellness_tool\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:05.681266Z", "completed_at": "2025-09-30T20:11:07.309029Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:07.309798Z", "completed_at": "2025-09-30T20:11:07.357451Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6794071197509766, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_1_month_follow_up", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- 1 month follow up with readable column names\n-- Questionnaire ID: 1-month-follow-up\n-- Source file: questionnaire/1-month-follow-up.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'completed-all-recommended-interventions' then answer_value_text end) as \"one_month_follow_up_scheduling_have_you_completed_all_recommend\",max(case when linkid = 'schedule-this-meeting' then answer_value_text end) as \"describe_one_month_follow_up_let_s_schedule_this_meeting_now\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_1_month_follow_up\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:05.710430Z", "completed_at": "2025-09-30T20:11:07.311288Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:07.313603Z", "completed_at": "2025-09-30T20:11:07.358128Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.652440071105957, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_common_mental_health_symptoms", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Common Mental Health Symptoms with readable column names\n-- Questionnaire ID: q-common-mental-health-symptoms\n-- Source file: questionnaire/assessments/common-mental-health-symptoms.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpath\",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_wer\",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_2\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_2\",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_3\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_3\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_4\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_5\",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_4\",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_f\",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_5\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_6\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_6\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_7\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_8\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_that\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"common_mental_health_symptoms_thoughts_that_you_would_be_better\",max(case when linkid = 'f1.15.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_edg\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"common_mental_health_symptoms_not_being_able_to_stop_or_control\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"common_mental_health_symptoms_worrying_too_much_about_different\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_relaxing\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"common_mental_health_symptoms_being_so_restless_that_it_s_hard_\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irrita\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_afraid_as_if_something_aw\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"common_mental_health_symptoms_little_interest_or_pleasure_in_do\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_down_depressed_or_hopeles\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_falling_or_staying_asleep\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_tired_or_having_little_en\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"common_mental_health_symptoms_poor_appetite_or_overeating\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_tha\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_concentrating_on_things_s\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'show-pcl-5-to-8-questions' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_7\",max(case when linkid = 'task-id-common-mental-pdf' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_8\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_common_mental_health_symptoms\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:07.378427Z", "completed_at": "2025-09-30T20:11:08.253512Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:08.253842Z", "completed_at": "2025-09-30T20:11:08.557295Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.188392162322998, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- GAD-7 (IPC Session 3) with readable column names\n-- Questionnaire ID: 59\n-- Source file: questionnaire/ipc-session-3/gad-7-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/59') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_20\",max(case when linkid = '534c4998-b964-4101-b919-ff3c26af9714' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_21\",max(case when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_22\",max(case when linkid = 'f1.15.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_4\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_4\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"common_mental_health_symptoms_worrying_too_much_about_differe_4\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_relaxing_4\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"common_mental_health_symptoms_being_so_restless_that_it_s_har_4\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_4\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_afraid_as_if_something__4\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:07.371269Z", "completed_at": "2025-09-30T20:11:08.251438Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:08.251737Z", "completed_at": "2025-09-30T20:11:08.558332Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1912057399749756, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- GAD-7 (IPC Session 1) with readable column names\n-- Questionnaire ID: 202\n-- Source file: questionnaire/ipc-session-1/gad-7-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/202') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_9\",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_10\",max(case when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_11\",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_12\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_2\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_2\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_2\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_2\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_13\",max(case when linkid = 'f1.15.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_2\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_2\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"common_mental_health_symptoms_worrying_too_much_about_differe_2\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_relaxing_2\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"common_mental_health_symptoms_being_so_restless_that_it_s_har_2\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_2\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_afraid_as_if_something__2\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_14\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:07.388789Z", "completed_at": "2025-09-30T20:11:08.264506Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:08.264717Z", "completed_at": "2025-09-30T20:11:08.559000Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1856729984283447, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- GAD-7 (IPC Session 4) with readable column names\n-- Questionnaire ID: 62\n-- Source file: questionnaire/ipc-session-4/gad-7-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/62') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_23\",max(case when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_24\",max(case when linkid = 'e4155e07-1d18-448f-8111-182bf4149672' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_25\",max(case when linkid = 'f1.15.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_5\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_5\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"common_mental_health_symptoms_worrying_too_much_about_differe_5\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_relaxing_5\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"common_mental_health_symptoms_being_so_restless_that_it_s_har_5\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_5\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_afraid_as_if_something__5\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:07.375147Z", "completed_at": "2025-09-30T20:11:08.257773Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:08.258011Z", "completed_at": "2025-09-30T20:11:08.559895Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1914198398590088, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- GAD-7 (IPC Session 2) with readable column names\n-- Questionnaire ID: 205\n-- Source file: questionnaire/ipc-session-2/gad-7-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/205') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_15\",max(case when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_16\",max(case when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_17\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_18\",max(case when linkid = 'f1.15.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_3\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_3\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"common_mental_health_symptoms_worrying_too_much_about_differe_3\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_relaxing_3\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"common_mental_health_symptoms_being_so_restless_that_it_s_har_3\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_3\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_afraid_as_if_something__3\",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_19\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:08.575813Z", "completed_at": "2025-09-30T20:11:09.344842Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:09.345325Z", "completed_at": "2025-09-30T20:11:09.683212Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.118523120880127, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mood Rating (IPC Session 4) with readable column names\n-- Questionnaire ID: 209\n-- Source file: questionnaire/ipc-session-4/mood-rating-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/209') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990' then answer_value_text end) as \"mood_rating_ipc_session_4_total_score\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__4\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:08.568086Z", "completed_at": "2025-09-30T20:11:09.339919Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:09.340703Z", "completed_at": "2025-09-30T20:11:09.685420Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.121500015258789, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mood Rating (IPC Session 1) with readable column names\n-- Questionnaire ID: 203\n-- Source file: questionnaire/ipc-session-1/mood-rating-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/203') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as \"mood_rating_ipc_session_1\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_3\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_3\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_3\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_3\",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as \"mood_rating_ipc_session_1_total_score\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being_th\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:08.573284Z", "completed_at": "2025-09-30T20:11:09.334872Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:09.336991Z", "completed_at": "2025-09-30T20:11:09.684024Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.119744062423706, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mood Rating (IPC Session 3) with readable column names\n-- Questionnaire ID: 207\n-- Source file: questionnaire/ipc-session-3/mood-rating-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/207') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as \"mood_rating_ipc_session_3_total_score\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__3\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:08.570966Z", "completed_at": "2025-09-30T20:11:09.342608Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:09.342933Z", "completed_at": "2025-09-30T20:11:09.681915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1175549030303955, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mood Rating (IPC Session 2) with readable column names\n-- Questionnaire ID: 206\n-- Source file: questionnaire/ipc-session-2/mood-rating-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/206') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as \"mood_rating_ipc_session_2_total_score\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_4\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_4\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_4\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_4\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__2\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:09.722412Z", "completed_at": "2025-09-30T20:11:11.113320Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:11.113597Z", "completed_at": "2025-09-30T20:11:11.292753Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5826821327209473, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mw_tool", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mental Wellness Tool with readable column names\n-- Questionnaire ID: 1613532\n-- Source file: questionnaire/assessments/mw-tool.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/1613532') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_have_there_been_times_whe\",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_y\",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_d\",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as \"mental_wellness_tool_in_the_past_month_have_you_wished_you_were\",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_did_you_at_any_time_hear_\",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_did_you_dis\",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_what_is_the\",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_bee\",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_how_many_times_have_you_u\",max(case when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29' then answer_value_text end) as \"discussion_with_supervisor_for_incomplete_answers_since_respons\",max(case when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f' then answer_value_text end) as \"discussion_with_supervisor_for_incomplete_answers_since_respo_2\",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_referral_de\",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_how_many_drinks_containin\",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as \"mental_wellness_tool_in_the_past_3_months_have_you_ever_done_an\",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_2\",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as \"mental_wellness_tool_in_the_past_month_have_you_had_any_actual_\",max(case when linkid = 'alcohol-problem' then answer_value_text end) as \"mental_wellness_tool_alcohol_problem\",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_3\",max(case when linkid = 'common-mental-health' then answer_value_text end) as \"mental_wellness_tool_common_mental_health\",max(case when linkid = 'drug-problem' then answer_value_text end) as \"mental_wellness_tool_drug_problem\",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_2\",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_supervisor_\",max(case when linkid = 'how-many-drinks' then answer_value_text end) as \"mental_wellness_tool_how_many_drinks\",max(case when linkid = 'no-mental-problem' then answer_value_text end) as \"mental_wellness_tool_no_mental_problem\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as \"patient-biological-sex\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as \"patient-gender-identity\",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as \"patient-how-you-think-of-yourself\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'patient-pronouns' then answer_value_text end) as \"patient-pronouns\",max(case when linkid = 'q1-to-q3-negative' then answer_value_text end) as \"the_client_s_mental_wellness_tool_results_q1_to_q3_negative\",max(case when linkid = 'severe-mental-health' then answer_value_text end) as \"mental_wellness_tool_severe_mental_health\",max(case when linkid = 'suicide-risk' then answer_value_text end) as \"mental_wellness_tool_suicide_risk\",max(case when linkid = 'task-id-common-mental-health-form' then answer_value_text end) as \"mental_wellness_tool_taskid_of_common_mental_health_form\",max(case when linkid = 'task-id-mwtool-pdf' then answer_value_text end) as \"mental_wellness_tool_taskid_of_pdf\",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as \"task_id_socio_pdf\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mw_tool\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:09.703601Z", "completed_at": "2025-09-30T20:11:11.122558Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:11.122753Z", "completed_at": "2025-09-30T20:11:11.294606Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5932700634002686, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mw_tool_ipc_session_4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mental Wellness Tool Session 4 with readable column names\n-- Questionnaire ID: mw-tool-ipc-session-4\n-- Source file: questionnaire/assessments/mw-tool-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_3\",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_2\",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_2\",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as \"mental_wellness_tool_in_the_past_month_have_you_wished_you_we_2\",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_did_you_at_any_time_hea_2\",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_4\",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_how_many_times_have_you_2\",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_how_many_drinks_contain_2\",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as \"mental_wellness_tool_in_the_past_3_months_have_you_ever_done__2\",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_5\",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as \"mental_wellness_tool_in_the_past_month_have_you_had_any_actua_2\",max(case when linkid = 'alcohol-problem' then answer_value_text end) as \"mental_wellness_tool_alcohol_problem_2\",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_6\",max(case when linkid = 'common-mental-health' then answer_value_text end) as \"mental_wellness_tool_common_mental_health_2\",max(case when linkid = 'drug-problem' then answer_value_text end) as \"mental_wellness_tool_drug_problem_2\",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_4\",max(case when linkid = 'how-many-drinks' then answer_value_text end) as \"mental_wellness_tool_how_many_drinks_2\",max(case when linkid = 'no-mental-problem' then answer_value_text end) as \"mental_wellness_tool_no_mental_problem_2\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as \"patient-biological-sex\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as \"patient-gender-identity\",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as \"patient-how-you-think-of-yourself\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'patient-pronouns' then answer_value_text end) as \"patient-pronouns\",max(case when linkid = 'severe-mental-health' then answer_value_text end) as \"mental_wellness_tool_severe_mental_health_2\",max(case when linkid = 'suicide-risk' then answer_value_text end) as \"mental_wellness_tool_suicide_risk_2\",max(case when linkid = 'task-id-mw-tool-ipc-s4-pdf' then answer_value_text end) as \"mental_wellness_tool_taskid_of_pdf_2\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mw_tool_ipc_session_4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:09.740856Z", "completed_at": "2025-09-30T20:11:11.156823Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:11.157069Z", "completed_at": "2025-09-30T20:11:11.295424Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5608587265014648, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 1) with readable column names\n-- Questionnaire ID: 54\n-- Source file: questionnaire/ipc-session-1/phq-9-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/54') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_26\",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_27\",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_2\",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_28\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_5\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_5\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_5\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_5\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_29\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_2\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_2\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"common_mental_health_symptoms_little_interest_or_pleasure_in__2\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_2\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_falling_or_staying_asle_2\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_tired_or_having_little__2\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"common_mental_health_symptoms_poor_appetite_or_overeating_2\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_2\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_concentrating_on_things_2\",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_30\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_31\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:09.746528Z", "completed_at": "2025-09-30T20:11:11.144020Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:11.144241Z", "completed_at": "2025-09-30T20:11:11.296762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5539231300354004, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 2) with readable column names\n-- Questionnaire ID: 57\n-- Source file: questionnaire/ipc-session-2/phq-9-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/57') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_32\",max(case when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_33\",max(case when linkid = 'a07491bd-039d-417b-9caf-0af536316594' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_34\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_35\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_3\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_3\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"common_mental_health_symptoms_little_interest_or_pleasure_in__3\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_3\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_falling_or_staying_asle_3\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_tired_or_having_little__3\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"common_mental_health_symptoms_poor_appetite_or_overeating_3\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_3\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_concentrating_on_things_3\",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_36\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:11.305453Z", "completed_at": "2025-09-30T20:11:12.141177Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:12.141491Z", "completed_at": "2025-09-30T20:11:12.427868Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1266279220581055, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 3) with readable column names\n-- Questionnaire ID: 61\n-- Source file: questionnaire/ipc-session-3/phq-9-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/61') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_37\",max(case when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_38\",max(case when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_39\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_4\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_4\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"common_mental_health_symptoms_little_interest_or_pleasure_in__4\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_4\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_falling_or_staying_asle_4\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_tired_or_having_little__4\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"common_mental_health_symptoms_poor_appetite_or_overeating_4\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_4\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_concentrating_on_things_4\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:11.316106Z", "completed_at": "2025-09-30T20:11:12.162269Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:12.164346Z", "completed_at": "2025-09-30T20:11:12.428995Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1207571029663086, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_registration_info", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Add Family Member Registration with readable column names\n-- Questionnaire ID: 221\n-- Source file: questionnaire/generic/registration_info.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/221') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff' then answer_value_text end) as \"add_family_member_registration\",max(case when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd' then answer_value_text end) as \"add_family_member_registration_middle_name\",max(case when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271' then answer_value_text end) as \"add_family_member_registration_which_of_the_following_best_repr\",max(case when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7' then answer_value_text end) as \"add_family_member_registration_age_estimate_if_unknown\",max(case when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d' then answer_value_text end) as \"add_family_member_registration_last_name\",max(case when linkid = 'age' then answer_value_text end) as \"age\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_6\",max(case when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f' then answer_value_text end) as \"add_family_member_registration_unique_id\",max(case when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0' then answer_value_text end) as \"add_family_member_registration_have_you_received_engage_service\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_6\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_6\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_6\",max(case when linkid = 'choice-gender-identity' then answer_value_text end) as \"add_family_member_registration_what_term_best_expresses_how_you\",max(case when linkid = 'choice-pronouns' then answer_value_text end) as \"add_family_member_registration_what_are_your_preferred_pronouns\",max(case when linkid = 'do-you-have-medicaid' then answer_value_text end) as \"add_family_member_registration_do_you_have_medicaid\",max(case when linkid = 'e6306275-b989-4375-8527-3a56092081b8' then answer_value_text end) as \"add_family_member_registration_first_name\",max(case when linkid = 'email-address' then answer_value_text end) as \"add_family_member_registration_email_address\",max(case when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd' then answer_value_text end) as \"add_family_member_registration_what_was_your_biological_sex_at_\",max(case when linkid = 'medicaid-number' then answer_value_text end) as \"add_family_member_registration_medicaid_number\",max(case when linkid = 'other-best-represents-how-you-think-of-yourself' then answer_value_text end) as \"add_family_member_registration_2\",max(case when linkid = 'other-biological-sex-at-birth' then answer_value_text end) as \"add_family_member_registration_3\",max(case when linkid = 'other-gender-identity' then answer_value_text end) as \"add_family_member_registration_4\",max(case when linkid = 'other-pronouns' then answer_value_text end) as \"add_family_member_registration_5\",max(case when linkid = 'other-where-did-you-first-learn-about-engage' then answer_value_text end) as \"add_family_member_registration_6\",max(case when linkid = 'phone-number' then answer_value_text end) as \"add_family_member_registration_phone_number\",max(case when linkid = 'physical-address' then answer_value_text end) as \"add_family_member_registration_physical_address\",max(case when linkid = 'where-did-you-first-learn-about-engage' then answer_value_text end) as \"add_family_member_registration_where_did_you_first_learn_about_\",max(case when linkid = 'zip-code' then answer_value_text end) as \"add_family_member_registration_zip_code\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_registration_info\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:11.313461Z", "completed_at": "2025-09-30T20:11:12.151942Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:12.152400Z", "completed_at": "2025-09-30T20:11:12.431153Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1240367889404297, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_planning_next_steps", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Planning Next Steps with readable column names\n-- Questionnaire ID: q-planning-next-steps\n-- Source file: questionnaire/assessments/planning-next-steps.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7' then answer_value_text end) as \"planning_next_stepsreferral_to_mental_health_specialist_where_w\",max(case when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7' then answer_value_text end) as \"planning_next_stepsprobable_severe_mental_health_problem_additi\",max(case when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f' then answer_value_text end) as \"planning_next_steps_additional_details\",max(case when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d' then answer_value_text end) as \"planning_next_steps_did_you_discuss_this_client_s_scores_with_a\",max(case when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6' then answer_value_text end) as \"planning_next_stepssafety_planning_intervention_spi_did_the_cli\",max(case when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9' then answer_value_text end) as \"planning_next_stepsreferral_to_mental_health_specialist_additio\",max(case when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01' then answer_value_text end) as \"planning_next_stepsother_agency_services_did_the_client_accept_\",max(case when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d' then answer_value_text end) as \"planning_next_stepsinterpersonal_counseling_ipc_did_the_client_\",max(case when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f' then answer_value_text end) as \"planning_next_stepsoptional_supports_is_the_client_interested_i\",max(case when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7' then answer_value_text end) as \"planning_next_stepssafety_planning_intervention_spi_why_does_th\",max(case when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123' then answer_value_text end) as \"planning_next_stepsother_agency_services_please_specify_which_o\",max(case when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae' then answer_value_text end) as \"planning_next_stepsinterpersonal_counseling_ipc_why_does_the_cl\",max(case when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345' then answer_value_text end) as \"planning_next_stepsother_agency_services_if_the_client_declined\",max(case when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf' then answer_value_text end) as \"planning_next_stepsinterpersonal_counseling_ipc_schedule_ipc_se\",max(case when linkid = '69712544-6237-4962-a455-ee6e9ee80000' then answer_value_text end) as \"planning_next_stepsfinancial_hardships_did_the_client_accept_fi\",max(case when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e' then answer_value_text end) as \"planning_next_steps_did_the_client_accept_spi\",max(case when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574' then answer_value_text end) as \"planning_next_steps_please_specify\",max(case when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106' then answer_value_text end) as \"planning_next_stepsprobable_common_mental_health_problem_schedu\",max(case when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d' then answer_value_text end) as \"planning_next_stepsprobable_severe_mental_health_problem_did_th\",max(case when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d' then answer_value_text end) as \"planning_next_steps_what_is_the_supervisor_s_recommendation_for\",max(case when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab' then answer_value_text end) as \"planning_next_stepsother_services_outside_of_the_agency_did_the\",max(case when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e' then answer_value_text end) as \"additional_notes_additional_notes_or_information\",max(case when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e' then answer_value_text end) as \"planning_next_steps_did_the_client_complete_spi\",max(case when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc' then answer_value_text end) as \"planning_next_stepsother_services_outside_of_the_agency_please_\",max(case when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e' then answer_value_text end) as \"planning_next_stepssbirt_motivational_interviewing_did_the_clie\",max(case when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f' then answer_value_text end) as \"planning_next_stepsprobable_common_mental_health_problem_did_th\",max(case when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4' then answer_value_text end) as \"planning_next_steps_did_the_client_accept_sbirt\",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd' then answer_value_text end) as \"planning_next_stepsother_services_outside_of_the_agency_if_the_\",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f' then answer_value_text end) as \"planning_next_stepsfinancial_wellness_supports_did_the_client_a\",max(case when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f' then answer_value_text end) as \"planning_next_stepssbirt_motivational_interviewing_why_does_the\",max(case when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a' then answer_value_text end) as \"planning_next_steps_schedule_sbirt_session\",max(case when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g' then answer_value_text end) as \"planning_next_steps_if_the_client_declined_please_indicate_the_\",max(case when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a' then answer_value_text end) as \"planning_next_stepsfinancial_wellness_supports_why_does_the_cli\",max(case when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90' then answer_value_text end) as \"planning_next_stepssbirt_motivational_interviewing_schedule_sbi\",max(case when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h' then answer_value_text end) as \"planning_next_stepsprobable_common_mental_health_problem_if_the\",max(case when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7' then answer_value_text end) as \"planning_next_stepsprobable_severe_mental_health_problem_where_\",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b' then answer_value_text end) as \"planning_next_stepsfinancial_wellness_supports_if_the_client_de\",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4' then answer_value_text end) as \"planning_next_stepsreferral_to_mental_health_specialist_did_the\",max(case when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5' then answer_value_text end) as \"planning_next_stepsreferral_to_mental_health_specialist_why_doe\",max(case when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100' then answer_value_text end) as \"planning_next_steps_if_the_client_declined_please_indicate_th_2\",max(case when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i' then answer_value_text end) as \"planning_next_steps_has_the_supervisor_assessed_the_client_to_d\",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_superviso_2\",max(case when linkid = 'financial-hardships-list' then answer_value_text end) as \"planning_next_steps_financial_hardships_list\",max(case when linkid = 'is-fws' then answer_value_text end) as \"is_fws\",max(case when linkid = 'is-ipc' then answer_value_text end) as \"is_ipc\",max(case when linkid = 'is-ipc-main' then answer_value_text end) as \"is_ipc_main\",max(case when linkid = 'is-ipc-optional' then answer_value_text end) as \"is_ipc_optional\",max(case when linkid = 'is-mhs' then answer_value_text end) as \"is_mhs\",max(case when linkid = 'is-other-agency-services' then answer_value_text end) as \"is_other_agency_services\",max(case when linkid = 'is-other-services-outside-agency' then answer_value_text end) as \"is_other_services_outside_agency\",max(case when linkid = 'is-sbirt' then answer_value_text end) as \"is_sbirt\",max(case when linkid = 'is-sbirt-main' then answer_value_text end) as \"is_sbirt_main\",max(case when linkid = 'is-sbirt-optional' then answer_value_text end) as \"is_sbirt_optional\",max(case when linkid = 'is-spi' then answer_value_text end) as \"is_spi\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient_age_4\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient_date_of_birth_4\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient_name_4\",max(case when linkid = 'scheduled-ipc-session-1-with-current-time' then answer_value_text end) as \"planning_next_steps_scheduled_ipc_session_1_with_current_time\",max(case when linkid = 'scheduled-ipc-session-1-with-current-time-2' then answer_value_text end) as \"scheduled_ipc_session_1_with_current_time_2\",max(case when linkid = 'task-id-000' then answer_value_text end) as \"planning_next_steps_taskid_000\",max(case when linkid = 'task-id-001' then answer_value_text end) as \"planning_next_steps_taskid_001\",max(case when linkid = 'task-id-002' then answer_value_text end) as \"planning_next_steps_taskid_002\",max(case when linkid = 'task-id-003' then answer_value_text end) as \"planning_next_steps_taskid_003\",max(case when linkid = 'task-id-004' then answer_value_text end) as \"planning_next_steps_taskid_004\",max(case when linkid = 'task-id-006' then answer_value_text end) as \"planning_next_steps_taskid_006\",max(case when linkid = 'task-id-planning-next-steps-pdf' then answer_value_text end) as \"planning_next_steps_taskid_pdf\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_planning_next_steps\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:11.310239Z", "completed_at": "2025-09-30T20:11:12.145148Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:12.145503Z", "completed_at": "2025-09-30T20:11:12.431759Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1284689903259277, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 4) with readable column names\n-- Questionnaire ID: 211\n-- Source file: questionnaire/ipc-session-4/phq-9-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/211') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_40\",max(case when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_41\",max(case when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_42\",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_3\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_5\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_5\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"common_mental_health_symptoms_little_interest_or_pleasure_in__5\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_5\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_falling_or_staying_asle_5\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_tired_or_having_little__5\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"common_mental_health_symptoms_poor_appetite_or_overeating_5\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_5\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"common_mental_health_symptoms_trouble_concentrating_on_things_5\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:12.447549Z", "completed_at": "2025-09-30T20:11:13.405529Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:13.405966Z", "completed_at": "2025-09-30T20:11:13.963139Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5206432342529297, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Short-Form PCL-5-8 (IPC Session 1) with readable column names\n-- Questionnaire ID: 204\n-- Source file: questionnaire/ipc-session-1/sf-pcl-5-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/204') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_43\",max(case when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_44\",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_9\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__10\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__11\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__12\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__13\",max(case when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f' then answer_value_text end) as \"pcl_5_item\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__14\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_8\",max(case when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161' then answer_value_text end) as \"pcl_5_item_2\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_8\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_8\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_8\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_45\",max(case when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a' then answer_value_text end) as \"pcl_5_item_3\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__15\",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_46\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__16\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_47\",max(case when linkid = 'f1.26.1' then answer_value_text end) as \"form_f1_question_26\",max(case when linkid = 'f1.27.1' then answer_value_text end) as \"form_f1_question_27\",max(case when linkid = 'f1.28.1' then answer_value_text end) as \"form_f1_question_28\",max(case when linkid = 'f1.29.1' then answer_value_text end) as \"form_f1_question_29\",max(case when linkid = 'f1.30.1' then answer_value_text end) as \"form_f1_question_30\",max(case when linkid = 'is-ptsd' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_48\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_49\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:12.443560Z", "completed_at": "2025-09-30T20:11:13.424767Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:13.424984Z", "completed_at": "2025-09-30T20:11:13.968140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5311839580535889, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sbirt", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SBIRT with readable column names\n-- Questionnaire ID: 212\n-- Source file: questionnaire/sbirt.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/212') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '0466b304-2876-409b-ade2-d1c675614854' then answer_value_text end) as \"sbirt_please_select_one_substance_you_would_like_to_discuss_fur\",max(case when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_methamphetam\",max(case when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f' then answer_value_text end) as \"sbirt_cocaine_coke_crack_etc\",max(case when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9' then answer_value_text end) as \"survey_response_2\",max(case when linkid = '1600f791-fd2c-44d8-8384-37973785741b' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_do_\",max(case when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78' then answer_value_text end) as \"sbirt_i_would_like_to_offer_an_opportunity_to_start_a_conversat\",max(case when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed_co\",max(case when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_sto\",max(case when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_2\",max(case when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_drink_alcohol\",max(case when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_str\",max(case when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0' then answer_value_text end) as \"survey_response_3\",max(case when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812' then answer_value_text end) as \"survey_response_4\",max(case when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_2\",max(case when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_2\",max(case when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_3\",max(case when linkid = '36af2335-ac86-4864-8a3d-619451160cc5' then answer_value_text end) as \"sbirt_i_want_to_use_no_more_than\",max(case when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f' then answer_value_text end) as \"sbirt\",max(case when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5' then answer_value_text end) as \"sbirt_what_service_was_the_client_referred_to\",max(case when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3' then answer_value_text end) as \"sbirt_prescription_stimulants_just_for_the_feeling_more_than_pr\",max(case when linkid = '39843731-a8e7-4822-bad7-55489947ebeb' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_other_drugs\",max(case when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f' then answer_value_text end) as \"sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecstasy_et\",max(case when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528' then answer_value_text end) as \"sbirt_i_want_to_use_no_more_than_2\",max(case when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_prescription_sti\",max(case when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730' then answer_value_text end) as \"sbirt_would_you_be_interested_in_talking_and_learning_more_abou\",max(case when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3' then answer_value_text end) as \"sbirt_are_you_interested_in_learning_more_about_what_alcohol_do\",max(case when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_methamphetamine_\",max(case when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_other_drugs_led_\",max(case when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_cocaine\",max(case when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_3\",max(case when linkid = '582271e0-892e-4795-ac55-0b73baf828ca' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__2\",max(case when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045' then answer_value_text end) as \"sbirt_i_want_to_drink_no_more_than\",max(case when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb' then answer_value_text end) as \"sbirt_2\",max(case when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__3\",max(case when linkid = '6281fa0d-ef3f-4013-bd31-062371828010' then answer_value_text end) as \"sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whippets_etc\",max(case when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e' then answer_value_text end) as \"sbirt_have_you_or_someone_else_been_injured_as_a_result_of_your\",max(case when linkid = '654d5688-f42a-469b-8494-81115b760e29' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__4\",max(case when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621' then answer_value_text end) as \"sbirt_how_often_do_you_have_six_or_more_drinks_on_one_occasion\",max(case when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_cannabis\",max(case when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_inhalants_led_to\",max(case when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_needed_a_first_dr\",max(case when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_4\",max(case when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_hallucinogen\",max(case when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6' then answer_value_text end) as \"sbirt_what_are_your_health_goals_around_substance_use\",max(case when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_3\",max(case when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848' then answer_value_text end) as \"sbirt_have_you_ever_experienced_withdrawal_symptoms_felt_sick_w\",max(case when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5' then answer_value_text end) as \"survey_response_5\",max(case when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__5\",max(case when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_sedatives\",max(case when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_cannabis_led_to_\",max(case when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3' then answer_value_text end) as \"sbirt_i_want_to_drink_no_more_than_2\",max(case when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_5\",max(case when linkid = '8427af19-3bad-4713-bad9-b179437fef96' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_street_opioi\",max(case when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d' then answer_value_text end) as \"sbirt_would_you_like_to_make_some_health_goals_around_substance\",max(case when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4' then answer_value_text end) as \"sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_of_drug_\",max(case when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_6\",max(case when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_other_dr\",max(case when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427' then answer_value_text end) as \"sbirt_did_the_client_accept_the_referral\",max(case when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_4\",max(case when linkid = '90876967-c973-4bee-9217-8c7482cb12a2' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_7\",max(case when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_had_a_feeling_of_\",max(case when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1' then answer_value_text end) as \"sbirt_how_many_standard_drinks_containing_alcohol_do_you_have_o\",max(case when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_4\",max(case when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_been_unable_to_re\",max(case when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3' then answer_value_text end) as \"sbirt_lets_start_by_discussing_the_pros_and_cons_of_changing_yo\",max(case when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368' then answer_value_text end) as \"sbirt_cannabis_marijuana_pot_grass_hash_etc\",max(case when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_inhalants\",max(case when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_5\",max(case when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__6\",max(case when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_street_opioids_o\",max(case when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_cocaine\",max(case when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_6\",max(case when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11' then answer_value_text end) as \"sbirt_how_often_do_you_have_a_drink_containing_alcohol\",max(case when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__7\",max(case when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__8\",max(case when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404' then answer_value_text end) as \"sbirt_any_other_drugs_to_get_high\",max(case when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4' then answer_value_text end) as \"sbirt_have_you_neglected_your_family_because_of_your_use_of_dru\",max(case when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848' then answer_value_text end) as \"sbirt_street_opioids_heroin_opium_etc_or_prescription_opioids_j\",max(case when linkid = 'ad609c63-366e-476a-b131-610ceed211da' then answer_value_text end) as \"survey_response_6\",max(case when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_hallucinogens_le\",max(case when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041' then answer_value_text end) as \"sbirt_are_you_interested_in_learning_more_about_what_the_substa\",max(case when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_8\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_7\",max(case when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267' then answer_value_text end) as \"sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use\",max(case when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7' then answer_value_text end) as \"sbirt_things_others_can_help_you_do\",max(case when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__9\",max(case when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_5\",max(case when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_sedative\",max(case when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990' then answer_value_text end) as \"sbirt_have_you_had_medical_problems_as_a_result_of_your_drug_us\",max(case when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3' then answer_value_text end) as \"sbirt_have_you_ever_used_any_drugs_by_injection_non_medical_use\",max(case when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299' then answer_value_text end) as \"sbirt_other_drugs\",max(case when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c' then answer_value_text end) as \"sbirt_have_you_engaged_in_illegal_activities_in_order_to_obtain\",max(case when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_prescrip\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_7\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_7\",max(case when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_methamph\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_7\",max(case when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_9\",max(case when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_failed_to_do_what\",max(case when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_cocaine_led_to_h\",max(case when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_cannabis\",max(case when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_7\",max(case when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_6\",max(case when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41' then answer_value_text end) as \"sbirt_does_your_spouse_or_parents_ever_complain_about_your_invo\",max(case when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_street_o\",max(case when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491' then answer_value_text end) as \"sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_all_and_1\",max(case when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_inhalant\",max(case when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4' then answer_value_text end) as \"sbirt_was_the_client_referred\",max(case when linkid = 'drug-to-use-alcohol' then answer_value_text end) as \"sbirt_drug_to_use_alcohol\",max(case when linkid = 'drug-to-use-marijuana-or-other' then answer_value_text end) as \"sbirt_drug_to_use_marijuana_or_other\",max(case when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_sedatives_led_to\",max(case when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_7\",max(case when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_8\",max(case when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_hallucin\",max(case when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d' then answer_value_text end) as \"sbirt_would_you_be_interested_in_learning_more_about_substance_\",max(case when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9' then answer_value_text end) as \"sbirt_are_you_always_able_to_stop_using_drugs_when_you_want_to\",max(case when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3' then answer_value_text end) as \"sbirt_things_you_can_do\",max(case when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_prescription\",max(case when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe' then answer_value_text end) as \"sbirt_sedatives_just_for_the_feeling_more_than_prescribed_or_th\",max(case when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509' then answer_value_text end) as \"sbirt_what_are_some_good_things_about_making_a_change\",max(case when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_found_that_you_we\",max(case when linkid = 'edced328-6f82-458a-bce4-35987bff19fb' then answer_value_text end) as \"survey_response_7\",max(case when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b' then answer_value_text end) as \"sbirt_have_you_used_drugs_other_than_those_required_for_medical\",max(case when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88' then answer_value_text end) as \"sbirt_has_a_relative_or_friend_or_a_doctor_or_another_health_wo\",max(case when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_9\",max(case when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac' then answer_value_text end) as \"sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_etc\",max(case when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_8\",max(case when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_9\",max(case when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1' then answer_value_text end) as \"survey_response_8\",max(case when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba' then answer_value_text end) as \"sbirt_do_you_use_more_than_one_drug_at_a_time\",max(case when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19' then answer_value_text end) as \"sbirt_can_i_share_additional_treatment_options_with_you\",max(case when linkid = 'health-goals-do-not-want-to-change' then answer_value_text end) as \"sbirt_health_goals_do_not_want_to_change\",max(case when linkid = 'is-drug-dependence' then answer_value_text end) as \"sbirt_is_drug_dependence\",max(case when linkid = 'is-high-risk-alcohol' then answer_value_text end) as \"sbirt_is_high_risk_alcohol\",max(case when linkid = 'is-high-risk-drug' then answer_value_text end) as \"sbirt_is_high_risk_drug\",max(case when linkid = 'is-low-risk-alcohol' then answer_value_text end) as \"sbirt_is_low_risk_alcohol\",max(case when linkid = 'is-low-risk-drug' then answer_value_text end) as \"sbirt_is_low_risk_drug\",max(case when linkid = 'is-medium-risk-alcohol' then answer_value_text end) as \"sbirt_is_medium_risk_alcohol\",max(case when linkid = 'is-medium-risk-drug' then answer_value_text end) as \"sbirt_is_medium_risk_drug\",max(case when linkid = 'is-opioid-dependence' then answer_value_text end) as \"sbirt_is_opioid_dependence\",max(case when linkid = 'other-drug-list' then answer_value_text end) as \"sbirt_other_drug_list\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-gender' then answer_value_text end) as \"patient-gender\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'score-audit' then answer_value_text end) as \"sbirt_score_audit\",max(case when linkid = 'score-dast' then answer_value_text end) as \"sbirt_score_dast\",max(case when linkid = 'should-converse-about-substance-use' then answer_value_text end) as \"sbirt_should_converse_about_substance_use\",max(case when linkid = 'should-discuss-health-goals' then answer_value_text end) as \"sbirt_should_discuss_health_goals\",max(case when linkid = 'show-client-use-with-other-drugs' then answer_value_text end) as \"sbirt_show_client_use_with_other_drugs\",max(case when linkid = 'show-discuss-next-steps' then answer_value_text end) as \"sbirt_show_discuss_next_steps\",max(case when linkid = 'show-goals' then answer_value_text end) as \"sbirt_show_goals\",max(case when linkid = 'show-intervention-when-low-risk' then answer_value_text end) as \"sbirt_show_intervention_when_low_risk\",max(case when linkid = 'show-intervention-when-medium-high-risk' then answer_value_text end) as \"sbirt_show_intervention_when_medium_high_risk\",max(case when linkid = 'show-is-medium-high-risk' then answer_value_text end) as \"sbirt_show_is_medium_high_risk\",max(case when linkid = 'show-summary-for-low-risk' then answer_value_text end) as \"sbirt_show_summary_for_low_risk\",max(case when linkid = 'show-things-to-do' then answer_value_text end) as \"sbirt_show_things_to_do\",max(case when linkid = 'task-id-sbirt-pdf' then answer_value_text end) as \"sbirt_task_id_sbirt_pdf\",max(case when linkid = 'using-opioids-and-low-risk' then answer_value_text end) as \"sbirt_using_opioids_and_low_risk\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sbirt\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:12.439984Z", "completed_at": "2025-09-30T20:11:13.388613Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:13.388840Z", "completed_at": "2025-09-30T20:11:13.967244Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5323560237884521, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_remove_patient", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- eCBIS Remove Family Form with readable column names\n-- Questionnaire ID: 69\n-- Source file: questionnaire/generic/remove_patient.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/69') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f' then answer_value_text end) as \"ecbis_remove_family_form_date_of_death\",max(case when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a' then answer_value_text end) as \"ecbis_remove_family_form_give_other_reasons_for_removal\",max(case when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5' then answer_value_text end) as \"ecbis_remove_family_form_age_at_death_year\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b' then answer_value_text end) as \"ecbis_remove_family_form\",max(case when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1' then answer_value_text end) as \"ecbis_remove_family_form_date_moved_away\",max(case when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec' then answer_value_text end) as \"survey_response\",max(case when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff' then answer_value_text end) as \"ecbis_remove_family_form_reason_for_removal\",max(case when linkid = 'patient-birthdate' then answer_value_text end) as \"patient-birthdate\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_remove_patient\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:12.450031Z", "completed_at": "2025-09-30T20:11:13.401159Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:13.402049Z", "completed_at": "2025-09-30T20:11:13.968843Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5268092155456543, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Short-Form PCL-5-8 (IPC Session 2) with readable column names\n-- Questionnaire ID: 56\n-- Source file: questionnaire/ipc-session-2/sf-pcl-5-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/56') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__17\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__18\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__19\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__20\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__21\",max(case when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc' then answer_value_text end) as \"pcl_5_item_4\",max(case when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_50\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__22\",max(case when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4' then answer_value_text end) as \"pcl_5_item_5\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_51\",max(case when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d' then answer_value_text end) as \"pcl_5_item_6\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__23\",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_52\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__24\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_53\",max(case when linkid = 'f1.26.1' then answer_value_text end) as \"form_f1_question_26_2\",max(case when linkid = 'f1.27.1' then answer_value_text end) as \"form_f1_question_27_2\",max(case when linkid = 'f1.28.1' then answer_value_text end) as \"form_f1_question_28_2\",max(case when linkid = 'f1.29.1' then answer_value_text end) as \"form_f1_question_29_2\",max(case when linkid = 'f1.30.1' then answer_value_text end) as \"form_f1_question_30_2\",max(case when linkid = 'is-ptsd' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_54\",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_55\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:13.986893Z", "completed_at": "2025-09-30T20:11:14.758918Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:14.761036Z", "completed_at": "2025-09-30T20:11:14.899321Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9134202003479004, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sociodemographic_survey", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Sociodemographic Survey with readable column names\n-- Questionnaire ID: 1613531\n-- Source file: questionnaire/assessments/sociodemographic_survey.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/1613531') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7' then answer_value_text end) as \"sociodemographic_survey_if_you_were_not_born_in_the_us_how_long\",max(case when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5' then answer_value_text end) as \"sociodemographic_survey_please_specify\",max(case when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde' then answer_value_text end) as \"sociodemographic_survey_please_specify_2\",max(case when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe' then answer_value_text end) as \"sociodemographic_survey_where_were_you_born\",max(case when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af' then answer_value_text end) as \"demographic_question\",max(case when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739' then answer_value_text end) as \"demographic_question_2\",max(case when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d' then answer_value_text end) as \"sociodemographic_survey_please_enter_the_number_of_years\",max(case when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173' then answer_value_text end) as \"sociodemographic_survey_we_would_like_to_know_about_what_you_do\",max(case when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130' then answer_value_text end) as \"demographic_question_3\",max(case when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4' then answer_value_text end) as \"sociodemographic_survey_please_enter_the_number_of_months\",max(case when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9' then answer_value_text end) as \"sociodemographic_survey_what_is_your_race_and_or_ethnicity\",max(case when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0' then answer_value_text end) as \"demographic_question_4\",max(case when linkid = '92fed595-49f2-4fab-81ff-885941f31e07' then answer_value_text end) as \"demographic_question_5\",max(case when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a' then answer_value_text end) as \"sociodemographic_survey_what_is_your_marital_status\",max(case when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c' then answer_value_text end) as \"demographic_question_6\",max(case when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba' then answer_value_text end) as \"sociodemographic_survey_what_was_the_highest_grade_or_level_of_\",max(case when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f' then answer_value_text end) as \"sociodemographic_survey_please_specify_3\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as \"patient-biological-sex\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as \"patient-gender-identity\",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as \"patient-how-you-think-of-yourself\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'patient-pronouns' then answer_value_text end) as \"patient-pronouns\",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as \"task_id_socio_pdf_2\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sociodemographic_survey\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:13.978156Z", "completed_at": "2025-09-30T20:11:14.762604Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:14.762820Z", "completed_at": "2025-09-30T20:11:14.900669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9257309436798096, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Short-Form PCL-5-8 (IPC Session 4) with readable column names\n-- Questionnaire ID: 210\n-- Source file: questionnaire/ipc-session-4/sf-pcl-5-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/210') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__33\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__34\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__35\",max(case when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_61\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__36\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__37\",max(case when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8' then answer_value_text end) as \"pcl_5_item_10\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__38\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_62\",max(case when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e' then answer_value_text end) as \"pcl_5_item_11\",max(case when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef' then answer_value_text end) as \"pcl_5_item_12\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__39\",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_63\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__40\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_64\",max(case when linkid = 'f1.26.1' then answer_value_text end) as \"form_f1_question_26_4\",max(case when linkid = 'f1.27.1' then answer_value_text end) as \"form_f1_question_27_4\",max(case when linkid = 'f1.28.1' then answer_value_text end) as \"form_f1_question_28_4\",max(case when linkid = 'f1.29.1' then answer_value_text end) as \"form_f1_question_29_4\",max(case when linkid = 'f1.30.1' then answer_value_text end) as \"form_f1_question_30_4\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:13.993510Z", "completed_at": "2025-09-30T20:11:14.758713Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:14.759120Z", "completed_at": "2025-09-30T20:11:14.902050Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9254589080810547, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Short-Form PCL-5-8 (IPC Session 3) with readable column names\n-- Questionnaire ID: 60\n-- Source file: questionnaire/ipc-session-3/sf-pcl-5-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/60') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__25\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__26\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__27\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__28\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__29\",max(case when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49' then answer_value_text end) as \"pcl_5_item_7\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__30\",max(case when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_56\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_57\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__31\",max(case when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e' then answer_value_text end) as \"pcl_5_item_8\",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_58\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__32\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_59\",max(case when linkid = 'f1.26.1' then answer_value_text end) as \"form_f1_question_26_3\",max(case when linkid = 'f1.27.1' then answer_value_text end) as \"form_f1_question_27_3\",max(case when linkid = 'f1.28.1' then answer_value_text end) as \"form_f1_question_28_3\",max(case when linkid = 'f1.29.1' then answer_value_text end) as \"form_f1_question_29_3\",max(case when linkid = 'f1.30.1' then answer_value_text end) as \"form_f1_question_30_3\",max(case when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17' then answer_value_text end) as \"pcl_5_item_9\",max(case when linkid = 'is-ptsd' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_60\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:14.177137Z", "completed_at": "2025-09-30T20:11:14.938933Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:14.939243Z", "completed_at": "2025-09-30T20:11:14.968683Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.792302131652832, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SPI Subform 1 with readable column names\n-- Questionnaire ID: 104455\n-- Source file: questionnaire/spi/spi-subform-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/104455') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d' then answer_value_text end) as \"spi_subform_1_is_medium_risk\",max(case when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5' then answer_value_text end) as \"spi_subform_1_were_any_of_these_in_the_past_three_months\",max(case when linkid = '35062b98-748b-441c-ad74-185823e1bb52' then answer_value_text end) as \"spi_subform_1_in_the_past_month_have_you_been_thinking_about_ho\",max(case when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b' then answer_value_text end) as \"spi_subform_1_is_high_risk\",max(case when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb' then answer_value_text end) as \"spi_subform_1_in_the_past_month_have_you_had_these_thoughts_and\",max(case when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03' then answer_value_text end) as \"spi_subform_1\",max(case when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23' then answer_value_text end) as \"spi_subform_1_in_the_past_month_have_you_started_to_work_out_or\",max(case when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837' then answer_value_text end) as \"spi_subform_1_2\",max(case when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9' then answer_value_text end) as \"spi_subform_1_3\",max(case when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511' then answer_value_text end) as \"spi_subform_1_in_the_past_month_have_you_wished_you_were_dead_o\",max(case when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda' then answer_value_text end) as \"spi_subform_1_4\",max(case when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea' then answer_value_text end) as \"spi_subform_1_have_you_ever_done_anything_started_to_do_anythin\",max(case when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42' then answer_value_text end) as \"spi_subform_1_5\",max(case when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423' then answer_value_text end) as \"spi_subform_1_6\",max(case when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab' then answer_value_text end) as \"spi_subform_1_is_low_risk\",max(case when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce' then answer_value_text end) as \"spi_subform_1_in_the_past_month_have_you_actually_had_any_thoug\",max(case when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019' then answer_value_text end) as \"spi_subform_1_7\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_65\",max(case when linkid = 'task-id-spi-subform-2' then answer_value_text end) as \"spi_subform_1_taskid_spi_subform_2\",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as \"spi_subform_2_taskid_spi_subform_3\",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as \"spi_subform_2_taskid_spi_subform_4\",max(case when linkid = 'task-status-spi-subform-2' then answer_value_text end) as \"spi_subform_1_taskstatus_spi_subform_2\",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as \"spi_subform_2_taskstatus_spi_subform_3\",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as \"spi_subform_2_taskstatus_spi_subform_4\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:14.911520Z", "completed_at": "2025-09-30T20:11:15.804534Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:15.808783Z", "completed_at": "2025-09-30T20:11:16.130084Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2233541011810303, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SPI Subform 3 with readable column names\n-- Questionnaire ID: 104454\n-- Source file: questionnaire/spi/spi-subform-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/104454') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_67\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:14.914179Z", "completed_at": "2025-09-30T20:11:15.863324Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:15.863811Z", "completed_at": "2025-09-30T20:11:16.132263Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.2268040180206299, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SPI Subform 4 with readable column names\n-- Questionnaire ID: 104394\n-- Source file: questionnaire/spi/spi-subform-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/104394') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12' then answer_value_text end) as \"spi_item\",max(case when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49' then answer_value_text end) as \"spi_subform_4\",max(case when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_serv\",max(case when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_se_2\",max(case when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_se_3\",max(case when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f' then answer_value_text end) as \"spi_subform_4_taking_pills_i_will_protect_myself_from_this_risk\",max(case when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_duri\",max(case when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888' then answer_value_text end) as \"spi_subform_4_2\",max(case when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_may_\",max(case when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969' then answer_value_text end) as \"spi_subform_4_3\",max(case when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_du_2\",max(case when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_du_3\",max(case when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0' then answer_value_text end) as \"review_the_safety_planstep_2_internal_coping_strategies\",max(case when linkid = '15e5007d-028f-4644-8fb6-0346730c3101' then answer_value_text end) as \"spi_subform_4_4\",max(case when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98' then answer_value_text end) as \"spi_item_2\",max(case when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_se_4\",max(case when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564' then answer_value_text end) as \"spi_subform_4_5\",max(case when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_se_5\",max(case when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_du_4\",max(case when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_du_5\",max(case when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942' then answer_value_text end) as \"review_the_safety_planstep_6_making_the_environment_safe_cuttin\",max(case when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3' then answer_value_text end) as \"spi_subform_4_jumping_i_will_protect_myself_from_this_risk_by\",max(case when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99' then answer_value_text end) as \"spi_subform_4_hanging_i_will_protect_myself_from_this_risk_by\",max(case when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8' then answer_value_text end) as \"spi_subform_4_in_a_few_days_i_would_like_to_meet_for_a_follow_u\",max(case when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3' then answer_value_text end) as \"spi_subform_4_6\",max(case when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36' then answer_value_text end) as \"review_the_safety_planstep_6_making_the_environment_safe_jumpin\",max(case when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_are_you_will\",max(case when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_se_6\",max(case when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63' then answer_value_text end) as \"spi_subform_4_7\",max(case when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e' then answer_value_text end) as \"spi_subform_4_8\",max(case when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b' then answer_value_text end) as \"spi_subform_4_9\",max(case when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2' then answer_value_text end) as \"spi_subform_4_10\",max(case when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_se_7\",max(case when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6' then answer_value_text end) as \"spi_subform_4_11\",max(case when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_se_8\",max(case when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_se_9\",max(case when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6' then answer_value_text end) as \"spi_subform_4_12\",max(case when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_2\",max(case when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a' then answer_value_text end) as \"spi_subform_4_13\",max(case when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_10\",max(case when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3' then answer_value_text end) as \"spi_subform_4_14\",max(case when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331' then answer_value_text end) as \"spi_item_3\",max(case when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe' then answer_value_text end) as \"spi_item_4\",max(case when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070' then answer_value_text end) as \"spi_subform_4_15\",max(case when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2' then answer_value_text end) as \"spi_subform_4_16\",max(case when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_11\",max(case when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_12\",max(case when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_13\",max(case when linkid = '437d9ea2-adb5-471a-828b-a0285a282217' then answer_value_text end) as \"review_the_safety_planstep_1_warning_signs\",max(case when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_du_6\",max(case when linkid = '45772f3f-c610-408b-942b-359769945cf4' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_14\",max(case when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_du_7\",max(case when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f' then answer_value_text end) as \"spi_subform_4_17\",max(case when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_15\",max(case when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264' then answer_value_text end) as \"spi_item_5\",max(case when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd' then answer_value_text end) as \"spi_subform_4_18\",max(case when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52' then answer_value_text end) as \"spi_subform_4_person_3\",max(case when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_du_8\",max(case when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_are_you_wi_2\",max(case when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7' then answer_value_text end) as \"spi_subform_4_the_methods_i_have_thought_about_using_include\",max(case when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124' then answer_value_text end) as \"review_the_safety_planstep_1_warning_signs_2\",max(case when linkid = '53932020-eed8-46f4-8236-d548a6335a59' then answer_value_text end) as \"spi_subform_4_drowning_i_will_protect_myself_from_this_risk_by\",max(case when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7' then answer_value_text end) as \"spi_subform_4_19\",max(case when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47' then answer_value_text end) as \"spi_subform_4_20\",max(case when linkid = '544a444d-b101-4d56-9351-00bca8ec749e' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_person_2\",max(case when linkid = '54b75d55-1c43-4552-acbf-d9754831add8' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_16\",max(case when linkid = '57e87170-761c-4b57-a09c-d50cab02860c' then answer_value_text end) as \"spi_subform_4_21\",max(case when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233' then answer_value_text end) as \"spi_subform_4_person_2\",max(case when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d' then answer_value_text end) as \"spi_item_6\",max(case when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_17\",max(case when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206' then answer_value_text end) as \"spi_subform_4_22\",max(case when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea' then answer_value_text end) as \"spi_subform_4_23\",max(case when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c' then answer_value_text end) as \"spi_subform_4_24\",max(case when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123' then answer_value_text end) as \"spi_subform_4_25\",max(case when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05' then answer_value_text end) as \"spi_item_7\",max(case when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_18\",max(case when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13' then answer_value_text end) as \"spi_subform_4_26\",max(case when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de' then answer_value_text end) as \"spi_item_8\",max(case when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help\",max(case when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5' then answer_value_text end) as \"spi_subform_4_person_4\",max(case when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_19\",max(case when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_20\",max(case when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_21\",max(case when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68' then answer_value_text end) as \"spi_subform_4_cutting_i_will_protect_myself_from_this_risk_by\",max(case when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609' then answer_value_text end) as \"review_the_safety_planstep_1_warning_signs_3\",max(case when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_22\",max(case when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_3\",max(case when linkid = '74d0f0df-e726-4c40-84ce-efece882818b' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_23\",max(case when linkid = '7845c436-4904-41fa-9553-2c401935623b' then answer_value_text end) as \"review_the_safety_planstep_2_internal_coping_strategies_2\",max(case when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_du_9\",max(case when linkid = '7b51625b-73b9-472d-9c71-299beb26694f' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_24\",max(case when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_25\",max(case when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7' then answer_value_text end) as \"review_the_safety_planstep_2_internal_coping_strategies_3\",max(case when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_2\",max(case when linkid = '808ba31c-cd29-4743-8801-dfce357d5956' then answer_value_text end) as \"spi_subform_4_person_1\",max(case when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_26\",max(case when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164' then answer_value_text end) as \"review_the_safety_planstep_1_warning_signs_4\",max(case when linkid = '83dfd82f-0277-459d-abe3-e8795750f288' then answer_value_text end) as \"spi_subform_4_person_5\",max(case when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_3\",max(case when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_27\",max(case when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8' then answer_value_text end) as \"spi_item_9\",max(case when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_4\",max(case when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73' then answer_value_text end) as \"spi_subform_4_using_a_firearm_i_will_protect_myself_from_this_r\",max(case when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c' then answer_value_text end) as \"spi_subform_4_27\",max(case when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf' then answer_value_text end) as \"spi_subform_4_28\",max(case when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410' then answer_value_text end) as \"spi_subform_4_taskid_my_safety_plan_pdf\",max(case when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_10\",max(case when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4' then answer_value_text end) as \"spi_subform_4_29\",max(case when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_28\",max(case when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc' then answer_value_text end) as \"spi_subform_4_30\",max(case when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031' then answer_value_text end) as \"spi_subform_4_31\",max(case when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_11\",max(case when linkid = '965b7874-dd24-4215-acd4-8d241a262638' then answer_value_text end) as \"spi_subform_4_32\",max(case when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_5\",max(case when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d' then answer_value_text end) as \"spi_item_10\",max(case when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_6\",max(case when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_29\",max(case when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3' then answer_value_text end) as \"spi_subform_4_33\",max(case when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_12\",max(case when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0' then answer_value_text end) as \"when_you_feel_a_suicidal_crisis_arising_go_through_each_step_of\",max(case when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f' then answer_value_text end) as \"review_the_safety_planstep_1_warning_signs_5\",max(case when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_13\",max(case when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478' then answer_value_text end) as \"spi_subform_4_34\",max(case when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_14\",max(case when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0' then answer_value_text end) as \"spi_subform_4_person_1_2\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi' then answer_value_text end) as \"spi_subform_4_taskid_spi_navigator\",max(case when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871' then answer_value_text end) as \"spi_subform_4_35\",max(case when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33' then answer_value_text end) as \"spi_subform_4_person_4_2\",max(case when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2' then answer_value_text end) as \"spi_item_11\",max(case when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_30\",max(case when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d' then answer_value_text end) as \"spi_subform_4_person_5_2\",max(case when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531' then answer_value_text end) as \"review_the_safety_planstep_6_making_the_environment_safe_taking\",max(case when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_15\",max(case when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af' then answer_value_text end) as \"spi_subform_4_36\",max(case when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256' then answer_value_text end) as \"review_the_safety_planstep_2_internal_coping_strategies_4\",max(case when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185' then answer_value_text end) as \"spi_subform_4_i_would_like_to_make_a_plan_that_will_help_you_ma\",max(case when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_7\",max(case when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_31\",max(case when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_16\",max(case when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_32\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_9\",max(case when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b' then answer_value_text end) as \"spi_item_12\",max(case when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_8\",max(case when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351' then answer_value_text end) as \"spi_item_13\",max(case when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad' then answer_value_text end) as \"spi_subform_4_37\",max(case when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_4\",max(case when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6' then answer_value_text end) as \"spi_subform_4_38\",max(case when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12' then answer_value_text end) as \"spi_subform_4_39\",max(case when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_17\",max(case when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f' then answer_value_text end) as \"spi_subform_4_40\",max(case when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_18\",max(case when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_9\",max(case when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_19\",max(case when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_are_you_wi_3\",max(case when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46' then answer_value_text end) as \"spi_subform_4_41\",max(case when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de' then answer_value_text end) as \"spi_subform_4_42\",max(case when linkid = 'c5720a67-803f-4917-8261-3738de838418' then answer_value_text end) as \"spi_subform_4_other_ways_i_will_make_my_environment_safer\",max(case when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0' then answer_value_text end) as \"spi_subform_4_43\",max(case when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_20\",max(case when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_21\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_9\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_9\",max(case when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_22\",max(case when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048' then answer_value_text end) as \"review_the_safety_planstep_2_internal_coping_strategies_5\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_9\",max(case when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7' then answer_value_text end) as \"spi_subform_4_44\",max(case when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_23\",max(case when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_m_10\",max(case when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_24\",max(case when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14' then answer_value_text end) as \"review_the_safety_planstep_6_making_the_environment_safe_going_\",max(case when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7' then answer_value_text end) as \"spi_item_14\",max(case when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_25\",max(case when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_m_11\",max(case when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba' then answer_value_text end) as \"spi_subform_4_45\",max(case when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95' then answer_value_text end) as \"spi_subform_4_person_2_2\",max(case when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_person_1\",max(case when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_m_12\",max(case when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2' then answer_value_text end) as \"review_the_safety_planstep_6_making_the_environment_safe_using_\",max(case when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54' then answer_value_text end) as \"spi_subform_4_46\",max(case when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_33\",max(case when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_26\",max(case when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_27\",max(case when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_28\",max(case when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_29\",max(case when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8' then answer_value_text end) as \"spi_item_15\",max(case when linkid = 'df53c378-27fe-483d-a630-f7b171f72980' then answer_value_text end) as \"spi_subform_4_47\",max(case when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf' then answer_value_text end) as \"review_the_safety_planstep_6_making_the_environment_safe_hangin\",max(case when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9' then answer_value_text end) as \"spi_item_16\",max(case when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_34\",max(case when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_m_13\",max(case when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0' then answer_value_text end) as \"spi_item_17\",max(case when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660' then answer_value_text end) as \"spi_subform_4_48\",max(case when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a' then answer_value_text end) as \"spi_subform_4_49\",max(case when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_30\",max(case when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_31\",max(case when linkid = 'e9c42647-eefb-42bd-9080-f83630729606' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_m_14\",max(case when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_person_3\",max(case when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198' then answer_value_text end) as \"review_the_safety_planstep_6_making_the_environment_safe_drowni\",max(case when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_m_15\",max(case when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248' then answer_value_text end) as \"review_the_safety_planstep_5_professionals_or_professional_s_35\",max(case when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d' then answer_value_text end) as \"spi_subform_4_50\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_68\",max(case when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39' then answer_value_text end) as \"review_the_safety_planstep_6_making_the_environment_safe_other_\",max(case when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc' then answer_value_text end) as \"spi_subform_4_51\",max(case when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_32\",max(case when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_m_16\",max(case when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3' then answer_value_text end) as \"spi_subform_4_person_3_2\",max(case when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_33\",max(case when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003' then answer_value_text end) as \"spi_subform_4_your_local_hotline_number\",max(case when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0' then answer_value_text end) as \"spi_subform_4_52\",max(case when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_34\",max(case when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa' then answer_value_text end) as \"step_5professionals_or_professional_services_that_can_help_d_35\",max(case when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8' then answer_value_text end) as \"spi_subform_4_53\",max(case when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54' then answer_value_text end) as \"spi_subform_4_additional_hotline_numbers_you_can_contact\",max(case when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807' then answer_value_text end) as \"spi_subform_4_54\",max(case when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449' then answer_value_text end) as \"spi_subform_4_going_in_front_of_a_moving_vehicle_i_will_protect\",max(case when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604' then answer_value_text end) as \"review_the_safety_planstep_4_family_members_or_friends_who_m_17\",max(case when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e' then answer_value_text end) as \"spi_subform_4_55\",max(case when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_5\",max(case when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7' then answer_value_text end) as \"step_4family_members_or_friends_who_may_offer_help_6\",max(case when linkid = 'no-response-step-1' then answer_value_text end) as \"spi_subform_4_56\",max(case when linkid = 'no-response-step-1-review' then answer_value_text end) as \"no_response_step_1_review\",max(case when linkid = 'no-response-step-2' then answer_value_text end) as \"spi_subform_4_57\",max(case when linkid = 'no-response-step-2-review' then answer_value_text end) as \"no_response_step_2_review\",max(case when linkid = 'no-response-step-3' then answer_value_text end) as \"spi_subform_4_58\",max(case when linkid = 'no-response-step-3-review' then answer_value_text end) as \"no_response_step_3_review\",max(case when linkid = 'no-response-step-4' then answer_value_text end) as \"spi_subform_4_59\",max(case when linkid = 'no-response-step-4-review' then answer_value_text end) as \"no_response_step_4_review\",max(case when linkid = 'no-response-step-6a' then answer_value_text end) as \"spi_subform_4_60\",max(case when linkid = 'no-response-step-6a-review' then answer_value_text end) as \"no_response_step_6a_review\",max(case when linkid = 'other-signs-step-1' then answer_value_text end) as \"spi_subform_4_61\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:14.971404Z", "completed_at": "2025-09-30T20:11:15.907402Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:15.907721Z", "completed_at": "2025-09-30T20:11:16.133317Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1638238430023193, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- IPC Session 1 with readable column names\n-- Questionnaire ID: 55\n-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/55') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as \"person_2\",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_69\",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_70\",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_71\",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as \"ipc_session_1_what_about_before_that_was_there_a_time_before_in\",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_72\",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_73\",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as \"ipc_session_1_earlier_than_that_you_noticed_symptoms\",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as \"ipc_session_1_is_there_anything_else_that_we_did_not_discuss_th\",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as \"ipc_session_1\",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as \"ipc_session_1_possible_problem_areas\",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_74\",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as \"ipc_session_1_what_were_the_symptoms\",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as \"ipc_session_1_2\",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as \"ipc_session_1_3\",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_75\",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as \"survey_response_9\",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as \"ipc_session_1_your_most_distressing_current_symptoms_began\",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as \"ipc_session_1_when_did_these_symptoms_begin\",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as \"ipc_session_1_when_did_you_notice_these_symptoms\",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as \"ipc_session_1_these_are_the_symptoms_you_said_you_are_currently\",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_76\",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as \"person_3\",max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as \"ipc_session_1_patient_age\",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as \"ipc_session_1_4\",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as \"ipc_session_1_i_noticed_that_when_i_was_asking_about_important_\",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as \"ipc_session_1_patient_dob\",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as \"ipc_session_1_5\",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_77\",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as \"mood_rating_ipc_session_1_2\",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as \"ipc_session_1_6\",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_78\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_79\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_80\",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as \"ipc_session_1_do_you_agree_with_this_summary\",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as \"ipc_session_1_in_what_format_did_you_deliver_this_session_with_\",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as \"ipc_session_1_7\",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_81\",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as \"ipc_session_2_did_you_complete_the_required_assessment_s_and_th\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_10\",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as \"ipc_session_1_is_there_anything_that_could_get_in_the_way_of_yo\",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_82\",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as \"ipc_session_1_what_was_going_on_in_your_life_when_you_started_t\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_10\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_10\",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as \"ipc_session_1_8\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_10\",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_83\",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as \"mood_rating_ipc_session_1_total_score_2\",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_84\",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as \"ipc_session_1_what_was_happening_then\",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as \"ipc_session_1_9\",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_85\",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as \"ipc_session_1_of_these_symptoms_which_are_the_most_distressing\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_86\",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as \"ipc_session_1_at_that_time_you_were_experiencing\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__5\",max(case when linkid = 'f1.38.3' then answer_value_text end) as \"form_f1_question_38\",max(case when linkid = 'f1.38.4' then answer_value_text end) as \"ipc_session_1_10\",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as \"person_1\",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as \"person_1_2\",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as \"person_1_how_has_this_relationship_changed_following_trauma_if_\",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as \"person_1_person_1_is\",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as \"person_2_2\",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as \"person_2_3\",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as \"person_2_how_has_this_relationship_changed_following_trauma_if_\",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as \"person_2_person_2_is\",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as \"person_3_2\",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as \"person_3_3\",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as \"person_3_how_has_this_relationship_changed_following_trauma_if_\",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as \"person_3_person_3_is\",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as \"person_4\",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as \"person_4_2\",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as \"person_4_how_has_this_relationship_changed_following_trauma_if_\",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as \"person_4_person_4_is\",max(case when linkid = 'f1.40.11' then answer_value_text end) as \"ipc_session_1_11\",max(case when linkid = 'f1.40.12' then answer_value_text end) as \"ipc_session_1_has_this_person_been_consistently_close_to_you_or\",max(case when linkid = 'f1.40.2' then answer_value_text end) as \"ipc_session_1_12\",max(case when linkid = 'f1.40.3' then answer_value_text end) as \"ipc_session_1_has_this_person_been_consistently_close_to_you__2\",max(case when linkid = 'f1.40.5' then answer_value_text end) as \"ipc_session_1_13\",max(case when linkid = 'f1.40.6' then answer_value_text end) as \"ipc_session_1_has_this_person_been_consistently_close_to_you__3\",max(case when linkid = 'f1.40.8' then answer_value_text end) as \"ipc_session_1_14\",max(case when linkid = 'f1.40.9' then answer_value_text end) as \"ipc_session_1_has_this_person_been_consistently_close_to_you__4\",max(case when linkid = 'f1.42.2' then answer_value_text end) as \"ipc_session_1_do_you_think_an_important_person_s_death_is_conne\",max(case when linkid = 'f1.43.2' then answer_value_text end) as \"ipc_session_1_tell_me_about_your_relationship_with_this_person_\",max(case when linkid = 'f1.46.2' then answer_value_text end) as \"form_f1_question_46\",max(case when linkid = 'f1.68.2' then answer_value_text end) as \"ipc_session_1_are_you_and_someone_else_having_a_strong_disagree\",max(case when linkid = 'f1.69.2' then answer_value_text end) as \"ipc_session_1_briefly_tell_me_about_the_disagreement\",max(case when linkid = 'f1.69.3' then answer_value_text end) as \"ipc_session_1_when_did_this_disagreement_happen\",max(case when linkid = 'f1.70.2' then answer_value_text end) as \"ipc_session_1_how_has_this_disagreement_been_affecting_you\",max(case when linkid = 'f1.72.2' then answer_value_text end) as \"ipc_session_1_have_there_been_any_changes_in_your_life_that_are\",max(case when linkid = 'f1.73.2' then answer_value_text end) as \"ipc_session_1_what_was_the_change\",max(case when linkid = 'f1.74.2' then answer_value_text end) as \"ipc_session_1_when_did_this_happen\",max(case when linkid = 'f1.76.2' then answer_value_text end) as \"ipc_session_1_if_the_client_did_not_mention_any_close_relations\",max(case when linkid = 'f1.78.2' then answer_value_text end) as \"ipc_session_1_would_you_say_you_have_close_relationships\",max(case when linkid = 'f1.79.2' then answer_value_text end) as \"ipc_session_1_has_anything_changed_in_your_life_so_that_now_you\",max(case when linkid = 'f1.79.3' then answer_value_text end) as \"ipc_session_1_when_did_this_event_happen\",max(case when linkid = 'f1.81.3' then answer_value_text end) as \"ipc_session_1_15\",max(case when linkid = 'f1.81.4' then answer_value_text end) as \"ipc_session_1_16\",max(case when linkid = 'f1.82.2' then answer_value_text end) as \"ipc_session_1_do_you_want_to_propose_an_interpersonal_formulati\",max(case when linkid = 'f1.87.2' then answer_value_text end) as \"ipc_session_1_do_you_agree_with_this\",max(case when linkid = 'f1.88.2' then answer_value_text end) as \"ipc_session_1_17\",max(case when linkid = 'f1.89.2' then answer_value_text end) as \"ipc_session_1_select_the_possible_interpersonal_problem_area_s_\",max(case when linkid = 'f1.92.1' then answer_value_text end) as \"ipc_session_1_18\",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as \"ipc_session_1_at_that_time_you_were_experiencing_2\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_87\",max(case when linkid = 'task-id-008' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_88\",max(case when linkid = 'task-id-009' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_89\",max(case when linkid = 'task-id-010' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_90\",max(case when linkid = 'task-id-012' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_91\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:14.907570Z", "completed_at": "2025-09-30T20:11:15.804173Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:15.804920Z", "completed_at": "2025-09-30T20:11:16.133937Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2295379638671875, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SPI Subform 2 with readable column names\n-- Questionnaire ID: 104453\n-- Source file: questionnaire/spi/spi-subform-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/104453') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36' then answer_value_text end) as \"spi_subform_2_did_this_client_also_screen_positive_for_probable\",max(case when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896' then answer_value_text end) as \"spi_subform_2_did_you_discuss_this_client_s_severe_mental_healt\",max(case when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b' then answer_value_text end) as \"spi_subform_2_this_client_scored_in_the_moderate_to_high_range_\",max(case when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76' then answer_value_text end) as \"spi_subform_2_what_is_the_recommended_plan_to_address_the_proba\",max(case when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f' then answer_value_text end) as \"spi_subform_2\",max(case when linkid = '783e2646-c8ea-466d-bba8-85c891a14435' then answer_value_text end) as \"spi_subform_2_2\",max(case when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50' then answer_value_text end) as \"spi_subform_2_3\",max(case when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f' then answer_value_text end) as \"spi_subform_2_what_is_the_recommended_plan_to_address_the_pro_2\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_66\",max(case when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253' then answer_value_text end) as \"spi_subform_2_did_you_discuss_this_client_s_suicide_risk_screen\",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as \"spi_subform_2_taskid_spi_subform_3_2\",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as \"spi_subform_2_taskid_spi_subform_4_2\",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as \"spi_subform_2_taskstatus_spi_subform_3_2\",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as \"spi_subform_2_taskstatus_spi_subform_4_2\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.157902Z", "completed_at": "2025-09-30T20:11:16.201862Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.202099Z", "completed_at": "2025-09-30T20:11:16.215264Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06650876998901367, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_1_month_follow_up_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_1_month_follow_up\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_1_month_follow_up'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_1_month_follow_up\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'one_month_follow_up_scheduling_have_you_completed_all_recommend' OR linkid = 'one_month_follow_up_scheduling_have_you_completed_all_recommend' OR short_name = 'one_month_follow_up_scheduling_have_you_completed_all_recommend')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"one_month_follow_up_scheduling_have_you_completed_all_recommend\"\n            END as \"one_month_follow_up_scheduling_have_you_completed_all_recommend\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'describe_one_month_follow_up_let_s_schedule_this_meeting_now' OR linkid = 'describe_one_month_follow_up_let_s_schedule_this_meeting_now' OR short_name = 'describe_one_month_follow_up_let_s_schedule_this_meeting_now')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"describe_one_month_follow_up_let_s_schedule_this_meeting_now\"\n            END as \"describe_one_month_follow_up_let_s_schedule_this_meeting_now\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_1_month_follow_up_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.217545Z", "completed_at": "2025-09-30T20:11:16.250184Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.250486Z", "completed_at": "2025-09-30T20:11:16.273128Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.056266069412231445, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_confidential_s1_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_confidential_s1\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_confidential_s1'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_confidential_s1\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age' OR linkid = 'add_family_member_registration_calculated_age' OR short_name = 'add_family_member_registration_calculated_age')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age\"\n            END as \"add_family_member_registration_calculated_age\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month' OR linkid = 'add_family_member_registration_calculated_month' OR short_name = 'add_family_member_registration_calculated_month')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month\"\n            END as \"add_family_member_registration_calculated_month\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year' OR linkid = 'add_family_member_registration_calculated_year' OR short_name = 'add_family_member_registration_calculated_year')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year\"\n            END as \"add_family_member_registration_calculated_year\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth' OR linkid = 'add_family_member_registration_date_of_birth' OR short_name = 'add_family_member_registration_date_of_birth')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth\"\n            END as \"add_family_member_registration_date_of_birth\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR short_name = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\"\n            END as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_confidential_s1_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.276681Z", "completed_at": "2025-09-30T20:11:16.350027Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.350371Z", "completed_at": "2025-09-30T20:11:16.391685Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11576414108276367, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_financial_wellness_tool_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_financial_wellness_tool\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_financial_wellness_tool'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_financial_wellness_tool\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_in_the_past_12_months_was_there_a_time_' OR linkid = 'financial_wellness_tool_in_the_past_12_months_was_there_a_time_' OR short_name = 'financial_wellness_tool_in_the_past_12_months_was_there_a_time_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_in_the_past_12_months_was_there_a_time_\"\n            END as \"financial_wellness_tool_in_the_past_12_months_was_there_a_time_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_in_the_past_12_months_did_you_not_pay_t' OR linkid = 'financial_wellness_tool_in_the_past_12_months_did_you_not_pay_t' OR short_name = 'financial_wellness_tool_in_the_past_12_months_did_you_not_pay_t')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_in_the_past_12_months_did_you_not_pay_t\"\n            END as \"financial_wellness_tool_in_the_past_12_months_did_you_not_pay_t\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_how_hard_is_it_for_you_to_pay_for_the_v' OR linkid = 'financial_wellness_tool_how_hard_is_it_for_you_to_pay_for_the_v' OR short_name = 'financial_wellness_tool_how_hard_is_it_for_you_to_pay_for_the_v')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_how_hard_is_it_for_you_to_pay_for_the_v\"\n            END as \"financial_wellness_tool_how_hard_is_it_for_you_to_pay_for_the_v\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_how_strongly_do_you_agree_or_disagree_w' OR linkid = 'financial_wellness_tool_how_strongly_do_you_agree_or_disagree_w' OR short_name = 'financial_wellness_tool_how_strongly_do_you_agree_or_disagree_w')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_how_strongly_do_you_agree_or_disagree_w\"\n            END as \"financial_wellness_tool_how_strongly_do_you_agree_or_disagree_w\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_in_the_past_12_months_did_you_move_in_w' OR linkid = 'financial_wellness_tool_in_the_past_12_months_did_you_move_in_w' OR short_name = 'financial_wellness_tool_in_the_past_12_months_did_you_move_in_w')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_in_the_past_12_months_did_you_move_in_w\"\n            END as \"financial_wellness_tool_in_the_past_12_months_did_you_move_in_w\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_in_the_past_12_months_how_often_did_you' OR linkid = 'financial_wellness_tool_in_the_past_12_months_how_often_did_you' OR short_name = 'financial_wellness_tool_in_the_past_12_months_how_often_did_you')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_in_the_past_12_months_how_often_did_you\"\n            END as \"financial_wellness_tool_in_the_past_12_months_how_often_did_you\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_in_the_past_12_months_did_you_stay_at_a' OR linkid = 'financial_wellness_tool_in_the_past_12_months_did_you_stay_at_a' OR short_name = 'financial_wellness_tool_in_the_past_12_months_did_you_stay_at_a')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_in_the_past_12_months_did_you_stay_at_a\"\n            END as \"financial_wellness_tool_in_the_past_12_months_did_you_stay_at_a\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_in_the_past_12_months_did_you_not_pay_2' OR linkid = 'financial_wellness_tool_in_the_past_12_months_did_you_not_pay_2' OR short_name = 'financial_wellness_tool_in_the_past_12_months_did_you_not_pay_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_in_the_past_12_months_did_you_not_pay_2\"\n            END as \"financial_wellness_tool_in_the_past_12_months_did_you_not_pay_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_i_worried_whether_my_food_would_run_out' OR linkid = 'financial_wellness_tool_i_worried_whether_my_food_would_run_out' OR short_name = 'financial_wellness_tool_i_worried_whether_my_food_would_run_out')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_i_worried_whether_my_food_would_run_out\"\n            END as \"financial_wellness_tool_i_worried_whether_my_food_would_run_out\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_the_food_that_i_bought_just_didn_t_last' OR linkid = 'financial_wellness_tool_the_food_that_i_bought_just_didn_t_last' OR short_name = 'financial_wellness_tool_the_food_that_i_bought_just_didn_t_last')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_the_food_that_i_bought_just_didn_t_last\"\n            END as \"financial_wellness_tool_the_food_that_i_bought_just_didn_t_last\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_in_the_past_12_months_was_your_phone_ga' OR linkid = 'financial_wellness_tool_in_the_past_12_months_was_your_phone_ga' OR short_name = 'financial_wellness_tool_in_the_past_12_months_was_your_phone_ga')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        CASE\n                            WHEN \"financial_wellness_tool_in_the_past_12_months_was_your_phone_ga\" IS NOT NULL AND LENGTH(\"financial_wellness_tool_in_the_past_12_months_was_your_phone_ga\"::text) >= 4\n                            THEN 'XXX-XXX-' || RIGHT(\"financial_wellness_tool_in_the_past_12_months_was_your_phone_ga\"::text, 4)\n                            ELSE 'NO PHONE'\n                        END\n                    \n                ELSE \"financial_wellness_tool_in_the_past_12_months_was_your_phone_ga\"\n            END as \"financial_wellness_tool_in_the_past_12_months_was_your_phone_ga\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_when_you_think_about_your_financial_sit' OR linkid = 'financial_wellness_tool_when_you_think_about_your_financial_sit' OR short_name = 'financial_wellness_tool_when_you_think_about_your_financial_sit')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_when_you_think_about_your_financial_sit\"\n            END as \"financial_wellness_tool_when_you_think_about_your_financial_sit\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool' OR linkid = 'financial_wellness_tool' OR short_name = 'financial_wellness_tool')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool\"\n            END as \"financial_wellness_tool\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_2' OR linkid = 'financial_wellness_tool_2' OR short_name = 'financial_wellness_tool_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_2\"\n            END as \"financial_wellness_tool_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_3' OR linkid = 'financial_wellness_tool_3' OR short_name = 'financial_wellness_tool_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_3\"\n            END as \"financial_wellness_tool_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_4' OR linkid = 'financial_wellness_tool_4' OR short_name = 'financial_wellness_tool_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_4\"\n            END as \"financial_wellness_tool_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_5' OR linkid = 'financial_wellness_tool_5' OR short_name = 'financial_wellness_tool_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_5\"\n            END as \"financial_wellness_tool_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_6' OR linkid = 'financial_wellness_tool_6' OR short_name = 'financial_wellness_tool_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_6\"\n            END as \"financial_wellness_tool_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_7' OR linkid = 'financial_wellness_tool_7' OR short_name = 'financial_wellness_tool_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_7\"\n            END as \"financial_wellness_tool_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_8' OR linkid = 'financial_wellness_tool_8' OR short_name = 'financial_wellness_tool_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_8\"\n            END as \"financial_wellness_tool_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_9' OR linkid = 'financial_wellness_tool_9' OR short_name = 'financial_wellness_tool_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_9\"\n            END as \"financial_wellness_tool_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_10' OR linkid = 'financial_wellness_tool_10' OR short_name = 'financial_wellness_tool_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_10\"\n            END as \"financial_wellness_tool_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'financial_wellness_tool_11' OR linkid = 'financial_wellness_tool_11' OR short_name = 'financial_wellness_tool_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"financial_wellness_tool_11\"\n            END as \"financial_wellness_tool_11\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_financial_wellness_tool_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.395159Z", "completed_at": "2025-09-30T20:11:16.447681Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.447889Z", "completed_at": "2025-09-30T20:11:16.479397Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0853118896484375, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_common_mental_health_symptoms_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_common_mental_health_symptoms\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_common_mental_health_symptoms'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_common_mental_health_symptoms\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpath' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpath' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpath')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpath\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpath\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_wer' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_wer' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_wer')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_wer\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_wer\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_2' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_2' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_2\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_2' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_2' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_2\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_3' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_3' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_3\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_3' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_3' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_3\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_4' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_4' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_4\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_5' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_5' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_5\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_4' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_4' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_4\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_f' OR linkid = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_f' OR short_name = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_f')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_f\"\n            END as \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_f\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_5' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_5' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_5\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_6' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_6' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_6\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_6' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_6' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_6\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_7' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_7' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_7\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_8' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_8' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_8\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_that' OR linkid = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_that' OR short_name = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_that')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_moving_or_speaking_so_slowly_that\"\n            END as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_that\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_thoughts_that_you_would_be_better' OR linkid = 'common_mental_health_symptoms_thoughts_that_you_would_be_better' OR short_name = 'common_mental_health_symptoms_thoughts_that_you_would_be_better')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_thoughts_that_you_would_be_better\"\n            END as \"common_mental_health_symptoms_thoughts_that_you_would_be_better\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_edg' OR linkid = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_edg' OR short_name = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_edg')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_edg\"\n            END as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_edg\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_not_being_able_to_stop_or_control' OR linkid = 'common_mental_health_symptoms_not_being_able_to_stop_or_control' OR short_name = 'common_mental_health_symptoms_not_being_able_to_stop_or_control')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_not_being_able_to_stop_or_control\"\n            END as \"common_mental_health_symptoms_not_being_able_to_stop_or_control\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_worrying_too_much_about_different' OR linkid = 'common_mental_health_symptoms_worrying_too_much_about_different' OR short_name = 'common_mental_health_symptoms_worrying_too_much_about_different')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_worrying_too_much_about_different\"\n            END as \"common_mental_health_symptoms_worrying_too_much_about_different\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_relaxing' OR linkid = 'common_mental_health_symptoms_trouble_relaxing' OR short_name = 'common_mental_health_symptoms_trouble_relaxing')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_relaxing\"\n            END as \"common_mental_health_symptoms_trouble_relaxing\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_being_so_restless_that_it_s_hard_' OR linkid = 'common_mental_health_symptoms_being_so_restless_that_it_s_hard_' OR short_name = 'common_mental_health_symptoms_being_so_restless_that_it_s_hard_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_being_so_restless_that_it_s_hard_\"\n            END as \"common_mental_health_symptoms_being_so_restless_that_it_s_hard_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irrita' OR linkid = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irrita' OR short_name = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irrita')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_becoming_easily_annoyed_or_irrita\"\n            END as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irrita\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_afraid_as_if_something_aw' OR linkid = 'common_mental_health_symptoms_feeling_afraid_as_if_something_aw' OR short_name = 'common_mental_health_symptoms_feeling_afraid_as_if_something_aw')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_afraid_as_if_something_aw\"\n            END as \"common_mental_health_symptoms_feeling_afraid_as_if_something_aw\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_little_interest_or_pleasure_in_do' OR linkid = 'common_mental_health_symptoms_little_interest_or_pleasure_in_do' OR short_name = 'common_mental_health_symptoms_little_interest_or_pleasure_in_do')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_little_interest_or_pleasure_in_do\"\n            END as \"common_mental_health_symptoms_little_interest_or_pleasure_in_do\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_down_depressed_or_hopeles' OR linkid = 'common_mental_health_symptoms_feeling_down_depressed_or_hopeles' OR short_name = 'common_mental_health_symptoms_feeling_down_depressed_or_hopeles')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_down_depressed_or_hopeles\"\n            END as \"common_mental_health_symptoms_feeling_down_depressed_or_hopeles\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_falling_or_staying_asleep' OR linkid = 'common_mental_health_symptoms_trouble_falling_or_staying_asleep' OR short_name = 'common_mental_health_symptoms_trouble_falling_or_staying_asleep')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_falling_or_staying_asleep\"\n            END as \"common_mental_health_symptoms_trouble_falling_or_staying_asleep\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_tired_or_having_little_en' OR linkid = 'common_mental_health_symptoms_feeling_tired_or_having_little_en' OR short_name = 'common_mental_health_symptoms_feeling_tired_or_having_little_en')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_tired_or_having_little_en\"\n            END as \"common_mental_health_symptoms_feeling_tired_or_having_little_en\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_poor_appetite_or_overeating' OR linkid = 'common_mental_health_symptoms_poor_appetite_or_overeating' OR short_name = 'common_mental_health_symptoms_poor_appetite_or_overeating')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_poor_appetite_or_overeating\"\n            END as \"common_mental_health_symptoms_poor_appetite_or_overeating\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_tha' OR linkid = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_tha' OR short_name = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_tha')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_bad_about_yourself_or_tha\"\n            END as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_tha\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_concentrating_on_things_s' OR linkid = 'common_mental_health_symptoms_trouble_concentrating_on_things_s' OR short_name = 'common_mental_health_symptoms_trouble_concentrating_on_things_s')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_concentrating_on_things_s\"\n            END as \"common_mental_health_symptoms_trouble_concentrating_on_things_s\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-age' OR linkid = 'patient-age' OR short_name = 'patient-age')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-age\"\n            END as \"patient-age\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-dob' OR linkid = 'patient-dob' OR short_name = 'patient-dob')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-dob\"\n            END as \"patient-dob\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-name' OR linkid = 'patient-name' OR short_name = 'patient-name')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-name\"\n            END as \"patient-name\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_7' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_7' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_7\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_8' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_8' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_8\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_8\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_common_mental_health_symptoms_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.482824Z", "completed_at": "2025-09-30T20:11:16.531045Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.531262Z", "completed_at": "2025-09-30T20:11:16.548221Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06677007675170898, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s3_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_gad_7_s3\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_gad_7_s3'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s3\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_20' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_20' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_20')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_20\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_20\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_21' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_21' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_21')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_21\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_21\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_22' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_22' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_22')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_22\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_22\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_4' OR linkid = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_4' OR short_name = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_4\"\n            END as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_4' OR linkid = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_4' OR short_name = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_4\"\n            END as \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_worrying_too_much_about_differe_4' OR linkid = 'common_mental_health_symptoms_worrying_too_much_about_differe_4' OR short_name = 'common_mental_health_symptoms_worrying_too_much_about_differe_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_worrying_too_much_about_differe_4\"\n            END as \"common_mental_health_symptoms_worrying_too_much_about_differe_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_relaxing_4' OR linkid = 'common_mental_health_symptoms_trouble_relaxing_4' OR short_name = 'common_mental_health_symptoms_trouble_relaxing_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_relaxing_4\"\n            END as \"common_mental_health_symptoms_trouble_relaxing_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_4' OR linkid = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_4' OR short_name = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_being_so_restless_that_it_s_har_4\"\n            END as \"common_mental_health_symptoms_being_so_restless_that_it_s_har_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_4' OR linkid = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_4' OR short_name = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_4\"\n            END as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_afraid_as_if_something__4' OR linkid = 'common_mental_health_symptoms_feeling_afraid_as_if_something__4' OR short_name = 'common_mental_health_symptoms_feeling_afraid_as_if_something__4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_afraid_as_if_something__4\"\n            END as \"common_mental_health_symptoms_feeling_afraid_as_if_something__4\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s3_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.550712Z", "completed_at": "2025-09-30T20:11:16.586139Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.586386Z", "completed_at": "2025-09-30T20:11:16.619900Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06984114646911621, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s1_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_gad_7_s1\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_gad_7_s1'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s1\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_9' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_9' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirpa_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_9\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirpa_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_10' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_10' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_10\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_11' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_11' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_11\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_12' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_12' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_12\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_2' OR linkid = 'add_family_member_registration_calculated_age_2' OR short_name = 'add_family_member_registration_calculated_age_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_2\"\n            END as \"add_family_member_registration_calculated_age_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_2' OR linkid = 'add_family_member_registration_calculated_month_2' OR short_name = 'add_family_member_registration_calculated_month_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_2\"\n            END as \"add_family_member_registration_calculated_month_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_2' OR linkid = 'add_family_member_registration_calculated_year_2' OR short_name = 'add_family_member_registration_calculated_year_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_2\"\n            END as \"add_family_member_registration_calculated_year_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_2' OR linkid = 'add_family_member_registration_date_of_birth_2' OR short_name = 'add_family_member_registration_date_of_birth_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_2\"\n            END as \"add_family_member_registration_date_of_birth_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_13' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_13' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_13\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_2' OR linkid = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_2' OR short_name = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_2\"\n            END as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_2' OR linkid = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_2' OR short_name = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_2\"\n            END as \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_worrying_too_much_about_differe_2' OR linkid = 'common_mental_health_symptoms_worrying_too_much_about_differe_2' OR short_name = 'common_mental_health_symptoms_worrying_too_much_about_differe_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_worrying_too_much_about_differe_2\"\n            END as \"common_mental_health_symptoms_worrying_too_much_about_differe_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_relaxing_2' OR linkid = 'common_mental_health_symptoms_trouble_relaxing_2' OR short_name = 'common_mental_health_symptoms_trouble_relaxing_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_relaxing_2\"\n            END as \"common_mental_health_symptoms_trouble_relaxing_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_2' OR linkid = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_2' OR short_name = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_being_so_restless_that_it_s_har_2\"\n            END as \"common_mental_health_symptoms_being_so_restless_that_it_s_har_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_2' OR linkid = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_2' OR short_name = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_2\"\n            END as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_afraid_as_if_something__2' OR linkid = 'common_mental_health_symptoms_feeling_afraid_as_if_something__2' OR short_name = 'common_mental_health_symptoms_feeling_afraid_as_if_something__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_afraid_as_if_something__2\"\n            END as \"common_mental_health_symptoms_feeling_afraid_as_if_something__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR short_name = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\"\n            END as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_14' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_14' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_14\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_14\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s1_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.623521Z", "completed_at": "2025-09-30T20:11:16.663453Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.663660Z", "completed_at": "2025-09-30T20:11:16.679181Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0568089485168457, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s4_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_gad_7_s4\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_gad_7_s4'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s4\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_23' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_23' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_23')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_23\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_23\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_24' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_24' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_24')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_24\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_24\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_25' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_25' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_25')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_25\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_25\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_5' OR linkid = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_5' OR short_name = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_5\"\n            END as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_5' OR linkid = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_5' OR short_name = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_5\"\n            END as \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_worrying_too_much_about_differe_5' OR linkid = 'common_mental_health_symptoms_worrying_too_much_about_differe_5' OR short_name = 'common_mental_health_symptoms_worrying_too_much_about_differe_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_worrying_too_much_about_differe_5\"\n            END as \"common_mental_health_symptoms_worrying_too_much_about_differe_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_relaxing_5' OR linkid = 'common_mental_health_symptoms_trouble_relaxing_5' OR short_name = 'common_mental_health_symptoms_trouble_relaxing_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_relaxing_5\"\n            END as \"common_mental_health_symptoms_trouble_relaxing_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_5' OR linkid = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_5' OR short_name = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_being_so_restless_that_it_s_har_5\"\n            END as \"common_mental_health_symptoms_being_so_restless_that_it_s_har_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_5' OR linkid = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_5' OR short_name = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_5\"\n            END as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_afraid_as_if_something__5' OR linkid = 'common_mental_health_symptoms_feeling_afraid_as_if_something__5' OR short_name = 'common_mental_health_symptoms_feeling_afraid_as_if_something__5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_afraid_as_if_something__5\"\n            END as \"common_mental_health_symptoms_feeling_afraid_as_if_something__5\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s4_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.681339Z", "completed_at": "2025-09-30T20:11:16.713417Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.713644Z", "completed_at": "2025-09-30T20:11:16.731876Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05125784873962402, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s2_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_gad_7_s2\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_gad_7_s2'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s2\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_15' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_15' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_15\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_16' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_16' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_16')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_16\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_16\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_17' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_17' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_17')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_17\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_17\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_18' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_18' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_18')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_18\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_18\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_3' OR linkid = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_3' OR short_name = 'common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_3\"\n            END as \"common_mental_health_symptoms_feeling_nervous_anxious_or_on_e_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_3' OR linkid = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_3' OR short_name = 'common_mental_health_symptoms_not_being_able_to_stop_or_contr_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_3\"\n            END as \"common_mental_health_symptoms_not_being_able_to_stop_or_contr_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_worrying_too_much_about_differe_3' OR linkid = 'common_mental_health_symptoms_worrying_too_much_about_differe_3' OR short_name = 'common_mental_health_symptoms_worrying_too_much_about_differe_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_worrying_too_much_about_differe_3\"\n            END as \"common_mental_health_symptoms_worrying_too_much_about_differe_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_relaxing_3' OR linkid = 'common_mental_health_symptoms_trouble_relaxing_3' OR short_name = 'common_mental_health_symptoms_trouble_relaxing_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_relaxing_3\"\n            END as \"common_mental_health_symptoms_trouble_relaxing_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_3' OR linkid = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_3' OR short_name = 'common_mental_health_symptoms_being_so_restless_that_it_s_har_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_being_so_restless_that_it_s_har_3\"\n            END as \"common_mental_health_symptoms_being_so_restless_that_it_s_har_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_3' OR linkid = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_3' OR short_name = 'common_mental_health_symptoms_becoming_easily_annoyed_or_irri_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_3\"\n            END as \"common_mental_health_symptoms_becoming_easily_annoyed_or_irri_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_afraid_as_if_something__3' OR linkid = 'common_mental_health_symptoms_feeling_afraid_as_if_something__3' OR short_name = 'common_mental_health_symptoms_feeling_afraid_as_if_something__3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_afraid_as_if_something__3\"\n            END as \"common_mental_health_symptoms_feeling_afraid_as_if_something__3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_19' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_19' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_19')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_19\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_19\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s2_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.733940Z", "completed_at": "2025-09-30T20:11:16.766829Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.767074Z", "completed_at": "2025-09-30T20:11:16.780375Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04709815979003906, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s4_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_mood_rating_s4\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_mood_rating_s4'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s4\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_4_total_score' OR linkid = 'mood_rating_ipc_session_4_total_score' OR short_name = 'mood_rating_ipc_session_4_total_score')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_4_total_score\"\n            END as \"mood_rating_ipc_session_4_total_score\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__4' OR linkid = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__4' OR short_name = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__4\"\n            END as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__4\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s4_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.782446Z", "completed_at": "2025-09-30T20:11:16.829406Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.829621Z", "completed_at": "2025-09-30T20:11:16.845173Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0637209415435791, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s1_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_mood_rating_s1\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_mood_rating_s1'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s1\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_1' OR linkid = 'mood_rating_ipc_session_1' OR short_name = 'mood_rating_ipc_session_1')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_1\"\n            END as \"mood_rating_ipc_session_1\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_3' OR linkid = 'add_family_member_registration_calculated_age_3' OR short_name = 'add_family_member_registration_calculated_age_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_3\"\n            END as \"add_family_member_registration_calculated_age_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_3' OR linkid = 'add_family_member_registration_calculated_month_3' OR short_name = 'add_family_member_registration_calculated_month_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_3\"\n            END as \"add_family_member_registration_calculated_month_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_3' OR linkid = 'add_family_member_registration_calculated_year_3' OR short_name = 'add_family_member_registration_calculated_year_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_3\"\n            END as \"add_family_member_registration_calculated_year_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_3' OR linkid = 'add_family_member_registration_date_of_birth_3' OR short_name = 'add_family_member_registration_date_of_birth_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_3\"\n            END as \"add_family_member_registration_date_of_birth_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_1_total_score' OR linkid = 'mood_rating_ipc_session_1_total_score' OR short_name = 'mood_rating_ipc_session_1_total_score')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_1_total_score\"\n            END as \"mood_rating_ipc_session_1_total_score\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being_th' OR linkid = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being_th' OR short_name = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being_th')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being_th\"\n            END as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being_th\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR short_name = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\"\n            END as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s1_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.848832Z", "completed_at": "2025-09-30T20:11:16.879727Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.879937Z", "completed_at": "2025-09-30T20:11:16.894364Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0462491512298584, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s3_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_mood_rating_s3\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_mood_rating_s3'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s3\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_3_total_score' OR linkid = 'mood_rating_ipc_session_3_total_score' OR short_name = 'mood_rating_ipc_session_3_total_score')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_3_total_score\"\n            END as \"mood_rating_ipc_session_3_total_score\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__3' OR linkid = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__3' OR short_name = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__3\"\n            END as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__3\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s3_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.896521Z", "completed_at": "2025-09-30T20:11:16.948355Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.948905Z", "completed_at": "2025-09-30T20:11:17.058733Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16350603103637695, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s2_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_mood_rating_s2\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_mood_rating_s2'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s2\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_total_score' OR linkid = 'mood_rating_ipc_session_2_total_score' OR short_name = 'mood_rating_ipc_session_2_total_score')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_total_score\"\n            END as \"mood_rating_ipc_session_2_total_score\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_4' OR linkid = 'add_family_member_registration_calculated_age_4' OR short_name = 'add_family_member_registration_calculated_age_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_4\"\n            END as \"add_family_member_registration_calculated_age_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_4' OR linkid = 'add_family_member_registration_calculated_month_4' OR short_name = 'add_family_member_registration_calculated_month_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_4\"\n            END as \"add_family_member_registration_calculated_month_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_4' OR linkid = 'add_family_member_registration_calculated_year_4' OR short_name = 'add_family_member_registration_calculated_year_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_4\"\n            END as \"add_family_member_registration_calculated_year_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_4' OR linkid = 'add_family_member_registration_date_of_birth_4' OR short_name = 'add_family_member_registration_date_of_birth_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_4\"\n            END as \"add_family_member_registration_date_of_birth_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__2' OR linkid = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__2' OR short_name = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__2\"\n            END as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__2\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s2_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.154500Z", "completed_at": "2025-09-30T20:11:16.939422Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.939667Z", "completed_at": "2025-09-30T20:11:17.060442Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.9139671325683594, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- IPC Session 4 with readable column names\n-- Questionnaire ID: 63\n-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/63') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as \"ipc_session_4_after_today_s_session_i_will_be_referring_you_for\",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as \"ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_how\",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as \"ipc_session_4_what_do_you_think_are_some_situations_that_may_tr\",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as \"ipc_session_4_what_do_you_think_are_some_situations_that_may__2\",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as \"ipc_session_4_i_am_going_to_provide_you_with_our_agency_s_conta\",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_did_you_d_2\",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_118\",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as \"ipc_session_4_how_does_it_make_you_feel_to_know_that_today_is_o\",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_what_is_t_2\",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as \"survey_response_13\",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as \"ipc_session_4_let_s_talk_about_what_skills_you_learned_here_tha\",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as \"ipc_session_4_let_s_talk_about_what_skills_you_learned_here_t_2\",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as \"ipc_session_4_let_s_look_at_your_symptom_changes_what_were_your\",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as \"mood_rating_ipc_session_4\",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as \"ipc_session_4_how_do_you_feel_about_today_being_our_last_sessio\",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_referral__2\",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as \"ipc_session_4_in_what_format_did_you_deliver_this_session_with_\",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as \"ipc_session_4_how_would_you_know_if_your_symptoms_are_coming_ba\",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as \"ipc_session_4_after_today_s_session_i_can_refer_you_for_clinica\",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as \"ipc_session_4_reason\",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as \"ipc_session_4_what_are_some_of_the_skills_you_learned_here_that\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_119\",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_120\",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as \"ipc_session_4_please_select_how_you_would_like_to_proceed_with_\",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as \"ipc_session_4_what_do_you_think_you_still_need_to_work_on_regar\",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as \"ipc_session_4_what_we_know_is_that_symptoms_can_come_back_in_th\",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as \"ipc_session_4_what_do_you_think_you_still_need_to_work_on_reg_2\",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as \"ipc_session_2_did_you_complete_the_required_assessment_s_and__4\",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as \"survey_response_14\",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as \"ipc_session_4_total_score\",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as \"ipc_session_4_what_are_some_of_the_skills_you_learned_here_th_2\",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as \"ipc_session_4_let_s_look_at_your_symptom_changes_what_were_yo_2\",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_121\",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as \"ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_h_2\",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as \"survey_response_15\",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as \"ipc_session_4_phq_9_total\",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as \"ipc_session_4_gad_7_total\",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as \"ipc_session_4_ptsd_total\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__8\",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as \"discussion_with_supervisor_for_severe_mental_health_superviso_3\",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as \"ipc_session_4_details\",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as \"ipc_session_4_is_the_client_connected_to_clinical_care\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.150004Z", "completed_at": "2025-09-30T20:11:16.950730Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.951431Z", "completed_at": "2025-09-30T20:11:17.062352Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9192550182342529, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- IPC Session 3 with readable column names\n-- Questionnaire ID: 208\n-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/208') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as \"decision_analysis_example_guiding_prompts_not_all_questions_n_5\",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as \"ipc_session_2_phq_9_total_meaning_2\",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as \"interpersonal_skills_building_example_skills_5\",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as \"ipc_session_2_gad_7_total_meaning_2\",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_5\",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as \"renegotiation\",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as \"communication_analysis_example_guiding_prompts_not_all_questi_5\",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as \"explore_the_problem_questions_asked_in_session_2_2\",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as \"identified_stage_of_disagreement_stage_identified_in_session_2\",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_6\",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as \"mood_rating_ipc_session_3_total_score_2\",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as \"impasse_questions_asked_in_session_2_2\",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as \"feelings_about_change_questions_asked_in_session_2_2\",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as \"explore_new_relationships_and_re_establish_old_relationships__2\",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as \"decision_analysis_5\",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_7\",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_105\",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_5\",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as \"discuss_the_relationship\",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as \"assess_for_violence\",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as \"ipc_session_2_6\",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as \"survey_response_11\",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as \"decision_analysis_6\",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as \"ipc_session_2_7\",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as \"communication_analysis_example_guiding_prompts_not_all_questi_6\",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_8\",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as \"mood_rating_ipc_session_3\",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as \"communication_analysis_example_guiding_prompts_not_all_questi_7\",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_6\",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as \"the_old_role_questions_asked_in_session_2_2\",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as \"discuss_close_relationships_in_the_past\",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_3\",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as \"disagreements\",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as \"the_new_role_questions_asked_in_session_2_2\",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as \"discuss_the_relationship_questions_asked_in_session_2_2\",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as \"communication_analysis_example_guiding_prompts_not_all_questi_8\",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as \"renegotiation_questions_asked_in_session_2_2\",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as \"explore_the_problem\",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as \"ipc_session_2_8\",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as \"assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pe_2\",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as \"survey_response_12\",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as \"decision_analysis_example_guiding_prompts_not_all_questions_n_6\",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as \"the_new_role\",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as \"increase_activities_with_others\",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_7\",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as \"explore_new_relationships_and_re_establish_old_relationships__3\",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as \"explore_difficulties_in_relationships\",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as \"decision_analysis_example_guiding_prompts_not_all_questions_n_7\",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as \"discuss_work_at_home_work_at_home_you_assigned_to_the_client__2\",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as \"go_to_the_interventions_tab_and_select_the_suicide_prevention_2\",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as \"explore_difficulties_in_relationships_questions_asked_in_sess_2\",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as \"the_old_role\",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as \"disagreements_questions_asked_in_session_2_2\",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as \"decision_analysis_example_guiding_prompts_not_all_questions_n_8\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_106\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_107\",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_108\",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as \"guiding_prompts_for_stages_of_disagreements_2\",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as \"dissolution_questions_asked_in_session_2_2\",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as \"ipc_session_3_in_what_format_did_you_deliver_this_session_with_\",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as \"impasse\",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as \"interpersonal_skills_building_example_skills_6\",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as \"ipc_session_2_did_you_complete_the_required_assessment_s_and__3\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_12\",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as \"assess_for_violence_has_anything_changed_since_the_last_time_we\",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as \"discuss_the_death_questions_asked_in_session_2_2\",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as \"decision_analysis_7\",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as \"increase_activities_with_others_questions_asked_in_session_2_2\",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as \"ipc_session_2_9\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_12\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_12\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_12\",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as \"ipc_session_3_phq_9_total\",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as \"ipc_session_3_gad_7_total\",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as \"ipc_session_3_ptsd_total\",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as \"ipc_session_3_ptsd_total_meaning\",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as \"identified_stage_of_disagreement_has_there_been_a_change_in_t_2\",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as \"discuss_close_relationships_in_the_past_questions_asked_in_se_2\",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as \"dissolution\",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as \"interpersonal_skills_building_example_skills_7\",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_109\",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as \"decision_analysis_8\",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as \"discuss_the_death\",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_8\",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as \"identify_social_settings_questions_asked_in_session_2_2\",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as \"interpersonal_skills_building_example_skills_8\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_110\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__7\",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as \"guiding_prompts_for_disagreements_2\",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as \"feelings_about_change\",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_111\",max(case when linkid = 'task-id-019' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_112\",max(case when linkid = 'task-id-020' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_113\",max(case when linkid = 'task-id-021' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_114\",max(case when linkid = 'task-id-022' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_115\",max(case when linkid = 'task-id-023' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_116\",max(case when linkid = 'task-id-024' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_117\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:16.140761Z", "completed_at": "2025-09-30T20:11:16.941978Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:16.942270Z", "completed_at": "2025-09-30T20:11:17.064580Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9282231330871582, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- IPC Session 2 with readable column names\n-- Questionnaire ID: 58\n-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/58') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as \"communication_analysis_example_guiding_prompts_not_all_question\",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as \"role_play_example_guiding_prompts_not_all_questions_need_to_be_\",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as \"ipc_session_2_phq_9_total_meaning\",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as \"decision_analysis_example_guiding_prompts_not_all_questions_nee\",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as \"interpersonal_skills_building_example_skills\",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as \"work_at_home_example_guiding_prompts_not_all_questions_need_to_\",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as \"ipc_session_2_gad_7_total_meaning\",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_2\",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as \"explore_the_problem_questions_asked_in_session_2\",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as \"mood_rating_ipc_session_2\",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_3\",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as \"identified_stage_of_disagreement\",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as \"assess_for_violence_was_this_in_the_context_of_an_argument_or_d\",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_2\",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as \"ipc_session_2_have_you_proposed_the_interpersonal_formulation_i\",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_92\",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as \"impasse_questions_asked_in_session_2\",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as \"feelings_about_change_questions_asked_in_session_2\",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as \"explore_new_relationships_and_re_establish_old_relationships_an\",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as \"decision_analysis\",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as \"ipc_session_2\",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as \"decision_analysis_2\",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as \"communication_analysis_example_guiding_prompts_not_all_questi_2\",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as \"ipc_session_2_2\",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_3\",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as \"ipc_session_2_in_what_format_did_you_deliver_this_session_with_\",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_93\",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as \"assess_for_violence_was_this_in_the_context_of_an_argument_or_2\",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as \"ipc_session_2_do_you_agree_with_this\",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_4\",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as \"the_old_role_questions_asked_in_session_2\",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_are\",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_94\",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as \"the_new_role_questions_asked_in_session_2\",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as \"discuss_the_relationship_questions_asked_in_session_2\",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as \"assess_for_violence_is_any_of_the_2_question_above_is_true\",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as \"renegotiation_questions_asked_in_session_2\",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as \"ipc_session_2_3\",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as \"assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pers\",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as \"mood_rating_ipc_session_2_total_score_2\",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as \"survey_response_10\",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as \"ipc_session_2_phq_9_total\",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as \"ipc_session_2_summary_when_1\",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as \"ipc_session_2_most_distressing_symptoms\",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as \"ipc_session_2_selected_problem_area\",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as \"ipc_session_2_ptsd_total_meaning\",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as \"ipc_session_2_gad_7_total\",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as \"discuss_work_at_home_work_at_home_you_assigned_to_the_client_in\",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as \"go_to_the_interventions_tab_and_select_the_suicide_prevention_m\",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as \"explore_difficulties_in_relationships_questions_asked_in_sessio\",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as \"decision_analysis_example_guiding_prompts_not_all_questions_n_2\",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as \"disagreements_questions_asked_in_session_2\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_95\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_96\",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as \"ipc_session_2_4\",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as \"guiding_prompts_for_stages_of_disagreements\",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as \"dissolution_questions_asked_in_session_2\",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as \"ipc_session_2_do_you_still_think_that\",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_2\",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as \"interpersonal_skills_building_example_skills_2\",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as \"ipc_session_2_did_you_complete_the_required_assessment_s_and__2\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"add_family_member_registration_calculated_age_11\",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as \"communication_analysis_example_guiding_prompts_not_all_questi_3\",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as \"discuss_the_death_questions_asked_in_session_2\",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as \"decision_analysis_3\",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as \"increase_activities_with_others_questions_asked_in_session_2\",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as \"ipc_session_2_5\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"add_family_member_registration_calculated_month_11\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"add_family_member_registration_calculated_year_11\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"add_family_member_registration_date_of_birth_11\",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as \"assess_for_violence_did_the_person_ever_hit_kick_push_or_slap_y\",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as \"identified_stage_of_disagreement_has_there_been_a_change_in_the\",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as \"discuss_close_relationships_in_the_past_questions_asked_in_sess\",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as \"interpersonal_skills_building_example_skills_3\",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_97\",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as \"decision_analysis_4\",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as \"communication_analysis_example_guiding_prompts_not_all_questi_4\",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as \"identify_social_settings_questions_asked_in_session_2\",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as \"decision_analysis_example_guiding_prompts_not_all_questions_n_3\",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as \"interpersonal_skills_building_example_skills_4\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_98\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__6\",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_4\",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as \"decision_analysis_example_guiding_prompts_not_all_questions_n_4\",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as \"guiding_prompts_for_disagreements\",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_99\",max(case when linkid = 'task-id-013' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_100\",max(case when linkid = 'task-id-014' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_101\",max(case when linkid = 'task-id-015' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_102\",max(case when linkid = 'task-id-016' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_103\",max(case when linkid = 'task-id-018' then answer_value_text end) as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_104\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.085021Z", "completed_at": "2025-09-30T20:11:17.243632Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.246003Z", "completed_at": "2025-09-30T20:11:17.282013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20735883712768555, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s2_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_phq_9_s2\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_phq_9_s2'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s2\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_32' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_32' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_32')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_32\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_32\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_33' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_33' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_33')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_33\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_33\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_34' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_34' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_34')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_34\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_34\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_35' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_35' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_35')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_35\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_35\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_3' OR linkid = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_3' OR short_name = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_3\"\n            END as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_3' OR linkid = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_3' OR short_name = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_3\"\n            END as \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_little_interest_or_pleasure_in__3' OR linkid = 'common_mental_health_symptoms_little_interest_or_pleasure_in__3' OR short_name = 'common_mental_health_symptoms_little_interest_or_pleasure_in__3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_little_interest_or_pleasure_in__3\"\n            END as \"common_mental_health_symptoms_little_interest_or_pleasure_in__3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_3' OR linkid = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_3' OR short_name = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_3\"\n            END as \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_3' OR linkid = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_3' OR short_name = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_falling_or_staying_asle_3\"\n            END as \"common_mental_health_symptoms_trouble_falling_or_staying_asle_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_tired_or_having_little__3' OR linkid = 'common_mental_health_symptoms_feeling_tired_or_having_little__3' OR short_name = 'common_mental_health_symptoms_feeling_tired_or_having_little__3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_tired_or_having_little__3\"\n            END as \"common_mental_health_symptoms_feeling_tired_or_having_little__3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_poor_appetite_or_overeating_3' OR linkid = 'common_mental_health_symptoms_poor_appetite_or_overeating_3' OR short_name = 'common_mental_health_symptoms_poor_appetite_or_overeating_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_poor_appetite_or_overeating_3\"\n            END as \"common_mental_health_symptoms_poor_appetite_or_overeating_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_3' OR linkid = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_3' OR short_name = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_3\"\n            END as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_concentrating_on_things_3' OR linkid = 'common_mental_health_symptoms_trouble_concentrating_on_things_3' OR short_name = 'common_mental_health_symptoms_trouble_concentrating_on_things_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_concentrating_on_things_3\"\n            END as \"common_mental_health_symptoms_trouble_concentrating_on_things_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_36' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_36' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_36')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_36\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_36\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s2_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.069125Z", "completed_at": "2025-09-30T20:11:17.240533Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.240959Z", "completed_at": "2025-09-30T20:11:17.283198Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2187659740447998, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mw_tool_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_mw_tool\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_mw_tool'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mw_tool\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_have_there_been_times_whe' OR linkid = 'mental_wellness_tool_in_the_past_year_have_there_been_times_whe' OR short_name = 'mental_wellness_tool_in_the_past_year_have_there_been_times_whe')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_have_there_been_times_whe\"\n            END as \"mental_wellness_tool_in_the_past_year_have_there_been_times_whe\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_y' OR linkid = 'mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_y' OR short_name = 'mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_y')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_y\"\n            END as \"mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_y\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_d' OR linkid = 'mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_d' OR short_name = 'mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_d')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_d\"\n            END as \"mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_d\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_month_have_you_wished_you_were' OR linkid = 'mental_wellness_tool_in_the_past_month_have_you_wished_you_were' OR short_name = 'mental_wellness_tool_in_the_past_month_have_you_wished_you_were')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_month_have_you_wished_you_were\"\n            END as \"mental_wellness_tool_in_the_past_month_have_you_wished_you_were\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_did_you_at_any_time_hear_' OR linkid = 'mental_wellness_tool_in_the_past_year_did_you_at_any_time_hear_' OR short_name = 'mental_wellness_tool_in_the_past_year_did_you_at_any_time_hear_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_did_you_at_any_time_hear_\"\n            END as \"mental_wellness_tool_in_the_past_year_did_you_at_any_time_hear_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_did_you_dis' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_did_you_dis' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_did_you_dis')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_did_you_dis\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_did_you_dis\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_what_is_the' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_what_is_the' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_what_is_the')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_what_is_the\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_what_is_the\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_bee' OR linkid = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_bee' OR short_name = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_bee')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_bee\"\n            END as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_bee\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_how_many_times_have_you_u' OR linkid = 'mental_wellness_tool_in_the_past_year_how_many_times_have_you_u' OR short_name = 'mental_wellness_tool_in_the_past_year_how_many_times_have_you_u')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_how_many_times_have_you_u\"\n            END as \"mental_wellness_tool_in_the_past_year_how_many_times_have_you_u\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_incomplete_answers_since_respons' OR linkid = 'discussion_with_supervisor_for_incomplete_answers_since_respons' OR short_name = 'discussion_with_supervisor_for_incomplete_answers_since_respons')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_incomplete_answers_since_respons\"\n            END as \"discussion_with_supervisor_for_incomplete_answers_since_respons\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_incomplete_answers_since_respo_2' OR linkid = 'discussion_with_supervisor_for_incomplete_answers_since_respo_2' OR short_name = 'discussion_with_supervisor_for_incomplete_answers_since_respo_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_incomplete_answers_since_respo_2\"\n            END as \"discussion_with_supervisor_for_incomplete_answers_since_respo_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_referral_de' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_referral_de' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_referral_de')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_referral_de\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_referral_de\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_how_many_drinks_containin' OR linkid = 'mental_wellness_tool_in_the_past_year_how_many_drinks_containin' OR short_name = 'mental_wellness_tool_in_the_past_year_how_many_drinks_containin')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_how_many_drinks_containin\"\n            END as \"mental_wellness_tool_in_the_past_year_how_many_drinks_containin\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_3_months_have_you_ever_done_an' OR linkid = 'mental_wellness_tool_in_the_past_3_months_have_you_ever_done_an' OR short_name = 'mental_wellness_tool_in_the_past_3_months_have_you_ever_done_an')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_3_months_have_you_ever_done_an\"\n            END as \"mental_wellness_tool_in_the_past_3_months_have_you_ever_done_an\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_2' OR linkid = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_2' OR short_name = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_2\"\n            END as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_month_have_you_had_any_actual_' OR linkid = 'mental_wellness_tool_in_the_past_month_have_you_had_any_actual_' OR short_name = 'mental_wellness_tool_in_the_past_month_have_you_had_any_actual_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_month_have_you_had_any_actual_\"\n            END as \"mental_wellness_tool_in_the_past_month_have_you_had_any_actual_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_alcohol_problem' OR linkid = 'mental_wellness_tool_alcohol_problem' OR short_name = 'mental_wellness_tool_alcohol_problem')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_alcohol_problem\"\n            END as \"mental_wellness_tool_alcohol_problem\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_3' OR linkid = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_3' OR short_name = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_3\"\n            END as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_common_mental_health' OR linkid = 'mental_wellness_tool_common_mental_health' OR short_name = 'mental_wellness_tool_common_mental_health')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_common_mental_health\"\n            END as \"mental_wellness_tool_common_mental_health\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_drug_problem' OR linkid = 'mental_wellness_tool_drug_problem' OR short_name = 'mental_wellness_tool_drug_problem')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_drug_problem\"\n            END as \"mental_wellness_tool_drug_problem\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_2' OR linkid = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_2' OR short_name = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_2\"\n            END as \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_supervisor_' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_supervisor_' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_supervisor_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_supervisor_\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_supervisor_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_how_many_drinks' OR linkid = 'mental_wellness_tool_how_many_drinks' OR short_name = 'mental_wellness_tool_how_many_drinks')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_how_many_drinks\"\n            END as \"mental_wellness_tool_how_many_drinks\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_no_mental_problem' OR linkid = 'mental_wellness_tool_no_mental_problem' OR short_name = 'mental_wellness_tool_no_mental_problem')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_no_mental_problem\"\n            END as \"mental_wellness_tool_no_mental_problem\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-age' OR linkid = 'patient-age' OR short_name = 'patient-age')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-age\"\n            END as \"patient-age\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-biological-sex' OR linkid = 'patient-biological-sex' OR short_name = 'patient-biological-sex')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-biological-sex\"\n            END as \"patient-biological-sex\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-dob' OR linkid = 'patient-dob' OR short_name = 'patient-dob')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-dob\"\n            END as \"patient-dob\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-gender-identity' OR linkid = 'patient-gender-identity' OR short_name = 'patient-gender-identity')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-gender-identity\"\n            END as \"patient-gender-identity\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-how-you-think-of-yourself' OR linkid = 'patient-how-you-think-of-yourself' OR short_name = 'patient-how-you-think-of-yourself')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-how-you-think-of-yourself\"\n            END as \"patient-how-you-think-of-yourself\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-name' OR linkid = 'patient-name' OR short_name = 'patient-name')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-name\"\n            END as \"patient-name\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-pronouns' OR linkid = 'patient-pronouns' OR short_name = 'patient-pronouns')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-pronouns\"\n            END as \"patient-pronouns\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'the_client_s_mental_wellness_tool_results_q1_to_q3_negative' OR linkid = 'the_client_s_mental_wellness_tool_results_q1_to_q3_negative' OR short_name = 'the_client_s_mental_wellness_tool_results_q1_to_q3_negative')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"the_client_s_mental_wellness_tool_results_q1_to_q3_negative\"\n            END as \"the_client_s_mental_wellness_tool_results_q1_to_q3_negative\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_severe_mental_health' OR linkid = 'mental_wellness_tool_severe_mental_health' OR short_name = 'mental_wellness_tool_severe_mental_health')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_severe_mental_health\"\n            END as \"mental_wellness_tool_severe_mental_health\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_suicide_risk' OR linkid = 'mental_wellness_tool_suicide_risk' OR short_name = 'mental_wellness_tool_suicide_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_suicide_risk\"\n            END as \"mental_wellness_tool_suicide_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_taskid_of_common_mental_health_form' OR linkid = 'mental_wellness_tool_taskid_of_common_mental_health_form' OR short_name = 'mental_wellness_tool_taskid_of_common_mental_health_form')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_taskid_of_common_mental_health_form\"\n            END as \"mental_wellness_tool_taskid_of_common_mental_health_form\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_taskid_of_pdf' OR linkid = 'mental_wellness_tool_taskid_of_pdf' OR short_name = 'mental_wellness_tool_taskid_of_pdf')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_taskid_of_pdf\"\n            END as \"mental_wellness_tool_taskid_of_pdf\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'task_id_socio_pdf' OR linkid = 'task_id_socio_pdf' OR short_name = 'task_id_socio_pdf')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"task_id_socio_pdf\"\n            END as \"task_id_socio_pdf\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mw_tool_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.073711Z", "completed_at": "2025-09-30T20:11:17.243366Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.244317Z", "completed_at": "2025-09-30T20:11:17.284066Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2144489288330078, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mw_tool_ipc_session_4_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_mw_tool_ipc_session_4\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_mw_tool_ipc_session_4'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mw_tool_ipc_session_4\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_3' OR linkid = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_3' OR short_name = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_3\"\n            END as \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_2' OR linkid = 'mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_2' OR short_name = 'mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_2\"\n            END as \"mental_wellness_tool_in_the_past_year_have_you_ever_felt_that_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_2' OR linkid = 'mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_2' OR short_name = 'mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_2\"\n            END as \"mental_wellness_tool_in_the_past_year_how_often_do_you_have_a_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_month_have_you_wished_you_we_2' OR linkid = 'mental_wellness_tool_in_the_past_month_have_you_wished_you_we_2' OR short_name = 'mental_wellness_tool_in_the_past_month_have_you_wished_you_we_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_month_have_you_wished_you_we_2\"\n            END as \"mental_wellness_tool_in_the_past_month_have_you_wished_you_we_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_did_you_at_any_time_hea_2' OR linkid = 'mental_wellness_tool_in_the_past_year_did_you_at_any_time_hea_2' OR short_name = 'mental_wellness_tool_in_the_past_year_did_you_at_any_time_hea_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_did_you_at_any_time_hea_2\"\n            END as \"mental_wellness_tool_in_the_past_year_did_you_at_any_time_hea_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_4' OR linkid = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_4' OR short_name = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_4\"\n            END as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_how_many_times_have_you_2' OR linkid = 'mental_wellness_tool_in_the_past_year_how_many_times_have_you_2' OR short_name = 'mental_wellness_tool_in_the_past_year_how_many_times_have_you_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_how_many_times_have_you_2\"\n            END as \"mental_wellness_tool_in_the_past_year_how_many_times_have_you_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_how_many_drinks_contain_2' OR linkid = 'mental_wellness_tool_in_the_past_year_how_many_drinks_contain_2' OR short_name = 'mental_wellness_tool_in_the_past_year_how_many_drinks_contain_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_how_many_drinks_contain_2\"\n            END as \"mental_wellness_tool_in_the_past_year_how_many_drinks_contain_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_3_months_have_you_ever_done__2' OR linkid = 'mental_wellness_tool_in_the_past_3_months_have_you_ever_done__2' OR short_name = 'mental_wellness_tool_in_the_past_3_months_have_you_ever_done__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_3_months_have_you_ever_done__2\"\n            END as \"mental_wellness_tool_in_the_past_3_months_have_you_ever_done__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_5' OR linkid = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_5' OR short_name = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_5\"\n            END as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_month_have_you_had_any_actua_2' OR linkid = 'mental_wellness_tool_in_the_past_month_have_you_had_any_actua_2' OR short_name = 'mental_wellness_tool_in_the_past_month_have_you_had_any_actua_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_month_have_you_had_any_actua_2\"\n            END as \"mental_wellness_tool_in_the_past_month_have_you_had_any_actua_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_alcohol_problem_2' OR linkid = 'mental_wellness_tool_alcohol_problem_2' OR short_name = 'mental_wellness_tool_alcohol_problem_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_alcohol_problem_2\"\n            END as \"mental_wellness_tool_alcohol_problem_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_6' OR linkid = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_6' OR short_name = 'mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_6\"\n            END as \"mental_wellness_tool_in_the_last_2_weeks_how_often_have_you_b_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_common_mental_health_2' OR linkid = 'mental_wellness_tool_common_mental_health_2' OR short_name = 'mental_wellness_tool_common_mental_health_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_common_mental_health_2\"\n            END as \"mental_wellness_tool_common_mental_health_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_drug_problem_2' OR linkid = 'mental_wellness_tool_drug_problem_2' OR short_name = 'mental_wellness_tool_drug_problem_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_drug_problem_2\"\n            END as \"mental_wellness_tool_drug_problem_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_4' OR linkid = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_4' OR short_name = 'mental_wellness_tool_in_the_past_year_have_there_been_times_w_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_4\"\n            END as \"mental_wellness_tool_in_the_past_year_have_there_been_times_w_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_how_many_drinks_2' OR linkid = 'mental_wellness_tool_how_many_drinks_2' OR short_name = 'mental_wellness_tool_how_many_drinks_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_how_many_drinks_2\"\n            END as \"mental_wellness_tool_how_many_drinks_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_no_mental_problem_2' OR linkid = 'mental_wellness_tool_no_mental_problem_2' OR short_name = 'mental_wellness_tool_no_mental_problem_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_no_mental_problem_2\"\n            END as \"mental_wellness_tool_no_mental_problem_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-age' OR linkid = 'patient-age' OR short_name = 'patient-age')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-age\"\n            END as \"patient-age\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-biological-sex' OR linkid = 'patient-biological-sex' OR short_name = 'patient-biological-sex')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-biological-sex\"\n            END as \"patient-biological-sex\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-dob' OR linkid = 'patient-dob' OR short_name = 'patient-dob')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-dob\"\n            END as \"patient-dob\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-gender-identity' OR linkid = 'patient-gender-identity' OR short_name = 'patient-gender-identity')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-gender-identity\"\n            END as \"patient-gender-identity\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-how-you-think-of-yourself' OR linkid = 'patient-how-you-think-of-yourself' OR short_name = 'patient-how-you-think-of-yourself')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-how-you-think-of-yourself\"\n            END as \"patient-how-you-think-of-yourself\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-name' OR linkid = 'patient-name' OR short_name = 'patient-name')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-name\"\n            END as \"patient-name\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-pronouns' OR linkid = 'patient-pronouns' OR short_name = 'patient-pronouns')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-pronouns\"\n            END as \"patient-pronouns\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_severe_mental_health_2' OR linkid = 'mental_wellness_tool_severe_mental_health_2' OR short_name = 'mental_wellness_tool_severe_mental_health_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_severe_mental_health_2\"\n            END as \"mental_wellness_tool_severe_mental_health_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_suicide_risk_2' OR linkid = 'mental_wellness_tool_suicide_risk_2' OR short_name = 'mental_wellness_tool_suicide_risk_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_suicide_risk_2\"\n            END as \"mental_wellness_tool_suicide_risk_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mental_wellness_tool_taskid_of_pdf_2' OR linkid = 'mental_wellness_tool_taskid_of_pdf_2' OR short_name = 'mental_wellness_tool_taskid_of_pdf_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mental_wellness_tool_taskid_of_pdf_2\"\n            END as \"mental_wellness_tool_taskid_of_pdf_2\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mw_tool_ipc_session_4_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.077751Z", "completed_at": "2025-09-30T20:11:17.244075Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.249949Z", "completed_at": "2025-09-30T20:11:17.284659Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2098710536956787, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s1_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_phq_9_s1\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_phq_9_s1'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s1\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_26' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_26' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_26')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_26\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_26\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_27' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_27' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_27')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_27\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_27\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_2' OR linkid = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_2' OR short_name = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_2\"\n            END as \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_28' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_28' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_28')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_28\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_28\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_5' OR linkid = 'add_family_member_registration_calculated_age_5' OR short_name = 'add_family_member_registration_calculated_age_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_5\"\n            END as \"add_family_member_registration_calculated_age_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_5' OR linkid = 'add_family_member_registration_calculated_month_5' OR short_name = 'add_family_member_registration_calculated_month_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_5\"\n            END as \"add_family_member_registration_calculated_month_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_5' OR linkid = 'add_family_member_registration_calculated_year_5' OR short_name = 'add_family_member_registration_calculated_year_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_5\"\n            END as \"add_family_member_registration_calculated_year_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_5' OR linkid = 'add_family_member_registration_date_of_birth_5' OR short_name = 'add_family_member_registration_date_of_birth_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_5\"\n            END as \"add_family_member_registration_date_of_birth_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_29' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_29' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_29')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_29\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_29\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_2' OR linkid = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_2' OR short_name = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_2\"\n            END as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_2' OR linkid = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_2' OR short_name = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_2\"\n            END as \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_little_interest_or_pleasure_in__2' OR linkid = 'common_mental_health_symptoms_little_interest_or_pleasure_in__2' OR short_name = 'common_mental_health_symptoms_little_interest_or_pleasure_in__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_little_interest_or_pleasure_in__2\"\n            END as \"common_mental_health_symptoms_little_interest_or_pleasure_in__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_2' OR linkid = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_2' OR short_name = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_2\"\n            END as \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_2' OR linkid = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_2' OR short_name = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_falling_or_staying_asle_2\"\n            END as \"common_mental_health_symptoms_trouble_falling_or_staying_asle_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_tired_or_having_little__2' OR linkid = 'common_mental_health_symptoms_feeling_tired_or_having_little__2' OR short_name = 'common_mental_health_symptoms_feeling_tired_or_having_little__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_tired_or_having_little__2\"\n            END as \"common_mental_health_symptoms_feeling_tired_or_having_little__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_poor_appetite_or_overeating_2' OR linkid = 'common_mental_health_symptoms_poor_appetite_or_overeating_2' OR short_name = 'common_mental_health_symptoms_poor_appetite_or_overeating_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_poor_appetite_or_overeating_2\"\n            END as \"common_mental_health_symptoms_poor_appetite_or_overeating_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_2' OR linkid = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_2' OR short_name = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_2\"\n            END as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_concentrating_on_things_2' OR linkid = 'common_mental_health_symptoms_trouble_concentrating_on_things_2' OR short_name = 'common_mental_health_symptoms_trouble_concentrating_on_things_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_concentrating_on_things_2\"\n            END as \"common_mental_health_symptoms_trouble_concentrating_on_things_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_30' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_30' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_30')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_30\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_30\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR short_name = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\"\n            END as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_31' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_31' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_31')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_31\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_31\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s1_anon\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.295996Z", "completed_at": "2025-09-30T20:11:17.301815Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.301998Z", "completed_at": "2025-09-30T20:11:17.344546Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0895390510559082, "adapter_response": {}, "message": "Database Error in model clients_accepted_ipc (models/metrics/clients_accepted_ipc.sql)\n  column pns.scheduled_ipc_session does not exist\n  LINE 20:     pns.scheduled_ipc_session,\n               ^\n  compiled code at target/run/engage_analytics/models/metrics/clients_accepted_ipc.sql", "failures": null, "unique_id": "model.engage_analytics.clients_accepted_ipc", "compiled": true, "compiled_code": "-- models/metrics/clients_accepted_ipc.sql\n\n\n-- View to identify clients who accepted IPC (Integrated Primary Care)\n-- Based on Planning Next Steps questionnaire responses\n-- When \"scheduled_ipc_session\" is not null, it indicates the client accepted IPC\n-- Tracks cumulative patients who accepted IPC as of each date\n\nwith planning_responses as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as acceptance_date,\n    pns.scheduled_ipc_session,\n    pns.practitioner_organization_id as organization_id\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_planning_next_steps\" pns\n    on pns.qr_id = qr.id\n  where qr.questionnaire_id = 'Questionnaire/q-planning-next-steps'\n    and qr.subject_patient_id is not null\n    and pns.scheduled_ipc_session is not null\n    and trim(pns.scheduled_ipc_session) != ''\n),\n\n-- Generate a date spine from the earliest acceptance to today\ndate_spine as (\n  select generate_series(\n    (select min(acceptance_date) from planning_responses),\n    current_date,\n    '1 day'::interval\n  )::date as period_date\n),\n\n-- For each date, count cumulative patients who accepted IPC up to that date\ndaily_counts as (\n  select\n    d.period_date,\n    p.organization_id,\n    p.subject_patient_id,\n    p.acceptance_date,\n    p.scheduled_ipc_session\n  from date_spine d\n  cross join planning_responses p\n  where p.acceptance_date <= d.period_date\n)\n\nselect\n  period_date,\n  organization_id,\n  subject_patient_id,\n  acceptance_date,\n  scheduled_ipc_session,\n  true as has_accepted_ipc\nfrom daily_counts", "relation_name": "\"airbyte\".\"engage_analytics\".\"clients_accepted_ipc\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.291450Z", "completed_at": "2025-09-30T20:11:17.353369Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.353804Z", "completed_at": "2025-09-30T20:11:17.399246Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1122589111328125, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s3_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_phq_9_s3\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_phq_9_s3'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s3\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_37' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_37' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_37')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_37\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_37\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_38' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_38' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_38')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_38\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_38\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_39' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_39' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_39')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_39\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_39\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_4' OR linkid = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_4' OR short_name = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_4\"\n            END as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_4' OR linkid = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_4' OR short_name = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_4\"\n            END as \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_little_interest_or_pleasure_in__4' OR linkid = 'common_mental_health_symptoms_little_interest_or_pleasure_in__4' OR short_name = 'common_mental_health_symptoms_little_interest_or_pleasure_in__4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_little_interest_or_pleasure_in__4\"\n            END as \"common_mental_health_symptoms_little_interest_or_pleasure_in__4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_4' OR linkid = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_4' OR short_name = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_4\"\n            END as \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_4' OR linkid = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_4' OR short_name = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_falling_or_staying_asle_4\"\n            END as \"common_mental_health_symptoms_trouble_falling_or_staying_asle_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_tired_or_having_little__4' OR linkid = 'common_mental_health_symptoms_feeling_tired_or_having_little__4' OR short_name = 'common_mental_health_symptoms_feeling_tired_or_having_little__4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_tired_or_having_little__4\"\n            END as \"common_mental_health_symptoms_feeling_tired_or_having_little__4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_poor_appetite_or_overeating_4' OR linkid = 'common_mental_health_symptoms_poor_appetite_or_overeating_4' OR short_name = 'common_mental_health_symptoms_poor_appetite_or_overeating_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_poor_appetite_or_overeating_4\"\n            END as \"common_mental_health_symptoms_poor_appetite_or_overeating_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_4' OR linkid = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_4' OR short_name = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_4\"\n            END as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_concentrating_on_things_4' OR linkid = 'common_mental_health_symptoms_trouble_concentrating_on_things_4' OR short_name = 'common_mental_health_symptoms_trouble_concentrating_on_things_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_concentrating_on_things_4\"\n            END as \"common_mental_health_symptoms_trouble_concentrating_on_things_4\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s3_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.298853Z", "completed_at": "2025-09-30T20:11:17.358180Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.358534Z", "completed_at": "2025-09-30T20:11:17.407235Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11698222160339355, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_planning_next_steps_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_planning_next_steps\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_planning_next_steps'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_planning_next_steps\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsreferral_to_mental_health_specialist_where_w' OR linkid = 'planning_next_stepsreferral_to_mental_health_specialist_where_w' OR short_name = 'planning_next_stepsreferral_to_mental_health_specialist_where_w')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsreferral_to_mental_health_specialist_where_w\"\n            END as \"planning_next_stepsreferral_to_mental_health_specialist_where_w\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsprobable_severe_mental_health_problem_additi' OR linkid = 'planning_next_stepsprobable_severe_mental_health_problem_additi' OR short_name = 'planning_next_stepsprobable_severe_mental_health_problem_additi')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsprobable_severe_mental_health_problem_additi\"\n            END as \"planning_next_stepsprobable_severe_mental_health_problem_additi\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_additional_details' OR linkid = 'planning_next_steps_additional_details' OR short_name = 'planning_next_steps_additional_details')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_additional_details\"\n            END as \"planning_next_steps_additional_details\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_did_you_discuss_this_client_s_scores_with_a' OR linkid = 'planning_next_steps_did_you_discuss_this_client_s_scores_with_a' OR short_name = 'planning_next_steps_did_you_discuss_this_client_s_scores_with_a')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_did_you_discuss_this_client_s_scores_with_a\"\n            END as \"planning_next_steps_did_you_discuss_this_client_s_scores_with_a\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepssafety_planning_intervention_spi_did_the_cli' OR linkid = 'planning_next_stepssafety_planning_intervention_spi_did_the_cli' OR short_name = 'planning_next_stepssafety_planning_intervention_spi_did_the_cli')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepssafety_planning_intervention_spi_did_the_cli\"\n            END as \"planning_next_stepssafety_planning_intervention_spi_did_the_cli\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsreferral_to_mental_health_specialist_additio' OR linkid = 'planning_next_stepsreferral_to_mental_health_specialist_additio' OR short_name = 'planning_next_stepsreferral_to_mental_health_specialist_additio')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsreferral_to_mental_health_specialist_additio\"\n            END as \"planning_next_stepsreferral_to_mental_health_specialist_additio\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsother_agency_services_did_the_client_accept_' OR linkid = 'planning_next_stepsother_agency_services_did_the_client_accept_' OR short_name = 'planning_next_stepsother_agency_services_did_the_client_accept_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsother_agency_services_did_the_client_accept_\"\n            END as \"planning_next_stepsother_agency_services_did_the_client_accept_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsinterpersonal_counseling_ipc_did_the_client_' OR linkid = 'planning_next_stepsinterpersonal_counseling_ipc_did_the_client_' OR short_name = 'planning_next_stepsinterpersonal_counseling_ipc_did_the_client_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsinterpersonal_counseling_ipc_did_the_client_\"\n            END as \"planning_next_stepsinterpersonal_counseling_ipc_did_the_client_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsoptional_supports_is_the_client_interested_i' OR linkid = 'planning_next_stepsoptional_supports_is_the_client_interested_i' OR short_name = 'planning_next_stepsoptional_supports_is_the_client_interested_i')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsoptional_supports_is_the_client_interested_i\"\n            END as \"planning_next_stepsoptional_supports_is_the_client_interested_i\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepssafety_planning_intervention_spi_why_does_th' OR linkid = 'planning_next_stepssafety_planning_intervention_spi_why_does_th' OR short_name = 'planning_next_stepssafety_planning_intervention_spi_why_does_th')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepssafety_planning_intervention_spi_why_does_th\"\n            END as \"planning_next_stepssafety_planning_intervention_spi_why_does_th\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsother_agency_services_please_specify_which_o' OR linkid = 'planning_next_stepsother_agency_services_please_specify_which_o' OR short_name = 'planning_next_stepsother_agency_services_please_specify_which_o')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsother_agency_services_please_specify_which_o\"\n            END as \"planning_next_stepsother_agency_services_please_specify_which_o\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsinterpersonal_counseling_ipc_why_does_the_cl' OR linkid = 'planning_next_stepsinterpersonal_counseling_ipc_why_does_the_cl' OR short_name = 'planning_next_stepsinterpersonal_counseling_ipc_why_does_the_cl')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsinterpersonal_counseling_ipc_why_does_the_cl\"\n            END as \"planning_next_stepsinterpersonal_counseling_ipc_why_does_the_cl\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsother_agency_services_if_the_client_declined' OR linkid = 'planning_next_stepsother_agency_services_if_the_client_declined' OR short_name = 'planning_next_stepsother_agency_services_if_the_client_declined')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsother_agency_services_if_the_client_declined\"\n            END as \"planning_next_stepsother_agency_services_if_the_client_declined\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsinterpersonal_counseling_ipc_schedule_ipc_se' OR linkid = 'planning_next_stepsinterpersonal_counseling_ipc_schedule_ipc_se' OR short_name = 'planning_next_stepsinterpersonal_counseling_ipc_schedule_ipc_se')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsinterpersonal_counseling_ipc_schedule_ipc_se\"\n            END as \"planning_next_stepsinterpersonal_counseling_ipc_schedule_ipc_se\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsfinancial_hardships_did_the_client_accept_fi' OR linkid = 'planning_next_stepsfinancial_hardships_did_the_client_accept_fi' OR short_name = 'planning_next_stepsfinancial_hardships_did_the_client_accept_fi')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsfinancial_hardships_did_the_client_accept_fi\"\n            END as \"planning_next_stepsfinancial_hardships_did_the_client_accept_fi\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_did_the_client_accept_spi' OR linkid = 'planning_next_steps_did_the_client_accept_spi' OR short_name = 'planning_next_steps_did_the_client_accept_spi')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_did_the_client_accept_spi\"\n            END as \"planning_next_steps_did_the_client_accept_spi\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_please_specify' OR linkid = 'planning_next_steps_please_specify' OR short_name = 'planning_next_steps_please_specify')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_please_specify\"\n            END as \"planning_next_steps_please_specify\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsprobable_common_mental_health_problem_schedu' OR linkid = 'planning_next_stepsprobable_common_mental_health_problem_schedu' OR short_name = 'planning_next_stepsprobable_common_mental_health_problem_schedu')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsprobable_common_mental_health_problem_schedu\"\n            END as \"planning_next_stepsprobable_common_mental_health_problem_schedu\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsprobable_severe_mental_health_problem_did_th' OR linkid = 'planning_next_stepsprobable_severe_mental_health_problem_did_th' OR short_name = 'planning_next_stepsprobable_severe_mental_health_problem_did_th')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsprobable_severe_mental_health_problem_did_th\"\n            END as \"planning_next_stepsprobable_severe_mental_health_problem_did_th\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_what_is_the_supervisor_s_recommendation_for' OR linkid = 'planning_next_steps_what_is_the_supervisor_s_recommendation_for' OR short_name = 'planning_next_steps_what_is_the_supervisor_s_recommendation_for')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_what_is_the_supervisor_s_recommendation_for\"\n            END as \"planning_next_steps_what_is_the_supervisor_s_recommendation_for\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsother_services_outside_of_the_agency_did_the' OR linkid = 'planning_next_stepsother_services_outside_of_the_agency_did_the' OR short_name = 'planning_next_stepsother_services_outside_of_the_agency_did_the')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsother_services_outside_of_the_agency_did_the\"\n            END as \"planning_next_stepsother_services_outside_of_the_agency_did_the\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'additional_notes_additional_notes_or_information' OR linkid = 'additional_notes_additional_notes_or_information' OR short_name = 'additional_notes_additional_notes_or_information')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"additional_notes_additional_notes_or_information\"\n            END as \"additional_notes_additional_notes_or_information\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_did_the_client_complete_spi' OR linkid = 'planning_next_steps_did_the_client_complete_spi' OR short_name = 'planning_next_steps_did_the_client_complete_spi')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_did_the_client_complete_spi\"\n            END as \"planning_next_steps_did_the_client_complete_spi\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsother_services_outside_of_the_agency_please_' OR linkid = 'planning_next_stepsother_services_outside_of_the_agency_please_' OR short_name = 'planning_next_stepsother_services_outside_of_the_agency_please_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsother_services_outside_of_the_agency_please_\"\n            END as \"planning_next_stepsother_services_outside_of_the_agency_please_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepssbirt_motivational_interviewing_did_the_clie' OR linkid = 'planning_next_stepssbirt_motivational_interviewing_did_the_clie' OR short_name = 'planning_next_stepssbirt_motivational_interviewing_did_the_clie')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepssbirt_motivational_interviewing_did_the_clie\"\n            END as \"planning_next_stepssbirt_motivational_interviewing_did_the_clie\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsprobable_common_mental_health_problem_did_th' OR linkid = 'planning_next_stepsprobable_common_mental_health_problem_did_th' OR short_name = 'planning_next_stepsprobable_common_mental_health_problem_did_th')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsprobable_common_mental_health_problem_did_th\"\n            END as \"planning_next_stepsprobable_common_mental_health_problem_did_th\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_did_the_client_accept_sbirt' OR linkid = 'planning_next_steps_did_the_client_accept_sbirt' OR short_name = 'planning_next_steps_did_the_client_accept_sbirt')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_did_the_client_accept_sbirt\"\n            END as \"planning_next_steps_did_the_client_accept_sbirt\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsother_services_outside_of_the_agency_if_the_' OR linkid = 'planning_next_stepsother_services_outside_of_the_agency_if_the_' OR short_name = 'planning_next_stepsother_services_outside_of_the_agency_if_the_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsother_services_outside_of_the_agency_if_the_\"\n            END as \"planning_next_stepsother_services_outside_of_the_agency_if_the_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsfinancial_wellness_supports_did_the_client_a' OR linkid = 'planning_next_stepsfinancial_wellness_supports_did_the_client_a' OR short_name = 'planning_next_stepsfinancial_wellness_supports_did_the_client_a')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsfinancial_wellness_supports_did_the_client_a\"\n            END as \"planning_next_stepsfinancial_wellness_supports_did_the_client_a\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepssbirt_motivational_interviewing_why_does_the' OR linkid = 'planning_next_stepssbirt_motivational_interviewing_why_does_the' OR short_name = 'planning_next_stepssbirt_motivational_interviewing_why_does_the')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepssbirt_motivational_interviewing_why_does_the\"\n            END as \"planning_next_stepssbirt_motivational_interviewing_why_does_the\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_schedule_sbirt_session' OR linkid = 'planning_next_steps_schedule_sbirt_session' OR short_name = 'planning_next_steps_schedule_sbirt_session')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_schedule_sbirt_session\"\n            END as \"planning_next_steps_schedule_sbirt_session\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_if_the_client_declined_please_indicate_the_' OR linkid = 'planning_next_steps_if_the_client_declined_please_indicate_the_' OR short_name = 'planning_next_steps_if_the_client_declined_please_indicate_the_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_if_the_client_declined_please_indicate_the_\"\n            END as \"planning_next_steps_if_the_client_declined_please_indicate_the_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsfinancial_wellness_supports_why_does_the_cli' OR linkid = 'planning_next_stepsfinancial_wellness_supports_why_does_the_cli' OR short_name = 'planning_next_stepsfinancial_wellness_supports_why_does_the_cli')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsfinancial_wellness_supports_why_does_the_cli\"\n            END as \"planning_next_stepsfinancial_wellness_supports_why_does_the_cli\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepssbirt_motivational_interviewing_schedule_sbi' OR linkid = 'planning_next_stepssbirt_motivational_interviewing_schedule_sbi' OR short_name = 'planning_next_stepssbirt_motivational_interviewing_schedule_sbi')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepssbirt_motivational_interviewing_schedule_sbi\"\n            END as \"planning_next_stepssbirt_motivational_interviewing_schedule_sbi\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsprobable_common_mental_health_problem_if_the' OR linkid = 'planning_next_stepsprobable_common_mental_health_problem_if_the' OR short_name = 'planning_next_stepsprobable_common_mental_health_problem_if_the')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsprobable_common_mental_health_problem_if_the\"\n            END as \"planning_next_stepsprobable_common_mental_health_problem_if_the\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsprobable_severe_mental_health_problem_where_' OR linkid = 'planning_next_stepsprobable_severe_mental_health_problem_where_' OR short_name = 'planning_next_stepsprobable_severe_mental_health_problem_where_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsprobable_severe_mental_health_problem_where_\"\n            END as \"planning_next_stepsprobable_severe_mental_health_problem_where_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsfinancial_wellness_supports_if_the_client_de' OR linkid = 'planning_next_stepsfinancial_wellness_supports_if_the_client_de' OR short_name = 'planning_next_stepsfinancial_wellness_supports_if_the_client_de')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsfinancial_wellness_supports_if_the_client_de\"\n            END as \"planning_next_stepsfinancial_wellness_supports_if_the_client_de\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsreferral_to_mental_health_specialist_did_the' OR linkid = 'planning_next_stepsreferral_to_mental_health_specialist_did_the' OR short_name = 'planning_next_stepsreferral_to_mental_health_specialist_did_the')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsreferral_to_mental_health_specialist_did_the\"\n            END as \"planning_next_stepsreferral_to_mental_health_specialist_did_the\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_stepsreferral_to_mental_health_specialist_why_doe' OR linkid = 'planning_next_stepsreferral_to_mental_health_specialist_why_doe' OR short_name = 'planning_next_stepsreferral_to_mental_health_specialist_why_doe')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_stepsreferral_to_mental_health_specialist_why_doe\"\n            END as \"planning_next_stepsreferral_to_mental_health_specialist_why_doe\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_if_the_client_declined_please_indicate_th_2' OR linkid = 'planning_next_steps_if_the_client_declined_please_indicate_th_2' OR short_name = 'planning_next_steps_if_the_client_declined_please_indicate_th_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_if_the_client_declined_please_indicate_th_2\"\n            END as \"planning_next_steps_if_the_client_declined_please_indicate_th_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_has_the_supervisor_assessed_the_client_to_d' OR linkid = 'planning_next_steps_has_the_supervisor_assessed_the_client_to_d' OR short_name = 'planning_next_steps_has_the_supervisor_assessed_the_client_to_d')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_has_the_supervisor_assessed_the_client_to_d\"\n            END as \"planning_next_steps_has_the_supervisor_assessed_the_client_to_d\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_superviso_2' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_superviso_2' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_superviso_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_superviso_2\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_superviso_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_financial_hardships_list' OR linkid = 'planning_next_steps_financial_hardships_list' OR short_name = 'planning_next_steps_financial_hardships_list')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_financial_hardships_list\"\n            END as \"planning_next_steps_financial_hardships_list\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_fws' OR linkid = 'is_fws' OR short_name = 'is_fws')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_fws\"\n            END as \"is_fws\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_ipc' OR linkid = 'is_ipc' OR short_name = 'is_ipc')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_ipc\"\n            END as \"is_ipc\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_ipc_main' OR linkid = 'is_ipc_main' OR short_name = 'is_ipc_main')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_ipc_main\"\n            END as \"is_ipc_main\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_ipc_optional' OR linkid = 'is_ipc_optional' OR short_name = 'is_ipc_optional')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_ipc_optional\"\n            END as \"is_ipc_optional\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_mhs' OR linkid = 'is_mhs' OR short_name = 'is_mhs')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_mhs\"\n            END as \"is_mhs\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_other_agency_services' OR linkid = 'is_other_agency_services' OR short_name = 'is_other_agency_services')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_other_agency_services\"\n            END as \"is_other_agency_services\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_other_services_outside_agency' OR linkid = 'is_other_services_outside_agency' OR short_name = 'is_other_services_outside_agency')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_other_services_outside_agency\"\n            END as \"is_other_services_outside_agency\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_sbirt' OR linkid = 'is_sbirt' OR short_name = 'is_sbirt')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_sbirt\"\n            END as \"is_sbirt\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_sbirt_main' OR linkid = 'is_sbirt_main' OR short_name = 'is_sbirt_main')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_sbirt_main\"\n            END as \"is_sbirt_main\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_sbirt_optional' OR linkid = 'is_sbirt_optional' OR short_name = 'is_sbirt_optional')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_sbirt_optional\"\n            END as \"is_sbirt_optional\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'is_spi' OR linkid = 'is_spi' OR short_name = 'is_spi')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"is_spi\"\n            END as \"is_spi\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient_age_4' OR linkid = 'patient_age_4' OR short_name = 'patient_age_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient_age_4\"\n            END as \"patient_age_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient_date_of_birth_4' OR linkid = 'patient_date_of_birth_4' OR short_name = 'patient_date_of_birth_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient_date_of_birth_4\"\n            END as \"patient_date_of_birth_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient_name_4' OR linkid = 'patient_name_4' OR short_name = 'patient_name_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient_name_4\"\n            END as \"patient_name_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_scheduled_ipc_session_1_with_current_time' OR linkid = 'planning_next_steps_scheduled_ipc_session_1_with_current_time' OR short_name = 'planning_next_steps_scheduled_ipc_session_1_with_current_time')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_scheduled_ipc_session_1_with_current_time\"\n            END as \"planning_next_steps_scheduled_ipc_session_1_with_current_time\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'scheduled_ipc_session_1_with_current_time_2' OR linkid = 'scheduled_ipc_session_1_with_current_time_2' OR short_name = 'scheduled_ipc_session_1_with_current_time_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"scheduled_ipc_session_1_with_current_time_2\"\n            END as \"scheduled_ipc_session_1_with_current_time_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_taskid_000' OR linkid = 'planning_next_steps_taskid_000' OR short_name = 'planning_next_steps_taskid_000')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_taskid_000\"\n            END as \"planning_next_steps_taskid_000\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_taskid_001' OR linkid = 'planning_next_steps_taskid_001' OR short_name = 'planning_next_steps_taskid_001')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_taskid_001\"\n            END as \"planning_next_steps_taskid_001\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_taskid_002' OR linkid = 'planning_next_steps_taskid_002' OR short_name = 'planning_next_steps_taskid_002')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_taskid_002\"\n            END as \"planning_next_steps_taskid_002\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_taskid_003' OR linkid = 'planning_next_steps_taskid_003' OR short_name = 'planning_next_steps_taskid_003')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_taskid_003\"\n            END as \"planning_next_steps_taskid_003\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_taskid_004' OR linkid = 'planning_next_steps_taskid_004' OR short_name = 'planning_next_steps_taskid_004')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_taskid_004\"\n            END as \"planning_next_steps_taskid_004\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_taskid_006' OR linkid = 'planning_next_steps_taskid_006' OR short_name = 'planning_next_steps_taskid_006')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_taskid_006\"\n            END as \"planning_next_steps_taskid_006\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'planning_next_steps_taskid_pdf' OR linkid = 'planning_next_steps_taskid_pdf' OR short_name = 'planning_next_steps_taskid_pdf')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"planning_next_steps_taskid_pdf\"\n            END as \"planning_next_steps_taskid_pdf\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_planning_next_steps_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.387409Z", "completed_at": "2025-09-30T20:11:17.427225Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.427530Z", "completed_at": "2025-09-30T20:11:17.449212Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06291794776916504, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s4_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_phq_9_s4\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_phq_9_s4'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s4\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_40' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_40' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_40')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_40\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_40\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_41' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_41' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_41')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_41\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_41\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_42' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_42' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_42')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_42\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_42\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_3' OR linkid = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_3' OR short_name = 'phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_3\"\n            END as \"phq_9_ipc_session_2_how_difficult_have_these_problems_made_it_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_5' OR linkid = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_5' OR short_name = 'common_mental_health_symptoms_moving_or_speaking_so_slowly_th_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_5\"\n            END as \"common_mental_health_symptoms_moving_or_speaking_so_slowly_th_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_5' OR linkid = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_5' OR short_name = 'common_mental_health_symptoms_thoughts_that_you_would_be_bett_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_5\"\n            END as \"common_mental_health_symptoms_thoughts_that_you_would_be_bett_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_little_interest_or_pleasure_in__5' OR linkid = 'common_mental_health_symptoms_little_interest_or_pleasure_in__5' OR short_name = 'common_mental_health_symptoms_little_interest_or_pleasure_in__5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_little_interest_or_pleasure_in__5\"\n            END as \"common_mental_health_symptoms_little_interest_or_pleasure_in__5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_5' OR linkid = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_5' OR short_name = 'common_mental_health_symptoms_feeling_down_depressed_or_hopel_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_5\"\n            END as \"common_mental_health_symptoms_feeling_down_depressed_or_hopel_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_5' OR linkid = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_5' OR short_name = 'common_mental_health_symptoms_trouble_falling_or_staying_asle_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_falling_or_staying_asle_5\"\n            END as \"common_mental_health_symptoms_trouble_falling_or_staying_asle_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_tired_or_having_little__5' OR linkid = 'common_mental_health_symptoms_feeling_tired_or_having_little__5' OR short_name = 'common_mental_health_symptoms_feeling_tired_or_having_little__5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_tired_or_having_little__5\"\n            END as \"common_mental_health_symptoms_feeling_tired_or_having_little__5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_poor_appetite_or_overeating_5' OR linkid = 'common_mental_health_symptoms_poor_appetite_or_overeating_5' OR short_name = 'common_mental_health_symptoms_poor_appetite_or_overeating_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_poor_appetite_or_overeating_5\"\n            END as \"common_mental_health_symptoms_poor_appetite_or_overeating_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_5' OR linkid = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_5' OR short_name = 'common_mental_health_symptoms_feeling_bad_about_yourself_or_t_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_5\"\n            END as \"common_mental_health_symptoms_feeling_bad_about_yourself_or_t_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'common_mental_health_symptoms_trouble_concentrating_on_things_5' OR linkid = 'common_mental_health_symptoms_trouble_concentrating_on_things_5' OR short_name = 'common_mental_health_symptoms_trouble_concentrating_on_things_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"common_mental_health_symptoms_trouble_concentrating_on_things_5\"\n            END as \"common_mental_health_symptoms_trouble_concentrating_on_things_5\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s4_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.408334Z", "completed_at": "2025-09-30T20:11:17.441197Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.441446Z", "completed_at": "2025-09-30T20:11:17.467526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.060304880142211914, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s1_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_sf_pcl_5_s1\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_sf_pcl_5_s1'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s1\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_43' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_43' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_43')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_43\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_43\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_44' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_44' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_44')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_44\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_44\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_9' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_9' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_9\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much_w_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__10' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__10' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__10\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__11' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__11' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__11\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__12' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__12' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__12\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__13' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__13' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__13\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item' OR linkid = 'pcl_5_item' OR short_name = 'pcl_5_item')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item\"\n            END as \"pcl_5_item\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__14' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__14' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__14\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__14\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_8' OR linkid = 'add_family_member_registration_calculated_age_8' OR short_name = 'add_family_member_registration_calculated_age_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_8\"\n            END as \"add_family_member_registration_calculated_age_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_2' OR linkid = 'pcl_5_item_2' OR short_name = 'pcl_5_item_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_2\"\n            END as \"pcl_5_item_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_8' OR linkid = 'add_family_member_registration_calculated_month_8' OR short_name = 'add_family_member_registration_calculated_month_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_8\"\n            END as \"add_family_member_registration_calculated_month_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_8' OR linkid = 'add_family_member_registration_calculated_year_8' OR short_name = 'add_family_member_registration_calculated_year_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_8\"\n            END as \"add_family_member_registration_calculated_year_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_8' OR linkid = 'add_family_member_registration_date_of_birth_8' OR short_name = 'add_family_member_registration_date_of_birth_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_8\"\n            END as \"add_family_member_registration_date_of_birth_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_45' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_45' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_45')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_45\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_45\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_3' OR linkid = 'pcl_5_item_3' OR short_name = 'pcl_5_item_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_3\"\n            END as \"pcl_5_item_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__15' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__15' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__15\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_46' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_46' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_46')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_46\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_46\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__16' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__16' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__16')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__16\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__16\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_47' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_47' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_47')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_47\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_47\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_26' OR linkid = 'form_f1_question_26' OR short_name = 'form_f1_question_26')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_26\"\n            END as \"form_f1_question_26\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_27' OR linkid = 'form_f1_question_27' OR short_name = 'form_f1_question_27')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_27\"\n            END as \"form_f1_question_27\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_28' OR linkid = 'form_f1_question_28' OR short_name = 'form_f1_question_28')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_28\"\n            END as \"form_f1_question_28\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_29' OR linkid = 'form_f1_question_29' OR short_name = 'form_f1_question_29')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_29\"\n            END as \"form_f1_question_29\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_30' OR linkid = 'form_f1_question_30' OR short_name = 'form_f1_question_30')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_30\"\n            END as \"form_f1_question_30\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_48' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_48' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_48')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_48\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_48\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR short_name = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\"\n            END as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_49' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_49' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_49')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_49\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_49\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s1_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.293856Z", "completed_at": "2025-09-30T20:11:17.353603Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.355984Z", "completed_at": "2025-09-30T20:11:17.400239Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11189794540405273, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_registration_info_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_registration_info\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_registration_info'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_registration_info\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration' OR linkid = 'add_family_member_registration' OR short_name = 'add_family_member_registration')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration\"\n            END as \"add_family_member_registration\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_middle_name' OR linkid = 'add_family_member_registration_middle_name' OR short_name = 'add_family_member_registration_middle_name')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_middle_name\"\n            END as \"add_family_member_registration_middle_name\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_which_of_the_following_best_repr' OR linkid = 'add_family_member_registration_which_of_the_following_best_repr' OR short_name = 'add_family_member_registration_which_of_the_following_best_repr')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_which_of_the_following_best_repr\"\n            END as \"add_family_member_registration_which_of_the_following_best_repr\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_age_estimate_if_unknown' OR linkid = 'add_family_member_registration_age_estimate_if_unknown' OR short_name = 'add_family_member_registration_age_estimate_if_unknown')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_age_estimate_if_unknown\"\n            END as \"add_family_member_registration_age_estimate_if_unknown\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_last_name' OR linkid = 'add_family_member_registration_last_name' OR short_name = 'add_family_member_registration_last_name')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_last_name\"\n            END as \"add_family_member_registration_last_name\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'age' OR linkid = 'age' OR short_name = 'age')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"age\"\n            END as \"age\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_6' OR linkid = 'add_family_member_registration_calculated_age_6' OR short_name = 'add_family_member_registration_calculated_age_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_6\"\n            END as \"add_family_member_registration_calculated_age_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_unique_id' OR linkid = 'add_family_member_registration_unique_id' OR short_name = 'add_family_member_registration_unique_id')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_unique_id\"\n            END as \"add_family_member_registration_unique_id\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_have_you_received_engage_service' OR linkid = 'add_family_member_registration_have_you_received_engage_service' OR short_name = 'add_family_member_registration_have_you_received_engage_service')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_have_you_received_engage_service\"\n            END as \"add_family_member_registration_have_you_received_engage_service\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_6' OR linkid = 'add_family_member_registration_calculated_month_6' OR short_name = 'add_family_member_registration_calculated_month_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_6\"\n            END as \"add_family_member_registration_calculated_month_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_6' OR linkid = 'add_family_member_registration_calculated_year_6' OR short_name = 'add_family_member_registration_calculated_year_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_6\"\n            END as \"add_family_member_registration_calculated_year_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_6' OR linkid = 'add_family_member_registration_date_of_birth_6' OR short_name = 'add_family_member_registration_date_of_birth_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_6\"\n            END as \"add_family_member_registration_date_of_birth_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_what_term_best_expresses_how_you' OR linkid = 'add_family_member_registration_what_term_best_expresses_how_you' OR short_name = 'add_family_member_registration_what_term_best_expresses_how_you')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_what_term_best_expresses_how_you\"\n            END as \"add_family_member_registration_what_term_best_expresses_how_you\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_what_are_your_preferred_pronouns' OR linkid = 'add_family_member_registration_what_are_your_preferred_pronouns' OR short_name = 'add_family_member_registration_what_are_your_preferred_pronouns')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_what_are_your_preferred_pronouns\"\n            END as \"add_family_member_registration_what_are_your_preferred_pronouns\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_do_you_have_medicaid' OR linkid = 'add_family_member_registration_do_you_have_medicaid' OR short_name = 'add_family_member_registration_do_you_have_medicaid')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_do_you_have_medicaid\"\n            END as \"add_family_member_registration_do_you_have_medicaid\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_first_name' OR linkid = 'add_family_member_registration_first_name' OR short_name = 'add_family_member_registration_first_name')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_first_name\"\n            END as \"add_family_member_registration_first_name\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_email_address' OR linkid = 'add_family_member_registration_email_address' OR short_name = 'add_family_member_registration_email_address')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_email_address\"\n            END as \"add_family_member_registration_email_address\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_what_was_your_biological_sex_at_' OR linkid = 'add_family_member_registration_what_was_your_biological_sex_at_' OR short_name = 'add_family_member_registration_what_was_your_biological_sex_at_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_what_was_your_biological_sex_at_\"\n            END as \"add_family_member_registration_what_was_your_biological_sex_at_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_medicaid_number' OR linkid = 'add_family_member_registration_medicaid_number' OR short_name = 'add_family_member_registration_medicaid_number')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_medicaid_number\"\n            END as \"add_family_member_registration_medicaid_number\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_2' OR linkid = 'add_family_member_registration_2' OR short_name = 'add_family_member_registration_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_2\"\n            END as \"add_family_member_registration_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_3' OR linkid = 'add_family_member_registration_3' OR short_name = 'add_family_member_registration_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_3\"\n            END as \"add_family_member_registration_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_4' OR linkid = 'add_family_member_registration_4' OR short_name = 'add_family_member_registration_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_4\"\n            END as \"add_family_member_registration_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_5' OR linkid = 'add_family_member_registration_5' OR short_name = 'add_family_member_registration_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_5\"\n            END as \"add_family_member_registration_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_6' OR linkid = 'add_family_member_registration_6' OR short_name = 'add_family_member_registration_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_6\"\n            END as \"add_family_member_registration_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_phone_number' OR linkid = 'add_family_member_registration_phone_number' OR short_name = 'add_family_member_registration_phone_number')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        CASE\n                            WHEN \"add_family_member_registration_phone_number\" IS NOT NULL AND LENGTH(\"add_family_member_registration_phone_number\"::text) >= 4\n                            THEN 'XXX-XXX-' || RIGHT(\"add_family_member_registration_phone_number\"::text, 4)\n                            ELSE 'NO PHONE'\n                        END\n                    \n                ELSE \"add_family_member_registration_phone_number\"\n            END as \"add_family_member_registration_phone_number\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_physical_address' OR linkid = 'add_family_member_registration_physical_address' OR short_name = 'add_family_member_registration_physical_address')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_physical_address\"\n            END as \"add_family_member_registration_physical_address\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_where_did_you_first_learn_about_' OR linkid = 'add_family_member_registration_where_did_you_first_learn_about_' OR short_name = 'add_family_member_registration_where_did_you_first_learn_about_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_where_did_you_first_learn_about_\"\n            END as \"add_family_member_registration_where_did_you_first_learn_about_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_zip_code' OR linkid = 'add_family_member_registration_zip_code' OR short_name = 'add_family_member_registration_zip_code')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        CASE\n                            WHEN \"add_family_member_registration_zip_code\" IS NOT NULL\n                            THEN LEFT(\"add_family_member_registration_zip_code\"::text, 3) || 'XX'\n                            ELSE NULL\n                        END\n                    \n                ELSE \"add_family_member_registration_zip_code\"\n            END as \"add_family_member_registration_zip_code\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_registration_info_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.548040Z", "completed_at": "2025-09-30T20:11:17.616676Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.617345Z", "completed_at": "2025-09-30T20:11:17.654622Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10960006713867188, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_remove_patient_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_remove_patient\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_remove_patient'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_remove_patient\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ecbis_remove_family_form_date_of_death' OR linkid = 'ecbis_remove_family_form_date_of_death' OR short_name = 'ecbis_remove_family_form_date_of_death')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ecbis_remove_family_form_date_of_death\"\n            END as \"ecbis_remove_family_form_date_of_death\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ecbis_remove_family_form_give_other_reasons_for_removal' OR linkid = 'ecbis_remove_family_form_give_other_reasons_for_removal' OR short_name = 'ecbis_remove_family_form_give_other_reasons_for_removal')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ecbis_remove_family_form_give_other_reasons_for_removal\"\n            END as \"ecbis_remove_family_form_give_other_reasons_for_removal\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ecbis_remove_family_form_age_at_death_year' OR linkid = 'ecbis_remove_family_form_age_at_death_year' OR short_name = 'ecbis_remove_family_form_age_at_death_year')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ecbis_remove_family_form_age_at_death_year\"\n            END as \"ecbis_remove_family_form_age_at_death_year\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ecbis_remove_family_form' OR linkid = 'ecbis_remove_family_form' OR short_name = 'ecbis_remove_family_form')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ecbis_remove_family_form\"\n            END as \"ecbis_remove_family_form\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ecbis_remove_family_form_date_moved_away' OR linkid = 'ecbis_remove_family_form_date_moved_away' OR short_name = 'ecbis_remove_family_form_date_moved_away')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ecbis_remove_family_form_date_moved_away\"\n            END as \"ecbis_remove_family_form_date_moved_away\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response' OR linkid = 'survey_response' OR short_name = 'survey_response')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response\"\n            END as \"survey_response\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ecbis_remove_family_form_reason_for_removal' OR linkid = 'ecbis_remove_family_form_reason_for_removal' OR short_name = 'ecbis_remove_family_form_reason_for_removal')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ecbis_remove_family_form_reason_for_removal\"\n            END as \"ecbis_remove_family_form_reason_for_removal\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-birthdate' OR linkid = 'patient-birthdate' OR short_name = 'patient-birthdate')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-birthdate\"\n            END as \"patient-birthdate\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_remove_patient_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.553169Z", "completed_at": "2025-09-30T20:11:17.616952Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.619830Z", "completed_at": "2025-09-30T20:11:17.657395Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11193609237670898, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s2_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_sf_pcl_5_s2\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_sf_pcl_5_s2'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s2\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__17' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__17' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__17')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__17\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__17\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__18' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__18' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__18')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__18\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__18\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__19' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__19' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__19')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__19\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__19\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__20' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__20' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__20')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__20\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__20\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__21' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__21' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__21')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__21\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__21\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_4' OR linkid = 'pcl_5_item_4' OR short_name = 'pcl_5_item_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_4\"\n            END as \"pcl_5_item_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_50' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_50' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_50')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_50\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_50\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__22' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__22' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__22')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__22\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__22\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_5' OR linkid = 'pcl_5_item_5' OR short_name = 'pcl_5_item_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_5\"\n            END as \"pcl_5_item_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_51' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_51' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_51')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_51\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_51\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_6' OR linkid = 'pcl_5_item_6' OR short_name = 'pcl_5_item_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_6\"\n            END as \"pcl_5_item_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__23' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__23' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__23')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__23\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__23\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_52' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_52' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_52')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_52\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_52\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__24' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__24' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__24')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__24\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__24\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_53' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_53' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_53')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_53\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_53\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_26_2' OR linkid = 'form_f1_question_26_2' OR short_name = 'form_f1_question_26_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_26_2\"\n            END as \"form_f1_question_26_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_27_2' OR linkid = 'form_f1_question_27_2' OR short_name = 'form_f1_question_27_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_27_2\"\n            END as \"form_f1_question_27_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_28_2' OR linkid = 'form_f1_question_28_2' OR short_name = 'form_f1_question_28_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_28_2\"\n            END as \"form_f1_question_28_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_29_2' OR linkid = 'form_f1_question_29_2' OR short_name = 'form_f1_question_29_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_29_2\"\n            END as \"form_f1_question_29_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_30_2' OR linkid = 'form_f1_question_30_2' OR short_name = 'form_f1_question_30_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_30_2\"\n            END as \"form_f1_question_30_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_54' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_54' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_54')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_54\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_54\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_55' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_55' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_55')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_55\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_55\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s2_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.555845Z", "completed_at": "2025-09-30T20:11:17.617149Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.622920Z", "completed_at": "2025-09-30T20:11:17.662631Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1203463077545166, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sociodemographic_survey_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_sociodemographic_survey\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_sociodemographic_survey'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sociodemographic_survey\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_if_you_were_not_born_in_the_us_how_long' OR linkid = 'sociodemographic_survey_if_you_were_not_born_in_the_us_how_long' OR short_name = 'sociodemographic_survey_if_you_were_not_born_in_the_us_how_long')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_if_you_were_not_born_in_the_us_how_long\"\n            END as \"sociodemographic_survey_if_you_were_not_born_in_the_us_how_long\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_please_specify' OR linkid = 'sociodemographic_survey_please_specify' OR short_name = 'sociodemographic_survey_please_specify')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_please_specify\"\n            END as \"sociodemographic_survey_please_specify\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_please_specify_2' OR linkid = 'sociodemographic_survey_please_specify_2' OR short_name = 'sociodemographic_survey_please_specify_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_please_specify_2\"\n            END as \"sociodemographic_survey_please_specify_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_where_were_you_born' OR linkid = 'sociodemographic_survey_where_were_you_born' OR short_name = 'sociodemographic_survey_where_were_you_born')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_where_were_you_born\"\n            END as \"sociodemographic_survey_where_were_you_born\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'demographic_question' OR linkid = 'demographic_question' OR short_name = 'demographic_question')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"demographic_question\"\n            END as \"demographic_question\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'demographic_question_2' OR linkid = 'demographic_question_2' OR short_name = 'demographic_question_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"demographic_question_2\"\n            END as \"demographic_question_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_please_enter_the_number_of_years' OR linkid = 'sociodemographic_survey_please_enter_the_number_of_years' OR short_name = 'sociodemographic_survey_please_enter_the_number_of_years')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_please_enter_the_number_of_years\"\n            END as \"sociodemographic_survey_please_enter_the_number_of_years\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_we_would_like_to_know_about_what_you_do' OR linkid = 'sociodemographic_survey_we_would_like_to_know_about_what_you_do' OR short_name = 'sociodemographic_survey_we_would_like_to_know_about_what_you_do')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_we_would_like_to_know_about_what_you_do\"\n            END as \"sociodemographic_survey_we_would_like_to_know_about_what_you_do\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'demographic_question_3' OR linkid = 'demographic_question_3' OR short_name = 'demographic_question_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"demographic_question_3\"\n            END as \"demographic_question_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_please_enter_the_number_of_months' OR linkid = 'sociodemographic_survey_please_enter_the_number_of_months' OR short_name = 'sociodemographic_survey_please_enter_the_number_of_months')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_please_enter_the_number_of_months\"\n            END as \"sociodemographic_survey_please_enter_the_number_of_months\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_what_is_your_race_and_or_ethnicity' OR linkid = 'sociodemographic_survey_what_is_your_race_and_or_ethnicity' OR short_name = 'sociodemographic_survey_what_is_your_race_and_or_ethnicity')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_what_is_your_race_and_or_ethnicity\"\n            END as \"sociodemographic_survey_what_is_your_race_and_or_ethnicity\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'demographic_question_4' OR linkid = 'demographic_question_4' OR short_name = 'demographic_question_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"demographic_question_4\"\n            END as \"demographic_question_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'demographic_question_5' OR linkid = 'demographic_question_5' OR short_name = 'demographic_question_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"demographic_question_5\"\n            END as \"demographic_question_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_what_is_your_marital_status' OR linkid = 'sociodemographic_survey_what_is_your_marital_status' OR short_name = 'sociodemographic_survey_what_is_your_marital_status')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_what_is_your_marital_status\"\n            END as \"sociodemographic_survey_what_is_your_marital_status\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'demographic_question_6' OR linkid = 'demographic_question_6' OR short_name = 'demographic_question_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"demographic_question_6\"\n            END as \"demographic_question_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_what_was_the_highest_grade_or_level_of_' OR linkid = 'sociodemographic_survey_what_was_the_highest_grade_or_level_of_' OR short_name = 'sociodemographic_survey_what_was_the_highest_grade_or_level_of_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_what_was_the_highest_grade_or_level_of_\"\n            END as \"sociodemographic_survey_what_was_the_highest_grade_or_level_of_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sociodemographic_survey_please_specify_3' OR linkid = 'sociodemographic_survey_please_specify_3' OR short_name = 'sociodemographic_survey_please_specify_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sociodemographic_survey_please_specify_3\"\n            END as \"sociodemographic_survey_please_specify_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-age' OR linkid = 'patient-age' OR short_name = 'patient-age')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-age\"\n            END as \"patient-age\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-biological-sex' OR linkid = 'patient-biological-sex' OR short_name = 'patient-biological-sex')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-biological-sex\"\n            END as \"patient-biological-sex\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-dob' OR linkid = 'patient-dob' OR short_name = 'patient-dob')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-dob\"\n            END as \"patient-dob\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-gender-identity' OR linkid = 'patient-gender-identity' OR short_name = 'patient-gender-identity')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-gender-identity\"\n            END as \"patient-gender-identity\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-how-you-think-of-yourself' OR linkid = 'patient-how-you-think-of-yourself' OR short_name = 'patient-how-you-think-of-yourself')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-how-you-think-of-yourself\"\n            END as \"patient-how-you-think-of-yourself\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-name' OR linkid = 'patient-name' OR short_name = 'patient-name')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-name\"\n            END as \"patient-name\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-pronouns' OR linkid = 'patient-pronouns' OR short_name = 'patient-pronouns')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-pronouns\"\n            END as \"patient-pronouns\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'task_id_socio_pdf_2' OR linkid = 'task_id_socio_pdf_2' OR short_name = 'task_id_socio_pdf_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"task_id_socio_pdf_2\"\n            END as \"task_id_socio_pdf_2\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sociodemographic_survey_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.551094Z", "completed_at": "2025-09-30T20:11:17.625086Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.625453Z", "completed_at": "2025-09-30T20:11:17.693505Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1473848819732666, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sbirt_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_sbirt\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_sbirt'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sbirt\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_please_select_one_substance_you_would_like_to_discuss_fur' OR linkid = 'sbirt_please_select_one_substance_you_would_like_to_discuss_fur' OR short_name = 'sbirt_please_select_one_substance_you_would_like_to_discuss_fur')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_please_select_one_substance_you_would_like_to_discuss_fur\"\n            END as \"sbirt_please_select_one_substance_you_would_like_to_discuss_fur\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_methamphetam' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_methamphetam' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_methamphetam')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_methamphetam\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_methamphetam\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_cocaine_coke_crack_etc' OR linkid = 'sbirt_cocaine_coke_crack_etc' OR short_name = 'sbirt_cocaine_coke_crack_etc')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_cocaine_coke_crack_etc\"\n            END as \"sbirt_cocaine_coke_crack_etc\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_2' OR linkid = 'survey_response_2' OR short_name = 'survey_response_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_2\"\n            END as \"survey_response_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_do_' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_do_' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_do_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_do_\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_do_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_i_would_like_to_offer_an_opportunity_to_start_a_conversat' OR linkid = 'sbirt_i_would_like_to_offer_an_opportunity_to_start_a_conversat' OR short_name = 'sbirt_i_would_like_to_offer_an_opportunity_to_start_a_conversat')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_i_would_like_to_offer_an_opportunity_to_start_a_conversat\"\n            END as \"sbirt_i_would_like_to_offer_an_opportunity_to_start_a_conversat\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed_co' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed_co' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed_co')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed_co\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed_co\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_sto' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_sto' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_sto')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_sto\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_sto\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_2' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_2' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_2\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_drink_alcohol' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_drink_alcohol' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_drink_alcohol')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_drink_alcohol\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_drink_alcohol\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_str' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_str' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_str')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_str\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_str\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_3' OR linkid = 'survey_response_3' OR short_name = 'survey_response_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_3\"\n            END as \"survey_response_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_4' OR linkid = 'survey_response_4' OR short_name = 'survey_response_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_4\"\n            END as \"survey_response_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_2' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_2' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_2\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_2' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_2' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_2\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_3' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_3' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_3\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_i_want_to_use_no_more_than' OR linkid = 'sbirt_i_want_to_use_no_more_than' OR short_name = 'sbirt_i_want_to_use_no_more_than')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_i_want_to_use_no_more_than\"\n            END as \"sbirt_i_want_to_use_no_more_than\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt' OR linkid = 'sbirt' OR short_name = 'sbirt')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt\"\n            END as \"sbirt\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_what_service_was_the_client_referred_to' OR linkid = 'sbirt_what_service_was_the_client_referred_to' OR short_name = 'sbirt_what_service_was_the_client_referred_to')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_what_service_was_the_client_referred_to\"\n            END as \"sbirt_what_service_was_the_client_referred_to\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_prescription_stimulants_just_for_the_feeling_more_than_pr' OR linkid = 'sbirt_prescription_stimulants_just_for_the_feeling_more_than_pr' OR short_name = 'sbirt_prescription_stimulants_just_for_the_feeling_more_than_pr')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_prescription_stimulants_just_for_the_feeling_more_than_pr\"\n            END as \"sbirt_prescription_stimulants_just_for_the_feeling_more_than_pr\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_other_drugs' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_other_drugs' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_other_drugs')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_other_drugs\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_other_drugs\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecstasy_et' OR linkid = 'sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecstasy_et' OR short_name = 'sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecstasy_et')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecstasy_et\"\n            END as \"sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecstasy_et\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_i_want_to_use_no_more_than_2' OR linkid = 'sbirt_i_want_to_use_no_more_than_2' OR short_name = 'sbirt_i_want_to_use_no_more_than_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_i_want_to_use_no_more_than_2\"\n            END as \"sbirt_i_want_to_use_no_more_than_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_prescription_sti' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_prescription_sti' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_prescription_sti')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_prescription_sti\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_prescription_sti\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_would_you_be_interested_in_talking_and_learning_more_abou' OR linkid = 'sbirt_would_you_be_interested_in_talking_and_learning_more_abou' OR short_name = 'sbirt_would_you_be_interested_in_talking_and_learning_more_abou')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_would_you_be_interested_in_talking_and_learning_more_abou\"\n            END as \"sbirt_would_you_be_interested_in_talking_and_learning_more_abou\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_are_you_interested_in_learning_more_about_what_alcohol_do' OR linkid = 'sbirt_are_you_interested_in_learning_more_about_what_alcohol_do' OR short_name = 'sbirt_are_you_interested_in_learning_more_about_what_alcohol_do')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_are_you_interested_in_learning_more_about_what_alcohol_do\"\n            END as \"sbirt_are_you_interested_in_learning_more_about_what_alcohol_do\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_methamphetamine_' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_methamphetamine_' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_methamphetamine_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_methamphetamine_\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_methamphetamine_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_other_drugs_led_' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_other_drugs_led_' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_other_drugs_led_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_other_drugs_led_\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_other_drugs_led_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_cocaine' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_cocaine' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_cocaine')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_cocaine\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_cocaine\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_3' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_3' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_3\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__2' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__2' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__2\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_i_want_to_drink_no_more_than' OR linkid = 'sbirt_i_want_to_drink_no_more_than' OR short_name = 'sbirt_i_want_to_drink_no_more_than')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_i_want_to_drink_no_more_than\"\n            END as \"sbirt_i_want_to_drink_no_more_than\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_2' OR linkid = 'sbirt_2' OR short_name = 'sbirt_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_2\"\n            END as \"sbirt_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__3' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__3' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__3\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whippets_etc' OR linkid = 'sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whippets_etc' OR short_name = 'sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whippets_etc')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whippets_etc\"\n            END as \"sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whippets_etc\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_or_someone_else_been_injured_as_a_result_of_your' OR linkid = 'sbirt_have_you_or_someone_else_been_injured_as_a_result_of_your' OR short_name = 'sbirt_have_you_or_someone_else_been_injured_as_a_result_of_your')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_or_someone_else_been_injured_as_a_result_of_your\"\n            END as \"sbirt_have_you_or_someone_else_been_injured_as_a_result_of_your\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__4' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__4' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__4\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_how_often_do_you_have_six_or_more_drinks_on_one_occasion' OR linkid = 'sbirt_how_often_do_you_have_six_or_more_drinks_on_one_occasion' OR short_name = 'sbirt_how_often_do_you_have_six_or_more_drinks_on_one_occasion')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_how_often_do_you_have_six_or_more_drinks_on_one_occasion\"\n            END as \"sbirt_how_often_do_you_have_six_or_more_drinks_on_one_occasion\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_cannabis' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_cannabis' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_cannabis')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_cannabis\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_cannabis\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_inhalants_led_to' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_inhalants_led_to' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_inhalants_led_to')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_inhalants_led_to\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_inhalants_led_to\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_how_often_during_the_last_year_have_you_needed_a_first_dr' OR linkid = 'sbirt_how_often_during_the_last_year_have_you_needed_a_first_dr' OR short_name = 'sbirt_how_often_during_the_last_year_have_you_needed_a_first_dr')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_how_often_during_the_last_year_have_you_needed_a_first_dr\"\n            END as \"sbirt_how_often_during_the_last_year_have_you_needed_a_first_dr\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_4' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_4' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_4\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_hallucinogen' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_hallucinogen' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_hallucinogen')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_hallucinogen\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_hallucinogen\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_what_are_your_health_goals_around_substance_use' OR linkid = 'sbirt_what_are_your_health_goals_around_substance_use' OR short_name = 'sbirt_what_are_your_health_goals_around_substance_use')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_what_are_your_health_goals_around_substance_use\"\n            END as \"sbirt_what_are_your_health_goals_around_substance_use\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_3' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_3' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_3\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_experienced_withdrawal_symptoms_felt_sick_w' OR linkid = 'sbirt_have_you_ever_experienced_withdrawal_symptoms_felt_sick_w' OR short_name = 'sbirt_have_you_ever_experienced_withdrawal_symptoms_felt_sick_w')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_experienced_withdrawal_symptoms_felt_sick_w\"\n            END as \"sbirt_have_you_ever_experienced_withdrawal_symptoms_felt_sick_w\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_5' OR linkid = 'survey_response_5' OR short_name = 'survey_response_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_5\"\n            END as \"survey_response_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__5' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__5' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__5\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_sedatives' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_sedatives' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_sedatives')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_sedatives\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_sedatives\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_cannabis_led_to_' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_cannabis_led_to_' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_cannabis_led_to_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_cannabis_led_to_\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_cannabis_led_to_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_i_want_to_drink_no_more_than_2' OR linkid = 'sbirt_i_want_to_drink_no_more_than_2' OR short_name = 'sbirt_i_want_to_drink_no_more_than_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_i_want_to_drink_no_more_than_2\"\n            END as \"sbirt_i_want_to_drink_no_more_than_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_5' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_5' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_5\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_street_opioi' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_street_opioi' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_street_opioi')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_street_opioi\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_street_opioi\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_would_you_like_to_make_some_health_goals_around_substance' OR linkid = 'sbirt_would_you_like_to_make_some_health_goals_around_substance' OR short_name = 'sbirt_would_you_like_to_make_some_health_goals_around_substance')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_would_you_like_to_make_some_health_goals_around_substance\"\n            END as \"sbirt_would_you_like_to_make_some_health_goals_around_substance\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_of_drug_' OR linkid = 'sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_of_drug_' OR short_name = 'sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_of_drug_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_of_drug_\"\n            END as \"sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_of_drug_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_6' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_6' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_6\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_other_dr' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_other_dr' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_other_dr')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_other_dr\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_other_dr\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_did_the_client_accept_the_referral' OR linkid = 'sbirt_did_the_client_accept_the_referral' OR short_name = 'sbirt_did_the_client_accept_the_referral')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_did_the_client_accept_the_referral\"\n            END as \"sbirt_did_the_client_accept_the_referral\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_4' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_4' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_4\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_7' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_7' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_7\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_how_often_during_the_last_year_have_you_had_a_feeling_of_' OR linkid = 'sbirt_how_often_during_the_last_year_have_you_had_a_feeling_of_' OR short_name = 'sbirt_how_often_during_the_last_year_have_you_had_a_feeling_of_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_how_often_during_the_last_year_have_you_had_a_feeling_of_\"\n            END as \"sbirt_how_often_during_the_last_year_have_you_had_a_feeling_of_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_how_many_standard_drinks_containing_alcohol_do_you_have_o' OR linkid = 'sbirt_how_many_standard_drinks_containing_alcohol_do_you_have_o' OR short_name = 'sbirt_how_many_standard_drinks_containing_alcohol_do_you_have_o')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_how_many_standard_drinks_containing_alcohol_do_you_have_o\"\n            END as \"sbirt_how_many_standard_drinks_containing_alcohol_do_you_have_o\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_4' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_4' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_4\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_how_often_during_the_last_year_have_you_been_unable_to_re' OR linkid = 'sbirt_how_often_during_the_last_year_have_you_been_unable_to_re' OR short_name = 'sbirt_how_often_during_the_last_year_have_you_been_unable_to_re')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_how_often_during_the_last_year_have_you_been_unable_to_re\"\n            END as \"sbirt_how_often_during_the_last_year_have_you_been_unable_to_re\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_lets_start_by_discussing_the_pros_and_cons_of_changing_yo' OR linkid = 'sbirt_lets_start_by_discussing_the_pros_and_cons_of_changing_yo' OR short_name = 'sbirt_lets_start_by_discussing_the_pros_and_cons_of_changing_yo')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_lets_start_by_discussing_the_pros_and_cons_of_changing_yo\"\n            END as \"sbirt_lets_start_by_discussing_the_pros_and_cons_of_changing_yo\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_cannabis_marijuana_pot_grass_hash_etc' OR linkid = 'sbirt_cannabis_marijuana_pot_grass_hash_etc' OR short_name = 'sbirt_cannabis_marijuana_pot_grass_hash_etc')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_cannabis_marijuana_pot_grass_hash_etc\"\n            END as \"sbirt_cannabis_marijuana_pot_grass_hash_etc\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_inhalants' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_inhalants' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_inhalants')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_inhalants\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_inhalants\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_5' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_5' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_5\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__6' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__6' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__6\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_street_opioids_o' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_street_opioids_o' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_street_opioids_o')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_street_opioids_o\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_street_opioids_o\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_cocaine' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_cocaine' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_cocaine')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_cocaine\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_cocaine\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_6' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_6' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_6\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_how_often_do_you_have_a_drink_containing_alcohol' OR linkid = 'sbirt_how_often_do_you_have_a_drink_containing_alcohol' OR short_name = 'sbirt_how_often_do_you_have_a_drink_containing_alcohol')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_how_often_do_you_have_a_drink_containing_alcohol\"\n            END as \"sbirt_how_often_do_you_have_a_drink_containing_alcohol\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__7' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__7' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__7\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__8' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__8' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__8\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_any_other_drugs_to_get_high' OR linkid = 'sbirt_any_other_drugs_to_get_high' OR short_name = 'sbirt_any_other_drugs_to_get_high')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_any_other_drugs_to_get_high\"\n            END as \"sbirt_any_other_drugs_to_get_high\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_neglected_your_family_because_of_your_use_of_dru' OR linkid = 'sbirt_have_you_neglected_your_family_because_of_your_use_of_dru' OR short_name = 'sbirt_have_you_neglected_your_family_because_of_your_use_of_dru')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_neglected_your_family_because_of_your_use_of_dru\"\n            END as \"sbirt_have_you_neglected_your_family_because_of_your_use_of_dru\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_street_opioids_heroin_opium_etc_or_prescription_opioids_j' OR linkid = 'sbirt_street_opioids_heroin_opium_etc_or_prescription_opioids_j' OR short_name = 'sbirt_street_opioids_heroin_opium_etc_or_prescription_opioids_j')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_street_opioids_heroin_opium_etc_or_prescription_opioids_j\"\n            END as \"sbirt_street_opioids_heroin_opium_etc_or_prescription_opioids_j\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_6' OR linkid = 'survey_response_6' OR short_name = 'survey_response_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_6\"\n            END as \"survey_response_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_hallucinogens_le' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_hallucinogens_le' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_hallucinogens_le')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_hallucinogens_le\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_hallucinogens_le\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_are_you_interested_in_learning_more_about_what_the_substa' OR linkid = 'sbirt_are_you_interested_in_learning_more_about_what_the_substa' OR short_name = 'sbirt_are_you_interested_in_learning_more_about_what_the_substa')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_are_you_interested_in_learning_more_about_what_the_substa\"\n            END as \"sbirt_are_you_interested_in_learning_more_about_what_the_substa\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_8' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_8' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_8\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_7' OR linkid = 'add_family_member_registration_calculated_age_7' OR short_name = 'add_family_member_registration_calculated_age_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_7\"\n            END as \"add_family_member_registration_calculated_age_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use' OR linkid = 'sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use' OR short_name = 'sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use\"\n            END as \"sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_things_others_can_help_you_do' OR linkid = 'sbirt_things_others_can_help_you_do' OR short_name = 'sbirt_things_others_can_help_you_do')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_things_others_can_help_you_do\"\n            END as \"sbirt_things_others_can_help_you_do\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__9' OR linkid = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__9' OR short_name = 'sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__9\"\n            END as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expressed__9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_5' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_5' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_5\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_sedative' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_sedative' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_sedative')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_sedative\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_sedative\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_had_medical_problems_as_a_result_of_your_drug_us' OR linkid = 'sbirt_have_you_had_medical_problems_as_a_result_of_your_drug_us' OR short_name = 'sbirt_have_you_had_medical_problems_as_a_result_of_your_drug_us')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_had_medical_problems_as_a_result_of_your_drug_us\"\n            END as \"sbirt_have_you_had_medical_problems_as_a_result_of_your_drug_us\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_used_any_drugs_by_injection_non_medical_use' OR linkid = 'sbirt_have_you_ever_used_any_drugs_by_injection_non_medical_use' OR short_name = 'sbirt_have_you_ever_used_any_drugs_by_injection_non_medical_use')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_used_any_drugs_by_injection_non_medical_use\"\n            END as \"sbirt_have_you_ever_used_any_drugs_by_injection_non_medical_use\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_other_drugs' OR linkid = 'sbirt_other_drugs' OR short_name = 'sbirt_other_drugs')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_other_drugs\"\n            END as \"sbirt_other_drugs\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_engaged_in_illegal_activities_in_order_to_obtain' OR linkid = 'sbirt_have_you_engaged_in_illegal_activities_in_order_to_obtain' OR short_name = 'sbirt_have_you_engaged_in_illegal_activities_in_order_to_obtain')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_engaged_in_illegal_activities_in_order_to_obtain\"\n            END as \"sbirt_have_you_engaged_in_illegal_activities_in_order_to_obtain\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_prescrip' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_prescrip' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_prescrip')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_prescrip\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_prescrip\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_7' OR linkid = 'add_family_member_registration_calculated_month_7' OR short_name = 'add_family_member_registration_calculated_month_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_7\"\n            END as \"add_family_member_registration_calculated_month_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_7' OR linkid = 'add_family_member_registration_calculated_year_7' OR short_name = 'add_family_member_registration_calculated_year_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_7\"\n            END as \"add_family_member_registration_calculated_year_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_methamph' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_methamph' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_methamph')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_methamph\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_methamph\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_7' OR linkid = 'add_family_member_registration_date_of_birth_7' OR short_name = 'add_family_member_registration_date_of_birth_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_7\"\n            END as \"add_family_member_registration_date_of_birth_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_9' OR linkid = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_9' OR short_name = 'sbirt_during_the_past_three_months_how_often_have_you_had_a_s_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_9\"\n            END as \"sbirt_during_the_past_three_months_how_often_have_you_had_a_s_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_how_often_during_the_last_year_have_you_failed_to_do_what' OR linkid = 'sbirt_how_often_during_the_last_year_have_you_failed_to_do_what' OR short_name = 'sbirt_how_often_during_the_last_year_have_you_failed_to_do_what')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_how_often_during_the_last_year_have_you_failed_to_do_what\"\n            END as \"sbirt_how_often_during_the_last_year_have_you_failed_to_do_what\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_cocaine_led_to_h' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_cocaine_led_to_h' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_cocaine_led_to_h')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_cocaine_led_to_h\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_cocaine_led_to_h\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_cannabis' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_cannabis' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_cannabis')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_cannabis\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_cannabis\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_7' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_7' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_7\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_6' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_6' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_6\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_does_your_spouse_or_parents_ever_complain_about_your_invo' OR linkid = 'sbirt_does_your_spouse_or_parents_ever_complain_about_your_invo' OR short_name = 'sbirt_does_your_spouse_or_parents_ever_complain_about_your_invo')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_does_your_spouse_or_parents_ever_complain_about_your_invo\"\n            END as \"sbirt_does_your_spouse_or_parents_ever_complain_about_your_invo\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_street_o' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_street_o' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_street_o')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_street_o\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_street_o\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_all_and_1' OR linkid = 'sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_all_and_1' OR short_name = 'sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_all_and_1')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_all_and_1\"\n            END as \"sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_all_and_1\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_inhalant' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_inhalant' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_inhalant')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_inhalant\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_inhalant\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_was_the_client_referred' OR linkid = 'sbirt_was_the_client_referred' OR short_name = 'sbirt_was_the_client_referred')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_was_the_client_referred\"\n            END as \"sbirt_was_the_client_referred\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_drug_to_use_alcohol' OR linkid = 'sbirt_drug_to_use_alcohol' OR short_name = 'sbirt_drug_to_use_alcohol')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_drug_to_use_alcohol\"\n            END as \"sbirt_drug_to_use_alcohol\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_drug_to_use_marijuana_or_other' OR linkid = 'sbirt_drug_to_use_marijuana_or_other' OR short_name = 'sbirt_drug_to_use_marijuana_or_other')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_drug_to_use_marijuana_or_other\"\n            END as \"sbirt_drug_to_use_marijuana_or_other\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_has_your_use_of_sedatives_led_to' OR linkid = 'sbirt_in_the_past_three_months_has_your_use_of_sedatives_led_to' OR short_name = 'sbirt_in_the_past_three_months_has_your_use_of_sedatives_led_to')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_has_your_use_of_sedatives_led_to\"\n            END as \"sbirt_in_the_past_three_months_has_your_use_of_sedatives_led_to\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_7' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_7' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_7\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_8' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_8' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_8\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_used_hallucin' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_used_hallucin' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_used_hallucin')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_used_hallucin\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_used_hallucin\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_would_you_be_interested_in_learning_more_about_substance_' OR linkid = 'sbirt_would_you_be_interested_in_learning_more_about_substance_' OR short_name = 'sbirt_would_you_be_interested_in_learning_more_about_substance_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_would_you_be_interested_in_learning_more_about_substance_\"\n            END as \"sbirt_would_you_be_interested_in_learning_more_about_substance_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_are_you_always_able_to_stop_using_drugs_when_you_want_to' OR linkid = 'sbirt_are_you_always_able_to_stop_using_drugs_when_you_want_to' OR short_name = 'sbirt_are_you_always_able_to_stop_using_drugs_when_you_want_to')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_are_you_always_able_to_stop_using_drugs_when_you_want_to\"\n            END as \"sbirt_are_you_always_able_to_stop_using_drugs_when_you_want_to\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_things_you_can_do' OR linkid = 'sbirt_things_you_can_do' OR short_name = 'sbirt_things_you_can_do')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_things_you_can_do\"\n            END as \"sbirt_things_you_can_do\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_on_average_how_many_days_per_week_do_you_use_prescription' OR linkid = 'sbirt_on_average_how_many_days_per_week_do_you_use_prescription' OR short_name = 'sbirt_on_average_how_many_days_per_week_do_you_use_prescription')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_on_average_how_many_days_per_week_do_you_use_prescription\"\n            END as \"sbirt_on_average_how_many_days_per_week_do_you_use_prescription\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_sedatives_just_for_the_feeling_more_than_prescribed_or_th' OR linkid = 'sbirt_sedatives_just_for_the_feeling_more_than_prescribed_or_th' OR short_name = 'sbirt_sedatives_just_for_the_feeling_more_than_prescribed_or_th')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_sedatives_just_for_the_feeling_more_than_prescribed_or_th\"\n            END as \"sbirt_sedatives_just_for_the_feeling_more_than_prescribed_or_th\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_what_are_some_good_things_about_making_a_change' OR linkid = 'sbirt_what_are_some_good_things_about_making_a_change' OR short_name = 'sbirt_what_are_some_good_things_about_making_a_change')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_what_are_some_good_things_about_making_a_change\"\n            END as \"sbirt_what_are_some_good_things_about_making_a_change\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_how_often_during_the_last_year_have_you_found_that_you_we' OR linkid = 'sbirt_how_often_during_the_last_year_have_you_found_that_you_we' OR short_name = 'sbirt_how_often_during_the_last_year_have_you_found_that_you_we')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_how_often_during_the_last_year_have_you_found_that_you_we\"\n            END as \"sbirt_how_often_during_the_last_year_have_you_found_that_you_we\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_7' OR linkid = 'survey_response_7' OR short_name = 'survey_response_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_7\"\n            END as \"survey_response_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_used_drugs_other_than_those_required_for_medical' OR linkid = 'sbirt_have_you_used_drugs_other_than_those_required_for_medical' OR short_name = 'sbirt_have_you_used_drugs_other_than_those_required_for_medical')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_used_drugs_other_than_those_required_for_medical\"\n            END as \"sbirt_have_you_used_drugs_other_than_those_required_for_medical\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_has_a_relative_or_friend_or_a_doctor_or_another_health_wo' OR linkid = 'sbirt_has_a_relative_or_friend_or_a_doctor_or_another_health_wo' OR short_name = 'sbirt_has_a_relative_or_friend_or_a_doctor_or_another_health_wo')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_has_a_relative_or_friend_or_a_doctor_or_another_health_wo\"\n            END as \"sbirt_has_a_relative_or_friend_or_a_doctor_or_another_health_wo\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_9' OR linkid = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_9' OR short_name = 'sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_9\"\n            END as \"sbirt_in_the_past_three_months_how_often_have_you_failed_to_d_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_etc' OR linkid = 'sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_etc' OR short_name = 'sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_etc')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_etc\"\n            END as \"sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_etc\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_8' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_8' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_8\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_9' OR linkid = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_9' OR short_name = 'sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_9\"\n            END as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_or_s_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_8' OR linkid = 'survey_response_8' OR short_name = 'survey_response_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_8\"\n            END as \"survey_response_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_do_you_use_more_than_one_drug_at_a_time' OR linkid = 'sbirt_do_you_use_more_than_one_drug_at_a_time' OR short_name = 'sbirt_do_you_use_more_than_one_drug_at_a_time')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_do_you_use_more_than_one_drug_at_a_time\"\n            END as \"sbirt_do_you_use_more_than_one_drug_at_a_time\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_can_i_share_additional_treatment_options_with_you' OR linkid = 'sbirt_can_i_share_additional_treatment_options_with_you' OR short_name = 'sbirt_can_i_share_additional_treatment_options_with_you')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_can_i_share_additional_treatment_options_with_you\"\n            END as \"sbirt_can_i_share_additional_treatment_options_with_you\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_health_goals_do_not_want_to_change' OR linkid = 'sbirt_health_goals_do_not_want_to_change' OR short_name = 'sbirt_health_goals_do_not_want_to_change')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_health_goals_do_not_want_to_change\"\n            END as \"sbirt_health_goals_do_not_want_to_change\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_is_drug_dependence' OR linkid = 'sbirt_is_drug_dependence' OR short_name = 'sbirt_is_drug_dependence')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_is_drug_dependence\"\n            END as \"sbirt_is_drug_dependence\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_is_high_risk_alcohol' OR linkid = 'sbirt_is_high_risk_alcohol' OR short_name = 'sbirt_is_high_risk_alcohol')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_is_high_risk_alcohol\"\n            END as \"sbirt_is_high_risk_alcohol\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_is_high_risk_drug' OR linkid = 'sbirt_is_high_risk_drug' OR short_name = 'sbirt_is_high_risk_drug')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_is_high_risk_drug\"\n            END as \"sbirt_is_high_risk_drug\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_is_low_risk_alcohol' OR linkid = 'sbirt_is_low_risk_alcohol' OR short_name = 'sbirt_is_low_risk_alcohol')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_is_low_risk_alcohol\"\n            END as \"sbirt_is_low_risk_alcohol\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_is_low_risk_drug' OR linkid = 'sbirt_is_low_risk_drug' OR short_name = 'sbirt_is_low_risk_drug')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_is_low_risk_drug\"\n            END as \"sbirt_is_low_risk_drug\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_is_medium_risk_alcohol' OR linkid = 'sbirt_is_medium_risk_alcohol' OR short_name = 'sbirt_is_medium_risk_alcohol')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_is_medium_risk_alcohol\"\n            END as \"sbirt_is_medium_risk_alcohol\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_is_medium_risk_drug' OR linkid = 'sbirt_is_medium_risk_drug' OR short_name = 'sbirt_is_medium_risk_drug')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_is_medium_risk_drug\"\n            END as \"sbirt_is_medium_risk_drug\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_is_opioid_dependence' OR linkid = 'sbirt_is_opioid_dependence' OR short_name = 'sbirt_is_opioid_dependence')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_is_opioid_dependence\"\n            END as \"sbirt_is_opioid_dependence\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_other_drug_list' OR linkid = 'sbirt_other_drug_list' OR short_name = 'sbirt_other_drug_list')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_other_drug_list\"\n            END as \"sbirt_other_drug_list\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-age' OR linkid = 'patient-age' OR short_name = 'patient-age')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-age\"\n            END as \"patient-age\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-dob' OR linkid = 'patient-dob' OR short_name = 'patient-dob')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-dob\"\n            END as \"patient-dob\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-gender' OR linkid = 'patient-gender' OR short_name = 'patient-gender')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-gender\"\n            END as \"patient-gender\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'patient-name' OR linkid = 'patient-name' OR short_name = 'patient-name')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"patient-name\"\n            END as \"patient-name\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_score_audit' OR linkid = 'sbirt_score_audit' OR short_name = 'sbirt_score_audit')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_score_audit\"\n            END as \"sbirt_score_audit\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_score_dast' OR linkid = 'sbirt_score_dast' OR short_name = 'sbirt_score_dast')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_score_dast\"\n            END as \"sbirt_score_dast\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_should_converse_about_substance_use' OR linkid = 'sbirt_should_converse_about_substance_use' OR short_name = 'sbirt_should_converse_about_substance_use')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_should_converse_about_substance_use\"\n            END as \"sbirt_should_converse_about_substance_use\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_should_discuss_health_goals' OR linkid = 'sbirt_should_discuss_health_goals' OR short_name = 'sbirt_should_discuss_health_goals')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_should_discuss_health_goals\"\n            END as \"sbirt_should_discuss_health_goals\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_show_client_use_with_other_drugs' OR linkid = 'sbirt_show_client_use_with_other_drugs' OR short_name = 'sbirt_show_client_use_with_other_drugs')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_show_client_use_with_other_drugs\"\n            END as \"sbirt_show_client_use_with_other_drugs\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_show_discuss_next_steps' OR linkid = 'sbirt_show_discuss_next_steps' OR short_name = 'sbirt_show_discuss_next_steps')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_show_discuss_next_steps\"\n            END as \"sbirt_show_discuss_next_steps\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_show_goals' OR linkid = 'sbirt_show_goals' OR short_name = 'sbirt_show_goals')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_show_goals\"\n            END as \"sbirt_show_goals\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_show_intervention_when_low_risk' OR linkid = 'sbirt_show_intervention_when_low_risk' OR short_name = 'sbirt_show_intervention_when_low_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_show_intervention_when_low_risk\"\n            END as \"sbirt_show_intervention_when_low_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_show_intervention_when_medium_high_risk' OR linkid = 'sbirt_show_intervention_when_medium_high_risk' OR short_name = 'sbirt_show_intervention_when_medium_high_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_show_intervention_when_medium_high_risk\"\n            END as \"sbirt_show_intervention_when_medium_high_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_show_is_medium_high_risk' OR linkid = 'sbirt_show_is_medium_high_risk' OR short_name = 'sbirt_show_is_medium_high_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_show_is_medium_high_risk\"\n            END as \"sbirt_show_is_medium_high_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_show_summary_for_low_risk' OR linkid = 'sbirt_show_summary_for_low_risk' OR short_name = 'sbirt_show_summary_for_low_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_show_summary_for_low_risk\"\n            END as \"sbirt_show_summary_for_low_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_show_things_to_do' OR linkid = 'sbirt_show_things_to_do' OR short_name = 'sbirt_show_things_to_do')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_show_things_to_do\"\n            END as \"sbirt_show_things_to_do\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_task_id_sbirt_pdf' OR linkid = 'sbirt_task_id_sbirt_pdf' OR short_name = 'sbirt_task_id_sbirt_pdf')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_task_id_sbirt_pdf\"\n            END as \"sbirt_task_id_sbirt_pdf\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'sbirt_using_opioids_and_low_risk' OR linkid = 'sbirt_using_opioids_and_low_risk' OR short_name = 'sbirt_using_opioids_and_low_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"sbirt_using_opioids_and_low_risk\"\n            END as \"sbirt_using_opioids_and_low_risk\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sbirt_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.663080Z", "completed_at": "2025-09-30T20:11:17.711700Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.712034Z", "completed_at": "2025-09-30T20:11:17.755106Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09604573249816895, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s4_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_sf_pcl_5_s4\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_sf_pcl_5_s4'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s4\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__33' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__33' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__33')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__33\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__33\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__34' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__34' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__34')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__34\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__34\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__35' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__35' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__35')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__35\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__35\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_61' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_61' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_61')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_61\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_61\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__36' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__36' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__36')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__36\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__36\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__37' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__37' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__37')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__37\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__37\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_10' OR linkid = 'pcl_5_item_10' OR short_name = 'pcl_5_item_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_10\"\n            END as \"pcl_5_item_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__38' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__38' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__38')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__38\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__38\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_62' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_62' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_62')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_62\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_62\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_11' OR linkid = 'pcl_5_item_11' OR short_name = 'pcl_5_item_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_11\"\n            END as \"pcl_5_item_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_12' OR linkid = 'pcl_5_item_12' OR short_name = 'pcl_5_item_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_12\"\n            END as \"pcl_5_item_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__39' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__39' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__39')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__39\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__39\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_63' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_63' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_63')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_63\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_63\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__40' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__40' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__40')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__40\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__40\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_64' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_64' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_64')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_64\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_64\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_26_4' OR linkid = 'form_f1_question_26_4' OR short_name = 'form_f1_question_26_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_26_4\"\n            END as \"form_f1_question_26_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_27_4' OR linkid = 'form_f1_question_27_4' OR short_name = 'form_f1_question_27_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_27_4\"\n            END as \"form_f1_question_27_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_28_4' OR linkid = 'form_f1_question_28_4' OR short_name = 'form_f1_question_28_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_28_4\"\n            END as \"form_f1_question_28_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_29_4' OR linkid = 'form_f1_question_29_4' OR short_name = 'form_f1_question_29_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_29_4\"\n            END as \"form_f1_question_29_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_30_4' OR linkid = 'form_f1_question_30_4' OR short_name = 'form_f1_question_30_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_30_4\"\n            END as \"form_f1_question_30_4\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s4_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.667974Z", "completed_at": "2025-09-30T20:11:17.716677Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.716905Z", "completed_at": "2025-09-30T20:11:17.756275Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09727096557617188, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s3_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_sf_pcl_5_s3\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_sf_pcl_5_s3'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s3\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__25' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__25' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__25')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__25\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__25\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__26' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__26' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__26')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__26\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__26\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__27' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__27' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__27')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__27\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__27\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__28' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__28' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__28')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__28\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__28\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__29' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__29' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__29')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__29\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__29\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_7' OR linkid = 'pcl_5_item_7' OR short_name = 'pcl_5_item_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_7\"\n            END as \"pcl_5_item_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__30' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__30' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__30')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__30\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__30\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_56' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_56' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_56')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_56\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_56\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_57' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_57' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_57')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_57\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_57\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__31' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__31' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__31')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__31\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__31\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_8' OR linkid = 'pcl_5_item_8' OR short_name = 'pcl_5_item_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_8\"\n            END as \"pcl_5_item_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_58' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_58' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_58')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_58\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_58\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__32' OR linkid = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__32' OR short_name = 'short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__32')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__32\"\n            END as \"short_form_pcl_5_8_ipc_session_2_in_the_past_month_how_much__32\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_59' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_59' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_59')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_59\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_59\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_26_3' OR linkid = 'form_f1_question_26_3' OR short_name = 'form_f1_question_26_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_26_3\"\n            END as \"form_f1_question_26_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_27_3' OR linkid = 'form_f1_question_27_3' OR short_name = 'form_f1_question_27_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_27_3\"\n            END as \"form_f1_question_27_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_28_3' OR linkid = 'form_f1_question_28_3' OR short_name = 'form_f1_question_28_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_28_3\"\n            END as \"form_f1_question_28_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_29_3' OR linkid = 'form_f1_question_29_3' OR short_name = 'form_f1_question_29_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_29_3\"\n            END as \"form_f1_question_29_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_30_3' OR linkid = 'form_f1_question_30_3' OR short_name = 'form_f1_question_30_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_30_3\"\n            END as \"form_f1_question_30_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'pcl_5_item_9' OR linkid = 'pcl_5_item_9' OR short_name = 'pcl_5_item_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"pcl_5_item_9\"\n            END as \"pcl_5_item_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_60' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_60' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_60')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_60\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_60\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s3_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.672428Z", "completed_at": "2025-09-30T20:11:17.714458Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.714800Z", "completed_at": "2025-09-30T20:11:17.757029Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08836913108825684, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_1_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_spi_subform_1\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_spi_subform_1'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_1\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_is_medium_risk' OR linkid = 'spi_subform_1_is_medium_risk' OR short_name = 'spi_subform_1_is_medium_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_is_medium_risk\"\n            END as \"spi_subform_1_is_medium_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_were_any_of_these_in_the_past_three_months' OR linkid = 'spi_subform_1_were_any_of_these_in_the_past_three_months' OR short_name = 'spi_subform_1_were_any_of_these_in_the_past_three_months')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_were_any_of_these_in_the_past_three_months\"\n            END as \"spi_subform_1_were_any_of_these_in_the_past_three_months\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_in_the_past_month_have_you_been_thinking_about_ho' OR linkid = 'spi_subform_1_in_the_past_month_have_you_been_thinking_about_ho' OR short_name = 'spi_subform_1_in_the_past_month_have_you_been_thinking_about_ho')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_in_the_past_month_have_you_been_thinking_about_ho\"\n            END as \"spi_subform_1_in_the_past_month_have_you_been_thinking_about_ho\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_is_high_risk' OR linkid = 'spi_subform_1_is_high_risk' OR short_name = 'spi_subform_1_is_high_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_is_high_risk\"\n            END as \"spi_subform_1_is_high_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_in_the_past_month_have_you_had_these_thoughts_and' OR linkid = 'spi_subform_1_in_the_past_month_have_you_had_these_thoughts_and' OR short_name = 'spi_subform_1_in_the_past_month_have_you_had_these_thoughts_and')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_in_the_past_month_have_you_had_these_thoughts_and\"\n            END as \"spi_subform_1_in_the_past_month_have_you_had_these_thoughts_and\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1' OR linkid = 'spi_subform_1' OR short_name = 'spi_subform_1')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1\"\n            END as \"spi_subform_1\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_in_the_past_month_have_you_started_to_work_out_or' OR linkid = 'spi_subform_1_in_the_past_month_have_you_started_to_work_out_or' OR short_name = 'spi_subform_1_in_the_past_month_have_you_started_to_work_out_or')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_in_the_past_month_have_you_started_to_work_out_or\"\n            END as \"spi_subform_1_in_the_past_month_have_you_started_to_work_out_or\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_2' OR linkid = 'spi_subform_1_2' OR short_name = 'spi_subform_1_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_2\"\n            END as \"spi_subform_1_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_3' OR linkid = 'spi_subform_1_3' OR short_name = 'spi_subform_1_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_3\"\n            END as \"spi_subform_1_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_in_the_past_month_have_you_wished_you_were_dead_o' OR linkid = 'spi_subform_1_in_the_past_month_have_you_wished_you_were_dead_o' OR short_name = 'spi_subform_1_in_the_past_month_have_you_wished_you_were_dead_o')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_in_the_past_month_have_you_wished_you_were_dead_o\"\n            END as \"spi_subform_1_in_the_past_month_have_you_wished_you_were_dead_o\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_4' OR linkid = 'spi_subform_1_4' OR short_name = 'spi_subform_1_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_4\"\n            END as \"spi_subform_1_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_have_you_ever_done_anything_started_to_do_anythin' OR linkid = 'spi_subform_1_have_you_ever_done_anything_started_to_do_anythin' OR short_name = 'spi_subform_1_have_you_ever_done_anything_started_to_do_anythin')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_have_you_ever_done_anything_started_to_do_anythin\"\n            END as \"spi_subform_1_have_you_ever_done_anything_started_to_do_anythin\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_5' OR linkid = 'spi_subform_1_5' OR short_name = 'spi_subform_1_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_5\"\n            END as \"spi_subform_1_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_6' OR linkid = 'spi_subform_1_6' OR short_name = 'spi_subform_1_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_6\"\n            END as \"spi_subform_1_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_is_low_risk' OR linkid = 'spi_subform_1_is_low_risk' OR short_name = 'spi_subform_1_is_low_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_is_low_risk\"\n            END as \"spi_subform_1_is_low_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_in_the_past_month_have_you_actually_had_any_thoug' OR linkid = 'spi_subform_1_in_the_past_month_have_you_actually_had_any_thoug' OR short_name = 'spi_subform_1_in_the_past_month_have_you_actually_had_any_thoug')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_in_the_past_month_have_you_actually_had_any_thoug\"\n            END as \"spi_subform_1_in_the_past_month_have_you_actually_had_any_thoug\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_7' OR linkid = 'spi_subform_1_7' OR short_name = 'spi_subform_1_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_7\"\n            END as \"spi_subform_1_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_65' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_65' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_65')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_65\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_65\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_taskid_spi_subform_2' OR linkid = 'spi_subform_1_taskid_spi_subform_2' OR short_name = 'spi_subform_1_taskid_spi_subform_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_taskid_spi_subform_2\"\n            END as \"spi_subform_1_taskid_spi_subform_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_taskid_spi_subform_3' OR linkid = 'spi_subform_2_taskid_spi_subform_3' OR short_name = 'spi_subform_2_taskid_spi_subform_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_taskid_spi_subform_3\"\n            END as \"spi_subform_2_taskid_spi_subform_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_taskid_spi_subform_4' OR linkid = 'spi_subform_2_taskid_spi_subform_4' OR short_name = 'spi_subform_2_taskid_spi_subform_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_taskid_spi_subform_4\"\n            END as \"spi_subform_2_taskid_spi_subform_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_1_taskstatus_spi_subform_2' OR linkid = 'spi_subform_1_taskstatus_spi_subform_2' OR short_name = 'spi_subform_1_taskstatus_spi_subform_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_1_taskstatus_spi_subform_2\"\n            END as \"spi_subform_1_taskstatus_spi_subform_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_taskstatus_spi_subform_3' OR linkid = 'spi_subform_2_taskstatus_spi_subform_3' OR short_name = 'spi_subform_2_taskstatus_spi_subform_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_taskstatus_spi_subform_3\"\n            END as \"spi_subform_2_taskstatus_spi_subform_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_taskstatus_spi_subform_4' OR linkid = 'spi_subform_2_taskstatus_spi_subform_4' OR short_name = 'spi_subform_2_taskstatus_spi_subform_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_taskstatus_spi_subform_4\"\n            END as \"spi_subform_2_taskstatus_spi_subform_4\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_1_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.695411Z", "completed_at": "2025-09-30T20:11:17.736345Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.736553Z", "completed_at": "2025-09-30T20:11:17.764409Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07071900367736816, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_3_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_spi_subform_3\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_spi_subform_3'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_3\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_67' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_67' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_67')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_67\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_67\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_3_anon\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.769953Z", "completed_at": "2025-09-30T20:11:17.775327Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.775901Z", "completed_at": "2025-09-30T20:11:17.807712Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04348897933959961, "adapter_response": {}, "message": "Database Error in model encounters_by_delivery_format (models/metrics/encounters_by_delivery_format.sql)\n  column ipc.format_you_deliver does not exist\n  LINE 19:     ipc.format_you_deliver,\n               ^\n  compiled code at target/run/engage_analytics/models/metrics/encounters_by_delivery_format.sql", "failures": null, "unique_id": "model.engage_analytics.encounters_by_delivery_format", "compiled": true, "compiled_code": "-- models/metrics/encounters_by_delivery_format.sql\n\n\n-- View to track daily encounters by delivery format\n-- Based on IPC Session 1 questionnaire responses\n-- Provides daily counts (not cumulative) for each delivery format type\n\nwith ipc_sessions as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as session_date,\n    ipc.format_you_deliver,\n    ipc.practitioner_organization_id as organization_id\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  inner join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s1\" ipc\n    on ipc.qr_id = qr.id\n  where qr.subject_patient_id is not null\n    and ipc.format_you_deliver is not null\n)\n\nselect\n  session_date,\n  organization_id,\n  format_you_deliver,\n  subject_patient_id,\n  author_practitioner_id\nfrom ipc_sessions", "relation_name": "\"airbyte\".\"engage_analytics\".\"encounters_by_delivery_format\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.777889Z", "completed_at": "2025-09-30T20:11:17.833842Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.837559Z", "completed_at": "2025-09-30T20:11:17.876706Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10193586349487305, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_2_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_spi_subform_2\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_spi_subform_2'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_2\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_did_this_client_also_screen_positive_for_probable' OR linkid = 'spi_subform_2_did_this_client_also_screen_positive_for_probable' OR short_name = 'spi_subform_2_did_this_client_also_screen_positive_for_probable')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_did_this_client_also_screen_positive_for_probable\"\n            END as \"spi_subform_2_did_this_client_also_screen_positive_for_probable\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_did_you_discuss_this_client_s_severe_mental_healt' OR linkid = 'spi_subform_2_did_you_discuss_this_client_s_severe_mental_healt' OR short_name = 'spi_subform_2_did_you_discuss_this_client_s_severe_mental_healt')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_did_you_discuss_this_client_s_severe_mental_healt\"\n            END as \"spi_subform_2_did_you_discuss_this_client_s_severe_mental_healt\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_this_client_scored_in_the_moderate_to_high_range_' OR linkid = 'spi_subform_2_this_client_scored_in_the_moderate_to_high_range_' OR short_name = 'spi_subform_2_this_client_scored_in_the_moderate_to_high_range_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_this_client_scored_in_the_moderate_to_high_range_\"\n            END as \"spi_subform_2_this_client_scored_in_the_moderate_to_high_range_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_what_is_the_recommended_plan_to_address_the_proba' OR linkid = 'spi_subform_2_what_is_the_recommended_plan_to_address_the_proba' OR short_name = 'spi_subform_2_what_is_the_recommended_plan_to_address_the_proba')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_what_is_the_recommended_plan_to_address_the_proba\"\n            END as \"spi_subform_2_what_is_the_recommended_plan_to_address_the_proba\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2' OR linkid = 'spi_subform_2' OR short_name = 'spi_subform_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2\"\n            END as \"spi_subform_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_2' OR linkid = 'spi_subform_2_2' OR short_name = 'spi_subform_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_2\"\n            END as \"spi_subform_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_3' OR linkid = 'spi_subform_2_3' OR short_name = 'spi_subform_2_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_3\"\n            END as \"spi_subform_2_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_what_is_the_recommended_plan_to_address_the_pro_2' OR linkid = 'spi_subform_2_what_is_the_recommended_plan_to_address_the_pro_2' OR short_name = 'spi_subform_2_what_is_the_recommended_plan_to_address_the_pro_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_what_is_the_recommended_plan_to_address_the_pro_2\"\n            END as \"spi_subform_2_what_is_the_recommended_plan_to_address_the_pro_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_66' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_66' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_66')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_66\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_66\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_did_you_discuss_this_client_s_suicide_risk_screen' OR linkid = 'spi_subform_2_did_you_discuss_this_client_s_suicide_risk_screen' OR short_name = 'spi_subform_2_did_you_discuss_this_client_s_suicide_risk_screen')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_did_you_discuss_this_client_s_suicide_risk_screen\"\n            END as \"spi_subform_2_did_you_discuss_this_client_s_suicide_risk_screen\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_taskid_spi_subform_3_2' OR linkid = 'spi_subform_2_taskid_spi_subform_3_2' OR short_name = 'spi_subform_2_taskid_spi_subform_3_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_taskid_spi_subform_3_2\"\n            END as \"spi_subform_2_taskid_spi_subform_3_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_taskid_spi_subform_4_2' OR linkid = 'spi_subform_2_taskid_spi_subform_4_2' OR short_name = 'spi_subform_2_taskid_spi_subform_4_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_taskid_spi_subform_4_2\"\n            END as \"spi_subform_2_taskid_spi_subform_4_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_taskstatus_spi_subform_3_2' OR linkid = 'spi_subform_2_taskstatus_spi_subform_3_2' OR short_name = 'spi_subform_2_taskstatus_spi_subform_3_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_taskstatus_spi_subform_3_2\"\n            END as \"spi_subform_2_taskstatus_spi_subform_3_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_2_taskstatus_spi_subform_4_2' OR linkid = 'spi_subform_2_taskstatus_spi_subform_4_2' OR short_name = 'spi_subform_2_taskstatus_spi_subform_4_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_2_taskstatus_spi_subform_4_2\"\n            END as \"spi_subform_2_taskstatus_spi_subform_4_2\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_2_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.772070Z", "completed_at": "2025-09-30T20:11:17.827756Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.828798Z", "completed_at": "2025-09-30T20:11:17.903209Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13676691055297852, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s1_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_start_ipc_s1\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_start_ipc_s1'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s1\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_2' OR linkid = 'person_2' OR short_name = 'person_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_2\"\n            END as \"person_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_69' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_69' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_69')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_69\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_69\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_70' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_70' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_70')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_70\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_70\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_71' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_71' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_71')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_71\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_71\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_what_about_before_that_was_there_a_time_before_in' OR linkid = 'ipc_session_1_what_about_before_that_was_there_a_time_before_in' OR short_name = 'ipc_session_1_what_about_before_that_was_there_a_time_before_in')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_what_about_before_that_was_there_a_time_before_in\"\n            END as \"ipc_session_1_what_about_before_that_was_there_a_time_before_in\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_72' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_72' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_72')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_72\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_72\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_73' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_73' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_73')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_73\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_73\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_earlier_than_that_you_noticed_symptoms' OR linkid = 'ipc_session_1_earlier_than_that_you_noticed_symptoms' OR short_name = 'ipc_session_1_earlier_than_that_you_noticed_symptoms')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_earlier_than_that_you_noticed_symptoms\"\n            END as \"ipc_session_1_earlier_than_that_you_noticed_symptoms\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_is_there_anything_else_that_we_did_not_discuss_th' OR linkid = 'ipc_session_1_is_there_anything_else_that_we_did_not_discuss_th' OR short_name = 'ipc_session_1_is_there_anything_else_that_we_did_not_discuss_th')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_is_there_anything_else_that_we_did_not_discuss_th\"\n            END as \"ipc_session_1_is_there_anything_else_that_we_did_not_discuss_th\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1' OR linkid = 'ipc_session_1' OR short_name = 'ipc_session_1')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1\"\n            END as \"ipc_session_1\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_possible_problem_areas' OR linkid = 'ipc_session_1_possible_problem_areas' OR short_name = 'ipc_session_1_possible_problem_areas')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_possible_problem_areas\"\n            END as \"ipc_session_1_possible_problem_areas\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_74' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_74' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_74')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_74\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_74\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_what_were_the_symptoms' OR linkid = 'ipc_session_1_what_were_the_symptoms' OR short_name = 'ipc_session_1_what_were_the_symptoms')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_what_were_the_symptoms\"\n            END as \"ipc_session_1_what_were_the_symptoms\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_2' OR linkid = 'ipc_session_1_2' OR short_name = 'ipc_session_1_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_2\"\n            END as \"ipc_session_1_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_3' OR linkid = 'ipc_session_1_3' OR short_name = 'ipc_session_1_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_3\"\n            END as \"ipc_session_1_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_75' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_75' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_75')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_75\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_75\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_9' OR linkid = 'survey_response_9' OR short_name = 'survey_response_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_9\"\n            END as \"survey_response_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_your_most_distressing_current_symptoms_began' OR linkid = 'ipc_session_1_your_most_distressing_current_symptoms_began' OR short_name = 'ipc_session_1_your_most_distressing_current_symptoms_began')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_your_most_distressing_current_symptoms_began\"\n            END as \"ipc_session_1_your_most_distressing_current_symptoms_began\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_when_did_these_symptoms_begin' OR linkid = 'ipc_session_1_when_did_these_symptoms_begin' OR short_name = 'ipc_session_1_when_did_these_symptoms_begin')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_when_did_these_symptoms_begin\"\n            END as \"ipc_session_1_when_did_these_symptoms_begin\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_when_did_you_notice_these_symptoms' OR linkid = 'ipc_session_1_when_did_you_notice_these_symptoms' OR short_name = 'ipc_session_1_when_did_you_notice_these_symptoms')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_when_did_you_notice_these_symptoms\"\n            END as \"ipc_session_1_when_did_you_notice_these_symptoms\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_these_are_the_symptoms_you_said_you_are_currently' OR linkid = 'ipc_session_1_these_are_the_symptoms_you_said_you_are_currently' OR short_name = 'ipc_session_1_these_are_the_symptoms_you_said_you_are_currently')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_these_are_the_symptoms_you_said_you_are_currently\"\n            END as \"ipc_session_1_these_are_the_symptoms_you_said_you_are_currently\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_76' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_76' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_76')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_76\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_76\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_3' OR linkid = 'person_3' OR short_name = 'person_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_3\"\n            END as \"person_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_patient_age' OR linkid = 'ipc_session_1_patient_age' OR short_name = 'ipc_session_1_patient_age')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_patient_age\"\n            END as \"ipc_session_1_patient_age\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_4' OR linkid = 'ipc_session_1_4' OR short_name = 'ipc_session_1_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_4\"\n            END as \"ipc_session_1_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_i_noticed_that_when_i_was_asking_about_important_' OR linkid = 'ipc_session_1_i_noticed_that_when_i_was_asking_about_important_' OR short_name = 'ipc_session_1_i_noticed_that_when_i_was_asking_about_important_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_i_noticed_that_when_i_was_asking_about_important_\"\n            END as \"ipc_session_1_i_noticed_that_when_i_was_asking_about_important_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_patient_dob' OR linkid = 'ipc_session_1_patient_dob' OR short_name = 'ipc_session_1_patient_dob')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_patient_dob\"\n            END as \"ipc_session_1_patient_dob\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_5' OR linkid = 'ipc_session_1_5' OR short_name = 'ipc_session_1_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_5\"\n            END as \"ipc_session_1_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_77' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_77' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_77')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_77\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_77\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_1_2' OR linkid = 'mood_rating_ipc_session_1_2' OR short_name = 'mood_rating_ipc_session_1_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_1_2\"\n            END as \"mood_rating_ipc_session_1_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_6' OR linkid = 'ipc_session_1_6' OR short_name = 'ipc_session_1_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_6\"\n            END as \"ipc_session_1_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_78' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_78' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_78')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_78\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_78\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_79' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_79' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_79')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_79\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_79\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_80' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_80' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_80')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_80\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_80\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_do_you_agree_with_this_summary' OR linkid = 'ipc_session_1_do_you_agree_with_this_summary' OR short_name = 'ipc_session_1_do_you_agree_with_this_summary')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_do_you_agree_with_this_summary\"\n            END as \"ipc_session_1_do_you_agree_with_this_summary\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_in_what_format_did_you_deliver_this_session_with_' OR linkid = 'ipc_session_1_in_what_format_did_you_deliver_this_session_with_' OR short_name = 'ipc_session_1_in_what_format_did_you_deliver_this_session_with_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_in_what_format_did_you_deliver_this_session_with_\"\n            END as \"ipc_session_1_in_what_format_did_you_deliver_this_session_with_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_7' OR linkid = 'ipc_session_1_7' OR short_name = 'ipc_session_1_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_7\"\n            END as \"ipc_session_1_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_81' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_81' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_81')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_81\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_81\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_did_you_complete_the_required_assessment_s_and_th' OR linkid = 'ipc_session_2_did_you_complete_the_required_assessment_s_and_th' OR short_name = 'ipc_session_2_did_you_complete_the_required_assessment_s_and_th')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_did_you_complete_the_required_assessment_s_and_th\"\n            END as \"ipc_session_2_did_you_complete_the_required_assessment_s_and_th\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_10' OR linkid = 'add_family_member_registration_calculated_age_10' OR short_name = 'add_family_member_registration_calculated_age_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_10\"\n            END as \"add_family_member_registration_calculated_age_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_is_there_anything_that_could_get_in_the_way_of_yo' OR linkid = 'ipc_session_1_is_there_anything_that_could_get_in_the_way_of_yo' OR short_name = 'ipc_session_1_is_there_anything_that_could_get_in_the_way_of_yo')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_is_there_anything_that_could_get_in_the_way_of_yo\"\n            END as \"ipc_session_1_is_there_anything_that_could_get_in_the_way_of_yo\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_82' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_82' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_82')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_82\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_82\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_what_was_going_on_in_your_life_when_you_started_t' OR linkid = 'ipc_session_1_what_was_going_on_in_your_life_when_you_started_t' OR short_name = 'ipc_session_1_what_was_going_on_in_your_life_when_you_started_t')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_what_was_going_on_in_your_life_when_you_started_t\"\n            END as \"ipc_session_1_what_was_going_on_in_your_life_when_you_started_t\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_10' OR linkid = 'add_family_member_registration_calculated_month_10' OR short_name = 'add_family_member_registration_calculated_month_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_10\"\n            END as \"add_family_member_registration_calculated_month_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_10' OR linkid = 'add_family_member_registration_calculated_year_10' OR short_name = 'add_family_member_registration_calculated_year_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_10\"\n            END as \"add_family_member_registration_calculated_year_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_8' OR linkid = 'ipc_session_1_8' OR short_name = 'ipc_session_1_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_8\"\n            END as \"ipc_session_1_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_10' OR linkid = 'add_family_member_registration_date_of_birth_10' OR short_name = 'add_family_member_registration_date_of_birth_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_10\"\n            END as \"add_family_member_registration_date_of_birth_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_83' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_83' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_83')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_83\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_83\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_1_total_score_2' OR linkid = 'mood_rating_ipc_session_1_total_score_2' OR short_name = 'mood_rating_ipc_session_1_total_score_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_1_total_score_2\"\n            END as \"mood_rating_ipc_session_1_total_score_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_84' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_84' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_84')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_84\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_84\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_what_was_happening_then' OR linkid = 'ipc_session_1_what_was_happening_then' OR short_name = 'ipc_session_1_what_was_happening_then')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_what_was_happening_then\"\n            END as \"ipc_session_1_what_was_happening_then\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_9' OR linkid = 'ipc_session_1_9' OR short_name = 'ipc_session_1_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_9\"\n            END as \"ipc_session_1_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_85' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_85' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_85')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_85\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_85\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_of_these_symptoms_which_are_the_most_distressing' OR linkid = 'ipc_session_1_of_these_symptoms_which_are_the_most_distressing' OR short_name = 'ipc_session_1_of_these_symptoms_which_are_the_most_distressing')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_of_these_symptoms_which_are_the_most_distressing\"\n            END as \"ipc_session_1_of_these_symptoms_which_are_the_most_distressing\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_86' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_86' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_86')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_86\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_86\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_at_that_time_you_were_experiencing' OR linkid = 'ipc_session_1_at_that_time_you_were_experiencing' OR short_name = 'ipc_session_1_at_that_time_you_were_experiencing')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_at_that_time_you_were_experiencing\"\n            END as \"ipc_session_1_at_that_time_you_were_experiencing\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__5' OR linkid = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__5' OR short_name = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__5\"\n            END as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_38' OR linkid = 'form_f1_question_38' OR short_name = 'form_f1_question_38')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_38\"\n            END as \"form_f1_question_38\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_10' OR linkid = 'ipc_session_1_10' OR short_name = 'ipc_session_1_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_10\"\n            END as \"ipc_session_1_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_1' OR linkid = 'person_1' OR short_name = 'person_1')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_1\"\n            END as \"person_1\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_1_2' OR linkid = 'person_1_2' OR short_name = 'person_1_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_1_2\"\n            END as \"person_1_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_1_how_has_this_relationship_changed_following_trauma_if_' OR linkid = 'person_1_how_has_this_relationship_changed_following_trauma_if_' OR short_name = 'person_1_how_has_this_relationship_changed_following_trauma_if_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_1_how_has_this_relationship_changed_following_trauma_if_\"\n            END as \"person_1_how_has_this_relationship_changed_following_trauma_if_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_1_person_1_is' OR linkid = 'person_1_person_1_is' OR short_name = 'person_1_person_1_is')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_1_person_1_is\"\n            END as \"person_1_person_1_is\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_2_2' OR linkid = 'person_2_2' OR short_name = 'person_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_2_2\"\n            END as \"person_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_2_3' OR linkid = 'person_2_3' OR short_name = 'person_2_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_2_3\"\n            END as \"person_2_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_2_how_has_this_relationship_changed_following_trauma_if_' OR linkid = 'person_2_how_has_this_relationship_changed_following_trauma_if_' OR short_name = 'person_2_how_has_this_relationship_changed_following_trauma_if_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_2_how_has_this_relationship_changed_following_trauma_if_\"\n            END as \"person_2_how_has_this_relationship_changed_following_trauma_if_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_2_person_2_is' OR linkid = 'person_2_person_2_is' OR short_name = 'person_2_person_2_is')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_2_person_2_is\"\n            END as \"person_2_person_2_is\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_3_2' OR linkid = 'person_3_2' OR short_name = 'person_3_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_3_2\"\n            END as \"person_3_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_3_3' OR linkid = 'person_3_3' OR short_name = 'person_3_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_3_3\"\n            END as \"person_3_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_3_how_has_this_relationship_changed_following_trauma_if_' OR linkid = 'person_3_how_has_this_relationship_changed_following_trauma_if_' OR short_name = 'person_3_how_has_this_relationship_changed_following_trauma_if_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_3_how_has_this_relationship_changed_following_trauma_if_\"\n            END as \"person_3_how_has_this_relationship_changed_following_trauma_if_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_3_person_3_is' OR linkid = 'person_3_person_3_is' OR short_name = 'person_3_person_3_is')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_3_person_3_is\"\n            END as \"person_3_person_3_is\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_4' OR linkid = 'person_4' OR short_name = 'person_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_4\"\n            END as \"person_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_4_2' OR linkid = 'person_4_2' OR short_name = 'person_4_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_4_2\"\n            END as \"person_4_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_4_how_has_this_relationship_changed_following_trauma_if_' OR linkid = 'person_4_how_has_this_relationship_changed_following_trauma_if_' OR short_name = 'person_4_how_has_this_relationship_changed_following_trauma_if_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_4_how_has_this_relationship_changed_following_trauma_if_\"\n            END as \"person_4_how_has_this_relationship_changed_following_trauma_if_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'person_4_person_4_is' OR linkid = 'person_4_person_4_is' OR short_name = 'person_4_person_4_is')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"person_4_person_4_is\"\n            END as \"person_4_person_4_is\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_11' OR linkid = 'ipc_session_1_11' OR short_name = 'ipc_session_1_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_11\"\n            END as \"ipc_session_1_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_has_this_person_been_consistently_close_to_you_or' OR linkid = 'ipc_session_1_has_this_person_been_consistently_close_to_you_or' OR short_name = 'ipc_session_1_has_this_person_been_consistently_close_to_you_or')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_has_this_person_been_consistently_close_to_you_or\"\n            END as \"ipc_session_1_has_this_person_been_consistently_close_to_you_or\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_12' OR linkid = 'ipc_session_1_12' OR short_name = 'ipc_session_1_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_12\"\n            END as \"ipc_session_1_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_has_this_person_been_consistently_close_to_you__2' OR linkid = 'ipc_session_1_has_this_person_been_consistently_close_to_you__2' OR short_name = 'ipc_session_1_has_this_person_been_consistently_close_to_you__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_has_this_person_been_consistently_close_to_you__2\"\n            END as \"ipc_session_1_has_this_person_been_consistently_close_to_you__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_13' OR linkid = 'ipc_session_1_13' OR short_name = 'ipc_session_1_13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_13\"\n            END as \"ipc_session_1_13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_has_this_person_been_consistently_close_to_you__3' OR linkid = 'ipc_session_1_has_this_person_been_consistently_close_to_you__3' OR short_name = 'ipc_session_1_has_this_person_been_consistently_close_to_you__3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_has_this_person_been_consistently_close_to_you__3\"\n            END as \"ipc_session_1_has_this_person_been_consistently_close_to_you__3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_14' OR linkid = 'ipc_session_1_14' OR short_name = 'ipc_session_1_14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_14\"\n            END as \"ipc_session_1_14\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_has_this_person_been_consistently_close_to_you__4' OR linkid = 'ipc_session_1_has_this_person_been_consistently_close_to_you__4' OR short_name = 'ipc_session_1_has_this_person_been_consistently_close_to_you__4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_has_this_person_been_consistently_close_to_you__4\"\n            END as \"ipc_session_1_has_this_person_been_consistently_close_to_you__4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_do_you_think_an_important_person_s_death_is_conne' OR linkid = 'ipc_session_1_do_you_think_an_important_person_s_death_is_conne' OR short_name = 'ipc_session_1_do_you_think_an_important_person_s_death_is_conne')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_do_you_think_an_important_person_s_death_is_conne\"\n            END as \"ipc_session_1_do_you_think_an_important_person_s_death_is_conne\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_tell_me_about_your_relationship_with_this_person_' OR linkid = 'ipc_session_1_tell_me_about_your_relationship_with_this_person_' OR short_name = 'ipc_session_1_tell_me_about_your_relationship_with_this_person_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_tell_me_about_your_relationship_with_this_person_\"\n            END as \"ipc_session_1_tell_me_about_your_relationship_with_this_person_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'form_f1_question_46' OR linkid = 'form_f1_question_46' OR short_name = 'form_f1_question_46')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"form_f1_question_46\"\n            END as \"form_f1_question_46\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_are_you_and_someone_else_having_a_strong_disagree' OR linkid = 'ipc_session_1_are_you_and_someone_else_having_a_strong_disagree' OR short_name = 'ipc_session_1_are_you_and_someone_else_having_a_strong_disagree')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_are_you_and_someone_else_having_a_strong_disagree\"\n            END as \"ipc_session_1_are_you_and_someone_else_having_a_strong_disagree\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_briefly_tell_me_about_the_disagreement' OR linkid = 'ipc_session_1_briefly_tell_me_about_the_disagreement' OR short_name = 'ipc_session_1_briefly_tell_me_about_the_disagreement')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_briefly_tell_me_about_the_disagreement\"\n            END as \"ipc_session_1_briefly_tell_me_about_the_disagreement\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_when_did_this_disagreement_happen' OR linkid = 'ipc_session_1_when_did_this_disagreement_happen' OR short_name = 'ipc_session_1_when_did_this_disagreement_happen')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_when_did_this_disagreement_happen\"\n            END as \"ipc_session_1_when_did_this_disagreement_happen\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_how_has_this_disagreement_been_affecting_you' OR linkid = 'ipc_session_1_how_has_this_disagreement_been_affecting_you' OR short_name = 'ipc_session_1_how_has_this_disagreement_been_affecting_you')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_how_has_this_disagreement_been_affecting_you\"\n            END as \"ipc_session_1_how_has_this_disagreement_been_affecting_you\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_have_there_been_any_changes_in_your_life_that_are' OR linkid = 'ipc_session_1_have_there_been_any_changes_in_your_life_that_are' OR short_name = 'ipc_session_1_have_there_been_any_changes_in_your_life_that_are')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_have_there_been_any_changes_in_your_life_that_are\"\n            END as \"ipc_session_1_have_there_been_any_changes_in_your_life_that_are\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_what_was_the_change' OR linkid = 'ipc_session_1_what_was_the_change' OR short_name = 'ipc_session_1_what_was_the_change')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_what_was_the_change\"\n            END as \"ipc_session_1_what_was_the_change\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_when_did_this_happen' OR linkid = 'ipc_session_1_when_did_this_happen' OR short_name = 'ipc_session_1_when_did_this_happen')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_when_did_this_happen\"\n            END as \"ipc_session_1_when_did_this_happen\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_if_the_client_did_not_mention_any_close_relations' OR linkid = 'ipc_session_1_if_the_client_did_not_mention_any_close_relations' OR short_name = 'ipc_session_1_if_the_client_did_not_mention_any_close_relations')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_if_the_client_did_not_mention_any_close_relations\"\n            END as \"ipc_session_1_if_the_client_did_not_mention_any_close_relations\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_would_you_say_you_have_close_relationships' OR linkid = 'ipc_session_1_would_you_say_you_have_close_relationships' OR short_name = 'ipc_session_1_would_you_say_you_have_close_relationships')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_would_you_say_you_have_close_relationships\"\n            END as \"ipc_session_1_would_you_say_you_have_close_relationships\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_has_anything_changed_in_your_life_so_that_now_you' OR linkid = 'ipc_session_1_has_anything_changed_in_your_life_so_that_now_you' OR short_name = 'ipc_session_1_has_anything_changed_in_your_life_so_that_now_you')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_has_anything_changed_in_your_life_so_that_now_you\"\n            END as \"ipc_session_1_has_anything_changed_in_your_life_so_that_now_you\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_when_did_this_event_happen' OR linkid = 'ipc_session_1_when_did_this_event_happen' OR short_name = 'ipc_session_1_when_did_this_event_happen')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_when_did_this_event_happen\"\n            END as \"ipc_session_1_when_did_this_event_happen\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_15' OR linkid = 'ipc_session_1_15' OR short_name = 'ipc_session_1_15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_15\"\n            END as \"ipc_session_1_15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_16' OR linkid = 'ipc_session_1_16' OR short_name = 'ipc_session_1_16')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_16\"\n            END as \"ipc_session_1_16\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_do_you_want_to_propose_an_interpersonal_formulati' OR linkid = 'ipc_session_1_do_you_want_to_propose_an_interpersonal_formulati' OR short_name = 'ipc_session_1_do_you_want_to_propose_an_interpersonal_formulati')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_do_you_want_to_propose_an_interpersonal_formulati\"\n            END as \"ipc_session_1_do_you_want_to_propose_an_interpersonal_formulati\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_do_you_agree_with_this' OR linkid = 'ipc_session_1_do_you_agree_with_this' OR short_name = 'ipc_session_1_do_you_agree_with_this')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_do_you_agree_with_this\"\n            END as \"ipc_session_1_do_you_agree_with_this\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_17' OR linkid = 'ipc_session_1_17' OR short_name = 'ipc_session_1_17')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_17\"\n            END as \"ipc_session_1_17\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_select_the_possible_interpersonal_problem_area_s_' OR linkid = 'ipc_session_1_select_the_possible_interpersonal_problem_area_s_' OR short_name = 'ipc_session_1_select_the_possible_interpersonal_problem_area_s_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_select_the_possible_interpersonal_problem_area_s_\"\n            END as \"ipc_session_1_select_the_possible_interpersonal_problem_area_s_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_18' OR linkid = 'ipc_session_1_18' OR short_name = 'ipc_session_1_18')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_18\"\n            END as \"ipc_session_1_18\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_1_at_that_time_you_were_experiencing_2' OR linkid = 'ipc_session_1_at_that_time_you_were_experiencing_2' OR short_name = 'ipc_session_1_at_that_time_you_were_experiencing_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_1_at_that_time_you_were_experiencing_2\"\n            END as \"ipc_session_1_at_that_time_you_were_experiencing_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' OR short_name = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\"\n            END as \"LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_87' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_87' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_87')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_87\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_87\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_88' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_88' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_88')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_88\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_88\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_89' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_89' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_89')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_89\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_89\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_90' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_90' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_90')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_90\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_90\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_91' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_91' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_91')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_91\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_91\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s1_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.834602Z", "completed_at": "2025-09-30T20:11:17.895209Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.895409Z", "completed_at": "2025-09-30T20:11:17.936176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10934996604919434, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s4_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_start_ipc_s4\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_start_ipc_s4'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s4\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_after_today_s_session_i_will_be_referring_you_for' OR linkid = 'ipc_session_4_after_today_s_session_i_will_be_referring_you_for' OR short_name = 'ipc_session_4_after_today_s_session_i_will_be_referring_you_for')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_after_today_s_session_i_will_be_referring_you_for\"\n            END as \"ipc_session_4_after_today_s_session_i_will_be_referring_you_for\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_how' OR linkid = 'ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_how' OR short_name = 'ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_how')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_how\"\n            END as \"ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_how\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_what_do_you_think_are_some_situations_that_may_tr' OR linkid = 'ipc_session_4_what_do_you_think_are_some_situations_that_may_tr' OR short_name = 'ipc_session_4_what_do_you_think_are_some_situations_that_may_tr')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_what_do_you_think_are_some_situations_that_may_tr\"\n            END as \"ipc_session_4_what_do_you_think_are_some_situations_that_may_tr\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_what_do_you_think_are_some_situations_that_may__2' OR linkid = 'ipc_session_4_what_do_you_think_are_some_situations_that_may__2' OR short_name = 'ipc_session_4_what_do_you_think_are_some_situations_that_may__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_what_do_you_think_are_some_situations_that_may__2\"\n            END as \"ipc_session_4_what_do_you_think_are_some_situations_that_may__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_i_am_going_to_provide_you_with_our_agency_s_conta' OR linkid = 'ipc_session_4_i_am_going_to_provide_you_with_our_agency_s_conta' OR short_name = 'ipc_session_4_i_am_going_to_provide_you_with_our_agency_s_conta')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_i_am_going_to_provide_you_with_our_agency_s_conta\"\n            END as \"ipc_session_4_i_am_going_to_provide_you_with_our_agency_s_conta\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_did_you_d_2' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_did_you_d_2' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_did_you_d_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_did_you_d_2\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_did_you_d_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_118' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_118' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_118')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_118\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_118\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_how_does_it_make_you_feel_to_know_that_today_is_o' OR linkid = 'ipc_session_4_how_does_it_make_you_feel_to_know_that_today_is_o' OR short_name = 'ipc_session_4_how_does_it_make_you_feel_to_know_that_today_is_o')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_how_does_it_make_you_feel_to_know_that_today_is_o\"\n            END as \"ipc_session_4_how_does_it_make_you_feel_to_know_that_today_is_o\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_what_is_t_2' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_what_is_t_2' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_what_is_t_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_what_is_t_2\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_what_is_t_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_13' OR linkid = 'survey_response_13' OR short_name = 'survey_response_13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_13\"\n            END as \"survey_response_13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_let_s_talk_about_what_skills_you_learned_here_tha' OR linkid = 'ipc_session_4_let_s_talk_about_what_skills_you_learned_here_tha' OR short_name = 'ipc_session_4_let_s_talk_about_what_skills_you_learned_here_tha')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_let_s_talk_about_what_skills_you_learned_here_tha\"\n            END as \"ipc_session_4_let_s_talk_about_what_skills_you_learned_here_tha\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_let_s_talk_about_what_skills_you_learned_here_t_2' OR linkid = 'ipc_session_4_let_s_talk_about_what_skills_you_learned_here_t_2' OR short_name = 'ipc_session_4_let_s_talk_about_what_skills_you_learned_here_t_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_let_s_talk_about_what_skills_you_learned_here_t_2\"\n            END as \"ipc_session_4_let_s_talk_about_what_skills_you_learned_here_t_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_let_s_look_at_your_symptom_changes_what_were_your' OR linkid = 'ipc_session_4_let_s_look_at_your_symptom_changes_what_were_your' OR short_name = 'ipc_session_4_let_s_look_at_your_symptom_changes_what_were_your')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_let_s_look_at_your_symptom_changes_what_were_your\"\n            END as \"ipc_session_4_let_s_look_at_your_symptom_changes_what_were_your\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_4' OR linkid = 'mood_rating_ipc_session_4' OR short_name = 'mood_rating_ipc_session_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_4\"\n            END as \"mood_rating_ipc_session_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_how_do_you_feel_about_today_being_our_last_sessio' OR linkid = 'ipc_session_4_how_do_you_feel_about_today_being_our_last_sessio' OR short_name = 'ipc_session_4_how_do_you_feel_about_today_being_our_last_sessio')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_how_do_you_feel_about_today_being_our_last_sessio\"\n            END as \"ipc_session_4_how_do_you_feel_about_today_being_our_last_sessio\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_referral__2' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_referral__2' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_referral__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_referral__2\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_referral__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_in_what_format_did_you_deliver_this_session_with_' OR linkid = 'ipc_session_4_in_what_format_did_you_deliver_this_session_with_' OR short_name = 'ipc_session_4_in_what_format_did_you_deliver_this_session_with_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_in_what_format_did_you_deliver_this_session_with_\"\n            END as \"ipc_session_4_in_what_format_did_you_deliver_this_session_with_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_how_would_you_know_if_your_symptoms_are_coming_ba' OR linkid = 'ipc_session_4_how_would_you_know_if_your_symptoms_are_coming_ba' OR short_name = 'ipc_session_4_how_would_you_know_if_your_symptoms_are_coming_ba')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_how_would_you_know_if_your_symptoms_are_coming_ba\"\n            END as \"ipc_session_4_how_would_you_know_if_your_symptoms_are_coming_ba\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_after_today_s_session_i_can_refer_you_for_clinica' OR linkid = 'ipc_session_4_after_today_s_session_i_can_refer_you_for_clinica' OR short_name = 'ipc_session_4_after_today_s_session_i_can_refer_you_for_clinica')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_after_today_s_session_i_can_refer_you_for_clinica\"\n            END as \"ipc_session_4_after_today_s_session_i_can_refer_you_for_clinica\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_reason' OR linkid = 'ipc_session_4_reason' OR short_name = 'ipc_session_4_reason')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_reason\"\n            END as \"ipc_session_4_reason\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_what_are_some_of_the_skills_you_learned_here_that' OR linkid = 'ipc_session_4_what_are_some_of_the_skills_you_learned_here_that' OR short_name = 'ipc_session_4_what_are_some_of_the_skills_you_learned_here_that')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_what_are_some_of_the_skills_you_learned_here_that\"\n            END as \"ipc_session_4_what_are_some_of_the_skills_you_learned_here_that\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_119' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_119' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_119')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_119\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_119\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_120' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_120' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_120')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_120\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_120\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_please_select_how_you_would_like_to_proceed_with_' OR linkid = 'ipc_session_4_please_select_how_you_would_like_to_proceed_with_' OR short_name = 'ipc_session_4_please_select_how_you_would_like_to_proceed_with_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_please_select_how_you_would_like_to_proceed_with_\"\n            END as \"ipc_session_4_please_select_how_you_would_like_to_proceed_with_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_what_do_you_think_you_still_need_to_work_on_regar' OR linkid = 'ipc_session_4_what_do_you_think_you_still_need_to_work_on_regar' OR short_name = 'ipc_session_4_what_do_you_think_you_still_need_to_work_on_regar')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_what_do_you_think_you_still_need_to_work_on_regar\"\n            END as \"ipc_session_4_what_do_you_think_you_still_need_to_work_on_regar\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_what_we_know_is_that_symptoms_can_come_back_in_th' OR linkid = 'ipc_session_4_what_we_know_is_that_symptoms_can_come_back_in_th' OR short_name = 'ipc_session_4_what_we_know_is_that_symptoms_can_come_back_in_th')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_what_we_know_is_that_symptoms_can_come_back_in_th\"\n            END as \"ipc_session_4_what_we_know_is_that_symptoms_can_come_back_in_th\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_what_do_you_think_you_still_need_to_work_on_reg_2' OR linkid = 'ipc_session_4_what_do_you_think_you_still_need_to_work_on_reg_2' OR short_name = 'ipc_session_4_what_do_you_think_you_still_need_to_work_on_reg_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_what_do_you_think_you_still_need_to_work_on_reg_2\"\n            END as \"ipc_session_4_what_do_you_think_you_still_need_to_work_on_reg_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__4' OR linkid = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__4' OR short_name = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_did_you_complete_the_required_assessment_s_and__4\"\n            END as \"ipc_session_2_did_you_complete_the_required_assessment_s_and__4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_14' OR linkid = 'survey_response_14' OR short_name = 'survey_response_14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_14\"\n            END as \"survey_response_14\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_total_score' OR linkid = 'ipc_session_4_total_score' OR short_name = 'ipc_session_4_total_score')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_total_score\"\n            END as \"ipc_session_4_total_score\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_what_are_some_of_the_skills_you_learned_here_th_2' OR linkid = 'ipc_session_4_what_are_some_of_the_skills_you_learned_here_th_2' OR short_name = 'ipc_session_4_what_are_some_of_the_skills_you_learned_here_th_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_what_are_some_of_the_skills_you_learned_here_th_2\"\n            END as \"ipc_session_4_what_are_some_of_the_skills_you_learned_here_th_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_let_s_look_at_your_symptom_changes_what_were_yo_2' OR linkid = 'ipc_session_4_let_s_look_at_your_symptom_changes_what_were_yo_2' OR short_name = 'ipc_session_4_let_s_look_at_your_symptom_changes_what_were_yo_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_let_s_look_at_your_symptom_changes_what_were_yo_2\"\n            END as \"ipc_session_4_let_s_look_at_your_symptom_changes_what_were_yo_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_121' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_121' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_121')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_121\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_121\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_h_2' OR linkid = 'ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_h_2' OR short_name = 'ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_h_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_h_2\"\n            END as \"ipc_session_4_do_you_remember_why_you_came_let_s_talk_about_h_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_15' OR linkid = 'survey_response_15' OR short_name = 'survey_response_15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_15\"\n            END as \"survey_response_15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_phq_9_total' OR linkid = 'ipc_session_4_phq_9_total' OR short_name = 'ipc_session_4_phq_9_total')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_phq_9_total\"\n            END as \"ipc_session_4_phq_9_total\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_gad_7_total' OR linkid = 'ipc_session_4_gad_7_total' OR short_name = 'ipc_session_4_gad_7_total')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_gad_7_total\"\n            END as \"ipc_session_4_gad_7_total\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_ptsd_total' OR linkid = 'ipc_session_4_ptsd_total' OR short_name = 'ipc_session_4_ptsd_total')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_ptsd_total\"\n            END as \"ipc_session_4_ptsd_total\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__8' OR linkid = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__8' OR short_name = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__8\"\n            END as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discussion_with_supervisor_for_severe_mental_health_superviso_3' OR linkid = 'discussion_with_supervisor_for_severe_mental_health_superviso_3' OR short_name = 'discussion_with_supervisor_for_severe_mental_health_superviso_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discussion_with_supervisor_for_severe_mental_health_superviso_3\"\n            END as \"discussion_with_supervisor_for_severe_mental_health_superviso_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_details' OR linkid = 'ipc_session_4_details' OR short_name = 'ipc_session_4_details')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_details\"\n            END as \"ipc_session_4_details\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_4_is_the_client_connected_to_clinical_care' OR linkid = 'ipc_session_4_is_the_client_connected_to_clinical_care' OR short_name = 'ipc_session_4_is_the_client_connected_to_clinical_care')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_4_is_the_client_connected_to_clinical_care\"\n            END as \"ipc_session_4_is_the_client_connected_to_clinical_care\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s4_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.767456Z", "completed_at": "2025-09-30T20:11:17.837248Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.843124Z", "completed_at": "2025-09-30T20:11:17.937125Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.17289519309997559, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_4_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_spi_subform_4\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_spi_subform_4'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_4\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item' OR linkid = 'spi_item' OR short_name = 'spi_item')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item\"\n            END as \"spi_item\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4' OR linkid = 'spi_subform_4' OR short_name = 'spi_subform_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4\"\n            END as \"spi_subform_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_serv' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_serv' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_serv')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_serv\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_serv\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_se_2' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_se_2' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_se_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_se_2\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_se_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_se_3' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_se_3' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_se_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_se_3\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_se_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_taking_pills_i_will_protect_myself_from_this_risk' OR linkid = 'spi_subform_4_taking_pills_i_will_protect_myself_from_this_risk' OR short_name = 'spi_subform_4_taking_pills_i_will_protect_myself_from_this_risk')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_taking_pills_i_will_protect_myself_from_this_risk\"\n            END as \"spi_subform_4_taking_pills_i_will_protect_myself_from_this_risk\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_duri' OR linkid = 'step_5professionals_or_professional_services_that_can_help_duri' OR short_name = 'step_5professionals_or_professional_services_that_can_help_duri')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_duri\"\n            END as \"step_5professionals_or_professional_services_that_can_help_duri\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_2' OR linkid = 'spi_subform_4_2' OR short_name = 'spi_subform_4_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_2\"\n            END as \"spi_subform_4_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_may_' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_may_' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_may_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_may_\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_may_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_3' OR linkid = 'spi_subform_4_3' OR short_name = 'spi_subform_4_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_3\"\n            END as \"spi_subform_4_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_du_2' OR linkid = 'step_5professionals_or_professional_services_that_can_help_du_2' OR short_name = 'step_5professionals_or_professional_services_that_can_help_du_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_du_2\"\n            END as \"step_5professionals_or_professional_services_that_can_help_du_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_du_3' OR linkid = 'step_5professionals_or_professional_services_that_can_help_du_3' OR short_name = 'step_5professionals_or_professional_services_that_can_help_du_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_du_3\"\n            END as \"step_5professionals_or_professional_services_that_can_help_du_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_2_internal_coping_strategies' OR linkid = 'review_the_safety_planstep_2_internal_coping_strategies' OR short_name = 'review_the_safety_planstep_2_internal_coping_strategies')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_2_internal_coping_strategies\"\n            END as \"review_the_safety_planstep_2_internal_coping_strategies\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_4' OR linkid = 'spi_subform_4_4' OR short_name = 'spi_subform_4_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_4\"\n            END as \"spi_subform_4_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_2' OR linkid = 'spi_item_2' OR short_name = 'spi_item_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_2\"\n            END as \"spi_item_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_se_4' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_se_4' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_se_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_se_4\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_se_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_5' OR linkid = 'spi_subform_4_5' OR short_name = 'spi_subform_4_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_5\"\n            END as \"spi_subform_4_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_se_5' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_se_5' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_se_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_se_5\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_se_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_du_4' OR linkid = 'step_5professionals_or_professional_services_that_can_help_du_4' OR short_name = 'step_5professionals_or_professional_services_that_can_help_du_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_du_4\"\n            END as \"step_5professionals_or_professional_services_that_can_help_du_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_du_5' OR linkid = 'step_5professionals_or_professional_services_that_can_help_du_5' OR short_name = 'step_5professionals_or_professional_services_that_can_help_du_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_du_5\"\n            END as \"step_5professionals_or_professional_services_that_can_help_du_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_6_making_the_environment_safe_cuttin' OR linkid = 'review_the_safety_planstep_6_making_the_environment_safe_cuttin' OR short_name = 'review_the_safety_planstep_6_making_the_environment_safe_cuttin')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_6_making_the_environment_safe_cuttin\"\n            END as \"review_the_safety_planstep_6_making_the_environment_safe_cuttin\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_jumping_i_will_protect_myself_from_this_risk_by' OR linkid = 'spi_subform_4_jumping_i_will_protect_myself_from_this_risk_by' OR short_name = 'spi_subform_4_jumping_i_will_protect_myself_from_this_risk_by')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_jumping_i_will_protect_myself_from_this_risk_by\"\n            END as \"spi_subform_4_jumping_i_will_protect_myself_from_this_risk_by\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_hanging_i_will_protect_myself_from_this_risk_by' OR linkid = 'spi_subform_4_hanging_i_will_protect_myself_from_this_risk_by' OR short_name = 'spi_subform_4_hanging_i_will_protect_myself_from_this_risk_by')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_hanging_i_will_protect_myself_from_this_risk_by\"\n            END as \"spi_subform_4_hanging_i_will_protect_myself_from_this_risk_by\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_in_a_few_days_i_would_like_to_meet_for_a_follow_u' OR linkid = 'spi_subform_4_in_a_few_days_i_would_like_to_meet_for_a_follow_u' OR short_name = 'spi_subform_4_in_a_few_days_i_would_like_to_meet_for_a_follow_u')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_in_a_few_days_i_would_like_to_meet_for_a_follow_u\"\n            END as \"spi_subform_4_in_a_few_days_i_would_like_to_meet_for_a_follow_u\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_6' OR linkid = 'spi_subform_4_6' OR short_name = 'spi_subform_4_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_6\"\n            END as \"spi_subform_4_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_6_making_the_environment_safe_jumpin' OR linkid = 'review_the_safety_planstep_6_making_the_environment_safe_jumpin' OR short_name = 'review_the_safety_planstep_6_making_the_environment_safe_jumpin')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_6_making_the_environment_safe_jumpin\"\n            END as \"review_the_safety_planstep_6_making_the_environment_safe_jumpin\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_are_you_will' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_are_you_will' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_are_you_will')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_are_you_will\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_are_you_will\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_se_6' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_se_6' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_se_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_se_6\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_se_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_7' OR linkid = 'spi_subform_4_7' OR short_name = 'spi_subform_4_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_7\"\n            END as \"spi_subform_4_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_8' OR linkid = 'spi_subform_4_8' OR short_name = 'spi_subform_4_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_8\"\n            END as \"spi_subform_4_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_9' OR linkid = 'spi_subform_4_9' OR short_name = 'spi_subform_4_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_9\"\n            END as \"spi_subform_4_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_10' OR linkid = 'spi_subform_4_10' OR short_name = 'spi_subform_4_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_10\"\n            END as \"spi_subform_4_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_se_7' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_se_7' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_se_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_se_7\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_se_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_11' OR linkid = 'spi_subform_4_11' OR short_name = 'spi_subform_4_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_11\"\n            END as \"spi_subform_4_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_se_8' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_se_8' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_se_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_se_8\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_se_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_se_9' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_se_9' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_se_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_se_9\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_se_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_12' OR linkid = 'spi_subform_4_12' OR short_name = 'spi_subform_4_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_12\"\n            END as \"spi_subform_4_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_2' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_2' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_ma_2\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_13' OR linkid = 'spi_subform_4_13' OR short_name = 'spi_subform_4_13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_13\"\n            END as \"spi_subform_4_13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_10' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_10' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_10\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_14' OR linkid = 'spi_subform_4_14' OR short_name = 'spi_subform_4_14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_14\"\n            END as \"spi_subform_4_14\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_3' OR linkid = 'spi_item_3' OR short_name = 'spi_item_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_3\"\n            END as \"spi_item_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_4' OR linkid = 'spi_item_4' OR short_name = 'spi_item_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_4\"\n            END as \"spi_item_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_15' OR linkid = 'spi_subform_4_15' OR short_name = 'spi_subform_4_15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_15\"\n            END as \"spi_subform_4_15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_16' OR linkid = 'spi_subform_4_16' OR short_name = 'spi_subform_4_16')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_16\"\n            END as \"spi_subform_4_16\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_11' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_11' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_11\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_12' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_12' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_12\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_13' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_13' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_13\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_1_warning_signs' OR linkid = 'review_the_safety_planstep_1_warning_signs' OR short_name = 'review_the_safety_planstep_1_warning_signs')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_1_warning_signs\"\n            END as \"review_the_safety_planstep_1_warning_signs\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_du_6' OR linkid = 'step_5professionals_or_professional_services_that_can_help_du_6' OR short_name = 'step_5professionals_or_professional_services_that_can_help_du_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_du_6\"\n            END as \"step_5professionals_or_professional_services_that_can_help_du_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_14' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_14' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_14\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_14\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_du_7' OR linkid = 'step_5professionals_or_professional_services_that_can_help_du_7' OR short_name = 'step_5professionals_or_professional_services_that_can_help_du_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_du_7\"\n            END as \"step_5professionals_or_professional_services_that_can_help_du_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_17' OR linkid = 'spi_subform_4_17' OR short_name = 'spi_subform_4_17')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_17\"\n            END as \"spi_subform_4_17\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_15' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_15' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_15\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_5' OR linkid = 'spi_item_5' OR short_name = 'spi_item_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_5\"\n            END as \"spi_item_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_18' OR linkid = 'spi_subform_4_18' OR short_name = 'spi_subform_4_18')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_18\"\n            END as \"spi_subform_4_18\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_3' OR linkid = 'spi_subform_4_person_3' OR short_name = 'spi_subform_4_person_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_3\"\n            END as \"spi_subform_4_person_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_du_8' OR linkid = 'step_5professionals_or_professional_services_that_can_help_du_8' OR short_name = 'step_5professionals_or_professional_services_that_can_help_du_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_du_8\"\n            END as \"step_5professionals_or_professional_services_that_can_help_du_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_are_you_wi_2' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_are_you_wi_2' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_are_you_wi_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_are_you_wi_2\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_are_you_wi_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_the_methods_i_have_thought_about_using_include' OR linkid = 'spi_subform_4_the_methods_i_have_thought_about_using_include' OR short_name = 'spi_subform_4_the_methods_i_have_thought_about_using_include')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_the_methods_i_have_thought_about_using_include\"\n            END as \"spi_subform_4_the_methods_i_have_thought_about_using_include\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_1_warning_signs_2' OR linkid = 'review_the_safety_planstep_1_warning_signs_2' OR short_name = 'review_the_safety_planstep_1_warning_signs_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_1_warning_signs_2\"\n            END as \"review_the_safety_planstep_1_warning_signs_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_drowning_i_will_protect_myself_from_this_risk_by' OR linkid = 'spi_subform_4_drowning_i_will_protect_myself_from_this_risk_by' OR short_name = 'spi_subform_4_drowning_i_will_protect_myself_from_this_risk_by')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_drowning_i_will_protect_myself_from_this_risk_by\"\n            END as \"spi_subform_4_drowning_i_will_protect_myself_from_this_risk_by\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_19' OR linkid = 'spi_subform_4_19' OR short_name = 'spi_subform_4_19')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_19\"\n            END as \"spi_subform_4_19\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_20' OR linkid = 'spi_subform_4_20' OR short_name = 'spi_subform_4_20')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_20\"\n            END as \"spi_subform_4_20\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_person_2' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_person_2' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_person_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_person_2\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_person_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_16' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_16' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_16')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_16\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_16\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_21' OR linkid = 'spi_subform_4_21' OR short_name = 'spi_subform_4_21')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_21\"\n            END as \"spi_subform_4_21\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_2' OR linkid = 'spi_subform_4_person_2' OR short_name = 'spi_subform_4_person_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_2\"\n            END as \"spi_subform_4_person_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_6' OR linkid = 'spi_item_6' OR short_name = 'spi_item_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_6\"\n            END as \"spi_item_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_17' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_17' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_17')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_17\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_17\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_22' OR linkid = 'spi_subform_4_22' OR short_name = 'spi_subform_4_22')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_22\"\n            END as \"spi_subform_4_22\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_23' OR linkid = 'spi_subform_4_23' OR short_name = 'spi_subform_4_23')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_23\"\n            END as \"spi_subform_4_23\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_24' OR linkid = 'spi_subform_4_24' OR short_name = 'spi_subform_4_24')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_24\"\n            END as \"spi_subform_4_24\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_25' OR linkid = 'spi_subform_4_25' OR short_name = 'spi_subform_4_25')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_25\"\n            END as \"spi_subform_4_25\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_7' OR linkid = 'spi_item_7' OR short_name = 'spi_item_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_7\"\n            END as \"spi_item_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_18' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_18' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_18')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_18\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_18\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_26' OR linkid = 'spi_subform_4_26' OR short_name = 'spi_subform_4_26')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_26\"\n            END as \"spi_subform_4_26\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_8' OR linkid = 'spi_item_8' OR short_name = 'spi_item_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_8\"\n            END as \"spi_item_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help' OR linkid = 'step_4family_members_or_friends_who_may_offer_help' OR short_name = 'step_4family_members_or_friends_who_may_offer_help')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help\"\n            END as \"step_4family_members_or_friends_who_may_offer_help\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_4' OR linkid = 'spi_subform_4_person_4' OR short_name = 'spi_subform_4_person_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_4\"\n            END as \"spi_subform_4_person_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_19' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_19' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_19')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_19\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_19\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_20' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_20' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_20')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_20\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_20\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_21' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_21' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_21')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_21\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_21\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_cutting_i_will_protect_myself_from_this_risk_by' OR linkid = 'spi_subform_4_cutting_i_will_protect_myself_from_this_risk_by' OR short_name = 'spi_subform_4_cutting_i_will_protect_myself_from_this_risk_by')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_cutting_i_will_protect_myself_from_this_risk_by\"\n            END as \"spi_subform_4_cutting_i_will_protect_myself_from_this_risk_by\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_1_warning_signs_3' OR linkid = 'review_the_safety_planstep_1_warning_signs_3' OR short_name = 'review_the_safety_planstep_1_warning_signs_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_1_warning_signs_3\"\n            END as \"review_the_safety_planstep_1_warning_signs_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_22' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_22' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_22')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_22\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_22\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_3' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_3' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_ma_3\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_23' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_23' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_23')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_23\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_23\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_2_internal_coping_strategies_2' OR linkid = 'review_the_safety_planstep_2_internal_coping_strategies_2' OR short_name = 'review_the_safety_planstep_2_internal_coping_strategies_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_2_internal_coping_strategies_2\"\n            END as \"review_the_safety_planstep_2_internal_coping_strategies_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_du_9' OR linkid = 'step_5professionals_or_professional_services_that_can_help_du_9' OR short_name = 'step_5professionals_or_professional_services_that_can_help_du_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_du_9\"\n            END as \"step_5professionals_or_professional_services_that_can_help_du_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_24' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_24' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_24')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_24\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_24\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_25' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_25' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_25')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_25\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_25\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_2_internal_coping_strategies_3' OR linkid = 'review_the_safety_planstep_2_internal_coping_strategies_3' OR short_name = 'review_the_safety_planstep_2_internal_coping_strategies_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_2_internal_coping_strategies_3\"\n            END as \"review_the_safety_planstep_2_internal_coping_strategies_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_2' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_2' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_2\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_1' OR linkid = 'spi_subform_4_person_1' OR short_name = 'spi_subform_4_person_1')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_1\"\n            END as \"spi_subform_4_person_1\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_26' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_26' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_26')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_26\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_26\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_1_warning_signs_4' OR linkid = 'review_the_safety_planstep_1_warning_signs_4' OR short_name = 'review_the_safety_planstep_1_warning_signs_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_1_warning_signs_4\"\n            END as \"review_the_safety_planstep_1_warning_signs_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_5' OR linkid = 'spi_subform_4_person_5' OR short_name = 'spi_subform_4_person_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_5\"\n            END as \"spi_subform_4_person_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_3' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_3' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_3\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_27' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_27' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_27')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_27\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_27\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_9' OR linkid = 'spi_item_9' OR short_name = 'spi_item_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_9\"\n            END as \"spi_item_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_4' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_4' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_ma_4\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_using_a_firearm_i_will_protect_myself_from_this_r' OR linkid = 'spi_subform_4_using_a_firearm_i_will_protect_myself_from_this_r' OR short_name = 'spi_subform_4_using_a_firearm_i_will_protect_myself_from_this_r')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_using_a_firearm_i_will_protect_myself_from_this_r\"\n            END as \"spi_subform_4_using_a_firearm_i_will_protect_myself_from_this_r\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_27' OR linkid = 'spi_subform_4_27' OR short_name = 'spi_subform_4_27')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_27\"\n            END as \"spi_subform_4_27\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_28' OR linkid = 'spi_subform_4_28' OR short_name = 'spi_subform_4_28')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_28\"\n            END as \"spi_subform_4_28\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_taskid_my_safety_plan_pdf' OR linkid = 'spi_subform_4_taskid_my_safety_plan_pdf' OR short_name = 'spi_subform_4_taskid_my_safety_plan_pdf')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_taskid_my_safety_plan_pdf\"\n            END as \"spi_subform_4_taskid_my_safety_plan_pdf\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_10' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_10' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_10\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_29' OR linkid = 'spi_subform_4_29' OR short_name = 'spi_subform_4_29')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_29\"\n            END as \"spi_subform_4_29\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_28' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_28' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_28')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_28\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_28\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_30' OR linkid = 'spi_subform_4_30' OR short_name = 'spi_subform_4_30')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_30\"\n            END as \"spi_subform_4_30\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_31' OR linkid = 'spi_subform_4_31' OR short_name = 'spi_subform_4_31')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_31\"\n            END as \"spi_subform_4_31\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_11' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_11' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_11\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_32' OR linkid = 'spi_subform_4_32' OR short_name = 'spi_subform_4_32')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_32\"\n            END as \"spi_subform_4_32\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_5' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_5' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_ma_5\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_10' OR linkid = 'spi_item_10' OR short_name = 'spi_item_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_10\"\n            END as \"spi_item_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_6' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_6' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_ma_6\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_29' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_29' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_29')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_29\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_29\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_33' OR linkid = 'spi_subform_4_33' OR short_name = 'spi_subform_4_33')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_33\"\n            END as \"spi_subform_4_33\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_12' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_12' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_12\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'when_you_feel_a_suicidal_crisis_arising_go_through_each_step_of' OR linkid = 'when_you_feel_a_suicidal_crisis_arising_go_through_each_step_of' OR short_name = 'when_you_feel_a_suicidal_crisis_arising_go_through_each_step_of')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"when_you_feel_a_suicidal_crisis_arising_go_through_each_step_of\"\n            END as \"when_you_feel_a_suicidal_crisis_arising_go_through_each_step_of\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_1_warning_signs_5' OR linkid = 'review_the_safety_planstep_1_warning_signs_5' OR short_name = 'review_the_safety_planstep_1_warning_signs_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_1_warning_signs_5\"\n            END as \"review_the_safety_planstep_1_warning_signs_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_13' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_13' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_13\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_34' OR linkid = 'spi_subform_4_34' OR short_name = 'spi_subform_4_34')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_34\"\n            END as \"spi_subform_4_34\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_14' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_14' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_14\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_14\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_1_2' OR linkid = 'spi_subform_4_person_1_2' OR short_name = 'spi_subform_4_person_1_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_1_2\"\n            END as \"spi_subform_4_person_1_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_taskid_spi_navigator' OR linkid = 'spi_subform_4_taskid_spi_navigator' OR short_name = 'spi_subform_4_taskid_spi_navigator')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_taskid_spi_navigator\"\n            END as \"spi_subform_4_taskid_spi_navigator\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_35' OR linkid = 'spi_subform_4_35' OR short_name = 'spi_subform_4_35')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_35\"\n            END as \"spi_subform_4_35\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_4_2' OR linkid = 'spi_subform_4_person_4_2' OR short_name = 'spi_subform_4_person_4_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_4_2\"\n            END as \"spi_subform_4_person_4_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_11' OR linkid = 'spi_item_11' OR short_name = 'spi_item_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_11\"\n            END as \"spi_item_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_30' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_30' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_30')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_30\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_30\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_5_2' OR linkid = 'spi_subform_4_person_5_2' OR short_name = 'spi_subform_4_person_5_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_5_2\"\n            END as \"spi_subform_4_person_5_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_6_making_the_environment_safe_taking' OR linkid = 'review_the_safety_planstep_6_making_the_environment_safe_taking' OR short_name = 'review_the_safety_planstep_6_making_the_environment_safe_taking')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_6_making_the_environment_safe_taking\"\n            END as \"review_the_safety_planstep_6_making_the_environment_safe_taking\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_15' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_15' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_15\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_36' OR linkid = 'spi_subform_4_36' OR short_name = 'spi_subform_4_36')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_36\"\n            END as \"spi_subform_4_36\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_2_internal_coping_strategies_4' OR linkid = 'review_the_safety_planstep_2_internal_coping_strategies_4' OR short_name = 'review_the_safety_planstep_2_internal_coping_strategies_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_2_internal_coping_strategies_4\"\n            END as \"review_the_safety_planstep_2_internal_coping_strategies_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_i_would_like_to_make_a_plan_that_will_help_you_ma' OR linkid = 'spi_subform_4_i_would_like_to_make_a_plan_that_will_help_you_ma' OR short_name = 'spi_subform_4_i_would_like_to_make_a_plan_that_will_help_you_ma')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_i_would_like_to_make_a_plan_that_will_help_you_ma\"\n            END as \"spi_subform_4_i_would_like_to_make_a_plan_that_will_help_you_ma\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_7' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_7' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_ma_7\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_31' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_31' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_31')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_31\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_31\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_16' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_16' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_16')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_16\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_16\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_32' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_32' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_32')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_32\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_32\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_9' OR linkid = 'add_family_member_registration_calculated_age_9' OR short_name = 'add_family_member_registration_calculated_age_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_9\"\n            END as \"add_family_member_registration_calculated_age_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_12' OR linkid = 'spi_item_12' OR short_name = 'spi_item_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_12\"\n            END as \"spi_item_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_8' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_8' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_ma_8\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_13' OR linkid = 'spi_item_13' OR short_name = 'spi_item_13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_13\"\n            END as \"spi_item_13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_37' OR linkid = 'spi_subform_4_37' OR short_name = 'spi_subform_4_37')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_37\"\n            END as \"spi_subform_4_37\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_4' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_4' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_4\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_38' OR linkid = 'spi_subform_4_38' OR short_name = 'spi_subform_4_38')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_38\"\n            END as \"spi_subform_4_38\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_39' OR linkid = 'spi_subform_4_39' OR short_name = 'spi_subform_4_39')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_39\"\n            END as \"spi_subform_4_39\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_17' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_17' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_17')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_17\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_17\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_40' OR linkid = 'spi_subform_4_40' OR short_name = 'spi_subform_4_40')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_40\"\n            END as \"spi_subform_4_40\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_18' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_18' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_18')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_18\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_18\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_9' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_9' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_ma_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_ma_9\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_ma_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_19' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_19' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_19')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_19\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_19\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_are_you_wi_3' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_are_you_wi_3' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_are_you_wi_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_are_you_wi_3\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_are_you_wi_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_41' OR linkid = 'spi_subform_4_41' OR short_name = 'spi_subform_4_41')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_41\"\n            END as \"spi_subform_4_41\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_42' OR linkid = 'spi_subform_4_42' OR short_name = 'spi_subform_4_42')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_42\"\n            END as \"spi_subform_4_42\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_other_ways_i_will_make_my_environment_safer' OR linkid = 'spi_subform_4_other_ways_i_will_make_my_environment_safer' OR short_name = 'spi_subform_4_other_ways_i_will_make_my_environment_safer')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_other_ways_i_will_make_my_environment_safer\"\n            END as \"spi_subform_4_other_ways_i_will_make_my_environment_safer\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_43' OR linkid = 'spi_subform_4_43' OR short_name = 'spi_subform_4_43')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_43\"\n            END as \"spi_subform_4_43\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_20' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_20' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_20')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_20\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_20\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_21' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_21' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_21')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_21\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_21\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_9' OR linkid = 'add_family_member_registration_calculated_month_9' OR short_name = 'add_family_member_registration_calculated_month_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_9\"\n            END as \"add_family_member_registration_calculated_month_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_9' OR linkid = 'add_family_member_registration_calculated_year_9' OR short_name = 'add_family_member_registration_calculated_year_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_9\"\n            END as \"add_family_member_registration_calculated_year_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_22' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_22' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_22')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_22\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_22\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_2_internal_coping_strategies_5' OR linkid = 'review_the_safety_planstep_2_internal_coping_strategies_5' OR short_name = 'review_the_safety_planstep_2_internal_coping_strategies_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_2_internal_coping_strategies_5\"\n            END as \"review_the_safety_planstep_2_internal_coping_strategies_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_9' OR linkid = 'add_family_member_registration_date_of_birth_9' OR short_name = 'add_family_member_registration_date_of_birth_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_9\"\n            END as \"add_family_member_registration_date_of_birth_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_44' OR linkid = 'spi_subform_4_44' OR short_name = 'spi_subform_4_44')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_44\"\n            END as \"spi_subform_4_44\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_23' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_23' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_23')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_23\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_23\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_m_10' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_m_10' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_m_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_m_10\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_m_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_24' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_24' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_24')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_24\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_24\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_6_making_the_environment_safe_going_' OR linkid = 'review_the_safety_planstep_6_making_the_environment_safe_going_' OR short_name = 'review_the_safety_planstep_6_making_the_environment_safe_going_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_6_making_the_environment_safe_going_\"\n            END as \"review_the_safety_planstep_6_making_the_environment_safe_going_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_14' OR linkid = 'spi_item_14' OR short_name = 'spi_item_14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_14\"\n            END as \"spi_item_14\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_25' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_25' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_25')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_25\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_25\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_m_11' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_m_11' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_m_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_m_11\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_m_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_45' OR linkid = 'spi_subform_4_45' OR short_name = 'spi_subform_4_45')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_45\"\n            END as \"spi_subform_4_45\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_2_2' OR linkid = 'spi_subform_4_person_2_2' OR short_name = 'spi_subform_4_person_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_2_2\"\n            END as \"spi_subform_4_person_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_person_1' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_person_1' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_person_1')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_person_1\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_person_1\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_m_12' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_m_12' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_m_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_m_12\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_m_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_6_making_the_environment_safe_using_' OR linkid = 'review_the_safety_planstep_6_making_the_environment_safe_using_' OR short_name = 'review_the_safety_planstep_6_making_the_environment_safe_using_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_6_making_the_environment_safe_using_\"\n            END as \"review_the_safety_planstep_6_making_the_environment_safe_using_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_46' OR linkid = 'spi_subform_4_46' OR short_name = 'spi_subform_4_46')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_46\"\n            END as \"spi_subform_4_46\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_33' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_33' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_33')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_33\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_33\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_26' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_26' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_26')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_26\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_26\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_27' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_27' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_27')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_27\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_27\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_28' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_28' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_28')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_28\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_28\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_29' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_29' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_29')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_29\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_29\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_15' OR linkid = 'spi_item_15' OR short_name = 'spi_item_15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_15\"\n            END as \"spi_item_15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_47' OR linkid = 'spi_subform_4_47' OR short_name = 'spi_subform_4_47')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_47\"\n            END as \"spi_subform_4_47\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_6_making_the_environment_safe_hangin' OR linkid = 'review_the_safety_planstep_6_making_the_environment_safe_hangin' OR short_name = 'review_the_safety_planstep_6_making_the_environment_safe_hangin')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_6_making_the_environment_safe_hangin\"\n            END as \"review_the_safety_planstep_6_making_the_environment_safe_hangin\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_16' OR linkid = 'spi_item_16' OR short_name = 'spi_item_16')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_16\"\n            END as \"spi_item_16\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_34' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_34' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_34')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_34\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_34\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_m_13' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_m_13' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_m_13')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_m_13\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_m_13\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_item_17' OR linkid = 'spi_item_17' OR short_name = 'spi_item_17')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_item_17\"\n            END as \"spi_item_17\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_48' OR linkid = 'spi_subform_4_48' OR short_name = 'spi_subform_4_48')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_48\"\n            END as \"spi_subform_4_48\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_49' OR linkid = 'spi_subform_4_49' OR short_name = 'spi_subform_4_49')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_49\"\n            END as \"spi_subform_4_49\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_30' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_30' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_30')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_30\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_30\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_31' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_31' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_31')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_31\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_31\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_m_14' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_m_14' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_m_14')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_m_14\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_m_14\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_person_3' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_person_3' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_person_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_person_3\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_person_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_6_making_the_environment_safe_drowni' OR linkid = 'review_the_safety_planstep_6_making_the_environment_safe_drowni' OR short_name = 'review_the_safety_planstep_6_making_the_environment_safe_drowni')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_6_making_the_environment_safe_drowni\"\n            END as \"review_the_safety_planstep_6_making_the_environment_safe_drowni\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_m_15' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_m_15' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_m_15')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_m_15\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_m_15\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_5_professionals_or_professional_s_35' OR linkid = 'review_the_safety_planstep_5_professionals_or_professional_s_35' OR short_name = 'review_the_safety_planstep_5_professionals_or_professional_s_35')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_5_professionals_or_professional_s_35\"\n            END as \"review_the_safety_planstep_5_professionals_or_professional_s_35\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_50' OR linkid = 'spi_subform_4_50' OR short_name = 'spi_subform_4_50')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_50\"\n            END as \"spi_subform_4_50\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_68' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_68' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_68')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_68\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_68\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_6_making_the_environment_safe_other_' OR linkid = 'review_the_safety_planstep_6_making_the_environment_safe_other_' OR short_name = 'review_the_safety_planstep_6_making_the_environment_safe_other_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_6_making_the_environment_safe_other_\"\n            END as \"review_the_safety_planstep_6_making_the_environment_safe_other_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_51' OR linkid = 'spi_subform_4_51' OR short_name = 'spi_subform_4_51')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_51\"\n            END as \"spi_subform_4_51\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_32' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_32' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_32')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_32\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_32\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_m_16' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_m_16' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_m_16')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_m_16\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_m_16\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_person_3_2' OR linkid = 'spi_subform_4_person_3_2' OR short_name = 'spi_subform_4_person_3_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_person_3_2\"\n            END as \"spi_subform_4_person_3_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_33' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_33' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_33')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_33\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_33\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_your_local_hotline_number' OR linkid = 'spi_subform_4_your_local_hotline_number' OR short_name = 'spi_subform_4_your_local_hotline_number')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_your_local_hotline_number\"\n            END as \"spi_subform_4_your_local_hotline_number\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_52' OR linkid = 'spi_subform_4_52' OR short_name = 'spi_subform_4_52')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_52\"\n            END as \"spi_subform_4_52\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_34' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_34' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_34')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_34\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_34\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_5professionals_or_professional_services_that_can_help_d_35' OR linkid = 'step_5professionals_or_professional_services_that_can_help_d_35' OR short_name = 'step_5professionals_or_professional_services_that_can_help_d_35')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_5professionals_or_professional_services_that_can_help_d_35\"\n            END as \"step_5professionals_or_professional_services_that_can_help_d_35\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_53' OR linkid = 'spi_subform_4_53' OR short_name = 'spi_subform_4_53')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_53\"\n            END as \"spi_subform_4_53\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_additional_hotline_numbers_you_can_contact' OR linkid = 'spi_subform_4_additional_hotline_numbers_you_can_contact' OR short_name = 'spi_subform_4_additional_hotline_numbers_you_can_contact')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_additional_hotline_numbers_you_can_contact\"\n            END as \"spi_subform_4_additional_hotline_numbers_you_can_contact\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_54' OR linkid = 'spi_subform_4_54' OR short_name = 'spi_subform_4_54')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_54\"\n            END as \"spi_subform_4_54\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_going_in_front_of_a_moving_vehicle_i_will_protect' OR linkid = 'spi_subform_4_going_in_front_of_a_moving_vehicle_i_will_protect' OR short_name = 'spi_subform_4_going_in_front_of_a_moving_vehicle_i_will_protect')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_going_in_front_of_a_moving_vehicle_i_will_protect\"\n            END as \"spi_subform_4_going_in_front_of_a_moving_vehicle_i_will_protect\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'review_the_safety_planstep_4_family_members_or_friends_who_m_17' OR linkid = 'review_the_safety_planstep_4_family_members_or_friends_who_m_17' OR short_name = 'review_the_safety_planstep_4_family_members_or_friends_who_m_17')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"review_the_safety_planstep_4_family_members_or_friends_who_m_17\"\n            END as \"review_the_safety_planstep_4_family_members_or_friends_who_m_17\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_55' OR linkid = 'spi_subform_4_55' OR short_name = 'spi_subform_4_55')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_55\"\n            END as \"spi_subform_4_55\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_5' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_5' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_5\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'step_4family_members_or_friends_who_may_offer_help_6' OR linkid = 'step_4family_members_or_friends_who_may_offer_help_6' OR short_name = 'step_4family_members_or_friends_who_may_offer_help_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"step_4family_members_or_friends_who_may_offer_help_6\"\n            END as \"step_4family_members_or_friends_who_may_offer_help_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_56' OR linkid = 'spi_subform_4_56' OR short_name = 'spi_subform_4_56')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_56\"\n            END as \"spi_subform_4_56\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'no_response_step_1_review' OR linkid = 'no_response_step_1_review' OR short_name = 'no_response_step_1_review')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"no_response_step_1_review\"\n            END as \"no_response_step_1_review\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_57' OR linkid = 'spi_subform_4_57' OR short_name = 'spi_subform_4_57')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_57\"\n            END as \"spi_subform_4_57\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'no_response_step_2_review' OR linkid = 'no_response_step_2_review' OR short_name = 'no_response_step_2_review')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"no_response_step_2_review\"\n            END as \"no_response_step_2_review\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_58' OR linkid = 'spi_subform_4_58' OR short_name = 'spi_subform_4_58')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_58\"\n            END as \"spi_subform_4_58\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'no_response_step_3_review' OR linkid = 'no_response_step_3_review' OR short_name = 'no_response_step_3_review')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"no_response_step_3_review\"\n            END as \"no_response_step_3_review\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_59' OR linkid = 'spi_subform_4_59' OR short_name = 'spi_subform_4_59')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_59\"\n            END as \"spi_subform_4_59\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'no_response_step_4_review' OR linkid = 'no_response_step_4_review' OR short_name = 'no_response_step_4_review')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"no_response_step_4_review\"\n            END as \"no_response_step_4_review\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_60' OR linkid = 'spi_subform_4_60' OR short_name = 'spi_subform_4_60')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_60\"\n            END as \"spi_subform_4_60\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'no_response_step_6a_review' OR linkid = 'no_response_step_6a_review' OR short_name = 'no_response_step_6a_review')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"no_response_step_6a_review\"\n            END as \"no_response_step_6a_review\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'spi_subform_4_61' OR linkid = 'spi_subform_4_61' OR short_name = 'spi_subform_4_61')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"spi_subform_4_61\"\n            END as \"spi_subform_4_61\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_4_anon\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.engage_analytics.fct_metrics_long", "compiled": false, "compiled_code": null, "relation_name": "\"airbyte\".\"engage_analytics\".\"fct_metrics_long\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-2 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.engage_analytics.fct_metrics_long_incremental", "compiled": false, "compiled_code": null, "relation_name": "\"airbyte\".\"engage_analytics\".\"fct_metrics_long_incremental\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.878927Z", "completed_at": "2025-09-30T20:11:17.927857Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.928504Z", "completed_at": "2025-09-30T20:11:17.969981Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09183192253112793, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s2_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_start_ipc_s2\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_start_ipc_s2'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s2\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'communication_analysis_example_guiding_prompts_not_all_question' OR linkid = 'communication_analysis_example_guiding_prompts_not_all_question' OR short_name = 'communication_analysis_example_guiding_prompts_not_all_question')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"communication_analysis_example_guiding_prompts_not_all_question\"\n            END as \"communication_analysis_example_guiding_prompts_not_all_question\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'role_play_example_guiding_prompts_not_all_questions_need_to_be_' OR linkid = 'role_play_example_guiding_prompts_not_all_questions_need_to_be_' OR short_name = 'role_play_example_guiding_prompts_not_all_questions_need_to_be_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"role_play_example_guiding_prompts_not_all_questions_need_to_be_\"\n            END as \"role_play_example_guiding_prompts_not_all_questions_need_to_be_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_phq_9_total_meaning' OR linkid = 'ipc_session_2_phq_9_total_meaning' OR short_name = 'ipc_session_2_phq_9_total_meaning')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_phq_9_total_meaning\"\n            END as \"ipc_session_2_phq_9_total_meaning\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_example_guiding_prompts_not_all_questions_nee' OR linkid = 'decision_analysis_example_guiding_prompts_not_all_questions_nee' OR short_name = 'decision_analysis_example_guiding_prompts_not_all_questions_nee')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_example_guiding_prompts_not_all_questions_nee\"\n            END as \"decision_analysis_example_guiding_prompts_not_all_questions_nee\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'interpersonal_skills_building_example_skills' OR linkid = 'interpersonal_skills_building_example_skills' OR short_name = 'interpersonal_skills_building_example_skills')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"interpersonal_skills_building_example_skills\"\n            END as \"interpersonal_skills_building_example_skills\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'work_at_home_example_guiding_prompts_not_all_questions_need_to_' OR linkid = 'work_at_home_example_guiding_prompts_not_all_questions_need_to_' OR short_name = 'work_at_home_example_guiding_prompts_not_all_questions_need_to_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"work_at_home_example_guiding_prompts_not_all_questions_need_to_\"\n            END as \"work_at_home_example_guiding_prompts_not_all_questions_need_to_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_gad_7_total_meaning' OR linkid = 'ipc_session_2_gad_7_total_meaning' OR short_name = 'ipc_session_2_gad_7_total_meaning')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_gad_7_total_meaning\"\n            END as \"ipc_session_2_gad_7_total_meaning\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_2' OR linkid = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_2' OR short_name = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"role_play_example_guiding_prompts_not_all_questions_need_to_b_2\"\n            END as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_the_problem_questions_asked_in_session_2' OR linkid = 'explore_the_problem_questions_asked_in_session_2' OR short_name = 'explore_the_problem_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_the_problem_questions_asked_in_session_2\"\n            END as \"explore_the_problem_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2' OR linkid = 'mood_rating_ipc_session_2' OR short_name = 'mood_rating_ipc_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2\"\n            END as \"mood_rating_ipc_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_3' OR linkid = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_3' OR short_name = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"role_play_example_guiding_prompts_not_all_questions_need_to_b_3\"\n            END as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'identified_stage_of_disagreement' OR linkid = 'identified_stage_of_disagreement' OR short_name = 'identified_stage_of_disagreement')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"identified_stage_of_disagreement\"\n            END as \"identified_stage_of_disagreement\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'assess_for_violence_was_this_in_the_context_of_an_argument_or_d' OR linkid = 'assess_for_violence_was_this_in_the_context_of_an_argument_or_d' OR short_name = 'assess_for_violence_was_this_in_the_context_of_an_argument_or_d')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"assess_for_violence_was_this_in_the_context_of_an_argument_or_d\"\n            END as \"assess_for_violence_was_this_in_the_context_of_an_argument_or_d\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_2' OR linkid = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_2' OR short_name = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"work_at_home_example_guiding_prompts_not_all_questions_need_t_2\"\n            END as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_have_you_proposed_the_interpersonal_formulation_i' OR linkid = 'ipc_session_2_have_you_proposed_the_interpersonal_formulation_i' OR short_name = 'ipc_session_2_have_you_proposed_the_interpersonal_formulation_i')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_have_you_proposed_the_interpersonal_formulation_i\"\n            END as \"ipc_session_2_have_you_proposed_the_interpersonal_formulation_i\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_92' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_92' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_92')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_92\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_92\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'impasse_questions_asked_in_session_2' OR linkid = 'impasse_questions_asked_in_session_2' OR short_name = 'impasse_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"impasse_questions_asked_in_session_2\"\n            END as \"impasse_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'feelings_about_change_questions_asked_in_session_2' OR linkid = 'feelings_about_change_questions_asked_in_session_2' OR short_name = 'feelings_about_change_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"feelings_about_change_questions_asked_in_session_2\"\n            END as \"feelings_about_change_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_new_relationships_and_re_establish_old_relationships_an' OR linkid = 'explore_new_relationships_and_re_establish_old_relationships_an' OR short_name = 'explore_new_relationships_and_re_establish_old_relationships_an')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_new_relationships_and_re_establish_old_relationships_an\"\n            END as \"explore_new_relationships_and_re_establish_old_relationships_an\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis' OR linkid = 'decision_analysis' OR short_name = 'decision_analysis')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis\"\n            END as \"decision_analysis\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2' OR linkid = 'ipc_session_2' OR short_name = 'ipc_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2\"\n            END as \"ipc_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_2' OR linkid = 'decision_analysis_2' OR short_name = 'decision_analysis_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_2\"\n            END as \"decision_analysis_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'communication_analysis_example_guiding_prompts_not_all_questi_2' OR linkid = 'communication_analysis_example_guiding_prompts_not_all_questi_2' OR short_name = 'communication_analysis_example_guiding_prompts_not_all_questi_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"communication_analysis_example_guiding_prompts_not_all_questi_2\"\n            END as \"communication_analysis_example_guiding_prompts_not_all_questi_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_2' OR linkid = 'ipc_session_2_2' OR short_name = 'ipc_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_2\"\n            END as \"ipc_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_3' OR linkid = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_3' OR short_name = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"work_at_home_example_guiding_prompts_not_all_questions_need_t_3\"\n            END as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_in_what_format_did_you_deliver_this_session_with_' OR linkid = 'ipc_session_2_in_what_format_did_you_deliver_this_session_with_' OR short_name = 'ipc_session_2_in_what_format_did_you_deliver_this_session_with_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_in_what_format_did_you_deliver_this_session_with_\"\n            END as \"ipc_session_2_in_what_format_did_you_deliver_this_session_with_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_93' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_93' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_93')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_93\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_93\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'assess_for_violence_was_this_in_the_context_of_an_argument_or_2' OR linkid = 'assess_for_violence_was_this_in_the_context_of_an_argument_or_2' OR short_name = 'assess_for_violence_was_this_in_the_context_of_an_argument_or_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"assess_for_violence_was_this_in_the_context_of_an_argument_or_2\"\n            END as \"assess_for_violence_was_this_in_the_context_of_an_argument_or_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_do_you_agree_with_this' OR linkid = 'ipc_session_2_do_you_agree_with_this' OR short_name = 'ipc_session_2_do_you_agree_with_this')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_do_you_agree_with_this\"\n            END as \"ipc_session_2_do_you_agree_with_this\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_4' OR linkid = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_4' OR short_name = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"role_play_example_guiding_prompts_not_all_questions_need_to_b_4\"\n            END as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'the_old_role_questions_asked_in_session_2' OR linkid = 'the_old_role_questions_asked_in_session_2' OR short_name = 'the_old_role_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"the_old_role_questions_asked_in_session_2\"\n            END as \"the_old_role_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_are' OR linkid = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_are' OR short_name = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_are')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_are\"\n            END as \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_are\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_94' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_94' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_94')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_94\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_94\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'the_new_role_questions_asked_in_session_2' OR linkid = 'the_new_role_questions_asked_in_session_2' OR short_name = 'the_new_role_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"the_new_role_questions_asked_in_session_2\"\n            END as \"the_new_role_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_the_relationship_questions_asked_in_session_2' OR linkid = 'discuss_the_relationship_questions_asked_in_session_2' OR short_name = 'discuss_the_relationship_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_the_relationship_questions_asked_in_session_2\"\n            END as \"discuss_the_relationship_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'assess_for_violence_is_any_of_the_2_question_above_is_true' OR linkid = 'assess_for_violence_is_any_of_the_2_question_above_is_true' OR short_name = 'assess_for_violence_is_any_of_the_2_question_above_is_true')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"assess_for_violence_is_any_of_the_2_question_above_is_true\"\n            END as \"assess_for_violence_is_any_of_the_2_question_above_is_true\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'renegotiation_questions_asked_in_session_2' OR linkid = 'renegotiation_questions_asked_in_session_2' OR short_name = 'renegotiation_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"renegotiation_questions_asked_in_session_2\"\n            END as \"renegotiation_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_3' OR linkid = 'ipc_session_2_3' OR short_name = 'ipc_session_2_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_3\"\n            END as \"ipc_session_2_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pers' OR linkid = 'assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pers' OR short_name = 'assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pers')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pers\"\n            END as \"assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pers\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_total_score_2' OR linkid = 'mood_rating_ipc_session_2_total_score_2' OR short_name = 'mood_rating_ipc_session_2_total_score_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_total_score_2\"\n            END as \"mood_rating_ipc_session_2_total_score_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_10' OR linkid = 'survey_response_10' OR short_name = 'survey_response_10')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_10\"\n            END as \"survey_response_10\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_phq_9_total' OR linkid = 'ipc_session_2_phq_9_total' OR short_name = 'ipc_session_2_phq_9_total')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_phq_9_total\"\n            END as \"ipc_session_2_phq_9_total\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_summary_when_1' OR linkid = 'ipc_session_2_summary_when_1' OR short_name = 'ipc_session_2_summary_when_1')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_summary_when_1\"\n            END as \"ipc_session_2_summary_when_1\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_most_distressing_symptoms' OR linkid = 'ipc_session_2_most_distressing_symptoms' OR short_name = 'ipc_session_2_most_distressing_symptoms')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_most_distressing_symptoms\"\n            END as \"ipc_session_2_most_distressing_symptoms\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_selected_problem_area' OR linkid = 'ipc_session_2_selected_problem_area' OR short_name = 'ipc_session_2_selected_problem_area')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_selected_problem_area\"\n            END as \"ipc_session_2_selected_problem_area\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_ptsd_total_meaning' OR linkid = 'ipc_session_2_ptsd_total_meaning' OR short_name = 'ipc_session_2_ptsd_total_meaning')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_ptsd_total_meaning\"\n            END as \"ipc_session_2_ptsd_total_meaning\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_gad_7_total' OR linkid = 'ipc_session_2_gad_7_total' OR short_name = 'ipc_session_2_gad_7_total')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_gad_7_total\"\n            END as \"ipc_session_2_gad_7_total\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_work_at_home_work_at_home_you_assigned_to_the_client_in' OR linkid = 'discuss_work_at_home_work_at_home_you_assigned_to_the_client_in' OR short_name = 'discuss_work_at_home_work_at_home_you_assigned_to_the_client_in')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_work_at_home_work_at_home_you_assigned_to_the_client_in\"\n            END as \"discuss_work_at_home_work_at_home_you_assigned_to_the_client_in\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'go_to_the_interventions_tab_and_select_the_suicide_prevention_m' OR linkid = 'go_to_the_interventions_tab_and_select_the_suicide_prevention_m' OR short_name = 'go_to_the_interventions_tab_and_select_the_suicide_prevention_m')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"go_to_the_interventions_tab_and_select_the_suicide_prevention_m\"\n            END as \"go_to_the_interventions_tab_and_select_the_suicide_prevention_m\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_difficulties_in_relationships_questions_asked_in_sessio' OR linkid = 'explore_difficulties_in_relationships_questions_asked_in_sessio' OR short_name = 'explore_difficulties_in_relationships_questions_asked_in_sessio')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_difficulties_in_relationships_questions_asked_in_sessio\"\n            END as \"explore_difficulties_in_relationships_questions_asked_in_sessio\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_example_guiding_prompts_not_all_questions_n_2' OR linkid = 'decision_analysis_example_guiding_prompts_not_all_questions_n_2' OR short_name = 'decision_analysis_example_guiding_prompts_not_all_questions_n_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_example_guiding_prompts_not_all_questions_n_2\"\n            END as \"decision_analysis_example_guiding_prompts_not_all_questions_n_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'disagreements_questions_asked_in_session_2' OR linkid = 'disagreements_questions_asked_in_session_2' OR short_name = 'disagreements_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"disagreements_questions_asked_in_session_2\"\n            END as \"disagreements_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_95' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_95' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_95')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_95\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_95\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_96' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_96' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_96')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_96\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_96\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_4' OR linkid = 'ipc_session_2_4' OR short_name = 'ipc_session_2_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_4\"\n            END as \"ipc_session_2_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'guiding_prompts_for_stages_of_disagreements' OR linkid = 'guiding_prompts_for_stages_of_disagreements' OR short_name = 'guiding_prompts_for_stages_of_disagreements')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"guiding_prompts_for_stages_of_disagreements\"\n            END as \"guiding_prompts_for_stages_of_disagreements\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'dissolution_questions_asked_in_session_2' OR linkid = 'dissolution_questions_asked_in_session_2' OR short_name = 'dissolution_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"dissolution_questions_asked_in_session_2\"\n            END as \"dissolution_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_do_you_still_think_that' OR linkid = 'ipc_session_2_do_you_still_think_that' OR short_name = 'ipc_session_2_do_you_still_think_that')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_do_you_still_think_that\"\n            END as \"ipc_session_2_do_you_still_think_that\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_2' OR linkid = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_2' OR short_name = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_2\"\n            END as \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'interpersonal_skills_building_example_skills_2' OR linkid = 'interpersonal_skills_building_example_skills_2' OR short_name = 'interpersonal_skills_building_example_skills_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"interpersonal_skills_building_example_skills_2\"\n            END as \"interpersonal_skills_building_example_skills_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__2' OR linkid = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__2' OR short_name = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_did_you_complete_the_required_assessment_s_and__2\"\n            END as \"ipc_session_2_did_you_complete_the_required_assessment_s_and__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_11' OR linkid = 'add_family_member_registration_calculated_age_11' OR short_name = 'add_family_member_registration_calculated_age_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_11\"\n            END as \"add_family_member_registration_calculated_age_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'communication_analysis_example_guiding_prompts_not_all_questi_3' OR linkid = 'communication_analysis_example_guiding_prompts_not_all_questi_3' OR short_name = 'communication_analysis_example_guiding_prompts_not_all_questi_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"communication_analysis_example_guiding_prompts_not_all_questi_3\"\n            END as \"communication_analysis_example_guiding_prompts_not_all_questi_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_the_death_questions_asked_in_session_2' OR linkid = 'discuss_the_death_questions_asked_in_session_2' OR short_name = 'discuss_the_death_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_the_death_questions_asked_in_session_2\"\n            END as \"discuss_the_death_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_3' OR linkid = 'decision_analysis_3' OR short_name = 'decision_analysis_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_3\"\n            END as \"decision_analysis_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'increase_activities_with_others_questions_asked_in_session_2' OR linkid = 'increase_activities_with_others_questions_asked_in_session_2' OR short_name = 'increase_activities_with_others_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"increase_activities_with_others_questions_asked_in_session_2\"\n            END as \"increase_activities_with_others_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_5' OR linkid = 'ipc_session_2_5' OR short_name = 'ipc_session_2_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_5\"\n            END as \"ipc_session_2_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_11' OR linkid = 'add_family_member_registration_calculated_month_11' OR short_name = 'add_family_member_registration_calculated_month_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_11\"\n            END as \"add_family_member_registration_calculated_month_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_11' OR linkid = 'add_family_member_registration_calculated_year_11' OR short_name = 'add_family_member_registration_calculated_year_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_11\"\n            END as \"add_family_member_registration_calculated_year_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_11' OR linkid = 'add_family_member_registration_date_of_birth_11' OR short_name = 'add_family_member_registration_date_of_birth_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_11\"\n            END as \"add_family_member_registration_date_of_birth_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'assess_for_violence_did_the_person_ever_hit_kick_push_or_slap_y' OR linkid = 'assess_for_violence_did_the_person_ever_hit_kick_push_or_slap_y' OR short_name = 'assess_for_violence_did_the_person_ever_hit_kick_push_or_slap_y')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"assess_for_violence_did_the_person_ever_hit_kick_push_or_slap_y\"\n            END as \"assess_for_violence_did_the_person_ever_hit_kick_push_or_slap_y\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'identified_stage_of_disagreement_has_there_been_a_change_in_the' OR linkid = 'identified_stage_of_disagreement_has_there_been_a_change_in_the' OR short_name = 'identified_stage_of_disagreement_has_there_been_a_change_in_the')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"identified_stage_of_disagreement_has_there_been_a_change_in_the\"\n            END as \"identified_stage_of_disagreement_has_there_been_a_change_in_the\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_close_relationships_in_the_past_questions_asked_in_sess' OR linkid = 'discuss_close_relationships_in_the_past_questions_asked_in_sess' OR short_name = 'discuss_close_relationships_in_the_past_questions_asked_in_sess')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_close_relationships_in_the_past_questions_asked_in_sess\"\n            END as \"discuss_close_relationships_in_the_past_questions_asked_in_sess\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'interpersonal_skills_building_example_skills_3' OR linkid = 'interpersonal_skills_building_example_skills_3' OR short_name = 'interpersonal_skills_building_example_skills_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"interpersonal_skills_building_example_skills_3\"\n            END as \"interpersonal_skills_building_example_skills_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_97' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_97' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_97')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_97\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_97\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_4' OR linkid = 'decision_analysis_4' OR short_name = 'decision_analysis_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_4\"\n            END as \"decision_analysis_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'communication_analysis_example_guiding_prompts_not_all_questi_4' OR linkid = 'communication_analysis_example_guiding_prompts_not_all_questi_4' OR short_name = 'communication_analysis_example_guiding_prompts_not_all_questi_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"communication_analysis_example_guiding_prompts_not_all_questi_4\"\n            END as \"communication_analysis_example_guiding_prompts_not_all_questi_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'identify_social_settings_questions_asked_in_session_2' OR linkid = 'identify_social_settings_questions_asked_in_session_2' OR short_name = 'identify_social_settings_questions_asked_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"identify_social_settings_questions_asked_in_session_2\"\n            END as \"identify_social_settings_questions_asked_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_example_guiding_prompts_not_all_questions_n_3' OR linkid = 'decision_analysis_example_guiding_prompts_not_all_questions_n_3' OR short_name = 'decision_analysis_example_guiding_prompts_not_all_questions_n_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_example_guiding_prompts_not_all_questions_n_3\"\n            END as \"decision_analysis_example_guiding_prompts_not_all_questions_n_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'interpersonal_skills_building_example_skills_4' OR linkid = 'interpersonal_skills_building_example_skills_4' OR short_name = 'interpersonal_skills_building_example_skills_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"interpersonal_skills_building_example_skills_4\"\n            END as \"interpersonal_skills_building_example_skills_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_98' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_98' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_98')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_98\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_98\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__6' OR linkid = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__6' OR short_name = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__6\"\n            END as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_4' OR linkid = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_4' OR short_name = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"work_at_home_example_guiding_prompts_not_all_questions_need_t_4\"\n            END as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_example_guiding_prompts_not_all_questions_n_4' OR linkid = 'decision_analysis_example_guiding_prompts_not_all_questions_n_4' OR short_name = 'decision_analysis_example_guiding_prompts_not_all_questions_n_4')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_example_guiding_prompts_not_all_questions_n_4\"\n            END as \"decision_analysis_example_guiding_prompts_not_all_questions_n_4\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'guiding_prompts_for_disagreements' OR linkid = 'guiding_prompts_for_disagreements' OR short_name = 'guiding_prompts_for_disagreements')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"guiding_prompts_for_disagreements\"\n            END as \"guiding_prompts_for_disagreements\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_99' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_99' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhirp_99')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_99\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhirp_99\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_100' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_100' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_100')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_100\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_100\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_101' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_101' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_101')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_101\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_101\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_102' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_102' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_102')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_102\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_102\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_103' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_103' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_103')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_103\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_103\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_104' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_104' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_104')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_104\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_104\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s2_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T20:11:17.905272Z", "completed_at": "2025-09-30T20:11:17.950731Z"}, {"name": "execute", "started_at": "2025-09-30T20:11:17.951037Z", "completed_at": "2025-09-30T20:11:17.989190Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08455204963684082, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s3_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized view for qr_start_ipc_s3\n-- Uses questionnaire_metadata.anon column to mask PII fields\n\n\n\nwith metadata_pii as (\n    select distinct\n        \"column\",\n        linkid,\n        short_name,\n        anon\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n    where \"table\" = 'qr_start_ipc_s3'\n),\n\nsource_data as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s3\"\n)\n\nselect\n    \n\n    -- Hash patient and QR IDs for privacy\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(COALESCE(subject_patient_id, '')::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    application_version,\n\n    -- Process all other columns dynamically\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_example_guiding_prompts_not_all_questions_n_5' OR linkid = 'decision_analysis_example_guiding_prompts_not_all_questions_n_5' OR short_name = 'decision_analysis_example_guiding_prompts_not_all_questions_n_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_example_guiding_prompts_not_all_questions_n_5\"\n            END as \"decision_analysis_example_guiding_prompts_not_all_questions_n_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_phq_9_total_meaning_2' OR linkid = 'ipc_session_2_phq_9_total_meaning_2' OR short_name = 'ipc_session_2_phq_9_total_meaning_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_phq_9_total_meaning_2\"\n            END as \"ipc_session_2_phq_9_total_meaning_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'interpersonal_skills_building_example_skills_5' OR linkid = 'interpersonal_skills_building_example_skills_5' OR short_name = 'interpersonal_skills_building_example_skills_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"interpersonal_skills_building_example_skills_5\"\n            END as \"interpersonal_skills_building_example_skills_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_gad_7_total_meaning_2' OR linkid = 'ipc_session_2_gad_7_total_meaning_2' OR short_name = 'ipc_session_2_gad_7_total_meaning_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_gad_7_total_meaning_2\"\n            END as \"ipc_session_2_gad_7_total_meaning_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_5' OR linkid = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_5' OR short_name = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"role_play_example_guiding_prompts_not_all_questions_need_to_b_5\"\n            END as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'renegotiation' OR linkid = 'renegotiation' OR short_name = 'renegotiation')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"renegotiation\"\n            END as \"renegotiation\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'communication_analysis_example_guiding_prompts_not_all_questi_5' OR linkid = 'communication_analysis_example_guiding_prompts_not_all_questi_5' OR short_name = 'communication_analysis_example_guiding_prompts_not_all_questi_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"communication_analysis_example_guiding_prompts_not_all_questi_5\"\n            END as \"communication_analysis_example_guiding_prompts_not_all_questi_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_the_problem_questions_asked_in_session_2_2' OR linkid = 'explore_the_problem_questions_asked_in_session_2_2' OR short_name = 'explore_the_problem_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_the_problem_questions_asked_in_session_2_2\"\n            END as \"explore_the_problem_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'identified_stage_of_disagreement_stage_identified_in_session_2' OR linkid = 'identified_stage_of_disagreement_stage_identified_in_session_2' OR short_name = 'identified_stage_of_disagreement_stage_identified_in_session_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"identified_stage_of_disagreement_stage_identified_in_session_2\"\n            END as \"identified_stage_of_disagreement_stage_identified_in_session_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_6' OR linkid = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_6' OR short_name = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"role_play_example_guiding_prompts_not_all_questions_need_to_b_6\"\n            END as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_3_total_score_2' OR linkid = 'mood_rating_ipc_session_3_total_score_2' OR short_name = 'mood_rating_ipc_session_3_total_score_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_3_total_score_2\"\n            END as \"mood_rating_ipc_session_3_total_score_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'impasse_questions_asked_in_session_2_2' OR linkid = 'impasse_questions_asked_in_session_2_2' OR short_name = 'impasse_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"impasse_questions_asked_in_session_2_2\"\n            END as \"impasse_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'feelings_about_change_questions_asked_in_session_2_2' OR linkid = 'feelings_about_change_questions_asked_in_session_2_2' OR short_name = 'feelings_about_change_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"feelings_about_change_questions_asked_in_session_2_2\"\n            END as \"feelings_about_change_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_new_relationships_and_re_establish_old_relationships__2' OR linkid = 'explore_new_relationships_and_re_establish_old_relationships__2' OR short_name = 'explore_new_relationships_and_re_establish_old_relationships__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_new_relationships_and_re_establish_old_relationships__2\"\n            END as \"explore_new_relationships_and_re_establish_old_relationships__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_5' OR linkid = 'decision_analysis_5' OR short_name = 'decision_analysis_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_5\"\n            END as \"decision_analysis_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_7' OR linkid = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_7' OR short_name = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"role_play_example_guiding_prompts_not_all_questions_need_to_b_7\"\n            END as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_105' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_105' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_105')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_105\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_105\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_5' OR linkid = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_5' OR short_name = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_5')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"work_at_home_example_guiding_prompts_not_all_questions_need_t_5\"\n            END as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_5\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_the_relationship' OR linkid = 'discuss_the_relationship' OR short_name = 'discuss_the_relationship')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_the_relationship\"\n            END as \"discuss_the_relationship\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'assess_for_violence' OR linkid = 'assess_for_violence' OR short_name = 'assess_for_violence')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"assess_for_violence\"\n            END as \"assess_for_violence\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_6' OR linkid = 'ipc_session_2_6' OR short_name = 'ipc_session_2_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_6\"\n            END as \"ipc_session_2_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_11' OR linkid = 'survey_response_11' OR short_name = 'survey_response_11')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_11\"\n            END as \"survey_response_11\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_6' OR linkid = 'decision_analysis_6' OR short_name = 'decision_analysis_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_6\"\n            END as \"decision_analysis_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_7' OR linkid = 'ipc_session_2_7' OR short_name = 'ipc_session_2_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_7\"\n            END as \"ipc_session_2_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'communication_analysis_example_guiding_prompts_not_all_questi_6' OR linkid = 'communication_analysis_example_guiding_prompts_not_all_questi_6' OR short_name = 'communication_analysis_example_guiding_prompts_not_all_questi_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"communication_analysis_example_guiding_prompts_not_all_questi_6\"\n            END as \"communication_analysis_example_guiding_prompts_not_all_questi_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_8' OR linkid = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_8' OR short_name = 'role_play_example_guiding_prompts_not_all_questions_need_to_b_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"role_play_example_guiding_prompts_not_all_questions_need_to_b_8\"\n            END as \"role_play_example_guiding_prompts_not_all_questions_need_to_b_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_3' OR linkid = 'mood_rating_ipc_session_3' OR short_name = 'mood_rating_ipc_session_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_3\"\n            END as \"mood_rating_ipc_session_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'communication_analysis_example_guiding_prompts_not_all_questi_7' OR linkid = 'communication_analysis_example_guiding_prompts_not_all_questi_7' OR short_name = 'communication_analysis_example_guiding_prompts_not_all_questi_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"communication_analysis_example_guiding_prompts_not_all_questi_7\"\n            END as \"communication_analysis_example_guiding_prompts_not_all_questi_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_6' OR linkid = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_6' OR short_name = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"work_at_home_example_guiding_prompts_not_all_questions_need_t_6\"\n            END as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'the_old_role_questions_asked_in_session_2_2' OR linkid = 'the_old_role_questions_asked_in_session_2_2' OR short_name = 'the_old_role_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"the_old_role_questions_asked_in_session_2_2\"\n            END as \"the_old_role_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_close_relationships_in_the_past' OR linkid = 'discuss_close_relationships_in_the_past' OR short_name = 'discuss_close_relationships_in_the_past')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_close_relationships_in_the_past\"\n            END as \"discuss_close_relationships_in_the_past\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_3' OR linkid = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_3' OR short_name = 'ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_3\"\n            END as \"ipc_session_2_would_you_prefer_to_focus_on_this_new_problem_a_3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'disagreements' OR linkid = 'disagreements' OR short_name = 'disagreements')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"disagreements\"\n            END as \"disagreements\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'the_new_role_questions_asked_in_session_2_2' OR linkid = 'the_new_role_questions_asked_in_session_2_2' OR short_name = 'the_new_role_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"the_new_role_questions_asked_in_session_2_2\"\n            END as \"the_new_role_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_the_relationship_questions_asked_in_session_2_2' OR linkid = 'discuss_the_relationship_questions_asked_in_session_2_2' OR short_name = 'discuss_the_relationship_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_the_relationship_questions_asked_in_session_2_2\"\n            END as \"discuss_the_relationship_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'communication_analysis_example_guiding_prompts_not_all_questi_8' OR linkid = 'communication_analysis_example_guiding_prompts_not_all_questi_8' OR short_name = 'communication_analysis_example_guiding_prompts_not_all_questi_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"communication_analysis_example_guiding_prompts_not_all_questi_8\"\n            END as \"communication_analysis_example_guiding_prompts_not_all_questi_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'renegotiation_questions_asked_in_session_2_2' OR linkid = 'renegotiation_questions_asked_in_session_2_2' OR short_name = 'renegotiation_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"renegotiation_questions_asked_in_session_2_2\"\n            END as \"renegotiation_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_the_problem' OR linkid = 'explore_the_problem' OR short_name = 'explore_the_problem')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_the_problem\"\n            END as \"explore_the_problem\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_8' OR linkid = 'ipc_session_2_8' OR short_name = 'ipc_session_2_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_8\"\n            END as \"ipc_session_2_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pe_2' OR linkid = 'assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pe_2' OR short_name = 'assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pe_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pe_2\"\n            END as \"assess_for_violence_did_you_ever_hit_kick_push_or_slap_the_pe_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'survey_response_12' OR linkid = 'survey_response_12' OR short_name = 'survey_response_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"survey_response_12\"\n            END as \"survey_response_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_example_guiding_prompts_not_all_questions_n_6' OR linkid = 'decision_analysis_example_guiding_prompts_not_all_questions_n_6' OR short_name = 'decision_analysis_example_guiding_prompts_not_all_questions_n_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_example_guiding_prompts_not_all_questions_n_6\"\n            END as \"decision_analysis_example_guiding_prompts_not_all_questions_n_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'the_new_role' OR linkid = 'the_new_role' OR short_name = 'the_new_role')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"the_new_role\"\n            END as \"the_new_role\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'increase_activities_with_others' OR linkid = 'increase_activities_with_others' OR short_name = 'increase_activities_with_others')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"increase_activities_with_others\"\n            END as \"increase_activities_with_others\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_7' OR linkid = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_7' OR short_name = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"work_at_home_example_guiding_prompts_not_all_questions_need_t_7\"\n            END as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_new_relationships_and_re_establish_old_relationships__3' OR linkid = 'explore_new_relationships_and_re_establish_old_relationships__3' OR short_name = 'explore_new_relationships_and_re_establish_old_relationships__3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_new_relationships_and_re_establish_old_relationships__3\"\n            END as \"explore_new_relationships_and_re_establish_old_relationships__3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_difficulties_in_relationships' OR linkid = 'explore_difficulties_in_relationships' OR short_name = 'explore_difficulties_in_relationships')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_difficulties_in_relationships\"\n            END as \"explore_difficulties_in_relationships\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_example_guiding_prompts_not_all_questions_n_7' OR linkid = 'decision_analysis_example_guiding_prompts_not_all_questions_n_7' OR short_name = 'decision_analysis_example_guiding_prompts_not_all_questions_n_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_example_guiding_prompts_not_all_questions_n_7\"\n            END as \"decision_analysis_example_guiding_prompts_not_all_questions_n_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_work_at_home_work_at_home_you_assigned_to_the_client__2' OR linkid = 'discuss_work_at_home_work_at_home_you_assigned_to_the_client__2' OR short_name = 'discuss_work_at_home_work_at_home_you_assigned_to_the_client__2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_work_at_home_work_at_home_you_assigned_to_the_client__2\"\n            END as \"discuss_work_at_home_work_at_home_you_assigned_to_the_client__2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'go_to_the_interventions_tab_and_select_the_suicide_prevention_2' OR linkid = 'go_to_the_interventions_tab_and_select_the_suicide_prevention_2' OR short_name = 'go_to_the_interventions_tab_and_select_the_suicide_prevention_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"go_to_the_interventions_tab_and_select_the_suicide_prevention_2\"\n            END as \"go_to_the_interventions_tab_and_select_the_suicide_prevention_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'explore_difficulties_in_relationships_questions_asked_in_sess_2' OR linkid = 'explore_difficulties_in_relationships_questions_asked_in_sess_2' OR short_name = 'explore_difficulties_in_relationships_questions_asked_in_sess_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"explore_difficulties_in_relationships_questions_asked_in_sess_2\"\n            END as \"explore_difficulties_in_relationships_questions_asked_in_sess_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'the_old_role' OR linkid = 'the_old_role' OR short_name = 'the_old_role')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"the_old_role\"\n            END as \"the_old_role\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'disagreements_questions_asked_in_session_2_2' OR linkid = 'disagreements_questions_asked_in_session_2_2' OR short_name = 'disagreements_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"disagreements_questions_asked_in_session_2_2\"\n            END as \"disagreements_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_example_guiding_prompts_not_all_questions_n_8' OR linkid = 'decision_analysis_example_guiding_prompts_not_all_questions_n_8' OR short_name = 'decision_analysis_example_guiding_prompts_not_all_questions_n_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_example_guiding_prompts_not_all_questions_n_8\"\n            END as \"decision_analysis_example_guiding_prompts_not_all_questions_n_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_106' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_106' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_106')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_106\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_106\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_107' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_107' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_107')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_107\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_107\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_108' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_108' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_108')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_108\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_108\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'guiding_prompts_for_stages_of_disagreements_2' OR linkid = 'guiding_prompts_for_stages_of_disagreements_2' OR short_name = 'guiding_prompts_for_stages_of_disagreements_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"guiding_prompts_for_stages_of_disagreements_2\"\n            END as \"guiding_prompts_for_stages_of_disagreements_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'dissolution_questions_asked_in_session_2_2' OR linkid = 'dissolution_questions_asked_in_session_2_2' OR short_name = 'dissolution_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"dissolution_questions_asked_in_session_2_2\"\n            END as \"dissolution_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_3_in_what_format_did_you_deliver_this_session_with_' OR linkid = 'ipc_session_3_in_what_format_did_you_deliver_this_session_with_' OR short_name = 'ipc_session_3_in_what_format_did_you_deliver_this_session_with_')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_3_in_what_format_did_you_deliver_this_session_with_\"\n            END as \"ipc_session_3_in_what_format_did_you_deliver_this_session_with_\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'impasse' OR linkid = 'impasse' OR short_name = 'impasse')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"impasse\"\n            END as \"impasse\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'interpersonal_skills_building_example_skills_6' OR linkid = 'interpersonal_skills_building_example_skills_6' OR short_name = 'interpersonal_skills_building_example_skills_6')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"interpersonal_skills_building_example_skills_6\"\n            END as \"interpersonal_skills_building_example_skills_6\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__3' OR linkid = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__3' OR short_name = 'ipc_session_2_did_you_complete_the_required_assessment_s_and__3')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_did_you_complete_the_required_assessment_s_and__3\"\n            END as \"ipc_session_2_did_you_complete_the_required_assessment_s_and__3\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_age_12' OR linkid = 'add_family_member_registration_calculated_age_12' OR short_name = 'add_family_member_registration_calculated_age_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_age_12\"\n            END as \"add_family_member_registration_calculated_age_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'assess_for_violence_has_anything_changed_since_the_last_time_we' OR linkid = 'assess_for_violence_has_anything_changed_since_the_last_time_we' OR short_name = 'assess_for_violence_has_anything_changed_since_the_last_time_we')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"assess_for_violence_has_anything_changed_since_the_last_time_we\"\n            END as \"assess_for_violence_has_anything_changed_since_the_last_time_we\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_the_death_questions_asked_in_session_2_2' OR linkid = 'discuss_the_death_questions_asked_in_session_2_2' OR short_name = 'discuss_the_death_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_the_death_questions_asked_in_session_2_2\"\n            END as \"discuss_the_death_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_7' OR linkid = 'decision_analysis_7' OR short_name = 'decision_analysis_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_7\"\n            END as \"decision_analysis_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'increase_activities_with_others_questions_asked_in_session_2_2' OR linkid = 'increase_activities_with_others_questions_asked_in_session_2_2' OR short_name = 'increase_activities_with_others_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"increase_activities_with_others_questions_asked_in_session_2_2\"\n            END as \"increase_activities_with_others_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_2_9' OR linkid = 'ipc_session_2_9' OR short_name = 'ipc_session_2_9')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_2_9\"\n            END as \"ipc_session_2_9\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_month_12' OR linkid = 'add_family_member_registration_calculated_month_12' OR short_name = 'add_family_member_registration_calculated_month_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_month_12\"\n            END as \"add_family_member_registration_calculated_month_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_calculated_year_12' OR linkid = 'add_family_member_registration_calculated_year_12' OR short_name = 'add_family_member_registration_calculated_year_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_calculated_year_12\"\n            END as \"add_family_member_registration_calculated_year_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'add_family_member_registration_date_of_birth_12' OR linkid = 'add_family_member_registration_date_of_birth_12' OR short_name = 'add_family_member_registration_date_of_birth_12')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"add_family_member_registration_date_of_birth_12\"\n            END as \"add_family_member_registration_date_of_birth_12\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_3_phq_9_total' OR linkid = 'ipc_session_3_phq_9_total' OR short_name = 'ipc_session_3_phq_9_total')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_3_phq_9_total\"\n            END as \"ipc_session_3_phq_9_total\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_3_gad_7_total' OR linkid = 'ipc_session_3_gad_7_total' OR short_name = 'ipc_session_3_gad_7_total')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_3_gad_7_total\"\n            END as \"ipc_session_3_gad_7_total\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_3_ptsd_total' OR linkid = 'ipc_session_3_ptsd_total' OR short_name = 'ipc_session_3_ptsd_total')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_3_ptsd_total\"\n            END as \"ipc_session_3_ptsd_total\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'ipc_session_3_ptsd_total_meaning' OR linkid = 'ipc_session_3_ptsd_total_meaning' OR short_name = 'ipc_session_3_ptsd_total_meaning')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"ipc_session_3_ptsd_total_meaning\"\n            END as \"ipc_session_3_ptsd_total_meaning\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'identified_stage_of_disagreement_has_there_been_a_change_in_t_2' OR linkid = 'identified_stage_of_disagreement_has_there_been_a_change_in_t_2' OR short_name = 'identified_stage_of_disagreement_has_there_been_a_change_in_t_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"identified_stage_of_disagreement_has_there_been_a_change_in_t_2\"\n            END as \"identified_stage_of_disagreement_has_there_been_a_change_in_t_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_close_relationships_in_the_past_questions_asked_in_se_2' OR linkid = 'discuss_close_relationships_in_the_past_questions_asked_in_se_2' OR short_name = 'discuss_close_relationships_in_the_past_questions_asked_in_se_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_close_relationships_in_the_past_questions_asked_in_se_2\"\n            END as \"discuss_close_relationships_in_the_past_questions_asked_in_se_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'dissolution' OR linkid = 'dissolution' OR short_name = 'dissolution')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"dissolution\"\n            END as \"dissolution\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'interpersonal_skills_building_example_skills_7' OR linkid = 'interpersonal_skills_building_example_skills_7' OR short_name = 'interpersonal_skills_building_example_skills_7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"interpersonal_skills_building_example_skills_7\"\n            END as \"interpersonal_skills_building_example_skills_7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_109' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_109' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_109')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_109\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_109\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'decision_analysis_8' OR linkid = 'decision_analysis_8' OR short_name = 'decision_analysis_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"decision_analysis_8\"\n            END as \"decision_analysis_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'discuss_the_death' OR linkid = 'discuss_the_death' OR short_name = 'discuss_the_death')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"discuss_the_death\"\n            END as \"discuss_the_death\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_8' OR linkid = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_8' OR short_name = 'work_at_home_example_guiding_prompts_not_all_questions_need_t_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"work_at_home_example_guiding_prompts_not_all_questions_need_t_8\"\n            END as \"work_at_home_example_guiding_prompts_not_all_questions_need_t_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'identify_social_settings_questions_asked_in_session_2_2' OR linkid = 'identify_social_settings_questions_asked_in_session_2_2' OR short_name = 'identify_social_settings_questions_asked_in_session_2_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"identify_social_settings_questions_asked_in_session_2_2\"\n            END as \"identify_social_settings_questions_asked_in_session_2_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'interpersonal_skills_building_example_skills_8' OR linkid = 'interpersonal_skills_building_example_skills_8' OR short_name = 'interpersonal_skills_building_example_skills_8')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"interpersonal_skills_building_example_skills_8\"\n            END as \"interpersonal_skills_building_example_skills_8\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_110' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_110' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_110')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_110\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_110\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__7' OR linkid = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__7' OR short_name = 'mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__7')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__7\"\n            END as \"mood_rating_ipc_session_2_on_a_scale_of_1_to_10_with_1_being__7\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'guiding_prompts_for_disagreements_2' OR linkid = 'guiding_prompts_for_disagreements_2' OR short_name = 'guiding_prompts_for_disagreements_2')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"guiding_prompts_for_disagreements_2\"\n            END as \"guiding_prompts_for_disagreements_2\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'feelings_about_change' OR linkid = 'feelings_about_change' OR short_name = 'feelings_about_change')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"feelings_about_change\"\n            END as \"feelings_about_change\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_111' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_111' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_111')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_111\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_111\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_112' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_112' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_112')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_112\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_112\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_113' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_113' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_113')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_113\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_113\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_114' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_114' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_114')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_114\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_114\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_115' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_115' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_115')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_115\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_115\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_116' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_116' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_116')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_116\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_116\",\n        \n    \n        \n            -- Check if this column should be masked based on metadata\n            -- Match using same logic as non-anon views: COALESCE(column, linkid)\n            CASE\n                WHEN EXISTS (\n                    SELECT 1 FROM metadata_pii\n                    WHERE (\"column\" = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_117' OR linkid = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_117' OR short_name = 'a_place_to_declare_values_that_cannot_be_created_using_fhir_117')\n                    AND anon = 'TRUE'\n                )\n                THEN\n                    \n                        'REDACTED'\n                    \n                ELSE \"a_place_to_declare_values_that_cannot_be_created_using_fhir_117\"\n            END as \"a_place_to_declare_values_that_cannot_be_created_using_fhir_117\",\n        \n    \n\n    -- Add metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom source_data\n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s3_anon\"", "batch_results": null}], "elapsed_time": 21.368783712387085, "args": {"log_level_file": "debug", "static_parser": true, "strict_mode": false, "project_dir": "/Users/mberg/github/engage-analytics/dbt", "empty": false, "select": [], "cache_selected_only": false, "log_format_file": "debug", "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "require_all_warnings_handled_by_warn_error": false, "which": "run", "defer": false, "quiet": false, "exclude": [], "printer_width": 80, "profiles_dir": ".", "indirect_selection": "eager", "require_yaml_configuration_for_mf_time_spines": false, "macro_debugging": false, "skip_nodes_if_on_run_start_fails": false, "favor_state": false, "source_freshness_run_project_hooks": true, "require_nested_cumulative_type_params": false, "use_colors_file": true, "partial_parse_file_diff": true, "log_format": "default", "log_path": "/Users/mberg/github/engage-analytics/dbt/logs", "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_generic_test_arguments_property": true, "send_anonymous_usage_stats": true, "log_level": "info", "log_file_max_bytes": 10485760, "use_fast_test_edges": false, "invocation_command": "dbt run --profiles-dir .", "validate_macro_args": false, "version_check": true, "require_resource_names_without_spaces": true, "partial_parse": true, "upload_to_artifacts_ingest_api": false, "use_colors": true, "state_modified_compare_vars": false, "require_batched_execution_for_custom_microbatch_strategy": false, "show_all_deprecations": false, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "introspect": true, "write_json": true, "show_resource_report": false}}
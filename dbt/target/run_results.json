{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-30T21:33:21.931228Z", "invocation_id": "73e4ee09-7781-429f-8ebe-982845d46199", "invocation_started_at": "2025-09-30T21:33:20.959831Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T21:33:21.807651Z", "completed_at": "2025-09-30T21:33:21.809939Z"}, {"name": "execute", "started_at": "2025-09-30T21:33:21.810149Z", "completed_at": "2025-09-30T21:33:21.903634Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10096383094787598, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.clients_accepted_sbirt", "compiled": true, "compiled_code": "-- models/metrics/clients_accepted_sbirt.sql\n\n\n-- View to identify clients who accepted SBIRT (Screening, Brief Intervention, and Referral to Treatment)\n-- Based on Planning Next Steps questionnaire responses\n-- When \"planning_next_steps_did_the_client_accept_sbirt\" is true, it indicates the client accepted SBIRT\n-- Tracks cumulative patients who accepted SBIRT as of each date\n\nwith sbirt_responses as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as acceptance_date,\n    pns.planning_next_steps_did_the_client_accept_sbirt,\n    pns.practitioner_organization_id as organization_id\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_planning_next_steps\" pns\n    on pns.qr_id = qr.id\n  where qr.questionnaire_id = 'Questionnaire/q-planning-next-steps'\n    and qr.subject_patient_id is not null\n    and pns.planning_next_steps_did_the_client_accept_sbirt = 'true'\n),\n\n-- Generate a date spine from the earliest acceptance to today\ndate_spine as (\n  select generate_series(\n    (select min(acceptance_date) from sbirt_responses),\n    current_date,\n    '1 day'::interval\n  )::date as period_date\n),\n\n-- For each date, count cumulative patients who accepted SBIRT up to that date\ndaily_counts as (\n  select\n    d.period_date,\n    p.organization_id,\n    p.subject_patient_id,\n    p.acceptance_date\n  from date_spine d\n  cross join sbirt_responses p\n  where p.acceptance_date <= d.period_date\n)\n\nselect\n  period_date,\n  organization_id,\n  subject_patient_id,\n  acceptance_date,\n  true as has_accepted_sbirt\nfrom daily_counts", "relation_name": "\"airbyte\".\"engage_analytics\".\"clients_accepted_sbirt\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T21:33:21.803574Z", "completed_at": "2025-09-30T21:33:21.827427Z"}, {"name": "execute", "started_at": "2025-09-30T21:33:21.827669Z", "completed_at": "2025-09-30T21:33:21.906598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10409808158874512, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.clients_accepted_ipc", "compiled": true, "compiled_code": "-- models/metrics/clients_accepted_ipc.sql\n\n\n-- View to identify clients who accepted IPC (Interpersonal Counseling)\n-- Based on Planning Next Steps questionnaire responses\n-- When \"planning_next_stepsinterpersonal_counseling_ipc_did_the_client_\" is true, it indicates the client accepted IPC\n-- Tracks cumulative patients who accepted IPC as of each date\n\nwith ipc_responses as (\n  select\n    qr.subject_patient_id,\n    qr.author_practitioner_id,\n    qr.meta_lastupdated::date as acceptance_date,\n    pns.planning_next_stepsinterpersonal_counseling_ipc_did_the_client_,\n    pns.practitioner_organization_id as organization_id\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\" qr\n  join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_planning_next_steps\" pns\n    on pns.qr_id = qr.id\n  where qr.questionnaire_id = 'Questionnaire/q-planning-next-steps'\n    and qr.subject_patient_id is not null\n    and pns.planning_next_stepsinterpersonal_counseling_ipc_did_the_client_ = 'true'\n),\n\n-- Generate a date spine from the earliest acceptance to today\ndate_spine as (\n  select generate_series(\n    (select min(acceptance_date) from ipc_responses),\n    current_date,\n    '1 day'::interval\n  )::date as period_date\n),\n\n-- For each date, count cumulative patients who accepted IPC up to that date\ndaily_counts as (\n  select\n    d.period_date,\n    p.organization_id,\n    p.subject_patient_id,\n    p.acceptance_date\n  from date_spine d\n  cross join ipc_responses p\n  where p.acceptance_date <= d.period_date\n)\n\nselect\n  period_date,\n  organization_id,\n  subject_patient_id,\n  acceptance_date,\n  true as has_accepted_ipc\nfrom daily_counts", "relation_name": "\"airbyte\".\"engage_analytics\".\"clients_accepted_ipc\"", "batch_results": null}], "elapsed_time": 0.383591890335083, "args": {"require_all_warnings_handled_by_warn_error": false, "log_path": "/Users/mberg/github/engage-analytics/dbt/logs", "invocation_command": "dbt run --profiles-dir . --select clients_accepted_ipc clients_accepted_sbirt", "require_generic_test_arguments_property": true, "log_level_file": "debug", "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "require_yaml_configuration_for_mf_time_spines": false, "show_all_deprecations": false, "vars": {}, "write_json": true, "printer_width": 80, "log_level": "info", "defer": false, "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "require_nested_cumulative_type_params": false, "partial_parse_file_diff": true, "introspect": true, "partial_parse": true, "show_resource_report": false, "state_modified_compare_more_unrendered_values": false, "profiles_dir": ".", "populate_cache": true, "log_format": "default", "favor_state": false, "upload_to_artifacts_ingest_api": false, "strict_mode": false, "log_format_file": "debug", "macro_debugging": false, "empty": false, "state_modified_compare_vars": false, "require_resource_names_without_spaces": true, "quiet": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "project_dir": "/Users/mberg/github/engage-analytics/dbt", "indirect_selection": "eager", "skip_nodes_if_on_run_start_fails": false, "use_colors": true, "use_colors_file": true, "select": ["clients_accepted_ipc", "clients_accepted_sbirt"], "source_freshness_run_project_hooks": true, "validate_macro_args": false, "exclude": [], "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_fast_test_edges": false, "print": true, "which": "run", "cache_selected_only": false}}
{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-12T02:33:55.462435Z", "invocation_id": "7658aacf-615a-467e-b855-296d4693b4aa", "invocation_started_at": "2025-09-12T02:33:54.455542Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-12T02:33:55.210279Z", "completed_at": "2025-09-12T02:33:55.227056Z"}, {"name": "execute", "started_at": "2025-09-12T02:33:55.227898Z", "completed_at": "2025-09-12T02:33:55.449074Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23981285095214844, "adapter_response": {"_message": "SELECT 708", "code": "SELECT", "rows_affected": 708}, "message": "SELECT 708", "failures": null, "unique_id": "model.engage_analytics.fct_metrics_long", "compiled": true, "compiled_code": "-- models/metrics/fct_metrics_long.sql\nwith\n\nbase_practitioners as (\n  select\n    current_date as period_date,\n    organization_id,\n    count(distinct id) as provider_count_value\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioners\"\n  \n  where active = 'true'\n  \n  group by organization_id\n),\nbase_patient as (\n  select\n    current_date as period_date,\n    practitioner_organization_id,\n    count(distinct id) as patient_count_value\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\"\n  \n  where active = 'true'\n  \n  group by practitioner_organization_id\n),\nbase_encounters as (\n  select\n    period_start::date as period_date,\n    practitioner_organization_id,\n    count(distinct subject_id) as client_encounters_value\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"encounters\"\n  \n  where period_start is not null\n  \n  group by\n    period_start::date, practitioner_organization_id\n),\nbase_active_providers as (\n  select\n    current_date as period_date,\n    organization_id,\n    count(distinct case when is_active_30d then practitioner_id end) as active_providers_value,\n    count(distinct case when is_active_30d then practitioner_id end) as percent_active_providers_numerator,\n    nullif(count(distinct practitioner_id), 0) as percent_active_providers_denominator\n  from \"airbyte\".\"engage_analytics\".\"active_providers\"\n  \n  group by organization_id\n),\nbase_clients_eligible_for_ipc as (\n  select\n    period_date,\n    organization_id,\n    count(distinct subject_patient_id) as clients_eligible_for_ipc_value\n  from \"airbyte\".\"engage_analytics\".\"clients_eligible_for_ipc\"\n  \n  group by\n    period_date, organization_id\n),\nbase_clients_sbirt_mi_eligible as (\n  select\n    period_date,\n    organization_id,\n    count(distinct subject_patient_id) as clients_sbirt_mi_eligible_value\n  from \"airbyte\".\"engage_analytics\".\"clients_sbirt_mi_eligible\"\n  \n  group by\n    period_date, organization_id\n),\nbase_clients_eligible_spi as (\n  select\n    period_date,\n    organization_id,\n    count(distinct subject_patient_id) as clients_eligible_spi_value\n  from \"airbyte\".\"engage_analytics\".\"clients_eligible_spi\"\n  \n  group by\n    period_date, organization_id\n),\nbase_clients_eligible_referral as (\n  select\n    period_date,\n    organization_id,\n    count(distinct subject_patient_id) as clients_eligible_referral_value\n  from \"airbyte\".\"engage_analytics\".\"clients_eligible_referral\"\n  \n  group by\n    period_date, organization_id\n),\nbase_clients_eligible_fws as (\n  select\n    period_date,\n    organization_id,\n    count(distinct subject_patient_id) as clients_eligible_fws_value\n  from \"airbyte\".\"engage_analytics\".\"clients_eligible_fws\"\n  \n  group by\n    period_date, organization_id\n)\n  select\n    period_date,\n    organization_id,\n    'provider_count' as metric_id,\n    provider_count_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Total number of unique providers' as description,\n    'prod' as status\n  from base_practitioners\n  union all\n  select\n    period_date,\n    practitioner_organization_id,\n    'patient_count' as metric_id,\n    patient_count_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Total number of unique patients' as description,\n    'prod' as status\n  from base_patient\n  union all\n  select\n    period_date,\n    practitioner_organization_id,\n    'client_encounters' as metric_id,\n    client_encounters_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Total unique clients seen (one encounter per patient per day)' as description,\n    'prod' as status\n  from base_encounters\n  union all\n  select\n    period_date,\n    organization_id,\n    'active_providers' as metric_id,\n    active_providers_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Providers who submitted QRs in past 30 days' as description,\n    'prod' as status\n  from base_active_providers\n  union all\n  select\n    period_date,\n    organization_id,\n    'percent_active_providers' as metric_id,\n    (percent_active_providers_numerator::numeric / percent_active_providers_denominator * 100) as value,\n    'percent' as unit,\n    'v1' as method_version,\n    'Percentage of providers active in past 30 days' as description,\n    'prod' as status\n  from base_active_providers\n  union all\n  select\n    period_date,\n    organization_id,\n    'clients_eligible_for_ipc' as metric_id,\n    clients_eligible_for_ipc_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Clients eligible for IPC (Integrated Primary Care)' as description,\n    'prod' as status\n  from base_clients_eligible_for_ipc\n  union all\n  select\n    period_date,\n    organization_id,\n    'clients_sbirt_mi_eligible' as metric_id,\n    clients_sbirt_mi_eligible_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Clients eligible for SBIRT/MI (alcohol or drug problems)' as description,\n    'prod' as status\n  from base_clients_sbirt_mi_eligible\n  union all\n  select\n    period_date,\n    organization_id,\n    'clients_eligible_spi' as metric_id,\n    clients_eligible_spi_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Clients eligible for SPI (Suicide Prevention Intervention)' as description,\n    'prod' as status\n  from base_clients_eligible_spi\n  union all\n  select\n    period_date,\n    organization_id,\n    'clients_eligible_referral' as metric_id,\n    clients_eligible_referral_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Clients eligible for referral (severe mental health)' as description,\n    'prod' as status\n  from base_clients_eligible_referral\n  union all\n  select\n    period_date,\n    organization_id,\n    'clients_eligible_fws' as metric_id,\n    clients_eligible_fws_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Clients eligible for FWS (Financial Wellness Services)' as description,\n    'prod' as status\n  from base_clients_eligible_fws\n  ", "relation_name": "\"airbyte\".\"engage_analytics\".\"fct_metrics_long\"", "batch_results": null}], "elapsed_time": 0.4932069778442383, "args": {"show_all_deprecations": false, "skip_nodes_if_on_run_start_fails": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "cache_selected_only": false, "state_modified_compare_vars": false, "indirect_selection": "eager", "printer_width": 80, "send_anonymous_usage_stats": true, "show_resource_report": false, "state_modified_compare_more_unrendered_values": false, "print": true, "log_level": "info", "log_file_max_bytes": 10485760, "project_dir": "/Users/mberg/github/engage-analytics/dbt", "version_check": true, "invocation_command": "dbt run --profiles-dir . --select fct_metrics_long", "partial_parse": true, "write_json": true, "populate_cache": true, "use_colors": true, "empty": false, "strict_mode": false, "validate_macro_args": false, "upload_to_artifacts_ingest_api": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_fast_test_edges": false, "which": "run", "require_all_warnings_handled_by_warn_error": false, "profiles_dir": ".", "defer": false, "source_freshness_run_project_hooks": true, "quiet": false, "favor_state": false, "require_resource_names_without_spaces": true, "static_parser": true, "log_format": "default", "macro_debugging": false, "introspect": true, "require_nested_cumulative_type_params": false, "select": ["fct_metrics_long"], "log_level_file": "debug", "log_format_file": "debug", "use_colors_file": true, "log_path": "/Users/mberg/github/engage-analytics/dbt/logs", "exclude": [], "require_yaml_configuration_for_mf_time_spines": false, "partial_parse_file_diff": true, "require_generic_test_arguments_property": true, "vars": {}, "require_batched_execution_for_custom_microbatch_strategy": false}}
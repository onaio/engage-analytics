{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-12T01:59:59.210607Z", "invocation_id": "481ba774-2981-4191-afaa-827a2faff7d0", "invocation_started_at": "2025-09-12T01:59:58.492451Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-12T01:59:59.069880Z", "completed_at": "2025-09-12T01:59:59.081655Z"}, {"name": "execute", "started_at": "2025-09-12T01:59:59.081840Z", "completed_at": "2025-09-12T01:59:59.198617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1294558048248291, "adapter_response": {"_message": "SELECT 246", "code": "SELECT", "rows_affected": 246}, "message": "SELECT 246", "failures": null, "unique_id": "model.engage_analytics.fct_metrics_long", "compiled": true, "compiled_code": "-- models/metrics/fct_metrics_long.sql\nwith\n\nbase_practitioners as (\n  select\n    current_date as period_date,\n    organization_id,\n    count(distinct id) as provider_count_value\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioners\"\n  \n  where active = 'true'\n  \n  group by organization_id\n),\nbase_patient as (\n  select\n    current_date as period_date,\n    practitioner_organization_id,\n    count(distinct id) as patient_count_value\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\"\n  \n  where active = 'true'\n  \n  group by practitioner_organization_id\n),\nbase_encounters as (\n  select\n    period_start::date as period_date,\n    practitioner_organization_id,\n    count(distinct subject_id) as client_encounters_value\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"encounters\"\n  \n  where period_start is not null\n  \n  group by\n    period_start::date, practitioner_organization_id\n),\nbase_active_providers as (\n  select\n    current_date as period_date,\n    organization_id,\n    count(distinct case when is_active_30d then practitioner_id end) as active_providers_value,\n    count(distinct case when is_active_30d then practitioner_id end) as percent_active_providers_numerator,\n    nullif(count(distinct practitioner_id), 0) as percent_active_providers_denominator\n  from \"airbyte\".\"engage_analytics\".\"active_providers\"\n  \n  group by organization_id\n),\nbase_clients_eligible_for_ipc as (\n  select\n    period_date,\n    organization_id,\n    count(distinct subject_patient_id) as clients_eligible_for_ipc_value\n  from \"airbyte\".\"engage_analytics\".\"clients_eligible_for_ipc\"\n  \n  group by\n    period_date, organization_id\n)\n  select\n    period_date,\n    organization_id,\n    'provider_count' as metric_id,\n    provider_count_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Total number of unique providers' as description,\n    'prod' as status\n  from base_practitioners\n  union all\n  select\n    period_date,\n    practitioner_organization_id,\n    'patient_count' as metric_id,\n    patient_count_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Total number of unique patients' as description,\n    'prod' as status\n  from base_patient\n  union all\n  select\n    period_date,\n    practitioner_organization_id,\n    'client_encounters' as metric_id,\n    client_encounters_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Total unique clients seen (one encounter per patient per day)' as description,\n    'prod' as status\n  from base_encounters\n  union all\n  select\n    period_date,\n    organization_id,\n    'active_providers' as metric_id,\n    active_providers_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Providers who submitted QRs in past 30 days' as description,\n    'prod' as status\n  from base_active_providers\n  union all\n  select\n    period_date,\n    organization_id,\n    'percent_active_providers' as metric_id,\n    (percent_active_providers_numerator::numeric / percent_active_providers_denominator * 100) as value,\n    'percent' as unit,\n    'v1' as method_version,\n    'Percentage of providers active in past 30 days' as description,\n    'prod' as status\n  from base_active_providers\n  union all\n  select\n    period_date,\n    organization_id,\n    'clients_eligible_for_ipc' as metric_id,\n    clients_eligible_for_ipc_value::numeric as value,\n    'count' as unit,\n    'v1' as method_version,\n    'Clients eligible for IPC (Integrated Primary Care)' as description,\n    'prod' as status\n  from base_clients_eligible_for_ipc\n  ", "relation_name": "\"airbyte\".\"engage_analytics\".\"fct_metrics_long\"", "batch_results": null}], "elapsed_time": 0.3007779121398926, "args": {"require_all_warnings_handled_by_warn_error": false, "log_level_file": "debug", "require_generic_test_arguments_property": true, "show_all_deprecations": false, "skip_nodes_if_on_run_start_fails": false, "use_colors": true, "cache_selected_only": false, "introspect": true, "send_anonymous_usage_stats": true, "which": "run", "log_format_file": "debug", "quiet": false, "favor_state": false, "require_nested_cumulative_type_params": false, "select": ["fct_metrics_long"], "defer": false, "log_format": "default", "write_json": true, "log_level": "info", "profiles_dir": ".", "macro_debugging": false, "invocation_command": "dbt run --profiles-dir . --select fct_metrics_long", "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "populate_cache": true, "source_freshness_run_project_hooks": true, "state_modified_compare_more_unrendered_values": false, "strict_mode": false, "vars": {}, "print": true, "log_path": "/Users/mberg/github/engage-analytics/dbt/logs", "use_fast_test_edges": false, "show_resource_report": false, "indirect_selection": "eager", "project_dir": "/Users/mberg/github/engage-analytics/dbt", "empty": false, "partial_parse_file_diff": true, "upload_to_artifacts_ingest_api": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": true, "log_file_max_bytes": 10485760, "version_check": true, "printer_width": 80, "partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "exclude": [], "static_parser": true, "use_colors_file": true, "state_modified_compare_vars": false, "validate_macro_args": false}}
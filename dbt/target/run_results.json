{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-09T15:10:02.918279Z", "invocation_id": "d23fd562-aada-44ea-b0fa-4b92716bdc61", "invocation_started_at": "2025-09-09T15:10:02.128229Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T15:10:02.762308Z", "completed_at": "2025-09-09T15:10:02.768447Z"}, {"name": "execute", "started_at": "2025-09-09T15:10:02.768753Z", "completed_at": "2025-09-09T15:10:02.892895Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1313631534576416, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.patient_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized patient view with masked PII fields for data sharing\n-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number\n-- Pulls phone numbers from registration data when available\n\nwith patient_with_registration as (\n    select \n        p.*,\n        r.\"phone-number\" as registration_phone\n    from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\" p\n    left join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_registration_info\" r on p.id = r.subject_patient_id\n)\n\nselect \n    -- Use hashed ID for referential integrity while maintaining privacy\n    MD5(p.id::text) as patient_id_hash,\n    \n    -- Demographic information (non-PII)\n    p.gender,\n    p.age_years,  -- Age instead of birth_date for privacy\n    p.deceased,\n    p.active,\n    p.registration_date,\n    \n    -- Masked name fields\n    'REDACTED' as name_family_masked,\n    'REDACTED' as name_given_masked,\n    \n    -- Masked contact information (use registration phone if patient phone is null)\n    CASE \n        WHEN COALESCE(p.phone_number, p.registration_phone) IS NOT NULL \n            AND LENGTH(COALESCE(p.phone_number, p.registration_phone)) >= 4\n        THEN 'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, p.registration_phone), 4)\n        ELSE 'NO PHONE'\n    END as phone_number_masked,\n    \n    -- Location and organization (reference IDs only, no PII)\n    p.location_id,\n    p.practitioner_id,\n    p.practitioner_organization_id,\n    p.practitioner_careteam_id,\n    \n    -- Metadata\n    p._airbyte_emitted_at,\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom patient_with_registration p", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient_anon\"", "batch_results": null}], "elapsed_time": 0.3375821113586426, "args": {"log_level": "info", "show_all_deprecations": false, "use_colors_file": true, "version_check": true, "partial_parse_file_diff": true, "log_path": "/Users/mberg/github/engage-analytics/dbt/logs", "write_json": true, "printer_width": 80, "select": ["patient_anon"], "populate_cache": true, "validate_macro_args": false, "require_resource_names_without_spaces": true, "log_level_file": "debug", "cache_selected_only": false, "upload_to_artifacts_ingest_api": false, "introspect": true, "macro_debugging": false, "project_dir": "/Users/mberg/github/engage-analytics/dbt", "require_all_warnings_handled_by_warn_error": false, "require_nested_cumulative_type_params": false, "use_colors": true, "exclude": [], "empty": false, "vars": {}, "log_format": "default", "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "send_anonymous_usage_stats": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_batched_execution_for_custom_microbatch_strategy": false, "defer": false, "log_format_file": "debug", "quiet": false, "source_freshness_run_project_hooks": true, "profiles_dir": ".", "static_parser": true, "use_fast_test_edges": false, "require_generic_test_arguments_property": true, "print": true, "require_yaml_configuration_for_mf_time_spines": false, "strict_mode": false, "which": "run", "log_file_max_bytes": 10485760, "favor_state": false, "invocation_command": "dbt run --profiles-dir . --select patient_anon", "state_modified_compare_more_unrendered_values": false, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "state_modified_compare_vars": false, "indirect_selection": "eager"}}
{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-07T04:07:49.853438Z", "invocation_id": "4db2d5f2-d091-4786-8214-78a020f8f721", "invocation_started_at": "2025-09-07T04:07:48.502882Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T04:07:49.070965Z", "completed_at": "2025-09-07T04:07:49.785301Z"}, {"name": "execute", "started_at": "2025-09-07T04:07:49.785512Z", "completed_at": "2025-09-07T04:07:49.839048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7687678337097168, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_54_readable", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 1) with readable column names\n-- Original id: ipc-54, url: n/a, version: 0.0.1\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/54') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'f1.3.1' then answer_value_text end) as \"phq9_q1_interest\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"phq9_q2_depressed\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"phq9_q3_sleep\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"phq9_q4_tired\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"phq9_q5_appetite\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"phq9_q6_failure\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"phq9_q7_concentration\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"phq9_q8_movement\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"phq9_q9_suicide\",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as \"phq9_total_score\",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as \"phq9_score_meaning\",max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as \"phq9_score_meaning_code\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"phq9_encounter_id\",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as \"phq9_observation_id\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"phq9_calculated_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"phq9_calculated_year\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"phq9_field_cd8e3d6d\",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as \"phq9_task_id\",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as \"phq9_field_9c366bcc\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"phq9_field_b5bc7f80\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"phq9_link_encounter\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_54_readable\"", "batch_results": null}], "elapsed_time": 0.9234859943389893, "args": {"use_colors": true, "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "cache_selected_only": false, "partial_parse_file_diff": true, "partial_parse": true, "state_modified_compare_vars": false, "macro_debugging": false, "printer_width": 80, "profiles_dir": ".", "state_modified_compare_more_unrendered_values": false, "log_level_file": "debug", "use_fast_test_edges": false, "print": true, "empty": false, "require_batched_execution_for_custom_microbatch_strategy": false, "show_resource_report": false, "validate_macro_args": false, "version_check": true, "require_all_warnings_handled_by_warn_error": false, "select": ["qr_54_readable"], "which": "run", "introspect": true, "favor_state": false, "defer": false, "log_path": "/Users/mberg/github/engage-analytics/dbt/logs", "show_all_deprecations": false, "log_level": "info", "upload_to_artifacts_ingest_api": false, "exclude": [], "require_nested_cumulative_type_params": false, "static_parser": true, "log_format": "default", "vars": {}, "quiet": false, "source_freshness_run_project_hooks": true, "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "populate_cache": true, "require_generic_test_arguments_property": true, "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "indirect_selection": "eager", "project_dir": "/Users/mberg/github/engage-analytics/dbt", "strict_mode": false, "log_format_file": "debug", "send_anonymous_usage_stats": true, "invocation_command": "dbt run --profiles-dir . --select qr_54_readable", "require_resource_names_without_spaces": true, "log_file_max_bytes": 10485760}}
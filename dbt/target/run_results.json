{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-09T13:44:55.435484Z", "invocation_id": "cd2c2df7-ac9a-451c-9ebe-0b6e315a28e5", "invocation_started_at": "2025-09-09T13:44:47.666502Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.412249Z", "completed_at": "2025-09-09T13:44:48.423186Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.442760Z", "completed_at": "2025-09-09T13:44:48.603398Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.20662713050842285, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_careteams", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'name' as name,\n    resource::jsonb ->> 'status' as status,\n    resource::jsonb ->> 'identifier' as identifier,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'managingOrganization' as managingOrganization,\n    resource::jsonb ->> 'participant' as participant,\n_airbyte_extracted_at as _airbyte_emitted_at,\nresource\nfrom \"airbyte\".\"airbyte\".\"care_team\"\n\n\nwhere _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careteams\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careteams\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.401041Z", "completed_at": "2025-09-09T13:44:48.422662Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.423627Z", "completed_at": "2025-09-09T13:44:48.606734Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20974993705749512, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_careplans", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'subject' as subject,\n    resource::jsonb ->> 'title' as title,\n    resource::jsonb ->> 'author' as author,\n    resource::jsonb ->> 'description' as description,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'intent' as intent,\n    resource::jsonb ->> 'created' as created,\n    resource::jsonb ->> 'period' as period,\n    resource::jsonb ->> 'identifier' as identifier,\n    resource::jsonb ->> 'status' as status,\n    resource::jsonb ->> 'activity' as activity,\n    resource::jsonb ->> 'instantiatesCanonical' as instantiatesCanonical,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"care_plan\"\n\n\nwhere _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careplans\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careplans\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.419317Z", "completed_at": "2025-09-09T13:44:48.435704Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.460360Z", "completed_at": "2025-09-09T13:44:48.607726Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.20282483100891113, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_locations", "compiled": true, "compiled_code": "\n\n\n\n\nwith previous_extraction as (\n  select\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'description' as description,\n    resource::jsonb ->> 'partOf' as partOf,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'status' as status,\n    resource::jsonb ->> 'physicalType' as physicalType,\n    resource::jsonb ->> 'name' as name,\n    jsonb_array_elements(resource::jsonb -> 'alias')::jsonb as alias,\n    jsonb_array_elements(resource::jsonb -> 'identifier')::jsonb as identifier,\n  _airbyte_extracted_at as _airbyte_emitted_at\n  from \"airbyte\".\"airbyte\".\"location\"\n)\nselect\n  *,\n  partof::jsonb -> 'display'   as parent_name,\n  \n  split_part(partof::jsonb->>'reference', '/', 2)\n as parent_id,\n  partof::jsonb -> 'reference' as parent_reference\nfrom previous_extraction\n\nwhere _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_locations\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_locations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.416158Z", "completed_at": "2025-09-09T13:44:48.460139Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.462988Z", "completed_at": "2025-09-09T13:44:48.608459Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2097630500793457, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_encounter", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'subject' as subject,\n    resource::jsonb ->> 'serviceType' as serviceType,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'priority' as priority,\n    resource::jsonb ->> 'class' as class,\n    resource::jsonb ->> 'serviceProvider' as serviceProvider,\n    resource::jsonb ->> 'reasonCode' as reasonCode,\n    resource::jsonb ->> 'participant' as participant,\n    resource::jsonb ->> 'type' as type,\n    resource::jsonb ->> 'period' as period,\n    resource::jsonb ->> 'status' as status,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"encounter\"\n\n\n  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.624031Z", "completed_at": "2025-09-09T13:44:48.634514Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.635333Z", "completed_at": "2025-09-09T13:44:48.721040Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10192298889160156, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_practitioner", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'identifier' as identifier,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    jsonb_array_elements(resource::jsonb -> 'name')::jsonb as name,\n    jsonb_array_elements(resource::jsonb -> 'telecom')::jsonb as telecom,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"practitioner\"\n\n\n  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.620948Z", "completed_at": "2025-09-09T13:44:48.628622Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.632538Z", "completed_at": "2025-09-09T13:44:48.722232Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10878229141235352, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_patient", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'gender' as gender,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'birthDate' as birthDate,\n    resource::jsonb ->> 'managingOrganization' as managingOrganization,\n    resource::jsonb ->> 'deceasedBoolean' as deceasedBoolean,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'text' as text,\n    resource::jsonb ->> 'identifier' as identifier,\n((resource::jsonb -> 'telecom')::jsonb->>0)::jsonb ->> 'value'  as telecom_value,\n((resource::jsonb -> 'generalPractitioner')::jsonb->>0)::jsonb ->> 'reference' as generalPractitioner_reference,\n((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'given' as name_given,\n((resource::jsonb -> 'name')::jsonb->>0)::jsonb ->> 'family' as name_family,\n((resource::jsonb -> 'identifier')::jsonb->>0)::jsonb -> 'period' ->> 'start' as period_start,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"patient\"\n\n\n  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_patient\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_patient\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.617704Z", "completed_at": "2025-09-09T13:44:48.626623Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.628897Z", "completed_at": "2025-09-09T13:44:48.724640Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11168575286865234, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_organizations", "compiled": true, "compiled_code": "\n\n\n\n \n    \n    select\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'name' as name,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'identifier' as identifier,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    jsonb_array_elements(resource::jsonb -> 'type')::jsonb as type,\n     _airbyte_extracted_at as _airbyte_emitted_at \n\n    from \"airbyte\".\"airbyte\".\"organization\"\n\n\n\n  -- this filter will only be applied on an incremental run\n   WHERE _airbyte_extracted_at > (SELECT max(_airbyte_emitted_at) FROM \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organizations\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organizations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.614826Z", "completed_at": "2025-09-09T13:44:48.623687Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.626823Z", "completed_at": "2025-09-09T13:44:48.726968Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11504101753234863, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_organization_affiliations", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'organization' as organization,\n    resource::jsonb ->> 'identifier' as identifier,\n    jsonb_array_elements(resource::jsonb -> 'location')::jsonb as location,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"organization_affiliation\"\n\n\nwhere _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organization_affiliations\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organization_affiliations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.731232Z", "completed_at": "2025-09-09T13:44:48.736752Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.741427Z", "completed_at": "2025-09-09T13:44:48.812776Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08524084091186523, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_practitioner_roles", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'active' as active,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'organization' as organization,\n    resource::jsonb ->> 'practitioner' as practitioner,\n    resource::jsonb ->> 'code' as code,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"practitioner_role\"\n\n\nwhere _airbyte_extracted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner_roles\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner_roles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.747194Z", "completed_at": "2025-09-09T13:44:48.752311Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.752714Z", "completed_at": "2025-09-09T13:44:48.813576Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07232403755187988, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.unnested_careteams", "compiled": true, "compiled_code": "with unnested_careteams as (\n  select\n    id,\n    status,\n    jsonb_array_elements(participant::jsonb) as participant,\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_careteams\"\n)\nselect\n  id,\n  status,\n  split_part(participant -> 'member' ->> 'reference', '/', 1) as participant_type,\n  split_part(participant -> 'member' ->> 'reference', '/', 2) as participant_id,\n  _airbyte_emitted_at\nfrom unnested_careteams", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"unnested_careteams\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.733980Z", "completed_at": "2025-09-09T13:44:48.741154Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.743825Z", "completed_at": "2025-09-09T13:44:48.844431Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11777210235595703, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_questionnaire_response", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    id,\n    resource,\n    lower(resource::jsonb ->> 'status') as status,\n    resource::jsonb ->> 'questionnaire' as questionnaire_id,\n    split_part((resource::jsonb -> 'subject'    ->> 'reference'), '/', 2) as subject_patient_id,\n    split_part((resource::jsonb -> 'encounter'  ->> 'reference'), '/', 2) as encounter_id,\n    split_part((resource::jsonb -> 'author'     ->> 'reference'), '/', 2) as author_practitioner_id,\n    resource::jsonb -> 'item' as items,\n    resource::jsonb -> 'meta' ->> 'lastUpdated' as meta_lastupdated,\n    resource::jsonb -> 'meta' as meta,\n    _airbyte_extracted_at as _airbyte_emitted_at\n  from \"airbyte\".\"airbyte\".\"questionnaire_response\"\n  where lower(resource::jsonb ->> 'status') = 'completed'\n)\nselect * from src\n\n  where _airbyte_emitted_at > (select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.737148Z", "completed_at": "2025-09-09T13:44:48.746763Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.749033Z", "completed_at": "2025-09-09T13:44:48.861495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1280958652496338, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.stg_task", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    resource::jsonb ->> 'id' as id,\n    resource::jsonb ->> 'meta' as meta,\n    resource::jsonb ->> 'authoredOn' as authoredOn,\n    resource::jsonb ->> 'basedOn' as basedOn,\n    resource::jsonb ->> 'statusReason' as statusReason,\n    resource::jsonb ->> 'reasonReference' as reasonReference,\n    resource::jsonb ->> 'executionPeriod' as executionPeriod,\n    resource::jsonb ->> 'for' as for,\n    resource::jsonb ->> 'code' as code,\n    resource::jsonb ->> 'owner' as owner,\n    resource::jsonb ->> 'description' as description,\n    resource::jsonb ->> 'resourceType' as resourceType,\n    resource::jsonb ->> 'intent' as intent,\n    resource::jsonb ->> 'priority' as priority,\n    resource::jsonb ->> 'lastModified' as lastModified,\n    resource::jsonb ->> 'requester' as requester,\n    resource::jsonb ->> 'status' as status,\n    resource::jsonb ->> 'reasonCode' as reasonCode,\n_airbyte_extracted_at as _airbyte_emitted_at\nfrom \"airbyte\".\"airbyte\".\"task\"\n\n\n  where _airbyte_extracted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_task\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_task\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.834803Z", "completed_at": "2025-09-09T13:44:48.840529Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.840753Z", "completed_at": "2025-09-09T13:44:48.915855Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09520888328552246, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.patient", "compiled": true, "compiled_code": "\n\nwith\ntags as (\n  with unnested_tags AS (\n    select\n        id,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,\n        _airbyte_emitted_at\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\"\n),\ntags_renamed as (\n    select\n      id as resource_id,\n      _airbyte_emitted_at,\n      meta_tag_code,\n      case\n        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'\n        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'\n        when meta_tag_display = 'Practitioner'              then 'practitioner_id'\n        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'\n        when meta_tag_display = 'Application Version'       then 'application_version'\n        else null\n      end as display_name\n    from unnested_tags\n)\nselect\n  resource_id,\n  _airbyte_emitted_at,\n  \n  \n    max(\n      \n      case\n      when display_name = 'practitioner_location_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_location_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_organization_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_organization_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_careteam_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_careteam_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'application_version'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"application_version\"\n      \n    \n    \n  \n\nfrom tags_renamed\n\n  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\")\n\ngroup by resource_id, _airbyte_emitted_at\n)\n\nselect \n    stp.id,\n    stp.gender,\n    stp.birthDate::date as birth_date,\n    DATE_PART('year', AGE(stp.birthDate::date))::integer as age_years,\n    stp.deceasedBoolean as deceased,\n    stp.active,\n    stp.period_start::date as registration_date,\n    ut.practitioner_location_id as location_id,\n    stp.name_family,\n    TRIM(stp.name_given,'[\"\"]') as name_given,\n    stp.telecom_value as phone_number,\n    ut.practitioner_id,\n    ut.practitioner_organization_id,\n    ut.practitioner_careteam_id,\n    stp._airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_patient\" stp\nleft join tags ut on ut.resource_id=stp.id\n\n\n    where stp._airbyte_emitted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\")\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.849988Z", "completed_at": "2025-09-09T13:44:48.879567Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.879902Z", "completed_at": "2025-09-09T13:44:48.923358Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0748898983001709, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.organizations", "compiled": true, "compiled_code": "\n\nwith\ncodes as (\n  select\n    id::text as resource_id,\n        type::jsonb ->> 'coding' as type_coding,\n    /* use the column your staging models actually expose */\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organizations\"\n)\n\nselect\n  o.id,\n  o.name,\n  o.active,\n  c.*\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organizations\" as o\nleft join codes c on c.resource_id = o.id \n\nwhere o._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organizations\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organizations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.824010Z", "completed_at": "2025-09-09T13:44:48.882838Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.883089Z", "completed_at": "2025-09-09T13:44:48.939098Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11829614639282227, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.encounters", "compiled": true, "compiled_code": "\n\nwith\ntags as (\n  with unnested_tags AS (\n    select\n        id,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,\n        _airbyte_emitted_at\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\"\n),\ntags_renamed as (\n    select\n      id as resource_id,\n      _airbyte_emitted_at,\n      meta_tag_code,\n      case\n        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'\n        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'\n        when meta_tag_display = 'Practitioner'              then 'practitioner_id'\n        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'\n        when meta_tag_display = 'Application Version'       then 'application_version'\n        else null\n      end as display_name\n    from unnested_tags\n)\nselect\n  resource_id,\n  _airbyte_emitted_at,\n  \n  \n    max(\n      \n      case\n      when display_name = 'practitioner_location_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_location_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_organization_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_organization_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_careteam_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_careteam_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'application_version'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"application_version\"\n      \n    \n    \n  \n\nfrom tags_renamed\n\n  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"encounters\")\n\ngroup by resource_id, _airbyte_emitted_at\n),\ncodes as (\n  -- Only json OBJECT columns here (arrays like reasonCode/participant are handled in SELECT)\n  select\n    id::text as resource_id,\n        class::jsonb ->> 'code' as class_code,\n        class::jsonb ->> 'system' as class_system,\n        priority::jsonb ->> 'coding' as priority_coding,\n        priority::jsonb ->> 'text' as priority_text,\n        period::jsonb ->> 'start' as period_start,\n        period::jsonb ->> 'end' as period_end,\n        serviceprovider::jsonb ->> 'reference' as serviceprovider_reference,\n    /* use the column your staging models actually expose */\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\"\n)\n\nselect\n  e.id,\n  e.status,\n  -- reasonCode is typically an array; grab the first element\u2019s 'text' safely\n  (e.reasoncode::jsonb -> 0 ->> 'text') as reasoncode,\n  \n  split_part(e.subject::jsonb->>'reference', '/', 1)\n as subject_type,\n  \n  split_part(e.subject::jsonb->>'reference', '/', 2)\n   as subject_id,\n  date_trunc('month', (c.period_start)::date) as month,\n  -- serviceType coding (jsonb)\n  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'code')    as service_coding,\n  (e.servicetype::jsonb -> 'coding' -> 0 ->> 'display') as service_display,\n\n  -- provider / class / priority decoded in 'codes' CTE\n  c.serviceprovider_reference,\n  c.class_code,\n  c.priority_text,\n  c.period_start,\n  c.period_end,\n\n  -- tags (meta->tag)\n  t.practitioner_location_id as location_id,\n  t.practitioner_organization_id,\n  t.practitioner_careteam_id,\n  t.practitioner_id,\n\n  -- keep the raw participant json for downstream use (it\u2019s an array)\n  e.participant,\n  e._airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_encounter\" e\nleft join tags  t on t.resource_id = e.id\nleft join codes c on c.resource_id = e.id\n\nwhere e._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at), '1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"encounters\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"encounters\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.865903Z", "completed_at": "2025-09-09T13:44:48.872176Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.873841Z", "completed_at": "2025-09-09T13:44:48.943778Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08059096336364746, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.organization_affiliations", "compiled": true, "compiled_code": "\n\nselect\n  s.id,\n  \n  split_part(s.organization::jsonb->>'reference', '/', 2)\n                 as organization_id,\n  \n  split_part((s.location::jsonb -> 0)::jsonb->>'reference', '/', 2)\n       as location_id,   -- first array entry\n  s._airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_organization_affiliations\" s\n\nwhere s._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organization_affiliations\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organization_affiliations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.925478Z", "completed_at": "2025-09-09T13:44:48.930579Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.931248Z", "completed_at": "2025-09-09T13:44:48.999247Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07693696022033691, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.practitioner_role", "compiled": true, "compiled_code": "\n\nselect\n  spr.id,\n  spr.active,\n  spr.resourceType as resourcetype,\n  -- first coding entry\n  (spr.code::jsonb -> 'coding' -> 0 ->> 'code')    as coding_code,\n  (spr.code::jsonb -> 'coding' -> 0 ->> 'display') as coding_display,\n  \n  split_part(spr.organization::jsonb->>'reference', '/', 2)\n  as organization_id,\n  \n  split_part(spr.practitioner::jsonb->>'reference', '/', 2)\n  as practitioner_id,\n  (spr.meta::jsonb ->> 'lastUpdated') as meta_lastupdated,\n  -- include the next line only if you actually want this column:\n  -- (spr.meta::jsonb ->> 'source')       as meta_source,\n  spr._airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner_roles\" spr\n\nwhere spr._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at), '1900-01-01')\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioner_role\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioner_role\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.934940Z", "completed_at": "2025-09-09T13:44:48.940781Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.941338Z", "completed_at": "2025-09-09T13:44:49.017772Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08534121513366699, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.int_qr_answers_long", "compiled": true, "compiled_code": "\n\nwith recursive base as (\n  select\n    id as qr_id,\n    questionnaire_id,\n    subject_patient_id,\n    encounter_id,\n    author_practitioner_id,\n    items,\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"\n),\n\nrecursive_items as (\n  select\n    b.qr_id,\n    b.questionnaire_id,\n    b.subject_patient_id,\n    b.encounter_id,\n    b.author_practitioner_id,\n    (i.value)::jsonb as item_json,\n    array[(i.value)::jsonb ->> 'linkId']::text[] as linkid_path,\n    b._airbyte_emitted_at\n  from base b\n  cross join lateral jsonb_array_elements(coalesce(b.items,'[]'::jsonb)) as i(value)\n  union all\n  select\n    r.qr_id,\n    r.questionnaire_id,\n    r.subject_patient_id,\n    r.encounter_id,\n    r.author_practitioner_id,\n    child.value::jsonb as item_json,\n    (r.linkid_path || (child.value::jsonb ->> 'linkId'))::text[] as linkid_path,\n    r._airbyte_emitted_at\n  from recursive_items r\n  join lateral jsonb_array_elements(coalesce(r.item_json -> 'item','[]'::jsonb)) as child(value) on true\n),\n\nanswers as (\n  select\n    qr_id,\n    questionnaire_id,\n    subject_patient_id,\n    encounter_id,\n    author_practitioner_id,\n    (linkid_path[array_length(linkid_path,1)]) as linkid,\n    a.value::jsonb as ans,\n    _airbyte_emitted_at\n  from recursive_items\n  cross join lateral jsonb_array_elements(coalesce(item_json -> 'answer','[]'::jsonb)) as a(value)\n),\n\nnormalized as (\n  select\n    qr_id,\n    questionnaire_id,\n    subject_patient_id,\n    encounter_id,\n    author_practitioner_id,\n    linkid,\n    ans ->> 'valueString'                         as value_string,\n    (ans ->> 'valueInteger')::int                 as value_integer,\n    (ans ->> 'valueDecimal')::numeric             as value_decimal,\n    ans ->> 'valueDate'                           as value_date,\n    ans -> 'valueCoding' ->> 'code'               as value_coding_code,\n    ans -> 'valueCoding' ->> 'display'            as value_coding_display,\n    (ans -> 'valueQuantity' ->> 'value')::numeric as value_quantity_value,\n    ans -> 'valueQuantity' ->> 'unit'             as value_quantity_unit,\n    coalesce(\n      ans -> 'valueCoding' ->> 'display',\n      ans ->> 'valueString',\n      ans ->> 'valueDate',\n      ans ->> 'valueInteger',\n      ans ->> 'valueDecimal',\n      ans -> 'valueQuantity' ->> 'value'\n    ) as answer_value_text,\n    _airbyte_emitted_at\n  from answers\n)\n\nselect * from normalized", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.947067Z", "completed_at": "2025-09-09T13:44:48.950406Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.952834Z", "completed_at": "2025-09-09T13:44:49.021614Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07663202285766602, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.int_qr_header", "compiled": true, "compiled_code": "\n\nselect\n  id as qr_id,\n  questionnaire_id,\n  subject_patient_id,\n  encounter_id,\n  author_practitioner_id,\n  _airbyte_emitted_at\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:48.950710Z", "completed_at": "2025-09-09T13:44:48.957707Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:48.958378Z", "completed_at": "2025-09-09T13:44:49.033582Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0845937728881836, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.int_qr_tags", "compiled": true, "compiled_code": "\nwith unnested_tags AS (\n    select\n        id,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'code'    as meta_tag_code,\n        jsonb_array_elements(coalesce(meta::jsonb -> 'tag', '[]'::jsonb)) ->> 'display' as meta_tag_display,\n        _airbyte_emitted_at\n    from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_questionnaire_response\"\n),\ntags_renamed as (\n    select\n      id as resource_id,\n      _airbyte_emitted_at,\n      meta_tag_code,\n      case\n        when meta_tag_display = 'Practitioner Location'    then 'practitioner_location_id'\n        when meta_tag_display = 'Practitioner Organization' then 'practitioner_organization_id'\n        when meta_tag_display = 'Practitioner'              then 'practitioner_id'\n        when meta_tag_display = 'Practitioner CareTeam'     then 'practitioner_careteam_id'\n        when meta_tag_display = 'Application Version'       then 'application_version'\n        else null\n      end as display_name\n    from unnested_tags\n)\nselect\n  resource_id,\n  _airbyte_emitted_at,\n  \n  \n    max(\n      \n      case\n      when display_name = 'practitioner_location_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_location_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_organization_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_organization_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'practitioner_careteam_id'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"practitioner_careteam_id\"\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when display_name = 'application_version'\n        then meta_tag_code\n      else null\n      end\n    )\n    \n      \n            as \"application_version\"\n      \n    \n    \n  \n\nfrom tags_renamed\n\n  where _airbyte_emitted_at > (select max(_airbyte_emitted_at) from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\")\n\ngroup by resource_id, _airbyte_emitted_at", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:49.005033Z", "completed_at": "2025-09-09T13:44:49.008669Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:49.009097Z", "completed_at": "2025-09-09T13:44:49.064213Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.060217857360839844, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.current_practitioner_role", "compiled": true, "compiled_code": "with ranked as (\n  select\n    pr.*,\n    row_number() over (\n      partition by practitioner_id\n      order by coalesce(pr.meta_lastupdated::timestamp, pr._airbyte_emitted_at::timestamp) desc\n    ) as rn\n  from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioner_role\" pr\n  where coalesce(pr.active::text,'true') ilike 'true'\n)\nselect * from ranked where rn = 1", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"current_practitioner_role\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:49.066575Z", "completed_at": "2025-09-09T13:44:49.854953Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:49.855629Z", "completed_at": "2025-09-09T13:44:49.933221Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8686511516571045, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_financial_wellness_tool", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Financial Wellness Tool with readable column names\n-- Questionnaire ID: q-financial-wellness-tool\n-- Source file: questionnaire/assessments/financial-wellness-tool.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/q-financial-wellness-tool') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '21234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_in_the_past_12_months_was_there_a_time_when_you_or\",max(case when linkid = '31234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_in_the_past_12_months_did_you_not_pay_the_full_amo\",max(case when linkid = '3456789a-bcde-f012-3456-789abcdef012' then answer_value_text end) as \"financial_how_hard_is_it_for_you_to_pay_for_the_very_basics_\",max(case when linkid = '51234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_how_strongly_do_you_agree_or_disagree_with_the_fol\",max(case when linkid = '61234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_in_the_past_12_months_did_you_move_in_with_other_p\",max(case when linkid = '6789abcd-ef01-2345-6789-abcdef012345' then answer_value_text end) as \"financial_in_the_past_12_months_how_often_did_you_run_out_of\",max(case when linkid = '91234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_in_the_past_12_months_did_you_stay_at_a_shelter_in\",max(case when linkid = 'c1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_in_the_past_12_months_did_you_not_pay_the_full_amo_8\",max(case when linkid = 'cdef0123-4567-89ab-cdef-0123456789ab' then answer_value_text end) as \"financial_i_worried_whether_my_food_would_run_out_before_i_g\",max(case when linkid = 'f0123456-789a-bcde-f012-3456789abcde' then answer_value_text end) as \"financial_the_food_that_i_bought_just_didnt_last_and_i_didnt\",max(case when linkid = 'f1234567-89ab-cdef-0123-456789abcdef' then answer_value_text end) as \"financial_in_the_past_12_months_was_your_phone_gas_heating_w\",max(case when linkid = 'f1a2b3c4-5e6f-4a1b-8c7d-9e0f1a2b3c4d' then answer_value_text end) as \"financial_when_you_think_about_your_financial_situation_how_\",max(case when linkid = 'high-debt' then answer_value_text end) as \"high-debt\",max(case when linkid = 'high-food-insecurity' then answer_value_text end) as \"high-food-insecurity\",max(case when linkid = 'high-housing-insecurity' then answer_value_text end) as \"high-housing-insecurity\",max(case when linkid = 'high-paying-bills' then answer_value_text end) as \"high-paying-bills\",max(case when linkid = 'moderate-debt' then answer_value_text end) as \"moderate-debt\",max(case when linkid = 'moderate-food-insecurity' then answer_value_text end) as \"moderate-food-insecurity\",max(case when linkid = 'moderate-housing-insecurity' then answer_value_text end) as \"moderate-housing-insecurity\",max(case when linkid = 'moderate-medical-hardships' then answer_value_text end) as \"moderate-medical-hardships\",max(case when linkid = 'moderate-paying-bills' then answer_value_text end) as \"moderate-paying-bills\",max(case when linkid = 'no-financial-hardship' then answer_value_text end) as \"no-financial-hardship\",max(case when linkid = 'overall-financial-hardship' then answer_value_text end) as \"overall-financial-hardship\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_financial_wellness_tool\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:49.053327Z", "completed_at": "2025-09-09T13:44:49.898975Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:49.901309Z", "completed_at": "2025-09-09T13:44:49.937003Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8974161148071289, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_confidential_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Discuss Confidentiality with readable column names\n-- Questionnaire ID: 23451\n-- Source file: questionnaire/ipc-session-1/confidential-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/23451') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"encounter_reference\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_confidential_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:49.048061Z", "completed_at": "2025-09-09T13:44:49.898645Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:49.899230Z", "completed_at": "2025-09-09T13:44:49.937932Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.8995189666748047, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_common_mental_health_symptoms", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Common Mental Health Symptoms with readable column names\n-- Questionnaire ID: q-common-mental-health-symptoms\n-- Source file: questionnaire/assessments/common-mental-health-symptoms.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/q-common-mental-health-symptoms') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as \"total_score\",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"in_the_past_month_how_much_were_you_bothered_bybrfeeling\",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as \"total_score_meaning\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"in_the_past_month_how_much_were_you_bothered_by_brrepeat\",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as \"total_score_5\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"in_the_past_month_how_much_were_you_bothered_bybrloss_of\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"in_the_past_month_how_much_were_you_bothered_by_brhaving\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"in_the_past_month_how_much_were_you_bothered_by_bravoidi\",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as \"total_score_meaning_9\",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as \"how_difficult_have_these_problems_made_it_for_you_to_do_your\",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as \"total_score_11\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"in_the_past_month_how_much_were_you_bothered_by_brfeelin\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"total_score_meaning_13\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"in_the_past_month_how_much_were_you_bothered_by_bravoidi_14\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"in_the_past_month_how_much_were_you_bothered_bybrhaving\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"f1.10.1\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"f1.11.1\",max(case when linkid = 'f1.15.1' then answer_value_text end) as \"f1.15.1\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"f1.16.1\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"f1.17.1\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"f1.18.1\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"f1.19.1\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"f1.20.1\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"f1.21.1\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"f1.3.1\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"f1.4.1\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"f1.5.1\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"f1.6.1\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"f1.7.1\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"f1.8.1\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"f1.9.1\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'show-pcl-5-to-8-questions' then answer_value_text end) as \"show-pcl-5-to-8-questions\",max(case when linkid = 'task-id-common-mental-pdf' then answer_value_text end) as \"task-id-common-mental-pdf\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_common_mental_health_symptoms\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:49.041129Z", "completed_at": "2025-09-09T13:44:49.900948Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:49.902896Z", "completed_at": "2025-09-09T13:44:49.934559Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.8979220390319824, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_1_month_follow_up", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- 1 month follow up with readable column names\n-- Questionnaire ID: 1-month-follow-up\n-- Source file: questionnaire/1-month-follow-up.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/1-month-follow-up') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'completed-all-recommended-interventions' then answer_value_text end) as \"completed-all-recommended-interventions\",max(case when linkid = 'schedule-this-meeting' then answer_value_text end) as \"schedule-this-meeting\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_1_month_follow_up\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:49.940297Z", "completed_at": "2025-09-09T13:44:50.639787Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:50.640182Z", "completed_at": "2025-09-09T13:44:50.655815Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7161571979522705, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- GAD-7 (IPC Session 1) with readable column names\n-- Questionnaire ID: 202\n-- Source file: questionnaire/ipc-session-1/gad-7-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/202') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '69f16284-b8a8-4a24-ab79-03bde5bcfbe9' then answer_value_text end) as \"ipc_s1_taskid_gad_pdf\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s1_encounter_id_of_gad7_session_1\",max(case when linkid = 'f1.15.1' then answer_value_text end) as \"ipc_s1_q1_anxious\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"ipc_s1_q2_control_worry\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"ipc_s1_q3_worry_too_much\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"ipc_s1_q4_trouble_relaxing\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"ipc_s1_q5_restless\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"ipc_s1_q6_irritable\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"ipc_s1_q7_afraid\",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as \"ipc_s1_observation_id_of_gad7_session_1_score\",max(case when linkid = '583c5b02-b26c-4821-8da8-7ed9066d9d5d' then answer_value_text end) as \"ipc_s1_total_score\",max(case when linkid = '829e6d32-3fa7-4d16-909b-b198aea54603' then answer_value_text end) as \"ipc_s1_score_meaning\",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as \"ipc_s1_score_meaning_13\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"encounter_reference\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:50.223008Z", "completed_at": "2025-09-09T13:44:50.829525Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:50.831582Z", "completed_at": "2025-09-09T13:44:50.859919Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6425831317901611, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- GAD-7 (IPC Session 3) with readable column names\n-- Questionnaire ID: 59\n-- Source file: questionnaire/ipc-session-3/gad-7-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/59') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as \"ipc_s3_q1_anxious\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"ipc_s3_q2_control_worry\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"ipc_s3_q3_worry_too_much\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"ipc_s3_q4_trouble_relaxing\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"ipc_s3_q5_restless\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"ipc_s3_q6_irritable\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"ipc_s3_q7_afraid\",max(case when linkid = '534c4998-b964-4101-b919-ff3c26af9714' then answer_value_text end) as \"ipc_s3_total_score\",max(case when linkid = 'd34c5839-fad9-4824-b2dc-9e0161647402' then answer_value_text end) as \"ipc_s3_score_meaning\",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as \"ipc_s3_score_meaning_10\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:50.225589Z", "completed_at": "2025-09-09T13:44:50.833801Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:50.834530Z", "completed_at": "2025-09-09T13:44:50.860578Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6425189971923828, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- GAD-7 (IPC Session 4) with readable column names\n-- Questionnaire ID: 62\n-- Source file: questionnaire/ipc-session-4/gad-7-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/62') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'f1.15.1' then answer_value_text end) as \"ipc_s4_q1_anxious\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"ipc_s4_q2_control_worry\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"ipc_s4_q3_worry_too_much\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"ipc_s4_q4_trouble_relaxing\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"ipc_s4_q5_restless\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"ipc_s4_q6_irritable\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"ipc_s4_q7_afraid\",max(case when linkid = '3e626219-c0e4-465e-92e6-9e976c52614c' then answer_value_text end) as \"ipc_s4_total_score\",max(case when linkid = 'e4155e07-1d18-448f-8111-182bf4149672' then answer_value_text end) as \"ipc_s4_score_meaning\",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as \"ipc_s4_score_meaning_10\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:50.219909Z", "completed_at": "2025-09-09T13:44:50.829280Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:50.829744Z", "completed_at": "2025-09-09T13:44:50.861169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6438870429992676, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_gad_7_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- GAD-7 (IPC Session 2) with readable column names\n-- Questionnaire ID: 205\n-- Source file: questionnaire/ipc-session-2/gad-7-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/205') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s2_encounter_id_of_gad7_session_2\",max(case when linkid = 'f1.15.1' then answer_value_text end) as \"ipc_s2_q1_anxious\",max(case when linkid = 'f1.16.1' then answer_value_text end) as \"ipc_s2_q2_control_worry\",max(case when linkid = 'f1.17.1' then answer_value_text end) as \"ipc_s2_q3_worry_too_much\",max(case when linkid = 'f1.18.1' then answer_value_text end) as \"ipc_s2_q4_trouble_relaxing\",max(case when linkid = 'f1.19.1' then answer_value_text end) as \"ipc_s2_q5_restless\",max(case when linkid = 'f1.20.1' then answer_value_text end) as \"ipc_s2_q6_irritable\",max(case when linkid = 'f1.21.1' then answer_value_text end) as \"ipc_s2_q7_afraid\",max(case when linkid = 'observation-gad-score-id' then answer_value_text end) as \"ipc_s2_observation_id_of_gad7_session_2_score\",max(case when linkid = '37e0bcfd-f6d1-4b35-9556-4d458a717a23' then answer_value_text end) as \"ipc_s2_total_score\",max(case when linkid = '510776d6-8b4e-446b-abe7-80aee8ecb110' then answer_value_text end) as \"ipc_s2_score_meaning\",max(case when linkid = '3212b2b2-f42f-46e9-b6bd-42fc29671da9' then answer_value_text end) as \"ipc_s2_score_meaning_12\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_gad_7_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:50.658083Z", "completed_at": "2025-09-09T13:44:51.276477Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:51.276830Z", "completed_at": "2025-09-09T13:44:51.291665Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6342692375183105, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mood Rating (IPC Session 1) with readable column names\n-- Questionnaire ID: 203\n-- Source file: questionnaire/ipc-session-1/mood-rating-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/203') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_\",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as \"mood_s1_8085cded8e0f497f9e3d5fab3981d727\",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as \"mood_s1_total_score\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"encounter_reference\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:50.869722Z", "completed_at": "2025-09-09T13:44:51.473456Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:51.474040Z", "completed_at": "2025-09-09T13:44:51.502041Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6373898983001709, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mood Rating (IPC Session 3) with readable column names\n-- Questionnaire ID: 207\n-- Source file: questionnaire/ipc-session-3/mood-rating-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/207') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_\",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as \"mood_s3_total_score\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:50.866978Z", "completed_at": "2025-09-09T13:44:51.479120Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:51.479323Z", "completed_at": "2025-09-09T13:44:51.505511Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6404109001159668, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mood Rating (IPC Session 2) with readable column names\n-- Questionnaire ID: 206\n-- Source file: questionnaire/ipc-session-2/mood-rating-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/206') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_\",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as \"mood_s2_total_score\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:50.872703Z", "completed_at": "2025-09-09T13:44:51.481233Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:51.481710Z", "completed_at": "2025-09-09T13:44:51.508144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6425936222076416, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mood_rating_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mood Rating (IPC Session 4) with readable column names\n-- Questionnaire ID: 209\n-- Source file: questionnaire/ipc-session-4/mood-rating-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/209') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'f1.33.6' then answer_value_text end) as \"mood_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_\",max(case when linkid = 'c04706e8-4a1e-4e6a-ac6e-be9dd8274990' then answer_value_text end) as \"mood_s4_total_score\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mood_rating_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:51.293684Z", "completed_at": "2025-09-09T13:44:51.905461Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:51.905804Z", "completed_at": "2025-09-09T13:44:51.921483Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6284387111663818, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mw_tool", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mental Wellness Tool with readable column names\n-- Questionnaire ID: 1613532\n-- Source file: questionnaire/assessments/mw-tool.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/1613532') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as \"mental_in_the_past_year_have_there_been_times_when_you_fe\",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as \"mental_in_the_past_year_have_you_ever_felt_that_your_thou\",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as \"mental_in_the_past_year_how_often_do_you_have_a_drink_con\",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as \"mental_in_the_past_month_have_you_wished_you_were_dead_or\",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as \"mental_in_the_past_year_did_you_at_any_time_hear_voices_s\",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as \"mental_q2_depressed\",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as \"mental_in_the_past_year_how_many_times_have_you_used_a_re\",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as \"mental_in_the_past_year_how_many_drinks_containing_alcoho\",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as \"mental_in_the_past_3_months_have_you_ever_done_anything_s\",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as \"mental_q1_anxious\",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as \"mental_in_the_past_month_have_you_had_any_actual_thoughts\",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as \"mental_q5_restless\",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as \"mental_in_the_past_year_have_there_been_times_when_you_fe_13\",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as \"mental_did_you_discuss_this_clients_severe_mental_health_\",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as \"mental_supervisors_name\",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as \"mental_what_is_the_recommended_plan_to_address_the_probab\",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as \"mental_referral_details_if_the_client_is_referred_out\",max(case when linkid = '80499f94-3f2a-4f0f-9a21-7fa252b33e29' then answer_value_text end) as \"retake_screening\",max(case when linkid = '8a051272-efb0-4f1f-acc7-f5038989207f' then answer_value_text end) as \"retake_screening_19\",max(case when linkid = 'alcohol-problem' then answer_value_text end) as \"alcohol-problem\",max(case when linkid = 'common-mental-health' then answer_value_text end) as \"common-mental-health\",max(case when linkid = 'drug-problem' then answer_value_text end) as \"drug-problem\",max(case when linkid = 'how-many-drinks' then answer_value_text end) as \"how-many-drinks\",max(case when linkid = 'no-mental-problem' then answer_value_text end) as \"no-mental-problem\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as \"patient-biological-sex\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as \"patient-gender-identity\",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as \"patient-how-you-think-of-yourself\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'patient-pronouns' then answer_value_text end) as \"patient-pronouns\",max(case when linkid = 'q1-to-q3-negative' then answer_value_text end) as \"q1-to-q3-negative\",max(case when linkid = 'severe-mental-health' then answer_value_text end) as \"severe-mental-health\",max(case when linkid = 'suicide-risk' then answer_value_text end) as \"suicide-risk\",max(case when linkid = 'task-id-common-mental-health-form' then answer_value_text end) as \"task-id-common-mental-health-form\",max(case when linkid = 'task-id-mwtool-pdf' then answer_value_text end) as \"task-id-mwtool-pdf\",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as \"task-id-socio-pdf\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mw_tool\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:51.510638Z", "completed_at": "2025-09-09T13:44:52.131278Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:52.131537Z", "completed_at": "2025-09-09T13:44:52.159144Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6535699367523193, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_mw_tool_ipc_session_4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Mental Wellness Tool Session 4 with readable column names\n-- Questionnaire ID: mw-tool-ipc-session-4\n-- Source file: questionnaire/assessments/mw-tool-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/mw-tool-ipc-session-4') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '0ee3228d-28b6-4c88-8119-808fc121aaa6' then answer_value_text end) as \"in_the_past_year_have_there_been_times_when_you_felt_that_s\",max(case when linkid = '11e90302-2ae0-4e7d-be11-754b2a91ab20' then answer_value_text end) as \"in_the_past_year_have_you_ever_felt_that_your_thoughts_were\",max(case when linkid = '156fce37-203f-4760-a9f9-1b8ab0ae0642' then answer_value_text end) as \"in_the_past_year_how_often_do_you_have_a_drink_containing_a\",max(case when linkid = '2c50fee4-7a5d-4d62-80aa-73329934d7dc' then answer_value_text end) as \"in_the_past_month_have_you_wished_you_were_dead_or_wished_y\",max(case when linkid = '364e4271-e89d-4206-85a1-45ad595e4cab' then answer_value_text end) as \"in_the_past_year_did_you_at_any_time_hear_voices_saying_qui\",max(case when linkid = '59ae2c65-3a25-4acb-9db5-7aa035c54a63' then answer_value_text end) as \"in_the_last_2_weeks_how_often_have_you_been_feeling_down_d\",max(case when linkid = '69a559db-c97b-4bcb-aae4-81465fdd1d20' then answer_value_text end) as \"in_the_past_year_how_many_times_have_you_used_a_recreationa\",max(case when linkid = '94f913ce-e837-48b3-906d-a0613ac72b73' then answer_value_text end) as \"in_the_past_year_how_many_drinks_containing_alcohol_do_you\",max(case when linkid = '97f2ed48-11d2-4417-a4b2-57a333c5157f' then answer_value_text end) as \"in_the_past_3_months_have_you_ever_done_anything_started_t\",max(case when linkid = '99f0d10e-9522-457f-8432-fd489c53acb3' then answer_value_text end) as \"in_the_last_2_weeks_how_often_have_you_been_feeling_nervous\",max(case when linkid = 'a669eaea-2f12-49ff-ac91-d54009d6ab77' then answer_value_text end) as \"in_the_past_month_have_you_had_any_actual_thoughts_of_killi\",max(case when linkid = 'b9ecb840-8515-4091-8cef-863ed297012e' then answer_value_text end) as \"in_the_last_2_weeks_how_often_have_you_been_so_restless_tha\",max(case when linkid = 'f35bbaa2-5e2e-4c74-b9b4-f0aa1eabe47d' then answer_value_text end) as \"in_the_past_year_have_there_been_times_when_you_felt_that_a\",max(case when linkid = 'alcohol-problem' then answer_value_text end) as \"alcohol-problem\",max(case when linkid = 'common-mental-health' then answer_value_text end) as \"common-mental-health\",max(case when linkid = 'drug-problem' then answer_value_text end) as \"drug-problem\",max(case when linkid = 'how-many-drinks' then answer_value_text end) as \"how-many-drinks\",max(case when linkid = 'no-mental-problem' then answer_value_text end) as \"no-mental-problem\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as \"patient-biological-sex\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as \"patient-gender-identity\",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as \"patient-how-you-think-of-yourself\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'patient-pronouns' then answer_value_text end) as \"patient-pronouns\",max(case when linkid = 'severe-mental-health' then answer_value_text end) as \"severe-mental-health\",max(case when linkid = 'suicide-risk' then answer_value_text end) as \"suicide-risk\",max(case when linkid = 'task-id-mw-tool-ipc-s4-pdf' then answer_value_text end) as \"task-id-mw-tool-ipc-s4-pdf\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_mw_tool_ipc_session_4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:51.520015Z", "completed_at": "2025-09-09T13:44:52.137737Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:52.138392Z", "completed_at": "2025-09-09T13:44:52.165847Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6516358852386475, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 2) with readable column names\n-- Questionnaire ID: 57\n-- Source file: questionnaire/ipc-session-2/phq-9-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/57') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s2_encounter_id_of_phq9_session_2\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"ipc_s2_q8_movement\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"ipc_s2_q9_suicide\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"ipc_s2_q1_interest\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"ipc_s2_q2_depressed\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"ipc_s2_q3_sleep\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"ipc_s2_q4_tired\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"ipc_s2_q5_appetite\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"ipc_s2_q6_failure\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"ipc_s2_q7_concentration\",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as \"ipc_s2_observation_id_of_phq9_session_2_score\",max(case when linkid = '7afb89dc-d53b-4dc3-a185-43dbb4854172' then answer_value_text end) as \"ipc_s2_total_score\",max(case when linkid = '7239b680-ef7a-4f9f-87ff-a77bf21d96d4' then answer_value_text end) as \"ipc_s2_score_meaning\",max(case when linkid = 'a07491bd-039d-417b-9caf-0af536316594' then answer_value_text end) as \"ipc_s2_score_meaning_14\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:51.515432Z", "completed_at": "2025-09-09T13:44:52.137951Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:52.140162Z", "completed_at": "2025-09-09T13:44:52.170161Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6578049659729004, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 1) with readable column names\n-- Questionnaire ID: 54\n-- Source file: questionnaire/ipc-session-1/phq-9-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/54') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'f1.3.1' then answer_value_text end) as \"phq9_q1_interest\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"phq9_q2_depressed\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"phq9_q3_sleep\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"phq9_q4_tired\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"phq9_q5_appetite\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"phq9_q6_failure\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"phq9_q7_concentration\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"phq9_q8_movement\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"phq9_q9_suicide\",max(case when linkid = 'b3d8e9fc-0435-47c5-a3f7-a0ce6cf41879' then answer_value_text end) as \"phq9_total_score\",max(case when linkid = '4a05b4fe-b514-4751-91be-adb1b278430c' then answer_value_text end) as \"phq9_score_meaning\",max(case when linkid = '0cfe26b9-8cd8-4d03-938f-991ebab4b3c0' then answer_value_text end) as \"phq9_score_meaning_code\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"phq9_encounter_id\",max(case when linkid = 'observation-phq-score-id' then answer_value_text end) as \"phq9_observation_id\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"phq9_calculated_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"phq9_calculated_year\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"phq9_field_cd8e3d6d\",max(case when linkid = 'f5675128-0cd4-423f-840c-8dcff1e2a429' then answer_value_text end) as \"phq9_task_id\",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as \"phq9_field_9c366bcc\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"phq9_field_b5bc7f80\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"phq9_link_encounter\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:51.923384Z", "completed_at": "2025-09-09T13:44:52.546578Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:52.547228Z", "completed_at": "2025-09-09T13:44:52.563343Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6406009197235107, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 3) with readable column names\n-- Questionnaire ID: 61\n-- Source file: questionnaire/ipc-session-3/phq-9-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/61') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '45f52042-6802-4d9c-9f86-6578923d0fd1' then answer_value_text end) as \"ipc_s3_total_score\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"ipc_s3_q8_movement\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"ipc_s3_q9_suicide\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"ipc_s3_q1_interest\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"ipc_s3_q2_depressed\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"ipc_s3_q3_sleep\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"ipc_s3_q4_tired\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"ipc_s3_q5_appetite\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"ipc_s3_q6_failure\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"ipc_s3_q7_concentration\",max(case when linkid = '55d78cf4-0963-4c44-af44-6004a8abbb3e' then answer_value_text end) as \"ipc_s3_score_meaning\",max(case when linkid = '4650a511-2184-4b0b-9e43-54f45f4340a9' then answer_value_text end) as \"ipc_s3_score_meaning_12\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:52.166018Z", "completed_at": "2025-09-09T13:44:52.788488Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:52.788904Z", "completed_at": "2025-09-09T13:44:52.812238Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6485459804534912, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_phq_9_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- PHQ-9 (IPC Session 4) with readable column names\n-- Questionnaire ID: 211\n-- Source file: questionnaire/ipc-session-4/phq-9-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/211') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '01a4984f-7b50-47bb-9ae1-1b81ee4d6df2' then answer_value_text end) as \"ipc_s4_total_score\",max(case when linkid = '9c366bcc-38c8-449f-8823-8a1632f44da3' then answer_value_text end) as \"ipc_s4_how_difficult_have_these_problems_made_it_for_you_\",max(case when linkid = 'f1.10.1' then answer_value_text end) as \"ipc_s4_q8_movement\",max(case when linkid = 'f1.11.1' then answer_value_text end) as \"ipc_s4_q9_suicide\",max(case when linkid = 'f1.3.1' then answer_value_text end) as \"ipc_s4_q1_interest\",max(case when linkid = 'f1.4.1' then answer_value_text end) as \"ipc_s4_q2_depressed\",max(case when linkid = 'f1.5.1' then answer_value_text end) as \"ipc_s4_q3_sleep\",max(case when linkid = 'f1.6.1' then answer_value_text end) as \"ipc_s4_q4_tired\",max(case when linkid = 'f1.7.1' then answer_value_text end) as \"ipc_s4_q5_appetite\",max(case when linkid = 'f1.8.1' then answer_value_text end) as \"ipc_s4_q6_failure\",max(case when linkid = 'f1.9.1' then answer_value_text end) as \"ipc_s4_q7_concentration\",max(case when linkid = '11d368a4-7f34-46d5-a8d0-6deed381945b' then answer_value_text end) as \"ipc_s4_score_meaning\",max(case when linkid = '4b86c897-4d68-405b-aa08-760ed6ff6792' then answer_value_text end) as \"ipc_s4_score_meaning_13\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_phq_9_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:52.175857Z", "completed_at": "2025-09-09T13:44:52.800288Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:52.800610Z", "completed_at": "2025-09-09T13:44:52.832656Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.658602237701416, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_planning_next_steps", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Planning Next Steps with readable column names\n-- Questionnaire ID: q-planning-next-steps\n-- Source file: questionnaire/assessments/planning-next-steps.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/q-planning-next-steps') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '12894a06-d244-4426-06f5-f2a3b4c5d6e7' then answer_value_text end) as \"referral_to_mental_health_specialist\",max(case when linkid = '1d2fdd10-a4d1-43e0-8042-8772146e63f7' then answer_value_text end) as \"referred\",max(case when linkid = '256b56d8-c4c2-4313-9e2d-6720941be85f' then answer_value_text end) as \"okay\",max(case when linkid = '2cb66889-3c74-40ff-be3d-183fdb17ce2d' then answer_value_text end) as \"field_2cb66889\",max(case when linkid = '34a56c28-f466-4648-2817-41b2c3d4e5f6' then answer_value_text end) as \"field_34a56c28\",max(case when linkid = '34ab6c28-f466-4648-2817-14c5d6e7f8a9' then answer_value_text end) as \"referres\",max(case when linkid = '34ab6c28-f466-4648-2817-1eacbdcedf01' then answer_value_text end) as \"field_34ab6c28\",max(case when linkid = '3b9f7e5d-9a66-4c4d-8e1d-4d5e6f7a8b9d' then answer_value_text end) as \"field_3b9f7e5d\",max(case when linkid = '3d373ba7-14fa-43bb-bd27-52fad3d2783f' then answer_value_text end) as \"sbirt_motivational_interviewing\",max(case when linkid = '45b67d39-0577-4759-3928-52c3d4e5f6a7' then answer_value_text end) as \"safety\",max(case when linkid = '45bc7d39-0577-4759-3928-2fbdcedf0123' then answer_value_text end) as \"others\",max(case when linkid = '4ca08f6e-0b77-4d5e-9f2e-5e6f7a8b9cae' then answer_value_text end) as \"mental_health\",max(case when linkid = '56cd8e4a-1688-486a-4a39-3acedf012345' then answer_value_text end) as \"not_interested\",max(case when linkid = '5db19a7f-1c88-4e6f-8a3f-6f7a8b9c0dbf' then answer_value_text end) as \"20250924\",max(case when linkid = '69712544-6237-4962-a455-ee6e9ee80000' then answer_value_text end) as \"field_69712544\",max(case when linkid = '76ba8dbe-5456-4de4-bdde-4b8059ecfa0e' then answer_value_text end) as \"field_76ba8dbe\",max(case when linkid = '9311146c-720d-47f6-b902-aeecaf3c0574' then answer_value_text end) as \"hh\",max(case when linkid = '950d904a-da1a-4ccd-988d-ea6b463ee106' then answer_value_text end) as \"20260505\",max(case when linkid = '9a8b7c6d-5e4f-4a3b-2c1d-0e9f8a7b6c5d' then answer_value_text end) as \"field_9a8b7c6d\",max(case when linkid = 'a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d' then answer_value_text end) as \"sbirt_motivational_interviewingbrspan_stylecolor006\",max(case when linkid = 'ab12d39f-6bdd-4dbf-9f8e-8f13456789ab' then answer_value_text end) as \"field_ab12d39f\",max(case when linkid = 'b1c2d3e4-f5a6-4b7c-8d9e-0f1a2b3c4d5e' then answer_value_text end) as \"they_gtycyvuy\",max(case when linkid = 'b2c3d4e5-f6a7-4b8c-9d0e-1f2a3b4c5d6e' then answer_value_text end) as \"field_b2c3d4e5\",max(case when linkid = 'bc23e4a0-7cee-4ec0-a09f-902456789abc' then answer_value_text end) as \"test\",max(case when linkid = 'bc2def4a-7cee-4ec0-a09f-cf3a4b5c6d7e' then answer_value_text end) as \"field_bc2def4a\",max(case when linkid = 'c3d4e5f6-a7b8-4c9d-0e1f-2a3b4c5d6e7f' then answer_value_text end) as \"field_c3d4e5f6\",max(case when linkid = 'c9d8b7a6-f5e4-4d3c-b2a1-09f8e7d6c5b4' then answer_value_text end) as \"field_c9d8b7a6\",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-a1356789abcd' then answer_value_text end) as \"not_interested_28\",max(case when linkid = 'cd34f5b1-8dff-4fd1-b1a0-ad3b4c5d6e7f' then answer_value_text end) as \"field_cd34f5b1\",max(case when linkid = 'cd3ef5b1-8dff-4fd1-b1a0-da4b5c6d7e8f' then answer_value_text end) as \"iwbwb\",max(case when linkid = 'd0e1f2a3-b4c5-4d6e-7f8a-9b0c1d2e3f4a' then answer_value_text end) as \"needs_checkups\",max(case when linkid = 'de4506c2-9e00-40e2-c2b1-be4c5d6e7f8a' then answer_value_text end) as \"hhh\",max(case when linkid = 'de4f06c2-9e00-40e2-c2b1-eb5c6d7e8f90' then answer_value_text end) as \"20250827\",max(case when linkid = 'e6a2b8e5-3d5f-4f5a-9a3d-f2e1c0b9a8d7' then answer_value_text end) as \"referral_to_mental_health_specialist_34\",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-cf5d6e7f8a9b' then answer_value_text end) as \"already_received_a_similar_service\",max(case when linkid = 'ef5617d3-af11-41f3-d3c2-fcd0e1f2a3b4' then answer_value_text end) as \"field_ef5617d3\",max(case when linkid = 'f06728e4-b022-4204-e4d3-d0e1f2a3b4c5' then answer_value_text end) as \"peace\",max(case when linkid = 'f4e3d2c1-b0a9-4988-7766-554433221100' then answer_value_text end) as \"interested_but_not_now\",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as \"supervisors_name\",max(case when linkid = 'd4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g' then answer_value_text end) as \"d4e5f6a7-b8c9-4d0e-1f2a-3b4c5d6e7f8g\",max(case when linkid = 'e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h' then answer_value_text end) as \"e5f6a7b8-c9d0-4e1f-2a3b-4c5d6e7f8g9h\",max(case when linkid = 'f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i' then answer_value_text end) as \"f6a7b8c9-d0e1-4f2a-3b4c-5d6e7f8g9h0i\",max(case when linkid = 'financial-hardships-list' then answer_value_text end) as \"financial-hardships-list\",max(case when linkid = 'is-fws' then answer_value_text end) as \"is-fws\",max(case when linkid = 'is-ipc' then answer_value_text end) as \"is-ipc\",max(case when linkid = 'is-ipc-main' then answer_value_text end) as \"is-ipc-main\",max(case when linkid = 'is-ipc-optional' then answer_value_text end) as \"is-ipc-optional\",max(case when linkid = 'is-mhs' then answer_value_text end) as \"is-mhs\",max(case when linkid = 'is-other-agency-services' then answer_value_text end) as \"is-other-agency-services\",max(case when linkid = 'is-other-services-outside-agency' then answer_value_text end) as \"is-other-services-outside-agency\",max(case when linkid = 'is-sbirt' then answer_value_text end) as \"is-sbirt\",max(case when linkid = 'is-sbirt-main' then answer_value_text end) as \"is-sbirt-main\",max(case when linkid = 'is-sbirt-optional' then answer_value_text end) as \"is-sbirt-optional\",max(case when linkid = 'is-spi' then answer_value_text end) as \"is-spi\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'scheduled-ipc-session-1-with-current-time' then answer_value_text end) as \"scheduled-ipc-session-1-with-current-time\",max(case when linkid = 'scheduled-ipc-session-1-with-current-time-2' then answer_value_text end) as \"scheduled-ipc-session-1-with-current-time-2\",max(case when linkid = 'task-id-000' then answer_value_text end) as \"task-id-000\",max(case when linkid = 'task-id-001' then answer_value_text end) as \"task-id-001\",max(case when linkid = 'task-id-002' then answer_value_text end) as \"task-id-002\",max(case when linkid = 'task-id-003' then answer_value_text end) as \"task-id-003\",max(case when linkid = 'task-id-004' then answer_value_text end) as \"task-id-004\",max(case when linkid = 'task-id-006' then answer_value_text end) as \"task-id-006\",max(case when linkid = 'task-id-planning-next-steps-pdf' then answer_value_text end) as \"task-id-planning-next-steps-pdf\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_planning_next_steps\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:52.179171Z", "completed_at": "2025-09-09T13:44:52.805018Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:52.805509Z", "completed_at": "2025-09-09T13:44:52.833381Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6646783351898193, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_registration_info", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Add Family Member Registration with readable column names\n-- Questionnaire ID: 221\n-- Source file: questionnaire/generic/registration_info.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/221') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '36d39dbe-00e2-4e29-f079-3ec8f0119aff' then answer_value_text end) as \"registration_36d39dbe00e24e29f0793ec8f0119aff\",max(case when linkid = '597f4425-72b3-4bc4-8f38-b742aa3e99cd' then answer_value_text end) as \"registration_middle_name\",max(case when linkid = '77e32953-0679-48b5-f004-1ab4a4ac0271' then answer_value_text end) as \"registration_which_of_the_following_best_represents_how_you_thi\",max(case when linkid = '8460d986-ef71-4997-80ee-7887d8c345e7' then answer_value_text end) as \"registration_age\",max(case when linkid = '8fb87910-d900-4eea-dbba-dcf76ee6806d' then answer_value_text end) as \"registration_surname\",max(case when linkid = 'age' then answer_value_text end) as \"registration_age_6\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"registration_calculated_age\",max(case when linkid = 'c02a80e7-ebf0-48b5-9752-28a48dba487f' then answer_value_text end) as \"registration_unique_id\",max(case when linkid = 'c31ef6d1-336b-4260-9881-67ba7b477ae0' then answer_value_text end) as \"registration_has_this_person_received_engage_services_in_the_pa\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"registration_calculated_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"registration_calculated_year\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"registration_date_of_birth_dob\",max(case when linkid = 'e6306275-b989-4375-8527-3a56092081b8' then answer_value_text end) as \"registration_first_name\",max(case when linkid = 'f9aa068d-8d94-4b3d-b9da-ce05a59cecdd' then answer_value_text end) as \"registration_what_was_your_biological_sex_assigned_at_birth\",max(case when linkid = 'choice-gender-identity' then answer_value_text end) as \"choice-gender-identity\",max(case when linkid = 'choice-pronouns' then answer_value_text end) as \"choice-pronouns\",max(case when linkid = 'do-you-have-medicaid' then answer_value_text end) as \"do-you-have-medicaid\",max(case when linkid = 'email-address' then answer_value_text end) as \"email-address\",max(case when linkid = 'medicaid-number' then answer_value_text end) as \"medicaid-number\",max(case when linkid = 'other-best-represents-how-you-think-of-yourself' then answer_value_text end) as \"other-best-represents-how-you-think-of-yourself\",max(case when linkid = 'other-biological-sex-at-birth' then answer_value_text end) as \"other-biological-sex-at-birth\",max(case when linkid = 'other-gender-identity' then answer_value_text end) as \"other-gender-identity\",max(case when linkid = 'other-pronouns' then answer_value_text end) as \"other-pronouns\",max(case when linkid = 'other-where-did-you-first-learn-about-engage' then answer_value_text end) as \"other-where-did-you-first-learn-about-engage\",max(case when linkid = 'phone-number' then answer_value_text end) as \"phone-number\",max(case when linkid = 'physical-address' then answer_value_text end) as \"physical-address\",max(case when linkid = 'where-did-you-first-learn-about-engage' then answer_value_text end) as \"where-did-you-first-learn-about-engage\",max(case when linkid = 'zip-code' then answer_value_text end) as \"zip-code\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_registration_info\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:52.565396Z", "completed_at": "2025-09-09T13:44:53.193969Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:53.194670Z", "completed_at": "2025-09-09T13:44:53.209036Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6443159580230713, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_remove_patient", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- eCBIS Remove Family Form with readable column names\n-- Questionnaire ID: 69\n-- Source file: questionnaire/generic/remove_patient.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/69') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '17b7fda5-514c-4408-88e7-52313ab0ef2f' then answer_value_text end) as \"remove_family_date_of_death\",max(case when linkid = '8489d249-1ef3-4edb-aa99-b5713fd2cb0a' then answer_value_text end) as \"remove_family_give_other_reasons_for_removal\",max(case when linkid = '98ac4694-590e-4cc2-83f3-cc6455e688c5' then answer_value_text end) as \"remove_family_age_at_death_year\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b' then answer_value_text end) as \"remove_family_a11ebb0dacb34038956b293a41acb85b\",max(case when linkid = 'b6c21488-87b8-4213-8cd0-d482367669c1' then answer_value_text end) as \"remove_family_date_moved_away\",max(case when linkid = 'f83bb7c0-dfd6-4aa8-9cb9-89d48b8040ff' then answer_value_text end) as \"remove_family_reason_for_removal\",max(case when linkid = 'patient-birthdate' then answer_value_text end) as \"remove_family_patientbirthdate\",max(case when linkid = 'cd73cfdf-6d70-4b42-8887-21e27db0b9ec' then answer_value_text end) as \"reason_unknown\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_remove_patient\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:52.814822Z", "completed_at": "2025-09-09T13:44:53.439061Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:53.439280Z", "completed_at": "2025-09-09T13:44:53.467312Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6540710926055908, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sbirt", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SBIRT with readable column names\n-- Questionnaire ID: 212\n-- Source file: questionnaire/sbirt.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/212') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '232a2454-1d23-4ec9-b4ee-65e3a48afb3e' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_drink_alc\",max(case when linkid = '4e2b0891-5355-4ffd-8a18-66193a0dbfbe' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t\",max(case when linkid = '642b120d-78f5-4ec6-9cbf-d3b9e336083e' then answer_value_text end) as \"sbirt_have_you_or_someone_else_been_injured_as_a_result_\",max(case when linkid = '67c70e9e-2e10-4d4a-b354-95621a05c621' then answer_value_text end) as \"sbirt_how_often_do_you_have_six_or_more_drinks_on_one_oc\",max(case when linkid = '6c1d97a4-bb16-4c46-bcee-5593f472b53b' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_needed_a_f\",max(case when linkid = '71679b91-ee7b-4eda-9f9d-cf85645ee848' then answer_value_text end) as \"sbirt_have_you_ever_experienced_withdrawal_symptoms_felt\",max(case when linkid = '86daa888-2174-4fdc-9200-cbfdbe430ab4' then answer_value_text end) as \"sbirt_have_you_had_blackouts_or_flashbacks_as_a_result_o\",max(case when linkid = '893ab0b5-f2ce-4fe2-8e2a-f9bc2a010b04' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t_8\",max(case when linkid = '9346e7e0-e74b-452a-addc-e6ad13d016dd' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_had_a_feel\",max(case when linkid = '94dc51b7-59e3-4276-9afe-9b18cb7a08e1' then answer_value_text end) as \"sbirt_how_many_standard_drinks_containing_alcohol_do_you\",max(case when linkid = '9724b66b-2162-4984-b352-0bc27bcfdfef' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_been_unabl\",max(case when linkid = 'a713e390-f199-4ed4-9a27-b9938fbf8b11' then answer_value_text end) as \"sbirt_how_often_do_you_have_a_drink_containing_alcohol\",max(case when linkid = 'ab8f95f3-3ca8-439f-afc2-c95a0853f9f4' then answer_value_text end) as \"sbirt_have_you_neglected_your_family_because_of_your_use\",max(case when linkid = 'b81b6e43-3b57-489e-8ea9-f35d82f9f267' then answer_value_text end) as \"sbirt_do_you_ever_feel_bad_or_guilty_about_your_drug_use\",max(case when linkid = 'c08dae42-df65-4dba-98c6-47f9e5dafcb0' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t_15\",max(case when linkid = 'c0911201-29b6-4cff-8cf8-fca31dc2b990' then answer_value_text end) as \"sbirt_have_you_had_medical_problems_as_a_result_of_your_\",max(case when linkid = 'c3e99643-32dc-4e2e-983c-e694159623e3' then answer_value_text end) as \"sbirt_have_you_ever_used_any_drugs_by_injection_nonmedic\",max(case when linkid = 'c6c7bd0c-812d-4931-b94c-929aa04dc45c' then answer_value_text end) as \"sbirt_have_you_engaged_in_illegal_activities_in_order_to\",max(case when linkid = 'c93222e9-84f3-44a3-a87d-d92dafdc558e' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t_19\",max(case when linkid = 'cd6aa7a8-5c5d-40bd-a096-d3a77a3afc2e' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t_20\",max(case when linkid = 'd169ab54-4544-4d1a-8687-6abc289982a4' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_failed_to_\",max(case when linkid = 'da1016a2-b3c5-4ea5-ae4a-0cce5d9c51db' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t_22\",max(case when linkid = 'daf9b1ff-06c5-45a7-a3d1-26977a2e2b41' then answer_value_text end) as \"sbirt_does_your_spouse_or_parents_ever_complain_about_yo\",max(case when linkid = 'db4b99b9-2cae-4833-bb08-fe7e94156b49' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t_24\",max(case when linkid = 'dc9d1ab7-8f17-4ea3-b9c1-24ff00a5f197' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t_25\",max(case when linkid = 'e4bd2450-08cb-410f-8f81-743d84749347' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_used_t_26\",max(case when linkid = 'e8e7d8b0-88e2-4bae-8990-c3ae94165ef9' then answer_value_text end) as \"sbirt_are_you_always_able_to_stop_using_drugs_when_you_w\",max(case when linkid = 'ec346c72-9835-4b5a-8088-1797a200f995' then answer_value_text end) as \"sbirt_how_often_during_the_last_year_have_you_found_that\",max(case when linkid = 'ef06e3fc-45f0-40a3-aca9-43293339689b' then answer_value_text end) as \"sbirt_have_you_used_drugs_other_than_those_required_for_\",max(case when linkid = 'f53db683-31e1-4d83-82c4-7e3a02f9ee88' then answer_value_text end) as \"sbirt_has_a_relative_or_friend_or_a_doctor_or_another_he\",max(case when linkid = 'fd89df57-4b13-432f-a5b9-d54918f8d4ba' then answer_value_text end) as \"sbirt_do_you_use_more_than_one_drug_at_a_time\",max(case when linkid = '0466b304-2876-409b-ade2-d1c675614854' then answer_value_text end) as \"sbirt_please_select_one_substance_you_would_like_to_disc\",max(case when linkid = '092f7cb4-cfcc-4b1b-ab5d-b7f2d68fc671' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_metha\",max(case when linkid = '19d44e35-f7b5-43e3-be3b-fdb820503f78' then answer_value_text end) as \"sbirt_i_would_like_to_offer_an_opportunity_to_start_a_co\",max(case when linkid = '272246d4-b9c5-4a8b-a349-12f75cf888d0' then answer_value_text end) as \"sbirt_we_could_start_by_discussing_the_pros_and_cons_of_\",max(case when linkid = '39843731-a8e7-4822-bad7-55489947ebeb' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_other\",max(case when linkid = '48d61a4b-d87d-4661-96dd-42766dbe8cc3' then answer_value_text end) as \"sbirt_are_you_interested_in_learning_more_about_what_alc\",max(case when linkid = '687cad76-ce92-4dca-b94f-58070b33da6f' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_canna\",max(case when linkid = '6f1dfe02-2dbb-4371-ab06-a8c915495069' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_hallu\",max(case when linkid = '7baaf5ce-f19b-4a40-980e-cfe53efac3f3' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_sedat\",max(case when linkid = '9dfe8a90-6551-4ae4-bcfb-c839e429a87b' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_inhal\",max(case when linkid = 'a44b78b7-d5ab-49a8-958d-5545072692d8' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_cocai\",max(case when linkid = 'af4330a4-7bc7-48db-bce8-364b0ff4b041' then answer_value_text end) as \"sbirt_are_you_interested_in_learning_more_about_what_the\",max(case when linkid = 'db7cc8b8-b558-41c8-9849-a80252710491' then answer_value_text end) as \"sbirt_on_a_scale_of_0_to_10_with_0_being_not_ready_at_al\",max(case when linkid = 'ea3c9480-429c-4f5c-ac95-0c8c68b8c4b0' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_presc\",max(case when linkid = '2336b352-cd6b-4044-8879-a5425c4ae5cb' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha\",max(case when linkid = '2b8c1391-ba62-4800-ab3d-287fd7a9a3a5' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha_47\",max(case when linkid = '2badbdc1-2d13-4368-b803-c2eb7a2647aa' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha_48\",max(case when linkid = '6c5e1af3-63d6-4283-9ea3-ef2b49314b1a' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha_49\",max(case when linkid = '818b51b8-c7b3-4d64-8142-1c0798662985' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha_50\",max(case when linkid = '8427af19-3bad-4713-bad9-b179437fef96' then answer_value_text end) as \"sbirt_on_average_how_many_days_per_week_do_you_use_stree\",max(case when linkid = '90876967-c973-4bee-9217-8c7482cb12a2' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha_52\",max(case when linkid = '9d8d7688-d1ed-4851-a6ea-59bc296f5368' then answer_value_text end) as \"sbirt_cannabis_marijuana_pot_grass_hash_etc\",max(case when linkid = 'b11bfd65-1f8d-4dee-8a9e-b2044382c0d5' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha_54\",max(case when linkid = 'd11e0ac3-5faf-4986-a633-22efa8c74c4d' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha_55\",max(case when linkid = 'e5787dda-4b43-4ae0-8cea-3062732f5a9d' then answer_value_text end) as \"sbirt_would_you_be_interested_in_learning_more_about_sub\",max(case when linkid = '15799969-7565-4c3e-b488-d6a65d66c6c9' then answer_value_text end) as \"sbirt_1579996975654c3eb488d6a65d66c6c9\",max(case when linkid = '287b1b6c-fe58-4245-90dc-87d72d296812' then answer_value_text end) as \"sbirt_things_you_can_do\",max(case when linkid = '43dead8d-380d-4214-80f1-a1961b916bd3' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_prescript\",max(case when linkid = '49bafbbf-8110-46a0-83f4-802cb1b6fd0f' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_methamphe\",max(case when linkid = '49ee0853-7d07-40af-a139-7cacc302ee41' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_other_dru\",max(case when linkid = '6ad8b269-9415-4551-8d00-9be8812bde01' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_inhalants\",max(case when linkid = '7ee9b164-9830-4f7a-8317-28e0cfc1852c' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_cannabis_\",max(case when linkid = '88accd91-b2ff-4bba-a5b1-58eaef458474' then answer_value_text end) as \"sbirt_during_the_past_three_months_how_often_have_you_ha_64\",max(case when linkid = '9cfbf571-09a3-4a3d-ae9d-24cfdf0b9ce3' then answer_value_text end) as \"sbirt_what_are_some_good_things_about_staying_the_same\",max(case when linkid = 'abb64c97-d3a9-45a2-bec2-11f6c4dc8848' then answer_value_text end) as \"sbirt_street_opioids_heroin_opium_etc_or_prescription_op\",max(case when linkid = 'ae15db19-8d0c-465a-a925-3e0503f0a25b' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_hallucino\",max(case when linkid = 'd4317308-24ec-4ce6-8659-54d4f1aa7e96' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_cocaine_l\",max(case when linkid = 'e06c266d-8bd5-4232-85dc-f61a9d33aff2' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_sedatives\",max(case when linkid = 'ebf2e364-e7d7-44ec-a463-757c8e24d509' then answer_value_text end) as \"sbirt_what_are_some_good_things_about_making_a_change\",max(case when linkid = 'fae920b4-84d9-4576-9fac-51cba163ffd1' then answer_value_text end) as \"sbirt_what_are_your_health_goals_around_substance_use\",max(case when linkid = '0eb07ad0-c8fa-49b6-9c27-064d844b6c4f' then answer_value_text end) as \"sbirt_cocaine_coke_crack_etc\",max(case when linkid = '1600f791-fd2c-44d8-8384-37973785741b' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed\",max(case when linkid = '21a9c779-27be-4c08-b9ab-b0d84964145a' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_74\",max(case when linkid = '705b4c26-4479-4d6a-adbe-b8ebdbad302e' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_75\",max(case when linkid = '958d0ff5-edd9-4d25-9f4d-4ff29289bbe2' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_76\",max(case when linkid = 'a36058d0-3ac9-4cf6-aabb-6b4859dc985d' then answer_value_text end) as \"sbirt_in_the_past_three_months_has_your_use_of_street_op\",max(case when linkid = 'ba444442-73b2-44be-b55e-c8f9fba8f7a8' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_78\",max(case when linkid = 'c5437ab8-5d0c-4157-b06a-b5ec491dc299' then answer_value_text end) as \"sbirt_other_drugs\",max(case when linkid = 'da46a37c-1678-4f34-80b5-f69589bc8844' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_80\",max(case when linkid = 'e1d9ecfa-c456-4109-8807-b8e26ffb69aa' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_81\",max(case when linkid = 'e2c84a83-1568-4593-9ea4-4f6c3978edd6' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_82\",max(case when linkid = 'edced328-6f82-458a-bce4-35987bff19fb' then answer_value_text end) as \"sbirt_edced3286f82458abce435987bff19fb\",max(case when linkid = 'ff55dd63-f51c-420b-97a0-f957d31d6b19' then answer_value_text end) as \"sbirt_can_i_share_additional_treatment_options_with_you\",max(case when linkid = '1bc8823a-bbb1-444a-ad1b-dc09f57038ce' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre\",max(case when linkid = '38eb7cfd-8f4a-4743-b856-c8ddd529dac3' then answer_value_text end) as \"sbirt_prescription_stimulants_just_for_the_feeling_more_\",max(case when linkid = '582271e0-892e-4795-ac55-0b73baf828ca' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_87\",max(case when linkid = '654d5688-f42a-469b-8494-81115b760e29' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_88\",max(case when linkid = '73b23b0b-ff20-4eb9-aebb-a34432897116' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_89\",max(case when linkid = 'a204f61e-3c3c-4cb1-9e3c-78cf8ea7ad5a' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_90\",max(case when linkid = 'a7443184-d141-4bce-93fc-c393132c73b1' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_91\",max(case when linkid = 'aa01eb31-553b-415c-bb90-1ec8d07e979e' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_92\",max(case when linkid = 'ba10b935-7861-4ce4-a2c6-88bdd97709fb' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_93\",max(case when linkid = 'f7444114-6b17-4300-80a1-a6376fd135d4' then answer_value_text end) as \"sbirt_in_the_past_three_months_how_often_have_you_failed_94\",max(case when linkid = '1eb189a2-2ae1-4a27-b4cf-9161447ff8b4' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down\",max(case when linkid = '28edfdea-ec6f-4d33-80e2-6d7323b3b515' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_96\",max(case when linkid = '54f4cac5-ac52-4caa-a6b9-f8b4a412d92e' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_97\",max(case when linkid = '5fa54c70-1483-4dfa-92fc-22ec4d90593c' then answer_value_text end) as \"sbirt_has_a_friend_or_relative_or_anyone_else_ever_expre_98\",max(case when linkid = '8bcb58a6-5720-4746-b0d0-22d6b6ec7c96' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_99\",max(case when linkid = 'a6d0780b-f202-416d-8d9b-c418a4bdb5d0' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_100\",max(case when linkid = 'ad609c63-366e-476a-b131-610ceed211da' then answer_value_text end) as \"sbirt_things_others_can_help_you_do\",max(case when linkid = 'da17f7fc-0919-44cb-a41c-fa8480bd3c40' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_102\",max(case when linkid = 'f7c474fa-87f7-454c-9f1b-1f53b9e4d1ac' then answer_value_text end) as \"sbirt_methamphetamine_meth_crystal_speed_ecstasy_molly_e\",max(case when linkid = 'f9fc5555-b1e6-4251-8047-13162c0b0cca' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_104\",max(case when linkid = 'fac09a6e-c280-426d-94a1-0aa707e35084' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_105\",max(case when linkid = '6281fa0d-ef3f-4013-bd31-062371828010' then answer_value_text end) as \"sbirt_inhalants_nitrous_glue_paint_thinner_poppers_whipp\",max(case when linkid = '9f1fb719-c235-4826-a53e-24502bc620cc' then answer_value_text end) as \"sbirt_have_you_ever_tried_and_failed_to_control_cut_down_107\",max(case when linkid = 'eaa83f10-5cad-4c71-96b9-528e45af44fe' then answer_value_text end) as \"sbirt_sedatives_just_for_the_feeling_more_than_prescribe\",max(case when linkid = '3b2fcef7-2e63-4aaf-b08e-c16dbc5bc33f' then answer_value_text end) as \"sbirt_hallucinogens_lsd_acid_mushrooms_pcp_special_k_ecs\",max(case when linkid = 'aa901327-bb55-4e04-a72b-5bcc7eb22404' then answer_value_text end) as \"sbirt_any_other_drugs_to_get_high\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = '36af2335-ac86-4864-8a3d-619451160cc5' then answer_value_text end) as \"2_times_in_a_day\",max(case when linkid = '380d715b-abd0-4808-9ec4-0a1aabf9a33f' then answer_value_text end) as \"join_a_community_group_and\",max(case when linkid = '386eb911-a4c5-4207-9dab-8d5973069ac5' then answer_value_text end) as \"therapy\",max(case when linkid = '3e1d29fe-7774-4731-bf50-ce5faaf0a528' then answer_value_text end) as \"2_days_per_week\",max(case when linkid = '445adcc0-9c5f-4647-b339-fcb5835f1730' then answer_value_text end) as \"field_445adcc0\",max(case when linkid = '590f26f6-d5e5-4b56-b3a8-415e038dc045' then answer_value_text end) as \"3_days_per_week\",max(case when linkid = '5de2f3d9-de95-4871-919e-a00bb4f346bb' then answer_value_text end) as \"not_ready\",max(case when linkid = '6fb3e9da-948e-4d05-8cad-58d293f557f6' then answer_value_text end) as \"quit\",max(case when linkid = '724d0558-550c-4edc-a1d6-3bd1285bc8a5' then answer_value_text end) as \"20250224\",max(case when linkid = '7f8ade46-1d91-40a0-b67e-015a5a6aadc3' then answer_value_text end) as \"2_times_in_a_day_124\",max(case when linkid = '859d58d6-ee56-4ede-9773-0b7650d7c66d' then answer_value_text end) as \"field_859d58d6\",max(case when linkid = '8a6c4c5b-2fc5-46f7-b9e8-e7f3865a0427' then answer_value_text end) as \"field_8a6c4c5b\",max(case when linkid = 'b87d6054-9f94-456f-b7f6-67c73be8acc7' then answer_value_text end) as \"social_places_you_can_go_to_eg_take_a_walk_at_the_park\",max(case when linkid = 'ddb86794-a4d0-47e8-8a6d-2d27b8e4c4f4' then answer_value_text end) as \"internally\",max(case when linkid = 'e9a44d1a-ecf7-43af-835c-f4b5f73828d3' then answer_value_text end) as \"work_toward_a_goal\",max(case when linkid = 'drug-to-use-alcohol' then answer_value_text end) as \"drug-to-use-alcohol\",max(case when linkid = 'drug-to-use-marijuana-or-other' then answer_value_text end) as \"drug-to-use-marijuana-or-other\",max(case when linkid = 'health-goals-do-not-want-to-change' then answer_value_text end) as \"health-goals-do-not-want-to-change\",max(case when linkid = 'is-drug-dependence' then answer_value_text end) as \"is-drug-dependence\",max(case when linkid = 'is-high-risk-alcohol' then answer_value_text end) as \"is-high-risk-alcohol\",max(case when linkid = 'is-high-risk-drug' then answer_value_text end) as \"is-high-risk-drug\",max(case when linkid = 'is-low-risk-alcohol' then answer_value_text end) as \"is-low-risk-alcohol\",max(case when linkid = 'is-low-risk-drug' then answer_value_text end) as \"is-low-risk-drug\",max(case when linkid = 'is-medium-risk-alcohol' then answer_value_text end) as \"is-medium-risk-alcohol\",max(case when linkid = 'is-medium-risk-drug' then answer_value_text end) as \"is-medium-risk-drug\",max(case when linkid = 'is-opioid-dependence' then answer_value_text end) as \"is-opioid-dependence\",max(case when linkid = 'other-drug-list' then answer_value_text end) as \"other-drug-list\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-gender' then answer_value_text end) as \"patient-gender\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'score-audit' then answer_value_text end) as \"score-audit\",max(case when linkid = 'score-dast' then answer_value_text end) as \"score-dast\",max(case when linkid = 'should-converse-about-substance-use' then answer_value_text end) as \"should-converse-about-substance-use\",max(case when linkid = 'should-discuss-health-goals' then answer_value_text end) as \"should-discuss-health-goals\",max(case when linkid = 'show-client-use-with-other-drugs' then answer_value_text end) as \"show-client-use-with-other-drugs\",max(case when linkid = 'show-discuss-next-steps' then answer_value_text end) as \"show-discuss-next-steps\",max(case when linkid = 'show-goals' then answer_value_text end) as \"show-goals\",max(case when linkid = 'show-intervention-when-low-risk' then answer_value_text end) as \"show-intervention-when-low-risk\",max(case when linkid = 'show-intervention-when-medium-high-risk' then answer_value_text end) as \"show-intervention-when-medium-high-risk\",max(case when linkid = 'show-is-medium-high-risk' then answer_value_text end) as \"show-is-medium-high-risk\",max(case when linkid = 'show-summary-for-low-risk' then answer_value_text end) as \"show-summary-for-low-risk\",max(case when linkid = 'show-things-to-do' then answer_value_text end) as \"show-things-to-do\",max(case when linkid = 'task-id-sbirt-pdf' then answer_value_text end) as \"task-id-sbirt-pdf\",max(case when linkid = 'using-opioids-and-low-risk' then answer_value_text end) as \"using-opioids-and-low-risk\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sbirt\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:52.842894Z", "completed_at": "2025-09-09T13:44:53.448467Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:53.450435Z", "completed_at": "2025-09-09T13:44:53.480511Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6391277313232422, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Short-Form PCL-5-8 (IPC Session 2) with readable column names\n-- Questionnaire ID: 56\n-- Source file: questionnaire/ipc-session-2/sf-pcl-5-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/56') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s2_encounter_id_of_ptsd_session_2\",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"ipc_s2_in_the_past_month_how_much_were_you_bothered_byfee\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"ipc_s2_in_the_past_month_how_much_were_you_bothered_by_re\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"ipc_s2_in_the_past_month_how_much_were_you_bothered_bylos\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"ipc_s2_in_the_past_month_how_much_were_you_bothered_by_ha\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av\",max(case when linkid = '9de6571c-3f74-4694-a567-ac5c897f96cb' then answer_value_text end) as \"ipc_s2_total_score\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"ipc_s2_in_the_past_month_how_much_were_you_bothered_by_fe\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"ipc_s2_in_the_past_month_how_much_were_you_bothered_by_av_9\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"ipc_s2_in_the_past_month_how_much_were_you_bothered_byhav\",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as \"ipc_s2_observation_id_of_pcptsd_session_2_score\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"ipc_s2_score_meaning\",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as \"ipc_s2_score_meaning_13\",max(case when linkid = 'is-ptsd' then answer_value_text end) as \"ipc_s2_is_ptsd\",max(case when linkid = '931dc4ee-b677-4812-9372-3fea7012e9bc' then answer_value_text end) as \"sometimes_things_happen_to_people_that_are_unusually_or_espe\",max(case when linkid = 'c8456561-48fb-49b5-a8e6-6f1a7c2ed7e4' then answer_value_text end) as \"likely_has_ptsd\",max(case when linkid = 'dd349377-e542-4b4f-8fba-795f91431f7d' then answer_value_text end) as \"i_am_going_to_list_some_of_these_events_please_tell_me_if_y\",max(case when linkid = 'f1.26.1' then answer_value_text end) as \"f1.26.1\",max(case when linkid = 'f1.27.1' then answer_value_text end) as \"f1.27.1\",max(case when linkid = 'f1.28.1' then answer_value_text end) as \"f1.28.1\",max(case when linkid = 'f1.29.1' then answer_value_text end) as \"f1.29.1\",max(case when linkid = 'f1.30.1' then answer_value_text end) as \"f1.30.1\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:52.835451Z", "completed_at": "2025-09-09T13:44:53.448245Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:53.448661Z", "completed_at": "2025-09-09T13:44:53.481216Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6467907428741455, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Short-Form PCL-5-8 (IPC Session 1) with readable column names\n-- Questionnaire ID: 204\n-- Source file: questionnaire/ipc-session-1/sf-pcl-5-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/204') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '2171a88a-4e4d-44c4-b6b3-389723e9b505' then answer_value_text end) as \"ipc_s1_taskid_ptsd_pdf\",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"ipc_s1_in_the_past_month_how_much_were_you_bothered_byfee\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"ipc_s1_in_the_past_month_how_much_were_you_bothered_by_re\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"ipc_s1_in_the_past_month_how_much_were_you_bothered_bylos\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"ipc_s1_in_the_past_month_how_much_were_you_bothered_by_ha\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"ipc_s1_in_the_past_month_how_much_were_you_bothered_by_fe\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"ipc_s1_in_the_past_month_how_much_were_you_bothered_by_av_8\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"ipc_s1_in_the_past_month_how_much_were_you_bothered_byhav\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s1_encounter_id_of_ptsd_session_1\",max(case when linkid = 'observation-ptsd-score-id' then answer_value_text end) as \"ipc_s1_observation_id_of_pcptsd_session_1_score\",max(case when linkid = '16d05294-fee9-4d42-8447-0d578a5de192' then answer_value_text end) as \"ipc_s1_total_score\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"ipc_s1_score_meaning\",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as \"ipc_s1_score_meaning_14\",max(case when linkid = 'is-ptsd' then answer_value_text end) as \"ipc_s1_is_ptsd\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"encounter_reference\",max(case when linkid = '790391ba-cf9f-4ef6-be11-b5a7b468819f' then answer_value_text end) as \"sometimes_things_happen_to_people_that_are_unusually_or_espe\",max(case when linkid = 'b7934aa5-17f0-4320-8f65-e7a7f72c5161' then answer_value_text end) as \"likely_has_ptsd\",max(case when linkid = 'd74aecd2-f0c4-4207-b396-b2c6d780be4a' then answer_value_text end) as \"i_am_going_to_list_some_of_these_events_please_tell_me_if_y\",max(case when linkid = 'f1.26.1' then answer_value_text end) as \"f1.26.1\",max(case when linkid = 'f1.27.1' then answer_value_text end) as \"f1.27.1\",max(case when linkid = 'f1.28.1' then answer_value_text end) as \"f1.28.1\",max(case when linkid = 'f1.29.1' then answer_value_text end) as \"f1.29.1\",max(case when linkid = 'f1.30.1' then answer_value_text end) as \"f1.30.1\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:53.211405Z", "completed_at": "2025-09-09T13:44:53.841364Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:53.841602Z", "completed_at": "2025-09-09T13:44:53.896056Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6854498386383057, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Short-Form PCL-5-8 (IPC Session 3) with readable column names\n-- Questionnaire ID: 60\n-- Source file: questionnaire/ipc-session-3/sf-pcl-5-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/60') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s3_encounter_id_of_ptsd_session_3\",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"ipc_s3_in_the_past_month_how_much_were_you_bothered_byfee\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"ipc_s3_in_the_past_month_how_much_were_you_bothered_by_re\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"ipc_s3_in_the_past_month_how_much_were_you_bothered_bylos\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"ipc_s3_in_the_past_month_how_much_were_you_bothered_by_ha\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"ipc_s3_in_the_past_month_how_much_were_you_bothered_by_fe\",max(case when linkid = 'cbad1c80-ab95-4720-ba6a-0eadd718905d' then answer_value_text end) as \"ipc_s3_total_score\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"ipc_s3_in_the_past_month_how_much_were_you_bothered_by_av_9\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"ipc_s3_in_the_past_month_how_much_were_you_bothered_byhav\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"ipc_s3_score_meaning\",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as \"ipc_s3_score_meaning_12\",max(case when linkid = 'is-ptsd' then answer_value_text end) as \"ipc_s3_is_ptsd\",max(case when linkid = 'a51fba17-fccd-4b65-ada3-5c50a75e5d49' then answer_value_text end) as \"sometimes_things_happen_to_people_that_are_unusually_or_espe\",max(case when linkid = 'e4c58005-803f-4bc3-adaa-1f84c5824b6e' then answer_value_text end) as \"i_am_going_to_list_some_of_these_events_please_tell_me_if_y\",max(case when linkid = 'f5002611-caf9-4792-8d10-e7870459ea17' then answer_value_text end) as \"likely_has_ptsd\",max(case when linkid = 'f1.26.1' then answer_value_text end) as \"f1.26.1\",max(case when linkid = 'f1.27.1' then answer_value_text end) as \"f1.27.1\",max(case when linkid = 'f1.28.1' then answer_value_text end) as \"f1.28.1\",max(case when linkid = 'f1.29.1' then answer_value_text end) as \"f1.29.1\",max(case when linkid = 'f1.30.1' then answer_value_text end) as \"f1.30.1\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:53.475806Z", "completed_at": "2025-09-09T13:44:54.094361Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:54.094733Z", "completed_at": "2025-09-09T13:44:54.116152Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6422250270843506, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sf_pcl_5_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Short-Form PCL-5-8 (IPC Session 4) with readable column names\n-- Questionnaire ID: 210\n-- Source file: questionnaire/ipc-session-4/sf-pcl-5-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/210') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s4_encounter_id_of_ptsd_session_4\",max(case when linkid = '347352fc-b189-444a-aa22-df4d9e779f67' then answer_value_text end) as \"ipc_s4_in_the_past_month_how_much_were_you_bothered_byfee\",max(case when linkid = '532fcdbc-38b7-4a35-870c-1d5222e239fb' then answer_value_text end) as \"ipc_s4_in_the_past_month_how_much_were_you_bothered_by_re\",max(case when linkid = '5bc16477-41ff-485f-a73f-f0caa9c2c0ab' then answer_value_text end) as \"ipc_s4_in_the_past_month_how_much_were_you_bothered_bylos\",max(case when linkid = '62b55d32-de8e-4abd-8489-4e3aa9270e11' then answer_value_text end) as \"ipc_s4_total_score\",max(case when linkid = '68bec639-6c70-41e0-88f8-fef0ad941b55' then answer_value_text end) as \"ipc_s4_in_the_past_month_how_much_were_you_bothered_by_ha\",max(case when linkid = '6a52200c-3856-4fcc-afe4-b75921da0122' then answer_value_text end) as \"ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av\",max(case when linkid = 'b4f73ad2-ed7a-4268-9057-a4a72b50dd10' then answer_value_text end) as \"ipc_s4_in_the_past_month_how_much_were_you_bothered_by_fe\",max(case when linkid = 'e13d2bb9-20a6-4605-a33f-5d9047f6b6a8' then answer_value_text end) as \"ipc_s4_in_the_past_month_how_much_were_you_bothered_by_av_9\",max(case when linkid = 'eb42041c-cb74-4d5e-8a29-941776cc0b6e' then answer_value_text end) as \"ipc_s4_in_the_past_month_how_much_were_you_bothered_byhav\",max(case when linkid = 'd4b3bbcc-6d23-45e1-9755-1aa0bfc1b646' then answer_value_text end) as \"ipc_s4_score_meaning\",max(case when linkid = 'ea00e468-9c26-4a1c-a0af-1b72923b1e2e' then answer_value_text end) as \"ipc_s4_score_meaning_12\",max(case when linkid = 'a4b58f6e-3046-4a11-9e9e-e6b1547594e8' then answer_value_text end) as \"sometimes_things_happen_to_people_that_are_unusually_or_espe\",max(case when linkid = 'd590116a-ec42-46e3-8ab6-6259307af17e' then answer_value_text end) as \"i_am_going_to_list_some_of_these_events_please_tell_me_if_y\",max(case when linkid = 'd5a448fb-4db7-45e8-858b-f2d2e7cb0eef' then answer_value_text end) as \"likely_has_ptsd\",max(case when linkid = 'f1.26.1' then answer_value_text end) as \"f1.26.1\",max(case when linkid = 'f1.27.1' then answer_value_text end) as \"f1.27.1\",max(case when linkid = 'f1.28.1' then answer_value_text end) as \"f1.28.1\",max(case when linkid = 'f1.29.1' then answer_value_text end) as \"f1.29.1\",max(case when linkid = 'f1.30.1' then answer_value_text end) as \"f1.30.1\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sf_pcl_5_s4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:53.488706Z", "completed_at": "2025-09-09T13:44:54.107209Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:54.107465Z", "completed_at": "2025-09-09T13:44:54.136013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6515288352966309, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SPI Subform 1 with readable column names\n-- Questionnaire ID: 104455\n-- Source file: questionnaire/spi/spi-subform-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/104455') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"spi_encounter_id_of_spi_sub_1\",max(case when linkid = 'd60ed1ee-79c9-444f-aff7-d346974426ab' then answer_value_text end) as \"spi_is_low_risk\",max(case when linkid = '06e33f1f-7202-4d5e-94d1-efbeabaa3e7d' then answer_value_text end) as \"spi_is_medium_risk\",max(case when linkid = '3f85f2ef-d781-4001-8df5-99a9ac5a656b' then answer_value_text end) as \"spi_is_high_risk\",max(case when linkid = '2897fef9-abcf-4bb3-b33f-2accae4c06c5' then answer_value_text end) as \"spi_were_any_of_these_in_the_past_three_months\",max(case when linkid = '35062b98-748b-441c-ad74-185823e1bb52' then answer_value_text end) as \"spi_in_the_past_month_have_you_been_thinking_about_how\",max(case when linkid = '41aee132-ab8e-4d64-a322-eed88f900edb' then answer_value_text end) as \"spi_in_the_past_month_have_you_had_these_thoughts_and_\",max(case when linkid = '567e992d-fb9e-4608-9be1-9277beae3c23' then answer_value_text end) as \"spi_in_the_past_month_have_you_started_to_work_out_or_\",max(case when linkid = '7cc2e8a9-197a-42ea-9431-ba01eefc6511' then answer_value_text end) as \"spi_in_the_past_month_have_you_wished_you_were_dead_or\",max(case when linkid = '91e9233a-9ab1-410a-b5e3-b30867355cea' then answer_value_text end) as \"spi_have_you_ever_done_anything_started_to_do_anything\",max(case when linkid = 'e2a74544-b333-4767-b3e3-7772413419ce' then answer_value_text end) as \"spi_in_the_past_month_have_you_actually_had_any_though\",max(case when linkid = 'task-id-spi-subform-2' then answer_value_text end) as \"spi_taskid_spi_subform_2\",max(case when linkid = '43898926-e9d5-400e-a095-62a8c7f8dd03' then answer_value_text end) as \"spi_43898926e9d5400ea09562a8c7f8dd03\",max(case when linkid = '644c00f2-8b07-4911-92d0-f05f5e5cc837' then answer_value_text end) as \"spi_644c00f28b07491192d0f05f5e5cc837\",max(case when linkid = '71dbaac9-867f-4d7f-b6d7-e1f59402bbf9' then answer_value_text end) as \"spi_71dbaac9867f4d7fb6d7e1f59402bbf9\",max(case when linkid = '7fc39fba-84db-490d-af4e-8f772d91ffda' then answer_value_text end) as \"spi_7fc39fba84db490daf4e8f772d91ffda\",max(case when linkid = 'a6601f97-0a34-49d0-b181-611d6705ca42' then answer_value_text end) as \"spi_a6601f970a3449d0b181611d6705ca42\",max(case when linkid = 'c7d21a57-0fc6-4e3a-b411-beceb1fb2423' then answer_value_text end) as \"spi_c7d21a570fc64e3ab411beceb1fb2423\",max(case when linkid = 'ecabd308-c45a-41f7-8754-b1f63a101019' then answer_value_text end) as \"spi_ecabd308c45a41f78754b1f63a101019\",max(case when linkid = 'task-status-spi-subform-2' then answer_value_text end) as \"spi_taskstatus_spi_subform_2\",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as \"task-id-spi-subform-3\",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as \"task-id-spi-subform-4\",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as \"task-status-spi-subform-3\",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as \"task-status-spi-subform-4\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:53.485300Z", "completed_at": "2025-09-09T13:44:54.113018Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:54.113414Z", "completed_at": "2025-09-09T13:44:54.145246Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6612188816070557, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_sociodemographic_survey", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- Sociodemographic Survey with readable column names\n-- Questionnaire ID: 1613531\n-- Source file: questionnaire/assessments/sociodemographic_survey.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/1613531') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '05990b62-11a8-4ab7-8988-1d2a17edcff7' then answer_value_text end) as \"demographic_if_you_were_not_born_in_the_us_how_long_have_you_l\",max(case when linkid = '0e027468-c1e9-4977-f5f5-1cfa00ab8af5' then answer_value_text end) as \"demographic_please_specify\",max(case when linkid = '1fdf1a17-7af6-413f-81e9-cf6823fe7fde' then answer_value_text end) as \"demographic_please_specify_3\",max(case when linkid = '2f8a7973-d9bb-493b-aa68-fb01e0f1aefe' then answer_value_text end) as \"demographic_where_were_you_born\",max(case when linkid = '3409c1f0-adf5-4b3b-8ea3-e7672e4cb5af' then answer_value_text end) as \"demographic_what_is_the_zip_code_of_where_you_currently_live\",max(case when linkid = '3960c72d-b6e7-418e-86e9-f8348a49e739' then answer_value_text end) as \"demographic_what_was_your_biological_sex_at_birth\",max(case when linkid = '4baa9e68-fe7a-489a-8b03-cc045b53d93d' then answer_value_text end) as \"demographic_please_enter_the_number_of_years\",max(case when linkid = '5b133a13-0303-4d2f-8884-ffa931d2c173' then answer_value_text end) as \"demographic_we_would_like_to_know_about_what_you_do_are_you\",max(case when linkid = '6e621fcc-a25c-4070-8fda-894bb9df68e4' then answer_value_text end) as \"demographic_please_enter_the_number_of_months\",max(case when linkid = '7b68e9a3-703a-4b57-876e-8dd400826db9' then answer_value_text end) as \"demographic_what_is_your_race_andor_ethnicity\",max(case when linkid = '8f600ee9-8d17-43df-ed68-c9a7de2da7d0' then answer_value_text end) as \"demographic_which_of_the_following_best_represents_how_you_thi\",max(case when linkid = '92fed595-49f2-4fab-81ff-885941f31e07' then answer_value_text end) as \"demographic_where_did_this_client_first_learn_about_engage\",max(case when linkid = '9cce9788-d7e7-4456-d455-5bd8dc3d2f2a' then answer_value_text end) as \"demographic_what_is_your_marital_status\",max(case when linkid = 'b4afce83-4279-4d19-8a8b-1e0b7e1ba73c' then answer_value_text end) as \"demographic_what_term_best_expresses_how_you_describe_your_gen\",max(case when linkid = 'd7e0e5c9-35bd-40bc-9224-9cf9e4b9dbba' then answer_value_text end) as \"demographic_what_was_the_highest_grade_or_level_of_school_that\",max(case when linkid = 'f11fe547-9be9-4693-8a85-f252e4a6262f' then answer_value_text end) as \"demographic_please_specify_the_us_territorycommonwealth_eg_pue\",max(case when linkid = '66d30814-73ea-4fa4-edf8-d0d79378b130' then answer_value_text end) as \"some_of_the_time\",max(case when linkid = 'patient-age' then answer_value_text end) as \"patient-age\",max(case when linkid = 'patient-biological-sex' then answer_value_text end) as \"patient-biological-sex\",max(case when linkid = 'patient-dob' then answer_value_text end) as \"patient-dob\",max(case when linkid = 'patient-gender-identity' then answer_value_text end) as \"patient-gender-identity\",max(case when linkid = 'patient-how-you-think-of-yourself' then answer_value_text end) as \"patient-how-you-think-of-yourself\",max(case when linkid = 'patient-name' then answer_value_text end) as \"patient-name\",max(case when linkid = 'patient-pronouns' then answer_value_text end) as \"patient-pronouns\",max(case when linkid = 'task-id-socio-pdf' then answer_value_text end) as \"task-id-socio-pdf\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_sociodemographic_survey\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:53.897931Z", "completed_at": "2025-09-09T13:44:54.520260Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:54.520646Z", "completed_at": "2025-09-09T13:44:54.536942Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6396069526672363, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SPI Subform 2 with readable column names\n-- Questionnaire ID: 104453\n-- Source file: questionnaire/spi/spi-subform-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/104453') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"spi_encounter_id_of_spi_sub_2\",max(case when linkid = '18c6510f-b294-4741-ae43-9cbbc4ba7e36' then answer_value_text end) as \"spi_did_this_client_also_screen_positive_for_probable_\",max(case when linkid = '27b1e829-9ad9-41c2-8cb5-01ce1f469896' then answer_value_text end) as \"spi_did_you_discuss_this_clients_severe_mental_health_\",max(case when linkid = '4c804862-f4b9-49df-aae4-c7802e723c76' then answer_value_text end) as \"spi_what_is_the_recommended_plan_to_address_the_probab\",max(case when linkid = 'ed537539-d317-43fc-a4b3-38de5e15ea4f' then answer_value_text end) as \"spi_what_is_the_recommended_plan_to_address_the_probab_5\",max(case when linkid = 'task-id-spi-subform-3' then answer_value_text end) as \"spi_taskid_spi_subform_3\",max(case when linkid = 'd02eb882-411e-4bc0-af9d-08a77fcc3f50' then answer_value_text end) as \"spi_d02eb882411e4bc0af9d08a77fcc3f50\",max(case when linkid = 'task-status-spi-subform-3' then answer_value_text end) as \"spi_taskstatus_spi_subform_3\",max(case when linkid = 'task-id-spi-subform-4' then answer_value_text end) as \"spi_taskid_spi_subform_4\",max(case when linkid = 'task-status-spi-subform-4' then answer_value_text end) as \"spi_taskstatus_spi_subform_4\",max(case when linkid = '53b30f12-74eb-474c-941c-5f0e81b7eb9f' then answer_value_text end) as \"spi_53b30f1274eb474c941c5f0e81b7eb9f\",max(case when linkid = 'f4b782e5-18e1-4edf-a3ff-409feb207253' then answer_value_text end) as \"spi_did_you_discuss_this_clients_suicide_risk_screenin\",max(case when linkid = '2dd6c90f-ea68-45ba-9d30-58e02ab0812b' then answer_value_text end) as \"spi_this_client_scored_in_the_moderate_to_high_range_o\",max(case when linkid = '783e2646-c8ea-466d-bba8-85c891a14435' then answer_value_text end) as \"spi_783e2646c8ea466dbba885c891a14435\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:54.120576Z", "completed_at": "2025-09-09T13:44:54.726085Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:54.726610Z", "completed_at": "2025-09-09T13:44:54.741643Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6223311424255371, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SPI Subform 3 with readable column names\n-- Questionnaire ID: 104454\n-- Source file: questionnaire/spi/spi-subform-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/104454') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"spi_encounter_id_of_spi_sub_3\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:54.147471Z", "completed_at": "2025-09-09T13:44:54.765460Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:54.765681Z", "completed_at": "2025-09-09T13:44:54.789130Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6432011127471924, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s1", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- IPC Session 1 with readable column names\n-- Questionnaire ID: 55\n-- Source file: questionnaire/ipc-session-1/start-ipc-ipc-session-1.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/55') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '69125945-bec7-4810-985a-8c1052e8d039' then answer_value_text end) as \"ipc_s1_patient_age\",max(case when linkid = '798d2c43-5b9f-436f-9fa2-f360cbeeea73' then answer_value_text end) as \"ipc_s1_patient_dob\",max(case when linkid = 'acd9d89b-0d67-415e-a3a4-b132ab304c45' then answer_value_text end) as \"ipc_s1_in_what_format_did_you_deliver_this_session_with_t\",max(case when linkid = 'b322e52d-99f3-48e0-bda0-09d95228ae7b' then answer_value_text end) as \"ipc_s1_in_the_past_6_months\",max(case when linkid = 'f1.92.1' then answer_value_text end) as \"ipc_s1_f1921\",max(case when linkid = '10151d1b-3cd2-4f10-b1e5-d6b20112d801' then answer_value_text end) as \"ipc_s1_in_the_past_1_year\",max(case when linkid = '78bc8272-eba1-48a8-a2f4-0e47304887b8' then answer_value_text end) as \"ipc_s1_i_noticed_that_when_i_was_asking_about_important_p\",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as \"ipc_s1_did_you_complete_the_required_assessments_and_the_\",max(case when linkid = 'f1.42.2' then answer_value_text end) as \"ipc_s1_do_you_think_an_important_persons_death_is_connect\",max(case when linkid = 'f1.68.2' then answer_value_text end) as \"ipc_s1_are_you_and_someone_else_having_a_strong_disagreem\",max(case when linkid = 'f1.69.2' then answer_value_text end) as \"ipc_s1_briefly_tell_me_about_the_disagreement\",max(case when linkid = 'f1.70.2' then answer_value_text end) as \"ipc_s1_how_has_this_disagreement_been_affecting_you\",max(case when linkid = 'f1.72.2' then answer_value_text end) as \"ipc_s1_have_there_been_any_changes_in_your_life_that_are_\",max(case when linkid = 'f1.73.2' then answer_value_text end) as \"ipc_s1_what_was_the_change\",max(case when linkid = 'f1.74.2' then answer_value_text end) as \"ipc_s1_when_did_this_happen\",max(case when linkid = 'f1.76.2' then answer_value_text end) as \"ipc_s1_if_the_client_did_not_mention_any_close_relationsh\",max(case when linkid = 'f1.78.2' then answer_value_text end) as \"ipc_s1_would_you_say_you_have_close_relationships\",max(case when linkid = 'f1.79.2' then answer_value_text end) as \"ipc_s1_has_anything_changed_in_your_life_so_that_now_you_\",max(case when linkid = 'f1.88.2' then answer_value_text end) as \"ipc_s1_f1882\",max(case when linkid = 'f1.89.2' then answer_value_text end) as \"ipc_s1_select_the_possible_interpersonal_problem_areas_yo\",max(case when linkid = '528fa2c7-7a88-4d4e-b2ba-38c1384aface' then answer_value_text end) as \"ipc_s1_your_most_distressing_current_symptoms_began\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-1' then answer_value_text end) as \"ipc_s1_taskid_session_1_navigator\",max(case when linkid = 'f1.40.2' then answer_value_text end) as \"ipc_s1_f1402\",max(case when linkid = 'f1.79.3' then answer_value_text end) as \"ipc_s1_when_did_this_event_happen\",max(case when linkid = '1809cb03-235d-4855-b201-7b296b160e37' then answer_value_text end) as \"ipc_s1_is_there_anything_else_that_we_did_not_discuss_tha\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as \"ipc_s1_taskid_session_2_navigator\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"ipc_s1_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_\",max(case when linkid = 'f1.40.3' then answer_value_text end) as \"ipc_s1_has_this_person_been_consistently_close_to_you_or_\",max(case when linkid = 'f1.43.2' then answer_value_text end) as \"ipc_s1_tell_me_about_your_relationship_with_this_person_h\",max(case when linkid = 'f1.69.3' then answer_value_text end) as \"ipc_s1_when_did_this_disagreement_happen\",max(case when linkid = 'f1.82.2' then answer_value_text end) as \"ipc_s1_do_you_want_to_propose_an_interpersonal_formulatio\",max(case when linkid = 'f1.87.2' then answer_value_text end) as \"ipc_s1_do_you_agree_with_this\",max(case when linkid = '5e65c0dc-5524-4f3d-8404-a7427a34e61c' then answer_value_text end) as \"ipc_s1_these_are_the_symptoms_you_said_you_are_currently_\",max(case when linkid = '80344998-41e2-4669-a77e-1fdaebe88bcf' then answer_value_text end) as \"ipc_s1_taskid_mood_pdf\",max(case when linkid = '82cdd7f0-f3d1-4eba-a31e-c6ad367742f4' then answer_value_text end) as \"ipc_s1_relationships_eg_talk_with_friends_or_vi\",max(case when linkid = 'b7b59772-0272-41f6-ba66-16b09a832fc1' then answer_value_text end) as \"ipc_s1_is_there_anything_that_could_get_in_the_way_of_you\",max(case when linkid = 'f1.81.3' then answer_value_text end) as \"ipc_s1_f1813\",max(case when linkid = 'fe689023-f019-483b-ba7c-8ff0e16129d5' then answer_value_text end) as \"ipc_s1_at_that_time_you_were_experiencing\",max(case when linkid = '0627ed93-c89d-48ae-bde2-bd013dc58685' then answer_value_text end) as \"ipc_s1_taskid_ipc_session_1_provider_pdf\",max(case when linkid = 'cd69a7a1-ec17-4f43-8597-26c59732261b' then answer_value_text end) as \"ipc_s1_work_on_my_relationship_with_my_parents_\",max(case when linkid = 'f1.39.3.1' then answer_value_text end) as \"ipc_s1_f13931\",max(case when linkid = '24f9ed3b-3706-43fb-9779-07a9c2077e9d' then answer_value_text end) as \"ipc_s1_taskid_ipc_session_1_client_pdf\",max(case when linkid = 'e8bfb690-b135-4b0f-9291-f6247611ce52' then answer_value_text end) as \"ipc_s1_of_these_symptoms_which_are_the_most_distressing\",max(case when linkid = 'f1.81.4' then answer_value_text end) as \"ipc_s1_f1814\",max(case when linkid = '16333904-aad5-4166-9593-b7286c7b20b2' then answer_value_text end) as \"ipc_s1_earlier_than_that_you_noticed_symptoms\",max(case when linkid = '19416221-7c67-44d7-9b9b-b88364ea7408' then answer_value_text end) as \"ipc_s1_community_activities_eg_go_to_a_recreati\",max(case when linkid = 'bd785881-7e04-4093-b191-d845edea4c9d' then answer_value_text end) as \"ipc_s1_patient_name\",max(case when linkid = 'f1.39.3.2' then answer_value_text end) as \"ipc_s1_f13932\",max(case when linkid = 'f1.40.5' then answer_value_text end) as \"ipc_s1_f1405\",max(case when linkid = '54a97eb0-3fd7-4b2d-b2b7-ea3fe97a1690' then answer_value_text end) as \"ipc_s1_when_did_these_symptoms_begin\",max(case when linkid = '7b0a751e-936e-40e8-9076-c7fe1e818c1f' then answer_value_text end) as \"ipc_s1_xxx\",max(case when linkid = '8085cded-8e0f-497f-9e3d-5fab3981d727' then answer_value_text end) as \"ipc_s1_yesterday_\",max(case when linkid = 'd6c7419a-9082-4579-8678-44e866ab3655' then answer_value_text end) as \"ipc_s1_patient_gender\",max(case when linkid = 'f1.40.6' then answer_value_text end) as \"ipc_s1_has_this_person_been_consistently_close_to_you_or__54\",max(case when linkid = '0c99c32b-a6a7-4de6-9fbc-d34ccf133bbf' then answer_value_text end) as \"ipc_s1_phq9_total\",max(case when linkid = '1ae11d83-35d4-41c0-a804-5ddf6b1c388c' then answer_value_text end) as \"ipc_s1_possible_problem_areas\",max(case when linkid = 'f11ace93-5d84-4cc5-8598-58f9c5623037' then answer_value_text end) as \"ipc_s1_at_that_time_you_were_experiencing_57\",max(case when linkid = '13d72f63-dd18-41f9-bf46-44981f2f804a' then answer_value_text end) as \"ipc_s1_gad7_total\",max(case when linkid = '37a6a71f-e6ee-4b2e-bfba-2c2cd51e508b' then answer_value_text end) as \"ipc_s1_hobbies_eg_listen_to_music_play_video_ga\",max(case when linkid = 'c4b93137-7abc-47f1-8c0a-fbfe8ad6ce2d' then answer_value_text end) as \"ipc_s1_what_was_going_on_in_your_life_when_you_started_to\",max(case when linkid = 'd58c8907-06c6-4071-aa6c-b2b95d2169c7' then answer_value_text end) as \"ipc_s1_total_score\",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as \"ipc_s1_ptsd_total\",max(case when linkid = 'e4ecfbd3-ed37-4b1b-9284-f7cc9386f7b8' then answer_value_text end) as \"ipc_s1_zfgh\",max(case when linkid = 'f1.39.3.3' then answer_value_text end) as \"ipc_s1_how_has_this_relationship_changed_following_trauma\",max(case when linkid = 'a88cb2bf-e23b-423b-9a22-ab94678ccc3a' then answer_value_text end) as \"ipc_s1_do_you_agree_with_this_summary\",max(case when linkid = 'f1.40.8' then answer_value_text end) as \"ipc_s1_f1408\",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as \"ipc_s1_observation_id_of_mood_rating_session_1_score\",max(case when linkid = '0de42ce5-6d9f-40ec-b67b-3d3b975d363b' then answer_value_text end) as \"ipc_s1_what_about_before_that_was_there_a_time_before_in_\",max(case when linkid = '347d89f5-1bad-4ba5-8f45-e63972b02123' then answer_value_text end) as \"ipc_s1_religionspirituality_eg_pray_or_go_to_se\",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as \"ipc_s1_mood_rating_total\",max(case when linkid = 'f1.39.3.4' then answer_value_text end) as \"ipc_s1_person_1_is\",max(case when linkid = 'f1.40.9' then answer_value_text end) as \"ipc_s1_has_this_person_been_consistently_close_to_you_or__72\",max(case when linkid = '07b722c9-210e-491a-8933-2e9aab3474af' then answer_value_text end) as \"ipc_s1_phq9_total_meaning\",max(case when linkid = '31a9e716-52ce-4651-bb17-26f442e2ab89' then answer_value_text end) as \"ipc_s1_what_were_the_symptoms\",max(case when linkid = '69ed5884-0814-4ae0-a7f1-ecf730710523' then answer_value_text end) as \"ipc_s1_with_my_pastor_\",max(case when linkid = 'd126d866-b8c4-4288-84ff-49a40f20e204' then answer_value_text end) as \"ipc_s1_gad7_total_meaning\",max(case when linkid = 'f1.39.4.1' then answer_value_text end) as \"ipc_s1_f13941\",max(case when linkid = '47eaf38f-c74e-484a-af95-b0002074bf67' then answer_value_text end) as \"ipc_s1_ptsd_total_meaning_toggle\",max(case when linkid = '5d23d8f0-b23a-4e2f-ac66-497d9c6ab3fd' then answer_value_text end) as \"ipc_s1_when_did_you_notice_these_symptoms\",max(case when linkid = 'b1b6bebb-0cb7-4029-b320-01d3270ee892' then answer_value_text end) as \"ipc_s1_other\",max(case when linkid = '8a8b5e1e-fa6b-472b-ade7-ee8f5286a759' then answer_value_text end) as \"ipc_s1_mood_rating_comment\",max(case when linkid = 'f1.38.4' then answer_value_text end) as \"ipc_s1_f1384\",max(case when linkid = 'f1.39.4.2' then answer_value_text end) as \"ipc_s1_f13942\",max(case when linkid = 'f1.40.11' then answer_value_text end) as \"ipc_s1_f14011\",max(case when linkid = 'e2629251-1266-4760-a539-f0e680df651b' then answer_value_text end) as \"ipc_s1_what_was_happening_then\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s1_encounter_id_of_ipc_session_1\",max(case when linkid = 'f1.40.12' then answer_value_text end) as \"ipc_s1_has_this_person_been_consistently_close_to_you_or__87\",max(case when linkid = '042e5415-93de-419d-9bac-632596939280' then answer_value_text end) as \"ipc_s1_ex\",max(case when linkid = 'f1.39.4.3' then answer_value_text end) as \"ipc_s1_how_has_this_relationship_changed_following_trauma_89\",max(case when linkid = 'f1.39.4.4' then answer_value_text end) as \"ipc_s1_person_2_is\",max(case when linkid = 'f1.39.5.1' then answer_value_text end) as \"ipc_s1_f13951\",max(case when linkid = 'f1.39.5.2' then answer_value_text end) as \"ipc_s1_f13952\",max(case when linkid = '6409c231-50c1-45fc-808e-f0bd015db97d' then answer_value_text end) as \"ipc_s1_gud\",max(case when linkid = 'f1.39.5.3' then answer_value_text end) as \"ipc_s1_how_has_this_relationship_changed_following_trauma_94\",max(case when linkid = 'f1.39.5.4' then answer_value_text end) as \"ipc_s1_person_3_is\",max(case when linkid = 'f1.39.6.1' then answer_value_text end) as \"ipc_s1_f13961\",max(case when linkid = 'f1.39.6.2' then answer_value_text end) as \"ipc_s1_f13962\",max(case when linkid = 'f1.39.6.3' then answer_value_text end) as \"ipc_s1_how_has_this_relationship_changed_following_trauma_98\",max(case when linkid = 'f1.39.6.4' then answer_value_text end) as \"ipc_s1_person_4_is\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = 'LINK_ID_THAT_CONTAINS_ENCOUNTER_ID_AS_ANSWER' then answer_value_text end) as \"encounter_reference\",max(case when linkid = '4a2ac26a-8d30-4c28-be11-f684f415f661' then answer_value_text end) as \"seeing_someone_be_killed_or_seriously_injured\",max(case when linkid = 'f1.38.3' then answer_value_text end) as \"f1.38.3\",max(case when linkid = 'f1.46.2' then answer_value_text end) as \"f1.46.2\",max(case when linkid = 'task-id-008' then answer_value_text end) as \"task-id-008\",max(case when linkid = 'task-id-009' then answer_value_text end) as \"task-id-009\",max(case when linkid = 'task-id-010' then answer_value_text end) as \"task-id-010\",max(case when linkid = 'task-id-012' then answer_value_text end) as \"task-id-012\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:54.141158Z", "completed_at": "2025-09-09T13:44:54.756263Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:54.756585Z", "completed_at": "2025-09-09T13:44:54.789961Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6505947113037109, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_spi_subform_4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- SPI Subform 4 with readable column names\n-- Questionnaire ID: 104394\n-- Source file: questionnaire/spi/spi-subform-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/104394') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'encounter-id' then answer_value_text end) as \"spi_encounter_id_of_spi_sub_4\",max(case when linkid = 'a3670632-ce8f-468a-b2f3-6934245d3531' then answer_value_text end) as \"spi_taking_pills_i_will_protect_myself_from_this_risk_\",max(case when linkid = '245e5273-e28b-41d2-a152-1f70d85576c8' then answer_value_text end) as \"spi_in_a_few_days_i_would_like_to_meet_for_a_followup_\",max(case when linkid = '36dd1467-a7a1-428c-bdca-17d352a79904' then answer_value_text end) as \"spi_person_1\",max(case when linkid = '9ea8d78b-3288-4ec8-8288-459c03df64f0' then answer_value_text end) as \"spi_when_you_feel_a_suicidal_crisis_arising_go_through\",max(case when linkid = 'a842d271-cd48-47c7-963e-dcd0376ef185' then answer_value_text end) as \"spi_i_would_like_to_make_a_plan_that_will_help_you_man\",max(case when linkid = 'cce2de12-cf62-44ff-84e8-9eb4d864d048' then answer_value_text end) as \"spi_cce2de12cf6244ff84e89eb4d864d048\",max(case when linkid = 'd3340d7e-9b84-4559-8a11-bed5a662a6f2' then answer_value_text end) as \"spi_using_a_firearm_i_will_protect_myself_from_this_ri\",max(case when linkid = '40fbe8d0-4380-4efc-bb04-26fc7d3714eb' then answer_value_text end) as \"spi_40fbe8d043804efcbb0426fc7d3714eb\",max(case when linkid = '53072f88-a81c-4f18-a49f-f85f64fb5be7' then answer_value_text end) as \"spi_the_methods_i_have_thought_about_using_include\",max(case when linkid = '808ba31c-cd29-4743-8801-dfce357d5956' then answer_value_text end) as \"spi_person_1_11\",max(case when linkid = '90cedcbf-bf11-4dc3-9733-42e6900a09fc' then answer_value_text end) as \"spi_90cedcbfbf114dc3973342e6900a09fc\",max(case when linkid = '92ab6e65-f9bd-4718-8af6-f731425d3031' then answer_value_text end) as \"spi_92ab6e65f9bd47188af6f731425d3031\",max(case when linkid = '9d203bac-75fd-4f31-bed6-073502a977f3' then answer_value_text end) as \"spi_9d203bac75fd4f31bed6073502a977f3\",max(case when linkid = 'fba783e8-91d0-4a49-ba80-c55fa9e41a54' then answer_value_text end) as \"spi_additional_hotline_numbers_you_can_contact\",max(case when linkid = '0b247120-23cf-45fc-9e4d-d959f0dda79f' then answer_value_text end) as \"spi_taking_pills_i_will_protect_myself_from_this_risk__16\",max(case when linkid = '12d89dfd-5e43-4f00-8446-b3af23323969' then answer_value_text end) as \"spi_12d89dfd5e434f008446b3af23323969\",max(case when linkid = '39de8b74-5cbc-4225-b27b-c97e72f08af3' then answer_value_text end) as \"spi_39de8b745cbc4225b27bc97e72f08af3\",max(case when linkid = '437d9ea2-adb5-471a-828b-a0285a282217' then answer_value_text end) as \"spi_437d9ea2adb5471a828ba0285a282217\",max(case when linkid = '509b140e-b195-4696-bc5f-f2fc2d2f77dd' then answer_value_text end) as \"spi_509b140eb1954696bc5ff2fc2d2f77dd\",max(case when linkid = '53a575e3-aa59-408d-a0dd-8df237b68bf7' then answer_value_text end) as \"spi_53a575e3aa59408da0dd8df237b68bf7\",max(case when linkid = 'a6d066a2-0286-49b0-b688-34696e7fb256' then answer_value_text end) as \"spi_a6d066a2028649b0b68834696e7fb256\",max(case when linkid = 'ce56c71d-9ea4-4c8e-9e9a-d1da93bac1d4' then answer_value_text end) as \"spi_ce56c71d9ea44c8e9e9ad1da93bac1d4\",max(case when linkid = 'cecb89ae-abce-411c-b4ce-f84ebf59ca14' then answer_value_text end) as \"spi_going_in_front_of_a_moving_vehicle_i_will_protect_\",max(case when linkid = 'd1efad02-3686-4ce3-a96d-68d8c638ff77' then answer_value_text end) as \"spi_person_1_25\",max(case when linkid = 'a0017b28-0aa9-4926-a7be-813f0a5e6bd0' then answer_value_text end) as \"spi_person_1_26\",max(case when linkid = 'beb4ad5f-2fd8-4b80-aa93-aa9ff1896dd0' then answer_value_text end) as \"spi_beb4ad5f2fd84b80aa93aa9ff1896dd0\",max(case when linkid = 'c396a3af-6f0d-4a8e-a42b-4f47bbce5f46' then answer_value_text end) as \"spi_c396a3af6f0d4a8ea42b4f47bbce5f46\",max(case when linkid = 'e45b778d-ee8c-4ee9-81f4-8927006160f9' then answer_value_text end) as \"spi_e45b778dee8c4ee981f48927006160f9\",max(case when linkid = 'f7513e58-a495-49d7-a549-ba4d84fb5003' then answer_value_text end) as \"spi_your_local_hotline_number\",max(case when linkid = '101d2b7f-2b68-407d-aa49-30cb4dadc888' then answer_value_text end) as \"spi_101d2b7f2b68407daa4930cb4dadc888\",max(case when linkid = '14ec8995-eee9-416f-83ad-9f44631ac9b0' then answer_value_text end) as \"spi_14ec8995eee9416f83ad9f44631ac9b0\",max(case when linkid = '18d8ee56-ffd8-4711-9074-126ef2cdc564' then answer_value_text end) as \"spi_18d8ee56ffd847119074126ef2cdc564\",max(case when linkid = '20cae99e-ab90-4d75-92a2-c0af5dd60942' then answer_value_text end) as \"spi_cutting_i_will_protect_myself_from_this_risk_by\",max(case when linkid = '5324bdce-baaa-45bf-935a-eb2f65bd7124' then answer_value_text end) as \"spi_5324bdcebaaa45bf935aeb2f65bd7124\",max(case when linkid = '68fa6f2e-84ec-4dbc-900e-10ede297c488' then answer_value_text end) as \"spi_68fa6f2e84ec4dbc900e10ede297c488\",max(case when linkid = '8891cd7b-ad1c-4030-afe4-6752cd273cf4' then answer_value_text end) as \"spi_8891cd7bad1c4030afe46752cd273cf4\",max(case when linkid = '88e9b865-b81a-494b-aef2-39e803b94e73' then answer_value_text end) as \"spi_using_a_firearm_i_will_protect_myself_from_this_ri_38\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-spi' then answer_value_text end) as \"spi_taskid_spi_navigator\",max(case when linkid = 'c631e361-027c-4e4d-b894-48785a3e6dd0' then answer_value_text end) as \"spi_c631e361027c4e4db89448785a3e6dd0\",max(case when linkid = '8a1155e2-6c49-4f82-a9fc-2807ee298410' then answer_value_text end) as \"spi_taskid_my_safety_plan_pdf\",max(case when linkid = 'a1c56f60-b823-4c15-b99d-a315d2ca1871' then answer_value_text end) as \"spi_a1c56f60b8234c15b99da315d2ca1871\",max(case when linkid = 'ae4fa455-f173-435a-bb1b-4df1d1316bd9' then answer_value_text end) as \"spi_ae4fa455f173435abb1b4df1d1316bd9\",max(case when linkid = 'bc981d8a-7f22-450b-abab-3acca810ccad' then answer_value_text end) as \"spi_bc981d8a7f22450babab3acca810ccad\",max(case when linkid = 'c6c266cc-1c85-41c0-97ce-9ab491be45db' then answer_value_text end) as \"spi_c6c266cc1c8541c097ce9ab491be45db\",max(case when linkid = '5846d53f-171d-47c4-89ad-4016c3be8233' then answer_value_text end) as \"spi_person_2\",max(case when linkid = '7d8621a4-dcc8-4f48-9210-3fb7d0dcc3c7' then answer_value_text end) as \"spi_7d8621a4dcc84f4892103fb7d0dcc3c7\",max(case when linkid = '83661ebe-71cf-4eab-88e3-bfecbfe35164' then answer_value_text end) as \"spi_83661ebe71cf4eab88e3bfecbfe35164\",max(case when linkid = 'be88b027-64b6-4c3c-bf59-36a94dc79b12' then answer_value_text end) as \"spi_be88b02764b64c3cbf5936a94dc79b12\",max(case when linkid = 'c3b4cf6e-385d-40b7-9380-4de2f81463de' then answer_value_text end) as \"spi_c3b4cf6e385d40b793804de2f81463de\",max(case when linkid = 'dfa1f239-2a4c-40bd-ab15-561f6d87febf' then answer_value_text end) as \"spi_hanging_i_will_protect_myself_from_this_risk_by\",max(case when linkid = 'f39df336-a0b8-4d0b-9bd2-6c4284985491' then answer_value_text end) as \"spi_are_you_willing_to_share_your_plan_with_this_perso\",max(case when linkid = 'fd1498e5-abf7-4ebe-9252-97994d6b9449' then answer_value_text end) as \"spi_going_in_front_of_a_moving_vehicle_i_will_protect__53\",max(case when linkid = 'ff115c26-95b9-4e0d-87ed-80817d438fc7' then answer_value_text end) as \"spi_ff115c2695b94e0d87ed80817d438fc7\",max(case when linkid = '656a57f8-f6f0-4fc5-b347-71dd8d38f596' then answer_value_text end) as \"spi_656a57f8f6f04fc5b34771dd8d38f596\",max(case when linkid = 'f7496859-63bb-4b2f-8f75-96e44e893bf7' then answer_value_text end) as \"spi_f749685963bb4b2f8f7596e44e893bf7\",max(case when linkid = 'f8861b1c-781f-4f12-b4c8-f8110f0c2cc0' then answer_value_text end) as \"spi_f8861b1c781f4f12b4c8f8110f0c2cc0\",max(case when linkid = '15e5007d-028f-4644-8fb6-0346730c3101' then answer_value_text end) as \"spi_15e5007d028f46448fb60346730c3101\",max(case when linkid = '24e98b7c-2b1c-4ebe-946f-bcb77bc2aa36' then answer_value_text end) as \"spi_jumping_i_will_protect_myself_from_this_risk_by\",max(case when linkid = '2728e75c-a0e9-4cd9-8d35-962e4f71bf41' then answer_value_text end) as \"spi_are_you_willing_to_share_your_plan_with_this_perso_60\",max(case when linkid = '2b2e05e9-0c11-490c-bbff-278ba90d7b4e' then answer_value_text end) as \"spi_2b2e05e90c11490cbbff278ba90d7b4e\",max(case when linkid = '3e388595-a32f-4623-8c9f-3c67bad04070' then answer_value_text end) as \"spi_3e388595a32f46238c9f3c67bad04070\",max(case when linkid = '62b0eb17-46e5-4c50-a133-087cc190a123' then answer_value_text end) as \"spi_62b0eb1746e54c50a133087cc190a123\",max(case when linkid = '6f68c416-a5de-4f68-8ad0-33c6e85a9a68' then answer_value_text end) as \"spi_cutting_i_will_protect_myself_from_this_risk_by_64\",max(case when linkid = '705df2d9-af92-4f4f-b513-17e01d07b609' then answer_value_text end) as \"spi_705df2d9af924f4fb51317e01d07b609\",max(case when linkid = '7845c436-4904-41fa-9553-2c401935623b' then answer_value_text end) as \"spi_7845c436490441fa95532c401935623b\",max(case when linkid = 'c1d9c871-c1f8-41cc-8c54-edd4e5b162fe' then answer_value_text end) as \"spi_person_2_67\",max(case when linkid = 'd1c2fae1-f0f5-4333-97f6-2220d2ff3d95' then answer_value_text end) as \"spi_person_2_68\",max(case when linkid = 'c802f463-c8f5-4056-bc45-8ab8d64a1966' then answer_value_text end) as \"spi_c802f463c8f54056bc458ab8d64a1966\",max(case when linkid = '22c11dbc-73e0-4470-9ef6-d9bd01f48c99' then answer_value_text end) as \"spi_hanging_i_will_protect_myself_from_this_risk_by_70\",max(case when linkid = '2a6c5feb-8034-418b-8644-142a5e31df63' then answer_value_text end) as \"spi_2a6c5feb8034418b8644142a5e31df63\",max(case when linkid = '3785a264-8bd5-44ab-bf08-8aa33735c0eb' then answer_value_text end) as \"spi_3785a2648bd544abbf088aa33735c0eb\",max(case when linkid = '544a444d-b101-4d56-9351-00bca8ec749e' then answer_value_text end) as \"spi_person_2_73\",max(case when linkid = '603d1492-316f-497f-967b-5c4b1ab983ea' then answer_value_text end) as \"spi_603d1492316f497f967b5c4b1ab983ea\",max(case when linkid = '9f3a622a-d39b-49b0-84e7-0bcf4f832a4f' then answer_value_text end) as \"spi_9f3a622ad39b49b084e70bcf4f832a4f\",max(case when linkid = 'e9c42647-eefb-42bd-9080-f83630729606' then answer_value_text end) as \"spi_e9c42647eefb42bd9080f83630729606\",max(case when linkid = 'ea95a315-f903-4351-87ed-c1e7e7b74198' then answer_value_text end) as \"spi_drowning_i_will_protect_myself_from_this_risk_by\",max(case when linkid = 'ee5d4acf-ecf0-4e62-8924-cff17a33679d' then answer_value_text end) as \"spi_ee5d4acfecf04e628924cff17a33679d\",max(case when linkid = 'fe2f0911-8ddc-412b-a3e6-f216620d147e' then answer_value_text end) as \"spi_fe2f09118ddc412ba3e6f216620d147e\",max(case when linkid = '370c849b-0e00-42ac-be9d-3b4c719ac31a' then answer_value_text end) as \"spi_370c849b0e0042acbe9d3b4c719ac31a\",max(case when linkid = '5151ea93-a0f2-478d-adb6-f31374107b52' then answer_value_text end) as \"spi_person_3\",max(case when linkid = '08b5e17c-5e14-4b19-ac93-9e479cd2a2bb' then answer_value_text end) as \"spi_08b5e17c5e144b19ac939e479cd2a2bb\",max(case when linkid = '13321778-b5d4-4b01-8eda-610cf0007c86' then answer_value_text end) as \"spi_13321778b5d44b018eda610cf0007c86\",max(case when linkid = '229e58ac-a18a-48dd-be10-f8b024a74eb3' then answer_value_text end) as \"spi_jumping_i_will_protect_myself_from_this_risk_by_84\",max(case when linkid = '84018cd8-9134-429c-8dfe-fd6a16e4bd17' then answer_value_text end) as \"spi_84018cd89134429c8dfefd6a16e4bd17\",max(case when linkid = 'f14c3c34-f80a-4481-9d9c-9b05267d4c39' then answer_value_text end) as \"spi_other_ways_i_will_make_my_environment_safer\",max(case when linkid = 'fdd7c3c3-f2c3-43bd-8a80-6b48aa2b9604' then answer_value_text end) as \"spi_fdd7c3c3f2c343bd8a806b48aa2b9604\",max(case when linkid = '8a9424b0-c893-4371-b5c9-bc0008be14b4' then answer_value_text end) as \"spi_8a9424b0c8934371b5c9bc0008be14b4\",max(case when linkid = 'a5d96f90-cd91-4a5b-8862-c4e3f88694af' then answer_value_text end) as \"spi_a5d96f90cd914a5b8862c4e3f88694af\",max(case when linkid = 'f5ab53d4-824c-460f-8939-b86ff3cd97a3' then answer_value_text end) as \"spi_person_3_90\",max(case when linkid = '28b2e31a-ee4d-4e99-8974-b616145311eb' then answer_value_text end) as \"spi_28b2e31aee4d4e998974b616145311eb\",max(case when linkid = '53932020-eed8-46f4-8236-d548a6335a59' then answer_value_text end) as \"spi_drowning_i_will_protect_myself_from_this_risk_by_92\",max(case when linkid = '7e38a614-b0a2-48ea-b7c7-ca2bdc1f00db' then answer_value_text end) as \"spi_7e38a614b0a248eab7c7ca2bdc1f00db\",max(case when linkid = 'c1e99f8b-b1ab-46d1-b205-ecbbb4240fdf' then answer_value_text end) as \"spi_c1e99f8bb1ab46d1b205ecbbb4240fdf\",max(case when linkid = 'd2572206-b47c-4d1e-85cb-812d13a60a85' then answer_value_text end) as \"spi_are_you_willing_to_share_your_plan_with_this_perso_95\",max(case when linkid = 'd4ebe784-07d0-4312-8a46-634c0e338a54' then answer_value_text end) as \"spi_d4ebe78407d043128a46634c0e338a54\",max(case when linkid = '53def3a1-a7e5-4326-95f2-2561c26ecb47' then answer_value_text end) as \"spi_53def3a1a7e5432695f22561c26ecb47\",max(case when linkid = '2b96f1d9-3450-423d-a277-060fcfdadc6b' then answer_value_text end) as \"spi_2b96f1d93450423da277060fcfdadc6b\",max(case when linkid = '69d5aec4-65d3-44b1-99ba-badd201769c5' then answer_value_text end) as \"spi_person_4\",max(case when linkid = 'b36fdd5f-ccac-457c-a8ea-f9497204ef1d' then answer_value_text end) as \"spi_b36fdd5fccac457ca8eaf9497204ef1d\",max(case when linkid = 'c37407c5-003a-4b7c-b6a3-e10ef146a47b' then answer_value_text end) as \"spi_are_you_willing_to_share_your_plan_with_this_perso_101\",max(case when linkid = 'c5720a67-803f-4917-8261-3738de838418' then answer_value_text end) as \"spi_other_ways_i_will_make_my_environment_safer_102\",max(case when linkid = 'cf896559-dff5-4704-94a0-6a6aedee53c5' then answer_value_text end) as \"spi_person_3_103\",max(case when linkid = 'f952feaf-7abc-4f6f-a3bc-d10a43ea62fa' then answer_value_text end) as \"spi_f952feaf7abc4f6fa3bcd10a43ea62fa\",max(case when linkid = 'bd7644ee-28f1-4f43-a654-17fd5034d1f6' then answer_value_text end) as \"spi_bd7644ee28f14f43a65417fd5034d1f6\",max(case when linkid = '72e5c1b7-7ce9-49bd-834b-d98b73ba7090' then answer_value_text end) as \"spi_72e5c1b77ce949bd834bd98b73ba7090\",max(case when linkid = 'a20b29af-3317-415e-9c6e-d9f3bbc4df33' then answer_value_text end) as \"spi_person_4_107\",max(case when linkid = 'd82c6ae9-0516-4513-91fa-664686779d6a' then answer_value_text end) as \"spi_d82c6ae90516451391fa664686779d6a\",max(case when linkid = 'e9e056c2-0469-4523-a28f-1000fed1a4f1' then answer_value_text end) as \"spi_person_3_109\",max(case when linkid = 'fc5c673b-41d4-4352-86bb-043c73ed9807' then answer_value_text end) as \"spi_fc5c673b41d4435286bb043c73ed9807\",max(case when linkid = '0397084a-cd51-4b3a-809d-970a2406ea49' then answer_value_text end) as \"spi_0397084acd514b3a809d970a2406ea49\",max(case when linkid = '6a273a98-82ca-4d36-ade0-ce98f7899972' then answer_value_text end) as \"spi_6a273a9882ca4d36ade0ce98f7899972\",max(case when linkid = '11aadd88-0cf9-48b2-939d-2b3e28191c5f' then answer_value_text end) as \"spi_11aadd880cf948b2939d2b3e28191c5f\",max(case when linkid = '57e87170-761c-4b57-a09c-d50cab02860c' then answer_value_text end) as \"spi_57e87170761c4b57a09cd50cab02860c\",max(case when linkid = '965b7874-dd24-4215-acd4-8d241a262638' then answer_value_text end) as \"spi_965b7874dd244215acd48d241a262638\",max(case when linkid = 'bd62b649-7209-4d32-9bbb-dc2b2823aadb' then answer_value_text end) as \"spi_bd62b64972094d329bbbdc2b2823aadb\",max(case when linkid = '07c2e8dc-b48b-4bc7-b21b-c196cce32709' then answer_value_text end) as \"spi_07c2e8dcb48b4bc7b21bc196cce32709\",max(case when linkid = '83dfd82f-0277-459d-abe3-e8795750f288' then answer_value_text end) as \"spi_person_5\",max(case when linkid = 'ae949697-92ae-476a-96cc-f8b0adc4221f' then answer_value_text end) as \"spi_ae94969792ae476a96ccf8b0adc4221f\",max(case when linkid = '2c7b6bd7-36f6-495b-9f41-eb492c07c7b2' then answer_value_text end) as \"spi_2c7b6bd736f6495b9f41eb492c07c7b2\",max(case when linkid = 'b6f126dd-eac5-42e4-8896-e7400b0c0496' then answer_value_text end) as \"spi_are_you_willing_to_share_your_plan_with_this_perso_121\",max(case when linkid = 'fefdc90f-fe1d-4bfb-af93-94df8c482897' then answer_value_text end) as \"spi_fefdc90ffe1d4bfbaf9394df8c482897\",max(case when linkid = '1fc8f8e7-2022-48d2-b41d-4e8ad22af344' then answer_value_text end) as \"spi_1fc8f8e7202248d2b41d4e8ad22af344\",max(case when linkid = '8c1ac4fe-1d76-4436-8f34-d315c6c17b9c' then answer_value_text end) as \"spi_8c1ac4fe1d7644368f34d315c6c17b9c\",max(case when linkid = 'a33cdecd-b7e6-45d8-94b6-52fa80c64a6d' then answer_value_text end) as \"spi_person_5_125\",max(case when linkid = 'df53c378-27fe-483d-a630-f7b171f72980' then answer_value_text end) as \"spi_df53c37827fe483da630f7b171f72980\",max(case when linkid = 'e552afd3-2816-446e-9ff5-e898bc813660' then answer_value_text end) as \"spi_e552afd32816446e9ff5e898bc813660\",max(case when linkid = '52ef2ff5-ced6-418a-b9e7-f2ef47123df5' then answer_value_text end) as \"spi_are_you_willing_to_share_your_plan_with_this_perso_128\",max(case when linkid = '9aeae470-6ea4-4e7f-9644-ed0375fb6369' then answer_value_text end) as \"spi_person_4_129\",max(case when linkid = '44f02467-8ee0-49f0-8da7-5e7ed827125a' then answer_value_text end) as \"spi_44f024678ee049f08da75e7ed827125a\",max(case when linkid = '82d6b50b-0bb2-40f6-94b1-7a4c58df43f9' then answer_value_text end) as \"spi_82d6b50b0bb240f694b17a4c58df43f9\",max(case when linkid = '892337bd-d7fd-46a7-bf72-08e87c9f412c' then answer_value_text end) as \"spi_892337bdd7fd46a7bf7208e87c9f412c\",max(case when linkid = 'e4a1be29-fe8b-4423-91bc-6b4f5d730e6b' then answer_value_text end) as \"spi_e4a1be29fe8b442391bc6b4f5d730e6b\",max(case when linkid = '9f46e0ff-0532-4105-be36-0cfa9d0770f2' then answer_value_text end) as \"spi_9f46e0ff05324105be360cfa9d0770f2\",max(case when linkid = '86da79f0-44cb-417d-ab20-c7ecc6f8f7c8' then answer_value_text end) as \"spi_86da79f044cb417dab20c7ecc6f8f7c8\",max(case when linkid = 'ce0fdd41-6b09-4104-9998-a04c5dd9a5b7' then answer_value_text end) as \"spi_ce0fdd416b0941049998a04c5dd9a5b7\",max(case when linkid = '3314932c-64e4-4192-b583-eb31e87da1d0' then answer_value_text end) as \"spi_3314932c64e44192b583eb31e87da1d0\",max(case when linkid = '5e2ab0f5-f5d9-4502-befe-aba770f0e206' then answer_value_text end) as \"spi_5e2ab0f5f5d94502befeaba770f0e206\",max(case when linkid = '796f5440-54f8-4d69-b961-a5b7e6a63240' then answer_value_text end) as \"spi_796f544054f84d69b961a5b7e6a63240\",max(case when linkid = '9f531e61-26cf-4223-8653-39c24d6dd478' then answer_value_text end) as \"spi_9f531e6126cf4223865339c24d6dd478\",max(case when linkid = 'ec2a78e1-e70b-4f66-86b1-561cffaf9ffd' then answer_value_text end) as \"spi_are_you_willing_to_share_your_plan_with_this_perso_141\",max(case when linkid = '4d334b16-ea16-4299-94ed-32e84ef97021' then answer_value_text end) as \"spi_4d334b16ea16429994ed32e84ef97021\",max(case when linkid = '895fad45-c3b5-47c5-9edf-5f9b9e793fbf' then answer_value_text end) as \"spi_895fad45c3b547c59edf5f9b9e793fbf\",max(case when linkid = '92da95cc-50dd-4bf0-acca-4465c07d44cc' then answer_value_text end) as \"spi_92da95cc50dd4bf0acca4465c07d44cc\",max(case when linkid = '98407058-4855-44cc-ac45-6e0d0c072fdd' then answer_value_text end) as \"spi_person_5_145\",max(case when linkid = 'f1fef9d7-2ab9-4ead-9c24-c4dc9c7ed4cc' then answer_value_text end) as \"spi_f1fef9d72ab94ead9c24c4dc9c7ed4cc\",max(case when linkid = '40d6a87f-9498-4cfd-b233-4610e6de08c2' then answer_value_text end) as \"spi_40d6a87f94984cfdb2334610e6de08c2\",max(case when linkid = 'ac3206dd-b60b-4cb1-a559-3a770a685668' then answer_value_text end) as \"spi_ac3206ddb60b4cb1a5593a770a685668\",max(case when linkid = 'f895ed4f-5004-4da4-9d59-c21293674b21' then answer_value_text end) as \"spi_f895ed4f50044da49d59c21293674b21\",max(case when linkid = 'faefef23-d2e6-4777-b628-8f83921e8fd8' then answer_value_text end) as \"spi_faefef23d2e64777b6288f83921e8fd8\",max(case when linkid = '62a04638-8928-4aab-b490-1a33739b7a5c' then answer_value_text end) as \"spi_62a0463889284aabb4901a33739b7a5c\",max(case when linkid = 'bfe595d6-325f-492a-b3b6-cc5541e18c3f' then answer_value_text end) as \"spi_bfe595d6325f492ab3b6cc5541e18c3f\",max(case when linkid = '40d8ef64-02f0-42ae-9478-77651bd26dfa' then answer_value_text end) as \"spi_40d8ef6402f042ae947877651bd26dfa\",max(case when linkid = '249f5ce8-ecc0-4e43-9675-6b01ca1502a3' then answer_value_text end) as \"spi_249f5ce8ecc04e4396756b01ca1502a3\",max(case when linkid = '9b1b11e8-608f-4ea9-911b-88aae467ac27' then answer_value_text end) as \"spi_9b1b11e8608f4ea9911b88aae467ac27\",max(case when linkid = 'dae7f411-758d-4800-9842-fc0038a6b4a4' then answer_value_text end) as \"spi_dae7f411758d48009842fc0038a6b4a4\",max(case when linkid = '0c308fef-8ce5-4217-a8d4-8e6ff00c8e14' then answer_value_text end) as \"spi_0c308fef8ce54217a8d48e6ff00c8e14\",max(case when linkid = '54b75d55-1c43-4552-acbf-d9754831add8' then answer_value_text end) as \"spi_54b75d551c434552acbfd9754831add8\",max(case when linkid = '9faa2b78-1842-4326-bf7f-9975bf04dc2c' then answer_value_text end) as \"spi_9faa2b7818424326bf7f9975bf04dc2c\",max(case when linkid = 'a320b787-4cba-457f-9c60-67ff76c7020f' then answer_value_text end) as \"spi_a320b7874cba457f9c6067ff76c7020f\",max(case when linkid = '706fc36f-efef-4bf9-827e-7dc100cc92bc' then answer_value_text end) as \"spi_706fc36fefef4bf9827e7dc100cc92bc\",max(case when linkid = 'a57b5b34-12e5-4ec8-8215-7f316267323a' then answer_value_text end) as \"spi_a57b5b3412e54ec882157f316267323a\",max(case when linkid = '6bbdb2cf-e7f6-443a-8f4e-841e16bb9b75' then answer_value_text end) as \"spi_6bbdb2cfe7f6443a8f4e841e16bb9b75\",max(case when linkid = 'd617b1e1-ea22-4863-a878-627f6b81963e' then answer_value_text end) as \"spi_d617b1e1ea224863a878627f6b81963e\",max(case when linkid = '2cedd4dd-15e5-4951-8674-ea4d4eeb7cfc' then answer_value_text end) as \"spi_2cedd4dd15e549518674ea4d4eeb7cfc\",max(case when linkid = 'c0655b11-8f21-47ed-8ede-95498c2e8200' then answer_value_text end) as \"spi_c0655b118f2147ed8ede95498c2e8200\",max(case when linkid = '1895c0a7-b090-4f49-9b0c-08dca9a7b225' then answer_value_text end) as \"spi_1895c0a7b0904f499b0c08dca9a7b225\",max(case when linkid = 'f311f3ca-5537-4134-8828-5e537bb26a9c' then answer_value_text end) as \"spi_f311f3ca5537413488285e537bb26a9c\",max(case when linkid = '1a00c7b7-e80d-4e90-8ed4-efd8f6d96268' then answer_value_text end) as \"spi_1a00c7b7e80d4e908ed4efd8f6d96268\",max(case when linkid = '527c0166-cc35-4cc3-a9d9-7eeb0a54635e' then answer_value_text end) as \"spi_527c0166cc354cc3a9d97eeb0a54635e\",max(case when linkid = '41cce38a-ca5c-4e24-904a-25b1027336ed' then answer_value_text end) as \"spi_41cce38aca5c4e24904a25b1027336ed\",max(case when linkid = 'e8726638-cfdb-40ae-b72c-f1d594f64de5' then answer_value_text end) as \"spi_e8726638cfdb40aeb72cf1d594f64de5\",max(case when linkid = '6ac23c5d-0035-4895-85f2-33c2fbba8f3f' then answer_value_text end) as \"spi_6ac23c5d0035489585f233c2fbba8f3f\",max(case when linkid = 'e7ba8485-5154-41b8-ac18-35410a83cd99' then answer_value_text end) as \"spi_e7ba8485515441b8ac1835410a83cd99\",max(case when linkid = '06f9231a-999b-4459-8260-6fbbcdfc5d81' then answer_value_text end) as \"spi_06f9231a999b445982606fbbcdfc5d81\",max(case when linkid = 'd8615ac7-96b2-46a2-b3a5-b5b83945b444' then answer_value_text end) as \"spi_d8615ac796b246a2b3a5b5b83945b444\",max(case when linkid = '74d0f0df-e726-4c40-84ce-efece882818b' then answer_value_text end) as \"spi_74d0f0dfe7264c4084ceefece882818b\",max(case when linkid = '1d0ad825-09de-4018-a680-cd0e6bf0983d' then answer_value_text end) as \"spi_1d0ad82509de4018a680cd0e6bf0983d\",max(case when linkid = 'd5194db0-0546-4bd1-96d8-d56457930c03' then answer_value_text end) as \"spi_d5194db005464bd196d8d56457930c03\",max(case when linkid = '9e11ce97-90e8-42f2-ba18-8c4f0720c131' then answer_value_text end) as \"spi_9e11ce9790e842f2ba188c4f0720c131\",max(case when linkid = 'cb75bba9-0bd8-4dce-ba2f-d1b21a97c2a0' then answer_value_text end) as \"spi_cb75bba90bd84dceba2fd1b21a97c2a0\",max(case when linkid = '2f44652f-df2d-476e-933d-75b6ed55f5f2' then answer_value_text end) as \"spi_2f44652fdf2d476e933d75b6ed55f5f2\",max(case when linkid = '7b51625b-73b9-472d-9c71-299beb26694f' then answer_value_text end) as \"spi_7b51625b73b9472d9c71299beb26694f\",max(case when linkid = '13e2f934-82ed-4b23-af6e-95523dc3746a' then answer_value_text end) as \"spi_13e2f93482ed4b23af6e95523dc3746a\",max(case when linkid = 'ec54e447-c981-4dd2-aaa4-659f8e494248' then answer_value_text end) as \"spi_ec54e447c9814dd2aaa4659f8e494248\",max(case when linkid = 'cf16ca6e-8b1b-467d-b807-fc5d50339f71' then answer_value_text end) as \"spi_cf16ca6e8b1b467db807fc5d50339f71\",max(case when linkid = 'ce18eee3-aa64-4423-8db1-50fe7f00850d' then answer_value_text end) as \"spi_ce18eee3aa6444238db150fe7f00850d\",max(case when linkid = '5a79866d-f1fb-4bd8-b4c4-f18c982bef3c' then answer_value_text end) as \"spi_5a79866df1fb4bd8b4c4f18c982bef3c\",max(case when linkid = '45772f3f-c610-408b-942b-359769945cf4' then answer_value_text end) as \"spi_45772f3fc610408b942b359769945cf4\",max(case when linkid = 'cebffdf4-8fd1-4829-884c-41cc42bc0111' then answer_value_text end) as \"spi_cebffdf48fd14829884c41cc42bc0111\",max(case when linkid = '7ca03155-c9ec-45e1-8cd0-5b86fa444ad0' then answer_value_text end) as \"spi_7ca03155c9ec45e18cd05b86fa444ad0\",max(case when linkid = '46c2861b-70a9-4fdf-94ea-e1a01cae3149' then answer_value_text end) as \"spi_46c2861b70a94fdf94eae1a01cae3149\",max(case when linkid = '8a5b1c7d-e3ef-4443-85f1-fa5213d89f8d' then answer_value_text end) as \"spi_8a5b1c7de3ef444385f1fa5213d89f8d\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = '01353b1d-f816-41c1-b330-910e9a76ed12' then answer_value_text end) as \"paracetamol\",max(case when linkid = '176aeeb0-e173-482a-b3eb-60f59bc04f98' then answer_value_text end) as \"tiredness\",max(case when linkid = '2e03fdf1-5274-494d-88e9-dd4b41ec90e6' then answer_value_text end) as \"watching_tv\",max(case when linkid = '33ae3bce-ebd5-4dbc-b40c-a4cbc30736e6' then answer_value_text end) as \"wait_what\",max(case when linkid = '3ab931b8-6bfd-4e5f-b86b-3c7377907331' then answer_value_text end) as \"toxins_i_will_protect_myself_from_this_risk_by\",max(case when linkid = '3cae39d6-8d44-4fe4-835b-3f3ecd9b64fe' then answer_value_text end) as \"sleeping\",max(case when linkid = '4a1c4c0d-158f-494c-a33f-1f7f8e41f21f' then answer_value_text end) as \"what\",max(case when linkid = '5056d0ba-67ac-4eab-b05d-d42941f7b264' then answer_value_text end) as \"what_205\",max(case when linkid = '58721b3d-88ae-4888-b5ec-ef7dfe30fb3d' then answer_value_text end) as \"wait\",max(case when linkid = '65252389-fa9e-4ef4-93ca-e952c77c4c05' then answer_value_text end) as \"wait_what_207\",max(case when linkid = '658e8c22-d6ba-480a-81e0-dc4b6164de13' then answer_value_text end) as \"tiredness_208\",max(case when linkid = '68608473-77e6-4341-9f1b-d4d18b17d3de' then answer_value_text end) as \"toxins_i_will_protect_myself_from_this_risk_by_209\",max(case when linkid = '87dab385-fe6b-44ce-b6b2-5771c41d82c8' then answer_value_text end) as \"sleeping_210\",max(case when linkid = '991ba845-38e5-4622-8528-dfeefbf20d3d' then answer_value_text end) as \"socialize\",max(case when linkid = 'a25cb682-be35-4909-965e-01b8c2d036a2' then answer_value_text end) as \"yoga_playing_with_dog\",max(case when linkid = 'b676a0c2-cda0-4762-be79-2a94205ee68b' then answer_value_text end) as \"watching_tv_213\",max(case when linkid = 'b7e42cdb-a42b-4d22-b7a6-204de5305351' then answer_value_text end) as \"video_games\",max(case when linkid = 'cece37bc-897b-4b48-a9c9-59ecc9f997f7' then answer_value_text end) as \"wait_215\",max(case when linkid = 'd0aa3679-e465-4225-85d6-5822efb10eba' then answer_value_text end) as \"walking_in_the_park\",max(case when linkid = 'db779cb5-5335-4eb6-8ccc-47ec94c626c8' then answer_value_text end) as \"none\",max(case when linkid = 'dfaddf2d-30a3-4f8f-b2fa-ffa675daa5c9' then answer_value_text end) as \"20250204\",max(case when linkid = 'e510a8cf-0bc7-4577-b9ee-ca758d431aa0' then answer_value_text end) as \"taking_toxins\",max(case when linkid = 'e6262800-1e24-4348-9bf2-9bb070d2f20a' then answer_value_text end) as \"tiktok_dance_challenges\",max(case when linkid = 'no-response-step-1' then answer_value_text end) as \"no-response-step-1\",max(case when linkid = 'no-response-step-1-review' then answer_value_text end) as \"no-response-step-1-review\",max(case when linkid = 'no-response-step-2' then answer_value_text end) as \"no-response-step-2\",max(case when linkid = 'no-response-step-2-review' then answer_value_text end) as \"no-response-step-2-review\",max(case when linkid = 'no-response-step-3' then answer_value_text end) as \"no-response-step-3\",max(case when linkid = 'no-response-step-3-review' then answer_value_text end) as \"no-response-step-3-review\",max(case when linkid = 'no-response-step-4' then answer_value_text end) as \"no-response-step-4\",max(case when linkid = 'no-response-step-4-review' then answer_value_text end) as \"no-response-step-4-review\",max(case when linkid = 'no-response-step-6a' then answer_value_text end) as \"no-response-step-6a\",max(case when linkid = 'no-response-step-6a-review' then answer_value_text end) as \"no-response-step-6a-review\",max(case when linkid = 'other-signs-step-1' then answer_value_text end) as \"other-signs-step-1\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_spi_subform_4\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:54.979978Z", "completed_at": "2025-09-09T13:44:55.003913Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:55.004130Z", "completed_at": "2025-09-09T13:44:55.030673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05141401290893555, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.engage_analytics.practitioners", "compiled": true, "compiled_code": "\n\nwith\ncodes as (\n  select\n    id::text as resource_id,\n        name::jsonb ->> 'family' as name_family,\n        name::jsonb ->> 'use' as name_use,\n        name::jsonb ->> 'given' as name_given,\n        telecom::jsonb ->> 'value' as telecom_value,\n        telecom::jsonb ->> 'system' as telecom_system,\n    /* use the column your staging models actually expose */\n    _airbyte_emitted_at\n  from \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner\"\n)\n\nselect\n  p.id,\n  p.active,\n  oa.organization_id,\n  oa.location_id,\n  pc.name_family,\n  trim(pc.name_given, '[\"\"]') as name_given,\n  pc.telecom_value as phone_number,\n  greatest(\n    p._airbyte_emitted_at,\n    coalesce(oa._airbyte_emitted_at, '1900-01-01'),\n    coalesce(pr._airbyte_emitted_at, '1900-01-01')\n  ) as _airbyte_emitted_at,\n  pr.coding_code    as role_id,\n  pr.coding_display as role\nfrom \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"stg_practitioner\" p\nleft join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"current_practitioner_role\" pr\n  on pr.practitioner_id = p.id\nleft join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"organization_affiliations\" oa\n  on pr.organization_id = oa.organization_id\nleft join codes as pc\n  on pc.resource_id = p.id\n\nwhere p._airbyte_emitted_at > (\n  select coalesce(max(_airbyte_emitted_at),'1900-01-01') from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioners\"\n)\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"practitioners\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:55.032788Z", "completed_at": "2025-09-09T13:44:55.035430Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:55.035728Z", "completed_at": "2025-09-09T13:44:55.063577Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0314640998840332, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.patient_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized patient view with masked PII fields for data sharing\n-- Masks: Unique ID, First/Middle/Last names, DOB (shows age instead), Phone, Email, Address, Zip, Medicaid number\n-- Pulls phone numbers from registration data when available\n\nwith patient_with_registration as (\n    select \n        p.*,\n        r.\"phone-number\" as registration_phone\n    from \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient\" p\n    left join \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_registration_info\" r on p.id = r.subject_patient_id\n)\n\nselect \n    -- Use hashed ID for referential integrity while maintaining privacy\n    MD5(p.id::text) as patient_id_hash,\n    \n    -- Demographic information (non-PII)\n    p.gender,\n    p.age_years,  -- Age instead of birth_date for privacy\n    p.deceased,\n    p.active,\n    p.registration_date,\n    \n    -- Masked name fields\n    'REDACTED' as name_family_masked,\n    'REDACTED' as name_given_masked,\n    \n    -- Masked contact information (use registration phone if patient phone is null)\n    CASE \n        WHEN COALESCE(p.phone_number, p.registration_phone) IS NOT NULL \n            AND LENGTH(COALESCE(p.phone_number, p.registration_phone)) >= 4\n        THEN 'XXX-XXX-' || RIGHT(COALESCE(p.phone_number, p.registration_phone), 4)\n        ELSE 'NO PHONE'\n    END as phone_number_masked,\n    \n    -- Location and organization (reference IDs only, no PII)\n    p.location_id,\n    p.practitioner_id,\n    p.practitioner_organization_id,\n    p.practitioner_careteam_id,\n    \n    -- Metadata\n    p._airbyte_emitted_at,\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom patient_with_registration p", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"patient_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:55.065616Z", "completed_at": "2025-09-09T13:44:55.067970Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:55.068191Z", "completed_at": "2025-09-09T13:44:55.098909Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03400397300720215, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_registration_info_anon", "compiled": true, "compiled_code": "\n\n-- Anonymized registration info with masked PII fields\n-- Masks: Unique ID, Names, DOB, Phone, Email, Physical address, Zip code, Medicaid number\n\nselect \n    -- Non-PII identifiers (hashed for referential integrity)\n    MD5(qr_id::text) as qr_id_hash,\n    questionnaire_id,\n    MD5(subject_patient_id::text) as subject_patient_id_hash,\n    encounter_id,\n    author_practitioner_id,\n    \n    -- Location and organization references (non-PII)\n    practitioner_location_id,\n    practitioner_organization_id,\n    practitioner_id,\n    practitioner_careteam_id,\n    \n    -- Application metadata\n    application_version,\n    \n    -- Masked PII fields\n    'REDACTED' as registration_unique_id_masked,\n    'REDACTED' as registration_first_name_masked,\n    'REDACTED' as registration_middle_name_masked,\n    'REDACTED' as registration_surname_masked,\n    \n    -- Age fields (keep age, mask DOB)\n    registration_age,\n    registration_age_6,\n    registration_calculated_age,\n    'REDACTED' as registration_date_of_birth_dob_masked,\n    \n    -- Masked contact information\n    'REDACTED' as \"email-address_masked\",\n    CASE \n        WHEN \"phone-number\" IS NOT NULL AND LENGTH(\"phone-number\") >= 4\n        THEN 'XXX-XXX-' || RIGHT(\"phone-number\", 4)\n        WHEN \"phone-number\" IS NOT NULL\n        THEN 'XXX-XXX-' || \"phone-number\"\n        ELSE 'NO PHONE'\n    END as \"phone-number_masked\",\n    'REDACTED' as \"physical-address_masked\",\n    CASE \n        WHEN \"zip-code\" IS NOT NULL \n        THEN LEFT(\"zip-code\", 3) || 'XX'\n        ELSE NULL\n    END as \"zip-code_masked\",\n    \n    -- Masked Medicaid information\n    CASE \n        WHEN \"do-you-have-medicaid\" = 'Yes' \n        THEN 'Yes'\n        ELSE \"do-you-have-medicaid\"\n    END as \"do-you-have-medicaid\",\n    'REDACTED' as \"medicaid-number_masked\",\n    \n    -- Non-PII demographic fields\n    registration_which_of_the_following_best_represents_how_you_thi,\n    registration_what_was_your_biological_sex_assigned_at_birth,\n    \"choice-gender-identity\",\n    \"choice-pronouns\",\n    \"other-best-represents-how-you-think-of-yourself\",\n    \n    -- Service history (non-PII)\n    registration_has_this_person_received_engage_services_in_the_pa,\n    \n    -- Date components (non-specific)\n    registration_calculated_month,\n    registration_calculated_year,\n    \n    -- Metadata\n    CURRENT_TIMESTAMP as anonymized_at\n\nfrom \"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_registration_info\"", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_registration_info_anon\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:54.538886Z", "completed_at": "2025-09-09T13:44:55.164379Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:55.164597Z", "completed_at": "2025-09-09T13:44:55.183393Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6451311111450195, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s2", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- IPC Session 2 with readable column names\n-- Questionnaire ID: 58\n-- Source file: questionnaire/ipc-session-2/start-ipc-ipc-session-2.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/58') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as \"ipc_s2_phq9_total_meaning\",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as \"ipc_s2_gad7_total_meaning\",max(case when linkid = '6099951a-c965-40f9-ad61-66e7a39a6b92' then answer_value_text end) as \"ipc_s2_ptsd_total\",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef' then answer_value_text end) as \"ipc_s2_phq9_total\",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-2' then answer_value_text end) as \"ipc_s2_summary_when_1\",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-3' then answer_value_text end) as \"ipc_s2_most_distressing_symptoms\",max(case when linkid = '8feb859b-ec9b-40c9-b576-9519401808ef-4' then answer_value_text end) as \"ipc_s2_selected_problem_area\",max(case when linkid = '94e90f68-ea59-4837-b0ad-452f5f0336c3' then answer_value_text end) as \"ipc_s2_ptsd_total_meaning_toggle\",max(case when linkid = '96171fdd-a424-4c09-91e8-31986ac315f7' then answer_value_text end) as \"ipc_s2_gad7_total\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-2' then answer_value_text end) as \"ipc_s2_taskid_session_2_navigator\",max(case when linkid = '5d0b76c5-a416-45a4-a8fc-9889ea840a03' then answer_value_text end) as \"ipc_s2_in_what_format_did_you_deliver_this_session_with_t\",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as \"ipc_s2_7ff4b5cb2c44434b90e985c61a858097\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as \"ipc_s2_taskid_session_3_navigator\",max(case when linkid = '301ae5ab-7dac-4414-a80a-f8784ba6bf51' then answer_value_text end) as \"ipc_s2_have_you_proposed_the_interpersonal_formulation_in\",max(case when linkid = '3abecf2a-c87b-4fad-96eb-e9abc37e9c54' then answer_value_text end) as \"ipc_s2_taskid_ipc_session_2_provider_pdf\",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as \"ipc_s2_work_at_home_you_assigned_to_the_client_in_this_se\",max(case when linkid = 'a4a9cad5-04db-44e5-9a9d-0f1bf40ca840' then answer_value_text end) as \"ipc_s2_a4a9cad504db44e59a9d0f1bf40ca840\",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as \"ipc_s2_did_you_complete_the_required_assessments_and_the_\",max(case when linkid = '6c0d6638-9b65-4016-b3f0-4008f8e462c2' then answer_value_text end) as \"ipc_s2_taskid_ipc_session_2_client_pdf\",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as \"ipc_s2_747188c84fc043ea92b49baa32567f73\",max(case when linkid = 'ac0ade27-9e9a-42a9-8ec6-4e7e79830299' then answer_value_text end) as \"ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area\",max(case when linkid = 'd8eb3c09-b97d-4d55-9590-e6ce932a7a10' then answer_value_text end) as \"ipc_s2_did_the_person_ever_hit_kick_push_or_slap_you\",max(case when linkid = '62cd085f-52d4-44de-881c-93058f201559' then answer_value_text end) as \"ipc_s2_do_you_agree_with_this\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s2_encounter_id_of_ipc_session_2\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"ipc_s2_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_\",max(case when linkid = '2efaba4d-f5af-45f3-9340-1ba9b3fffc1c' then answer_value_text end) as \"ipc_s2_was_this_in_the_context_of_an_argument_or_disagree\",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as \"ipc_s2_3d2ccf9a0e7b48a0854044d43b6dacfe\",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as \"ipc_s2_would_you_prefer_to_focus_on_this_new_problem_area_28\",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as \"ipc_s2_6fb0c7a5a21143ecaf7b5f1079399133\",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as \"ipc_s2_observation_id_of_mood_rating_session_1_score\",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as \"ipc_s2_did_you_ever_hit_kick_push_or_slap_the_person\",max(case when linkid = 'a9314459-f6d9-4ebb-84e7-f1a1968cfd7c' then answer_value_text end) as \"ipc_s2_do_you_still_think_that\",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as \"ipc_s2_mood_rating_total\",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as \"ipc_s2_232484cf1aee4bfaa66e61494587a16a\",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as \"ipc_s2_9ed77f2a0d5a434db153d8deadfbc3f8\",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as \"ipc_s2_3bfee97a6a0e4cd0bdb77ffa8d36191f\",max(case when linkid = '62c9e3f2-30aa-46b0-9190-aa36a1804fdc' then answer_value_text end) as \"ipc_s2_was_this_in_the_context_of_an_argument_or_disagree_37\",max(case when linkid = '9eac8fed-4265-447f-bbde-0986c34f3875' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to_\",max(case when linkid = 'b93eafea-8b01-4b21-994b-c45113622a93' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__39\",max(case when linkid = 'ecd82c04-48de-48ec-8efe-24cbe04cbe4b' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__40\",max(case when linkid = 'f82f76f4-648a-453a-916d-28795448a758' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__41\",max(case when linkid = '287593c3-4174-45af-a998-71d249230943' then answer_value_text end) as \"ipc_s2_287593c3417445afa99871d249230943\",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as \"ipc_s2_9cb58d5b0f2c48f095d2d861ab30c2a7\",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as \"ipc_s2_3f63637c1de24851a088c3b08152447e\",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as \"ipc_s2_50cf6a9ca8374531a13a47381657c2b3\",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as \"ipc_s2_665e1595f16948159d24dac265f1809b\",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as \"ipc_s2_bc8f199a59f04184864db1c0befd26df\",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as \"ipc_s2_e1755ad4b33a44a3b5624206a582c28a\",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as \"ipc_s2_e17756cd48614dde859cf90241977246\",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as \"ipc_s2_e6befba36d2547ae9cac409dfae832a2\",max(case when linkid = '6ff6f541-cb58-48d3-b7eb-24ab667f0a94' then answer_value_text end) as \"ipc_s2_is_any_of_the_2_question_above_is_true\",max(case when linkid = '85a3f14c-e4d8-4c45-9088-967ec4ea0d07' then answer_value_text end) as \"ipc_s2_total_score\",max(case when linkid = '2ef63cf4-b37e-4216-a8e1-db6d1b91cc2a' then answer_value_text end) as \"ipc_s2_2ef63cf4b37e4216a8e1db6d1b91cc2a\",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as \"ipc_s2_3e0b76f9090243bab8580b1505e9d168\",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as \"ipc_s2_9cc2834b0d2843d08811509995cfcdb8\",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as \"ipc_s2_a7f10195b8594670abbca2498c4fe45f\",max(case when linkid = '0b80fd6e-3e52-4d1f-aa19-bbfdd912d724' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__57\",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as \"ipc_s2_f9543e3ccbff4d2ab3dfbf96e509d9ca\",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as \"ipc_s2_547a07c2f94c4956997f0439626d0251\",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as \"ipc_s2_6c1b2aa7f2444d5abfc6e0faef33bfe6\",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as \"ipc_s2_a77f07b379134708a35414e503a948f1\",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as \"ipc_s2_example_skills\",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as \"ipc_s2_example_skills_63\",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as \"ipc_s2_bcb8b5c0bcd84a078fe39d59916e8b7c\",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as \"ipc_s2_eb8828db167447e7ba9ae3c161160b65\",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as \"ipc_s2_example_skills_66\",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as \"ipc_s2_4c95559d86ff4b87a271e52388072a53\",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as \"ipc_s2_bed17079d1e54bbeaf073d7b6a86243e\",max(case when linkid = '0984569b-3fd6-4c4e-a391-e68e73b46f00' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__69\",max(case when linkid = '2a5d7010-a84b-414c-adcb-ad0f49a95740' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__70\",max(case when linkid = '63ac8d07-518c-4791-849a-a9e2c282ce9a' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__71\",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as \"ipc_s2_example_skills_72\",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as \"ipc_s2_c91209cc1b2c43f083f04704418ae2d5\",max(case when linkid = '0e5c44d8-3ec0-427a-99a5-58c2c9cdf9c3' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__74\",max(case when linkid = '126c7309-8143-4c33-857f-41cc6bed09d8' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__75\",max(case when linkid = '2f9608db-8796-4f45-89b7-741585b8a362' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__76\",max(case when linkid = '5817d327-373e-4fc0-9bac-b64e408b0e7f' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__77\",max(case when linkid = '044d9000-1935-4b35-9947-d668de09f10b' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__78\",max(case when linkid = '52f7924d-1c66-4049-8611-26d4e7bcb260' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__79\",max(case when linkid = 'e73f462c-e543-4a3d-849d-dbedcb831444' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__80\",max(case when linkid = 'f39b0b39-2058-4c29-a183-aac5dc70e083' then answer_value_text end) as \"ipc_s2_example_guiding_prompts_not_all_questions_need_to__81\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as \"did_you_ever_hit_kick_slap_or_push_the_person\",max(case when linkid = 'task-id-013' then answer_value_text end) as \"task-id-013\",max(case when linkid = 'task-id-014' then answer_value_text end) as \"task-id-014\",max(case when linkid = 'task-id-015' then answer_value_text end) as \"task-id-015\",max(case when linkid = 'task-id-016' then answer_value_text end) as \"task-id-016\",max(case when linkid = 'task-id-018' then answer_value_text end) as \"task-id-018\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:54.743558Z", "completed_at": "2025-09-09T13:44:55.368278Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:55.368646Z", "completed_at": "2025-09-09T13:44:55.387632Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6446850299835205, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s3", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- IPC Session 3 with readable column names\n-- Questionnaire ID: 208\n-- Source file: questionnaire/ipc-session-3/start-ipc-ipc-session-3.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/208') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-1' then answer_value_text end) as \"ipc_s3_phq9_total\",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-2' then answer_value_text end) as \"ipc_s3_gad7_total\",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-3' then answer_value_text end) as \"ipc_s3_ptsd_total\",max(case when linkid = 'd2cdab75-7e7a-4d5a-add8-fa70bd027640-4' then answer_value_text end) as \"ipc_s3_ptsd_total_meaning\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-3' then answer_value_text end) as \"ipc_s3_taskid_session_3_navigator\",max(case when linkid = '7ff4b5cb-2c44-434b-90e9-85c61a858097' then answer_value_text end) as \"ipc_s3_7ff4b5cb2c44434b90e985c61a858097\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as \"ipc_s3_taskid_session_4_navigator\",max(case when linkid = 'ac6eb49b-3d37-4bac-8d27-1e1ad01018ce' then answer_value_text end) as \"ipc_s3_in_what_format_did_you_deliver_this_session_with_t\",max(case when linkid = '99079ebd-1665-4503-bb37-8de493dd4a21' then answer_value_text end) as \"ipc_s3_work_at_home_you_assigned_to_the_client_in_this_se\",max(case when linkid = 'a24c89ff-1e14-403c-8dfa-26fc6c1103d9' then answer_value_text end) as \"ipc_s3_taskid_ipc_session_3_provider_pdf\",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as \"ipc_s3_did_you_complete_the_required_assessments_and_the_\",max(case when linkid = '4442589a-51b2-48c3-8297-b805e525642c' then answer_value_text end) as \"ipc_s3_taskid_ipc_session_3_client_pdf\",max(case when linkid = '747188c8-4fc0-43ea-92b4-9baa32567f73' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2\",max(case when linkid = 'encounter-id' then answer_value_text end) as \"ipc_s3_encounter_id_of_ipc_session_3\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"ipc_s3_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_\",max(case when linkid = '3d2ccf9a-0e7b-48a0-8540-44d43b6dacfe' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_16\",max(case when linkid = '6930d457-7bec-4983-832b-3220b163f505' then answer_value_text end) as \"ipc_s3_would_you_prefer_to_focus_on_this_new_problem_area\",max(case when linkid = '6fb0c7a5-a211-43ec-af7b-5f1079399133' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_18\",max(case when linkid = 'observation-mood-score-id' then answer_value_text end) as \"ipc_s3_observation_id_of_mood_rating_session_3_score\",max(case when linkid = '1b59ddeb-483d-4b1b-af53-f3942204589a' then answer_value_text end) as \"ipc_s3_1b59ddeb483d4b1baf53f3942204589a\",max(case when linkid = '83176bb3-c0cb-445a-a91b-6711635b1414' then answer_value_text end) as \"ipc_s3_did_you_ever_hit_kick_push_or_slap_the_personno\",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as \"ipc_s3_mood_rating_total\",max(case when linkid = '232484cf-1aee-4bfa-a66e-61494587a16a' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_23\",max(case when linkid = '4554f4b2-d15e-47e7-a10d-d77939dd3afc' then answer_value_text end) as \"ipc_s3_4554f4b2d15e47e7a10dd77939dd3afc\",max(case when linkid = '9ed77f2a-0d5a-434d-b153-d8deadfbc3f8' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_25\",max(case when linkid = 'f9a9f492-8eb8-4c71-8ec6-f80ab596430b' then answer_value_text end) as \"ipc_s3_f9a9f4928eb84c718ec6f80ab596430b\",max(case when linkid = '058278e4-33d6-4c0f-8127-ccf923bcc7ef' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to_\",max(case when linkid = '1c04e4db-3d54-4898-ac8a-d9e2d1cc3e3c' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__28\",max(case when linkid = '8a126244-6ec2-4c81-a6d4-409dff788019' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__29\",max(case when linkid = '969c0120-0b86-40e5-8881-6a145fe90aa9' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__30\",max(case when linkid = '9cb58d5b-0f2c-48f0-95d2-d861ab30c2a7' then answer_value_text end) as \"ipc_s3_9cb58d5b0f2c48f095d2d861ab30c2a7\",max(case when linkid = '59744d45-0100-4d62-b105-5cbecd973ffd' then answer_value_text end) as \"ipc_s3_59744d4501004d62b1055cbecd973ffd\",max(case when linkid = '6b5fa434-2fc3-4e4b-ad11-89f6260a81f2' then answer_value_text end) as \"ipc_s3_6b5fa4342fc34e4bad1189f6260a81f2\",max(case when linkid = '77fc70ba-6cac-494c-b27a-77ebce2289e5' then answer_value_text end) as \"ipc_s3_77fc70ba6cac494cb27a77ebce2289e5\",max(case when linkid = '3f63637c-1de2-4851-a088-c3b08152447e' then answer_value_text end) as \"ipc_s3_3f63637c1de24851a088c3b08152447e\",max(case when linkid = '50cf6a9c-a837-4531-a13a-47381657c2b3' then answer_value_text end) as \"ipc_s3_50cf6a9ca8374531a13a47381657c2b3\",max(case when linkid = 'b95949ec-f2ee-4d04-9e52-fb61dac18e60' then answer_value_text end) as \"ipc_s3_has_anything_changed_since_the_last_time_we_met\",max(case when linkid = 'e6befba3-6d25-47ae-9cac-409dfae832a2' then answer_value_text end) as \"ipc_s3_e6befba36d2547ae9cac409dfae832a2\",max(case when linkid = '2fb4f2f4-23b5-4f36-b444-683563ea4fb3' then answer_value_text end) as \"ipc_s3_total_score\",max(case when linkid = '3bfee97a-6a0e-4cd0-bdb7-7ffa8d36191f' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_40\",max(case when linkid = '4ad7384f-a332-4e41-9318-0d3f9e540ee7' then answer_value_text end) as \"ipc_s3_4ad7384fa3324e4193180d3f9e540ee7\",max(case when linkid = '2f7b6563-47b1-4ad4-abc3-cffdae40a57a' then answer_value_text end) as \"ipc_s3_stage_identified_in_session_2\",max(case when linkid = '665e1595-f169-4815-9d24-dac265f1809b' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_43\",max(case when linkid = 'bc8f199a-59f0-4184-864d-b1c0befd26df' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_44\",max(case when linkid = 'e17756cd-4861-4dde-859c-f90241977246' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_45\",max(case when linkid = 'b24118e2-31c5-4e23-af3a-1722af72c299' then answer_value_text end) as \"ipc_s3_b24118e231c54e23af3a1722af72c299\",max(case when linkid = '68b3cbf5-b9ef-4da4-9ac1-bcbc20f04473' then answer_value_text end) as \"ipc_s3_68b3cbf5b9ef4da49ac1bcbc20f04473\",max(case when linkid = '9e995f48-b092-49b2-a9e4-c7e754e446e5' then answer_value_text end) as \"ipc_s3_9e995f48b09249b2a9e4c7e754e446e5\",max(case when linkid = '9f1e5102-4441-49d8-9fbc-4ea6df196b43' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__49\",max(case when linkid = 'e1755ad4-b33a-44a3-b562-4206a582c28a' then answer_value_text end) as \"ipc_s3_e1755ad4b33a44a3b5624206a582c28a\",max(case when linkid = 'e8b8e550-4d65-42be-acb9-2f4ac17c7f49' then answer_value_text end) as \"ipc_s3_e8b8e5504d6542beacb92f4ac17c7f49\",max(case when linkid = '0c9f8c1d-5827-4d21-bd33-3240fade93ac' then answer_value_text end) as \"ipc_s3_example_skills\",max(case when linkid = 'b31c0187-3e54-4fcf-9763-8b3f3850be92' then answer_value_text end) as \"ipc_s3_example_skills_53\",max(case when linkid = 'bcb8b5c0-bcd8-4a07-8fe3-9d59916e8b7c' then answer_value_text end) as \"ipc_s3_bcb8b5c0bcd84a078fe39d59916e8b7c\",max(case when linkid = 'eea0b1ca-5582-4b45-b5cf-36bc0665ba44' then answer_value_text end) as \"ipc_s3_example_skills_55\",max(case when linkid = '3e0b76f9-0902-43ba-b858-0b1505e9d168' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_56\",max(case when linkid = '9cc2834b-0d28-43d0-8811-509995cfcdb8' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_57\",max(case when linkid = 'a7f10195-b859-4670-abbc-a2498c4fe45f' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_58\",max(case when linkid = 'f9543e3c-cbff-4d2a-b3df-bf96e509d9ca' then answer_value_text end) as \"ipc_s3_f9543e3ccbff4d2ab3dfbf96e509d9ca\",max(case when linkid = '6c1b2aa7-f244-4d5a-bfc6-e0faef33bfe6' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_60\",max(case when linkid = '920de190-557a-4233-91a3-4bf293f18214' then answer_value_text end) as \"ipc_s3_920de190557a423391a34bf293f18214\",max(case when linkid = '95121ef1-bfe5-40ce-841c-524334644148' then answer_value_text end) as \"ipc_s3_95121ef1bfe540ce841c524334644148\",max(case when linkid = 'e1a13d53-b867-440f-8622-bccebf54f176' then answer_value_text end) as \"ipc_s3_e1a13d53b867440f8622bccebf54f176\",max(case when linkid = '547a07c2-f94c-4956-997f-0439626d0251' then answer_value_text end) as \"ipc_s3_547a07c2f94c4956997f0439626d0251\",max(case when linkid = '8ac792f5-3f3c-49d3-a800-63c662bf00cd' then answer_value_text end) as \"ipc_s3_8ac792f53f3c49d3a80063c662bf00cd\",max(case when linkid = '1b3394a9-eaff-4871-9537-0d29f5712adc' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__66\",max(case when linkid = '2f926bba-38b5-4b20-8852-5b9e317bb010' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__67\",max(case when linkid = '57a5ca78-4761-466a-bba4-c0c84eab5243' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__68\",max(case when linkid = 'a77f07b3-7913-4708-a354-14e503a948f1' then answer_value_text end) as \"ipc_s3_a77f07b379134708a35414e503a948f1\",max(case when linkid = 'e245b7d9-955a-4c4b-a107-e2bf5d6d2359' then answer_value_text end) as \"ipc_s3_example_skills_70\",max(case when linkid = 'eb8828db-1674-47e7-ba9a-e3c161160b65' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_71\",max(case when linkid = '4c95559d-86ff-4b87-a271-e52388072a53' then answer_value_text end) as \"ipc_s3_4c95559d86ff4b87a271e52388072a53\",max(case when linkid = '43801cc4-c61f-4ee0-82ad-cf6f1f799593' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__73\",max(case when linkid = '451acc1a-26f4-4374-96da-09bfb47365a8' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__74\",max(case when linkid = '9082f0ba-b8e5-495a-a2a4-b30918e19d53' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__75\",max(case when linkid = 'eb78f289-5f7d-4c89-9ddf-6b393a268462' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__76\",max(case when linkid = 'bed17079-d1e5-4bbe-af07-3d7b6a86243e' then answer_value_text end) as \"ipc_s3_questions_asked_in_session_2_77\",max(case when linkid = '8c82f757-3f40-4b09-bdf4-78ee376f75a8' then answer_value_text end) as \"ipc_s3_8c82f7573f404b09bdf478ee376f75a8\",max(case when linkid = 'c91209cc-1b2c-43f0-83f0-4704418ae2d5' then answer_value_text end) as \"ipc_s3_c91209cc1b2c43f083f04704418ae2d5\",max(case when linkid = '55092b78-a252-44ed-9dcb-2fc78570dc8b' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__80\",max(case when linkid = '5db949bd-4ebf-4d52-b850-8e951455e975' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__81\",max(case when linkid = '601055c1-efe3-47d4-9510-1ed0cc565553' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__82\",max(case when linkid = '70e4d965-a614-4dc5-b2fa-4035f0444b19' then answer_value_text end) as \"ipc_s3_example_guiding_prompts_not_all_questions_need_to__83\",max(case when linkid = 'cd8e3d6d-e9ff-458d-d122-57070bebffaf' then answer_value_text end) as \"date_of_birth\",max(case when linkid = 'b5bc7f80-4a0c-486c-e5eb-32c750036f94' then answer_value_text end) as \"age\",max(case when linkid = 'calculated-month' then answer_value_text end) as \"birth_month\",max(case when linkid = 'calculated-year' then answer_value_text end) as \"age_years\",max(case when linkid = '0a15f38b-027a-42ff-b1e8-ca5e2b313f71' then answer_value_text end) as \"phq9_total_meaning\",max(case when linkid = '10cd5560-6c41-41a6-94c5-af74ce96dc90' then answer_value_text end) as \"gad7_total_meaning\",max(case when linkid = '4ecf12a4-a246-4b79-b281-65b3676ca3a4' then answer_value_text end) as \"did_you_ever_hit_kick_slap_or_push_the_person\",max(case when linkid = '86bdafab-bb90-429e-8bc5-a90dc46e7263' then answer_value_text end) as \"did_you_ever_hit_kick_slap_or_push_the_person_91\",max(case when linkid = 'task-id-019' then answer_value_text end) as \"task-id-019\",max(case when linkid = 'task-id-020' then answer_value_text end) as \"task-id-020\",max(case when linkid = 'task-id-021' then answer_value_text end) as \"task-id-021\",max(case when linkid = 'task-id-022' then answer_value_text end) as \"task-id-022\",max(case when linkid = 'task-id-023' then answer_value_text end) as \"task-id-023\",max(case when linkid = 'task-id-024' then answer_value_text end) as \"task-id-024\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-09T13:44:54.793548Z", "completed_at": "2025-09-09T13:44:55.398645Z"}, {"name": "execute", "started_at": "2025-09-09T13:44:55.398930Z", "completed_at": "2025-09-09T13:44:55.416370Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6235110759735107, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.engage_analytics.qr_start_ipc_s4", "compiled": true, "compiled_code": "-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\"\n-- depends_on: \"airbyte\".\"engage_analytics_engage_analytics_stg\".\"questionnaire_metadata\"\n\n-- IPC Session 4 with readable column names\n-- Questionnaire ID: 63\n-- Source file: questionnaire/ipc-session-4/start-ipc-ipc-session-4.json\n\n\n\n\n  \n  \n\n  \n  \n\n  \n  \n\n  \n  \n    \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n      \n    \n  \n\n  \n  \n\n  with ids(ident) as ( values('Questionnaire/63') ),\n  base as (\n    select\n      a.qr_id,\n      a.linkid,\n      string_agg(distinct a.answer_value_text, ' | ' order by a.answer_value_text) as answer_value_text\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_answers_long\" a\n    join ids on a.questionnaire_id = ids.ident\n    group by 1,2\n  ),\n  header as (\n    select h.*\n    from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_header\" h\n    join ids on h.questionnaire_id = ids.ident\n  ),\n  tags as (\n    select * from \"airbyte\".\"engage_analytics_engage_analytics_int\".\"int_qr_tags\"\n  ),\n  pivoted as (\n    select\n      b.qr_id,max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-1' then answer_value_text end) as \"ipc_s4_phq9_total\",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-2' then answer_value_text end) as \"ipc_s4_gad7_total\",max(case when linkid = 'eda5bee4-4b2a-43d7-a6e9-a180dbf40dce-3' then answer_value_text end) as \"ipc_s4_ptsd_total\",max(case when linkid = 'a11ebb0d-acb3-4038-956b-293a41acb85b-4' then answer_value_text end) as \"ipc_s4_taskid_session_4_navigator\",max(case when linkid = '49a270cd-b72b-42a6-92e3-c139f7a85d74' then answer_value_text end) as \"ipc_s4_taskid_ipc_session_4_provider_pdf\",max(case when linkid = '936d5c53-d176-4c63-9a3a-e9e7f9db3f99' then answer_value_text end) as \"ipc_s4_in_what_format_did_you_deliver_this_session_with_t\",max(case when linkid = 'a302513b-141a-4316-9546-d013212a361e' then answer_value_text end) as \"ipc_s4_taskid_ipc_session_4_client_pdf\",max(case when linkid = 'aa30ce6c-4153-46d8-a4af-83012eafa23d' then answer_value_text end) as \"ipc_s4_what_we_know_is_that_symptoms_can_come_back_in_the\",max(case when linkid = 'b3e46a84-9743-4506-9465-43fa16460e16' then answer_value_text end) as \"ipc_s4_did_you_complete_the_required_assessments_and_the_\",max(case when linkid = '9848888d-1ec0-4d43-b53f-7613ba5144fe' then answer_value_text end) as \"ipc_s4_after_todays_session_i_can_refer_you_for_clinical_\",max(case when linkid = '05617430-b835-4ebd-8d6a-ff58ef6d2824' then answer_value_text end) as \"ipc_s4_after_todays_session_i_will_be_referring_you_for_a\",max(case when linkid = '0b12311e-d9a3-40b4-bb18-5cc6135a3850' then answer_value_text end) as \"ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y\",max(case when linkid = '19dd65c2-8709-4745-81f2-4d4843c4307f' then answer_value_text end) as \"ipc_s4_what_do_you_think_are_some_situations_that_may_tri\",max(case when linkid = '39dfd1f4-01db-4057-9734-4f2fbd83b8fe' then answer_value_text end) as \"ipc_s4_what_do_you_think_are_some_situations_that_may_tri_14\",max(case when linkid = '4c457ea8-c60d-49f7-b166-ebabf737ab22' then answer_value_text end) as \"ipc_s4_how_does_it_make_you_feel_to_know_that_today_is_ou\",max(case when linkid = '7db481df-19e5-400c-a206-4811b39485d5' then answer_value_text end) as \"ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s\",max(case when linkid = '83a63af9-6f49-4fad-bca9-80776fc97be7' then answer_value_text end) as \"ipc_s4_how_do_you_feel_about_today_being_our_last_session\",max(case when linkid = '978ba6cf-b149-49e2-89c3-89a0e18461bc' then answer_value_text end) as \"ipc_s4_how_would_you_know_if_your_symptoms_are_coming_bac\",max(case when linkid = '9b602b02-e5f9-4795-9fb9-fc7ae4353a19' then answer_value_text end) as \"ipc_s4_what_are_some_of_the_skills_you_learned_here_that_\",max(case when linkid = 'a3831bfc-0175-4e5a-8d8d-7313c7f2b69b' then answer_value_text end) as \"ipc_s4_please_select_how_you_would_like_to_proceed_with_t\",max(case when linkid = 'cb8337b0-c822-4374-895b-ee875da4d7f6' then answer_value_text end) as \"ipc_s4_what_are_some_of_the_skills_you_learned_here_that__21\",max(case when linkid = 'dd000285-7c36-44b4-82e6-4e8826665036' then answer_value_text end) as \"ipc_s4_lets_look_at_your_symptom_changes_what_were_your_s_22\",max(case when linkid = 'e67ca22d-e803-4790-bbce-126f2c863490' then answer_value_text end) as \"ipc_s4_do_you_remember_why_you_came_lets_talk_about_how_y_23\",max(case when linkid = 'f1.33.6' then answer_value_text end) as \"ipc_s4_on_a_scale_of_1_to_10_with_1_being_the_worst_mood_\",max(case when linkid = 'e5899d3e-d8fc-4931-91c8-383f51474a5b' then answer_value_text end) as \"ipc_s4_mood_rating_total\",max(case when linkid = '3ce3bf84-176e-40bc-8075-1517a03c6bef' then answer_value_text end) as \"ipc_s4_i_am_going_to_provide_you_with_our_agencys_contact\",max(case when linkid = 'a8c2cacf-7ee5-4076-af42-19d0eba0e6d6' then answer_value_text end) as \"ipc_s4_what_do_you_think_you_still_need_to_work_on_regard\",max(case when linkid = 'aa8d0648-9550-489a-9543-4f00d43ba1fe' then answer_value_text end) as \"ipc_s4_what_do_you_think_you_still_need_to_work_on_regard_28\",max(case when linkid = '749d2a97-4195-4516-8079-60638a4d9e82' then answer_value_text end) as \"ipc_s4_lets_talk_about_what_skills_you_learned_here_that_\",max(case when linkid = '7b65857a-5c04-4414-833d-10602f04d299' then answer_value_text end) as \"ipc_s4_lets_talk_about_what_skills_you_learned_here_that__30\",max(case when linkid = '7fef53bc-56db-47ce-8cba-8efd4bcbc318' then answer_value_text end) as \"ipc_s4_7fef53bc56db47ce8cba8efd4bcbc318\",max(case when linkid = 'ca41ccab-5f0b-4538-b394-ad342a0b5bdc' then answer_value_text end) as \"ipc_s4_total_score\",max(case when linkid = '4602f806-3bf4-4f16-bee1-c2e690dca588' then answer_value_text end) as \"did_you_discuss_this_clients_severe_mental_health_screening\",max(case when linkid = '4e9014d1-e07c-492e-897a-3bf7e8f6f018' then answer_value_text end) as \"what_is_the_recommended_plan_to_address_the_probable_severe\",max(case when linkid = '6d9345d7-61a0-425b-8496-8b08d68175d0' then answer_value_text end) as \"feeling_changed\",max(case when linkid = '91e7579d-ac74-4d72-955b-1a3675a2e656' then answer_value_text end) as \"referral_details_if_the_client_is_referred_out\",max(case when linkid = '9a02423f-9848-4254-b427-3dfa8819d0de' then answer_value_text end) as \"rerer\",max(case when linkid = 'b46d08e9-6af9-47be-a09a-afd0cfdf41de' then answer_value_text end) as \"20241031\",max(case when linkid = 'ec39511c-de47-469d-ac44-973e3fc08532' then answer_value_text end) as \"20250201\",max(case when linkid = 'fe874736-efd1-4fba-b517-5560489729b0' then answer_value_text end) as \"supervisors_name\",max(case when linkid = 'is-connected-to-clinical-care-details' then answer_value_text end) as \"is-connected-to-clinical-care-details\",max(case when linkid = 'is-connected-to-clinical-care-question' then answer_value_text end) as \"is-connected-to-clinical-care-question\"\n    from base b\n    group by b.qr_id\n  )\n  select\n    h.questionnaire_id,\n    h.subject_patient_id,\n    h.encounter_id,\n    h.author_practitioner_id,\n    t.practitioner_location_id,\n    t.practitioner_organization_id,\n    t.practitioner_id,\n    t.practitioner_careteam_id,\n    t.application_version,\n    p.*\n  from pivoted p\n  join header h using (qr_id)\n  left join tags t on t.resource_id = h.qr_id\n\n  \n  \n\n", "relation_name": "\"airbyte\".\"engage_analytics_engage_analytics_mart\".\"qr_start_ipc_s4\"", "batch_results": null}], "elapsed_time": 7.359838008880615, "args": {"quiet": false, "defer": false, "send_anonymous_usage_stats": true, "upload_to_artifacts_ingest_api": false, "use_colors_file": true, "require_nested_cumulative_type_params": false, "exclude": [], "vars": {}, "show_resource_report": false, "log_format": "default", "require_resource_names_without_spaces": true, "which": "run", "project_dir": "/Users/mberg/github/engage-analytics/dbt", "require_yaml_configuration_for_mf_time_spines": false, "print": true, "log_file_max_bytes": 10485760, "populate_cache": true, "state_modified_compare_vars": false, "static_parser": true, "require_generic_test_arguments_property": true, "require_all_warnings_handled_by_warn_error": false, "select": [], "partial_parse": true, "show_all_deprecations": false, "log_level": "info", "state_modified_compare_more_unrendered_values": false, "introspect": true, "strict_mode": false, "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "indirect_selection": "eager", "log_path": "/Users/mberg/github/engage-analytics/dbt/logs", "validate_macro_args": false, "write_json": true, "require_batched_execution_for_custom_microbatch_strategy": false, "use_fast_test_edges": false, "log_level_file": "debug", "invocation_command": "dbt run --profiles-dir .", "empty": false, "use_colors": true, "partial_parse_file_diff": true, "printer_width": 80, "macro_debugging": false, "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": true, "profiles_dir": ".", "log_format_file": "debug", "favor_state": false, "version_check": true}}
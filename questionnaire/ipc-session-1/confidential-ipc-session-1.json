{
  "resourceType": "Questionnaire",
  "id": "34008028",
  "meta": {
    "versionId": "1",
    "lastUpdated": "2024-10-04T09:30:34.101+00:00"
  },
  "language": "en",
  "extension": [
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-launchContext",
      "extension": [
        {
          "url": "name",
          "valueCoding": {
            "system": "http://hl7.org/fhir/uv/sdc/CodeSystem/launchContext",
            "code": "patient",
            "display": "Patient"
          }
        },
        {
          "url": "type",
          "valueCode": "Patient"
        }
      ]
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "patient-name-given",
        "language": "text/fhirpath",
        "expression": "iif(%patient.name.given.first().exists(), %patient.name.given.first(), '')"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "patient-name-family",
        "language": "text/fhirpath",
        "expression": "iif(%patient.name.family.exists(), %patient.name.family, '')"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "patient-calculated-month",
        "language": "text/fhirpath",
        "expression": "iif(%patient.birthDate.toString().substring(5, 2).toInteger() > today().toString().substring(5, 2).toInteger(), ((today().toString().substring(5, 2).toInteger() + 12) - %patient.birthDate.toString().substring(5, 2).toInteger() + 1), (today().toString().substring(5, 2).toInteger() - %patient.birthDate.toString().substring(5, 2).toInteger()) + 1)"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "patient-calculated-year",
        "language": "text/fhirpath",
        "expression": "iif(%patient.birthDate.toString().substring(5, 2).toInteger() > today().toString().substring(5, 2).toInteger(), (today().toString().substring(0, 4).toInteger() - 1) - %patient.birthDate.toString().substring(0, 4).toInteger(), today().toString().substring(0, 4).toInteger() - %patient.birthDate.toString().substring(0, 4).toInteger())"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "patient-age",
        "language": "text/fhirpath",
        "expression": "(((%patient-calculated-year.toString().toInteger() * 365.25) + (%patient-calculated-month.toString().toInteger() * 365.25 / 12)) / 365.25).toString().replaceMatches('[.]+[0-9]+', '').toInteger().toString()"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "patient-name-family-space",
        "language": "text/fhirpath",
        "expression": "iif(%patient-name-family.exists(), ' ' + %patient-name-family, '')"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "patient-age-space",
        "language": "text/fhirpath",
        "expression": "iif(%patient-age.exists(), ', ' + %patient-age, '')"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "patient-name-and-age",
        "language": "text/fhirpath",
        "expression": "%patient-name-given + %patient-name-family-space + %patient-age-space"
      }
    }
  ],
  "version": "0.0.1",
  "title": "Discuss Confidentiality",
  "status": "draft",
  "subjectType": [
    "Patient"
  ],
  "publisher": "ona",
  "contact": [
    {
      "name": "http://www.smartregister.org/"
    }
  ],
  "description": "Discuss Confidentiality form that is intended for IPC Session 1",
  "item": [
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/questionnaire-item-control",
                "code": "page",
                "display": "Page"
              }
            ],
            "text": "Page"
          }
        }
      ],
      "linkId": "797b9edc-dc59-46a5-bbde-2a97391dfc51",
      "type": "group",
      "item": [
        {
          "linkId": "d887fcb3-226a-40c8-85e3-fe2872169259",
          "text": "[patient-given] [patient-family], [patient-age]",
          "_text": {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/cqf-expression",
                "valueExpression": {
                  "language": "text/fhirpath",
                  "expression": "%patient-name-and-age"
                }
              }
            ]
          },
          "type": "display"
        },
        {
          "linkId": "58cd75b9-28f0-4d33-8fca-044e6b18679c",
          "text": "<b>Discuss confidentiality and its limits</b>",
          "type": "group",
          "item": [
            {
              "linkId": "d6ff1f9d-9be8-4fee-8c88-24c9d0060680",
              "text": "Before we begin, I want you to know that anything you say here will be kept private between the two of us. The only exception would be if I think you are at immediate risk of harming yourself or somebody else. Then, I would want to involve others who could help keep you safe. Do you have any questions about this?",
              "type": "display"
            }
          ]
        }
      ]
    }
  ]
}